<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>AmiaaaZ's Site | Javascript逆向学习笔记</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.109.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link href=/dist/app.css rel=stylesheet><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-203328343-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=stylesheet href=https://amiaaaz.github.io/lib/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://amiaaaz.github.io/lib/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script>
<script defer src=https://amiaaaz.github.io/lib/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("https://amiaaaz.github.io/lib/pangu.min.js",function(){pangu.spacingPage()})</script><style type=text/css media="screen, print">@font-face{font-family:fancytitlefont;font-style:normal;font-display:swap;src:url(%25!s%28%3cnil%3e%29.woff2)format('woff2'),url(%25!s%28%3cnil%3e%29.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:300;font-display:swap;src:local('Noto Serif CJK SC Light'),local('NotoSerifCJK-Light'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:400;font-display:swap;src:local('Noto Serif CJK SC'),local('NotoSerifCJK-Regular'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:500;font-display:swap;src:local('Noto Serif CJK SC Medium'),local('NotoSerifCJK-Medium'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff)format('woff')}</style></head><body class="bg-gray-100 text-gray-700 font-sans"><div class="p-6 sm:p-10 md:p-16 flex flex-wrap"><header class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-1 md:order-1 max-w-2xl"><div class="z-50 bg-gray-100 bg-opacity-75 bg-opacity-custom lg:min-w-0.7 max-w-xl md:float-right md:text-right leading-loose tracking-tight md:sticky md:top-0 pt-2"><div><h2><a href=https://amiaaaz.github.io/ title="AmiaaaZ's Site" class="heading font-cursive icon">AmiaaaZ's Site</a></h2></div><h1 class=pt-2>Javascript逆向学习笔记</h1><h3 class="text-java-700 font-normal leading-relaxed pt-2">学就完事了. | 更新ing</h3><div class="flex flex-wrap justify-end pt-2"><div class="md:flex-grow-0 font-light"><a class="post-taxonomy-category text-medium-red-violet-600 hover:text-medium-red-violet-400" href=/categories/notessummary>NOTES&SUMMARY</a>&nbsp;/
<a class="post-taxonomy-category text-medium-red-violet-600 hover:text-medium-red-violet-400" href=/categories/lts>LTS</a>
&nbsp;&nbsp;
<a class="post-taxonomy-tag text-eucalyptus-500" href=/tags/js>js</a></div><time class="text-eucalyptus-500 md:text-right md:flex-grow font-light pl-4" datetime=2023-01-03T22:53:09+08:00>2023-1-3 22:53</time></div><details class=toc open><summary><hr></summary><div class="inline toc-content"><nav id=TableOfContents><ul><li><a href=#绕过反调试>绕过反调试</a></li><li><a href=#obfuscator特征解混淆>obfuscator特征&解混淆</a></li><li><a href=#添加hook>添加hook</a><ul><li><a href=#油猴>油猴</a></li><li><a href=#浏览器插件>浏览器插件</a></li></ul></li><li><a href=#对js进行astjson转换>对js进行ast/json转换</a></li><li><a href=#切分js>切分js</a></li><li><a href=#execjs库相关问题>execjs库相关问题</a></li><li><a href=#requests库tricks>requests库tricks</a><ul><li><a href=#确保headers顺序不变>确保headers顺序不变</a></li><li><a href=#cookie转字典>cookie转字典</a></li></ul></li><li><a href=#猿人学1---js混淆-源码乱码>猿人学1 - js混淆 源码乱码</a></li><li><a href=#猿人学2---js-混淆-动态cookie1>猿人学2 - js 混淆 动态cookie1</a><ul><li><a href=#简单处理>简单处理</a></li><li><a href=#变量回复>变量回复</a></li><li><a href=#调用解密函数>调用解密函数</a></li><li><a href=#对象调用还原>对象调用还原</a></li><li><a href=#分支流程判断>分支流程判断</a></li><li><a href=#控制流平坦化>控制流平坦化</a></li><li><a href=#去除干扰项>去除干扰项</a></li><li><a href=#解题>解题</a></li></ul></li><li><a href=#猿人学3---访问逻辑-推心置腹>猿人学3 - 访问逻辑 推心置腹</a><ul><li><a href=#元组>元组</a></li><li><a href=#requestssession>requests.Session()</a></li></ul></li></ul></nav></div></details><hr></div></header><main role=main class="w-full md:w-3/5 xl:w-1/2 max-w-3xl order-2 md:order-2 min-h-70vh pt-2 pb-4"><article><section class="mx-auto content"><div class=c-rich-text><h2 id=绕过反调试>绕过反调试</h2><ul><li>每xx ms执行一次debugger</li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75af00>setInterval</span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>debugger</span>
</span></span><span style=display:flex><span><span style=color:#111>},</span> <span style=color:#ae81ff>500</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>在debugger处右键 永不在此处暂停（或：添加条件断点 false）</p><ul><li>每xx ms打印一个值 干扰控制台输出</li></ul><p>*单一js文件形态：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75af00>setInterval</span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>eval</span><span style=color:#111>.</span><span style=color:#75af00>toString</span><span style=color:#111>()</span> <span style=color:#f92672>!==</span> <span style=color:#d88200>&#39;function eval() { [native code] }&#39;</span><span style=color:#111>){</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>w</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>dd</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>){</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>error</span><span style=color:#111>(</span><span style=color:#d88200>&#39;苦蟲&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>error</span><span style=color:#111>(</span><span style=color:#d88200>&#39;闆蘭&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#75af00>setInterval</span><span style=color:#111>.</span><span style=color:#75af00>toString</span><span style=color:#111>()</span> <span style=color:#f92672>!==</span> <span style=color:#d88200>&#39;function setInterval() { [native code] }&#39;</span><span style=color:#111>){</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>w</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>dd</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>error</span><span style=color:#111>(</span><span style=color:#d88200>&#39;總難煉為&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>debugger</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>error</span><span style=color:#111>(</span><span style=color:#d88200>&#39;永不言棄,jy&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#111>},</span> <span style=color:#ae81ff>500</span><span style=color:#111>);</span>
</span></span></code></pre></div><p>控制台处定位到代码，源代码处右键 在网络面板中显示，找到对应条目右键 阻止请求URL</p><p>*嵌入js中作为函数的形态：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>oo0O0</span><span style=color:#111>(){</span>
</span></span><span style=display:flex><span>    <span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>a</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;xxxxxxxxxxxxxxxxxxxxxxxxxx&#39;</span> <span style=color:#75715e>// 一堆乱码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>var</span> <span style=color:#75af00>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#75af00>len</span> <span style=color:#f92672>=</span> <span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>a</span><span style=color:#111>.</span><span style=color:#75af00>length</span><span style=color:#111>;</span> <span style=color:#75af00>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>len</span><span style=color:#111>;</span> <span style=color:#75af00>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>log</span><span style=color:#111>(</span><span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>a</span><span style=color:#111>[</span><span style=color:#75af00>i</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></div><p>在该函数处下断点，让它在被调用之前就修改掉内部的赋值</p><h2 id=obfuscator特征解混淆>obfuscator特征&解混淆</h2><blockquote><p>ob混淆：<a href=https://obfuscator.io/>JavaScript Obfuscator Tool</a></p><p>解混淆：<a href=https://github.com/DingZaiHub/ob-decrypt>ob混淆还原工具</a> | <a href=http://tool.yuanrenxue.com/decode_obfuscator>ob混淆专解 测试版 V0.6</a></p></blockquote><p>以基础代码举例</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>hi</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>log</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Hello World!&#34;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#75af00>hi</span><span style=color:#111>();</span>
</span></span></code></pre></div><p>旧版obfuscator加密后的结果是这样的：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x30bb</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#d88200>&#39;log&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;Hello\x20World!&#39;</span><span style=color:#111>];</span>	<span style=color:#75715e>// 定义数组 [1]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>_0x38d89d</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30bbb2</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0xae0a32</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>_0x2e4e9d</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#f92672>--</span><span style=color:#75af00>_0x2e4e9d</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x38d89d</span><span style=color:#111>[</span><span style=color:#d88200>&#39;push&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x38d89d</span><span style=color:#111>[</span><span style=color:#d88200>&#39;shift&#39;</span><span style=color:#111>]());</span>	<span style=color:#75715e>// 对数组内变量做移位操作 [2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>};</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>_0xae0a32</span><span style=color:#111>(</span><span style=color:#f92672>++</span><span style=color:#75af00>_0x30bbb2</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#111>}(</span><span style=color:#75af00>_0x30bb</span><span style=color:#111>,</span> <span style=color:#ae81ff>0x153</span><span style=color:#111>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>_0xae0a</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>_0x38d89d</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30bbb2</span><span style=color:#111>)</span> <span style=color:#111>{</span>	<span style=color:#75715e>// 解密函数 [3]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75af00>_0x38d89d</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x38d89d</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0xae0a32</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x30bb</span><span style=color:#111>[</span><span style=color:#75af00>_0x38d89d</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0xae0a32</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#111>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>hi</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>console</span><span style=color:#111>[</span><span style=color:#75af00>_0xae0a</span><span style=color:#111>(</span><span style=color:#d88200>&#39;0x1&#39;</span><span style=color:#111>)](</span><span style=color:#75af00>_0xae0a</span><span style=color:#111>(</span><span style=color:#d88200>&#39;0x0&#39;</span><span style=color:#111>));</span>	<span style=color:#75715e>// 加密后的函数 [4]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>hi</span><span style=color:#111>();</span>	<span style=color:#75715e>// 调用
</span></span></span></code></pre></div><p>对于[2]可以直接执行，获得正确顺序下的数组内容</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221216102737795.png alt=image-20221216102737795></p><p>正确数组有了，[3]中还提供了现成的解密方法，我们只需要用它就可以还原数据了</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>re</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>execjs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>decrypt</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;&#39;var _0x30bb = [&#39;Hello World!&#39;, &#39;log&#39;]  // 处理过移位的数组
</span></span></span><span style=display:flex><span><span style=color:#d88200>var _0xae0a = function (_0x38d89d, _0x30bbb2) {	// 解密函数
</span></span></span><span style=display:flex><span><span style=color:#d88200>    _0x38d89d = _0x38d89d - 0x0;
</span></span></span><span style=display:flex><span><span style=color:#d88200>    var _0xae0a32 = _0x30bb[_0x38d89d];
</span></span></span><span style=display:flex><span><span style=color:#d88200>    return _0xae0a32;
</span></span></span><span style=display:flex><span><span style=color:#d88200>};&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>decrypt_func</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;_0xae0a&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>ctx</span> <span style=color:#f92672>=</span> <span style=color:#111>execjs</span><span style=color:#f92672>.</span><span style=color:#111>compile</span><span style=color:#111>(</span><span style=color:#111>decrypt</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;a.js&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#111>code</span> <span style=color:#f92672>=</span> <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#111>code</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>set</span><span style=color:#111>(</span><span style=color:#111>re</span><span style=color:#f92672>.</span><span style=color:#111>findall</span><span style=color:#111>(</span><span style=color:#111>decrypt_func</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\([\s\S]+?\)&#39;</span><span style=color:#111>,</span> <span style=color:#111>code</span><span style=color:#111>)):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>args</span> <span style=color:#f92672>=</span> <span style=color:#111>re</span><span style=color:#f92672>.</span><span style=color:#111>findall</span><span style=color:#111>(</span><span style=color:#d88200>&#39;\(([\s\S]+?)\)&#39;</span><span style=color:#111>,</span> <span style=color:#111>i</span><span style=color:#111>)[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#111>arg1</span> <span style=color:#f92672>=</span> <span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#111>args</span><span style=color:#f92672>.</span><span style=color:#111>split</span><span style=color:#111>(</span><span style=color:#d88200>&#39;,&#39;</span><span style=color:#111>)[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#111>_res</span> <span style=color:#f92672>=</span> <span style=color:#111>ctx</span><span style=color:#f92672>.</span><span style=color:#111>call</span><span style=color:#111>(</span><span style=color:#111>decrypt_func</span><span style=color:#111>,</span> <span style=color:#111>arg1</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#111>res</span><span style=color:#f92672>.</span><span style=color:#111>replace</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;&#39;&#34;</span> <span style=color:#f92672>+</span> <span style=color:#111>_res</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;&#39;&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>res</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>脚本其实是完成了批量匹配和解密的过程</p><p>而目前4.0.0版obfuscator的默认加密已经没有上面可读性那么好了（看github上说不会再更新了）</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x3b94</span><span style=color:#111>()</span> <span style=color:#111>{</span>    <span style=color:#75715e>// 定义数组 [1]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x47a143</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#d88200>&#39;log&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;1914804MUXMLC&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;Hello\x20World!&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;13668568PxihTU&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;3072916cTlxVO&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;1319280YhFVKJ&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;20xdoBic&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;374500AdEIEJ&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;565449UDQpof&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;1069183kuRgHD&#39;</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>_0x3b94</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x47a143</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>};</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x3b94</span><span style=color:#111>();</span>	<span style=color:#75715e>// 从原先的赋值变量改为函数加载 并进行嵌套 同时增加了数组内的干扰项 排列顺序与之后解密有关系
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>_0x41ac74</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1a5714</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x59b7d7</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x1e16</span><span style=color:#111>,</span> <span style=color:#75af00>_0x75200a</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x41ac74</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#f92672>!!</span><span style=color:#111>[])</span> <span style=color:#111>{</span>	<span style=color:#75715e>// 对原先流程复杂化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#00a8c8>try</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x28ad51</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x122</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x1</span> <span style=color:#f92672>+</span> <span style=color:#f92672>-</span><span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x120</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x2</span> <span style=color:#f92672>+</span> <span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x121</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x3</span> <span style=color:#f92672>+</span> <span style=color:#f92672>-</span><span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x124</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x4</span> <span style=color:#f92672>+</span> <span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x11f</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x5</span> <span style=color:#f92672>*</span> <span style=color:#111>(</span><span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x11e</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x6</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#f92672>-</span><span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x127</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x7</span> <span style=color:#f92672>+</span> <span style=color:#111>parseInt</span><span style=color:#111>(</span><span style=color:#75af00>_0x59b7d7</span><span style=color:#111>(</span><span style=color:#ae81ff>0x126</span><span style=color:#111>))</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>0x8</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#75af00>_0x28ad51</span> <span style=color:#f92672>===</span> <span style=color:#75af00>_0x1a5714</span><span style=color:#111>)</span> <span style=color:#00a8c8>break</span><span style=color:#111>;</span> <span style=color:#00a8c8>else</span> <span style=color:#75af00>_0x75200a</span><span style=color:#111>[</span><span style=color:#d88200>&#39;push&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x75200a</span><span style=color:#111>[</span><span style=color:#d88200>&#39;shift&#39;</span><span style=color:#111>]());</span>   <span style=color:#75715e>// 对数组内变量做移位操作 [2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#111>}</span> <span style=color:#00a8c8>catch</span> <span style=color:#111>(</span><span style=color:#75af00>_0x4accb5</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x75200a</span><span style=color:#111>[</span><span style=color:#d88200>&#39;push&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x75200a</span><span style=color:#111>[</span><span style=color:#d88200>&#39;shift&#39;</span><span style=color:#111>]());</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}(</span><span style=color:#75af00>_0x3b94</span><span style=color:#111>,</span> <span style=color:#ae81ff>0x93154</span><span style=color:#111>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x1e16</span><span style=color:#111>(</span><span style=color:#75af00>_0xf3f526</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3900a2</span><span style=color:#111>)</span> <span style=color:#111>{</span>    <span style=color:#75715e>// 解密函数 [3]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x3b9493</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3b94</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x1e16</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>_0x1e16b4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x52b1ed</span><span style=color:#111>)</span> <span style=color:#111>{</span>	<span style=color:#75715e>// 仍旧是嵌套 核心执行部分在这里
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75af00>_0x1e16b4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x1e16b4</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x11e</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x17070a</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3b9493</span><span style=color:#111>[</span><span style=color:#75af00>_0x1e16b4</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x17070a</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>},</span> <span style=color:#75af00>_0x1e16</span><span style=color:#111>(</span><span style=color:#75af00>_0xf3f526</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3900a2</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>hi</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x2ffbfb</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x1e16</span><span style=color:#111>;</span>	<span style=color:#75715e>// 再次替换变量名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75af00>console</span><span style=color:#111>[</span><span style=color:#75af00>_0x2ffbfb</span><span style=color:#111>(</span><span style=color:#ae81ff>0x123</span><span style=color:#111>)](</span><span style=color:#75af00>_0x2ffbfb</span><span style=color:#111>(</span><span style=color:#ae81ff>0x125</span><span style=color:#111>));</span>    <span style=color:#75715e>// 加密后的函数 [4]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>hi</span><span style=color:#111>();</span>
</span></span></code></pre></div><p>但仔细看每一个存在差异的地方就能发现改动是有限的，核心逻辑上并没有太大区别，修改后的脚本（也仅有两处需要改）：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>re</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>execjs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>decrypt</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;&#39;[1] + [2] + [3]&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>decrypt_func</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;*见下注&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>ctx</span> <span style=color:#f92672>=</span> <span style=color:#111>execjs</span><span style=color:#f92672>.</span><span style=color:#111>compile</span><span style=color:#111>(</span><span style=color:#111>decrypt</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;a.js&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#111>code</span> <span style=color:#f92672>=</span> <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#111>code</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>set</span><span style=color:#111>(</span><span style=color:#111>re</span><span style=color:#f92672>.</span><span style=color:#111>findall</span><span style=color:#111>(</span><span style=color:#111>decrypt_func</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\([\s\S]+?\)&#39;</span><span style=color:#111>,</span> <span style=color:#111>code</span><span style=color:#111>)):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>args</span> <span style=color:#f92672>=</span> <span style=color:#111>re</span><span style=color:#f92672>.</span><span style=color:#111>findall</span><span style=color:#111>(</span><span style=color:#d88200>&#39;\(([\s\S]+?)\)&#39;</span><span style=color:#111>,</span> <span style=color:#111>i</span><span style=color:#111>)[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#111>arg1</span> <span style=color:#f92672>=</span> <span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#111>args</span><span style=color:#f92672>.</span><span style=color:#111>split</span><span style=color:#111>(</span><span style=color:#d88200>&#39;,&#39;</span><span style=color:#111>)[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#111>_res</span> <span style=color:#f92672>=</span> <span style=color:#111>ctx</span><span style=color:#f92672>.</span><span style=color:#111>call</span><span style=color:#111>(</span><span style=color:#111>decrypt_func</span><span style=color:#111>,</span> <span style=color:#111>arg1</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#111>res</span><span style=color:#f92672>.</span><span style=color:#111>replace</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#d88200>&#34;&#39;&#34;</span> <span style=color:#f92672>+</span> <span style=color:#111>_res</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;&#39;&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>res</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>注：由于最后解密的部分又重新替换了个名字，所以要么在js处进行替换 要么在我们解密脚本中进行替换，结果是一样的</p><p>当然，这里展示的只是一个非常简单的单一函数Ob混淆后再解混淆的实例，实际情况要更复杂更麻烦，建议直接用工具嗦~</p><h2 id=添加hook>添加hook</h2><h3 id=油猴>油猴</h3><p>一个简单的在cookie生成处下断点的例子</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#d88200>&#39;use strict&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>Object</span><span style=color:#111>.</span><span style=color:#75af00>defineProperty</span><span style=color:#111>(</span><span style=color:#111>document</span><span style=color:#111>,</span><span style=color:#d88200>&#39;cookie&#39;</span><span style=color:#111>,{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>set</span><span style=color:#f92672>:</span><span style=color:#00a8c8>function</span><span style=color:#111>(</span><span style=color:#75af00>val</span><span style=color:#111>){</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>debugger</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span> <span style=color:#75af00>val</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>});})();</span>
</span></span></code></pre></div><p>油猴前面的注释有其特殊的含义，主要注意<code>@match</code>，它确定了这段代码的作用域 支持正则</p><h3 id=浏览器插件>浏览器插件</h3><h2 id=对js进行astjson转换>对js进行ast/json转换</h2><ul><li>js2ast: <a href=https://astexplorer.net/>https://astexplorer.net/</a></li><li>js2json</li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// js2json.js
</span></span></span><span style=display:flex><span><span style=color:#75715e>// cmd: node js2json &lt;jsfile&gt; &lt;outjsonfile&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>const</span> <span style=color:#75af00>fs</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;fs&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>esprima</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;esprima&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>input_text</span> <span style=color:#f92672>=</span> <span style=color:#75af00>process</span><span style=color:#111>.</span><span style=color:#75af00>argv</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>output_text</span> <span style=color:#f92672>=</span> <span style=color:#75af00>process</span><span style=color:#111>.</span><span style=color:#75af00>argv</span><span style=color:#111>[</span><span style=color:#ae81ff>3</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>data</span> <span style=color:#f92672>=</span> <span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>readFileSync</span><span style=color:#111>(</span><span style=color:#75af00>input_text</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>ast</span> <span style=color:#f92672>=</span> <span style=color:#75af00>esprima</span><span style=color:#111>.</span><span style=color:#75af00>parseScript</span><span style=color:#111>(</span><span style=color:#75af00>data</span><span style=color:#111>.</span><span style=color:#75af00>toString</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>ast_to_json</span> <span style=color:#f92672>=</span> <span style=color:#75af00>JSON</span><span style=color:#111>.</span><span style=color:#75af00>stringify</span><span style=color:#111>(</span><span style=color:#75af00>ast</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>writeFileSync</span><span style=color:#111>(</span><span style=color:#75af00>output_text</span><span style=color:#111>,</span> <span style=color:#75af00>ast_to_json</span><span style=color:#111>)</span>
</span></span></code></pre></div><ul><li>json2js</li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// json2js
</span></span></span><span style=display:flex><span><span style=color:#75715e>// cmd: node json2js &lt;jsonfile&gt; &lt;outjsfile&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>const</span> <span style=color:#75af00>fs</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;fs&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>escodegen</span> <span style=color:#f92672>=</span> <span style=color:#75af00>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;escodegen&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>input_text</span> <span style=color:#f92672>=</span> <span style=color:#75af00>process</span><span style=color:#111>.</span><span style=color:#75af00>argv</span><span style=color:#111>[</span><span style=color:#ae81ff>2</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>output_text</span> <span style=color:#f92672>=</span> <span style=color:#75af00>process</span><span style=color:#111>.</span><span style=color:#75af00>argv</span><span style=color:#111>[</span><span style=color:#ae81ff>3</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>data</span> <span style=color:#f92672>=</span> <span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>readFileSync</span><span style=color:#111>(</span><span style=color:#75af00>input_text</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>ast</span> <span style=color:#f92672>=</span> <span style=color:#75af00>JSON</span><span style=color:#111>.</span><span style=color:#75af00>parse</span><span style=color:#111>(</span><span style=color:#75af00>data</span><span style=color:#111>.</span><span style=color:#75af00>toString</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>const</span> <span style=color:#75af00>code</span> <span style=color:#f92672>=</span> <span style=color:#75af00>escodegen</span><span style=color:#111>.</span><span style=color:#75af00>generate</span><span style=color:#111>(</span><span style=color:#75af00>ast</span><span style=color:#111>,</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>format</span><span style=color:#f92672>:</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>compact</span><span style=color:#f92672>:</span> <span style=color:#00a8c8>true</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>escapeless</span><span style=color:#f92672>:</span> <span style=color:#00a8c8>true</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75af00>fs</span><span style=color:#111>.</span><span style=color:#75af00>writeFileSync</span><span style=color:#111>(</span><span style=color:#75af00>output_text</span><span style=color:#111>,</span> <span style=color:#75af00>code</span><span style=color:#111>)</span>
</span></span></code></pre></div><h2 id=切分js>切分js</h2><ul><li><p>转AST进行操作</p></li><li><p>可以先对js转json，再操作json</p></li></ul><p>举例：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node js2json 1.js 1.json&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#111>node</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>left_node</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;Program&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>:</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][:</span><span style=color:#ae81ff>3</span><span style=color:#111>],</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;sourceType&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;script&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>right_node</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;Program&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>:</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>3</span><span style=color:#111>:],</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;sourceType&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;script&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f1</span><span style=color:#111>,</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_right.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f2</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#111>f1</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>left_node</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>f2</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>right_node</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left.json 1_left.js&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_right.json 1_right.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><h2 id=execjs库相关问题>execjs库相关问题</h2><p>如果遇到编码相关问题，请修改subprocess.py中<code>__init__</code>方法中的encoding参数为&rsquo;utf-8'</p><p>！！！但之后记得改回来！以免影响到其他库的正常运行</p><h2 id=requests库tricks>requests库tricks</h2><h3 id=确保headers顺序不变>确保headers顺序不变</h3><p>用<code>requests.Session()</code>对象，对这个session对象设置headers，还能减少后续继续赋值cookie的过程</p><h3 id=cookie转字典>cookie转字典</h3><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>cookie_dict</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>utils</span><span style=color:#f92672>.</span><span style=color:#111>dict_from_cookiejar</span><span style=color:#111>(</span><span style=color:#111>response</span><span style=color:#f92672>.</span><span style=color:#111>cookies</span><span style=color:#111>)</span>
</span></span></code></pre></div><h2 id=猿人学1---js混淆-源码乱码>猿人学1 - js混淆 源码乱码</h2><blockquote><p><a href=https://match.yuanrenxue.com/match/1>https://match.yuanrenxue.com/match/1</a></p><p>题目要求：抓取所有（5页）机票的价格，并计算所有机票价格的平均值，填入答案</p></blockquote><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221215175204997.png alt=image-20221215175204997></p><p><del>首先把人力计算的路堵死了（</del></p><p>观察请求，第一页内容中机票价格的部分来自于</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>GET /api/match/1?m=a5884f0516dd56ce8282ddcc1ede907c%E4%B8%A81671196895 HTTP/2
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Host: match.yuanrenxue.com
</span></span></span></code></pre></div><p>也就是<code>/api/match/&lt;page>?m=&lt;length 32>丨&lt;length 10 timestamp(s)></code>，末尾存在时间戳限制，前一个一看就像md5</p><p>如何定位m的生成？直接搜<code>m = </code>，<code>丨</code> 甚至是<code>/api/match</code>都没找到；我们在网络部分来找到它的发起程序</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221215213810415.png alt=image-20221215213810415></p><p>看着代码很复杂，全是混淆，但是在开头点了断点没几步就出结果了……</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221215214022138.png alt=image-20221215214022138></p><p>这里<code>_0x5d83a3</code>正是我们要的对象，包含m，也反向说明了加密部分在1到4行之内已经完成了，简化如下</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x2268f9</span> <span style=color:#f92672>=</span> <span style=color:#111>Date</span><span style=color:#111>[</span><span style=color:#d88200>&#39;parse&#39;</span><span style=color:#111>](</span><span style=color:#00a8c8>new</span> <span style=color:#111>Date</span><span style=color:#111>())</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>100000000</span>  <span style=color:#75715e>// 时间戳
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#111>,</span> <span style=color:#75af00>_0x57feae</span> <span style=color:#f92672>=</span> <span style=color:#75af00>oo0O0</span><span style=color:#111>(</span><span style=color:#75af00>_0x2268f9</span><span style=color:#111>[</span><span style=color:#d88200>&#39;toString&#39;</span><span style=color:#111>]())</span> <span style=color:#f92672>+</span> <span style=color:#111>window</span><span style=color:#111>[</span><span style=color:#d88200>&#39;f&#39;</span><span style=color:#111>];</span> <span style=color:#75715e>// md5部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>const</span> <span style=color:#75af00>_0x5d83a3</span> <span style=color:#f92672>=</span> <span style=color:#111>{};</span>
</span></span><span style=display:flex><span><span style=color:#75af00>_0x5d83a3</span><span style=color:#111>[</span><span style=color:#d88200>&#39;m&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x57feae</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\u4e28&#39;</span> <span style=color:#f92672>+</span> <span style=color:#75af00>_0x2268f9</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span><span style=color:#111>;</span>
</span></span></code></pre></div><p>时间戳部分很好说，md5部分有个oo0O0，打断点发现这是在html里的script中定义的</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221215220246973.png alt=image-20221215220246973></p><p>拖出来一看好家伙，一顿操作猛如虎 最后<code>return ''</code>？？？</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>oo0O0</span><span style=color:#111>(</span><span style=color:#75af00>mw</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>b</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>var</span> <span style=color:#75af00>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#75af00>len</span> <span style=color:#f92672>=</span> <span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>a</span><span style=color:#111>.</span><span style=color:#75af00>length</span><span style=color:#111>;</span> <span style=color:#75af00>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>len</span><span style=color:#111>;</span> <span style=color:#75af00>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>log</span><span style=color:#111>(</span><span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>a</span><span style=color:#111>[</span><span style=color:#75af00>i</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>b</span> <span style=color:#f92672>+=</span> <span style=color:#111>String</span><span style=color:#111>[</span><span style=color:#75af00>e</span> <span style=color:#f92672>+</span> <span style=color:#75af00>g</span><span style=color:#111>](</span><span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>a</span><span style=color:#111>[</span><span style=color:#75af00>i</span><span style=color:#111>][</span><span style=color:#75af00>f</span> <span style=color:#f92672>+</span> <span style=color:#75af00>h</span><span style=color:#111>]()</span> <span style=color:#f92672>-</span> <span style=color:#75af00>i</span> <span style=color:#f92672>-</span> <span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>c</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>U</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#d88200>&#39;W5r5W6VdIHZcT8kU&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;WQ8CWRaxWQirAW==&#39;</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>J</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>o</span><span style=color:#111>,</span> <span style=color:#75af00>E</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75af00>o</span> <span style=color:#f92672>=</span> <span style=color:#75af00>o</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>var</span> <span style=color:#75af00>N</span> <span style=color:#f92672>=</span> <span style=color:#75af00>U</span><span style=color:#111>[</span><span style=color:#75af00>o</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;bSSGte&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>===</span> <span style=color:#00a8c8>undefined</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>var</span> <span style=color:#75af00>Y</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>w</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>var</span> <span style=color:#75af00>m</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>T</span> <span style=color:#f92672>=</span> <span style=color:#111>String</span><span style=color:#111>(</span><span style=color:#75af00>w</span><span style=color:#111>)[</span><span style=color:#d88200>&#39;replace&#39;</span><span style=color:#111>](</span><span style=color:#d88200>/=+$/</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>var</span> <span style=color:#75af00>A</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>var</span> <span style=color:#75af00>C</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>,</span> <span style=color:#75af00>b</span><span style=color:#111>,</span> <span style=color:#75af00>W</span><span style=color:#111>,</span> <span style=color:#75af00>l</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span> <span style=color:#75af00>W</span> <span style=color:#f92672>=</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>l</span><span style=color:#f92672>++</span><span style=color:#111>);</span> <span style=color:#f92672>~</span><span style=color:#75af00>W</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>(</span><span style=color:#75af00>b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>C</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x4</span> <span style=color:#f92672>?</span> <span style=color:#75af00>b</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x40</span> <span style=color:#f92672>+</span> <span style=color:#75af00>W</span> <span style=color:#f92672>:</span> <span style=color:#75af00>W</span><span style=color:#111>,</span> <span style=color:#75af00>C</span><span style=color:#f92672>++</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x4</span><span style=color:#111>)</span> <span style=color:#f92672>?</span> <span style=color:#75af00>A</span> <span style=color:#f92672>+=</span> <span style=color:#111>String</span><span style=color:#111>[</span><span style=color:#d88200>&#39;fromCharCode&#39;</span><span style=color:#111>](</span><span style=color:#ae81ff>0xff</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>b</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#111>(</span><span style=color:#f92672>-</span><span style=color:#ae81ff>0x2</span> <span style=color:#f92672>*</span> <span style=color:#75af00>C</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0x6</span><span style=color:#111>))</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>W</span> <span style=color:#f92672>=</span> <span style=color:#75af00>m</span><span style=color:#111>[</span><span style=color:#d88200>&#39;indexOf&#39;</span><span style=color:#111>](</span><span style=color:#75af00>W</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                <span style=color:#111>}</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>return</span> <span style=color:#75af00>A</span>
</span></span><span style=display:flex><span>            <span style=color:#111>};</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>var</span> <span style=color:#75af00>t</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span> <span style=color:#111>(</span><span style=color:#75af00>w</span><span style=color:#111>,</span> <span style=color:#75af00>m</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>var</span> <span style=color:#75af00>T</span> <span style=color:#f92672>=</span> <span style=color:#111>[],</span> <span style=color:#75af00>A</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>,</span> <span style=color:#75af00>C</span><span style=color:#111>,</span> <span style=color:#75af00>b</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>,</span> <span style=color:#75af00>W</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>                <span style=color:#75af00>w</span> <span style=color:#f92672>=</span> <span style=color:#75af00>Y</span><span style=color:#111>(</span><span style=color:#75af00>w</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>var</span> <span style=color:#75af00>R</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>,</span> <span style=color:#75af00>v</span> <span style=color:#f92672>=</span> <span style=color:#75af00>w</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span> <span style=color:#75af00>R</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>v</span><span style=color:#111>;</span> <span style=color:#75af00>R</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>W</span> <span style=color:#f92672>+=</span> <span style=color:#d88200>&#39;%&#39;</span> <span style=color:#f92672>+</span> <span style=color:#111>(</span><span style=color:#d88200>&#39;00&#39;</span> <span style=color:#f92672>+</span> <span style=color:#75af00>w</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charCodeAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>R</span><span style=color:#111>)[</span><span style=color:#d88200>&#39;toString&#39;</span><span style=color:#111>](</span><span style=color:#ae81ff>0x10</span><span style=color:#111>))[</span><span style=color:#d88200>&#39;slice&#39;</span><span style=color:#111>](</span><span style=color:#f92672>-</span><span style=color:#ae81ff>0x2</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                <span style=color:#111>}</span>
</span></span><span style=display:flex><span>                <span style=color:#75af00>w</span> <span style=color:#f92672>=</span> <span style=color:#111>decodeURIComponent</span><span style=color:#111>(</span><span style=color:#75af00>W</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>var</span> <span style=color:#75af00>l</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>l</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span> <span style=color:#75af00>l</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x100</span><span style=color:#111>;</span> <span style=color:#75af00>l</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>l</span>
</span></span><span style=display:flex><span>                <span style=color:#111>}</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>l</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span> <span style=color:#75af00>l</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0x100</span><span style=color:#111>;</span> <span style=color:#75af00>l</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>A</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#75af00>A</span> <span style=color:#f92672>+</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>]</span> <span style=color:#f92672>+</span> <span style=color:#75af00>m</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charCodeAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>l</span> <span style=color:#f92672>%</span> <span style=color:#75af00>m</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>]))</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x100</span><span style=color:#111>,</span> <span style=color:#75af00>C</span> <span style=color:#f92672>=</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>],</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>A</span><span style=color:#111>],</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>A</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>C</span>
</span></span><span style=display:flex><span>                <span style=color:#111>}</span>
</span></span><span style=display:flex><span>                <span style=color:#75af00>l</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>,</span> <span style=color:#75af00>A</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>var</span> <span style=color:#75af00>L</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0</span><span style=color:#111>;</span> <span style=color:#75af00>L</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>w</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span> <span style=color:#75af00>L</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>l</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#75af00>l</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x1</span><span style=color:#111>)</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x100</span><span style=color:#111>,</span> <span style=color:#75af00>A</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#75af00>A</span> <span style=color:#f92672>+</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>])</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x100</span><span style=color:#111>,</span> <span style=color:#75af00>C</span> <span style=color:#f92672>=</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>],</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>A</span><span style=color:#111>],</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>A</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>C</span><span style=color:#111>,</span> <span style=color:#75af00>b</span> <span style=color:#f92672>+=</span> <span style=color:#111>String</span><span style=color:#111>[</span><span style=color:#d88200>&#39;fromCharCode&#39;</span><span style=color:#111>](</span><span style=color:#75af00>w</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charCodeAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>L</span><span style=color:#111>)</span> <span style=color:#f92672>^</span> <span style=color:#75af00>T</span><span style=color:#111>[(</span><span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>l</span><span style=color:#111>]</span> <span style=color:#f92672>+</span> <span style=color:#75af00>T</span><span style=color:#111>[</span><span style=color:#75af00>A</span><span style=color:#111>])</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>0x100</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>                <span style=color:#111>}</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>return</span> <span style=color:#75af00>b</span>
</span></span><span style=display:flex><span>            <span style=color:#111>};</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;luAabU&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>t</span><span style=color:#111>,</span> <span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;qlVPZg&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>{},</span> <span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;bSSGte&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!!</span><span style=color:#111>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>var</span> <span style=color:#75af00>H</span> <span style=color:#f92672>=</span> <span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;qlVPZg&#39;</span><span style=color:#111>][</span><span style=color:#75af00>o</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span> <span style=color:#75af00>H</span> <span style=color:#f92672>===</span> <span style=color:#00a8c8>undefined</span> <span style=color:#f92672>?</span> <span style=color:#111>(</span><span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;TUDBIJ&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>===</span> <span style=color:#00a8c8>undefined</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#111>(</span><span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;TUDBIJ&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!!</span><span style=color:#111>[]),</span> <span style=color:#75af00>N</span> <span style=color:#f92672>=</span> <span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;luAabU&#39;</span><span style=color:#111>](</span><span style=color:#75af00>N</span><span style=color:#111>,</span> <span style=color:#75af00>E</span><span style=color:#111>),</span> <span style=color:#75af00>J</span><span style=color:#111>[</span><span style=color:#d88200>&#39;qlVPZg&#39;</span><span style=color:#111>][</span><span style=color:#75af00>o</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>N</span><span style=color:#111>)</span> <span style=color:#f92672>:</span> <span style=color:#75af00>N</span> <span style=color:#f92672>=</span> <span style=color:#75af00>H</span><span style=color:#111>,</span> <span style=color:#75af00>N</span>
</span></span><span style=display:flex><span>    <span style=color:#111>};</span>
</span></span><span style=display:flex><span>    <span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#75af00>atob</span><span style=color:#111>(</span><span style=color:#111>window</span><span style=color:#111>[</span><span style=color:#d88200>&#39;b&#39;</span><span style=color:#111>])[</span><span style=color:#75af00>J</span><span style=color:#111>(</span><span style=color:#d88200>&#39;0x0&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;]dQW&#39;</span><span style=color:#111>)](</span><span style=color:#75af00>J</span><span style=color:#111>(</span><span style=color:#d88200>&#39;0x1&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;GTu!&#39;</span><span style=color:#111>),</span> <span style=color:#d88200>&#39;\x27&#39;</span> <span style=color:#f92672>+</span> <span style=color:#75af00>mw</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x27&#39;</span><span style=color:#111>));</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span> <span style=color:#d88200>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></div><p>不过别急，<code>_0x57feae</code>由两部分组成，前面注定为空，后面还有<code>window.f</code>的操作空间，恰好return前面还有个万恶的eval，分段看一下内容：先看<code>atob(window['b'])</code>到底是个啥，控制台<code>copy(window.b)</code></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221215222925604.png alt=image-20221215222925604></p><p>拖出来一看有一堆加解密算法，而最后跟着一行</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>hex_md5</span><span style=color:#111>(</span><span style=color:#75af00>mwqqppz</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>后面的部分我们如法炮制，最后简化得到</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#75af00>atob</span><span style=color:#111>(</span><span style=color:#111>window</span><span style=color:#111>[</span><span style=color:#d88200>&#39;b&#39;</span><span style=color:#111>])[</span><span style=color:#d88200>&#39;replace&#39;</span><span style=color:#111>](</span><span style=color:#d88200>&#39;mwqqppz&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;\&#39;&#39;</span><span style=color:#f92672>+</span> <span style=color:#75af00>mw</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\&#39;&#39;</span><span style=color:#111>));</span>
</span></span></code></pre></div><p>这下看懂了，相当于执行</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>mw</span> <span style=color:#f92672>=</span> <span style=color:#111>Date</span><span style=color:#111>[</span><span style=color:#d88200>&#39;parse&#39;</span><span style=color:#111>](</span><span style=color:#00a8c8>new</span> <span style=color:#111>Date</span><span style=color:#111>())</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>100000000</span>
</span></span><span style=display:flex><span><span style=color:#111>window</span><span style=color:#111>.</span><span style=color:#75af00>f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>hex_md5</span><span style=color:#111>(</span><span style=color:#75af00>mw</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>前面一堆圈的函数就可以直接抛弃了；over，写脚本开始嗦~</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 2.js
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 省略atob(window[&#39;b&#39;])的一堆函数 在末尾加上下面的getResult()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>getResult</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>timestamp</span> <span style=color:#f92672>=</span> <span style=color:#111>Date</span><span style=color:#111>[</span><span style=color:#d88200>&#39;parse&#39;</span><span style=color:#111>](</span><span style=color:#00a8c8>new</span> <span style=color:#111>Date</span><span style=color:#111>())</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>100000000</span>  <span style=color:#75715e>// 时间戳
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>var</span> <span style=color:#75af00>md5</span> <span style=color:#f92672>=</span> <span style=color:#75af00>hex_md5</span><span style=color:#111>(</span><span style=color:#75af00>timestamp</span><span style=color:#111>[</span><span style=color:#d88200>&#39;toString&#39;</span><span style=color:#111>]());</span> <span style=color:#75715e>// md5部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>const</span> <span style=color:#75af00>res</span> <span style=color:#f92672>=</span> <span style=color:#111>{};</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>res</span><span style=color:#111>[</span><span style=color:#d88200>&#39;m&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>md5</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\u4e28&#39;</span> <span style=color:#f92672>+</span> <span style=color:#75af00>timestamp</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#75af00>console</span><span style=color:#111>.</span><span style=color:#75af00>log</span><span style=color:#111>(</span><span style=color:#75af00>res</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// { m: &#39;fac30e8b1f385e2eecd11154f33aa469丨1671216252&#39; }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>subprocess</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> <span style=color:#111>functools</span> <span style=color:#f92672>import</span> <span style=color:#111>partial</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>subprocess</span><span style=color:#f92672>.</span><span style=color:#111>Popen</span> <span style=color:#f92672>=</span> <span style=color:#111>partial</span><span style=color:#111>(</span><span style=color:#111>subprocess</span><span style=color:#f92672>.</span><span style=color:#111>Popen</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;2.js&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> <span style=color:#111>execjs</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> <span style=color:#111>requests</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>_url</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;https://match.yuanrenxue.com/api/match/&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>headers</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#d88200>&#39;User-Agent&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;yuanrenxue.project&#39;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>ctx</span> <span style=color:#f92672>=</span> <span style=color:#111>execjs</span><span style=color:#f92672>.</span><span style=color:#111>compile</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#111>sum</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#111>num</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>        <span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#111>ctx</span><span style=color:#f92672>.</span><span style=color:#111>call</span><span style=color:#111>(</span><span style=color:#d88200>&#39;getResult&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>value</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>get</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>_url</span><span style=color:#d88200>}</span><span style=color:#d88200>1?page=</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&amp;m=</span><span style=color:#d88200>{</span><span style=color:#111>res</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>headers</span><span style=color:#f92672>=</span><span style=color:#111>headers</span><span style=color:#111>)</span><span style=color:#f92672>.</span><span style=color:#111>json</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>j</span> <span style=color:#f92672>in</span> <span style=color:#111>value</span><span style=color:#111>[</span><span style=color:#d88200>&#39;data&#39;</span><span style=color:#111>]:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>sum</span> <span style=color:#f92672>+=</span> <span style=color:#111>j</span><span style=color:#111>[</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#111>num</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>sum</span> <span style=color:#f92672>/</span> <span style=color:#111>num</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># 4700.0</span>
</span></span></code></pre></div><h2 id=猿人学2---js-混淆-动态cookie1>猿人学2 - js 混淆 动态cookie1</h2><blockquote><p><a href=https://match.yuanrenxue.com/match/2>https://match.yuanrenxue.com/match/2</a></p><p>题目要求：提取全部5页发布日热度的值，计算所有值的<strong>加和</strong>,并提交答案 (感谢蔡老板为本题提供混淆方案)</p></blockquote><p>惯例抓包，这次信息在<code>/api/match/2?page=&lt;page_number></code>获取，并且请求的cookie有时效，在f12网络部分可以看出这是个ajax请求；还有个包是<code>/match/2</code>，诶 正好有巨量的混淆过的js代码，但我在网络部分并没有找到</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221216101556644.png alt=image-20221216101556644></p><p>*这里也可以借助hook的方式来打断点</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221216155159401.png alt=image-20221216155159401></p><p>或者直接不要在以往会never pause的地方过掉，也能在堆栈处停下</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221216155631382.png alt=image-20221216155631382></p><p>断下来之后找到cookie生成的地方（搜document）</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221216160528185.png alt=image-20221216160528185></p><p>把等于号后面的部分执行一下，可以确定这里就是cookie中m的生成处了</p><p>但是好像并没有什么卵用……因为我们还是搞不懂document[&lsquo;cookie&rsquo;]具体是怎么生成的，不过一眼Ob鉴定为烂 我们拖出来用解混淆的工具解一下，结果嘿！您猜怎么着！还是看不懂！</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 原
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>document</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>QO0qoO</span><span style=color:#111>,</span> <span style=color:#75af00>Qolo0q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>oqQoqO</span><span style=color:#111>,</span> <span style=color:#75af00>QIolqQ</span><span style=color:#111>)]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>QOoqQQ</span><span style=color:#111>,</span> <span style=color:#75af00>OILiQO</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x4c\x4b&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>LOILqL</span><span style=color:#111>,</span> <span style=color:#75af00>qIIo1Q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x4c\x4b&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>iLOo0O</span><span style=color:#111>,</span> <span style=color:#75af00>qqqOoQ</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x54\x78&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>oqOqLO</span><span style=color:#111>,</span> <span style=color:#75af00>qoO0i0</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x59\x45&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>IoOqoO</span><span style=color:#111>,</span> <span style=color:#75af00>qiQO1q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x51\x65&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qOqoL1</span><span style=color:#111>,</span> <span style=color:#75af00>LloilO</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x67\x4b&#39;</span><span style=color:#111>](</span><span style=color:#75af00>QOO0Qo</span><span style=color:#111>,</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#d88200>&#39;\x4c\x41\x74&#39;</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x54\x65&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x3c9ca8</span><span style=color:#111>)),</span> <span style=color:#75af00>iQoOQo</span><span style=color:#111>),</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>QiqQqQ</span><span style=color:#111>,</span> <span style=color:#75af00>lqO110</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x55\x4a&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x313b78</span><span style=color:#111>,</span> <span style=color:#75af00>_0x46f74d</span><span style=color:#111>)),</span> <span style=color:#75af00>OQiQQo</span><span style=color:#111>),</span> <span style=color:#75af00>_0x46f74d</span><span style=color:#111>),</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>oqlQq0</span><span style=color:#111>,</span> <span style=color:#75af00>IIo0I0</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x43\x73&#39;</span><span style=color:#111>]),</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>document</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qqLQOq</span><span style=color:#111>,</span> <span style=color:#75af00>iOiqII</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>q1IoqQ</span><span style=color:#111>,</span> <span style=color:#75af00>QQlLlq</span><span style=color:#111>)]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#d88200>&#39;\x4e\x74\x44&#39;</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x72\x43&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qqqQoq</span><span style=color:#111>,</span> <span style=color:#75af00>oqQiiO</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x6d\x65&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>Ioo0ql</span><span style=color:#111>,</span> <span style=color:#75af00>olq0Oq</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x6d\x65&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qOIqQi</span><span style=color:#111>,</span> <span style=color:#75af00>OOqIQi</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x72\x44&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>Q1qoqQ</span><span style=color:#111>,</span> <span style=color:#75af00>lILOOq</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x72\x44&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qOO1Q0</span><span style=color:#111>,</span> <span style=color:#75af00>oiqlQQ</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x72\x44&#39;</span><span style=color:#111>](</span><span style=color:#75af00>Ql1OO0</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#d88200>&#39;\x7a\x76\x67&#39;</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x6c\x77&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x3c9ca8</span><span style=color:#111>)),</span> <span style=color:#75af00>Qoqq0I</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>iqOiQ0</span><span style=color:#111>,</span> <span style=color:#75af00>QOiq0Q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x47\x6b&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x313b78</span><span style=color:#111>,</span> <span style=color:#75af00>_0x160e3a</span><span style=color:#111>)),</span> <span style=color:#75af00>lOo0QQ</span><span style=color:#111>),</span> <span style=color:#75af00>_0x160e3a</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qiOOiO</span><span style=color:#111>,</span> <span style=color:#75af00>liQIoQ</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;\x4e\x5a&#39;</span><span style=color:#111>]),</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 解混淆后
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>document</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>QO0qoO</span><span style=color:#111>,</span> <span style=color:#75af00>Qolo0q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>oqQoqO</span><span style=color:#111>,</span> <span style=color:#75af00>QIolqQ</span><span style=color:#111>)]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>QOoqQQ</span><span style=color:#111>,</span> <span style=color:#75af00>OILiQO</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;LK&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>LOILqL</span><span style=color:#111>,</span> <span style=color:#75af00>qIIo1Q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;LK&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>iLOo0O</span><span style=color:#111>,</span> <span style=color:#75af00>qqqOoQ</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;Tx&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>oqOqLO</span><span style=color:#111>,</span> <span style=color:#75af00>qoO0i0</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;YE&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>IoOqoO</span><span style=color:#111>,</span> <span style=color:#75af00>qiQO1q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;Qe&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qOqoL1</span><span style=color:#111>,</span> <span style=color:#75af00>LloilO</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;gK&#34;</span><span style=color:#111>](</span><span style=color:#75af00>QOO0Qo</span><span style=color:#111>,</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#d88200>&#34;LAtTe&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x3c9ca8</span><span style=color:#111>)),</span> <span style=color:#75af00>iQoOQo</span><span style=color:#111>),</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>QiqQqQ</span><span style=color:#111>,</span> <span style=color:#75af00>lqO110</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;UJ&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x313b78</span><span style=color:#111>,</span> <span style=color:#75af00>_0x46f74d</span><span style=color:#111>)),</span> <span style=color:#75af00>OQiQQo</span><span style=color:#111>),</span> <span style=color:#75af00>_0x46f74d</span><span style=color:#111>),</span> <span style=color:#75af00>_0x426597</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>oqlQq0</span><span style=color:#111>,</span> <span style=color:#75af00>IIo0I0</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;Cs&#34;</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>document</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qqLQOq</span><span style=color:#111>,</span> <span style=color:#75af00>iOiqII</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>q1IoqQ</span><span style=color:#111>,</span> <span style=color:#75af00>QQlLlq</span><span style=color:#111>)]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#d88200>&#34;NtDrC&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qqqQoq</span><span style=color:#111>,</span> <span style=color:#75af00>oqQiiO</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;me&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>Ioo0ql</span><span style=color:#111>,</span> <span style=color:#75af00>olq0Oq</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;me&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qOIqQi</span><span style=color:#111>,</span> <span style=color:#75af00>OOqIQi</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;rD&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>Q1qoqQ</span><span style=color:#111>,</span> <span style=color:#75af00>lILOOq</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;rD&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qOO1Q0</span><span style=color:#111>,</span> <span style=color:#75af00>oiqlQQ</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;rD&#34;</span><span style=color:#111>](</span><span style=color:#75af00>Ql1OO0</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#d88200>&#34;zvglw&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x3c9ca8</span><span style=color:#111>)),</span> <span style=color:#75af00>Qoqq0I</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>iqOiQ0</span><span style=color:#111>,</span> <span style=color:#75af00>QOiq0Q</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;Gk&#34;</span><span style=color:#111>](</span><span style=color:#75af00>_0x313b78</span><span style=color:#111>,</span> <span style=color:#75af00>_0x160e3a</span><span style=color:#111>)),</span> <span style=color:#75af00>lOo0QQ</span><span style=color:#111>),</span> <span style=color:#75af00>_0x160e3a</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5500bb</span><span style=color:#111>[</span><span style=color:#75af00>$dbsm_0x42c3</span><span style=color:#111>(</span><span style=color:#75af00>qiOOiO</span><span style=color:#111>,</span> <span style=color:#75af00>liQIoQ</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#34;NZ&#34;</span><span style=color:#111>]);</span>
</span></span></code></pre></div><p>这下呃呃了，只能手搓了😋</p><h3 id=简单处理>简单处理</h3><p>观察js，全部折叠以后会发现有6个部分，我们把js切分成前后两个部分并写入right.js（前三）和left.js（后三）中，便于后续处理</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221217225948100.png alt=image-20221217225948100></p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>var</span> <span style=color:#75af00>$dbsm_0x123c</span> <span style=color:#f92672>=</span> <span style=color:#111>[....]</span>	<span style=color:#75715e>// 乱序数组 [1]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>(</span><span style=color:#00a8c8>function</span><span style=color:#111>(....){})(</span><span style=color:#75af00>$dbsm_0x123c</span><span style=color:#111>,</span> <span style=color:#ae81ff>0x70</span><span style=color:#111>)</span>	<span style=color:#75715e>// 还原数组 [2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>var</span> <span style=color:#75af00>$dbsm_0x42c3</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span><span style=color:#111>(....){}</span>	<span style=color:#75715e>// 解密函数 [3]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#75af00>$dbsm_0x37d29a</span><span style=color:#111>(....))()</span>	<span style=color:#75715e>// 有用的函数？ [4]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>function</span> <span style=color:#75af00>$dbsm_0x1a0b2e</span><span style=color:#111>(....){}</span>	<span style=color:#75715e>// 有用的函数？ [5]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75af00>setInterval</span><span style=color:#111>(</span><span style=color:#00a8c8>function</span><span style=color:#111>(....){},</span> <span style=color:#ae81ff>0xfa0</span><span style=color:#111>)</span>	<span style=color:#75715e>// ? [6]
</span></span></span></code></pre></div><h3 id=变量回复>变量回复</h3><p>一般情况下调用解密函数<code>$dbsm_0x42c31</code>时传入的参数直接就是字符串，但我们可以看到[4]中调用[3]时会提前把变量赋值，再传入</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 通常
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75af00>res</span> <span style=color:#f92672>=</span> <span style=color:#75af00>func</span><span style=color:#111>(</span><span style=color:#d88200>&#39;abcd&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 本题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75af00>content</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;abcd&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75af00>res2</span> <span style=color:#f92672>=</span> <span style=color:#75af00>func</span><span style=color:#111>(</span><span style=color:#75af00>content</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>这样做一两处还好，太多的话我们肯定需要批量还原；那如何还原呢？我们借助AST，这里赋值的部分都是一个个AssignmentExpression节点</p><p>替换变量分为这几步</p><ul><li>定位这些节点所在的列表容器</li><li>提取变量名与字符串的映射关系 存入字典</li><li>替换变量为字符串</li><li>删除原变量</li></ul><p>我们要恢复的是[4]到[6]中的变量赋值，首先要从AST中找到它们：</p><ul><li>4：<code>node['expression']['callee']['body']['body'][0]['expression']['expressions']</code></li></ul><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103104153723.png alt=image-20230103104153723></p><ul><li>5: <code>node['body']['body'][0]['expression']['expressions']</code></li></ul><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103104616646.png alt=image-20230103104616646></p><ul><li>6: <code>node['expression']['arguments'][0]['body']['body'][0]['expression']['expressions']</code></li></ul><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103105001086.png alt=image-20230103105001086></p><p>通过这样的方式我们就可以找到4~6中所有的含<code>=</code>的赋值表达式，根据等号右边的类型还可以细分这样两种：</p><ul><li><code>expr['left']['type'] == 'Identifier'</code></li></ul><p>即<code>a=1</code>，我们直接把它加入全局字典即可</p><ul><li><code>expr['right']['type'] == 'BinaryExpression'</code></li></ul><p>即<code>a=1+1</code>，这种类型的需要我们再考虑right的二元表达式是什么样的，甚至需要继续迭代处理</p><p>代码如下：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>copy</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>val_dict</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>getExpr</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>val_dict</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 处理[4]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>expr_list</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>except</span> <span style=color:#75af00>TypeError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 处理[5]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>expr_list</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 处理[6]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>expr_list</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span> <span style=color:#111>expr_list</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>getMapping</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># [4]到[6]变量名称有重复 分开处理</span>
</span></span><span style=display:flex><span>    <span style=color:#111>expr_list</span> <span style=color:#f92672>=</span> <span style=color:#111>getExpr</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>expr</span> <span style=color:#f92672>in</span> <span style=color:#111>expr_list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;AssignmentExpression&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>continue</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#111>val_dict</span><span style=color:#111>[</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>elif</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;BinaryExpression&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#111>left</span> <span style=color:#f92672>=</span> <span style=color:#111>val_dict</span><span style=color:#111>[</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span>
</span></span><span style=display:flex><span>                <span style=color:#111>right</span> <span style=color:#f92672>=</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>new_node</span> <span style=color:#f92672>=</span> <span style=color:#111>copy</span><span style=color:#f92672>.</span><span style=color:#111>deepcopy</span><span style=color:#111>(</span><span style=color:#111>right</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>new_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>left</span><span style=color:#111>[</span><span style=color:#d88200>&#34;value&#34;</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200> </span><span style=color:#d88200>{</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#34;right&#34;</span><span style=color:#111>][</span><span style=color:#d88200>&#34;operator&#34;</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200> </span><span style=color:#d88200>{</span><span style=color:#111>right</span><span style=color:#111>[</span><span style=color:#d88200>&#34;value&#34;</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>val_dict</span><span style=color:#111>[</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>new_node</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>except</span> <span style=color:#75af00>TypeError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>exit</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>varReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 一次只还原一个部分 递归处理</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>  <span style=color:#75715e># 虽然arguments本身是列表 但会在下面再被捕捉 不在此处进入</span>
</span></span><span style=display:flex><span>            <span style=color:#111>varReload</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>!=</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>try</span><span style=color:#111>:</span>    <span style=color:#75715e># 捕获一个包含arguments属性的节点</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>])):</span> <span style=color:#75715e># 遍历参数</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>try</span><span style=color:#111>:</span>  <span style=color:#75715e># 捕获前面参数不匹配 而后面参数匹配的情况 确保每个参数都会被处理</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>val_dict</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>pass</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>raise</span> <span style=color:#75af00>KeyError</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>    <span style=color:#75715e># 无论结果如何 将该节点的所有属性再次递归 防止遗漏</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>            <span style=color:#111>varReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>delNode</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>expr_list</span> <span style=color:#f92672>=</span> <span style=color:#111>getExpr</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>expr_list</span><span style=color:#111>)</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>expr_list</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;AssignmentExpression&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>continue</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>expr_list</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span> <span style=color:#f92672>and</span> <span style=color:#111>expr_list</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>in</span> <span style=color:#111>(</span>
</span></span><span style=display:flex><span>                <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;BinaryExpression&#39;</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>del</span> <span style=color:#111>expr_list</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_right.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>item</span> <span style=color:#f92672>in</span> <span style=color:#111>data</span><span style=color:#111>[</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>]:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>getMapping</span><span style=color:#111>(</span><span style=color:#111>item</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>varReload</span><span style=color:#111>(</span><span style=color:#111>item</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>delNode</span><span style=color:#111>(</span><span style=color:#111>item</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_var_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_var_reload.json 1_left_var_reload.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>最终实现这样的效果：</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221218011540192.png alt=image-20221218011540192></p><h3 id=调用解密函数>调用解密函数</h3><p>我们已经成功把[4]到[6]中调用解密函数的部分都把变量换成了字符串（参数还原），接下来我们把用到解密函数的部分进行还原，还原的方式是找到解密函数<code>$dbsm_0x42c3</code>被调用的位置，获取参数，调用函数，替换返回值</p><p>在ast中观察，函数调用节点是CallExpression，内部callee的name是<code>$dbsm_0x42c3</code></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103140231617.png alt=image-20230103140231617></p><p>编写对应代码</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>execjs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>funcReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>,</span> <span style=color:#111>ctx</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>funcReload</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>ctx</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>!=</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;CallExpression&#39;</span><span style=color:#111>:</span>    <span style=color:#75715e># 捕获一个CallExpression节点</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#34;$dbsm_0x42c3&#34;</span><span style=color:#111>:</span>    <span style=color:#75715e># 确认函数名</span>
</span></span><span style=display:flex><span>                <span style=color:#111>arg_list</span> <span style=color:#f92672>=</span> <span style=color:#111>[]</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>]:</span> <span style=color:#75715e># 提取所有参数</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>if</span> <span style=color:#111>i</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>break</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>arg_list</span><span style=color:#f92672>.</span><span style=color:#111>append</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>[</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>value</span> <span style=color:#f92672>=</span> <span style=color:#111>ctx</span><span style=color:#f92672>.</span><span style=color:#111>call</span><span style=color:#111>(</span><span style=color:#d88200>&#39;$dbsm_0x42c3&#39;</span><span style=color:#111>,</span> <span style=color:#f92672>*</span><span style=color:#111>arg_list</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>value</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>new_node</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>:</span> <span style=color:#111>value</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>new_node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>pass</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>        <span style=color:#111>funcReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>],</span> <span style=color:#111>ctx</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_var_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left.js&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>ctx</span> <span style=color:#f92672>=</span> <span style=color:#111>execjs</span><span style=color:#f92672>.</span><span style=color:#111>compile</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#111>funcReload</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>,</span> <span style=color:#111>ctx</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_call_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_call_reload.json 1_left_call_reload.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>有个蜜汁彩蛋？由于这里乱码部分心机的加了中文字符，导致即使open处用utf-8还是会导致execjs解析失败，所以要修改subprocess.py中的encoding参数也为utf-8（切记 用完之后改回来 不然会影响其它库的正常工作的）</p><p>执行完的效果则是这样</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221218021235668.png alt=image-20221218021235668></p><p>在新生成的js中已经找不到<code>$dbsm_0x42c3</code>的身影了</p><h3 id=对象调用还原>对象调用还原</h3><h4 id=字符串拼接>字符串拼接</h4><p>字符串拼接部分的节点类型为BinaryExpression，且左右子节点都是Literal</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>concatString</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>concatString</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>!=</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;BinaryExpression&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span> <span style=color:#f92672>and</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>):</span>  <span style=color:#75715e># 当`+`左右任意一方为非Literal类型 则递归处理</span>
</span></span><span style=display:flex><span>            <span style=color:#111>concatString</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>            <span style=color:#111>concatString</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span> <span style=color:#f92672>and</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>new_node</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>:</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>+</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]}</span>
</span></span><span style=display:flex><span>            <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>            <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>new_node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>        <span style=color:#111>concatString</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_call_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#111>concatString</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_concat_string.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_concat_string.json 1_left_concat_string.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221218022613304.png alt=image-20221218022613304></p><h4 id=获取对象的属性字典>获取对象的属性字典</h4><p>观察恢复过字符串的js，我们可以发现函数中通常是这样操作的：</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221218151522895.png alt=image-20221218151522895></p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221218152556874.png alt=image-20221218152556874></p><p>先定义一个对象，再不断对其添加属性，难搞的是这些属性有的是字符串 有的是函数定义 有的又交叉其它对象的属性，之后再把这个对象赋值给另一个对象，再通过属性名进行引用，中间可能会再间接赋值给一个对象</p><p>我们接下来要做的是将这些属性被调用的地方，替换为对应的值/内容（类似之前的变量回复和解密函数回复），我们希望构造一个字典存储这样的映射关系</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>property_dict</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>	<span style=color:#d88200>&#39;obj1_name&#39;</span><span style=color:#111>:</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>		<span style=color:#d88200>&#39;property1_name&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;value1&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>		<span style=color:#d88200>&#39;property2_name&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;value2&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>....</span>
</span></span><span style=display:flex><span>	<span style=color:#111>},</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>....</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></div><p>接下来惯例ast中分析结构，最开始属性赋值的长长的部分都属于SequenceExpression，具体赋值的语句属于AssignmentExpression，且左边的类型是Identifier</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221218153009563.png alt=image-20221218153009563></p><p>编写对应代码：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>copy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>property_dict</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span><span style=color:#111>object_list</span> <span style=color:#f92672>=</span> <span style=color:#111>[]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>getPropertyMapping</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>getPropertyMapping</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>!=</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;SequenceExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 捕获一个表达式序列</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#f92672>-</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>]),</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>):</span>  <span style=color:#75715e># 一边正向遍历列表 一边删除 不产生KeyError</span>
</span></span><span style=display:flex><span>            <span style=color:#111>expr</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;AssignmentExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 捕获一个变量声明</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;ObjectExpression&#39;</span> <span style=color:#f92672>and</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;properties&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#111>[]:</span>  <span style=color:#75715e># 声明的是一个空对象</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>property_dict</span><span style=color:#111>[</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>object_list</span><span style=color:#f92672>.</span><span style=color:#111>append</span><span style=color:#111>(</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>del</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>continue</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>elif</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 一个对象 = 另一个对象</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>if</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>in</span> <span style=color:#111>property_dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                            <span style=color:#111>property_dict</span><span style=color:#111>[</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>property_dict</span><span style=color:#111>[</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span>
</span></span><span style=display:flex><span>                            <span style=color:#111>object_list</span><span style=color:#f92672>.</span><span style=color:#111>append</span><span style=color:#111>(</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>                            <span style=color:#00a8c8>del</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                            <span style=color:#00a8c8>continue</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>elif</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;MemberExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 属性声明</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>_object</span> <span style=color:#f92672>=</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;object&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>_property_name</span> <span style=color:#f92672>=</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;property&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>property_dict</span><span style=color:#111>[</span><span style=color:#111>_object</span><span style=color:#111>][</span><span style=color:#111>_property_name</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>del</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>continue</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#00a8c8>pass</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>expr</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>  <span style=color:#75715e># 将处理完的子节点的所有属性加入递归 避免遗漏</span>
</span></span><span style=display:flex><span>                <span style=color:#111>getPropertyMapping</span><span style=color:#111>(</span><span style=color:#111>expr</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>        <span style=color:#111>getPropertyMapping</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_concat_string.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#111>getPropertyMapping</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_property_delete.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_property_delete.json 1_left_property_delete.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>这一步我们生成了1_left_property_delete.json和1_left_property_delete.js中间文件，其中删除了前面提到的对象赋值的部分</p><h4 id=对象调用还原-1>对象调用还原</h4><p>我们获得了对象->属性->值的映射字典后，需要查找调用这些属性的地方进行还原（上一步我们都做了删除处理）</p><p>对象调用有两种方式，一种是函数式调用CallExpression类型的节点，一种是MemberExpression类型 直接返回字符串，而函数式调用的返回值有多种类型，需要进行不同的处理：</p><ol><li>返回字符串Literal</li></ol><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#d88200>&#39;a&#39;</span>
</span></span></code></pre></div><ol start=2><li>返回对象调用MemberExpression</li></ol><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#75af00>obj</span><span style=color:#111>[</span><span style=color:#d88200>&#39;a&#39;</span><span style=color:#111>](</span><span style=color:#75af00>c</span><span style=color:#111>,</span> <span style=color:#75af00>d</span><span style=color:#111>)</span>
</span></span></code></pre></div><ol start=3><li>返回二元表达式BinaryExpression</li></ol><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#75af00>a</span><span style=color:#f92672>*</span><span style=color:#75af00>b</span>
</span></span></code></pre></div><ol start=4><li>返回逻辑计算LogicalExpression</li></ol><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#75af00>a</span><span style=color:#f92672>||</span><span style=color:#75af00>b</span>
</span></span></code></pre></div><ol start=5><li>返回函数调用CallExpression</li></ol><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#75af00>a</span><span style=color:#111>(</span><span style=color:#75af00>b</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>对于1和2 直接替换内容即可，属于MemberExpression节点，但如果包裹在函数中需要另外考虑；对于3和4，都是由中间的符号和左右的标识组成，只要将调用时的两个参数替换 再将整个节点替换；对于5，可以同时提取形参名和实参节点，以调用对象时传参的顺序为标准 填入临时字典</p><p>编写对应代码：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>copy</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此处省略上一步获取属性字典的函数 执行时要加上 因为需要使用property_dict这个全局变量</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>propertyReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>propertyReload</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>!=</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;MemberExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 捕获一个属性调用节点</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>_obj</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;object&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#111>_property</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;property&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#111>new_node</span> <span style=color:#f92672>=</span> <span style=color:#111>property_dict</span><span style=color:#111>[</span><span style=color:#111>_obj</span><span style=color:#111>][</span><span style=color:#111>_property</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>new_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;FunctionExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 不是函数类型节点直接替换</span>
</span></span><span style=display:flex><span>                <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>                <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>new_node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                <span style=color:#111>propertyReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>pass</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;CallExpression&#39;</span> <span style=color:#f92672>or</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;MemberExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 函数式调用 且子节点callee类型为MemberExpression</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>raise</span> <span style=color:#75af00>KeyError</span>
</span></span><span style=display:flex><span>        <span style=color:#111>_obj</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;object&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>_property</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;property&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>func_node</span> <span style=color:#f92672>=</span> <span style=color:#111>property_dict</span><span style=color:#111>[</span><span style=color:#111>_obj</span><span style=color:#111>][</span><span style=color:#111>_property</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>            <span style=color:#111>propertyReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>param_list</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>[</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span> <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>func_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;params&#39;</span><span style=color:#111>]]</span>  <span style=color:#75715e># 形参</span>
</span></span><span style=display:flex><span>    <span style=color:#111>arg_list</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>]</span>  <span style=color:#75715e># 实参</span>
</span></span><span style=display:flex><span>    <span style=color:#111>param_arg_dict</span> <span style=color:#f92672>=</span> <span style=color:#111>dict</span><span style=color:#111>(</span><span style=color:#111>zip</span><span style=color:#111>(</span><span style=color:#111>param_list</span><span style=color:#111>,</span> <span style=color:#111>arg_list</span><span style=color:#111>))</span>  <span style=color:#75715e># 形参与实参对应字典</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>ret_node</span> <span style=color:#f92672>=</span> <span style=color:#111>copy</span><span style=color:#f92672>.</span><span style=color:#111>deepcopy</span><span style=color:#111>(</span><span style=color:#111>func_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span>  <span style=color:#75715e># 拷贝一份函数节点的返回值节点</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;ReturnStatement&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;有超过一行的函数体：</span><span style=color:#d88200>{</span><span style=color:#111>func_node</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>exit</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span> <span style=color:#f92672>or</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;MemberExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 实参直接替换形参 对应1, 2种情况被包裹在一个函数中再返回时</span>
</span></span><span style=display:flex><span>        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;BinaryExpression&#39;</span> <span style=color:#f92672>or</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;LogicalExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 对应3, 4种情况</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>param_arg_dict</span><span style=color:#111>[</span><span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>param_arg_dict</span><span style=color:#111>[</span><span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;CallExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 对应第五种情况</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#d88200>&#39;MemberExpression&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>func_name</span> <span style=color:#f92672>=</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>func_name</span> <span style=color:#f92672>in</span> <span style=color:#111>param_arg_dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>param_arg_dict</span><span style=color:#111>[</span><span style=color:#111>func_name</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>])):</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Identifier&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#111>arg_name</span> <span style=color:#f92672>=</span> <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>][</span><span style=color:#d88200>&#39;name&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                <span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;arguments&#39;</span><span style=color:#111>][</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>param_arg_dict</span><span style=color:#111>[</span><span style=color:#111>arg_name</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>ret_node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;argument&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;意料之外的函数返回值类型：</span><span style=color:#d88200>{</span><span style=color:#111>ret_node</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>exit</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 递归处理防止遗漏</span>
</span></span><span style=display:flex><span>    <span style=color:#111>propertyReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_property_delete.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>propertyReload</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_property_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf-8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_property_reload.json 1_left_property_reload.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>最终效果</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20221219021808232.png alt=image-20221219021808232></p><h3 id=分支流程判断>分支流程判断</h3><p>上一步生成的js文件中有很多多余的分支判断，比如上图中的<code>if('QcUHF' !== 'QcUHF')</code>，这样的bool判断是可以提前处理掉的，我们只需要递归找到这样的节点，判断其表达式中的bool值并决定是否保留此分支</p><p>代码如下：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>operator_dict</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#d88200>&#39;===&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;==&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;!==&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;!=&#39;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>ifReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#111>ifReload</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>!=</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;IfStatement&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 捕获一个分支语句</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;test&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;BinaryExpression&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 当判断内容为二元表达式时</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;test&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span> <span style=color:#f92672>and</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;test&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>:</span>  <span style=color:#75715e># 当表达式两侧均为Literal类型时</span>
</span></span><span style=display:flex><span>                <span style=color:#111>consequent</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;consequent&#39;</span><span style=color:#111>]</span>  <span style=color:#75715e># 当前分支下if的block</span>
</span></span><span style=display:flex><span>                <span style=color:#111>alternate</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;alternate&#39;</span><span style=color:#111>]</span>  <span style=color:#75715e># 当前分支下else的block</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>try</span><span style=color:#111>:</span>  <span style=color:#75715e># 执行表达式 根据执行结果保留block</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>if</span> <span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#34;&#39;</span><span style=color:#d88200>{</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;test&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;left&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39; </span><span style=color:#d88200>{</span><span style=color:#111>operator_dict</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;test&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;operator&#39;</span><span style=color:#111>]]</span><span style=color:#d88200>}</span><span style=color:#d88200> &#39;</span><span style=color:#d88200>{</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#d88200>&#39;test&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;&#34;</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>consequent</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>alternate</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>except</span> <span style=color:#75af00>KeyError</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;Unexcepted operator: </span><span style=color:#d88200>{</span><span style=color:#111>node</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>sys</span><span style=color:#f92672>.</span><span style=color:#111>exit</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>ifReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>        <span style=color:#111>ifReload</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_property_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#111>ifReload</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_if_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_if_reload.json 1_left_if_reload.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>执行结果：</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103164701409.png alt=image-20230103164701409></p><p>可以看到我们已经将不需要的分支去除掉了</p><h3 id=控制流平坦化>控制流平坦化</h3><p>虽然if被我们砍去了大半，但while+switch的组合还是留下了很多障碍</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103165127573.png alt=image-20230103165127573></p><p>如图，本来从上至下的执行顺序被人为控制，我们需要进行控制流平坦化处理来还原程序执行的真实顺序</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103165544743.png alt=image-20230103165544743></p><p>执行顺序在ExpressionStatement中，我们按执行顺序提取出cases对应的block，再替换整个node</p><p>代码如下：</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>os</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>def</span> <span style=color:#75af00>flowFlatten</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>list</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>flag</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>False</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>try</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>if</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;WhileStatement&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>var1</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                    <span style=color:#111>var2</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expression&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;expressions&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>                    <span style=color:#00a8c8>if</span> <span style=color:#111>var1</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;CallExpression&#39;</span> <span style=color:#f92672>and</span> <span style=color:#111>var2</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;type&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;Literal&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#111>flag</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>True</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>flag</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#00a8c8>raise</span> <span style=color:#75af00>KeyError</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>except</span> <span style=color:#111>(</span><span style=color:#75af00>KeyError</span><span style=color:#111>,</span> <span style=color:#75af00>TypeError</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>                <span style=color:#111>flowFlatten</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>elif</span> <span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>)</span> <span style=color:#f92672>==</span> <span style=color:#111>dict</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>for</span> <span style=color:#111>key</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>keys</span><span style=color:#111>():</span>
</span></span><span style=display:flex><span>            <span style=color:#111>flowFlatten</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#111>key</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>flow</span> <span style=color:#f92672>=</span> <span style=color:#111>var1</span><span style=color:#111>[</span><span style=color:#d88200>&#39;right&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;callee&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;object&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>split</span><span style=color:#111>(</span><span style=color:#d88200>&#39;|&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>cases</span> <span style=color:#f92672>=</span> <span style=color:#111>node</span><span style=color:#111>[</span><span style=color:#ae81ff>1</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#d88200>&#39;body&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>][</span><span style=color:#d88200>&#39;cases&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>    <span style=color:#111>results</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#111>cases</span><span style=color:#111>[</span><span style=color:#111>int</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)][</span><span style=color:#d88200>&#39;consequent&#39;</span><span style=color:#111>][</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span> <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>flow</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>clear</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#111>node</span><span style=color:#f92672>.</span><span style=color:#111>extend</span><span style=color:#111>(</span><span style=color:#111>results</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>node</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>flowFlatten</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>if</span> <span style=color:#111>__name__</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;__main__&#39;</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_if_reload.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>loads</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>())</span>
</span></span><span style=display:flex><span>    <span style=color:#111>flowFlatten</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;1_left_flow_flattening.json&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;w&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>write</span><span style=color:#111>(</span><span style=color:#111>json</span><span style=color:#f92672>.</span><span style=color:#111>dumps</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#111>os</span><span style=color:#f92672>.</span><span style=color:#111>system</span><span style=color:#111>(</span><span style=color:#d88200>&#39;node json2js 1_left_flow_flattening.json 1_left_flow_flattening.js&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>实现效果：</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103170512666.png alt=image-20230103170512666></p><h3 id=去除干扰项>去除干扰项</h3><p>此时程序已经比较方便阅读，能直接找到设置cookie的接口</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103170714330.png alt=image-20230103170714330></p><p>但还是无法直接运行这个js文件，因为有最后那个setInterval函数的干扰，同时还有混杂的干扰项</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103170857905.png alt=image-20230103170857905></p><p>以及第四部分<code>dbsm_0x37d29a</code>的若干参数，都是无用的，我们手动去除一下</p><p>另外<code>_0x3c9ca8</code>函数（以及众多函数）也都属于多余的干扰项，我们手动删去调用它的地方</p><p>最终得到的js:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#111>(</span><span style=color:#00a8c8>function</span> <span style=color:#75af00>$dbsm_0x37d29a</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b69d8</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3de4a1</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x448c2f</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#ae81ff>65535</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x5b69d8</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#111>(</span><span style=color:#ae81ff>65535</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x3de4a1</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#111>(</span><span style=color:#75af00>_0x5b69d8</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#111>(</span><span style=color:#75af00>_0x3de4a1</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#111>(</span><span style=color:#75af00>_0x448c2f</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>16</span><span style=color:#111>)</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>16</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>65535</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x448c2f</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x101700</span><span style=color:#111>(</span><span style=color:#75af00>_0x19c5f2</span><span style=color:#111>,</span> <span style=color:#75af00>_0x40c04f</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x19c5f2</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#75af00>_0x40c04f</span> <span style=color:#f92672>|</span> <span style=color:#75af00>_0x19c5f2</span> <span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>-</span> <span style=color:#75af00>_0x40c04f</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x4d9052</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ad611</span><span style=color:#111>,</span> <span style=color:#75af00>_0x12667c</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4e5444</span><span style=color:#111>,</span> <span style=color:#75af00>_0x21c32c</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ca7da</span><span style=color:#111>,</span> <span style=color:#75af00>_0x44626f</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x101700</span><span style=color:#111>(</span><span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x12667c</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ad611</span><span style=color:#111>),</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x21c32c</span><span style=color:#111>,</span> <span style=color:#75af00>_0x44626f</span><span style=color:#111>)),</span> <span style=color:#75af00>_0x2ca7da</span><span style=color:#111>),</span> <span style=color:#75af00>_0x4e5444</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x173d50</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1eb601</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3e80e6</span><span style=color:#111>,</span> <span style=color:#75af00>_0x27ae79</span><span style=color:#111>,</span> <span style=color:#75af00>_0x196272</span><span style=color:#111>,</span> <span style=color:#75af00>_0x352dd6</span><span style=color:#111>,</span> <span style=color:#75af00>_0x315a43</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x4d9052</span><span style=color:#111>(</span><span style=color:#75af00>_0x1eb601</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x3e80e6</span> <span style=color:#f92672>|</span> <span style=color:#f92672>~</span><span style=color:#75af00>_0x1eb601</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x27ae79</span><span style=color:#111>,</span> <span style=color:#75af00>_0x173d50</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1eb601</span><span style=color:#111>,</span> <span style=color:#75af00>_0x196272</span><span style=color:#111>,</span> <span style=color:#75af00>_0x352dd6</span><span style=color:#111>,</span> <span style=color:#75af00>_0x315a43</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x32a9d0</span><span style=color:#111>,</span> <span style=color:#75af00>_0x585bb5</span><span style=color:#111>,</span> <span style=color:#75af00>_0x19b9f2</span><span style=color:#111>,</span> <span style=color:#75af00>_0x53bbfb</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1cbfed</span><span style=color:#111>,</span> <span style=color:#75af00>_0x34200c</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5135ca</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x4d9052</span><span style=color:#111>(</span><span style=color:#75af00>_0x585bb5</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x53bbfb</span> <span style=color:#f92672>|</span> <span style=color:#75af00>_0x19b9f2</span> <span style=color:#f92672>&amp;</span> <span style=color:#f92672>~</span><span style=color:#75af00>_0x53bbfb</span><span style=color:#111>,</span> <span style=color:#75af00>_0x32a9d0</span><span style=color:#111>,</span> <span style=color:#75af00>_0x585bb5</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1cbfed</span><span style=color:#111>,</span> <span style=color:#75af00>_0x34200c</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5135ca</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x21cf21</span><span style=color:#111>(</span><span style=color:#75af00>_0x5f0db4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x560b61</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x45ae5c</span> <span style=color:#f92672>=</span> <span style=color:#111>[</span><span style=color:#ae81ff>99</span><span style=color:#111>,</span> <span style=color:#ae81ff>111</span><span style=color:#111>,</span> <span style=color:#ae81ff>110</span><span style=color:#111>,</span> <span style=color:#ae81ff>115</span><span style=color:#111>,</span> <span style=color:#ae81ff>111</span><span style=color:#111>,</span> <span style=color:#ae81ff>108</span><span style=color:#111>,</span> <span style=color:#ae81ff>101</span><span style=color:#111>],</span> <span style=color:#75af00>_0x7cdad8</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>_0x5d58e6</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x5d58e6</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>_0x45ae5c</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span> <span style=color:#75af00>_0x5d58e6</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                <span style=color:#111>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75af00>_0x7cdad8</span> <span style=color:#f92672>+=</span> <span style=color:#111>String</span><span style=color:#111>[</span><span style=color:#d88200>&#39;fromCharCode&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x45ae5c</span><span style=color:#111>[</span><span style=color:#75af00>_0x5d58e6</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>                <span style=color:#111>}</span>
</span></span><span style=display:flex><span>            <span style=color:#111>}</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x7cdad8</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x5c1f3b</span><span style=color:#111>,</span> <span style=color:#75af00>_0xdee360</span><span style=color:#111>,</span> <span style=color:#75af00>_0x251700</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2a047e</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4ea0af</span><span style=color:#111>,</span> <span style=color:#75af00>_0x62d9e8</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1edd4c</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x4d9052</span><span style=color:#111>(</span><span style=color:#75af00>_0xdee360</span> <span style=color:#f92672>^</span> <span style=color:#75af00>_0x251700</span> <span style=color:#f92672>^</span> <span style=color:#75af00>_0x2a047e</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5c1f3b</span><span style=color:#111>,</span> <span style=color:#75af00>_0xdee360</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4ea0af</span><span style=color:#111>,</span> <span style=color:#75af00>_0x62d9e8</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1edd4c</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x2afda5</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4cf1da</span><span style=color:#111>,</span> <span style=color:#75af00>_0x354d4e</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2c2702</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b938d</span><span style=color:#111>,</span> <span style=color:#75af00>_0x58d9fb</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b82c0</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x4d9052</span><span style=color:#111>(</span><span style=color:#75af00>_0x354d4e</span> <span style=color:#f92672>^</span> <span style=color:#111>(</span><span style=color:#75af00>_0x4cf1da</span> <span style=color:#f92672>|</span> <span style=color:#f92672>~</span><span style=color:#75af00>_0x2c2702</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2afda5</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4cf1da</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b938d</span><span style=color:#111>,</span> <span style=color:#75af00>_0x58d9fb</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b82c0</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x1a8c0e</span><span style=color:#111>(</span><span style=color:#75af00>_0x4b49f3</span><span style=color:#111>,</span> <span style=color:#75af00>_0x31923d</span><span style=color:#111>,</span> <span style=color:#75af00>_0xbd3204</span><span style=color:#111>,</span> <span style=color:#75af00>_0x693550</span><span style=color:#111>,</span> <span style=color:#75af00>_0x540797</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5dacc8</span><span style=color:#111>,</span> <span style=color:#75af00>_0x22f03d</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0x31923d</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>5</span><span style=color:#111>]</span> <span style=color:#f92672>|=</span> <span style=color:#ae81ff>128</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#75af00>_0x31923d</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>32</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#ae81ff>14</span> <span style=color:#f92672>+</span> <span style=color:#111>(</span><span style=color:#75af00>_0x31923d</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>64</span> <span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>9</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>4</span><span style=color:#111>)]</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x31923d</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1732584193</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>271733879</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1732584194</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1460850315</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span> <span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>16</span><span style=color:#111>)</span> <span style=color:#75af00>_0x693550</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x540797</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5dacc8</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x22f03d</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span><span style=color:#111>],</span> <span style=color:#ae81ff>7</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>680876936</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#ae81ff>12</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>389564586</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#ae81ff>17</span><span style=color:#111>,</span> <span style=color:#ae81ff>606105819</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span><span style=color:#111>],</span> <span style=color:#ae81ff>22</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1044525330</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span><span style=color:#111>],</span> <span style=color:#ae81ff>7</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>176418897</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span><span style=color:#111>],</span> <span style=color:#ae81ff>12</span><span style=color:#111>,</span> <span style=color:#ae81ff>1200080426</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>6</span><span style=color:#111>],</span> <span style=color:#ae81ff>17</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1473231341</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span><span style=color:#111>],</span> <span style=color:#ae81ff>22</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>45705983</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span><span style=color:#111>],</span> <span style=color:#ae81ff>7</span><span style=color:#111>,</span> <span style=color:#ae81ff>1770010416</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>9</span><span style=color:#111>],</span> <span style=color:#ae81ff>12</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1958414417</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span><span style=color:#111>],</span> <span style=color:#ae81ff>17</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>42063</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>11</span><span style=color:#111>],</span> <span style=color:#ae81ff>22</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1990404162</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span><span style=color:#111>],</span> <span style=color:#ae81ff>7</span><span style=color:#111>,</span> <span style=color:#ae81ff>1804603682</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>13</span><span style=color:#111>],</span> <span style=color:#ae81ff>12</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>40341101</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>14</span><span style=color:#111>],</span> <span style=color:#ae81ff>17</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1502882290</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5624ba</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span><span style=color:#111>],</span> <span style=color:#ae81ff>22</span><span style=color:#111>,</span> <span style=color:#ae81ff>1236535329</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#ae81ff>5</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>165796510</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>6</span><span style=color:#111>],</span> <span style=color:#ae81ff>9</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1069501632</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>11</span><span style=color:#111>],</span> <span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>643717713</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span><span style=color:#111>],</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>373897302</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span><span style=color:#111>],</span> <span style=color:#ae81ff>5</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>701558691</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span><span style=color:#111>],</span> <span style=color:#ae81ff>9</span><span style=color:#111>,</span> <span style=color:#ae81ff>38016083</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span><span style=color:#111>],</span> <span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>660478335</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span><span style=color:#111>],</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>405537848</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>9</span><span style=color:#111>],</span> <span style=color:#ae81ff>5</span><span style=color:#111>,</span> <span style=color:#ae81ff>568446438</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>14</span><span style=color:#111>],</span> <span style=color:#ae81ff>9</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1019803690</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span><span style=color:#111>],</span> <span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>187363961</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span><span style=color:#111>],</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#ae81ff>1163531501</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>13</span><span style=color:#111>],</span> <span style=color:#ae81ff>5</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1444681467</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#ae81ff>9</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>51403784</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span><span style=color:#111>],</span> <span style=color:#ae81ff>14</span><span style=color:#111>,</span> <span style=color:#ae81ff>1735328473</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x2d8b1d</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span><span style=color:#111>],</span> <span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1926607734</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span><span style=color:#111>],</span> <span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>378558</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span><span style=color:#111>],</span> <span style=color:#ae81ff>11</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>2022574463</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>11</span><span style=color:#111>],</span> <span style=color:#ae81ff>16</span><span style=color:#111>,</span> <span style=color:#ae81ff>1839030562</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>14</span><span style=color:#111>],</span> <span style=color:#ae81ff>23</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>35309556</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1530992060</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span><span style=color:#111>],</span> <span style=color:#ae81ff>11</span><span style=color:#111>,</span> <span style=color:#ae81ff>1272893353</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span><span style=color:#111>],</span> <span style=color:#ae81ff>16</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>155497632</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span><span style=color:#111>],</span> <span style=color:#ae81ff>23</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1094730640</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>13</span><span style=color:#111>],</span> <span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#ae81ff>681279174</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span><span style=color:#111>],</span> <span style=color:#ae81ff>11</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>358537222</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span><span style=color:#111>],</span> <span style=color:#ae81ff>16</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>722521979</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>6</span><span style=color:#111>],</span> <span style=color:#ae81ff>23</span><span style=color:#111>,</span> <span style=color:#ae81ff>76029189</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>9</span><span style=color:#111>],</span> <span style=color:#ae81ff>4</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>640364487</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span><span style=color:#111>],</span> <span style=color:#ae81ff>11</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>421815835</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span><span style=color:#111>],</span> <span style=color:#ae81ff>16</span><span style=color:#111>,</span> <span style=color:#ae81ff>530742520</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x3316ae</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#ae81ff>23</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>995338651</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span><span style=color:#111>],</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>198630844</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span><span style=color:#111>],</span> <span style=color:#ae81ff>10</span><span style=color:#111>,</span> <span style=color:#ae81ff>1126891415</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>14</span><span style=color:#111>],</span> <span style=color:#ae81ff>15</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1416354905</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span><span style=color:#111>],</span> <span style=color:#ae81ff>21</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>57434055</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>12</span><span style=color:#111>],</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>1700485571</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span><span style=color:#111>],</span> <span style=color:#ae81ff>10</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1894986606</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>10</span><span style=color:#111>],</span> <span style=color:#ae81ff>15</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1051523</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#111>],</span> <span style=color:#ae81ff>21</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>2054922799</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>8</span><span style=color:#111>],</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#ae81ff>1873313359</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>15</span><span style=color:#111>],</span> <span style=color:#ae81ff>10</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>30611744</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>6</span><span style=color:#111>],</span> <span style=color:#ae81ff>15</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1560198380</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>13</span><span style=color:#111>],</span> <span style=color:#ae81ff>21</span><span style=color:#111>,</span> <span style=color:#ae81ff>1309151649</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span><span style=color:#111>],</span> <span style=color:#ae81ff>6</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>145523070</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>11</span><span style=color:#111>],</span> <span style=color:#ae81ff>10</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1120210379</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span><span style=color:#111>],</span> <span style=color:#ae81ff>15</span><span style=color:#111>,</span> <span style=color:#ae81ff>718787259</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x160619</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4b49f3</span><span style=color:#111>[</span><span style=color:#75af00>_0xbd3204</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>9</span><span style=color:#111>],</span> <span style=color:#ae81ff>21</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>343485441</span><span style=color:#111>),</span> <span style=color:#75af00>_0x5b3e7f</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x693550</span><span style=color:#111>),</span> <span style=color:#75af00>_0x2ee10b</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x540797</span><span style=color:#111>),</span> <span style=color:#75af00>_0x30b068</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5dacc8</span><span style=color:#111>),</span> <span style=color:#75af00>_0x3a35a4</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x112208</span><span style=color:#111>(</span><span style=color:#75af00>_0x3a35a4</span><span style=color:#111>,</span> <span style=color:#75af00>_0x22f03d</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#111>[</span><span style=color:#75af00>_0x5b3e7f</span><span style=color:#111>,</span> <span style=color:#75af00>_0x2ee10b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x30b068</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3a35a4</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0xb8fd83</span><span style=color:#111>(</span><span style=color:#75af00>_0x28b0d4</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x18d4aa</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>,</span> <span style=color:#75af00>_0x630f0</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>*</span> <span style=color:#75af00>_0x28b0d4</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>_0x24362f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x24362f</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>_0x630f0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x24362f</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>8</span><span style=color:#111>)</span> <span style=color:#75af00>_0x18d4aa</span> <span style=color:#f92672>+=</span> <span style=color:#111>String</span><span style=color:#111>[</span><span style=color:#d88200>&#39;fromCharCode&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x28b0d4</span><span style=color:#111>[</span><span style=color:#75af00>_0x24362f</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>5</span><span style=color:#111>]</span> <span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#75af00>_0x24362f</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>32</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>255</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x18d4aa</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x44ecf2</span><span style=color:#111>(</span><span style=color:#75af00>_0x12f7d8</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x4a27a3</span> <span style=color:#f92672>=</span> <span style=color:#111>[];</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>_0x4a27a3</span><span style=color:#111>[(</span><span style=color:#75af00>_0x12f7d8</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>]</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2</span><span style=color:#111>)</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>void</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>_0x4a27a3</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span> <span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#75af00>_0x4a27a3</span><span style=color:#111>[</span><span style=color:#75af00>_0x4d24a7</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>var</span> <span style=color:#75af00>_0x4fa8f0</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>*</span> <span style=color:#75af00>_0x12f7d8</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>_0x4fa8f0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>8</span><span style=color:#111>)</span> <span style=color:#75af00>_0x4a27a3</span><span style=color:#111>[</span><span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>5</span><span style=color:#111>]</span> <span style=color:#f92672>|=</span> <span style=color:#111>(</span><span style=color:#ae81ff>255</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0x12f7d8</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charCodeAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>8</span><span style=color:#111>))</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#75af00>_0x4d24a7</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>32</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x4a27a3</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x57fdd5</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ace3b</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0xb8fd83</span><span style=color:#111>(</span><span style=color:#75af00>_0x1a8c0e</span><span style=color:#111>(</span><span style=color:#75af00>_0x44ecf2</span><span style=color:#111>(</span><span style=color:#75af00>_0x2ace3b</span><span style=color:#111>),</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>*</span> <span style=color:#75af00>_0x2ace3b</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>]));</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x3781b2</span><span style=color:#111>(</span><span style=color:#75af00>_0x5802aa</span><span style=color:#111>,</span> <span style=color:#75af00>_0x324521</span><span style=color:#111>,</span> <span style=color:#75af00>_0x33c9ff</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5d4f74</span><span style=color:#111>,</span> <span style=color:#75af00>_0x344078</span><span style=color:#111>,</span> <span style=color:#75af00>_0x385415</span><span style=color:#111>,</span> <span style=color:#75af00>_0x160dd3</span><span style=color:#111>,</span> <span style=color:#75af00>_0x61f2ad</span><span style=color:#111>,</span> <span style=color:#75af00>_0x5a2d55</span><span style=color:#111>,</span> <span style=color:#75af00>_0x47bfff</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75af00>_0x1548fd</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;0123456789abcdef&#39;</span><span style=color:#111>,</span> <span style=color:#75af00>_0x54f778</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#75af00>_0x5da9b5</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#75af00>_0x5da9b5</span> <span style=color:#f92672>&lt;</span> <span style=color:#75af00>_0x5802aa</span><span style=color:#111>[</span><span style=color:#d88200>&#39;length&#39;</span><span style=color:#111>];</span> <span style=color:#75af00>_0x5da9b5</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#75af00>_0xd26743</span> <span style=color:#f92672>=</span> <span style=color:#75af00>_0x5802aa</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charCodeAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0x5da9b5</span><span style=color:#111>),</span> <span style=color:#75af00>_0x54f778</span> <span style=color:#f92672>+=</span> <span style=color:#75af00>_0x1548fd</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charAt&#39;</span><span style=color:#111>](</span><span style=color:#75af00>_0xd26743</span> <span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>15</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#75af00>_0x1548fd</span><span style=color:#111>[</span><span style=color:#d88200>&#39;charAt&#39;</span><span style=color:#111>](</span><span style=color:#ae81ff>15</span> <span style=color:#f92672>&amp;</span> <span style=color:#75af00>_0xd26743</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x54f778</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x45dccd</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b4c95</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>unescape</span><span style=color:#111>(</span><span style=color:#111>encodeURIComponent</span><span style=color:#111>(</span><span style=color:#75af00>_0x5b4c95</span><span style=color:#111>));</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x443ca7</span><span style=color:#111>(</span><span style=color:#75af00>_0x48561e</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x57fdd5</span><span style=color:#111>(</span><span style=color:#75af00>_0x45dccd</span><span style=color:#111>(</span><span style=color:#75af00>_0x48561e</span><span style=color:#111>));</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x184fb0</span><span style=color:#111>(</span><span style=color:#75af00>_0x49a1f3</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x3781b2</span><span style=color:#111>(</span><span style=color:#75af00>_0x443ca7</span><span style=color:#111>(</span><span style=color:#75af00>_0x49a1f3</span><span style=color:#111>));</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x313b78</span><span style=color:#111>(</span><span style=color:#75af00>_0x575158</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1fa91a</span><span style=color:#111>,</span> <span style=color:#75af00>_0x1cf5de</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x1fa91a</span> <span style=color:#f92672>?</span> <span style=color:#75af00>_0x1cf5de</span> <span style=color:#f92672>?</span> <span style=color:#75af00>_0x21cf21</span><span style=color:#111>(</span><span style=color:#75af00>_0x1fa91a</span><span style=color:#111>,</span> <span style=color:#75af00>_0x575158</span><span style=color:#111>)</span> <span style=color:#f92672>:</span> <span style=color:#75af00>y</span><span style=color:#111>(</span><span style=color:#75af00>_0x1fa91a</span><span style=color:#111>,</span> <span style=color:#75af00>_0x575158</span><span style=color:#111>)</span> <span style=color:#f92672>:</span> <span style=color:#75af00>_0x1cf5de</span> <span style=color:#f92672>?</span> <span style=color:#75af00>_0x443ca7</span><span style=color:#111>(</span><span style=color:#75af00>_0x575158</span><span style=color:#111>)</span> <span style=color:#f92672>:</span> <span style=color:#75af00>_0x184fb0</span><span style=color:#111>(</span><span style=color:#75af00>_0x575158</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0xdad69f</span><span style=color:#111>(</span><span style=color:#75af00>_0x160e3a</span><span style=color:#111>,</span> <span style=color:#75af00>_0x3818c5</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0x313b78</span><span style=color:#111>(</span><span style=color:#75af00>_0x160e3a</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;|&#39;</span> <span style=color:#f92672>+</span> <span style=color:#75af00>_0x160e3a</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>_0x3e5ed0</span><span style=color:#111>(</span><span style=color:#75af00>_0x133a8b</span><span style=color:#111>,</span> <span style=color:#75af00>_0x27a18b</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>return</span> <span style=color:#111>Date</span><span style=color:#111>[</span><span style=color:#d88200>&#39;parse&#39;</span><span style=color:#111>](</span><span style=color:#00a8c8>new</span> <span style=color:#111>Date</span><span style=color:#111>());</span>
</span></span><span style=display:flex><span>        <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>return</span> <span style=color:#75af00>_0xdad69f</span><span style=color:#111>(</span><span style=color:#75af00>_0x3e5ed0</span><span style=color:#111>());</span>
</span></span><span style=display:flex><span><span style=color:#111>}())</span>
</span></span></code></pre></div><h3 id=解题>解题</h3><p>辛苦得到的美化后的js可以直接被调用</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>execjs</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>requests</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>with</span> <span style=color:#111>open</span><span style=color:#111>(</span><span style=color:#d88200>&#39;end.js&#39;</span><span style=color:#111>,</span> <span style=color:#d88200>&#39;r&#39;</span><span style=color:#111>,</span> <span style=color:#111>encoding</span><span style=color:#f92672>=</span><span style=color:#d88200>&#39;utf8&#39;</span><span style=color:#111>)</span> <span style=color:#00a8c8>as</span> <span style=color:#111>f</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#111>data</span> <span style=color:#f92672>=</span> <span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>read</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>_url</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;https://match.yuanrenxue.com/api/match/2&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>headers</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#d88200>&#39;User-Agent&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;yuanrenxue.project&#39;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>cookie</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#d88200>&#39;m&#39;</span><span style=color:#111>:</span> <span style=color:#111>execjs</span><span style=color:#f92672>.</span><span style=color:#111>eval</span><span style=color:#111>(</span><span style=color:#111>data</span><span style=color:#111>)}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>value</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>get</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>_url</span><span style=color:#d88200>}</span><span style=color:#d88200>?page=</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>,</span> <span style=color:#111>cookies</span><span style=color:#f92672>=</span><span style=color:#111>cookie</span><span style=color:#111>,</span> <span style=color:#111>headers</span><span style=color:#f92672>=</span><span style=color:#111>headers</span><span style=color:#111>)</span><span style=color:#f92672>.</span><span style=color:#111>json</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>j</span> <span style=color:#f92672>in</span> <span style=color:#111>value</span><span style=color:#111>[</span><span style=color:#d88200>&#39;data&#39;</span><span style=color:#111>]:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>res</span> <span style=color:#f92672>+=</span> <span style=color:#111>j</span><span style=color:#111>[</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>res</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 248974</span>
</span></span></code></pre></div><h2 id=猿人学3---访问逻辑-推心置腹>猿人学3 - 访问逻辑 推心置腹</h2><blockquote><p><a href=https://match.yuanrenxue.com/match/3>https://match.yuanrenxue.com/match/3</a></p><p>题目要求：抓取下列5页商标的数据，并将<strong>出现频率最高</strong>的申请号填入答案中</p></blockquote><p>抓包看了一手，没什么特殊的</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103204430002.png alt=image-20230103204430002></p><p>f12看网络部分有点东西</p><p><img src=https://amiz-1307622586.cos.ap-chongqing.myqcloud.com/images/image-20230103204449404.png alt=image-20230103204449404></p><p>每次?page=x请求时都会请求一下/jssm，那就很简单了~</p><p>简单测试一下发现cookie中m不是必须的，sessionid是必须的，而对于其它请求头来说，必须具备的有以下几个</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>POST /jssm HTTP/2
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Host: match.yuanrenxue.com
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Cookie: qpfccr=true
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Content-Length: 0
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept: */*
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Referer: https://match.yuanrenxue.com/match/3
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept-Encoding: gzip, deflate
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept-Language: zh-CN,zh;q=0.9
</span></span></span></code></pre></div><p>但是吧，用python的requests直接发包是无法指定好这几个请求头的顺序，导致无法返回含有Set-Cookie的sessinid</p><p>尝试很久，无果，遂查找wp（）发现这里有两种处理方式：</p><h3 id=元组>元组</h3><p>需要用自定义的items方法，借用元组的格式来固定顺序；详见<a href=https://zhuanlan.zhihu.com/p/360335607>此处</a></p><h3 id=requestssession>requests.Session()</h3><p>上一种方式还是有点麻烦，我这里用Session()对象也可以确保headers顺序不变</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>requests</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>headers</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Host&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;match.yuanrenxue.com&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Connection&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;keep-alive&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Content-Length&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;0&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Pragma&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;no-cache&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Cache-Control&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;no-cache&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;sec-ch-ua&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;&#34;Google Chrome&#34;;v=&#34;95&#34;, &#34;Chromium&#34;;v=&#34;95&#34;, &#34;;Not A Brand&#34;;v=&#34;99&#34;&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;sec-ch-ua-mobile&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;?0&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;User-Agent&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;yuanrenxue.project&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;sec-ch-ua-platform&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;&#34;Windows&#34;&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Accept&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;*/*&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Origin&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;https://match.yuanrenxue.com&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Sec-Fetch-Site&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;same-origin&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Sec-Fetch-Mode&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;cors&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Sec-Fetch-Dest&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;empty&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Referer&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;https://match.yuanrenxue.com/match/3&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Accept-Encoding&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;gzip, deflate, br&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#d88200>&#39;Accept-Language&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;zh-CN,zh;q=0.9&#39;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>session</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>Session</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span><span style=color:#111>session</span><span style=color:#f92672>.</span><span style=color:#111>headers</span> <span style=color:#f92672>=</span> <span style=color:#111>headers</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>_url</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;https://match.yuanrenxue.com/api/match/3&#39;</span>
</span></span><span style=display:flex><span><span style=color:#111>value</span> <span style=color:#f92672>=</span> <span style=color:#111>[]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>6</span><span style=color:#111>):</span>
</span></span><span style=display:flex><span>    <span style=color:#111>session</span><span style=color:#f92672>.</span><span style=color:#111>post</span><span style=color:#111>(</span><span style=color:#d88200>&#39;https://match.yuanrenxue.com/jssm&#39;</span><span style=color:#111>,</span> <span style=color:#111>headers</span><span style=color:#f92672>=</span><span style=color:#111>headers</span><span style=color:#111>,</span> <span style=color:#111>cookies</span><span style=color:#f92672>=</span><span style=color:#111>{</span><span style=color:#d88200>&#39;Cookie&#39;</span><span style=color:#111>:</span> <span style=color:#d88200>&#39;sessionid=;&#39;</span><span style=color:#111>})</span>
</span></span><span style=display:flex><span>    <span style=color:#111>res</span> <span style=color:#f92672>=</span> <span style=color:#111>session</span><span style=color:#f92672>.</span><span style=color:#111>get</span><span style=color:#111>(</span><span style=color:#d88200>f</span><span style=color:#d88200>&#39;</span><span style=color:#d88200>{</span><span style=color:#111>_url</span><span style=color:#d88200>}</span><span style=color:#d88200>?page=</span><span style=color:#d88200>{</span><span style=color:#111>i</span><span style=color:#d88200>}</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span><span style=color:#f92672>.</span><span style=color:#111>json</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>j</span> <span style=color:#f92672>in</span> <span style=color:#111>res</span><span style=color:#111>[</span><span style=color:#d88200>&#39;data&#39;</span><span style=color:#111>]:</span>
</span></span><span style=display:flex><span>        <span style=color:#111>value</span><span style=color:#f92672>.</span><span style=color:#111>append</span><span style=color:#111>(</span><span style=color:#111>j</span><span style=color:#111>[</span><span style=color:#d88200>&#39;value&#39;</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>value</span><span style=color:#111>,</span> <span style=color:#111>key</span><span style=color:#f92672>=</span><span style=color:#111>value</span><span style=color:#f92672>.</span><span style=color:#111>count</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 8717</span>
</span></span></code></pre></div></div></section></article></main><div class="w-full h-0 flex-none order-3"></div><aside role=contentinfo class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-4 md:order-3 md:sticky md:bottom-0 self-end max-w-2xl"><div class="md:float-right md:text-right leading-loose tracking-tight md:mb-2"><div class="md:max-w-xs flex flex-col md:items-end"><ul class="font-serif flex-grow-0 flex justify-between flex-wrap md:flex-col"><li class="px-1 md:px-0"><a href=/posts/ title="Posts page">Posts</a></li><li class="px-1 md:px-0"><a href=/life/ title="Fxxking life page">Fxxking life</a></li><li class="px-1 md:px-0"><a href=/relax/ title="Relaxxx page">Relaxxx</a></li><li class="px-1 md:px-0"><a href=/categories/ title="Categories page">Categories</a></li><li class="px-1 md:px-0"><a href=/series/ title="Series page">Series</a></li><li class="px-1 md:px-0"><a href=/tags/ title="Tags page">Tags</a></li><li class="px-1 md:px-0"><a href=/about/ title="About page">About</a></li><li class="px-1 md:px-0"><a href=/friends/ title="Friends page">Friends</a></li><li class="px-1 md:px-0"><a href=https://travellings.link title="Travelling page">Travelling</a></li><div id=fastSearch class=m-0><input id=searchInput type=text size=10 class="bg-gray-100 focus:outline-none border-b border-gray-100 focus:border-eucalyptus-300 md:text-right
placeholder-java-500 min-w-0 max-w-xxxs" placeholder=search><ul id=searchResults class="bg-gray-200 px-2 divide-y divide-gray-400"></ul></div></ul><div class="flex flex-wrap-reverse md:justify-end content-end md:content-start justify-start items-start md:flex-col max-h-16"><a href=V2VkIDI3IEFwcmlsIDIwMjIgMTE6MzM6MTUgVVRD target=_blank class="bilibili icon pl-1 text-eucalyptus-400 hover:text-java-400" title="bilibili link" rel=noopener aria-label="follow on bilibili——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M7.172 2.757 10.414 6h3.171l3.243-3.242a1 1 0 011.415 1.415L16.414 6H18.5A3.5 3.5.0 0122 9.5v8A3.5 3.5.0 0118.5 21h-13A3.5 3.5.0 012 17.5v-8A3.5 3.5.0 015.5 6h2.085L5.757 4.171a1 1 0 011.415-1.415zM18.5 8h-13A1.5 1.5.0 004.007 9.356L4 9.5v8a1.5 1.5.0 001.356 1.493L5.5 19h13a1.5 1.5.0 001.493-1.356L20 17.5v-8A1.5 1.5.0 0018.5 8zM8 11a1 1 0 011 1v2a1 1 0 01-2 0v-2a1 1 0 011-1zm8 0a1 1 0 011 1v2a1 1 0 01-2 0v-2a1 1 0 011-1z"/></g></svg></div></a><a href=https://github.com/AmiaaaZ target=_blank class="github icon pl-1 text-eucalyptus-400 hover:text-java-400" title="github link" rel=noopener aria-label="follow on github——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M5.883 18.653c-.3-.2-.558-.455-.86-.816a50.32 50.32.0 01-.466-.579c-.463-.575-.755-.84-1.057-.949a1 1 0 01.676-1.883c.752.27 1.261.735 1.947 1.588-.094-.117.34.427.433.539.19.227.33.365.44.438.204.137.587.196 1.15.14.023-.382.094-.753.202-1.095C5.38 15.31 3.7 13.396 3.7 9.64c0-1.24.37-2.356 1.058-3.292-.218-.894-.185-1.975.302-3.192a1 1 0 01.63-.582c.081-.024.127-.035.208-.047.803-.123 1.937.17 3.415 1.096A11.731 11.731.0 0112 3.315c.912.0 1.818.104 2.684.308 1.477-.933 2.613-1.226 3.422-1.096.085.013.157.03.218.05a1 1 0 01.616.58c.487 1.216.52 2.297.302 3.19.691.936 1.058 2.045 1.058 3.293.0 3.757-1.674 5.665-4.642 6.392.125.415.19.879.19 1.38a300.492 300.492.0 01-.012 2.716 1 1 0 01-.019 1.958c-1.139.228-1.983-.532-1.983-1.525l.002-.446.005-.705c.005-.708.007-1.338.007-1.998.0-.697-.183-1.152-.425-1.36-.661-.57-.326-1.655.54-1.752 2.967-.333 4.337-1.482 4.337-4.66.0-.955-.312-1.744-.913-2.404a1 1 0 01-.19-1.045c.166-.414.237-.957.096-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 01-.833.135A9.626 9.626.0 0012 5.315c-.89.0-1.772.119-2.592.35a1 1 0 01-.83-.134c-.752-.507-1.374-.807-1.868-.947-.144.653-.073 1.194.092 1.607a1 1 0 01-.189 1.045C6.016 7.89 5.7 8.694 5.7 9.64c0 3.172 1.371 4.328 4.322 4.66.865.097 1.201 1.177.544 1.748-.192.168-.429.732-.429 1.364v3.15c0 .986-.835 1.725-1.96 1.528a1 1 0 01-.04-1.962v-.99c-.91.061-1.662-.088-2.254-.485z"/></g></svg></div></a><a href=vickyckyky@foxmail.com target=_blank class="mail icon pl-1 text-eucalyptus-400 hover:text-java-400" title="mail link" rel=noopener aria-label="follow on mail——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M3 3h18a1 1 0 011 1v16a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zm17 4.238-7.928 7.1L4 7.216V19h16V7.238zM4.511 5l7.55 6.662L19.502 5H4.511z"/></g></svg></div></a><a href='TW9uJTIwMTglMjBGZWJydWFyeSUyMDE5ODAlMjAyMTowMjo1NSUyMFVUQw==' target=_blank class="netease-cloud-music icon pl-1 text-eucalyptus-400 hover:text-java-400" title="netease-cloud-music link" rel=noopener aria-label="follow on netease-cloud-music——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M10.421 11.375c-.294 1.028.012 2.064.784 2.653 1.061.81 2.565.3 2.874-.995.08-.337.103-.722.027-1.056-.23-1.001-.52-1.988-.792-2.996-1.33.154-2.543 1.172-2.893 2.394zm5.548-.287c.273 1.012.285 2.017-.127 3-1.128 2.69-4.721 3.14-6.573.826-1.302-1.627-1.28-3.961.06-5.734.78-1.032 1.804-1.707 3.048-2.054l.379-.104c-.084-.415-.188-.816-.243-1.224-.176-1.317.512-2.503 1.744-3.04 1.226-.535 2.708-.216 3.53.76.406.479.395 1.08-.025 1.464-.412.377-.996.346-1.435-.09-.247-.246-.51-.44-.877-.436-.525.006-.987.418-.945.937.037.468.173.93.3 1.386.022.078.216.135.338.153 1.334.197 2.504.731 3.472 1.676 2.558 2.493 2.861 6.531.672 9.44-1.529 2.032-3.61 3.168-6.127 3.409-4.621.44-8.664-2.53-9.7-7.058C2.515 10.255 4.84 5.831 8.795 4.25c.586-.234 1.143-.031 1.371.498.232.537-.019 1.086-.61 1.35-2.368 1.06-3.817 2.855-4.215 5.424-.533 3.433 1.656 6.776 5 7.72 2.723.77 5.658-.166 7.308-2.33 1.586-2.08 1.4-5.099-.427-6.873a3.979 3.979.0 00-1.823-1.013c.198.716.389 1.388.57 2.062z"/></g></svg></div></a><a href=2517834528 target=_blank class="qq icon pl-1 text-eucalyptus-400 hover:text-java-400" title="qq link" rel=noopener aria-label="follow on qq——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M17.535 12.514l-.696-1.796c0-.021.01-.375.01-.558C16.848 7.088 15.446 4 12 4s-4.848 3.088-4.848 6.16c0 .183.009.537.01.558l-.696 1.796c-.19.515-.38 1.05-.517 1.51-.657 2.189-.444 3.095-.282 3.115.348.043 1.354-1.648 1.354-1.648.0.98.488 2.258 1.542 3.18-.394.127-.878.32-1.188.557-.28.214-.245.431-.194.52.22.385 3.79.245 4.82.125 1.03.12 4.599.26 4.82-.126.05-.088.085-.305-.194-.519-.311-.237-.795-.43-1.19-.556 1.055-.923 1.542-2.202 1.542-3.181.0.0 1.007 1.691 1.355 1.648.162-.02.378-.928-.283-3.116-.14-.463-.325-.994-.516-1.509zm1.021 8.227c-.373.652-.833.892-1.438 1.057-.24.065-.498.108-.794.138-.44.045-.986.065-1.613.064a33.23 33.23.0 01-2.71-.116c-.692.065-1.785.114-2.71.116a16.07 16.07.0 01-1.614-.064 4.928 4.928.0 01-.793-.138c-.605-.164-1.065-.405-1.44-1.059a2.274 2.274.0 01-.239-1.652c-.592-.132-1.001-.483-1.279-.911a2.43 2.43.0 01-.309-.71 4.028 4.028.0 01-.116-1.106c.013-.785.187-1.762.532-2.912.14-.466.327-1.008.568-1.655l.553-1.43a15.496 15.496.0 01-.002-.203C5.152 5.605 7.588 2 12 2c4.413.0 6.848 3.605 6.848 8.16l-.001.203.553 1.43.01.026c.225.606.413 1.153.556 1.626.348 1.15.522 2.129.535 2.916.007.407-.03.776-.118 1.108-.066.246-.161.48-.31.708-.276.427-.684.776-1.277.91.13.554.055 1.14-.24 1.654z"/></g></svg></div></a><a href='Vmlja3lja3lreQ==' target=_blank class="wechat icon pl-1 text-eucalyptus-400 hover:text-java-400" title="wechat link" rel=noopener aria-label="follow on wechat——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill-rule="evenodd"><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M10 14.676v-.062c0-2.508 2.016-4.618 4.753-5.233C14.389 7.079 11.959 5.2 8.9 5.2 5.58 5.2 3 7.413 3 9.98c0 .969.36 1.9 1.04 2.698.032.038.083.094.152.165a3.568 3.568.0 011.002 2.238 3.612 3.612.0 012.363-.442c.166.026.302.046.405.06A7.254 7.254.0 0010 14.675zm.457 1.951a9.209 9.209.0 01-2.753.055 19.056 19.056.0 01-.454-.067 1.612 1.612.0 00-1.08.212l-1.904 1.148a.806.806.0 01-.49.117.791.791.0 01-.729-.851l.15-1.781a1.565 1.565.0 00-.439-1.223 5.537 5.537.0 01-.241-.262C1.563 12.855 1 11.473 1 9.979 1 6.235 4.537 3.2 8.9 3.2c4.06.0 7.403 2.627 7.85 6.008 3.372.153 6.05 2.515 6.05 5.406.0 1.193-.456 2.296-1.229 3.19-.051.06-.116.13-.195.21a1.24 1.24.0 00-.356.976l.121 1.423a.635.635.0 01-.59.68.66.66.0 01-.397-.094l-1.543-.917a1.322 1.322.0 00-.874-.169c-.147.023-.27.04-.368.053-.316.04-.64.062-.969.062-2.694.0-4.998-1.408-5.943-3.401zm6.977 1.31a3.325 3.325.0 011.676.174 3.25 3.25.0 01.841-1.502c.05-.05.087-.09.106-.112.489-.565.743-1.213.743-1.883.0-1.804-1.903-3.414-4.4-3.414-2.497.0-4.4 1.61-4.4 3.414s1.903 3.414 4.4 3.414c.241.0.48-.016.714-.046.08-.01.188-.025.32-.046z"/></g></svg></div></a><a href=https://weibo.com/u/7562434112 target=_blank class="weibo icon pl-1 text-eucalyptus-400 hover:text-java-400" title="weibo link" rel=noopener aria-label="follow on weibo——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M20.194 14.197c0 3.362-4.53 6.424-9.926 6.424C5.318 20.62 1 18.189 1 14.534c0-1.947 1.18-4.087 3.24-6.088 2.832-2.746 6.229-4.033 7.858-2.448.498.482.723 1.122.719 1.858 1.975-.576 3.65-.404 4.483.752.449.623.532 1.38.326 2.207 1.511.61 2.568 1.77 2.568 3.382zm-4.44-2.07c-.386-.41-.4-.92-.198-1.41.208-.508.213-.812.12-.94-.264-.368-1.533-.363-3.194.311a2.043 2.043.0 01-.509.14c-.344.046-.671.001-.983-.265-.419-.359-.474-.855-.322-1.316.215-.67.18-1.076.037-1.215-.186-.18-.777-.191-1.659.143-1.069.405-2.298 1.224-3.414 2.306C3.925 11.54 3 13.218 3 14.534c0 2.242 3.276 4.087 7.268 4.087 4.42.0 7.926-2.37 7.926-4.424.0-.738-.637-1.339-1.673-1.652-.394-.113-.536-.171-.767-.417zm7.054-1.617a1 1 0 01-1.936-.502 4 4 0 00-4.693-4.924 1 1 0 11-.407-1.958 6 6 0 017.036 7.384z"/></g></svg></div></a><a href=https://www.zhihu.com/people/lan-shan-86-69 target=_blank class="zhihu icon pl-1 text-eucalyptus-400 hover:text-java-400" title="zhihu link" rel=noopener aria-label="follow on zhihu——Opens in a new window"><div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M12.344 17.963l-1.688 1.074-2.131-3.35c-.44 1.402-1.172 2.665-2.139 3.825-.402.483-.82.918-1.301 1.375-.155.147-.775.717-.878.82l-1.414-1.414c.139-.139.787-.735.915-.856.43-.408.795-.79 1.142-1.206 1.266-1.518 2.03-3.21 2.137-5.231H3v-2h4V7h-.868c-.689 1.266-1.558 2.222-2.618 2.857L2.486 8.143c1.395-.838 2.425-2.604 3.038-5.36l1.952.434c-.14.633-.303 1.227-.489 1.783H11.5v2H9v4h2.5v2H9.185l3.159 4.963zm3.838-.07L17.298 17H19V7h-4v10h.736l.446.893zM13 5h8v14h-3l-2.5 2-1-2H13V5z"/></g></svg></div></a></div><div class="text-sm text-gray-500 leading-tight a-gray"><br>Built with Hugo and theme <a href=https://github.com/heyeshuang/hugo-theme-tokiwa>Tokiwa</a>. 9067 words in this page.</div></div></div></aside><footer class="w-full md:w-3/5 xl:w-1/2 order-3 max-w-3xl md:order-4 pt-2"><hr class=double-line><div class="flex flex-wrap justify-between pb-2 leading-loose font-serif"><a class=flex-grow-0 href=/relax/bass-practice-memo/><svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"/></svg>bass练习备忘</a></div><div><div class="font-serif pb-2 flex align-start leading-loose"><span class="heading pr-6 leading-loose">Related</span>
<span><a href=/2022/05/04/js-prototype-pollution-study-notes/>js原型污染学习笔记</a></span></div></div><hr><div class=pb-2><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//amiaaaz.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><hr></footer><script src=/dist/app.js></script>
<script src=/lib/fuse.min.js></script>
<script src=/lib/fastsearch.js></script></div></body></html>